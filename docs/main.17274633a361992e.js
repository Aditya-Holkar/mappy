"use strict";(self.webpackChunkKGIS=self.webpackChunkKGIS||[]).push([[179],{810:(CF,ub,hb)=>{function Si(t){return"function"==typeof t}function Nl(t){const n=t(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const bC=Nl(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,s)=>`${s+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function pn(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class aa{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const c of n)c.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(Si(r))try{r()}catch(c){e=c instanceof bC?c.errors:[c]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const c of s)try{so(c)}catch(f){e=e??[],f instanceof bC?e=[...e,...f.errors]:e.push(f)}}if(e)throw new bC(e)}}add(e){var n;if(e&&e!==this)if(this.closed)so(e);else{if(e instanceof aa){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&pn(n,e)}remove(e){const{_finalizers:n}=this;n&&pn(n,e),e instanceof aa&&e._removeParent(this)}}aa.EMPTY=(()=>{const t=new aa;return t.closed=!0,t})();const Ka=aa.EMPTY;function dv(t){return t instanceof aa||t&&"closed"in t&&Si(t.remove)&&Si(t.add)&&Si(t.unsubscribe)}function so(t){Si(t)?t():t.unsubscribe()}const Wp={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},db={setTimeout(t,e,...n){const{delegate:r}=db;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){const{delegate:e}=db;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function kP(t){db.setTimeout(()=>{const{onUnhandledError:e}=Wp;if(!e)throw t;e(t)})}function Kg(){}const IF=Pr("C",void 0,void 0);function Pr(t,e,n){return{kind:t,value:e,error:n}}let pm=null;function To(t){if(Wp.useDeprecatedSynchronousErrorHandling){const e=!pm;if(e&&(pm={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:r}=pm;if(pm=null,n)throw r}}else t()}class OP extends aa{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,dv(e)&&e.add(this)):this.destination=Yp}static create(e,n,r){return new wu(e,n,r)}next(e){this.isStopped?xC(function mc(t){return Pr("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?xC(function dm(t){return Pr("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?xC(IF,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const AF=Function.prototype.bind;function vu(t,e){return AF.call(t,e)}class DF{constructor(e){this.partialObserver=e}next(e){const{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){pv(r)}}error(e){const{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){pv(r)}else pv(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){pv(n)}}}class wu extends OP{constructor(e,n,r){let s;if(super(),Si(e)||!e)s={next:e??void 0,error:n??void 0,complete:r??void 0};else{let c;this&&Wp.useDeprecatedNextContext?(c=Object.create(e),c.unsubscribe=()=>this.unsubscribe(),s={next:e.next&&vu(e.next,c),error:e.error&&vu(e.error,c),complete:e.complete&&vu(e.complete,c)}):s=e}this.destination=new DF(s)}}function pv(t){Wp.useDeprecatedSynchronousErrorHandling?function SF(t){Wp.useDeprecatedSynchronousErrorHandling&&pm&&(pm.errorThrown=!0,pm.error=t)}(t):kP(t)}function xC(t,e){const{onStoppedNotification:n}=Wp;n&&db.setTimeout(()=>n(t,e))}const Yp={closed:!0,next:Kg,error:function EC(t){throw t},complete:Kg},fv="function"==typeof Symbol&&Symbol.observable||"@@observable";function Zp(t){return t}function NP(t){return 0===t.length?Zp:1===t.length?t[0]:function(n){return t.reduce((r,s)=>s(r),n)}}let ls=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,s){const c=function fb(t){return t&&t instanceof OP||function Qp(t){return t&&Si(t.next)&&Si(t.error)&&Si(t.complete)}(t)&&dv(t)}(n)?n:new wu(n,r,s);return To(()=>{const{operator:f,source:v}=this;c.add(f?f.call(c,v):v?this._subscribe(c):this._trySubscribe(c))}),c}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=pb(r))((s,c)=>{const f=new wu({next:v=>{try{n(v)}catch(b){c(b),f.unsubscribe()}},error:c,complete:s});this.subscribe(f)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[fv](){return this}pipe(...n){return NP(n)(this)}toPromise(n){return new(n=pb(n))((r,s)=>{let c;this.subscribe(f=>c=f,f=>s(f),()=>r(c))})}}return t.create=e=>new t(e),t})();function pb(t){var e;return null!==(e=t??Wp.Promise)&&void 0!==e?e:Promise}const RF=Nl(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let bu=(()=>{class t extends ls{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new LP(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new RF}next(n){To(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){To(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){To(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:s,observers:c}=this;return r||s?Ka:(this.currentObservers=null,c.push(n),new aa(()=>{this.currentObservers=null,pn(c,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:s,isStopped:c}=this;r?n.error(s):c&&n.complete()}asObservable(){const n=new ls;return n.source=this,n}}return t.create=(e,n)=>new LP(e,n),t})();class LP extends bu{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,e)}error(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==r?r:Ka}}function FP(t){return Si(t?.lift)}function Ws(t){return e=>{if(FP(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Bs(t,e,n,r,s){return new MF(t,e,n,r,s)}class MF extends OP{constructor(e,n,r,s,c,f){super(e),this.onFinalize=c,this.shouldUnsubscribe=f,this._next=n?function(v){try{n(v)}catch(b){e.error(b)}}:super._next,this._error=s?function(v){try{s(v)}catch(b){e.error(b)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(v){e.error(v)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function go(t,e){return Ws((n,r)=>{let s=0;n.subscribe(Bs(r,c=>{r.next(t.call(e,c,s++))}))})}function gb(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]])}return n}function Xp(t){return this instanceof Xp?(this.v=t,this):new Xp(t)}function vb(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function mv(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(c){n[c]=t[c]&&function(f){return new Promise(function(v,b){!function s(c,f,v,b){Promise.resolve(b).then(function(S){c({value:S,done:v})},f)}(v,b,(f=t[c](f)).done,f.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const wb=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function bb(t){return Si(t?.then)}function kC(t){return Si(t[fv])}function Eb(t){return Symbol.asyncIterator&&Si(t?.[Symbol.asyncIterator])}function OC(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const LC=function NC(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function gv(t){return Si(t?.[LC])}function xb(t){return function HP(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=n.apply(t,e||[]),c=[];return s={},f("next"),f("throw"),f("return"),s[Symbol.asyncIterator]=function(){return this},s;function f(H){r[H]&&(s[H]=function(Q){return new Promise(function(de,be){c.push([H,Q,de,be])>1||v(H,Q)})})}function v(H,Q){try{!function b(H){H.value instanceof Xp?Promise.resolve(H.value.v).then(S,k):F(c[0][2],H)}(r[H](Q))}catch(de){F(c[0][3],de)}}function S(H){v("next",H)}function k(H){v("throw",H)}function F(H,Q){H(Q),c.shift(),c.length&&v(c[0][0],c[0][1])}}(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:r,done:s}=yield Xp(n.read());if(s)return yield Xp(void 0);yield yield Xp(r)}}finally{n.releaseLock()}})}function Tb(t){return Si(t?.getReader)}function Wa(t){if(t instanceof ls)return t;if(null!=t){if(kC(t))return function FC(t){return new ls(e=>{const n=t[fv]();if(Si(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(wb(t))return function VC(t){return new ls(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(bb(t))return function BC(t){return new ls(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,kP)})}(t);if(Eb(t))return UC(t);if(gv(t))return function Cb(t){return new ls(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(Tb(t))return function GP(t){return UC(xb(t))}(t)}throw OC(t)}function UC(t){return new ls(e=>{(function zC(t,e){var n,r,s,c;return function yb(t,e,n,r){return new(n||(n=Promise))(function(c,f){function v(k){try{S(r.next(k))}catch(F){f(F)}}function b(k){try{S(r.throw(k))}catch(F){f(F)}}function S(k){k.done?c(k.value):function s(c){return c instanceof n?c:new n(function(f){f(c)})}(k.value).then(v,b)}S((r=r.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){try{for(n=vb(t);!(r=yield n.next()).done;)if(e.next(r.value),e.closed)return}catch(f){s={error:f}}finally{try{r&&!r.done&&(c=n.return)&&(yield c.call(n))}finally{if(s)throw s.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function $h(t,e,n,r=0,s=!1){const c=e.schedule(function(){n(),s?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(c),!s)return c}function la(t,e,n=1/0){return Si(e)?la((r,s)=>go((c,f)=>e(r,c,s,f))(Wa(t(r,s))),n):("number"==typeof e&&(n=e),Ws((r,s)=>function KP(t,e,n,r,s,c,f,v){const b=[];let S=0,k=0,F=!1;const H=()=>{F&&!b.length&&!S&&e.complete()},Q=be=>S<r?de(be):b.push(be),de=be=>{c&&e.next(be),S++;let Ie=!1;Wa(n(be,k++)).subscribe(Bs(e,Be=>{s?.(Be),c?Q(Be):e.next(Be)},()=>{Ie=!0},void 0,()=>{if(Ie)try{for(S--;b.length&&S<r;){const Be=b.shift();f?$h(e,f,()=>de(Be)):de(Be)}H()}catch(Be){e.error(Be)}}))};return t.subscribe(Bs(e,Q,()=>{F=!0,H()})),()=>{v?.()}}(r,s,t,n)))}function gm(t=1/0){return la(Zp,t)}const sh=new ls(t=>t.complete());function Ib(t){return t&&Si(t.schedule)}function Sb(t){return t[t.length-1]}function ym(t){return Ib(Sb(t))?t.pop():void 0}function Ab(t,e=0){return Ws((n,r)=>{n.subscribe(Bs(r,s=>$h(r,t,()=>r.next(s),e),()=>$h(r,t,()=>r.complete(),e),s=>$h(r,t,()=>r.error(s),e)))})}function Db(t,e=0){return Ws((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function ya(t,e){if(!t)throw new Error("Iterable cannot be null");return new ls(n=>{$h(n,e,()=>{const r=t[Symbol.asyncIterator]();$h(n,e,()=>{r.next().then(s=>{s.done?n.complete():n.next(s.value)})},0,!0)})})}function ki(t,e){return e?function QP(t,e){if(null!=t){if(kC(t))return function YP(t,e){return Wa(t).pipe(Db(e),Ab(e))}(t,e);if(wb(t))return function ZP(t,e){return new ls(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}(t,e);if(bb(t))return function Jp(t,e){return Wa(t).pipe(Db(e),Ab(e))}(t,e);if(Eb(t))return ya(t,e);if(gv(t))return function Ll(t,e){return new ls(n=>{let r;return $h(n,e,()=>{r=t[LC](),$h(n,e,()=>{let s,c;try{({value:s,done:c}=r.next())}catch(f){return void n.error(f)}c?n.complete():n.next(s)},0,!0)}),()=>Si(r?.return)&&r.return()})}(t,e);if(Tb(t))return function _m(t,e){return ya(xb(t),e)}(t,e)}throw OC(t)}(t,e):Wa(t)}class pl extends bu{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}function Sr(...t){return ki(t,ym(t))}function XP(t={}){const{connector:e=(()=>new bu),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:s=!0}=t;return c=>{let f,v,b,S=0,k=!1,F=!1;const H=()=>{v?.unsubscribe(),v=void 0},Q=()=>{H(),f=b=void 0,k=F=!1},de=()=>{const be=f;Q(),be?.unsubscribe()};return Ws((be,Ie)=>{S++,!F&&!k&&H();const Be=b=b??e();Ie.add(()=>{S--,0===S&&!F&&!k&&(v=Fl(de,s))}),Be.subscribe(Ie),!f&&S>0&&(f=new wu({next:Fe=>Be.next(Fe),error:Fe=>{F=!0,H(),v=Fl(Q,n,Fe),Be.error(Fe)},complete:()=>{k=!0,H(),v=Fl(Q,r),Be.complete()}}),Wa(be).subscribe(f))})(c)}}function Fl(t,e,...n){if(!0===e)return void t();if(!1===e)return;const r=new wu({next:()=>{r.unsubscribe(),t()}});return Wa(e(...n)).subscribe(r)}function Pa(t,e){return Ws((n,r)=>{let s=null,c=0,f=!1;const v=()=>f&&!s&&r.complete();n.subscribe(Bs(r,b=>{s?.unsubscribe();let S=0;const k=c++;Wa(t(b,k)).subscribe(s=Bs(r,F=>r.next(e?e(b,F,k,S++):F),()=>{s=null,v()}))},()=>{f=!0,v()}))})}function LF(t,e){return t===e}function oi(t){for(let e in t)if(t[e]===oi)return e;throw Error("Could not find renamed property on target object.")}function Pb(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function _a(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(_a).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function qC(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const eR=oi({__forward_ref__:oi});function Yo(t){return t.__forward_ref__=Yo,t.toString=function(){return _a(this())},t}function Vr(t){return GC(t)?t():t}function GC(t){return"function"==typeof t&&t.hasOwnProperty(eR)&&t.__forward_ref__===Yo}function tR(t){return t&&!!t.\u0275providers}const nR="https://g.co/ng/security#xss";class Gt extends Error{constructor(e,n){super(function KC(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,n)),this.code=e}}function jr(t){return"string"==typeof t?t:null==t?"":String(t)}function ef(t,e){throw new Gt(-201,!1)}function ah(t,e){null==t&&function Nr(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function jn(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function cs(t){return{providers:t.providers||[],imports:t.imports||[]}}function Mb(t){return iR(t,Ob)||iR(t,wm)}function iR(t,e){return t.hasOwnProperty(e)?t[e]:null}function kb(t){return t&&(t.hasOwnProperty(YC)||t.hasOwnProperty(oR))?t[YC]:null}const Ob=oi({\u0275prov:oi}),YC=oi({\u0275inj:oi}),wm=oi({ngInjectableDef:oi}),oR=oi({ngInjectorDef:oi});var mi=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(mi||{});let ZC;function gc(t){const e=ZC;return ZC=t,e}function lh(t,e,n){const r=Mb(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&mi.Optional?null:void 0!==e?e:void ef(_a(t))}const Zo=globalThis;class Xn{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=jn({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Xg={},eI="__NG_DI_FLAG__",Lb="ngTempTokenPath",$F=/\n/gm,tI="__source";let $c;function tf(t){const e=$c;return $c=t,e}function Fb(t,e=mi.Default){if(void 0===$c)throw new Gt(-203,!1);return null===$c?lh(t,void 0,e):$c.get(t,e&mi.Optional?null:void 0,e)}function hr(t,e=mi.Default){return(function sR(){return ZC}()||Fb)(Vr(t),e)}function Kn(t,e=mi.Default){return hr(t,Ld(e))}function Ld(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function _v(t){const e=[];for(let n=0;n<t.length;n++){const r=Vr(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Gt(900,!1);let s,c=mi.Default;for(let f=0;f<r.length;f++){const v=r[f],b=GF(v);"number"==typeof b?-1===b?s=v.token:c|=b:s=v}e.push(hr(s,c))}else e.push(hr(r))}return e}function Vb(t,e){return t[eI]=e,t.prototype[eI]=e,t}function GF(t){return t[eI]}function uh(t){return{toString:t}.toString()}var Bb=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Bb||{}),xu=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(xu||{});const qh={},Xi=[],Ub=oi({\u0275cmp:oi}),zb=oi({\u0275dir:oi}),nI=oi({\u0275pipe:oi}),vv=oi({\u0275mod:oi}),Tu=oi({\u0275fac:oi}),wv=oi({__NG_ELEMENT_ID__:oi}),uR=oi({__NG_ENV_ID__:oi});function jb(t,e,n){let r=t.length;for(;;){const s=t.indexOf(e,n);if(-1===s)return s;if(0===s||t.charCodeAt(s-1)<=32){const c=e.length;if(s+c===r||t.charCodeAt(s+c)<=32)return s}n=s+1}}function rI(t,e,n){let r=0;for(;r<n.length;){const s=n[r];if("number"==typeof s){if(0!==s)break;r++;const c=n[r++],f=n[r++],v=n[r++];t.setAttribute(e,f,v,c)}else{const c=s,f=n[++r];dR(c)?t.setProperty(e,c,f):t.setAttribute(e,c,f),r++}}return r}function hR(t){return 3===t||4===t||6===t}function dR(t){return 64===t.charCodeAt(0)}function bv(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const s=e[r];"number"==typeof s?n=s:0===n||pR(t,n,s,null,-1===n||2===n?e[++r]:null)}}return t}function pR(t,e,n,r,s){let c=0,f=t.length;if(-1===e)f=-1;else for(;c<t.length;){const v=t[c++];if("number"==typeof v){if(v===e){f=-1;break}if(v>e){f=c-1;break}}}for(;c<t.length;){const v=t[c];if("number"==typeof v)break;if(v===n){if(null===r)return void(null!==s&&(t[c+1]=s));if(r===t[c+1])return void(t[c+2]=s)}c++,null!==r&&c++,null!==s&&c++}-1!==f&&(t.splice(f,0,e),c=f+1),t.splice(c++,0,n),null!==r&&t.splice(c++,0,r),null!==s&&t.splice(c++,0,s)}const fR="ng-template";function KF(t,e,n){let r=0,s=!0;for(;r<t.length;){let c=t[r++];if("string"==typeof c&&s){const f=t[r++];if(n&&"class"===c&&-1!==jb(f.toLowerCase(),e,0))return!0}else{if(1===c){for(;r<t.length&&"string"==typeof(c=t[r++]);)if(c.toLowerCase()===e)return!0;return!1}"number"==typeof c&&(s=!1)}}return!1}function mR(t){return 4===t.type&&t.value!==fR}function Nj(t,e,n){return e===(4!==t.type||n?t.value:fR)}function WF(t,e,n){let r=4;const s=t.attrs||[],c=function Fj(t){for(let e=0;e<t.length;e++)if(hR(t[e]))return e;return t.length}(s);let f=!1;for(let v=0;v<e.length;v++){const b=e[v];if("number"!=typeof b){if(!f)if(4&r){if(r=2|1&r,""!==b&&!Nj(t,b,n)||""===b&&1===e.length){if(hh(r))return!1;f=!0}}else{const S=8&r?b:e[++v];if(8&r&&null!==t.attrs){if(!KF(t.attrs,S,n)){if(hh(r))return!1;f=!0}continue}const F=YF(8&r?"class":b,s,mR(t),n);if(-1===F){if(hh(r))return!1;f=!0;continue}if(""!==S){let H;H=F>c?"":s[F+1].toLowerCase();const Q=8&r?H:null;if(Q&&-1!==jb(Q,S,0)||2&r&&S!==H){if(hh(r))return!1;f=!0}}}}else{if(!f&&!hh(r)&&!hh(b))return!1;if(f&&hh(b))continue;f=!1,r=b|1&r}}return hh(r)||f}function hh(t){return 0==(1&t)}function YF(t,e,n,r){if(null===e)return-1;let s=0;if(r||!n){let c=!1;for(;s<e.length;){const f=e[s];if(f===t)return s;if(3===f||6===f)c=!0;else{if(1===f||2===f){let v=e[++s];for(;"string"==typeof v;)v=e[++s];continue}if(4===f)break;if(0===f){s+=4;continue}}s+=c?1:2}return-1}return function ZF(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function nf(t,e,n=!1){for(let r=0;r<e.length;r++)if(WF(t,e[r],n))return!0;return!1}function iI(t,e){e:for(let n=0;n<e.length;n++){const r=e[n];if(t.length===r.length){for(let s=0;s<t.length;s++)if(t[s]!==r[s])continue e;return!0}}return!1}function QF(t,e){return t?":not("+e.trim()+")":e}function XF(t){let e=t[0],n=1,r=2,s="",c=!1;for(;n<t.length;){let f=t[n];if("string"==typeof f)if(2&r){const v=t[++n];s+="["+f+(v.length>0?'="'+v+'"':"")+"]"}else 8&r?s+="."+f:4&r&&(s+=" "+f);else""!==s&&!hh(f)&&(e+=QF(c,s),s=""),r=f,c=c||!hh(r);n++}return""!==s&&(e+=QF(c,s)),e}function Ra(t){return uh(()=>{const e=rV(t),n={...e,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Bb.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||xu.Emulated,styles:t.styles||Xi,_:null,schemas:t.schemas||null,tView:null,id:""};_R(n);const r=t.dependencies;return n.directiveDefs=$b(r,!1),n.pipeDefs=$b(r,!0),n.id=function sI(t){let e=0;const n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const s of n)e=Math.imul(31,e)+s.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(n),n})}function eV(t){return qi(t)||Ya(t)}function tV(t){return null!==t}function _s(t){return uh(()=>({type:t.type,bootstrap:t.bootstrap||Xi,declarations:t.declarations||Xi,imports:t.imports||Xi,exports:t.exports||Xi,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function yR(t,e){if(null==t)return qh;const n={};for(const r in t)if(t.hasOwnProperty(r)){let s=t[r],c=s;Array.isArray(s)&&(c=s[1],s=s[0]),n[s]=r,e&&(e[s]=c)}return n}function vr(t){return uh(()=>{const e=rV(t);return _R(e),e})}function yc(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function qi(t){return t[Ub]||null}function Ya(t){return t[zb]||null}function Vl(t){return t[nI]||null}function Ai(t,e){const n=t[vv]||null;if(!n&&!0===e)throw new Error(`Type ${_a(t)} does not have '\u0275mod' property.`);return n}function rV(t){const e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||qh,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||Xi,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:yR(t.inputs,e),outputs:yR(t.outputs)}}function _R(t){t.features?.forEach(e=>e(t))}function $b(t,e){if(!t)return null;const n=e?Vl:eV;return()=>("function"==typeof t?t():t).map(r=>n(r)).filter(tV)}const Bo=0,On=1,Zr=2,As=3,Cu=4,Gh=5,fl=6,bm=7,Ys=8,rf=9,ey=10,Hr=11,Ev=12,iV=13,ty=14,vs=15,xv=16,ny=17,Kh=18,ry=19,vR=20,Fd=21,Em=22,Tv=23,qb=24,Oi=25,aI=1,oV=2,Wh=7,iy=9,Za=11;function Bl(t){return Array.isArray(t)&&"object"==typeof t[aI]}function Ul(t){return Array.isArray(t)&&!0===t[aI]}function cI(t){return 0!=(4&t.flags)}function xm(t){return t.componentOffset>-1}function sy(t){return 1==(1&t.flags)}function dh(t){return!!t.template}function wR(t){return 0!=(512&t[Zr])}function Tm(t,e){return t.hasOwnProperty(Tu)?t[Tu]:null}let Qa=null,Sv=!1;function Iu(t){const e=Qa;return Qa=t,e}const Yh={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function CR(t){if(!Dv(t)||t.dirty){if(!t.producerMustRecompute(t)&&!gI(t))return void(t.dirty=!1);t.producerRecomputeValue(t),t.dirty=!1}}function fI(t){t.dirty=!0,function dI(t){if(void 0===t.liveConsumerNode)return;const e=Sv;Sv=!0;try{for(const n of t.liveConsumerNode)n.dirty||fI(n)}finally{Sv=e}}(t),t.consumerMarkedDirty?.(t)}function Kb(t){return t&&(t.nextProducerIndex=0),Iu(t)}function mI(t,e){if(Iu(e),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(Dv(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Av(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function gI(t){ay(t);for(let e=0;e<t.producerNode.length;e++){const n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(CR(n),r!==n.version))return!0}return!1}function IR(t){if(ay(t),Dv(t))for(let e=0;e<t.producerNode.length;e++)Av(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Av(t,e){if(function Cm(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}(t),ay(t),1===t.liveConsumerNode.length)for(let r=0;r<t.producerNode.length;r++)Av(t.producerNode[r],t.producerIndexOfThis[r]);const n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){const r=t.liveConsumerIndexOfThis[e],s=t.liveConsumerNode[e];ay(s),s.producerIndexOfThis[r]=e}}function Dv(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function ay(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}let fV=null;function AR(t){const e=Iu(null);try{return t()}finally{Iu(e)}}const PR=()=>{},EV=(()=>({...Yh,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:t=>{t.schedule(t.ref)},hasRun:!1,cleanupFn:PR}))();class xV{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function ml(){return TV}function TV(t){return t.type.prototype.ngOnChanges&&(t.setInput=CV),Jj}function Jj(){const t=IV(this),e=t?.current;if(e){const n=t.previous;if(n===qh)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function CV(t,e,n,r){const s=this.declaredInputs[n],c=IV(t)||function eH(t,e){return t[RR]=e}(t,{previous:qh,current:null}),f=c.current||(c.current={}),v=c.previous,b=v[s];f[s]=new xV(b&&b.currentValue,e,v===qh),t[r]=e}ml.ngInherit=!0;const RR="__ngSimpleChanges__";function IV(t){return t[RR]||null}const Vd=function(t,e,n){},AV="svg";function Qo(t){for(;Array.isArray(t);)t=t[Bo];return t}function Uo(t,e){return Qo(e[t])}function _c(t,e){return Qo(e[t.index])}function Zb(t,e){return t.data[e]}function Zh(t,e){return t[e]}function Ma(t,e){const n=e[t];return Bl(n)?n:n[Bo]}function Su(t,e){return null==e?null:t[e]}function Qb(t){t[ny]=0}function DV(t){1024&t[Zr]||(t[Zr]|=1024,EI(t,1))}function Pv(t){1024&t[Zr]&&(t[Zr]&=-1025,EI(t,-1))}function EI(t,e){let n=t[As];if(null===n)return;n[Gh]+=e;let r=n;for(n=n[As];null!==n&&(1===e&&1===r[Gh]||-1===e&&0===r[Gh]);)n[Gh]+=e,r=n,n=n[As]}const Lr={lFrame:HR(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function ly(){return Lr.bindingsEnabled}function cy(){return null!==Lr.skipHydrationRootTNode}function Bt(){return Lr.lFrame.lView}function Gi(){return Lr.lFrame.tView}function va(t){return Lr.lFrame.contextLView=t,t[Ys]}function Zs(t){return Lr.lFrame.contextLView=null,t}function Xa(){let t=FR();for(;null!==t&&64===t.type;)t=t.parent;return t}function FR(){return Lr.lFrame.currentTNode}function Bd(t,e){const n=Lr.lFrame;n.currentTNode=t,n.isParent=e}function CI(){return Lr.lFrame.isParent}function II(){Lr.lFrame.isParent=!1}function zl(){const t=Lr.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function cf(){return Lr.lFrame.bindingIndex++}function uf(t){const e=Lr.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function LV(t,e){const n=Lr.lFrame;n.bindingIndex=n.bindingRootIndex=t,UR(e)}function UR(t){Lr.lFrame.currentDirectiveIndex=t}function zR(){return Lr.lFrame.currentQueryIndex}function DI(t){Lr.lFrame.currentQueryIndex=t}function VV(t){const e=t[On];return 2===e.type?e.declTNode:1===e.type?t[fl]:null}function jR(t,e,n){if(n&mi.SkipSelf){let s=e,c=t;for(;!(s=s.parent,null!==s||n&mi.Host||(s=VV(c),null===s||(c=c[ty],10&s.type))););if(null===s)return!1;e=s,t=c}const r=Lr.lFrame=BV();return r.currentTNode=e,r.lView=t,!0}function PI(t){const e=BV(),n=t[On];Lr.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function BV(){const t=Lr.lFrame,e=null===t?null:t.child;return null===e?HR(t):e}function HR(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function $R(){const t=Lr.lFrame;return Lr.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const qR=$R;function RI(){const t=$R();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function jl(){return Lr.lFrame.selectedIndex}function Sm(t){Lr.lFrame.selectedIndex=t}function Ds(){const t=Lr.lFrame;return Zb(t.tView,t.selectedIndex)}function vc(){Lr.lFrame.currentNamespace=AV}let jV=!0;function kv(){return jV}function Ud(t){jV=t}function Jb(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const c=t.data[n].type.prototype,{ngAfterContentInit:f,ngAfterContentChecked:v,ngAfterViewInit:b,ngAfterViewChecked:S,ngOnDestroy:k}=c;f&&(t.contentHooks??=[]).push(-n,f),v&&((t.contentHooks??=[]).push(n,v),(t.contentCheckHooks??=[]).push(n,v)),b&&(t.viewHooks??=[]).push(-n,b),S&&((t.viewHooks??=[]).push(n,S),(t.viewCheckHooks??=[]).push(n,S)),null!=k&&(t.destroyHooks??=[]).push(n,k)}}function e1(t,e,n){YR(t,e,3,n)}function t1(t,e,n,r){(3&t[Zr])===n&&YR(t,e,n,r)}function n1(t,e){let n=t[Zr];(3&n)===e&&(n&=8191,n+=1,t[Zr]=n)}function YR(t,e,n,r){const c=r??-1,f=e.length-1;let v=0;for(let b=void 0!==r?65535&t[ny]:0;b<f;b++)if("number"==typeof e[b+1]){if(v=e[b],null!=r&&v>=r)break}else e[b]<0&&(t[ny]+=65536),(v<c||-1==c)&&(HV(t,n,e,b),t[ny]=(4294901760&t[ny])+b+2),b++}function r1(t,e){Vd(4,t,e);const n=Iu(null);try{e.call(t)}finally{Iu(n),Vd(5,t,e)}}function HV(t,e,n,r){const s=n[r]<0,c=n[r+1],v=t[s?-n[r]:n[r]];s?t[Zr]>>13<t[ny]>>16&&(3&t[Zr])===e&&(t[Zr]+=8192,r1(v,c)):r1(v,c)}const uy=-1;class Ov{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function kI(t){return t!==uy}function Nv(t){return 32767&t}function Lv(t,e){let n=function $V(t){return t>>16}(t),r=e;for(;n>0;)r=r[ty],n--;return r}let QR=!0;function s1(t){const e=QR;return QR=t,e}const OI=255,XR=5;let uH=0;const Qh={};function NI(t,e){const n=eM(t,e);if(-1!==n)return n;const r=e[On];r.firstCreatePass&&(t.injectorIndex=e.length,LI(r.data,t),LI(e,null),LI(r.blueprint,null));const s=a1(t,e),c=t.injectorIndex;if(kI(s)){const f=Nv(s),v=Lv(s,e),b=v[On].data;for(let S=0;S<8;S++)e[c+S]=v[f+S]|b[f+S]}return e[c+8]=s,c}function LI(t,e){t.push(0,0,0,0,0,0,0,0,e)}function eM(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function a1(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,s=e;for(;null!==s;){if(r=aM(s),null===r)return uy;if(n++,s=s[ty],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return uy}function FI(t,e,n){!function JR(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(wv)&&(r=n[wv]),null==r&&(r=n[wv]=uH++);const s=r&OI;e.data[t+(s>>XR)]|=1<<s}(t,e,n)}function nM(t,e,n){if(n&mi.Optional||void 0!==t)return t;ef()}function rM(t,e,n,r){if(n&mi.Optional&&void 0===r&&(r=null),!(n&(mi.Self|mi.Host))){const s=t[rf],c=gc(void 0);try{return s?s.get(e,r,n&mi.Optional):lh(e,r,n&mi.Optional)}finally{gc(c)}}return nM(r,0,n)}function iM(t,e,n,r=mi.Default,s){if(null!==t){if(2048&e[Zr]&&!(r&mi.Self)){const f=function YV(t,e,n,r,s){let c=t,f=e;for(;null!==c&&null!==f&&2048&f[Zr]&&!(512&f[Zr]);){const v=oM(c,f,n,r|mi.Self,Qh);if(v!==Qh)return v;let b=c.parent;if(!b){const S=f[vR];if(S){const k=S.get(n,Qh,r);if(k!==Qh)return k}b=aM(f),f=f[ty]}c=b}return s}(t,e,n,r,Qh);if(f!==Qh)return f}const c=oM(t,e,n,r,Qh);if(c!==Qh)return c}return rM(e,n,r,s)}function oM(t,e,n,r,s){const c=function GV(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(wv)?t[wv]:void 0;return"number"==typeof e?e>=0?e&OI:hH:e}(n);if("function"==typeof c){if(!jR(e,t,r))return r&mi.Host?nM(s,0,r):rM(e,n,r,s);try{let f;if(f=c(r),null!=f||r&mi.Optional)return f;ef()}finally{qR()}}else if("number"==typeof c){let f=null,v=eM(t,e),b=uy,S=r&mi.Host?e[vs][fl]:null;for((-1===v||r&mi.SkipSelf)&&(b=-1===v?a1(t,e):e[v+8],b!==uy&&KV(r,!1)?(f=e[On],v=Nv(b),e=Lv(b,e)):v=-1);-1!==v;){const k=e[On];if(sM(c,v,k.data)){const F=qV(v,e,n,f,r,S);if(F!==Qh)return F}b=e[v+8],b!==uy&&KV(r,e[On].data[v+8]===S)&&sM(c,v,e)?(f=k,v=Nv(b),e=Lv(b,e)):v=-1}}return s}function qV(t,e,n,r,s,c){const f=e[On],v=f.data[t+8],k=VI(v,f,n,null==r?xm(v)&&QR:r!=f&&0!=(3&v.type),s&mi.Host&&c===v);return null!==k?hy(e,f,k,v):Qh}function VI(t,e,n,r,s){const c=t.providerIndexes,f=e.data,v=1048575&c,b=t.directiveStart,k=c>>20,H=s?v+k:t.directiveEnd;for(let Q=r?v:v+k;Q<H;Q++){const de=f[Q];if(Q<b&&n===de||Q>=b&&de.type===n)return Q}if(s){const Q=f[b];if(Q&&dh(Q)&&Q.type===n)return b}return null}function hy(t,e,n,r){let s=t[n];const c=e.data;if(function sH(t){return t instanceof Ov}(s)){const f=s;f.resolving&&function FF(t,e){const n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new Gt(-200,`Circular dependency in DI detected for ${t}${n}`)}(function $i(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():jr(t)}(c[n]));const v=s1(f.canSeeViewProviders);f.resolving=!0;const S=f.injectImpl?gc(f.injectImpl):null;jR(t,r,mi.Default);try{s=t[n]=f.factory(void 0,c,t,r),e.firstCreatePass&&n>=r.directiveStart&&function oH(t,e,n){const{ngOnChanges:r,ngOnInit:s,ngDoCheck:c}=e.type.prototype;if(r){const f=TV(e);(n.preOrderHooks??=[]).push(t,f),(n.preOrderCheckHooks??=[]).push(t,f)}s&&(n.preOrderHooks??=[]).push(0-t,s),c&&((n.preOrderHooks??=[]).push(t,c),(n.preOrderCheckHooks??=[]).push(t,c))}(n,c[n],e)}finally{null!==S&&gc(S),s1(v),f.resolving=!1,qR()}}return s}function sM(t,e,n){return!!(n[e+(t>>XR)]&1<<t)}function KV(t,e){return!(t&mi.Self||t&mi.Host&&e)}class Hl{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return iM(this._tNode,this._lView,e,Ld(r),n)}}function hH(){return new Hl(Xa(),Bt())}function BI(t){return GC(t)?()=>{const e=BI(Vr(t));return e&&e()}:Tm(t)}function aM(t){const e=t[On],n=e.type;return 2===n?e.declTNode:1===n?t[fl]:null}const Fv="__parameters__";function df(t,e,n){return uh(()=>{const r=function Bv(t){return function(...n){if(t){const r=t(...n);for(const s in r)this[s]=r[s]}}}(e);function s(...c){if(this instanceof s)return r.apply(this,c),this;const f=new s(...c);return v.annotation=f,v;function v(b,S,k){const F=b.hasOwnProperty(Fv)?b[Fv]:Object.defineProperty(b,Fv,{value:[]})[Fv];for(;F.length<=k;)F.push(null);return(F[k]=F[k]||[]).push(f),b}}return n&&(s.prototype=Object.create(n.prototype)),s.prototype.ngMetadataName=t,s.annotationCls=s,s})}function py(t,e){t.forEach(n=>Array.isArray(n)?py(n,e):e(n))}function cM(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Co(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function pf(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}function qc(t,e,n){let r=ff(t,e);return r>=0?t[1|r]=n:(r=~r,function uM(t,e,n,r){let s=t.length;if(s==e)t.push(n,r);else if(1===s)t.push(r,t[0]),t[0]=n;else{for(s--,t.push(t[s-1],t[s]);s>e;)t[s]=t[s-2],s--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function c1(t,e){const n=ff(t,e);if(n>=0)return t[1|n]}function ff(t,e){return function hM(t,e,n){let r=0,s=t.length>>n;for(;s!==r;){const c=r+(s-r>>1),f=t[c<<n];if(e===f)return c<<n;f>e?s=c:r=c+1}return~(s<<n)}(t,e,1)}const zd=Vb(df("Optional"),8),jd=Vb(df("SkipSelf"),4);function Hv(t){return 128==(128&t.flags)}var Hd=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Hd||{});const T3=/^>|^->|<!--|-->|--!>|<!-$/g,C3=/(<|>)/g,I3="\u200b$1\u200b";const gy=new Map;let xH=0;const KI="__ngContext__";function ir(t,e){Bl(e)?(t[KI]=e[ry],function S3(t){gy.set(t[ry],t)}(e)):t[KI]=e}let ZI;function Ja(t,e){return ZI(t,e)}function yy(t){const e=t[As];return Ul(e)?e[As]:e}function QI(t){return el(t[Ev])}function XI(t){return el(t[Cu])}function el(t){for(;null!==t&&!Ul(t);)t=t[Cu];return t}function _y(t,e,n,r,s){if(null!=r){let c,f=!1;Ul(r)?c=r:Bl(r)&&(f=!0,r=r[Bo]);const v=Qo(r);0===t&&null!==n?null==s?xe(e,n,v):te(e,n,v,s||null,!0):1===t&&null!==n?te(e,n,v,s||null,!0):2===t?function Rm(t,e,n){const r=at(t,e);r&&function nt(t,e,n,r){t.removeChild(e,n,r)}(t,r,e,n)}(e,v,f):3===t&&e.destroyNode(v),null!=c&&function VY(t,e,n,r,s){const c=n[Wh];c!==Qo(n)&&_y(e,t,r,c,s);for(let v=Za;v<n.length;v++){const b=n[v];LM(b[On],b,t,e,r,c)}}(e,t,c,n,s)}}function v1(t,e){return t.createComment(function qI(t){return t.replace(T3,e=>e.replace(C3,I3))}(e))}function w1(t,e,n){return t.createElement(e,n)}function NM(t,e){const n=t[iy],r=n.indexOf(e);Pv(e),n.splice(r,1)}function E1(t,e){if(t.length<=Za)return;const n=Za+e,r=t[n];if(r){const s=r[xv];null!==s&&s!==t&&NM(s,r),e>0&&(t[n-1][Cu]=r[Cu]);const c=Co(t,Za+e);!function qv(t,e){LM(t,e,e[Hr],2,null,null),e[Bo]=null,e[fl]=null}(r[On],r);const f=c[Kh];null!==f&&f.detachView(c[On]),r[As]=null,r[Cu]=null,r[Zr]&=-129}return r}function eS(t,e){if(!(256&e[Zr])){const n=e[Hr];e[Tv]&&IR(e[Tv]),e[qb]&&IR(e[qb]),n.destroyNode&&LM(t,e,n,3,null,null),function k3(t){let e=t[Ev];if(!e)return tS(t[On],t);for(;e;){let n=null;if(Bl(e))n=e[Ev];else{const r=e[Za];r&&(n=r)}if(!n){for(;e&&!e[Cu]&&e!==t;)Bl(e)&&tS(e[On],e),e=e[As];null===e&&(e=t),Bl(e)&&tS(e[On],e),n=e&&e[Cu]}e=n}}(e)}}function tS(t,e){if(!(256&e[Zr])){e[Zr]&=-129,e[Zr]|=256,function j(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const s=e[n[r]];if(!(s instanceof Ov)){const c=n[r+1];if(Array.isArray(c))for(let f=0;f<c.length;f+=2){const v=s[c[f]],b=c[f+1];Vd(4,v,b);try{b.call(v)}finally{Vd(5,v,b)}}else{Vd(4,s,c);try{c.call(s)}finally{Vd(5,s,c)}}}}}(t,e),function N3(t,e){const n=t.cleanup,r=e[bm];if(null!==n)for(let c=0;c<n.length-1;c+=2)if("string"==typeof n[c]){const f=n[c+3];f>=0?r[f]():r[-f].unsubscribe(),c+=2}else n[c].call(r[n[c+1]]);null!==r&&(e[bm]=null);const s=e[Fd];if(null!==s){e[Fd]=null;for(let c=0;c<s.length;c++)(0,s[c])()}}(t,e),1===e[On].type&&e[Hr].destroy();const n=e[xv];if(null!==n&&Ul(e[As])){n!==e[As]&&NM(n,e);const r=e[Kh];null!==r&&r.detachView(t)}!function A3(t){gy.delete(t[ry])}(e)}}function G(t,e,n){return function Z(t,e,n){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return n[Bo];{const{componentOffset:s}=r;if(s>-1){const{encapsulation:c}=t.data[r.directiveStart+s];if(c===xu.None||c===xu.Emulated)return null}return _c(r,n)}}(t,e.parent,n)}function te(t,e,n,r,s){t.insertBefore(e,n,r,s)}function xe(t,e,n){t.appendChild(e,n)}function Te(t,e,n,r,s){null!==r?te(t,e,n,r,s):xe(t,e,n)}function at(t,e){return t.parentNode(e)}function Er(t,e,n){return yo(t,e,n)}let zo,FM,V3,nS,yo=function Qr(t,e,n){return 40&t.type?_c(t,n):null};function Gc(t,e,n,r){const s=G(t,r,e),c=e[Hr],v=Er(r.parent||e[fl],r,e);if(null!=s)if(Array.isArray(n))for(let b=0;b<n.length;b++)Te(c,s,n[b],v,!1);else Te(c,s,n,v,!1);void 0!==zo&&zo(c,r,e,n,s)}function Ki(t,e){if(null!==e){const n=e.type;if(3&n)return _c(e,t);if(4&n)return x1(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return Ki(t,r);{const s=t[e.index];return Ul(s)?x1(-1,s):Qo(s)}}if(32&n)return Ja(e,t)()||Qo(t[e.index]);{const r=ph(t,e);return null!==r?Array.isArray(r)?r[0]:Ki(yy(t[vs]),r):Ki(t,e.next)}}return null}function ph(t,e){return null!==e?t[vs][fl].projection[e.projection]:null}function x1(t,e){const n=Za+t+1;if(n<e.length){const r=e[n],s=r[On].firstChild;if(null!==s)return Ki(r,s)}return e[Wh]}function L3(t,e,n,r,s,c,f){for(;null!=n;){const v=r[n.index],b=n.type;if(f&&0===e&&(v&&ir(Qo(v),r),n.flags|=2),32!=(32&n.flags))if(8&b)L3(t,e,n.child,r,s,c,!1),_y(e,t,s,v,c);else if(32&b){const S=Ja(n,r);let k;for(;k=S();)_y(e,t,s,k,c);_y(e,t,s,v,c)}else 16&b?IH(t,e,r,n,s,c):_y(e,t,s,v,c);n=f?n.projectionNext:n.next}}function LM(t,e,n,r,s,c){L3(n,r,t.firstChild,e,s,c,!1)}function IH(t,e,n,r,s,c){const f=n[vs],b=f[fl].projection[r.projection];if(Array.isArray(b))for(let S=0;S<b.length;S++)_y(e,t,s,b[S],c);else{let S=b;const k=f[As];Hv(r)&&(S.flags|=128),L3(t,e,S,k,s,c,!0)}}function SH(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function AH(t,e,n){const{mergedAttrs:r,classes:s,styles:c}=n;null!==r&&rI(t,e,r),null!==s&&SH(t,e,s),null!==c&&function UY(t,e,n){t.setAttribute(e,"style",n)}(t,e,c)}function T1(t){return function F3(){if(void 0===FM&&(FM=null,Zo.trustedTypes))try{FM=Zo.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return FM}()?.createHTML(t)||t}function C1(){if(void 0!==V3)return V3;if(typeof document<"u")return document;throw new Gt(210,!1)}function $Y(t){return function VM(){if(void 0===nS&&(nS=null,Zo.trustedTypes))try{nS=Zo.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return nS}()?.createHTML(t)||t}class MH{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${nR})`}}function wy(t){return t instanceof MH?t.changingThisBreaksApplicationSecurity:t}class NH{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const n=(new window.DOMParser).parseFromString(T1(e),"text/html").body;return null===n?this.inertDocumentHelper.getInertBodyElement(e):(n.removeChild(n.firstChild),n)}catch{return null}}}class YY{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const n=this.inertDocument.createElement("template");return n.innerHTML=T1(e),n}}const Goe=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function B3(t){return(t=String(t)).match(Goe)?t:"unsafe:"+t}function Mm(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function rS(...t){const e={};for(const n of t)for(const r in n)n.hasOwnProperty(r)&&(e[r]=!0);return e}const LH=Mm("area,br,col,hr,img,wbr"),FH=Mm("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),VH=Mm("rp,rt"),U3=rS(LH,rS(FH,Mm("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),rS(VH,Mm("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),rS(VH,FH)),BM=Mm("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),BH=rS(BM,Mm("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Mm("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),UH=Mm("script,style,template");class XY{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let n=e.firstChild,r=!0;for(;n;)if(n.nodeType===Node.ELEMENT_NODE?r=this.startElement(n):n.nodeType===Node.TEXT_NODE?this.chars(n.nodeValue):this.sanitizedSomething=!0,r&&n.firstChild)n=n.firstChild;else for(;n;){n.nodeType===Node.ELEMENT_NODE&&this.endElement(n);let s=this.checkClobberedElement(n,n.nextSibling);if(s){n=s;break}n=this.checkClobberedElement(n,n.parentNode)}return this.buf.join("")}startElement(e){const n=e.nodeName.toLowerCase();if(!U3.hasOwnProperty(n))return this.sanitizedSomething=!0,!UH.hasOwnProperty(n);this.buf.push("<"),this.buf.push(n);const r=e.attributes;for(let s=0;s<r.length;s++){const c=r.item(s),f=c.name,v=f.toLowerCase();if(!BH.hasOwnProperty(v)){this.sanitizedSomething=!0;continue}let b=c.value;BM[v]&&(b=B3(b)),this.buf.push(" ",f,'="',tZ(b),'"')}return this.buf.push(">"),!0}endElement(e){const n=e.nodeName.toLowerCase();U3.hasOwnProperty(n)&&!LH.hasOwnProperty(n)&&(this.buf.push("</"),this.buf.push(n),this.buf.push(">"))}chars(e){this.buf.push(tZ(e))}checkClobberedElement(e,n){if(n&&(e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return n}}const JY=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,eZ=/([^\#-~ |!])/g;function tZ(t){return t.replace(/&/g,"&amp;").replace(JY,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(eZ,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let UM;function jH(t){return"content"in t&&function nZ(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var S1=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(S1||{});function HH(t){const e=function iS(){const t=Bt();return t&&t[ey].sanitizer}();return e?$Y(e.sanitize(S1.HTML,t)||""):function I1(t,e){const n=function kH(t){return t instanceof MH&&t.getTypeName()||null}(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${nR})`)}return n===e}(t,"HTML")?$Y(wy(t)):function zH(t,e){let n=null;try{UM=UM||function OH(t){const e=new YY(t);return function ZY(){try{return!!(new window.DOMParser).parseFromString(T1(""),"text/html")}catch{return!1}}()?new NH(e):e}(t);let r=e?String(e):"";n=UM.getInertBodyElement(r);let s=5,c=r;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,r=c,c=n.innerHTML,n=UM.getInertBodyElement(r)}while(r!==c);return T1((new XY).sanitizeChildren(jH(n)||n))}finally{if(n){const r=jH(n)||n;for(;r.firstChild;)r.removeChild(r.firstChild)}}}(C1(),jr(t))}const oS=new Xn("ENVIRONMENT_INITIALIZER"),sZ=new Xn("INJECTOR",-1),GH=new Xn("INJECTOR_DEF_TYPES");class z3{get(e,n=Xg){if(n===Xg){const r=new Error(`NullInjectorError: No provider for ${_a(e)}!`);throw r.name="NullInjectorError",r}return n}}function aZ(...t){return{\u0275providers:WH(0,t),\u0275fromNgModule:!0}}function WH(t,...e){const n=[],r=new Set;let s;const c=f=>{n.push(f)};return py(e,f=>{const v=f;zM(v,c,[],r)&&(s||=[],s.push(v))}),void 0!==s&&lZ(s,c),n}function lZ(t,e){for(let n=0;n<t.length;n++){const{ngModule:r,providers:s}=t[n];j3(s,c=>{e(c,r)})}}function zM(t,e,n,r){if(!(t=Vr(t)))return!1;let s=null,c=kb(t);const f=!c&&qi(t);if(c||f){if(f&&!f.standalone)return!1;s=t}else{const b=t.ngModule;if(c=kb(b),!c)return!1;s=b}const v=r.has(s);if(f){if(v)return!1;if(r.add(s),f.dependencies){const b="function"==typeof f.dependencies?f.dependencies():f.dependencies;for(const S of b)zM(S,e,n,r)}}else{if(!c)return!1;{if(null!=c.imports&&!v){let S;r.add(s);try{py(c.imports,k=>{zM(k,e,n,r)&&(S||=[],S.push(k))})}finally{}void 0!==S&&lZ(S,e)}if(!v){const S=Tm(s)||(()=>new s);e({provide:s,useFactory:S,deps:Xi},s),e({provide:GH,useValue:s,multi:!0},s),e({provide:oS,useValue:()=>hr(s),multi:!0},s)}const b=c.providers;if(null!=b&&!v){const S=t;j3(b,k=>{e(k,S)})}}}return s!==t&&void 0!==t.providers}function j3(t,e){for(let n of t)tR(n)&&(n=n.\u0275providers),Array.isArray(n)?j3(n,e):e(n)}const nse=oi({provide:String,useValue:oi});function H3(t){return null!==t&&"object"==typeof t&&nse in t}function A1(t){return"function"==typeof t}const $3=new Xn("Set Injector scope."),jM={},uZ={};let q3;function HM(){return void 0===q3&&(q3=new z3),q3}class Au{}class D1 extends Au{get destroyed(){return this._destroyed}constructor(e,n,r,s){super(),this.parent=n,this.source=r,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,K3(e,f=>this.processProvider(f)),this.records.set(sZ,P1(void 0,this)),s.has("environment")&&this.records.set(Au,P1(void 0,this));const c=this.records.get($3);null!=c&&"string"==typeof c.value&&this.scopes.add(c.value),this.injectorDefTypes=new Set(this.get(GH.multi,Xi,mi.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const n=tf(this),r=gc(void 0);try{return e()}finally{tf(n),gc(r)}}get(e,n=Xg,r=mi.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(uR))return e[uR](this);r=Ld(r);const c=tf(this),f=gc(void 0);try{if(!(r&mi.SkipSelf)){let b=this.records.get(e);if(void 0===b){const S=function JH(t){return"function"==typeof t||"object"==typeof t&&t instanceof Xn}(e)&&Mb(e);b=S&&this.injectableDefInScope(S)?P1(G3(e),jM):null,this.records.set(e,b)}if(null!=b)return this.hydrate(e,b)}return(r&mi.Self?HM():this.parent).get(e,n=r&mi.Optional&&n===Xg?null:n)}catch(v){if("NullInjectorError"===v.name){if((v[Lb]=v[Lb]||[]).unshift(_a(e)),c)throw v;return function Oj(t,e,n,r){const s=t[Lb];throw e[tI]&&s.unshift(e[tI]),t.message=function cR(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let s=_a(e);if(Array.isArray(e))s=e.map(_a).join(" -> ");else if("object"==typeof e){let c=[];for(let f in e)if(e.hasOwnProperty(f)){let v=e[f];c.push(f+":"+("string"==typeof v?JSON.stringify(v):_a(v)))}s=`{${c.join(", ")}}`}return`${n}${r?"("+r+")":""}[${s}]: ${t.replace($F,"\n  ")}`}("\n"+t.message,s,n,r),t.ngTokenPath=s,t[Lb]=null,t}(v,e,"R3InjectorError",this.source)}throw v}finally{gc(f),tf(c)}}resolveInjectorInitializers(){const e=tf(this),n=gc(void 0);try{const s=this.get(oS.multi,Xi,mi.Self);for(const c of s)c()}finally{tf(e),gc(n)}}toString(){const e=[],n=this.records;for(const r of n.keys())e.push(_a(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Gt(205,!1)}processProvider(e){let n=A1(e=Vr(e))?e:Vr(e&&e.provide);const r=function hZ(t){return H3(t)?P1(void 0,t.useValue):P1(QH(t),jM)}(e);if(A1(e)||!0!==e.multi)this.records.get(n);else{let s=this.records.get(n);s||(s=P1(void 0,jM,!0),s.factory=()=>_v(s.multi),this.records.set(n,s)),n=e,s.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===jM&&(n.value=uZ,n.value=n.factory()),"object"==typeof n.value&&n.value&&function dZ(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=Vr(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){const n=this._onDestroyHooks.indexOf(e);-1!==n&&this._onDestroyHooks.splice(n,1)}}function G3(t){const e=Mb(t),n=null!==e?e.factory:Tm(t);if(null!==n)return n;if(t instanceof Xn)throw new Gt(204,!1);if(t instanceof Function)return function $M(t){const e=t.length;if(e>0)throw pf(e,"?"),new Gt(204,!1);const n=function zF(t){return t&&(t[Ob]||t[wm])||null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Gt(204,!1)}function QH(t,e,n){let r;if(A1(t)){const s=Vr(t);return Tm(s)||G3(s)}if(H3(t))r=()=>Vr(t.useValue);else if(function YH(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(..._v(t.deps||[]));else if(function cZ(t){return!(!t||!t.useExisting)}(t))r=()=>hr(Vr(t.useExisting));else{const s=Vr(t&&(t.useClass||t.provide));if(!function XH(t){return!!t.deps}(t))return Tm(s)||G3(s);r=()=>new s(..._v(t.deps))}return r}function P1(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function K3(t,e){for(const n of t)Array.isArray(n)?K3(n,e):n&&tR(n)?K3(n.\u0275providers,e):e(n)}const qM=new Xn("AppId",{providedIn:"root",factory:()=>pZ}),pZ="ng",fZ=new Xn("Platform Initializer"),R1=new Xn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),e$=new Xn("CSP nonce",{providedIn:"root",factory:()=>C1().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let i$=(t,e,n)=>null;function e4(t,e,n=!1){return i$(t,e,n)}class EZ{}class a${}class xZ{resolveComponentFactory(e){throw function l$(t){const e=Error(`No component factory found for ${_a(t)}.`);return e.ngComponent=t,e}(e)}}let aS=(()=>{class t{static#e=this.NULL=new xZ}return t})();function TZ(){return O1(Xa(),Bt())}function O1(t,e){return new yl(_c(t,e))}let yl=(()=>{class t{constructor(n){this.nativeElement=n}static#e=this.__NG_ELEMENT_ID__=TZ}return t})();function CZ(t){return t instanceof yl?t.nativeElement:t}class IZ{}let Kc=(()=>{class t{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function SZ(){const t=Bt(),n=Ma(Xa().index,t);return(Bl(n)?n:t)[Hr]}()}return t})(),AZ=(()=>{class t{static#e=this.\u0275prov=jn({token:t,providedIn:"root",factory:()=>null})}return t})();class lS{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const c$=new lS("16.2.12"),JM={};function o4(t,e=null,n=null,r){const s=s4(t,e,n,r);return s.resolveInjectorInitializers(),s}function s4(t,e=null,n=null,r,s=new Set){const c=[n||Xi,aZ(t)];return r=r||("object"==typeof t?void 0:_a(t)),new D1(c,e||HM(),r||null,s)}let fh=(()=>{class t{static#e=this.THROW_IF_NOT_FOUND=Xg;static#t=this.NULL=new z3;static create(n,r){if(Array.isArray(n))return o4({name:""},r,n,"");{const s=n.name??"";return o4({name:s},n.parent,n.providers,s)}}static#n=this.\u0275prov=jn({token:t,providedIn:"any",factory:()=>hr(sZ)});static#r=this.__NG_ELEMENT_ID__=-1}return t})();function Jo(t){return t.ngOriginalError}class si{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Jo(e);for(;n&&Jo(n);)n=Jo(n);return n||null}}function Gl(t){return e=>{setTimeout(t,void 0,e)}}const Rr=class hse extends bu{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let s=e,c=n||(()=>null),f=r;if(e&&"object"==typeof e){const b=e;s=b.next?.bind(b),c=b.error?.bind(b),f=b.complete?.bind(b)}this.__isAsync&&(c=Gl(c),s&&(s=Gl(s)),f&&(f=Gl(f)));const v=super.subscribe({next:s,error:c,complete:f});return e instanceof aa&&e.add(v),v}};function f$(...t){}class Ji{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Rr(!1),this.onMicrotaskEmpty=new Rr(!1),this.onStable=new Rr(!1),this.onError=new Rr(!1),typeof Zone>"u")throw new Gt(908,!1);Zone.assertZonePatched();const s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&n,s.shouldCoalesceRunChangeDetection=r,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function _l(){const t="function"==typeof Zo.requestAnimationFrame;let e=Zo[t?"requestAnimationFrame":"setTimeout"],n=Zo[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);const s=n[Zone.__symbol__("OriginalDelegate")];s&&(n=s)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function m$(t){const e=()=>{!function kZ(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Zo,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,e2(t),t.isCheckStableRunning=!0,N1(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),e2(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,s,c,f,v)=>{if(function l4(t){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0].data?.__ignore_ng_zone__}(v))return n.invokeTask(s,c,f,v);try{return L1(t),n.invokeTask(s,c,f,v)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===c.type||t.shouldCoalesceRunChangeDetection)&&e(),vl(t)}},onInvoke:(n,r,s,c,f,v,b)=>{try{return L1(t),n.invoke(s,c,f,v,b)}finally{t.shouldCoalesceRunChangeDetection&&e(),vl(t)}},onHasTask:(n,r,s,c)=>{n.hasTask(s,c),r===s&&("microTask"==c.change?(t._hasPendingMicrotasks=c.microTask,e2(t),N1(t)):"macroTask"==c.change&&(t.hasPendingMacrotasks=c.macroTask))},onHandleError:(n,r,s,c)=>(n.handleError(s,c),t.runOutsideAngular(()=>t.onError.emit(c)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ji.isInAngularZone())throw new Gt(909,!1)}static assertNotInAngularZone(){if(Ji.isInAngularZone())throw new Gt(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,s){const c=this._inner,f=c.scheduleEventTask("NgZoneEvent: "+s,e,MZ,f$,f$);try{return c.runTask(f,n,r)}finally{c.cancelTask(f)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const MZ={};function N1(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function e2(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function L1(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function vl(t){t._nesting--,N1(t)}class uS{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Rr,this.onMicrotaskEmpty=new Rr,this.onStable=new Rr,this.onError=new Rr}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,s){return e.apply(n,r)}}const t2=new Xn("",{providedIn:"root",factory:a4});function a4(){const t=Kn(Ji);let e=!0;return function Vo(...t){const e=ym(t),n=function WP(t,e){return"number"==typeof Sb(t)?t.pop():e}(t,1/0),r=t;return r.length?1===r.length?Wa(r[0]):gm(n)(ki(r,e)):sh}(new ls(s=>{e=t.isStable&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks,t.runOutsideAngular(()=>{s.next(e),s.complete()})}),new ls(s=>{let c;t.runOutsideAngular(()=>{c=t.onStable.subscribe(()=>{Ji.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks&&(e=!0,s.next(!0))})})});const f=t.onUnstable.subscribe(()=>{Ji.assertInAngularZone(),e&&(e=!1,t.runOutsideAngular(()=>{s.next(!1)}))});return()=>{c.unsubscribe(),f.unsubscribe()}}).pipe(XP()))}function gf(t){return t instanceof Function?t():t}let u4=(()=>{class t{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=jn({token:t,providedIn:"root",factory:()=>new t})}return t})();function mh(t){for(;t;){t[Zr]|=64;const e=yy(t);if(wR(t)&&!e)return t;t=e}return null}const Yc=new Xn("",{providedIn:"root",factory:()=>!1});let F1=null;function ba(t,e){return t[e]??r2()}function Qs(t,e){const n=r2();n.producerNode?.length&&(t[e]=F1,n.lView=t,F1=C$())}const T$={...Yh,consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{mh(t.lView)},lView:null};function C$(){return Object.create(T$)}function r2(){return F1??=C$(),F1}const Ur={};function fn(t){m4(Gi(),Bt(),jl()+t,!1)}function m4(t,e,n,r){if(!r)if(3==(3&e[Zr])){const c=t.preOrderCheckHooks;null!==c&&e1(e,c,n)}else{const c=t.preOrderHooks;null!==c&&t1(e,c,0,n)}Sm(n)}function vt(t,e=mi.Default){const n=Bt();return null===n?hr(t,e):iM(Xa(),n,Vr(t),e)}function hS(t,e,n,r,s,c,f,v,b,S,k){const F=e.blueprint.slice();return F[Bo]=s,F[Zr]=140|r,(null!==S||t&&2048&t[Zr])&&(F[Zr]|=2048),Qb(F),F[As]=F[ty]=t,F[Ys]=n,F[ey]=f||t&&t[ey],F[Hr]=v||t&&t[Hr],F[rf]=b||t&&t[rf]||null,F[fl]=c,F[ry]=function GI(){return xH++}(),F[Em]=k,F[vR]=S,F[vs]=2==e.type?t[vs]:F,F}function V1(t,e,n,r,s){let c=t.data[e];if(null===c)c=function o2(t,e,n,r,s){const c=FR(),f=CI(),b=t.data[e]=function a2(t,e,n,r,s,c){let f=e?e.injectorIndex:-1,v=0;return cy()&&(v|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:f,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:v,providerIndexes:0,value:s,attrs:c,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,f?c:c&&c.parent,n,e,r,s);return null===t.firstChild&&(t.firstChild=b),null!==c&&(f?null==c.child&&null!==b.parent&&(c.child=b):null===c.next&&(c.next=b,b.prev=c)),b}(t,e,n,r,s),function NV(){return Lr.lFrame.inI18n}()&&(c.flags|=32);else if(64&c.type){c.type=n,c.value=r,c.attrs=s;const f=function Rv(){const t=Lr.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();c.injectorIndex=null===f?-1:f.injectorIndex}return Bd(c,!0),c}function dS(t,e,n,r){if(0===n)return-1;const s=e.length;for(let c=0;c<n;c++)e.push(r),t.blueprint.push(r),t.data.push(null);return s}function S$(t,e,n,r,s){const c=ba(e,Tv),f=jl(),v=2&r;try{Sm(-1),v&&e.length>Oi&&m4(t,e,Oi,!1),Vd(v?2:0,s);const S=v?c:null,k=Kb(S);try{null!==S&&(S.dirty=!1),n(r,s)}finally{mI(S,k)}}finally{v&&null===e[Tv]&&Qs(e,Tv),Sm(f),Vd(v?3:1,s)}}function pS(t,e,n){if(cI(e)){const r=Iu(null);try{const c=e.directiveEnd;for(let f=e.directiveStart;f<c;f++){const v=t.data[f];v.contentQueries&&v.contentQueries(1,n[f],f)}}finally{Iu(r)}}}function g4(t,e,n){ly()&&(function zZ(t,e,n,r){const s=n.directiveStart,c=n.directiveEnd;xm(n)&&function qZ(t,e,n){const r=_c(e,t),s=A$(n);let f=16;n.signals?f=4096:n.onPush&&(f=64);const v=l2(t,hS(t,s,null,f,r,e,null,t[ey].rendererFactory.createRenderer(r,n),null,null,null));t[e.index]=v}(e,n,t.data[s+n.componentOffset]),t.firstCreatePass||NI(n,e),ir(r,e);const f=n.initialInputs;for(let v=s;v<c;v++){const b=t.data[v],S=hy(e,t,v,n);ir(S,e),null!==f&&GZ(0,v-s,S,b,0,f),dh(b)&&(Ma(n.index,e)[Ys]=hy(e,t,v,n))}}(t,e,n,_c(n,e)),64==(64&n.flags)&&k$(t,e,n))}function fS(t,e,n=_c){const r=e.localNames;if(null!==r){let s=e.index+1;for(let c=0;c<r.length;c+=2){const f=r[c+1],v=-1===f?n(e,t):t[f];t[s++]=v}}}function A$(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=km(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function km(t,e,n,r,s,c,f,v,b,S,k){const F=Oi+r,H=F+s,Q=function Zc(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:Ur);return n}(F,H),de="function"==typeof S?S():S;return Q[On]={type:t,blueprint:Q,template:n,queries:null,viewQuery:v,declTNode:e,data:Q.slice().fill(null,F),bindingStartIndex:F,expandoStartIndex:H,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof c?c():c,pipeRegistry:"function"==typeof f?f():f,firstChild:null,schemas:b,consts:de,incompleteFirstPass:!1,ssrId:k}}let P$=t=>null;function R$(t,e,n,r){for(let s in t)if(t.hasOwnProperty(s)){n=null===n?{}:n;const c=t[s];null===r?y4(n,e,s,c):r.hasOwnProperty(s)&&y4(n,e,r[s],c)}return n}function y4(t,e,n,r){t.hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}function _4(t,e,n,r){if(ly()){const s=null===r?null:{"":-1},c=function v4(t,e){const n=t.directiveRegistry;let r=null,s=null;if(n)for(let c=0;c<n.length;c++){const f=n[c];if(nf(e,f.selectors,!1))if(r||(r=[]),dh(f))if(null!==f.findHostDirectiveDefs){const v=[];s=s||new Map,f.findHostDirectiveDefs(f,v,s),r.unshift(...v,f),w4(t,e,v.length)}else r.unshift(f),w4(t,e,0);else s=s||new Map,f.findHostDirectiveDefs?.(f,r,s),r.push(f)}return null===r?null:[r,s]}(t,n);let f,v;null===c?f=v=null:[f,v]=c,null!==f&&M$(t,e,n,f,s,v),s&&function jZ(t,e,n){if(e){const r=t.localNames=[];for(let s=0;s<e.length;s+=2){const c=n[e[s+1]];if(null==c)throw new Gt(-301,!1);r.push(e[s],c)}}}(n,r,s)}n.mergedAttrs=bv(n.mergedAttrs,n.attrs)}function M$(t,e,n,r,s,c){for(let S=0;S<r.length;S++)FI(NI(n,e),t,r[S].type);!function b4(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}(n,t.data.length,r.length);for(let S=0;S<r.length;S++){const k=r[S];k.providersResolver&&k.providersResolver(k)}let f=!1,v=!1,b=dS(t,e,r.length,null);for(let S=0;S<r.length;S++){const k=r[S];n.mergedAttrs=bv(n.mergedAttrs,k.hostAttrs),$Z(t,n,e,b,k),HZ(b,k,s),null!==k.contentQueries&&(n.flags|=4),(null!==k.hostBindings||null!==k.hostAttrs||0!==k.hostVars)&&(n.flags|=64);const F=k.type.prototype;!f&&(F.ngOnChanges||F.ngOnInit||F.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),f=!0),!v&&(F.ngOnChanges||F.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),v=!0),b++}!function ws(t,e,n){const s=e.directiveEnd,c=t.data,f=e.attrs,v=[];let b=null,S=null;for(let k=e.directiveStart;k<s;k++){const F=c[k],H=n?n.get(F):null,de=H?H.outputs:null;b=R$(F.inputs,k,b,H?H.inputs:null),S=R$(F.outputs,k,S,de);const be=null===b||null===f||mR(e)?null:N$(b,k,f);v.push(be)}null!==b&&(b.hasOwnProperty("class")&&(e.flags|=8),b.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=v,e.inputs=b,e.outputs=S}(t,n,c)}function k$(t,e,n){const r=n.directiveStart,s=n.directiveEnd,c=n.index,f=function FV(){return Lr.lFrame.currentDirectiveIndex}();try{Sm(c);for(let v=r;v<s;v++){const b=t.data[v],S=e[v];UR(v),(null!==b.hostBindings||0!==b.hostVars||null!==b.hostAttrs)&&O$(b,S)}}finally{Sm(-1),UR(f)}}function O$(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function w4(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function HZ(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;dh(e)&&(n[""]=t)}}function $Z(t,e,n,r,s){t.data[r]=s;const c=s.factory||(s.factory=Tm(s.type)),f=new Ov(c,dh(s),vt);t.blueprint[r]=f,n[r]=f,function BZ(t,e,n,r,s){const c=s.hostBindings;if(c){let f=t.hostBindingOpCodes;null===f&&(f=t.hostBindingOpCodes=[]);const v=~e.index;(function UZ(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(f)!=v&&f.push(v),f.push(n,r,c)}}(t,e,r,dS(t,n,s.hostVars,Ur),s)}function yf(t,e,n,r,s,c){const f=_c(t,e);!function E4(t,e,n,r,s,c,f){if(null==c)t.removeAttribute(e,s,n);else{const v=null==f?jr(c):f(c,r||"",s);t.setAttribute(e,s,v,n)}}(e[Hr],f,c,t.value,n,r,s)}function GZ(t,e,n,r,s,c){const f=c[e];if(null!==f)for(let v=0;v<f.length;)mS(r,n,f[v++],f[v++],f[v++])}function mS(t,e,n,r,s){const c=Iu(null);try{const f=t.inputTransforms;null!==f&&f.hasOwnProperty(r)&&(s=f[r].call(e,s)),null!==t.setInput?t.setInput(e,s,n,r):e[r]=s}finally{Iu(c)}}function N$(t,e,n){let r=null,s=0;for(;s<n.length;){const c=n[s];if(0!==c)if(5!==c){if("number"==typeof c)break;if(t.hasOwnProperty(c)){null===r&&(r=[]);const f=t[c];for(let v=0;v<f.length;v+=2)if(f[v]===e){r.push(c,f[v+1],n[s+1]);break}}s+=2}else s+=2;else s+=4}return r}function L$(t,e,n,r){return[t,!0,!1,e,null,0,r,n,null,null,null]}function F$(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const c=n[r+1];if(-1!==c){const f=t.data[c];DI(n[r]),f.contentQueries(2,e[c],c)}}}function l2(t,e){return t[Ev]?t[iV][Cu]=e:t[Ev]=e,t[iV]=e,e}function x4(t,e,n){DI(0);const r=Iu(null);try{e(t,n)}finally{Iu(r)}}function V$(t){return t[bm]||(t[bm]=[])}function B$(t){return t.cleanup||(t.cleanup=[])}function z$(t,e){const n=t[rf],r=n?n.get(si,null):null;r&&r.handleError(e)}function j$(t,e,n,r,s){for(let c=0;c<n.length;){const f=n[c++],v=n[c++];mS(t.data[f],e[f],r,v,s)}}function WZ(t,e){const n=Ma(e,t),r=n[On];!function YZ(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n);const s=n[Bo];null!==s&&null===n[Em]&&(n[Em]=e4(s,n[rf])),c2(r,n,n[Ys])}function c2(t,e,n){PI(e);try{const r=t.viewQuery;null!==r&&x4(1,r,n);const s=t.template;null!==s&&S$(t,e,s,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&F$(t,e),t.staticViewQueries&&x4(2,t.viewQuery,n);const c=t.components;null!==c&&function ZZ(t,e){for(let n=0;n<e.length;n++)WZ(t,e[n])}(e,c)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[Zr]&=-5,RI()}}let us=(()=>{class t{constructor(){this.all=new Set,this.queue=new Map}create(n,r,s){const c=typeof Zone>"u"?null:Zone.current,f=function DR(t,e,n){const r=Object.create(EV);n&&(r.consumerAllowSignalWrites=!0),r.fn=t,r.schedule=e;const s=f=>{r.cleanupFn=f};return r.ref={notify:()=>fI(r),run:()=>{if(r.dirty=!1,r.hasRun&&!gI(r))return;r.hasRun=!0;const f=Kb(r);try{r.cleanupFn(),r.cleanupFn=PR,r.fn(s)}finally{mI(r,f)}},cleanup:()=>r.cleanupFn()},r.ref}(n,S=>{this.all.has(S)&&this.queue.set(S,c)},s);let v;this.all.add(f),f.notify();const b=()=>{f.cleanup(),v?.(),this.all.delete(f),this.queue.delete(f)};return v=r?.onDestroy(b),{destroy:b}}flush(){if(0!==this.queue.size)for(const[n,r]of this.queue)this.queue.delete(n),r?r.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=jn({token:t,providedIn:"root",factory:()=>new t})}return t})();function Qv(t,e,n){let r=n?t.styles:null,s=n?t.classes:null,c=0;if(null!==e)for(let f=0;f<e.length;f++){const v=e[f];"number"==typeof v?c=v:1==c?s=qC(s,v):2==c&&(r=qC(r,v+": "+e[++f]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=s:t.classesWithoutHost=s}function Wl(t,e,n,r,s=!1){for(;null!==n;){const c=e[n.index];null!==c&&r.push(Qo(c)),Ul(c)&&H$(c,r);const f=n.type;if(8&f)Wl(t,e,n.child,r);else if(32&f){const v=Ja(n,e);let b;for(;b=v();)r.push(b)}else if(16&f){const v=ph(e,n);if(Array.isArray(v))r.push(...v);else{const b=yy(e[vs]);Wl(b[On],b,v,r,!0)}}n=s?n.projectionNext:n.next}return r}function H$(t,e){for(let n=Za;n<t.length;n++){const r=t[n],s=r[On].firstChild;null!==s&&Wl(r[On],r,s,e)}t[Wh]!==t[Bo]&&e.push(t[Wh])}function gS(t,e,n,r=!0){const s=e[ey],c=s.rendererFactory,f=s.afterRenderEventManager;c.begin?.(),f?.begin();try{q$(t,e,t.template,n)}catch(b){throw r&&z$(e,b),b}finally{c.end?.(),s.effectManager?.flush(),f?.end()}}function q$(t,e,n,r){const s=e[Zr];if(256!=(256&s)){e[ey].effectManager?.flush(),PI(e);try{Qb(e),function VR(t){return Lr.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&S$(t,e,n,2,r);const f=3==(3&s);if(f){const S=t.preOrderCheckHooks;null!==S&&e1(e,S,null)}else{const S=t.preOrderHooks;null!==S&&t1(e,S,0,null),n1(e,0)}if(function XZ(t){for(let e=QI(t);null!==e;e=XI(e)){if(!e[oV])continue;const n=e[iy];for(let r=0;r<n.length;r++){DV(n[r])}}}(e),T4(e,2),null!==t.contentQueries&&F$(t,e),f){const S=t.contentCheckHooks;null!==S&&e1(e,S)}else{const S=t.contentHooks;null!==S&&t1(e,S,1),n1(e,1)}!function I$(t,e){const n=t.hostBindingOpCodes;if(null===n)return;const r=ba(e,qb);try{for(let s=0;s<n.length;s++){const c=n[s];if(c<0)Sm(~c);else{const f=c,v=n[++s],b=n[++s];LV(v,f),r.dirty=!1;const S=Kb(r);try{b(2,e[f])}finally{mI(r,S)}}}}finally{null===e[qb]&&Qs(e,qb),Sm(-1)}}(t,e);const v=t.components;null!==v&&u2(e,v,0);const b=t.viewQuery;if(null!==b&&x4(2,b,r),f){const S=t.viewCheckHooks;null!==S&&e1(e,S)}else{const S=t.viewHooks;null!==S&&t1(e,S,2),n1(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[Zr]&=-73,Pv(e)}finally{RI()}}}function T4(t,e){for(let n=QI(t);null!==n;n=XI(n))for(let r=Za;r<n.length;r++)K$(n[r],e)}function G$(t,e,n){K$(Ma(e,t),n)}function K$(t,e){if(!function bI(t){return 128==(128&t[Zr])}(t))return;const n=t[On],r=t[Zr];if(80&r&&0===e||1024&r||2===e)q$(n,t,n.template,t[Ys]);else if(t[Gh]>0){T4(t,1);const s=n.components;null!==s&&u2(t,s,1)}}function u2(t,e,n){for(let r=0;r<e.length;r++)G$(t,e[r],n)}class yS{get rootNodes(){const e=this._lView,n=e[On];return Wl(n,e,n.firstChild,[])}constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ys]}set context(e){this._lView[Ys]=e}get destroyed(){return 256==(256&this._lView[Zr])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[As];if(Ul(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(E1(e,r),Co(n,r))}this._attachedToViewContainer=!1}eS(this._lView[On],this._lView)}onDestroy(e){!function xI(t,e){if(256==(256&t[Zr]))throw new Gt(911,!1);null===t[Fd]&&(t[Fd]=[]),t[Fd].push(e)}(this._lView,e)}markForCheck(){mh(this._cdRefInjectingView||this._lView)}detach(){this._lView[Zr]&=-129}reattach(){this._lView[Zr]|=128}detectChanges(){gS(this._lView[On],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Gt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function kM(t,e){LM(t,e,e[Hr],2,null,null)}(this._lView[On],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Gt(902,!1);this._appRef=e}}class W$ extends yS{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;gS(e[On],e,e[Ys],!1)}checkNoChanges(){}get context(){return null}}class Y$ extends aS{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=qi(e);return new _S(n,this.ngModule)}}function Z$(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}class eQ{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Ld(r);const s=this.injector.get(e,JM,r);return s!==JM||n===JM?s:this.parentInjector.get(e,n,r)}}class _S extends a${get inputs(){const e=this.componentDef,n=e.inputTransforms,r=Z$(e.inputs);if(null!==n)for(const s of r)n.hasOwnProperty(s.propName)&&(s.transform=n[s.propName]);return r}get outputs(){return Z$(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function Hb(t){return t.map(XF).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,s){let c=(s=s||this.ngModule)instanceof Au?s:s?.injector;c&&null!==this.componentDef.getStandaloneInjector&&(c=this.componentDef.getStandaloneInjector(c)||c);const f=c?new eQ(e,c):e,v=f.get(IZ,null);if(null===v)throw new Gt(407,!1);const F={rendererFactory:v,sanitizer:f.get(AZ,null),effectManager:f.get(us,null),afterRenderEventManager:f.get(u4,null)},H=v.createRenderer(null,this.componentDef),Q=this.componentDef.selectors[0][0]||"div",de=r?function LZ(t,e,n,r){const c=r.get(Yc,!1)||n===xu.ShadowDom,f=t.selectRootElement(e,c);return function D$(t){P$(t)}(f),f}(H,r,this.componentDef.encapsulation,f):w1(H,Q,function JZ(t){const e=t.toLowerCase();return"svg"===e?AV:"math"===e?"math":null}(Q)),Be=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let Fe=null;null!==de&&(Fe=e4(de,f,!0));const tt=km(0,null,null,1,0,null,null,null,null,null,null),mt=hS(null,tt,null,Be,null,null,F,H,f,null,Fe);let Xt,bn;PI(mt);try{const Or=this.componentDef;let Bi,ys=null;Or.findHostDirectiveDefs?(Bi=[],ys=new Map,Or.findHostDirectiveDefs(Or,Bi,ys),Bi.push(Or)):Bi=[Or];const Ui=function tQ(t,e){const n=t[On],r=Oi;return t[r]=e,V1(n,r,2,"#host",null)}(mt,de),Ol=function X$(t,e,n,r,s,c,f){const v=s[On];!function nQ(t,e,n,r){for(const s of t)e.mergedAttrs=bv(e.mergedAttrs,s.hostAttrs);null!==e.mergedAttrs&&(Qv(e,e.mergedAttrs,!0),null!==n&&AH(r,n,e))}(r,t,e,f);let b=null;null!==e&&(b=e4(e,s[rf]));const S=c.rendererFactory.createRenderer(e,n);let k=16;n.signals?k=4096:n.onPush&&(k=64);const F=hS(s,A$(n),null,k,s[t.index],t,c,S,null,null,b);return v.firstCreatePass&&w4(v,t,r.length-1),l2(s,F),s[t.index]=F}(Ui,de,Or,Bi,mt,F,H);bn=Zb(tt,Oi),de&&function rQ(t,e,n,r){if(r)rI(t,n,["ng-version",c$.full]);else{const{attrs:s,classes:c}=function gR(t){const e=[],n=[];let r=1,s=2;for(;r<t.length;){let c=t[r];if("string"==typeof c)2===s?""!==c&&e.push(c,t[++r]):8===s&&n.push(c);else{if(!hh(s))break;s=c}r++}return{attrs:e,classes:n}}(e.selectors[0]);s&&rI(t,n,s),c&&c.length>0&&SH(t,n,c.join(" "))}}(H,Or,de,r),void 0!==n&&function Ey(t,e,n){const r=t.projection=[];for(let s=0;s<e.length;s++){const c=n[s];r.push(null!=c?Array.from(c):null)}}(bn,this.ngContentSelectors,n),Xt=function Ps(t,e,n,r,s,c){const f=Xa(),v=s[On],b=_c(f,s);M$(v,s,f,n,null,r);for(let k=0;k<n.length;k++)ir(hy(s,v,f.directiveStart+k,f),s);k$(v,s,f),b&&ir(b,s);const S=hy(s,v,f.directiveStart+f.componentOffset,f);if(t[Ys]=s[Ys]=S,null!==c)for(const k of c)k(S,e);return pS(v,f,t),S}(Ol,Or,Bi,ys,mt,[iQ]),c2(tt,mt,null)}finally{RI()}return new Q$(this.componentType,Xt,O1(bn,mt),mt,bn)}}class Q$ extends EZ{constructor(e,n,r,s,c){super(),this.location=r,this._rootLView=s,this._tNode=c,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new W$(s),this.componentType=e}setInput(e,n){const r=this._tNode.inputs;let s;if(null!==r&&(s=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;const c=this._rootLView;j$(c[On],c,s,e,n),this.previousInputValues.set(e,n),mh(Ma(this._tNode.index,c))}}get injector(){return new Hl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function iQ(){const t=Xa();Jb(Bt()[On],t)}function _o(t){let e=function B1(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),n=!0;const r=[t];for(;e;){let s;if(dh(t))s=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Gt(903,!1);s=e.\u0275dir}if(s){if(n){r.push(s);const f=t;f.inputs=h2(t.inputs),f.inputTransforms=h2(t.inputTransforms),f.declaredInputs=h2(t.declaredInputs),f.outputs=h2(t.outputs);const v=s.hostBindings;v&&C4(t,v);const b=s.viewQuery,S=s.contentQueries;if(b&&J$(t,b),S&&e8(t,S),Pb(t.inputs,s.inputs),Pb(t.declaredInputs,s.declaredInputs),Pb(t.outputs,s.outputs),null!==s.inputTransforms&&(null===f.inputTransforms&&(f.inputTransforms={}),Pb(f.inputTransforms,s.inputTransforms)),dh(s)&&s.data.animation){const k=t.data;k.animation=(k.animation||[]).concat(s.data.animation)}}const c=s.features;if(c)for(let f=0;f<c.length;f++){const v=c[f];v&&v.ngInherit&&v(t),v===_o&&(n=!1)}}e=Object.getPrototypeOf(e)}!function oQ(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const s=t[r];s.hostVars=e+=s.hostVars,s.hostAttrs=bv(s.hostAttrs,n=bv(n,s.hostAttrs))}}(r)}function h2(t){return t===qh?{}:t===Xi?[]:t}function J$(t,e){const n=t.viewQuery;t.viewQuery=n?(r,s)=>{e(r,s),n(r,s)}:e}function e8(t,e){const n=t.contentQueries;t.contentQueries=n?(r,s,c)=>{e(r,s,c),n(r,s,c)}:e}function C4(t,e){const n=t.hostBindings;t.hostBindings=n?(r,s)=>{e(r,s),n(r,s)}:e}function p2(t){return!!S4(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function S4(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Xh(t,e,n){return t[e]=n}function ka(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Xv(t,e,n,r){const s=ka(t,e,n);return ka(t,e+1,r)||s}function ca(t,e,n,r){const s=Bt();return ka(s,cf(),e)&&(Gi(),yf(Ds(),s,t,e,n,r)),ca}function z1(t,e,n,r){return ka(t,cf(),n)?e+jr(n)+r:Ur}function mr(t,e,n,r,s,c,f,v){const b=Bt(),S=Gi(),k=t+Oi,F=S.firstCreatePass?function y2(t,e,n,r,s,c,f,v,b){const S=e.consts,k=V1(e,t,4,f||null,Su(S,v));_4(e,n,k,Su(S,b)),Jb(e,k);const F=k.tView=km(2,k,r,s,c,e.directiveRegistry,e.pipeRegistry,null,e.schemas,S,null);return null!==e.queries&&(e.queries.template(e,k),F.queries=e.queries.embeddedTView(k)),k}(k,S,b,e,n,r,s,c,f):S.data[k];Bd(F,!1);const H=u8(S,b,F,t);kv()&&Gc(S,b,H,F),ir(H,b),l2(b,b[k]=L$(H,b,H,F)),sy(F)&&g4(S,b,F),null!=f&&fS(b,F,v)}let u8=function t0(t,e,n,r){return Ud(!0),e[Hr].createComment("")};function Ql(t){return Zh(function iH(){return Lr.lFrame.contextLView}(),Oi+t)}function un(t,e,n){const r=Bt();return ka(r,cf(),e)&&function gh(t,e,n,r,s,c,f,v){const b=_c(e,n);let k,S=e.inputs;!v&&null!=S&&(k=S[r])?(j$(t,n,k,r,s),xm(e)&&function gi(t,e){const n=Ma(e,t);16&n[Zr]||(n[Zr]|=64)}(n,e.index)):3&e.type&&(r=function VZ(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),s=null!=f?f(s,e.value||"",r):s,c.setProperty(b,r,s))}(Gi(),Ds(),r,t,e,r[Hr],n,!1),un}function w2(t,e,n,r,s){const f=s?"class":"style";j$(t,n,e.inputs[f],f,r)}function Gn(t,e,n,r){const s=Bt(),c=Gi(),f=Oi+t,v=s[Hr],b=c.firstCreatePass?function n0(t,e,n,r,s,c){const f=e.consts,b=V1(e,t,2,r,Su(f,s));return _4(e,n,b,Su(f,c)),null!==b.attrs&&Qv(b,b.attrs,!1),null!==b.mergedAttrs&&Qv(b,b.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,b),b}(f,c,s,e,n,r):c.data[f],S=bf(c,s,b,v,e,t);s[f]=S;const k=sy(b);return Bd(b,!0),AH(v,S,b),32!=(32&b.flags)&&kv()&&Gc(c,s,S,b),0===function PV(){return Lr.lFrame.elementDepthCount}()&&ir(S,s),function RV(){Lr.lFrame.elementDepthCount++}(),k&&(g4(c,s,b),pS(c,b,s)),null!==r&&fS(s,b),Gn}function _r(){let t=Xa();CI()?II():(t=t.parent,Bd(t,!1));const e=t;(function MV(t){return Lr.skipHydrationRootTNode===t})(e)&&function rH(){Lr.skipHydrationRootTNode=null}(),function Im(){Lr.lFrame.elementDepthCount--}();const n=Gi();return n.firstCreatePass&&(Jb(n,t),cI(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function ZR(t){return 0!=(8&t.flags)}(e)&&w2(n,e,Bt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function MI(t){return 0!=(16&t.flags)}(e)&&w2(n,e,Bt(),e.stylesWithoutHost,!1),_r}function Rs(t,e,n,r){return Gn(t,e,n,r),_r(),Rs}let bf=(t,e,n,r,s,c)=>(Ud(!0),w1(r,s,function WR(){return Lr.lFrame.currentNamespace}()));function bc(t,e,n){const r=Bt(),s=Gi(),c=t+Oi,f=s.firstCreatePass?function b2(t,e,n,r,s){const c=e.consts,f=Su(c,r),v=V1(e,t,8,"ng-container",f);return null!==f&&Qv(v,f,!0),_4(e,n,v,Su(c,s)),null!==e.queries&&e.queries.elementStart(e,v),v}(c,s,r,e,n):s.data[c];Bd(f,!0);const v=tn(s,r,f,t);return r[c]=v,kv()&&Gc(s,r,v,f),ir(v,r),sy(f)&&(g4(s,r,f),pS(s,f,r)),null!=n&&fS(r,f),bc}function Qc(){let t=Xa();const e=Gi();return CI()?II():(t=t.parent,Bd(t,!1)),e.firstCreatePass&&(Jb(e,t),cI(t)&&e.queries.elementEnd(t)),Qc}let tn=(t,e,n,r)=>(Ud(!0),v1(e[Hr],""));function $d(){return Bt()}function xr(t){return!!t&&"function"==typeof t.then}function $r(t){return!!t&&"function"==typeof t.subscribe}function Ar(t,e,n,r){const s=Bt(),c=Gi(),f=Xa();return function J1(t,e,n,r,s,c,f){const v=sy(r),S=t.firstCreatePass&&B$(t),k=e[Ys],F=V$(e);let H=!0;if(3&r.type||f){const be=_c(r,e),Ie=f?f(be):be,Be=F.length,Fe=f?mt=>f(Qo(mt[r.index])):r.index;let tt=null;if(!f&&v&&(tt=function EQ(t,e,n,r){const s=t.cleanup;if(null!=s)for(let c=0;c<s.length-1;c+=2){const f=s[c];if(f===n&&s[c+1]===r){const v=e[bm],b=s[c+2];return v.length>b?v[b]:null}"string"==typeof f&&(c+=2)}return null}(t,e,s,r.index)),null!==tt)(tt.__ngLastListenerFn__||tt).__ngNextListenerFn__=c,tt.__ngLastListenerFn__=c,H=!1;else{c=E2(r,e,k,c,!1);const mt=n.listen(Ie,s,c);F.push(c,mt),S&&S.push(s,Fe,Be,Be+1)}}else c=E2(r,e,k,c,!1);const Q=r.outputs;let de;if(H&&null!==Q&&(de=Q[s])){const be=de.length;if(be)for(let Ie=0;Ie<be;Ie+=2){const Xt=e[de[Ie]][de[Ie+1]].subscribe(c),bn=F.length;F.push(c,Xt),S&&S.push(s,r.index,bn,-(bn+1))}}}(c,s,s[Hr],f,t,e,r),Ar}function k4(t,e,n,r){try{return Vd(6,e,n),!1!==n(r)}catch(s){return z$(t,s),!1}finally{Vd(7,e,n)}}function E2(t,e,n,r,s){return function c(f){if(f===Function)return r;mh(t.componentOffset>-1?Ma(t.index,e):e);let b=k4(e,n,r,f),S=c.__ngNextListenerFn__;for(;S;)b=k4(e,n,S,f)&&b,S=S.__ngNextListenerFn__;return s&&!1===b&&f.preventDefault(),b}}function or(t=1){return function Mv(t){return(Lr.lFrame.contextLView=function UV(t,e){for(;t>0;)e=e[ty],t--;return e}(t,Lr.lFrame.contextLView))[Ys]}(t)}function x2(t,e){let n=null;const r=function Lj(t){const e=t.attrs;if(null!=e){const n=e.indexOf(5);if(!(1&n))return e[n+1]}return null}(t);for(let s=0;s<e.length;s++){const c=e[s];if("*"!==c){if(null===r?nf(t,c,!0):iI(r,c))return s}else n=s}return n}function qd(t){const e=Bt()[vs][fl];if(!e.projection){const r=e.projection=pf(t?t.length:1,null),s=r.slice();let c=e.child;for(;null!==c;){const f=t?x2(c,t):0;null!==f&&(s[f]?s[f].projectionNext=c:r[f]=c,s[f]=c),c=c.next}}}function Oa(t,e=0,n){const r=Bt(),s=Gi(),c=V1(s,Oi+t,16,null,n||null);null===c.projection&&(c.projection=e),II(),(!r[Em]||cy())&&32!=(32&c.flags)&&function Voe(t,e,n){IH(e[Hr],0,e,n,G(t,n,e),Er(n.parent||e[fl],n,e))}(s,r,c)}function T2(t,e){return t<<17|e<<2}function Mn(t){return t>>17&32767}function C2(t){return 2|t}function r0(t){return(131068&t)>>2}function L4(t,e){return-131069&t|e<<2}function Kd(t){return 1|t}function p8(t,e,n,r,s){const c=t[n+1],f=null===e;let v=r?Mn(c):r0(c),b=!1;for(;0!==v&&(!1===b||f);){const k=t[v+1];TQ(t[v],e)&&(b=!0,t[v+1]=r?Kd(k):C2(k)),v=r?Mn(k):r0(k)}b&&(t[n+1]=r?C2(c):Kd(c))}function TQ(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&ff(t,e)>=0}const tl={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function I2(t){return t.substring(tl.key,tl.keyEnd)}function B4(t,e){const n=tl.textEnd;return n===e?-1:(e=tl.keyEnd=function IQ(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}(t,tl.key=e,n),eE(t,e,n))}function eE(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function tE(t,e,n){return Zd(t,e,n,!1),tE}function Xl(t,e){return Zd(t,e,null,!0),Xl}function ed(t,e){for(let n=function m8(t){return function Wd(t){tl.key=0,tl.keyEnd=0,tl.value=0,tl.valueEnd=0,tl.textEnd=t.length}(t),B4(t,eE(t,0,tl.textEnd))}(e);n>=0;n=B4(e,n))qc(t,I2(e),!0)}function Zd(t,e,n,r){const s=Bt(),c=Gi(),f=uf(2);c.firstUpdatePass&&b8(c,t,f,r),e!==Ur&&ka(s,f,e)&&T8(c,c.data[jl()],s,s[Hr],t,s[f+1]=function AS(t,e){return null==t||""===t||("string"==typeof e?t+=e:"object"==typeof t&&(t=_a(wy(t)))),t}(e,n),r,f)}function Vm(t,e){return e>=t.expandoStartIndex}function b8(t,e,n,r){const s=t.data;if(null===s[n+1]){const c=s[jl()],f=Vm(t,n);U4(c,r)&&null===e&&!f&&(e=!1),e=function td(t,e,n,r){const s=function AI(t){const e=Lr.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let c=r?e.residualClasses:e.residualStyles;if(null===s)0===(r?e.classBindings:e.styleBindings)&&(n=hs(n=Pu(null,t,e,n,r),e.attrs,r),c=null);else{const f=e.directiveStylingLast;if(-1===f||t[f]!==s)if(n=Pu(s,t,e,n,r),null===c){let b=function SS(t,e,n){const r=n?e.classBindings:e.styleBindings;if(0!==r0(r))return t[Mn(r)]}(t,e,r);void 0!==b&&Array.isArray(b)&&(b=Pu(null,t,e,b[1],r),b=hs(b,e.attrs,r),function E8(t,e,n,r){t[Mn(n?e.classBindings:e.styleBindings)]=r}(t,e,r,b))}else c=function nE(t,e,n){let r;const s=e.directiveEnd;for(let c=1+e.directiveStylingLast;c<s;c++)r=hs(r,t[c].hostAttrs,n);return hs(r,e.attrs,n)}(t,e,r)}return void 0!==c&&(r?e.residualClasses=c:e.residualStyles=c),n}(s,c,e,r),function V4(t,e,n,r,s,c){let f=c?e.classBindings:e.styleBindings,v=Mn(f),b=r0(f);t[r]=n;let k,S=!1;if(Array.isArray(n)?(k=n[1],(null===k||ff(n,k)>0)&&(S=!0)):k=n,s)if(0!==b){const H=Mn(t[v+1]);t[r+1]=T2(H,v),0!==H&&(t[H+1]=L4(t[H+1],r)),t[v+1]=function Gd(t,e){return 131071&t|e<<17}(t[v+1],r)}else t[r+1]=T2(v,0),0!==v&&(t[v+1]=L4(t[v+1],r)),v=r;else t[r+1]=T2(b,0),0===v?v=r:t[b+1]=L4(t[b+1],r),b=r;S&&(t[r+1]=C2(t[r+1])),p8(t,k,r,!0),p8(t,k,r,!1),function xQ(t,e,n,r,s){const c=s?t.residualClasses:t.residualStyles;null!=c&&"string"==typeof e&&ff(c,e)>=0&&(n[r+1]=Kd(n[r+1]))}(e,k,t,r,c),f=T2(v,b),c?e.classBindings=f:e.styleBindings=f}(s,c,e,n,f,r)}}function Pu(t,e,n,r,s){let c=null;const f=n.directiveEnd;let v=n.directiveStylingLast;for(-1===v?v=n.directiveStart:v++;v<f&&(c=e[v],r=hs(r,c.hostAttrs,s),c!==t);)v++;return null!==t&&(n.directiveStylingLast=v),r}function hs(t,e,n){const r=n?1:2;let s=-1;if(null!==e)for(let c=0;c<e.length;c++){const f=e[c];"number"==typeof f?s=f:s===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),qc(t,f,!!n||e[++c]))}return void 0===t?null:t}function T8(t,e,n,r,s,c,f,v){if(!(3&e.type))return;const b=t.data,S=b[v+1],k=function F4(t){return 1==(1&t)}(S)?Xd(b,e,n,s,r0(S),f):void 0;A2(k)||(A2(c)||function yh(t){return 2==(2&t)}(S)&&(c=Xd(b,null,n,s,v,f)),function BY(t,e,n,r,s){if(e)s?t.addClass(n,r):t.removeClass(n,r);else{let c=-1===r.indexOf("-")?void 0:Hd.DashCase;null==s?t.removeStyle(n,r,c):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),c|=Hd.Important),t.setStyle(n,r,s,c))}}(r,f,Uo(jl(),n),s,c))}function Xd(t,e,n,r,s,c){const f=null===e;let v;for(;s>0;){const b=t[s],S=Array.isArray(b),k=S?b[1]:b,F=null===k;let H=n[s+1];H===Ur&&(H=F?Xi:void 0);let Q=F?c1(H,r):k===r?H:void 0;if(S&&!A2(Q)&&(Q=c1(b,r)),A2(Q)&&(v=Q,f))return v;const de=t[s+1];s=f?Mn(de):r0(de)}if(null!==e){let b=c?e.residualClasses:e.residualStyles;null!=b&&(v=c1(b,r))}return v}function A2(t){return void 0!==t}function U4(t,e){return 0!=(t.flags&(e?8:16))}function Ho(t,e=""){const n=Bt(),r=Gi(),s=t+Oi,c=r.firstCreatePass?V1(r,s,1,e,null):r.data[s],f=z4(r,n,c,e,t);n[s]=f,kv()&&Gc(r,n,f,c),Bd(c,!1)}let z4=(t,e,n,r,s)=>(Ud(!0),function Pm(t,e){return t.createText(e)}(e[Hr],r));function Xs(t){return rE("",t,""),Xs}function rE(t,e,n){const r=Bt(),s=z1(r,t,e,n);return s!==Ur&&function ai(t,e,n){const r=Uo(e,t);!function JI(t,e,n){t.setValue(e,n)}(t[Hr],r,n)}(r,jl(),s),rE}function o0(t,e,n){!function Qd(t,e,n,r){const s=Gi(),c=uf(2);s.firstUpdatePass&&b8(s,null,c,r);const f=Bt();if(n!==Ur&&ka(f,c,n)){const v=s.data[jl()];if(U4(v,r)&&!Vm(s,c)){let b=r?v.classesWithoutHost:v.stylesWithoutHost;null!==b&&(n=qC(b,n||"")),w2(s,v,f,n,r)}else!function Ru(t,e,n,r,s,c,f,v){s===Ur&&(s=Xi);let b=0,S=0,k=0<s.length?s[0]:null,F=0<c.length?c[0]:null;for(;null!==k||null!==F;){const H=b<s.length?s[b+1]:void 0,Q=S<c.length?c[S+1]:void 0;let be,de=null;k===F?(b+=2,S+=2,H!==Q&&(de=F,be=Q)):null===F||null!==k&&k<F?(b+=2,de=k):(S+=2,de=F,be=Q),null!==de&&T8(t,e,n,r,de,be,f,v),k=b<s.length?s[b]:null,F=S<c.length?c[S]:null}}(s,v,f,f[Hr],f[c+1],f[c+1]=function x8(t,e,n){if(null==n||""===n)return Xi;const r=[],s=wy(n);if(Array.isArray(s))for(let c=0;c<s.length;c++)t(r,s[c],!0);else if("object"==typeof s)for(const c in s)s.hasOwnProperty(c)&&t(r,c,s[c]);else"string"==typeof s&&e(r,s);return r}(t,e,n),r,c)}}(qc,ed,z1(Bt(),t,e,n),!0)}const s0="en-US";let V2=s0;function Q2(t,e,n,r,s){if(t=Vr(t),Array.isArray(t))for(let c=0;c<t.length;c++)Q2(t[c],e,n,r,s);else{const c=Gi(),f=Bt(),v=Xa();let b=A1(t)?t:Vr(t.provide);const S=QH(t),k=1048575&v.providerIndexes,F=v.directiveStart,H=v.providerIndexes>>20;if(A1(t)||!t.multi){const Q=new Ov(S,s,vt),de=NS(b,e,s?k:k+H,F);-1===de?(FI(NI(v,f),c,b),OS(c,t,e.length),e.push(b),v.directiveStart++,v.directiveEnd++,s&&(v.providerIndexes+=1048576),n.push(Q),f.push(Q)):(n[de]=Q,f[de]=Q)}else{const Q=NS(b,e,k+H,F),de=NS(b,e,k,k+H),Ie=de>=0&&n[de];if(s&&!Ie||!s&&!(Q>=0&&n[Q])){FI(NI(v,f),c,b);const Be=function tu(t,e,n,r,s){const c=new Ov(t,n,vt);return c.multi=[],c.index=e,c.componentProviders=0,tp(c,s,r&&!n),c}(s?tq:zQ,n.length,s,r,S);!s&&Ie&&(n[de].providerFactory=Be),OS(c,t,e.length,0),e.push(b),v.directiveStart++,v.directiveEnd++,s&&(v.providerIndexes+=1048576),n.push(Be),f.push(Be)}else OS(c,t,Q>-1?Q:de,tp(n[s?de:Q],S,!s&&r));!s&&r&&Ie&&n[de].componentProviders++}}}function OS(t,e,n,r){const s=A1(e),c=function ZH(t){return!!t.useClass}(e);if(s||c){const b=(c?Vr(e.useClass):e).prototype.ngOnDestroy;if(b){const S=t.destroyHooks||(t.destroyHooks=[]);if(!s&&e.multi){const k=S.indexOf(n);-1===k?S.push(n,[r,b]):S[k+1].push(r,b)}else S.push(n,b)}}}function tp(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function NS(t,e,n,r){for(let s=n;s<r;s++)if(e[s]===t)return s;return-1}function zQ(t,e,n,r){return iB(this.multi,[])}function tq(t,e,n,r){const s=this.multi;let c;if(this.providerFactory){const f=this.providerFactory.componentProviders,v=hy(n,n[On],this.providerFactory.index,r);c=v.slice(0,f),iB(s,c);for(let b=f;b<v.length;b++)c.push(v[b])}else c=[],iB(s,c);return c}function iB(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function ns(t,e=[]){return n=>{n.providersResolver=(r,s)=>function eq(t,e,n){const r=Gi();if(r.firstCreatePass){const s=dh(t);Q2(n,r.data,r.blueprint,s,!0),Q2(e,r.data,r.blueprint,s,!1)}}(r,s?s(t):t,e)}}class nu{}class oB{}class vE extends nu{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Y$(this);const s=Ai(e);this._bootstrapComponents=gf(s.bootstrap),this._r3Injector=s4(e,n,[{provide:nu,useValue:this},{provide:aS,useValue:this.componentFactoryResolver},...r],_a(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class wE extends oB{constructor(e){super(),this.moduleType=e}create(e){return new vE(this.moduleType,e,[])}}class p0 extends nu{constructor(e){super(),this.componentFactoryResolver=new Y$(this),this.instance=null;const n=new D1([...e.providers,{provide:nu,useValue:this},{provide:aS,useValue:this.componentFactoryResolver}],e.parent||HM(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function aB(t,e,n=null){return new p0({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}let lB=(()=>{class t{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const r=WH(0,n.type),s=r.length>0?aB([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,s)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=jn({token:t,providedIn:"environment",factory:()=>new t(hr(Au))})}return t})();function bE(t){t.getStandaloneInjector=e=>e.get(lB).getOrCreateStandaloneInjector(t)}function vh(t,e,n,r){return FS(Bt(),zl(),t,e,n,r)}function ok(t,e,n,r,s){return function lk(t,e,n,r,s,c,f){const v=e+n;return Xv(t,v,s,c)?Xh(t,v+2,f?r.call(f,s,c):r(s,c)):ko(t,v+2)}(Bt(),zl(),t,e,n,r,s)}function sk(t,e,n,r,s,c){return function Df(t,e,n,r,s,c,f,v){const b=e+n;return function _f(t,e,n,r,s){const c=Xv(t,e,n,r);return ka(t,e+2,s)||c}(t,b,s,c,f)?Xh(t,b+3,v?r.call(v,s,c,f):r(s,c,f)):ko(t,b+3)}(Bt(),zl(),t,e,n,r,s,c)}function rq(t,e,n,r,s,c,f){return function gB(t,e,n,r,s,c,f,v,b){const S=e+n;return function Jh(t,e,n,r,s,c){const f=Xv(t,e,n,r);return Xv(t,e+2,s,c)||f}(t,S,s,c,f,v)?Xh(t,S+4,b?r.call(b,s,c,f,v):r(s,c,f,v)):ko(t,S+4)}(Bt(),zl(),t,e,n,r,s,c,f)}function ak(t,e,n,r){return function iq(t,e,n,r,s,c){let f=e+n,v=!1;for(let b=0;b<s.length;b++)ka(t,f++,s[b])&&(v=!0);return v?Xh(t,f,r.apply(c,s)):ko(t,f)}(Bt(),zl(),t,e,n,r)}function ko(t,e){const n=t[e];return n===Ur?void 0:n}function FS(t,e,n,r,s,c){const f=e+n;return ka(t,f,s)?Xh(t,f+1,c?r.call(c,s):r(s)):ko(t,f+1)}function sq(t,e,n){const r=t+Oi,s=Bt(),c=Zh(s,r);return function xE(t,e){return t[On].data[e].pure}(s,r)?FS(s,zl(),e,c.transform,n,c):c.transform(n)}function WQ(){return this._results[Symbol.iterator]()}class _B{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new Rr)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=_B.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=WQ)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){const r=this;r.dirty=!1;const s=function $l(t){return t.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function Dm(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++){let s=t[r],c=e[r];if(n&&(s=n(s),c=n(c)),c!==s)return!1}return!0}(r._results,s,n))&&(r._results=s,r.length=s.length,r.last=s[this.length-1],r.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function YQ(t,e,n,r=!0){const s=e[On];if(function O3(t,e,n,r){const s=Za+r,c=n.length;r>0&&(n[s-1][Cu]=e),r<c-Za?(e[Cu]=n[s],cM(n,Za+r,e)):(n.push(e),e[Cu]=null),e[As]=n;const f=e[xv];null!==f&&n!==f&&function OM(t,e){const n=t[iy];e[vs]!==e[As][As][vs]&&(t[oV]=!0),null===n?t[iy]=[e]:n.push(e)}(f,e);const v=e[Kh];null!==v&&v.insertView(t),e[Zr]|=128}(s,e,t,n),r){const c=x1(n,t),f=e[Hr],v=at(f,t[Wh]);null!==v&&function b1(t,e,n,r,s,c){r[Bo]=s,r[fl]=e,LM(t,r,n,1,s,c)}(s,t[fl],f,e,v,c)}}let nd=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=QQ}return t})();const ZQ=nd,VS=class extends ZQ{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){const s=function uq(t,e,n,r){const s=e.tView,v=hS(t,s,n,4096&t[Zr]?4096:16,null,e,null,null,null,r?.injector??null,r?.hydrationInfo??null);v[xv]=t[e.index];const S=t[Kh];return null!==S&&(v[Kh]=S.createEmbeddedView(s)),c2(s,v,n),v}(this._declarationLView,this._declarationTContainer,e,{injector:n,hydrationInfo:r});return new yS(s)}};function QQ(){return rd(Xa(),Bt())}function rd(t,e){return 4&t.type?new VS(e,t,O1(t,e)):null}let Na=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=hk}return t})();function hk(){return pk(Xa(),Bt())}const dk=Na,CE=class extends dk{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return O1(this._hostTNode,this._hostLView)}get injector(){return new Hl(this._hostTNode,this._hostLView)}get parentInjector(){const e=a1(this._hostTNode,this._hostLView);if(kI(e)){const n=Lv(e,this._hostLView),r=Nv(e);return new Hl(n[On].data[r+8],n)}return new Hl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=BS(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-Za}createEmbeddedView(e,n,r){let s,c;"number"==typeof r?s=r:null!=r&&(s=r.index,c=r.injector);const v=e.createEmbeddedViewImpl(n||{},c,null);return this.insertImpl(v,s,false),v}createComponent(e,n,r,s,c){const f=e&&!function zv(t){return"function"==typeof t}(e);let v;if(f)v=n;else{const be=n||{};v=be.index,r=be.injector,s=be.projectableNodes,c=be.environmentInjector||be.ngModuleRef}const b=f?e:new _S(qi(e)),S=r||this.parentInjector;if(!c&&null==b.ngModule){const Ie=(f?S:this.parentInjector).get(Au,null);Ie&&(c=Ie)}qi(b.componentType??{});const Q=b.create(S,s,null,c);return this.insertImpl(Q.hostView,v,false),Q}insert(e,n){return this.insertImpl(e,n,!1)}insertImpl(e,n,r){const s=e._lView;if(function OR(t){return Ul(t[As])}(s)){const b=this.indexOf(e);if(-1!==b)this.detach(b);else{const S=s[As],k=new CE(S,S[fl],S[As]);k.detach(k.indexOf(e))}}const f=this._adjustIndex(n),v=this._lContainer;return YQ(v,s,f,!r),e.attachToViewContainerRef(),cM($m(v),f,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=BS(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=E1(this._lContainer,n);r&&(Co($m(this._lContainer),n),eS(r[On],r))}detach(e){const n=this._adjustIndex(e,-1),r=E1(this._lContainer,n);return r&&null!=Co($m(this._lContainer),n)?new yS(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function BS(t){return t[8]}function $m(t){return t[8]||(t[8]=[])}function pk(t,e){let n;const r=e[t.index];return Ul(r)?n=r:(n=L$(r,e,null,t),e[t.index]=n,l2(e,n)),fk(n,e,t,r),new CE(n,t,e)}let fk=function US(t,e,n,r){if(t[Wh])return;let s;s=8&n.type?Qo(r):function wB(t,e){const n=t[Hr],r=n.createComment(""),s=_c(e,t);return te(n,at(n,s),r,function fr(t,e){return t.nextSibling(e)}(n,s),!1),r}(e,n),t[Wh]=s};class xB{constructor(e){this.queryList=e,this.matches=null}clone(){return new xB(this.queryList)}setDirty(){this.queryList.setDirty()}}class TB{constructor(e=[]){this.queries=e}createEmbeddedView(e){const n=e.queries;if(null!==n){const r=null!==e.contentQueries?e.contentQueries[0]:n.length,s=[];for(let c=0;c<r;c++){const f=n.getByIndex(c);s.push(this.queries[f.indexInDeclarationView].clone())}return new TB(s)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)null!==SB(e,n).matches&&this.queries[n].setDirty()}}class dq{constructor(e,n,r=null){this.predicate=e,this.flags=n,this.read=r}}class CB{constructor(e=[]){this.queries=e}elementStart(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let r=0;r<this.length;r++){const s=null!==n?n.length:0,c=this.getByIndex(r).embeddedTView(e,s);c&&(c.indexInDeclarationView=r,null!==n?n.push(c):n=[c])}return null!==n?new CB(n):null}template(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class IB{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new IB(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let r=e.parent;for(;null!==r&&8&r.type&&r.index!==n;)r=r.parent;return n===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(e,n){const r=this.metadata.predicate;if(Array.isArray(r))for(let s=0;s<r.length;s++){const c=r[s];this.matchTNodeWithReadOption(e,n,JQ(n,c)),this.matchTNodeWithReadOption(e,n,VI(n,e,c,!1,!1))}else r===nd?4&n.type&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,VI(n,e,r,!1,!1))}matchTNodeWithReadOption(e,n,r){if(null!==r){const s=this.metadata.read;if(null!==s)if(s===yl||s===Na||s===nd&&4&n.type)this.addMatch(n.index,-2);else{const c=VI(n,e,s,!1,!1);null!==c&&this.addMatch(n.index,c)}else this.addMatch(n.index,r)}}addMatch(e,n){null===this.matches?this.matches=[e,n]:this.matches.push(e,n)}}function JQ(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function mk(t,e,n,r){return-1===n?function y0(t,e){return 11&t.type?O1(t,e):4&t.type?rd(t,e):null}(e,t):-2===n?function Cc(t,e,n){return n===yl?O1(e,t):n===nd?rd(e,t):n===Na?pk(e,t):void 0}(t,e,r):hy(t,t[On],n,e)}function _0(t,e,n,r){const s=e[Kh].queries[r];if(null===s.matches){const c=t.data,f=n.matches,v=[];for(let b=0;b<f.length;b+=2){const S=f[b];v.push(S<0?null:mk(e,c[S],f[b+1],n.metadata.read))}s.matches=v}return s.matches}function to(t,e,n,r){const s=t.queries.getByIndex(n),c=s.matches;if(null!==c){const f=_0(t,e,s,n);for(let v=0;v<c.length;v+=2){const b=c[v];if(b>0)r.push(f[v/2]);else{const S=c[v+1],k=e[-b];for(let F=Za;F<k.length;F++){const H=k[F];H[xv]===H[As]&&to(H[On],H,S,r)}if(null!==k[iy]){const F=k[iy];for(let H=0;H<F.length;H++){const Q=F[H];to(Q[On],Q,S,r)}}}}}return r}function yi(t){const e=Bt(),n=Gi(),r=zR();DI(r+1);const s=SB(n,r);if(t.dirty&&function af(t){return 4==(4&t[Zr])}(e)===(2==(2&s.metadata.flags))){if(null===s.matches)t.reset([]);else{const c=s.crossesNgTemplate?to(n,e,r,[]):_0(n,e,s,r);t.reset(c,CZ),t.notifyOnChanges()}return!0}return!1}function Es(t,e,n){const r=Gi();r.firstCreatePass&&(pq(r,new dq(t,e,n),-1),2==(2&e)&&(r.staticViewQueries=!0)),IE(r,Bt(),e)}function Mu(){return function yk(t,e){return t[Kh].queries[e].queryList}(Bt(),zR())}function IE(t,e,n){const r=new _B(4==(4&n));(function Kl(t,e,n,r){const s=V$(e);s.push(n),t.firstCreatePass&&B$(t).push(r,s.length-1)})(t,e,r,r.destroy),null===e[Kh]&&(e[Kh]=new TB),e[Kh].queries.push(new xB(r))}function pq(t,e,n){null===t.queries&&(t.queries=new CB),t.queries.track(new IB(e,n))}function SB(t,e){return t.queries.getByIndex(e)}function zS(t,e){return rd(t,e)}const ku=new Xn("Application Initializer");let Tk=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=Kn(ku,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const s of this.appInits){const c=s();if(xr(c))n.push(c);else if($r(c)){const f=new Promise((v,b)=>{c.subscribe({complete:v,error:b})});n.push(f)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(s=>{this.reject(s)}),0===n.length&&r(),this.initialized=!0}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),qS=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();const op=new Xn("LocaleId",{providedIn:"root",factory:()=>Kn(op,mi.Optional|mi.SkipSelf)||function Aq(){return typeof $localize<"u"&&$localize.locale||s0}()});let UB=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new pl(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class fX{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}let Dq=(()=>{class t{compileModuleSync(n){return new wE(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),c=gf(Ai(n).declarations).reduce((f,v)=>{const b=qi(v);return b&&f.push(new _S(b)),f},[]);return new fX(r,c)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const WS=new Xn(""),Mk=new Xn("");let Ok,HB=(()=>{class t{constructor(n,r,s){this._ngZone=n,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Ok||(function TX(t){Ok=t}(s),s.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ji.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,s){let c=-1;r&&r>0&&(c=setTimeout(()=>{this._callbacks=this._callbacks.filter(f=>f.timeoutId!==c),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:c,updateCb:s})}whenStable(n,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,s){return[]}static#e=this.\u0275fac=function(r){return new(r||t)(hr(Ji),hr(kk),hr(Mk))};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac})}return t})(),kk=(()=>{class t{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return Ok?.findTestabilityInTree(this,n,r)??null}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})(),By=null;const kq=new Xn("AllowMultipleToken"),$B=new Xn("PlatformDestroyListeners"),qB=new Xn("appBootstrapListener");class Uy{constructor(e,n){this.name=e,this.token=n}}function En(t,e,n=[]){const r=`Platform: ${e}`,s=new Xn(r);return(c=[])=>{let f=Lk();if(!f||f.injector.get(kq,!1)){const v=[...n,...c,{provide:s,useValue:!0}];t?t(v):function Oq(t){if(By&&!By.get(kq,!1))throw new Gt(400,!1);(function Nk(){!function mV(t){fV=t}(()=>{throw new Gt(600,!1)})})(),By=t;const e=t.get(GB);(function ZS(t){t.get(fZ,null)?.forEach(n=>n())})(t)}(function Lq(t=[],e){return fh.create({name:e,providers:[{provide:$3,useValue:"platform"},{provide:$B,useValue:new Set([()=>By=null])},...t]})}(v,r))}return function E0(t){const e=Lk();if(!e)throw new Gt(401,!1);return e}()}}function Lk(){return By?.get(GB)??null}let GB=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const s=function KB(t="zone.js",e){return"noop"===t?new uS:"zone.js"===t?new Ji(e):t}(r?.ngZone,function Fk(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return s.run(()=>{const c=function sB(t,e,n){return new vE(t,e,n)}(n.moduleType,this.injector,function zk(t){return[{provide:Ji,useFactory:t},{provide:oS,multi:!0,useFactory:()=>{const e=Kn(Uk,{optional:!0});return()=>e.initialize()}},{provide:YB,useFactory:Fq},{provide:t2,useFactory:a4}]}(()=>s)),f=c.injector.get(si,null);return s.runOutsideAngular(()=>{const v=s.onError.subscribe({next:b=>{f.handleError(b)}});c.onDestroy(()=>{x0(this._modules,c),v.unsubscribe()})}),function WB(t,e,n){try{const r=n();return xr(r)?r.catch(s=>{throw e.runOutsideAngular(()=>t.handleError(s)),s}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(f,s,()=>{const v=c.injector.get(Tk);return v.runInitializers(),v.donePromise.then(()=>(function U8(t){ah(t,"Expected localeId to be defined"),"string"==typeof t&&(V2=t.toLowerCase().replace(/_/g,"-"))}(c.injector.get(op,s0)||s0),this._moduleDoBootstrap(c),c))})})}bootstrapModule(n,r=[]){const s=Vk({},r);return function CX(t,e,n){const r=new wE(n);return Promise.resolve(r)}(0,0,n).then(c=>this.bootstrapModuleFactory(c,s))}_moduleDoBootstrap(n){const r=n.injector.get(Ou);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(s=>r.bootstrap(s));else{if(!n.instance.ngDoBootstrap)throw new Gt(-403,!1);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Gt(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get($B,null);n&&(n.forEach(r=>r()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(r){return new(r||t)(hr(fh))};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();function Vk(t,e){return Array.isArray(e)?e.reduce(Vk,t):{...t,...e}}let Ou=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Kn(YB),this.zoneIsStable=Kn(t2),this.componentTypes=[],this.components=[],this.isStable=Kn(UB).hasPendingTasks.pipe(Pa(n=>n?Sr(!1):this.zoneIsStable),function JP(t,e=Zp){return t=t??LF,Ws((n,r)=>{let s,c=!0;n.subscribe(Bs(r,f=>{const v=e(f);(c||!t(s,v))&&(c=!1,s=v,r.next(f))}))})}(),XP()),this._injector=Kn(Au)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){const s=n instanceof a$;if(!this._injector.get(Tk).done)throw!s&&function Jg(t){const e=qi(t)||Ya(t)||Vl(t);return null!==e&&e.standalone}(n),new Gt(405,!1);let f;f=s?n:this._injector.get(aS).resolveComponentFactory(n),this.componentTypes.push(f.componentType);const v=function YS(t){return t.isBoundToModule}(f)?void 0:this._injector.get(nu),S=f.create(fh.NULL,[],r||f.selector,v),k=S.location.nativeElement,F=S.injector.get(WS,null);return F?.registerApplication(k),S.onDestroy(()=>{this.detachView(S.hostView),x0(this.components,S),F?.unregisterApplication(k)}),this._loadComponent(S),S}tick(){if(this._runningTick)throw new Gt(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;x0(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const r=this._injector.get(qB,[]);r.push(...this._bootstrapListeners),r.forEach(s=>s(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>x0(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new Gt(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function x0(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const YB=new Xn("",{providedIn:"root",factory:()=>Kn(si).handleError.bind(void 0)});function Fq(){const t=Kn(Ji),e=Kn(si);return n=>t.runOutsideAngular(()=>e.handleError(n))}let Uk=(()=>{class t{constructor(){this.zone=Kn(Ji),this.applicationRef=Kn(Ou)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();let Pf=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=Vq}return t})();function Vq(t){return function Bq(t,e,n){if(xm(t)&&!n){const r=Ma(t.index,e);return new yS(r,r)}return 47&t.type?new yS(e[vs],e):null}(Xa(),Bt(),16==(16&t))}class XB{constructor(){}supports(e){return p2(e)}create(e){return new XS(e)}}const zq=(t,e)=>e;class XS{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||zq}forEachItem(e){let n;for(n=this._itHead;null!==n;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,s=0,c=null;for(;n||r;){const f=!r||n&&n.currentIndex<qk(r,s,c)?n:r,v=qk(f,s,c),b=f.currentIndex;if(f===r)s--,r=r._nextRemoved;else if(n=n._next,null==f.previousIndex)s++;else{c||(c=[]);const S=v-s,k=b-s;if(S!=k){for(let H=0;H<S;H++){const Q=H<c.length?c[H]:c[H]=0,de=Q+H;k<=de&&de<S&&(c[H]=Q+1)}c[f.previousIndex]=k-S}}v!==b&&e(f,v,b)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)e(n)}diff(e){if(null==e&&(e=[]),!p2(e))throw new Gt(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let s,c,f,n=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let v=0;v<this.length;v++)c=e[v],f=this._trackByFn(v,c),null!==n&&Object.is(n.trackById,f)?(r&&(n=this._verifyReinsertion(n,c,f,v)),Object.is(n.item,c)||this._addIdentityChange(n,c)):(n=this._mismatch(n,c,f,v),r=!0),n=n._next}else s=0,function wS(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Symbol.iterator]();let r;for(;!(r=n.next()).done;)e(r.value)}}(e,v=>{f=this._trackByFn(s,v),null!==n&&Object.is(n.trackById,f)?(r&&(n=this._verifyReinsertion(n,v,f,s)),Object.is(n.item,v)||this._addIdentityChange(n,v)):(n=this._mismatch(n,v,f,s),r=!0),n=n._next,s++}),this.length=s;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,s){let c;return null===e?c=this._itTail:(c=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,c,s)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,s))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,c,s)):e=this._addAfter(new jq(n,r),c,s),e}_verifyReinsertion(e,n,r,s){let c=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==c?e=this._reinsertAfter(c,e._prev,s):e.currentIndex!=s&&(e.currentIndex=s,this._addToMoves(e,s)),e}_truncate(e){for(;null!==e;){const n=e._next;this._addToRemovals(this._unlink(e)),e=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const s=e._prevRemoved,c=e._nextRemoved;return null===s?this._removalsHead=c:s._nextRemoved=c,null===c?this._removalsTail=s:c._prevRemoved=s,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){const s=null===n?this._itHead:n._next;return e._next=s,e._prev=n,null===s?this._itTail=e:s._prev=e,null===n?this._itHead=e:n._next=e,null===this._linkedRecords&&(this._linkedRecords=new JB),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const n=e._prev,r=e._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new JB),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class jq{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class LX{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const n=e._prevDup,r=e._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class JB{constructor(){this.map=new Map}put(e){const n=e.trackById;let r=this.map.get(n);r||(r=new LX,this.map.set(n,r)),r.add(e)}get(e,n){const s=this.map.get(e);return s?s.get(e,n):null}remove(e){const n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function qk(t,e,n){const r=t.previousIndex;if(null===r)return r;let s=0;return n&&r<n.length&&(s=n[r]),r+e+s}class Gk{constructor(){}supports(e){return e instanceof Map||S4(e)}create(){return new Hq}}class Hq{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let n;for(n=this._mapHead;null!==n;n=n._next)e(n)}forEachPreviousItem(e){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)e(n)}forEachChangedItem(e){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}diff(e){if(e){if(!(e instanceof Map||S4(e)))throw new Gt(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,s)=>{if(n&&n.key===s)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{const c=this._getOrCreateRecordForKey(s,r);n=this._insertBeforeOrAppend(n,c)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,n){if(e){const r=e._prev;return n._next=e,n._prev=r,e._prev=n,r&&(r._next=n),e===this._mapHead&&(this._mapHead=n),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(e,n){if(this._records.has(e)){const s=this._records.get(e);this._maybeAddToChanges(s,n);const c=s._prev,f=s._next;return c&&(c._next=f),f&&(f._prev=c),s._next=null,s._prev=null,s}const r=new FX(e);return this._records.set(e,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,n){Object.is(n,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=n,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,n){e instanceof Map?e.forEach(n):Object.keys(e).forEach(r=>n(e[r],r))}}class FX{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function jy(){return new JS([new XB])}let JS=(()=>{class t{static#e=this.\u0275prov=jn({token:t,providedIn:"root",factory:jy});constructor(n){this.factories=n}static create(n,r){if(null!=r){const s=r.factories.slice();n=n.concat(s)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||jy()),deps:[[t,new jd,new zd]]}}find(n){const r=this.factories.find(s=>s.supports(n));if(null!=r)return r;throw new Gt(901,!1)}}return t})();function qq(){return new NE([new Gk])}let NE=(()=>{class t{static#e=this.\u0275prov=jn({token:t,providedIn:"root",factory:qq});constructor(n){this.factories=n}static create(n,r){if(r){const s=r.factories.slice();n=n.concat(s)}return new t(n)}static extend(n){return{provide:t,useFactory:r=>t.create(n,r||qq()),deps:[[t,new jd,new zd]]}}find(n){const r=this.factories.find(s=>s.supports(n));if(r)return r;throw new Gt(901,!1)}}return t})();const zX=En(null,"core",[]);let eU=(()=>{class t{constructor(n){}static#e=this.\u0275fac=function(r){return new(r||t)(hr(Ou))};static#t=this.\u0275mod=_s({type:t});static#n=this.\u0275inj=cs({})}return t})(),Zk=null;function Zm(){return Zk}class sU{}const ru=new Xn("DocumentToken");let LE=(()=>{class t{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:function(){return Kn(nG)},providedIn:"platform"})}return t})();const tG=new Xn("Location Initialized");let nG=(()=>{class t extends LE{constructor(){super(),this._doc=Kn(ru),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Zm().getBaseHref(this._doc)}onPopState(n){const r=Zm().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=Zm().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,s){this._history.pushState(n,r,s)}replaceState(n,r,s){this._history.replaceState(n,r,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:function(){return new t},providedIn:"platform"})}return t})();function Qk(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function rG(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function Qm(t){return t&&"?"!==t[0]?"?"+t:t}let D0=(()=>{class t{historyGo(n){throw new Error("Not implemented")}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:function(){return Kn(iG)},providedIn:"root"})}return t})();const eA=new Xn("appBaseHref");let iG=(()=>{class t extends D0{constructor(n,r){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Kn(ru).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return Qk(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+Qm(this._platformLocation.search),s=this._platformLocation.hash;return s&&n?`${r}${s}`:r}pushState(n,r,s,c){const f=this.prepareExternalUrl(s+Qm(c));this._platformLocation.pushState(n,r,f)}replaceState(n,r,s,c){const f=this.prepareExternalUrl(s+Qm(c));this._platformLocation.replaceState(n,r,f)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||t)(hr(LE),hr(eA,8))};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),oG=(()=>{class t extends D0{constructor(n,r){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(n){const r=Qk(this._baseHref,n);return r.length>0?"#"+r:r}pushState(n,r,s,c){let f=this.prepareExternalUrl(s+Qm(c));0==f.length&&(f=this._platformLocation.pathname),this._platformLocation.pushState(n,r,f)}replaceState(n,r,s,c){let f=this.prepareExternalUrl(s+Qm(c));0==f.length&&(f=this._platformLocation.pathname),this._platformLocation.replaceState(n,r,f)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static#e=this.\u0275fac=function(r){return new(r||t)(hr(LE),hr(eA,8))};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac})}return t})(),tA=(()=>{class t{constructor(n){this._subject=new Rr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const r=this._locationStrategy.getBaseHref();this._basePath=function cG(t){if(new RegExp("^(https?:)?//").test(t)){const[,n]=t.split(/\/\/[^\/]+/);return n}return t}(rG(lG(r))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+Qm(r))}normalize(n){return t.stripTrailingSlash(function aG(t,e){if(!t||!e.startsWith(t))return e;const n=e.substring(t.length);return""===n||["/",";","?","#"].includes(n[0])?n:e}(this._basePath,lG(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",s=null){this._locationStrategy.pushState(s,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Qm(r)),s)}replaceState(n,r="",s=null){this._locationStrategy.replaceState(s,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Qm(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(s=>s(n,r))}subscribe(n,r,s){return this._subject.subscribe({next:n,error:r,complete:s})}static#e=this.normalizeQueryParams=Qm;static#t=this.joinWithSlash=Qk;static#n=this.stripTrailingSlash=rG;static#r=this.\u0275fac=function(r){return new(r||t)(hr(D0))};static#i=this.\u0275prov=jn({token:t,factory:function(){return function sG(){return new tA(hr(D0))}()},providedIn:"root"})}return t})();function lG(t){return t.replace(/\/index.html$/,"")}const yU=/\s+/,EG=[];let hp=(()=>{class t{constructor(n,r,s,c){this._iterableDiffers=n,this._keyValueDiffers=r,this._ngEl=s,this._renderer=c,this.initialClasses=EG,this.stateMap=new Map}set klass(n){this.initialClasses=null!=n?n.trim().split(yU):EG}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split(yU):n}ngDoCheck(){for(const r of this.initialClasses)this._updateState(r,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const r of n)this._updateState(r,!0);else if(null!=n)for(const r of Object.keys(n))this._updateState(r,!!n[r]);this._applyStateDiff()}_updateState(n,r){const s=this.stateMap.get(n);void 0!==s?(s.enabled!==r&&(s.changed=!0,s.enabled=r),s.touched=!0):this.stateMap.set(n,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const r=n[0],s=n[1];s.changed?(this._toggleClass(r,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),s.touched=!1}}_toggleClass(n,r){(n=n.trim()).length>0&&n.split(yU).forEach(s=>{r?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}static#e=this.\u0275fac=function(r){return new(r||t)(vt(JS),vt(NE),vt(yl),vt(Kc))};static#t=this.\u0275dir=vr({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return t})();class aJ{constructor(e,n,r,s){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let cA=(()=>{class t{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,r,s){this._viewContainer=n,this._template=r,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const r=this._viewContainer;n.forEachOperation((s,c,f)=>{if(null==s.previousIndex)r.createEmbeddedView(this._template,new aJ(s.item,this._ngForOf,-1,-1),null===f?void 0:f);else if(null==f)r.remove(null===c?void 0:c);else if(null!==c){const v=r.get(c);r.move(v,f),uA(v,s)}});for(let s=0,c=r.length;s<c;s++){const v=r.get(s).context;v.index=s,v.count=c,v.ngForOf=this._ngForOf}n.forEachIdentityChange(s=>{uA(r.get(s.currentIndex),s)})}static ngTemplateContextGuard(n,r){return!0}static#e=this.\u0275fac=function(r){return new(r||t)(vt(Na),vt(nd),vt(JS))};static#t=this.\u0275dir=vr({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return t})();function uA(t,e){t.context.$implicit=e.item}let dp=(()=>{class t{constructor(n,r){this._viewContainer=n,this._context=new hA,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){Jm("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){Jm("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}static#e=this.\u0275fac=function(r){return new(r||t)(vt(Na),vt(nd))};static#t=this.\u0275dir=vr({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return t})();class hA{constructor(){this.$implicit=null,this.ngIf=null}}function Jm(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${_a(e)}'.`)}let Ky=(()=>{class t{constructor(n){this._viewContainerRef=n,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(n){if(n.ngTemplateOutlet||n.ngTemplateOutletInjector){const r=this._viewContainerRef;if(this._viewRef&&r.remove(r.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:s,ngTemplateOutletContext:c,ngTemplateOutletInjector:f}=this;this._viewRef=r.createEmbeddedView(s,c,f?{injector:f}:void 0)}else this._viewRef=null}else this._viewRef&&n.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}static#e=this.\u0275fac=function(r){return new(r||t)(vt(Na))};static#t=this.\u0275dir=vr({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[ml]})}return t})();class uJ{createSubscription(e,n){return AR(()=>e.subscribe({next:n,error:r=>{throw r}}))}dispose(e){AR(()=>e.unsubscribe())}}class dA{createSubscription(e,n){return e.then(n,r=>{throw r})}dispose(e){}}const bU=new dA,IG=new uJ;let EU=(()=>{class t{constructor(n){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=n}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(n){return this._obj?n!==this._obj?(this._dispose(),this.transform(n)):this._latestValue:(n&&this._subscribe(n),this._latestValue)}_subscribe(n){this._obj=n,this._strategy=this._selectStrategy(n),this._subscription=this._strategy.createSubscription(n,r=>this._updateLatestValue(n,r))}_selectStrategy(n){if(xr(n))return bU;if($r(n))return IG;throw function ad(t,e){return new Gt(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(n,r){n===this._obj&&(this._latestValue=r,this._ref.markForCheck())}static#e=this.\u0275fac=function(r){return new(r||t)(vt(Pf,16))};static#t=this.\u0275pipe=yc({name:"async",type:t,pure:!1,standalone:!0})}return t})(),ld=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=_s({type:t});static#n=this.\u0275inj=cs({})}return t})();function cO(t){return"server"===t}let Yy=(()=>{class t{static#e=this.\u0275prov=jn({token:t,providedIn:"root",factory:()=>new bJ(hr(ru),window)})}return t})();class bJ{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const n=function Zy(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&"function"==typeof t.body.attachShadow){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let s=r.currentNode;for(;s;){const c=s.shadowRoot;if(c){const f=c.getElementById(e)||c.querySelector(`[name="${e}"]`);if(f)return f}s=r.nextNode()}}return null}(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,s=n.top+this.window.pageYOffset,c=this.offset();this.window.scrollTo(r-c[0],s-c[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class LJ extends sU{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class LU extends LJ{static makeCurrent(){!function eG(t){Zk||(Zk=t)}(new LU)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function $G(){return EA=EA||document.querySelector("base"),EA?EA.getAttribute("href"):null}();return null==n?null:function xA(t){gO=gO||document.createElement("a"),gO.setAttribute("href",t);const e=gO.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){EA=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function bG(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[s,c]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(s.trim()===e)return decodeURIComponent(c)}return null}(document.cookie,e)}}let gO,EA=null,qG=(()=>{class t{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac})}return t})();const FU=new Xn("EventManagerPlugins");let VU=(()=>{class t{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,s){return this._findPluginFor(r).addEventListener(n,r,s)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(c=>c.supports(n)),!r)throw new Gt(5101,!1);return this._eventNameToPlugin.set(n,r),r}static#e=this.\u0275fac=function(r){return new(r||t)(hr(FU),hr(Ji))};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac})}return t})();class GG{constructor(e){this._doc=e}}const BU="ng-app-id";let KG=(()=>{class t{constructor(n,r,s,c={}){this.doc=n,this.appId=r,this.nonce=s,this.platformId=c,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=cO(c),this.resetHostNodes()}addStyles(n){for(const r of n)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(n){for(const r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){const r=this.styleRef;r.get(n)?.elements?.forEach(s=>s.remove()),r.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${BU}="${this.appId}"]`);if(n?.length){const r=new Map;return n.forEach(s=>{null!=s.textContent&&r.set(s.textContent,s)}),r}return null}changeUsageCount(n,r){const s=this.styleRef;if(s.has(n)){const c=s.get(n);return c.usage+=r,c.usage}return s.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){const s=this.styleNodesInDOM,c=s?.get(r);if(c?.parentNode===n)return s.delete(r),c.removeAttribute(BU),c;{const f=this.doc.createElement("style");return this.nonce&&f.setAttribute("nonce",this.nonce),f.textContent=r,this.platformIsServer&&f.setAttribute(BU,this.appId),f}}addStyleToHost(n,r){const s=this.getStyleElement(n,r);n.appendChild(s);const c=this.styleRef,f=c.get(r)?.elements;f?f.push(s):c.set(r,{elements:[s],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}static#e=this.\u0275fac=function(r){return new(r||t)(hr(ru),hr(qM),hr(e$,8),hr(R1))};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac})}return t})();const tx={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},yO=/%COMP%/g,nx=new Xn("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function zU(t,e){return e.map(n=>n.replace(yO,t))}let XG=(()=>{class t{constructor(n,r,s,c,f,v,b,S=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=s,this.removeStylesOnCompDestroy=c,this.doc=f,this.platformId=v,this.ngZone=b,this.nonce=S,this.rendererByCompId=new Map,this.platformIsServer=cO(v),this.defaultRenderer=new jU(n,f,b,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===xu.ShadowDom&&(r={...r,encapsulation:xu.Emulated});const s=this.getOrCreateRenderer(n,r);return s instanceof JG?s.applyToHost(n):s instanceof Xy&&s.applyStyles(),s}getOrCreateRenderer(n,r){const s=this.rendererByCompId;let c=s.get(r.id);if(!c){const f=this.doc,v=this.ngZone,b=this.eventManager,S=this.sharedStylesHost,k=this.removeStylesOnCompDestroy,F=this.platformIsServer;switch(r.encapsulation){case xu.Emulated:c=new JG(b,S,r,this.appId,k,f,v,F);break;case xu.ShadowDom:return new BJ(b,S,n,r,f,v,this.nonce,F);default:c=new Xy(b,S,r,k,f,v,F)}s.set(r.id,c)}return c}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(r){return new(r||t)(hr(VU),hr(KG),hr(qM),hr(nx),hr(ru),hr(R1),hr(Ji),hr(e$))};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac})}return t})();class jU{constructor(e,n,r,s){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=s,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(tx[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(HU(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(HU(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new Gt(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,s){if(s){n=s+":"+n;const c=tx[s];c?e.setAttributeNS(c,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const s=tx[r];s?e.removeAttributeNS(s,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,s){s&(Hd.DashCase|Hd.Important)?e.style.setProperty(n,r,s&Hd.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Hd.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e[n]=r}setValue(e,n){e.nodeValue=n}listen(e,n,r){if("string"==typeof e&&!(e=Zm().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if("__ngUnwrap__"===n)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))&&n.preventDefault()}}}function HU(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class BJ extends jU{constructor(e,n,r,s,c,f,v,b){super(e,c,f,b),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const S=zU(s.id,s.styles);for(const k of S){const F=document.createElement("style");v&&F.setAttribute("nonce",v),F.textContent=k,this.shadowRoot.appendChild(F)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Xy extends jU{constructor(e,n,r,s,c,f,v,b){super(e,c,f,v),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=s,this.styles=b?zU(b,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class JG extends Xy{constructor(e,n,r,s,c,f,v,b){const S=s+"-"+r.id;super(e,n,r,c,f,v,b,S),this.contentAttr=function ZG(t){return"_ngcontent-%COMP%".replace(yO,t)}(S),this.hostAttr=function QG(t){return"_nghost-%COMP%".replace(yO,t)}(S)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}let UJ=(()=>{class t extends GG{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,s){return n.addEventListener(r,s,!1),()=>this.removeEventListener(n,r,s)}removeEventListener(n,r,s){return n.removeEventListener(r,s)}static#e=this.\u0275fac=function(r){return new(r||t)(hr(ru))};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac})}return t})();const e9=["alt","control","meta","shift"],U0={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},nc={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let $U=(()=>{class t extends GG{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,s){const c=t.parseEventName(r),f=t.eventCallback(c.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Zm().onAndCancel(n,c.domEventName,f))}static parseEventName(n){const r=n.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const c=t._normalizeKey(r.pop());let f="",v=r.indexOf("code");if(v>-1&&(r.splice(v,1),f="code."),e9.forEach(S=>{const k=r.indexOf(S);k>-1&&(r.splice(k,1),f+=S+".")}),f+=c,0!=r.length||0===c.length)return null;const b={};return b.domEventName=s,b.fullKey=f,b}static matchEventFullKeyCode(n,r){let s=U0[n.key]||n.key,c="";return r.indexOf("code.")>-1&&(s=n.code,c="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),e9.forEach(f=>{f!==s&&(0,nc[f])(n)&&(c+=f+".")}),c+=s,c===r)}static eventCallback(n,r,s){return c=>{t.matchEventFullKeyCode(c,n)&&s.runGuarded(()=>r(c))}}static _normalizeKey(n){return"esc"===n?"escape":n}static#e=this.\u0275fac=function(r){return new(r||t)(hr(ru))};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac})}return t})();const e_=[{provide:R1,useValue:"browser"},{provide:fZ,useValue:function TA(){LU.makeCurrent()},multi:!0},{provide:ru,useFactory:function Of(){return function HY(t){V3=t}(document),document},deps:[]}],j0=En(zX,"browser",e_),CA=new Xn(""),t_=[{provide:Mk,useClass:class FJ{addToWindow(e){Zo.getAngularTestability=(r,s=!0)=>{const c=e.findTestabilityInTree(r,s);if(null==c)throw new Gt(5103,!1);return c},Zo.getAllAngularTestabilities=()=>e.getAllTestabilities(),Zo.getAllAngularRootElements=()=>e.getAllRootElements(),Zo.frameworkStabilizers||(Zo.frameworkStabilizers=[]),Zo.frameworkStabilizers.push(r=>{const s=Zo.getAllAngularTestabilities();let c=s.length,f=!1;const v=function(b){f=f||b,c--,0==c&&r(f)};s.forEach(b=>{b.whenStable(v)})})}findTestabilityInTree(e,n,r){return null==n?null:e.getTestability(n)??(r?Zm().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},deps:[]},{provide:WS,useClass:HB,deps:[Ji,kk,Mk]},{provide:HB,useClass:HB,deps:[Ji,kk,Mk]}],n_=[{provide:$3,useValue:"root"},{provide:si,useFactory:function z0(){return new si},deps:[]},{provide:FU,useClass:UJ,multi:!0,deps:[ru,Ji,R1]},{provide:FU,useClass:$U,multi:!0,deps:[ru]},XG,KG,VU,{provide:IZ,useExisting:XG},{provide:class ZE{},useClass:qG,deps:[]},[]];let t9=(()=>{class t{constructor(n){}static withServerTransition(n){return{ngModule:t,providers:[{provide:qM,useValue:n.appId}]}}static#e=this.\u0275fac=function(r){return new(r||t)(hr(CA,12))};static#t=this.\u0275mod=_s({type:t});static#n=this.\u0275inj=cs({providers:[...n_,...t_],imports:[ld,eU]})}return t})(),wO=(()=>{class t{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static#e=this.\u0275fac=function(r){return new(r||t)(hr(ru))};static#t=this.\u0275prov=jn({token:t,factory:function(r){let s=null;return s=r?new r:function ix(){return new wO(hr(ru))}(),s},providedIn:"root"})}return t})();typeof window<"u"&&window;const{isArray:TO}=Array,{getPrototypeOf:ox,prototype:ZU,keys:CO}=Object;const{isArray:XU}=Array;function sx(t){return go(e=>function JU(t,e){return XU(e)?t(...e):t(e)}(t,e))}const Wi=new Xn("NgValueAccessor"),Y0=new Xn("CallSetDisabledState",{providedIn:"root",factory:()=>c_}),c_="always";let D9=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=_s({type:t});static#n=this.\u0275inj=cs({})}return t})(),dg=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=_s({type:t});static#n=this.\u0275inj=cs({imports:[D9]})}return t})(),H9=(()=>{class t{static withConfig(n){return{ngModule:t,providers:[{provide:Y0,useValue:n.callSetDisabledState??c_}]}}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=_s({type:t});static#n=this.\u0275inj=cs({imports:[dg]})}return t})();function d_(t){return!!t&&(t instanceof ls||Si(t.lift)&&Si(t.subscribe))}function UA(...t){const e=ym(t),n=function $C(t){return Si(Sb(t))?t.pop():void 0}(t),{args:r,keys:s}=function IO(t){if(1===t.length){const e=t[0];if(TO(e))return{args:e,keys:null};if(function QU(t){return t&&"object"==typeof t&&ox(t)===ZU}(e)){const n=CO(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}(t);if(0===r.length)return ki([],e);const c=new ls(function gee(t,e,n=Zp){return r=>{$9(e,()=>{const{length:s}=t,c=new Array(s);let f=s,v=s;for(let b=0;b<s;b++)$9(e,()=>{const S=ki(t[b],e);let k=!1;S.subscribe(Bs(r,F=>{c[b]=F,k||(k=!0,v--),v||r.next(n(c.slice()))},()=>{--f||r.complete()}))},r)},r)}}(r,e,s?f=>function ez(t,e){return t.reduce((n,r,s)=>(n[r]=e[s],n),{})}(s,f):Zp));return n?c.pipe(sx(n)):c}function $9(t,e,n){t?$h(n,t,e):e()}const XO=Nl(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function JO(...t){return function Az(){return gm(1)}()(ki(t,ym(t)))}function Dz(t){return new ls(e=>{Wa(t()).subscribe(e)})}function zA(t,e){const n=Si(t)?t:()=>t,r=s=>s.error(n());return new ls(e?s=>e.schedule(r,0,s):r)}function eN(){return Ws((t,e)=>{let n=null;t._refCount++;const r=Bs(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(n=null);const s=t._connection,c=n;n=null,s&&(!c||s===c)&&s.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}class tN extends ls{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,FP(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new aa;const n=this.getSubject();e.add(this.source.subscribe(Bs(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=aa.EMPTY)}return e}refCount(){return eN()(this)}}function Vf(t){return t<=0?()=>sh:Ws((e,n)=>{let r=0;e.subscribe(Bs(n,s=>{++r<=t&&(n.next(s),t<=r&&n.complete())}))})}function pg(t,e){return Ws((n,r)=>{let s=0;n.subscribe(Bs(r,c=>t.call(e,c,s++)&&r.next(c)))})}function nN(t){return Ws((e,n)=>{let r=!1;e.subscribe(Bs(n,s=>{r=!0,n.next(s)},()=>{r||n.next(t),n.complete()}))})}function q9(t=_ee){return Ws((e,n)=>{let r=!1;e.subscribe(Bs(n,s=>{r=!0,n.next(s)},()=>r?n.complete():n.error(t())))})}function _ee(){return new XO}function p_(t,e){const n=arguments.length>=2;return r=>r.pipe(t?pg((s,c)=>t(s,c,r)):Zp,Vf(1),n?nN(e):q9(()=>new XO))}function jA(t,e){return Si(e)?la(t,e,1):la(t,1)}function rc(t,e,n){const r=Si(t)||e||n?{next:t,error:e,complete:n}:t;return r?Ws((s,c)=>{var f;null===(f=r.subscribe)||void 0===f||f.call(r);let v=!0;s.subscribe(Bs(c,b=>{var S;null===(S=r.next)||void 0===S||S.call(r,b),c.next(b)},()=>{var b;v=!1,null===(b=r.complete)||void 0===b||b.call(r),c.complete()},b=>{var S;v=!1,null===(S=r.error)||void 0===S||S.call(r,b),c.error(b)},()=>{var b,S;v&&(null===(b=r.unsubscribe)||void 0===b||b.call(r)),null===(S=r.finalize)||void 0===S||S.call(r)}))}):Zp}function ew(t){return Ws((e,n)=>{let c,r=null,s=!1;r=e.subscribe(Bs(n,void 0,void 0,f=>{c=Wa(t(f,ew(t)(e))),r?(r.unsubscribe(),r=null,c.subscribe(n)):s=!0})),s&&(r.unsubscribe(),r=null,c.subscribe(n))})}function Sx(t){return t<=0?()=>sh:Ws((e,n)=>{let r=[];e.subscribe(Bs(n,s=>{r.push(s),t<r.length&&r.shift()},()=>{for(const s of r)n.next(s);n.complete()},void 0,()=>{r=null}))})}function Rz(t){return go(()=>t)}function Ax(t){return Ws((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}const ii="primary",fg=Symbol("RouteTitle");class fd{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function nw(t){return new fd(t)}function Mz(t,e,n){const r=n.path.split("/");if(r.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const s={};for(let c=0;c<r.length;c++){const f=r[c],v=t[c];if(f.startsWith(":"))s[f.substring(1)]=v;else if(f!==v.path)return null}return{consumed:t.slice(0,r.length),posParams:s}}function yp(t,e){const n=t?Object.keys(t):void 0,r=e?Object.keys(e):void 0;if(!n||!r||n.length!=r.length)return!1;let s;for(let c=0;c<n.length;c++)if(s=n[c],!kz(t[s],e[s]))return!1;return!0}function kz(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),r=[...e].sort();return n.every((s,c)=>r[c]===s)}return t===e}function Oz(t){return t.length>0?t[t.length-1]:null}function mg(t){return d_(t)?t:xr(t)?ki(Promise.resolve(t)):Sr(t)}const iN={exact:function W9(t,e,n){if(!rw(t.segments,e.segments)||!gg(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!t.children[r]||!W9(t.children[r],e.children[r],n))return!1;return!0},subset:Y9},G9={exact:function oN(t,e){return yp(t,e)},subset:function wee(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>kz(t[n],e[n]))},ignored:()=>!0};function K9(t,e,n){return iN[n.paths](t.root,e.root,n.matrixParams)&&G9[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function Y9(t,e,n){return Z9(t,e,e.segments,n)}function Z9(t,e,n,r){if(t.segments.length>n.length){const s=t.segments.slice(0,n.length);return!(!rw(s,n)||e.hasChildren()||!gg(s,n,r))}if(t.segments.length===n.length){if(!rw(t.segments,n)||!gg(t.segments,n,r))return!1;for(const s in e.children)if(!t.children[s]||!Y9(t.children[s],e.children[s],r))return!1;return!0}{const s=n.slice(0,t.segments.length),c=n.slice(t.segments.length);return!!(rw(t.segments,s)&&gg(t.segments,s,r)&&t.children[ii])&&Z9(t.children[ii],e,c,r)}}function gg(t,e,n){return e.every((r,s)=>G9[n](t[s].parameters,r.parameters))}class Dx{constructor(e=new qo([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=nw(this.queryParams)),this._queryParamMap}toString(){return xee.serialize(this)}}class qo{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return sN(this)}}class Px{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=nw(this.parameters)),this._parameterMap}toString(){return J9(this)}}function rw(t,e){return t.length===e.length&&t.every((n,r)=>n.path===e[r].path)}let Rx=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:function(){return new Nz},providedIn:"root"})}return t})();class Nz{parse(e){const n=new Ree(e);return new Dx(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){const n=`/${Mx(e.root,!0)}`,r=function Cee(t){const e=Object.keys(t).map(n=>{const r=t[n];return Array.isArray(r)?r.map(s=>`${aN(n)}=${aN(s)}`).join("&"):`${aN(n)}=${aN(r)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${n}${r}${"string"==typeof e.fragment?`#${function $A(t){return encodeURI(t)}(e.fragment)}`:""}`}}const xee=new Nz;function sN(t){return t.segments.map(e=>J9(e)).join("/")}function Mx(t,e){if(!t.hasChildren())return sN(t);if(e){const n=t.children[ii]?Mx(t.children[ii],!1):"",r=[];return Object.entries(t.children).forEach(([s,c])=>{s!==ii&&r.push(`${s}:${Mx(c,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function Eee(t,e){let n=[];return Object.entries(t.children).forEach(([r,s])=>{r===ii&&(n=n.concat(e(s,r)))}),Object.entries(t.children).forEach(([r,s])=>{r!==ii&&(n=n.concat(e(s,r)))}),n}(t,(r,s)=>s===ii?[Mx(t.children[ii],!1)]:[`${s}:${Mx(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[ii]?`${sN(t)}/${n[0]}`:`${sN(t)}/(${n.join("//")})`}}function Q9(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function aN(t){return Q9(t).replace(/%3B/gi,";")}function iw(t){return Q9(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function qA(t){return decodeURIComponent(t)}function X9(t){return qA(t.replace(/\+/g,"%20"))}function J9(t){return`${iw(t.path)}${function Tee(t){return Object.keys(t).map(e=>`;${iw(e)}=${iw(t[e])}`).join("")}(t.parameters)}`}const Iee=/^[^\/()?;#]+/;function lN(t){const e=t.match(Iee);return e?e[0]:""}const e7=/^[^\/()?;=#]+/,Aee=/^[^=?&#]+/,Pee=/^[^&#]+/;class Ree{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new qo([],{}):new qo([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[ii]=new qo(e,n)),r}parseSegment(){const e=lN(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Gt(4009,!1);return this.capture(e),new Px(qA(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const n=function See(t){const e=t.match(e7);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const s=lN(this.remaining);s&&(r=s,this.capture(r))}e[qA(n)]=qA(r)}parseQueryParam(e){const n=function Dee(t){const e=t.match(Aee);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const f=function t7(t){const e=t.match(Pee);return e?e[0]:""}(this.remaining);f&&(r=f,this.capture(r))}const s=X9(n),c=X9(r);if(e.hasOwnProperty(s)){let f=e[s];Array.isArray(f)||(f=[f],e[s]=f),f.push(c)}else e[s]=c}parseParens(e){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=lN(this.remaining),s=this.remaining[r.length];if("/"!==s&&")"!==s&&";"!==s)throw new Gt(4010,!1);let c;r.indexOf(":")>-1?(c=r.slice(0,r.indexOf(":")),this.capture(c),this.capture(":")):e&&(c=ii);const f=this.parseChildren();n[c]=1===Object.keys(f).length?f[ii]:new qo([],f),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Gt(4011,!1)}}function n7(t){return t.segments.length>0?new qo([],{[ii]:t}):t}function r7(t){const e={};for(const r of Object.keys(t.children)){const c=r7(t.children[r]);if(r===ii&&0===c.segments.length&&c.hasChildren())for(const[f,v]of Object.entries(c.children))e[f]=v;else(c.segments.length>0||c.hasChildren())&&(e[r]=c)}return function i7(t){if(1===t.numberOfChildren&&t.children[ii]){const e=t.children[ii];return new qo(t.segments.concat(e.segments),e.children)}return t}(new qo(t.segments,e))}function ow(t){return t instanceof Dx}function Lz(t){let e;const s=n7(function n(c){const f={};for(const b of c.children){const S=n(b);f[b.outlet]=S}const v=new qo(c.url,f);return c===t&&(e=v),v}(t.root));return e??s}function Fz(t,e,n,r){let s=t;for(;s.parent;)s=s.parent;if(0===e.length)return Vz(s,s,s,n,r);const c=function Bz(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new s7(!0,0,t);let e=0,n=!1;const r=t.reduce((s,c,f)=>{if("object"==typeof c&&null!=c){if(c.outlets){const v={};return Object.entries(c.outlets).forEach(([b,S])=>{v[b]="string"==typeof S?S.split("/"):S}),[...s,{outlets:v}]}if(c.segmentPath)return[...s,c.segmentPath]}return"string"!=typeof c?[...s,c]:0===f?(c.split("/").forEach((v,b)=>{0==b&&"."===v||(0==b&&""===v?n=!0:".."===v?e++:""!=v&&s.push(v))}),s):[...s,c]},[]);return new s7(n,e,r)}(e);if(c.toRoot())return Vz(s,s,new qo([],{}),n,r);const f=function kee(t,e,n){if(t.isAbsolute)return new kx(e,!0,0);if(!n)return new kx(e,!1,NaN);if(null===n.parent)return new kx(n,!0,0);const r=cN(t.commands[0])?0:1;return function Uz(t,e,n){let r=t,s=e,c=n;for(;c>s;){if(c-=s,r=r.parent,!r)throw new Gt(4005,!1);s=r.segments.length}return new kx(r,!1,s-c)}(n,n.segments.length-1+r,t.numberOfDoubleDots)}(c,s,t),v=f.processChildren?md(f.segmentGroup,f.index,c.commands):zz(f.segmentGroup,f.index,c.commands);return Vz(s,f.segmentGroup,v,n,r)}function cN(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function GA(t){return"object"==typeof t&&null!=t&&t.outlets}function Vz(t,e,n,r,s){let f,c={};r&&Object.entries(r).forEach(([b,S])=>{c[b]=Array.isArray(S)?S.map(k=>`${k}`):`${S}`}),f=t===e?n:o7(t,e,n);const v=n7(r7(f));return new Dx(v,c,s)}function o7(t,e,n){const r={};return Object.entries(t.children).forEach(([s,c])=>{r[s]=c===e?n:o7(c,e,n)}),new qo(t.segments,r)}class s7{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&cN(r[0]))throw new Gt(4003,!1);const s=r.find(GA);if(s&&s!==Oz(r))throw new Gt(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class kx{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}}function zz(t,e,n){if(t||(t=new qo([],{})),0===t.segments.length&&t.hasChildren())return md(t,e,n);const r=function Ox(t,e,n){let r=0,s=e;const c={match:!1,pathIndex:0,commandIndex:0};for(;s<t.segments.length;){if(r>=n.length)return c;const f=t.segments[s],v=n[r];if(GA(v))break;const b=`${v}`,S=r<n.length-1?n[r+1]:null;if(s>0&&void 0===b)break;if(b&&S&&"object"==typeof S&&void 0===S.outlets){if(!xl(b,S,f))return c;r+=2}else{if(!xl(b,{},f))return c;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}(t,e,n),s=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const c=new qo(t.segments.slice(0,r.pathIndex),{});return c.children[ii]=new qo(t.segments.slice(r.pathIndex),t.children),md(c,0,s)}return r.match&&0===s.length?new qo(t.segments,{}):r.match&&!t.hasChildren()?jz(t,e,n):r.match?md(t,0,s):jz(t,e,n)}function md(t,e,n){if(0===n.length)return new qo(t.segments,{});{const r=function Oee(t){return GA(t[0])?t[0].outlets:{[ii]:t}}(n),s={};if(Object.keys(r).some(c=>c!==ii)&&t.children[ii]&&1===t.numberOfChildren&&0===t.children[ii].segments.length){const c=md(t.children[ii],e,n);return new qo(t.segments,c.children)}return Object.entries(r).forEach(([c,f])=>{"string"==typeof f&&(f=[f]),null!==f&&(s[c]=zz(t.children[c],e,f))}),Object.entries(t.children).forEach(([c,f])=>{void 0===r[c]&&(s[c]=f)}),new qo(t.segments,s)}}function jz(t,e,n){const r=t.segments.slice(0,e);let s=0;for(;s<n.length;){const c=n[s];if(GA(c)){const b=Nee(c.outlets);return new qo(r,b)}if(0===s&&cN(n[0])){r.push(new Px(t.segments[e].path,Hz(n[0]))),s++;continue}const f=GA(c)?c.outlets[ii]:`${c}`,v=s<n.length-1?n[s+1]:null;f&&v&&cN(v)?(r.push(new Px(f,Hz(v))),s+=2):(r.push(new Px(f,{})),s++)}return new qo(r,{})}function Nee(t){const e={};return Object.entries(t).forEach(([n,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(e[n]=jz(new qo([],{}),0,r))}),e}function Hz(t){const e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function xl(t,e,n){return t==n.path&&yp(e,n.parameters)}const Wn="imperative";class _p{constructor(e,n){this.id=e,this.url=n}}class jt extends _p{constructor(e,n,r="imperative",s=null){super(e,n),this.type=0,this.navigationTrigger=r,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Lt extends _p{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class KA extends _p{constructor(e,n,r,s){super(e,n),this.reason=r,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class f_ extends _p{constructor(e,n,r,s){super(e,n),this.reason=r,this.code=s,this.type=16}}class WA extends _p{constructor(e,n,r,s){super(e,n),this.error=r,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ou extends _p{constructor(e,n,r,s){super(e,n),this.urlAfterRedirects=r,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Oo extends _p{constructor(e,n,r,s){super(e,n),this.urlAfterRedirects=r,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Gr extends _p{constructor(e,n,r,s,c){super(e,n),this.urlAfterRedirects=r,this.state=s,this.shouldActivate=c,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Kr extends _p{constructor(e,n,r,s){super(e,n),this.urlAfterRedirects=r,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class uN extends _p{constructor(e,n,r,s){super(e,n),this.urlAfterRedirects=r,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ch{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ol{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class sw{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ti{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Nx{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class YA{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ZA{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Lx{}class vp{constructor(e){this.url=e}}class Mr{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ih,this.attachRef=null}}let Ih=(()=>{class t{constructor(){this.contexts=new Map}onChildOutletCreated(n,r){const s=this.getOrCreateContext(n);s.outlet=r,this.contexts.set(n,s)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new Mr,this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class Sh{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){const n=vo(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){const n=vo(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){const n=Fx(e,this._root);return n.length<2?[]:n[n.length-2].children.map(s=>s.value).filter(s=>s!==e)}pathFromRoot(e){return Fx(e,this._root).map(n=>n.value)}}function vo(t,e){if(t===e.value)return e;for(const n of e.children){const r=vo(t,n);if(r)return r}return null}function Fx(t,e){if(t===e.value)return[e];for(const n of e.children){const r=Fx(t,n);if(r.length)return r.unshift(e),r}return[]}class Hu{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}}function Ah(t){const e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}class Vx extends Sh{constructor(e,n){super(e),this.snapshot=n,hN(this,e)}toString(){return this.snapshot.toString()}}function yg(t,e){const n=function $z(t,e){const f=new je([],{},{},"",{},ii,e,null,{});return new Ux("",new Hu(f,[]))}(0,e),r=new pl([new Px("",{})]),s=new pl({}),c=new pl({}),f=new pl({}),v=new pl(""),b=new Js(r,s,f,v,c,ii,e,n.root);return b.snapshot=n.root,new Vx(new Hu(b,[]),n)}class Js{constructor(e,n,r,s,c,f,v,b){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=s,this.dataSubject=c,this.outlet=f,this.component=v,this._futureSnapshot=b,this.title=this.dataSubject?.pipe(go(S=>S[fg]))??Sr(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=s,this.data=c}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(go(e=>nw(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(go(e=>nw(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Bx(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const s=n[r],c=n[r-1];if(s.routeConfig&&""===s.routeConfig.path)r--;else{if(c.component)break;r--}}return function su(t){return t.reduce((e,n)=>({params:{...e.params,...n.params},data:{...e.data,...n.data},resolve:{...n.data,...e.resolve,...n.routeConfig?.data,...n._resolvedData}}),{params:{},data:{},resolve:{}})}(n.slice(r))}class je{get title(){return this.data?.[fg]}constructor(e,n,r,s,c,f,v,b,S){this.url=e,this.params=n,this.queryParams=r,this.fragment=s,this.data=c,this.outlet=f,this.component=v,this.routeConfig=b,this._resolve=S}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=nw(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=nw(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ux extends Sh{constructor(e,n){super(n),this.url=e,hN(this,n)}toString(){return ic(this._root)}}function hN(t,e){e.value._routerState=t,e.children.forEach(n=>hN(t,n))}function ic(t){const e=t.children.length>0?` { ${t.children.map(ic).join(", ")} } `:"";return`${t.value}${e}`}function dN(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,yp(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),yp(e.params,n.params)||t.paramsSubject.next(n.params),function vee(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!yp(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.urlSubject.next(n.url),yp(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function QA(t,e){const n=yp(t.params,e.params)&&function bee(t,e){return rw(t,e)&&t.every((n,r)=>yp(n.parameters,e[r].parameters))}(t.url,e.url);return n&&!(!t.parent!=!e.parent)&&(!t.parent||QA(t.parent,e.parent))}let qz=(()=>{class t{constructor(){this.activated=null,this._activatedRoute=null,this.name=ii,this.activateEvents=new Rr,this.deactivateEvents=new Rr,this.attachEvents=new Rr,this.detachEvents=new Rr,this.parentContexts=Kn(Ih),this.location=Kn(Na),this.changeDetector=Kn(Pf),this.environmentInjector=Kn(Au),this.inputBinder=Kn(m_,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:r,previousValue:s}=n.name;if(r)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Gt(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Gt(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Gt(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new Gt(4013,!1);this._activatedRoute=n;const s=this.location,f=n.snapshot.component,v=this.parentContexts.getOrCreateContext(this.name).children,b=new XA(n,v,s.injector);this.activated=s.createComponent(f,{index:s.length,injector:b,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275dir=vr({type:t,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ml]})}return t})();class XA{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Js?this.route:e===Ih?this.childContexts:this.parent.get(e,n)}}const m_=new Xn("");let Cl=(()=>{class t{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:r}=n,s=UA([r.queryParams,r.params,r.data]).pipe(Pa(([c,f,v],b)=>(v={...c,...f,...v},0===b?Sr(v):Promise.resolve(v)))).subscribe(c=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(n);const f=function Jq(t){const e=qi(t);if(!e)return null;const n=new _S(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(r.component);if(f)for(const{templateName:v}of f.inputs)n.activatedComponentRef.setInput(v,c[v]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,s)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac})}return t})();function zx(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=e.value;const s=function pN(t,e,n){return e.children.map(r=>{for(const s of n.children)if(t.shouldReuseRoute(r.value,s.value.snapshot))return zx(t,r,s);return zx(t,r)})}(t,e,n);return new Hu(r,s)}{if(t.shouldAttach(e.value)){const c=t.retrieve(e.value);if(null!==c){const f=c.route;return f.value._futureSnapshot=e.value,f.children=e.children.map(v=>zx(t,v)),f}}const r=function dr(t){return new Js(new pl(t.url),new pl(t.params),new pl(t.queryParams),new pl(t.fragment),new pl(t.data),t.outlet,t.component,t)}(e.value),s=e.children.map(c=>zx(t,c));return new Hu(r,s)}}const jx="ngNavigationCancelingError";function hn(t,e){const{redirectTo:n,navigationBehaviorOptions:r}=ow(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,s=Vn(!1,0,e);return s.url=n,s.navigationBehaviorOptions=r,s}function Vn(t,e,n){const r=new Error("NavigationCancelingError: "+(t||""));return r[jx]=!0,r.cancellationCode=e,n&&(r.url=n),r}function fN(t){return t&&t[jx]}let Gz=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Ra({type:t,selectors:[["ng-component"]],standalone:!0,features:[bE],decls:1,vars:0,template:function(r,s){1&r&&Rs(0,"router-outlet")},dependencies:[qz],encapsulation:2})}return t})();function Yz(t){const e=t.children&&t.children.map(Yz),n=e?{...t,children:e}:{...t};return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==ii&&(n.component=Gz),n}function wp(t){return t.outlet||ii}function eD(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class Fee{constructor(e,n,r,s,c){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=s,this.inputBindingEnabled=c}activate(e){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),dN(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){const s=Ah(n);e.children.forEach(c=>{const f=c.value.outlet;this.deactivateRoutes(c,s[f],r),delete s[f]}),Object.values(s).forEach(c=>{this.deactivateRouteAndItsChildren(c,r)})}deactivateRoutes(e,n,r){const s=e.value,c=n?n.value:null;if(s===c)if(s.component){const f=r.getContext(s.outlet);f&&this.deactivateChildRoutes(e,n,f.children)}else this.deactivateChildRoutes(e,n,r);else c&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){const r=n.getContext(e.value.outlet),s=r&&e.value.component?r.children:n,c=Ah(e);for(const f of Object.keys(c))this.deactivateRouteAndItsChildren(c[f],s);if(r&&r.outlet){const f=r.outlet.detach(),v=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:f,route:e,contexts:v})}}deactivateRouteAndOutlet(e,n){const r=n.getContext(e.value.outlet),s=r&&e.value.component?r.children:n,c=Ah(e);for(const f of Object.keys(c))this.deactivateRouteAndItsChildren(c[f],s);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){const s=Ah(n);e.children.forEach(c=>{this.activateRoutes(c,s[c.value.outlet],r),this.forwardEvent(new YA(c.value.snapshot))}),e.children.length&&this.forwardEvent(new ti(e.value.snapshot))}activateRoutes(e,n,r){const s=e.value,c=n?n.value:null;if(dN(s),s===c)if(s.component){const f=r.getOrCreateContext(s.outlet);this.activateChildRoutes(e,n,f.children)}else this.activateChildRoutes(e,n,r);else if(s.component){const f=r.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const v=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),f.children.onOutletReAttached(v.contexts),f.attachRef=v.componentRef,f.route=v.route.value,f.outlet&&f.outlet.attach(v.componentRef,v.route.value),dN(v.route.value),this.activateChildRoutes(e,null,f.children)}else{const v=eD(s.snapshot);f.attachRef=null,f.route=s,f.injector=v,f.outlet&&f.outlet.activateWith(s,f.injector),this.activateChildRoutes(e,null,f.children)}}else this.activateChildRoutes(e,null,r)}}class l7{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class mN{constructor(e,n){this.component=e,this.route=n}}function Vee(t,e,n){const r=t._root;return oc(r,e?e._root:null,n,[r.value])}function $x(t,e){const n=Symbol(),r=e.get(t,n);return r===n?"function"!=typeof t||function Dj(t){return null!==Mb(t)}(t)?e.get(t):t:r}function oc(t,e,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const c=Ah(e);return t.children.forEach(f=>{(function Ct(t,e,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const c=t.value,f=e?e.value:null,v=n?n.getContext(t.value.outlet):null;if(f&&c.routeConfig===f.routeConfig){const b=function gN(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!rw(t.url,e.url);case"pathParamsOrQueryParamsChange":return!rw(t.url,e.url)||!yp(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!QA(t,e)||!yp(t.queryParams,e.queryParams);default:return!QA(t,e)}}(f,c,c.routeConfig.runGuardsAndResolvers);b?s.canActivateChecks.push(new l7(r)):(c.data=f.data,c._resolvedData=f._resolvedData),oc(t,e,c.component?v?v.children:null:n,r,s),b&&v&&v.outlet&&v.outlet.isActivated&&s.canDeactivateChecks.push(new mN(v.outlet.component,f))}else f&&aw(e,v,s),s.canActivateChecks.push(new l7(r)),oc(t,null,c.component?v?v.children:null:n,r,s)})(f,c[f.value.outlet],n,r.concat([f.value]),s),delete c[f.value.outlet]}),Object.entries(c).forEach(([f,v])=>aw(v,n.getContext(f),s)),s}function aw(t,e,n){const r=Ah(t),s=t.value;Object.entries(r).forEach(([c,f])=>{aw(f,s.component?e?e.children.getContext(c):null:e,n)}),n.canDeactivateChecks.push(new mN(s.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,s))}function bp(t){return"function"==typeof t}function g_(t){return t instanceof XO||"EmptyError"===t?.name}const _g=Symbol("INITIAL_VALUE");function cw(){return Pa(t=>UA(t.map(e=>e.pipe(Vf(1),function yee(...t){const e=ym(t);return Ws((n,r)=>{(e?JO(t,n,e):JO(t,n)).subscribe(r)})}(_g)))).pipe(go(e=>{for(const n of e)if(!0!==n){if(n===_g)return _g;if(!1===n||n instanceof Dx)return n}return!0}),pg(e=>e!==_g),Vf(1)))}function c7(t){return function PF(...t){return NP(t)}(rc(e=>{if(ow(e))throw hn(0,e)}),go(e=>!0===e))}class nD{constructor(e){this.segmentGroup=e||null}}class Jz{constructor(e){this.urlTree=e}}function Wx(t){return zA(new nD(t))}function u7(t){return zA(new Jz(t))}class d7{constructor(e,n){this.urlSerializer=e,this.urlTree=n}noMatchError(e){return new Gt(4002,!1)}lineralizeSegments(e,n){let r=[],s=n.root;for(;;){if(r=r.concat(s.segments),0===s.numberOfChildren)return Sr(r);if(s.numberOfChildren>1||!s.children[ii])return zA(new Gt(4e3,!1));s=s.children[ii]}}applyRedirectCommands(e,n,r){return this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r)}applyRedirectCreateUrlTree(e,n,r,s){const c=this.createSegmentGroup(e,n.root,r,s);return new Dx(c,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){const r={};return Object.entries(e).forEach(([s,c])=>{if("string"==typeof c&&c.startsWith(":")){const v=c.substring(1);r[s]=n[v]}else r[s]=c}),r}createSegmentGroup(e,n,r,s){const c=this.createSegments(e,n.segments,r,s);let f={};return Object.entries(n.children).forEach(([v,b])=>{f[v]=this.createSegmentGroup(e,b,r,s)}),new qo(c,f)}createSegments(e,n,r,s){return n.map(c=>c.path.startsWith(":")?this.findPosParam(e,c,s):this.findOrReturn(c,r))}findPosParam(e,n,r){const s=r[n.path.substring(1)];if(!s)throw new Gt(4001,!1);return s}findOrReturn(e,n){let r=0;for(const s of n){if(s.path===e.path)return n.splice(r),s;r++}return e}}const wN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function e5(t,e,n,r,s){const c=t5(t,e,n);return c.matched?(r=function Kz(t,e){return t.providers&&!t._injector&&(t._injector=aB(t.providers,e,`Route: ${t.path}`)),t._injector??e}(e,r),function vN(t,e,n,r){const s=e.canMatch;return s&&0!==s.length?Sr(s.map(f=>{const v=$x(f,t);return mg(function Qz(t){return t&&bp(t.canMatch)}(v)?v.canMatch(e,n):t.runInContext(()=>v(e,n)))})).pipe(cw(),c7()):Sr(!0)}(r,e,n).pipe(go(f=>!0===f?c:{...wN}))):Sr(c)}function t5(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{...wN}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const s=(e.matcher||Mz)(n,t,e);if(!s)return{...wN};const c={};Object.entries(s.posParams??{}).forEach(([v,b])=>{c[v]=b.path});const f=s.consumed.length>0?{...c,...s.consumed[s.consumed.length-1].parameters}:c;return{matched:!0,consumedSegments:s.consumed,remainingSegments:n.slice(s.consumed.length),parameters:f,positionalParamSegments:s.posParams??{}}}function p7(t,e,n,r){return n.length>0&&function Uf(t,e,n){return n.some(r=>Dh(t,e,r)&&wp(r)!==ii)}(t,n,r)?{segmentGroup:new qo(e,Ba(r,new qo(n,t.children))),slicedSegments:[]}:0===n.length&&function co(t,e,n){return n.some(r=>Dh(t,e,r))}(t,n,r)?{segmentGroup:new qo(t.segments,wg(t,0,n,r,t.children)),slicedSegments:n}:{segmentGroup:new qo(t.segments,t.children),slicedSegments:n}}function wg(t,e,n,r,s){const c={};for(const f of r)if(Dh(t,n,f)&&!s[wp(f)]){const v=new qo([],{});c[wp(f)]=v}return{...s,...c}}function Ba(t,e){const n={};n[ii]=e;for(const r of t)if(""===r.path&&wp(r)!==ii){const s=new qo([],{});n[wp(r)]=s}return n}function Dh(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}class f7{constructor(e,n,r,s,c,f,v){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=s,this.urlTree=c,this.paramsInheritanceStrategy=f,this.urlSerializer=v,this.allowRedirects=!0,this.applyRedirects=new d7(this.urlSerializer,this.urlTree)}noMatchError(e){return new Gt(4002,!1)}recognize(){const e=p7(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,ii).pipe(ew(n=>{if(n instanceof Jz)return this.allowRedirects=!1,this.urlTree=n.urlTree,this.match(n.urlTree);throw n instanceof nD?this.noMatchError(n):n}),go(n=>{const r=new je([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},ii,this.rootComponentType,null,{}),s=new Hu(r,n),c=new Ux("",s),f=function Mee(t,e,n=null,r=null){return Fz(Lz(t),e,n,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return f.queryParams=this.urlTree.queryParams,c.url=this.urlSerializer.serialize(f),this.inheritParamsAndData(c._root),{state:c,tree:f}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,ii).pipe(ew(r=>{throw r instanceof nD?this.noMatchError(r):r}))}inheritParamsAndData(e){const n=e.value,r=Bx(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(e,n,r,s){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,s,!0)}processChildren(e,n,r){const s=[];for(const c of Object.keys(r.children))"primary"===c?s.unshift(c):s.push(c);return ki(s).pipe(jA(c=>{const f=r.children[c],v=function a7(t,e){const n=t.filter(r=>wp(r)===e);return n.push(...t.filter(r=>wp(r)!==e)),n}(n,c);return this.processSegmentGroup(e,v,f,c)}),function tw(t,e){return Ws(function Pz(t,e,n,r,s){return(c,f)=>{let v=n,b=e,S=0;c.subscribe(Bs(f,k=>{const F=S++;b=v?t(b,k,F):(v=!0,k),r&&f.next(b)},s&&(()=>{v&&f.next(b),f.complete()})))}}(t,e,arguments.length>=2,!0))}((c,f)=>(c.push(...f),c)),nN(null),function HA(t,e){const n=arguments.length>=2;return r=>r.pipe(t?pg((s,c)=>t(s,c,r)):Zp,Sx(1),n?nN(e):q9(()=>new XO))}(),la(c=>{if(null===c)return Wx(r);const f=zr(c);return function m7(t){t.sort((e,n)=>e.value.outlet===ii?-1:n.value.outlet===ii?1:e.value.outlet.localeCompare(n.value.outlet))}(f),Sr(f)}))}processSegment(e,n,r,s,c,f){return ki(n).pipe(jA(v=>this.processSegmentAgainstRoute(v._injector??e,n,v,r,s,c,f).pipe(ew(b=>{if(b instanceof nD)return Sr(null);throw b}))),p_(v=>!!v),ew(v=>{if(g_(v))return function xs(t,e,n){return 0===e.length&&!t.children[n]}(r,s,c)?Sr([]):Wx(r);throw v}))}processSegmentAgainstRoute(e,n,r,s,c,f,v){return function Yx(t,e,n,r){return!!(wp(t)===r||r!==ii&&Dh(e,n,t))&&("**"===t.path||t5(e,t,n).matched)}(r,s,c,f)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,s,r,c,f,v):v&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,s,n,r,c,f):Wx(s):Wx(s)}expandSegmentAgainstRouteUsingRedirect(e,n,r,s,c,f){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,s,f):this.expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,s,c,f)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,s){const c=this.applyRedirects.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?u7(c):this.applyRedirects.lineralizeSegments(r,c).pipe(la(f=>{const v=new qo(f,{});return this.processSegment(e,n,v,f,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,n,r,s,c,f){const{matched:v,consumedSegments:b,remainingSegments:S,positionalParamSegments:k}=t5(n,s,c);if(!v)return Wx(n);const F=this.applyRedirects.applyRedirectCommands(b,s.redirectTo,k);return s.redirectTo.startsWith("/")?u7(F):this.applyRedirects.lineralizeSegments(s,F).pipe(la(H=>this.processSegment(e,r,n,H.concat(S),f,!1)))}matchSegmentAgainstRoute(e,n,r,s,c,f){let v;if("**"===r.path){const b=s.length>0?Oz(s).parameters:{};v=Sr({snapshot:new je(s,b,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,g7(r),wp(r),r.component??r._loadedComponent??null,r,Zx(r)),consumedSegments:[],remainingSegments:[]}),n.children={}}else v=e5(n,r,s,e).pipe(go(({matched:b,consumedSegments:S,remainingSegments:k,parameters:F})=>b?{snapshot:new je(S,F,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,g7(r),wp(r),r.component??r._loadedComponent??null,r,Zx(r)),consumedSegments:S,remainingSegments:k}:null));return v.pipe(Pa(b=>null===b?Wx(n):this.getChildConfig(e=r._injector??e,r,s).pipe(Pa(({routes:S})=>{const k=r._loadedInjector??e,{snapshot:F,consumedSegments:H,remainingSegments:Q}=b,{segmentGroup:de,slicedSegments:be}=p7(n,H,Q,S);if(0===be.length&&de.hasChildren())return this.processChildren(k,S,de).pipe(go(Be=>null===Be?null:[new Hu(F,Be)]));if(0===S.length&&0===be.length)return Sr([new Hu(F,[])]);const Ie=wp(r)===c;return this.processSegment(k,S,de,be,Ie?ii:c,!0).pipe(go(Be=>[new Hu(F,Be)]))}))))}getChildConfig(e,n,r){return n.children?Sr({routes:n.children,injector:e}):n.loadChildren?void 0!==n._loadedRoutes?Sr({routes:n._loadedRoutes,injector:n._loadedInjector}):function Xz(t,e,n,r){const s=e.canLoad;return void 0===s||0===s.length?Sr(!0):Sr(s.map(f=>{const v=$x(f,t);return mg(function Uee(t){return t&&bp(t.canLoad)}(v)?v.canLoad(e,n):t.runInContext(()=>v(e,n)))})).pipe(cw(),c7())}(e,n,r).pipe(la(s=>s?this.configLoader.loadChildren(e,n).pipe(rc(c=>{n._loadedRoutes=c.routes,n._loadedInjector=c.injector})):function h7(t){return zA(Vn(!1,3))}())):Sr({routes:[],injector:e})}}function qu(t){const e=t.value.routeConfig;return e&&""===e.path}function zr(t){const e=[],n=new Set;for(const r of t){if(!qu(r)){e.push(r);continue}const s=e.find(c=>r.value.routeConfig===c.value.routeConfig);void 0!==s?(s.children.push(...r.children),n.add(s)):e.push(r)}for(const r of n){const s=zr(r.children);e.push(new Hu(r.value,s))}return e.filter(r=>!n.has(r))}function g7(t){return t.data||{}}function Zx(t){return t.resolve||{}}function v7(t){return"string"==typeof t.title||null===t.title}function n5(t){return Pa(e=>{const n=t(e);return n?ki(n).pipe(go(()=>e)):Sr(e)})}const hw=new Xn("ROUTES");let TN=(()=>{class t{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Kn(Dq)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Sr(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const r=mg(n.loadComponent()).pipe(go(xn),rc(c=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=c}),Ax(()=>{this.componentLoaders.delete(n)})),s=new tN(r,()=>new bu).pipe(eN());return this.componentLoaders.set(n,s),s}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Sr({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const c=function $ee(t,e,n,r){return mg(t.loadChildren()).pipe(go(xn),la(s=>s instanceof oB||Array.isArray(s)?Sr(s):ki(e.compileModuleAsync(s))),go(s=>{r&&r(t);let c,f,v=!1;return Array.isArray(s)?(f=s,!0):(c=s.create(n).injector,f=c.get(hw,[],{optional:!0,self:!0}).flat()),{routes:f.map(Yz),injector:c}}))}(r,this.compiler,n,this.onLoadEndListener).pipe(Ax(()=>{this.childrenLoaders.delete(r)})),f=new tN(c,()=>new bu).pipe(eN());return this.childrenLoaders.set(r,f),f}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function xn(t){return function dn(t){return t&&"object"==typeof t&&"default"in t}(t)?t.default:t}let Gu=(()=>{class t{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new bu,this.transitionAbortSubject=new bu,this.configLoader=Kn(TN),this.environmentInjector=Kn(Au),this.urlSerializer=Kn(Rx),this.rootContexts=Kn(Ih),this.inputBindingEnabled=null!==Kn(m_,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Sr(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=s=>this.events.next(new ol(s)),this.configLoader.onLoadStartListener=s=>this.events.next(new Ch(s))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:r})}setupNavigations(n,r,s){return this.transitions=new pl({id:0,currentUrlTree:r,currentRawUrl:r,currentBrowserUrl:r,extractedUrl:n.urlHandlingStrategy.extract(r),urlAfterRedirects:n.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Wn,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(pg(c=>0!==c.id),go(c=>({...c,extractedUrl:n.urlHandlingStrategy.extract(c.rawUrl)})),Pa(c=>{this.currentTransition=c;let f=!1,v=!1;return Sr(c).pipe(rc(b=>{this.currentNavigation={id:b.id,initialUrl:b.rawUrl,extractedUrl:b.extractedUrl,trigger:b.source,extras:b.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Pa(b=>{const S=b.currentBrowserUrl.toString(),k=!n.navigated||b.extractedUrl.toString()!==S||S!==b.currentUrlTree.toString();if(!k&&"reload"!==(b.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const H="";return this.events.next(new f_(b.id,this.urlSerializer.serialize(b.rawUrl),H,0)),b.resolve(null),sh}if(n.urlHandlingStrategy.shouldProcessUrl(b.rawUrl))return Sr(b).pipe(Pa(H=>{const Q=this.transitions?.getValue();return this.events.next(new jt(H.id,this.urlSerializer.serialize(H.extractedUrl),H.source,H.restoredState)),Q!==this.transitions?.getValue()?sh:Promise.resolve(H)}),function bN(t,e,n,r,s,c){return la(f=>function Jn(t,e,n,r,s,c,f="emptyOnly"){return new f7(t,e,n,r,s,f,c).recognize()}(t,e,n,r,f.extractedUrl,s,c).pipe(go(({state:v,tree:b})=>({...f,targetSnapshot:v,urlAfterRedirects:b}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,n.paramsInheritanceStrategy),rc(H=>{c.targetSnapshot=H.targetSnapshot,c.urlAfterRedirects=H.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:H.urlAfterRedirects};const Q=new ou(H.id,this.urlSerializer.serialize(H.extractedUrl),this.urlSerializer.serialize(H.urlAfterRedirects),H.targetSnapshot);this.events.next(Q)}));if(k&&n.urlHandlingStrategy.shouldProcessUrl(b.currentRawUrl)){const{id:H,extractedUrl:Q,source:de,restoredState:be,extras:Ie}=b,Be=new jt(H,this.urlSerializer.serialize(Q),de,be);this.events.next(Be);const Fe=yg(0,this.rootComponentType).snapshot;return this.currentTransition=c={...b,targetSnapshot:Fe,urlAfterRedirects:Q,extras:{...Ie,skipLocationChange:!1,replaceUrl:!1}},Sr(c)}{const H="";return this.events.next(new f_(b.id,this.urlSerializer.serialize(b.extractedUrl),H,1)),b.resolve(null),sh}}),rc(b=>{const S=new Oo(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot);this.events.next(S)}),go(b=>(this.currentTransition=c={...b,guards:Vee(b.targetSnapshot,b.currentSnapshot,this.rootContexts)},c)),function zee(t,e){return la(n=>{const{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:c,canDeactivateChecks:f}}=n;return 0===f.length&&0===c.length?Sr({...n,guardsResult:!0}):function Gx(t,e,n,r){return ki(t).pipe(la(s=>function Kx(t,e,n,r,s){const c=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return c&&0!==c.length?Sr(c.map(v=>{const b=eD(e)??s,S=$x(v,b);return mg(function Zz(t){return t&&bp(t.canDeactivate)}(S)?S.canDeactivate(t,e,n,r):b.runInContext(()=>S(t,e,n,r))).pipe(p_())})).pipe(cw()):Sr(!0)}(s.component,s.route,n,e,r)),p_(s=>!0!==s,!0))}(f,r,s,t).pipe(la(v=>v&&function yN(t){return"boolean"==typeof t}(v)?function yd(t,e,n,r){return ki(e).pipe(jA(s=>JO(function vg(t,e){return null!==t&&e&&e(new sw(t)),Sr(!0)}(s.route.parent,r),function _N(t,e){return null!==t&&e&&e(new Nx(t)),Sr(!0)}(s.route,r),function jee(t,e,n){const r=e[e.length-1],c=e.slice(0,e.length-1).reverse().map(f=>function Bee(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(f)).filter(f=>null!==f).map(f=>Dz(()=>Sr(f.guards.map(b=>{const S=eD(f.node)??n,k=$x(b,S);return mg(function tD(t){return t&&bp(t.canActivateChild)}(k)?k.canActivateChild(r,t):S.runInContext(()=>k(r,t))).pipe(p_())})).pipe(cw())));return Sr(c).pipe(cw())}(t,s.path,n),function Yi(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return Sr(!0);const s=r.map(c=>Dz(()=>{const f=eD(e)??n,v=$x(c,f);return mg(function lw(t){return t&&bp(t.canActivate)}(v)?v.canActivate(e,t):f.runInContext(()=>v(e,t))).pipe(p_())}));return Sr(s).pipe(cw())}(t,s.route,n))),p_(s=>!0!==s,!0))}(r,c,t,e):Sr(v)),go(v=>({...n,guardsResult:v})))})}(this.environmentInjector,b=>this.events.next(b)),rc(b=>{if(c.guardsResult=b.guardsResult,ow(b.guardsResult))throw hn(0,b.guardsResult);const S=new Gr(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot,!!b.guardsResult);this.events.next(S)}),pg(b=>!!b.guardsResult||(this.cancelNavigationTransition(b,"",3),!1)),n5(b=>{if(b.guards.canActivateChecks.length)return Sr(b).pipe(rc(S=>{const k=new Kr(S.id,this.urlSerializer.serialize(S.extractedUrl),this.urlSerializer.serialize(S.urlAfterRedirects),S.targetSnapshot);this.events.next(k)}),Pa(S=>{let k=!1;return Sr(S).pipe(function EN(t,e){return la(n=>{const{targetSnapshot:r,guards:{canActivateChecks:s}}=n;if(!s.length)return Sr(n);let c=0;return ki(s).pipe(jA(f=>function y7(t,e,n,r){const s=t.routeConfig,c=t._resolve;return void 0!==s?.title&&!v7(s)&&(c[fg]=s.title),function Hee(t,e,n,r){const s=function xN(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}(t);if(0===s.length)return Sr({});const c={};return ki(s).pipe(la(f=>function _7(t,e,n,r){const s=eD(e)??r,c=$x(t,s);return mg(c.resolve?c.resolve(e,n):s.runInContext(()=>c(e,n)))}(t[f],e,n,r).pipe(p_(),rc(v=>{c[f]=v}))),Sx(1),Rz(c),ew(f=>g_(f)?sh:zA(f)))}(c,t,e,r).pipe(go(f=>(t._resolvedData=f,t.data=Bx(t,n).resolve,s&&v7(s)&&(t.data[fg]=s.title),null)))}(f.route,r,t,e)),rc(()=>c++),Sx(1),la(f=>c===s.length?Sr(n):sh))})}(n.paramsInheritanceStrategy,this.environmentInjector),rc({next:()=>k=!0,complete:()=>{k||this.cancelNavigationTransition(S,"",2)}}))}),rc(S=>{const k=new uN(S.id,this.urlSerializer.serialize(S.extractedUrl),this.urlSerializer.serialize(S.urlAfterRedirects),S.targetSnapshot);this.events.next(k)}))}),n5(b=>{const S=k=>{const F=[];k.routeConfig?.loadComponent&&!k.routeConfig._loadedComponent&&F.push(this.configLoader.loadComponent(k.routeConfig).pipe(rc(H=>{k.component=H}),go(()=>{})));for(const H of k.children)F.push(...S(H));return F};return UA(S(b.targetSnapshot.root)).pipe(nN(),Vf(1))}),n5(()=>this.afterPreactivation()),go(b=>{const S=function JA(t,e,n){const r=zx(t,e._root,n?n._root:void 0);return new Vx(r,e)}(n.routeReuseStrategy,b.targetSnapshot,b.currentRouterState);return this.currentTransition=c={...b,targetRouterState:S},c}),rc(()=>{this.events.next(new Lx)}),((t,e,n,r)=>go(s=>(new Fee(e,s.targetRouterState,s.currentRouterState,n,r).activate(t),s)))(this.rootContexts,n.routeReuseStrategy,b=>this.events.next(b),this.inputBindingEnabled),Vf(1),rc({next:b=>{f=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Lt(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects))),n.titleStrategy?.updateTitle(b.targetRouterState.snapshot),b.resolve(!0)},complete:()=>{f=!0}}),function rN(t){return Ws((e,n)=>{Wa(t).subscribe(Bs(n,()=>n.complete(),Kg)),!n.closed&&e.subscribe(n)})}(this.transitionAbortSubject.pipe(rc(b=>{throw b}))),Ax(()=>{f||v||this.cancelNavigationTransition(c,"",1),this.currentNavigation?.id===c.id&&(this.currentNavigation=null)}),ew(b=>{if(v=!0,fN(b))this.events.next(new KA(c.id,this.urlSerializer.serialize(c.extractedUrl),b.message,b.cancellationCode)),function Ln(t){return fN(t)&&ow(t.url)}(b)?this.events.next(new vp(b.url)):c.resolve(!1);else{this.events.next(new WA(c.id,this.urlSerializer.serialize(c.extractedUrl),b,c.targetSnapshot??void 0));try{c.resolve(n.errorHandler(b))}catch(S){c.reject(S)}}return sh}))}))}cancelNavigationTransition(n,r,s){const c=new KA(n.id,this.urlSerializer.serialize(n.extractedUrl),r,s);this.events.next(c),n.resolve(!1)}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Qx(t){return t!==Wn}let r5=(()=>{class t{buildTitle(n){let r,s=n.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(c=>c.outlet===ii);return r}getResolvedTitleForRoute(n){return n.data[fg]}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:function(){return Kn(Xx)},providedIn:"root"})}return t})(),Xx=(()=>{class t extends r5{constructor(n){super(),this.title=n}updateTitle(n){const r=this.buildTitle(n);void 0!==r&&this.title.setTitle(r)}static#e=this.\u0275fac=function(r){return new(r||t)(hr(wO))};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),i5=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:function(){return Kn(Gee)},providedIn:"root"})}return t})();class qee{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}}let Gee=(()=>{class t extends qee{static#e=this.\u0275fac=function(){let n;return function(s){return(n||(n=function gl(t){return uh(()=>{const e=t.prototype.constructor,n=e[Tu]||BI(e),r=Object.prototype;let s=Object.getPrototypeOf(t.prototype).constructor;for(;s&&s!==r;){const c=s[Tu]||BI(s);if(c&&c!==n)return c;s=Object.getPrototypeOf(s)}return c=>new c})}(t)))(s||t)}}();static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const sc=new Xn("",{providedIn:"root",factory:()=>({})});let CN=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:function(){return Kn(w7)},providedIn:"root"})}return t})(),w7=(()=>{class t{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var dw=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(dw||{});function o5(t,e){t.events.pipe(pg(n=>n instanceof Lt||n instanceof KA||n instanceof WA||n instanceof f_),go(n=>n instanceof Lt||n instanceof f_?dw.COMPLETE:n instanceof KA&&(0===n.code||1===n.code)?dw.REDIRECTING:dw.FAILED),pg(n=>n!==dw.REDIRECTING),Vf(1)).subscribe(()=>{e()})}function s5(t){throw t}function Kee(t,e,n){return e.parse("/")}const a5={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},iD={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let _d=(()=>{class t{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Kn(qS),this.isNgZoneEnabled=!1,this._events=new bu,this.options=Kn(sc,{optional:!0})||{},this.pendingTasks=Kn(UB),this.errorHandler=this.options.errorHandler||s5,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Kee,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Kn(CN),this.routeReuseStrategy=Kn(i5),this.titleStrategy=Kn(r5),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Kn(hw,{optional:!0})?.flat()??[],this.navigationTransitions=Kn(Gu),this.urlSerializer=Kn(Rx),this.location=Kn(tA),this.componentInputBindingEnabled=!!Kn(m_,{optional:!0}),this.eventsSubscription=new aa,this.isNgZoneEnabled=Kn(Ji)instanceof Ji&&Ji.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Dx,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=yg(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(n=>{this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(r=>{try{const{currentTransition:s}=this.navigationTransitions;if(null===s)return void(ea(r)&&this._events.next(r));if(r instanceof jt)Qx(s.source)&&(this.browserUrlTree=s.extractedUrl);else if(r instanceof f_)this.rawUrlTree=s.rawUrl;else if(r instanceof ou){if("eager"===this.urlUpdateStrategy){if(!s.extras.skipLocationChange){const c=this.urlHandlingStrategy.merge(s.urlAfterRedirects,s.rawUrl);this.setBrowserUrl(c,s)}this.browserUrlTree=s.urlAfterRedirects}}else if(r instanceof Lx)this.currentUrlTree=s.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(s.urlAfterRedirects,s.rawUrl),this.routerState=s.targetRouterState,"deferred"===this.urlUpdateStrategy&&(s.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,s),this.browserUrlTree=s.urlAfterRedirects);else if(r instanceof KA)0!==r.code&&1!==r.code&&(this.navigated=!0),(3===r.code||2===r.code)&&this.restoreHistory(s);else if(r instanceof vp){const c=this.urlHandlingStrategy.merge(r.url,s.currentRawUrl),f={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Qx(s.source)};this.scheduleNavigation(c,Wn,null,f,{resolve:s.resolve,reject:s.reject,promise:s.promise})}r instanceof WA&&this.restoreHistory(s,!0),r instanceof Lt&&(this.navigated=!0),ea(r)&&this._events.next(r)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const n=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Wn,n)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const r="popstate"===n.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(n.url,r,n.state)},0)}))}navigateToSyncWithBrowser(n,r,s){const c={replaceUrl:!0},f=s?.navigationId?s:null;if(s){const b={...s};delete b.navigationId,delete b.\u0275routerPageId,0!==Object.keys(b).length&&(c.state=b)}const v=this.parseUrl(n);this.scheduleNavigation(v,r,f,c)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Yz),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){const{relativeTo:s,queryParams:c,fragment:f,queryParamsHandling:v,preserveFragment:b}=r,S=b?this.currentUrlTree.fragment:f;let F,k=null;switch(v){case"merge":k={...this.currentUrlTree.queryParams,...c};break;case"preserve":k=this.currentUrlTree.queryParams;break;default:k=c||null}null!==k&&(k=this.removeEmptyProps(k));try{F=Lz(s?s.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),F=this.currentUrlTree.root}return Fz(F,n,k,S??null)}navigateByUrl(n,r={skipLocationChange:!1}){const s=ow(n)?n:this.parseUrl(n),c=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(c,Wn,null,r)}navigate(n,r={skipLocationChange:!1}){return function Wee(t){for(let e=0;e<t.length;e++)if(null==t[e])throw new Gt(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let r;try{r=this.urlSerializer.parse(n)}catch(s){r=this.malformedUriErrorHandler(s,this.urlSerializer,n)}return r}isActive(n,r){let s;if(s=!0===r?{...a5}:!1===r?{...iD}:r,ow(n))return K9(this.currentUrlTree,n,s);const c=this.parseUrl(n);return K9(this.currentUrlTree,c,s)}removeEmptyProps(n){return Object.keys(n).reduce((r,s)=>{const c=n[s];return null!=c&&(r[s]=c),r},{})}scheduleNavigation(n,r,s,c,f){if(this.disposed)return Promise.resolve(!1);let v,b,S;f?(v=f.resolve,b=f.reject,S=f.promise):S=new Promise((F,H)=>{v=F,b=H});const k=this.pendingTasks.add();return o5(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(k))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:n,extras:c,resolve:v,reject:b,promise:S,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),S.catch(F=>Promise.reject(F))}setBrowserUrl(n,r){const s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl){const f={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(s,"",f)}else{const c={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(s,"",c)}}restoreHistory(n,r=!1){if("computed"===this.canceledNavigationResolution){const c=this.currentPageId-this.browserPageId;0!==c?this.location.historyGo(c):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===c&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ea(t){return!(t instanceof Lx||t instanceof vp)}class c5{}let b7=(()=>{class t{constructor(n,r,s,c,f){this.router=n,this.injector=s,this.preloadingStrategy=c,this.loader=f}setUpPreloading(){this.subscription=this.router.events.pipe(pg(n=>n instanceof Lt),jA(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,r){const s=[];for(const c of r){c.providers&&!c._injector&&(c._injector=aB(c.providers,n,`Route: ${c.path}`));const f=c._injector??n,v=c._loadedInjector??f;(c.loadChildren&&!c._loadedRoutes&&void 0===c.canLoad||c.loadComponent&&!c._loadedComponent)&&s.push(this.preloadConfig(f,c)),(c.children||c._loadedRoutes)&&s.push(this.processRoutes(v,c.children??c._loadedRoutes))}return ki(s).pipe(gm())}preloadConfig(n,r){return this.preloadingStrategy.preload(r,()=>{let s;s=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(n,r):Sr(null);const c=s.pipe(la(f=>null===f?Sr(void 0):(r._loadedRoutes=f.routes,r._loadedInjector=f.injector,this.processRoutes(f.injector??n,f.routes))));return r.loadComponent&&!r._loadedComponent?ki([c,this.loader.loadComponent(r)]).pipe(gm()):c})}static#e=this.\u0275fac=function(r){return new(r||t)(hr(_d),hr(Dq),hr(Au),hr(c5),hr(TN))};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const y_=new Xn("");let __=(()=>{class t{constructor(n,r,s,c,f={}){this.urlSerializer=n,this.transitions=r,this.viewportScroller=s,this.zone=c,this.options=f,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},f.scrollPositionRestoration=f.scrollPositionRestoration||"disabled",f.anchorScrolling=f.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof jt?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof Lt?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof f_&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof ZA&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new ZA(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(r){!function Yv(){throw new Error("invalid")}()};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac})}return t})();function Eg(t,e){return{\u0275kind:t,\u0275providers:e}}function T7(){const t=Kn(fh);return e=>{const n=t.get(Ou);if(e!==n.components[0])return;const r=t.get(_d),s=t.get(oD);1===t.get(AN)&&r.initialNavigation(),t.get(ac,null,mi.Optional)?.setUpPreloading(),t.get(y_,null,mi.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),s.closed||(s.next(),s.complete(),s.unsubscribe())}}const oD=new Xn("",{factory:()=>new bu}),AN=new Xn("",{providedIn:"root",factory:()=>1}),ac=new Xn("");function C7(t){return Eg(0,[{provide:ac,useExisting:b7},{provide:c5,useExisting:t}])}const I7=new Xn("ROUTER_FORROOT_GUARD"),ete=[tA,{provide:Rx,useClass:Nz},_d,Ih,{provide:Js,useFactory:function E7(t){return t.routerState.root},deps:[_d]},TN,[]];function tte(){return new Uy("Router",_d)}let S7=(()=>{class t{constructor(n){}static forRoot(n,r){return{ngModule:t,providers:[ete,[],{provide:hw,multi:!0,useValue:n},{provide:I7,useFactory:D7,deps:[[_d,new zd,new jd]]},{provide:sc,useValue:r||{}},r?.useHash?{provide:D0,useClass:oG}:{provide:D0,useClass:iG},{provide:y_,useFactory:()=>{const t=Kn(Yy),e=Kn(Ji),n=Kn(sc),r=Kn(Gu),s=Kn(Rx);return n.scrollOffset&&t.setOffset(n.scrollOffset),new __(s,r,t,e,n)}},r?.preloadingStrategy?C7(r.preloadingStrategy).\u0275providers:[],{provide:Uy,multi:!0,useFactory:tte},r?.initialNavigation?ite(r):[],r?.bindToComponentInputs?Eg(8,[Cl,{provide:m_,useExisting:Cl}]).\u0275providers:[],[{provide:u5,useFactory:T7},{provide:qB,multi:!0,useExisting:u5}]]}}static forChild(n){return{ngModule:t,providers:[{provide:hw,multi:!0,useValue:n}]}}static#e=this.\u0275fac=function(r){return new(r||t)(hr(I7,8))};static#t=this.\u0275mod=_s({type:t});static#n=this.\u0275inj=cs({})}return t})();function D7(t){return"guarded"}function ite(t){return["disabled"===t.initialNavigation?Eg(3,[{provide:ku,multi:!0,useFactory:()=>{const e=Kn(_d);return()=>{e.setUpLocationChangeListener()}}},{provide:AN,useValue:2}]).\u0275providers:[],"enabledBlocking"===t.initialNavigation?Eg(2,[{provide:AN,useValue:0},{provide:ku,multi:!0,deps:[fh],useFactory:e=>{const n=e.get(tG,Promise.resolve());return()=>n.then(()=>new Promise(r=>{const s=e.get(_d),c=e.get(oD);o5(s,()=>{r(!0)}),e.get(Gu).afterPreactivation=()=>(r(!0),c.closed?Sr(void 0):c),s.initialNavigation()}))}}]).\u0275providers:[]]}const u5=new Xn("");var Ns=hb(155),P7=hb(597);function DN(t,e,n,r,s,c,f){try{var v=t[c](f),b=v.value}catch(S){return void n(S)}v.done?e(b):Promise.resolve(b).then(r,s)}function Ze(t){return function(){var e=this,n=arguments;return new Promise(function(r,s){var c=t.apply(e,n);function f(b){DN(c,r,s,f,v,"next",b)}function v(b){DN(c,r,s,f,v,"throw",b)}f(void 0)})}}const R7=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++r)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},k7={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const c=t[s],f=s+1<t.length,v=f?t[s+1]:0,b=s+2<t.length,S=b?t[s+2]:0;let H=(15&v)<<2|S>>6,Q=63&S;b||(Q=64,f||(H=64)),r.push(n[c>>2],n[(3&c)<<4|v>>4],n[H],n[Q])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(R7(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const c=t[n++];e[r++]=String.fromCharCode((31&s)<<6|63&c)}else if(s>239&&s<365){const b=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(b>>10)),e[r++]=String.fromCharCode(56320+(1023&b))}else{const c=t[n++],f=t[n++];e[r++]=String.fromCharCode((15&s)<<12|(63&c)<<6|63&f)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const c=n[t.charAt(s++)],v=s<t.length?n[t.charAt(s)]:0;++s;const S=s<t.length?n[t.charAt(s)]:64;++s;const F=s<t.length?n[t.charAt(s)]:64;if(++s,null==c||null==v||null==S||null==F)throw new eT;r.push(c<<2|v>>4),64!==S&&(r.push(v<<4&240|S>>2),64!==F&&r.push(S<<6&192|F))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class eT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zf=function(t){return function(t){const e=R7(t);return k7.encodeByteArray(e,!0)}(t).replace(/\./g,"")},tT=function(t){try{return k7.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},Ep=()=>{try{return function ute(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&tT(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},jf=t=>{var e,n;return null===(n=null===(e=Ep())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},L7=t=>{const e=jf(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]},F7=()=>{var t;return null===(t=Ep())||void 0===t?void 0:t.config},V7=t=>{var e;return null===(e=Ep())||void 0===e?void 0:e[`_${t}`]};class d5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(n):e(n,r))}}}function B7(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=e||"demo-project",s=t.iat||0,c=t.sub||t.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const f=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},t);return[zf(JSON.stringify({alg:"none",type:"JWT"})),zf(JSON.stringify(f)),""].join(".")}function zs(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function U7(){try{return"object"==typeof indexedDB}catch{return!1}}class Hf extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,Hf.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,aD.prototype.create)}}class aD{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,c=this.errors[e],f=c?function bte(t,e){return t.replace(Ete,(n,r)=>{const s=e[r];return null!=s?String(s):`<${r}?>`})}(c,r):"Error";return new Hf(s,`${this.serviceName}: ${f} (${s}).`,r)}}const Ete=/\{\$([^}]+)}/g;function MN(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const c=t[s],f=e[s];if(p5(c)&&p5(f)){if(!MN(c,f))return!1}else if(c!==f)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function p5(t){return null!==t&&"object"==typeof t}function xg(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}class m5{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(void 0===e&&void 0===n&&void 0===r)throw new Error("Missing Observer.");s=function NN(t,e){if("object"!=typeof t||null===t)return!1;for(const n of e)if(n in t&&"function"==typeof t[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:n,complete:r},void 0===s.next&&(s.next=LN),void 0===s.error&&(s.error=LN),void 0===s.complete&&(s.complete=LN);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),c}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function LN(){}function xp(t){return t&&t._delegate?t._delegate:t}class Tp{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Cg="[DEFAULT]";class Ste{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new d5;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e?.identifier),s=null!==(n=e?.optional)&&void 0!==n&&n;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(c){if(s)return null;throw c}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function q7(t){return"EAGER"===t.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Cg})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const c=this.getOrInitializeService({instanceIdentifier:s});r.resolve(c)}catch{}}}}clearInstance(e=Cg){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return Ze(function*(){const n=Array.from(e.instances.values());yield Promise.all([...n.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...n.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=Cg){return this.instances.has(e)}getOptions(e=Cg){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[c,f]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(c)&&f.resolve(s);return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),c=null!==(r=this.onInitCallbacks.get(s))&&void 0!==r?r:new Set;c.add(e),this.onInitCallbacks.set(s,c);const f=this.instances.get(s);return f&&e(f,s),()=>{c.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(t=e,t===Cg?void 0:t),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}var t;return r||null}normalizeInstanceIdentifier(e=Cg){return this.component?this.component.multipleInstances?e:Cg:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Dte{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Ste(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}const a=[];var o=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(o||{});const i={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},l=o.INFO,u={[o.DEBUG]:"log",[o.VERBOSE]:"log",[o.INFO]:"info",[o.WARN]:"warn",[o.ERROR]:"error"},h=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString(),s=u[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${r}]  ${t.name}:`,...n)};class g{constructor(e){this.name=e,this._logLevel=l,this._logHandler=h,this._userLogHandler=null,a.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in o))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?i[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,o.DEBUG,...e),this._logHandler(this,o.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,o.VERBOSE,...e),this._logHandler(this,o.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,o.INFO,...e),this._logHandler(this,o.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,o.WARN,...e),this._logHandler(this,o.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,o.ERROR,...e),this._logHandler(this,o.ERROR,...e)}}const D=(t,e)=>e.some(n=>t instanceof n);let P,N;const ue=new WeakMap,ge=new WeakMap,we=new WeakMap,Re=new WeakMap,et=new WeakMap;let Qt={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return ge.get(t);if("objectStoreNames"===e)return t.objectStoreNames||we.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Et(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function ot(t){return"function"==typeof t?function Je(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function W(){return N||(N=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(t)?function(...e){return t.apply(Kt(this),e),Et(ue.get(this))}:function(...e){return Et(t.apply(Kt(this),e))}:function(e,...n){const r=t.call(Kt(this),e,...n);return we.set(r,e.sort?e.sort():[e]),Et(r)}}(t):(t instanceof IDBTransaction&&function St(t){if(ge.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",c),t.removeEventListener("error",f),t.removeEventListener("abort",f)},c=()=>{n(),s()},f=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",c),t.addEventListener("error",f),t.addEventListener("abort",f)});ge.set(t,e)}(t),D(t,function z(){return P||(P=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(t,Qt):t)}function Et(t){if(t instanceof IDBRequest)return function Mt(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",c),t.removeEventListener("error",f)},c=()=>{n(Et(t.result)),s()},f=()=>{r(t.error),s()};t.addEventListener("success",c),t.addEventListener("error",f)});return e.then(n=>{n instanceof IDBCursor&&ue.set(n,t)}).catch(()=>{}),et.set(e,t),e}(t);if(Re.has(t))return Re.get(t);const e=ot(t);return e!==t&&(Re.set(t,e),et.set(e,t)),e}const Kt=t=>et.get(t),It=["get","getKey","getAll","getAllKeys","count"],xt=["put","add","delete","clear"],ln=new Map;function Sn(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(ln.get(e))return ln.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=xt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!It.includes(n))return;const c=function(){var f=Ze(function*(v,...b){const S=this.transaction(v,s?"readwrite":"readonly");let k=S.store;return r&&(k=k.index(b.shift())),(yield Promise.all([k[n](...b),s&&S.done]))[0]});return function(b){return f.apply(this,arguments)}}();return ln.set(e,c),c}!function Le(t){Qt=t(Qt)}(t=>({...t,get:(e,n,r)=>Sn(e,n)||t.get(e,n,r),has:(e,n)=>!!Sn(e,n)||t.has(e,n)}));class We{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(function on(t){const e=t.getComponent();return"VERSION"===e?.type}(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}return null}).filter(n=>n).join(" ")}}const Rn="@firebase/app",nn=new g("@firebase/app"),Pe="[DEFAULT]",Ft={[Rn]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},kt=new Map,en=new Map;function Yn(t,e){try{t.container.addComponent(e)}catch(n){nn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Dt(t){const e=t.name;if(en.has(e))return nn.debug(`There were multiple attempts to register component ${e}.`),!1;en.set(e,t);for(const n of kt.values())Yn(n,t);return!0}function qt(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const Li=new aD("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class os{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Tp("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Li.create("app-deleted",{appName:this._name})}}const vi="10.8.0";function me(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:Pe,automaticDataCollectionEnabled:!1},e),s=r.name;if("string"!=typeof s||!s)throw Li.create("bad-app-name",{appName:String(s)});if(n||(n=F7()),!n)throw Li.create("no-options");const c=kt.get(s);if(c){if(MN(n,c.options)&&MN(r,c.config))return c;throw Li.create("duplicate-app",{appName:s})}const f=new Dte(s);for(const b of en.values())f.addComponent(b);const v=new os(n,r,f);return kt.set(s,v),v}function J(t=Pe){const e=kt.get(t);if(!e&&t===Pe&&F7())return me();if(!e)throw Li.create("no-app",{appName:t});return e}function Ue(t,e,n){var r;let s=null!==(r=Ft[t])&&void 0!==r?r:t;n&&(s+=`-${n}`);const c=s.match(/\s|\//),f=e.match(/\s|\//);if(c||f){const v=[`Unable to register library "${s}" with version "${e}":`];return c&&v.push(`library name "${s}" contains illegal characters (whitespace or "/")`),c&&f&&v.push("and"),f&&v.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void nn.warn(v.join(" "))}Dt(new Tp(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const Ve="firebase-heartbeat-database",$e=1,Rt="firebase-heartbeat-store";let Ot=null;function cn(){return Ot||(Ot=function Ne(t,e,{blocked:n,upgrade:r,blocking:s,terminated:c}={}){const f=indexedDB.open(t,e),v=Et(f);return r&&f.addEventListener("upgradeneeded",b=>{r(Et(f.result),b.oldVersion,b.newVersion,Et(f.transaction),b)}),n&&f.addEventListener("blocked",b=>n(b.oldVersion,b.newVersion,b)),v.then(b=>{c&&b.addEventListener("close",()=>c()),s&&b.addEventListener("versionchange",S=>s(S.oldVersion,S.newVersion,S))}).catch(()=>{}),v}(Ve,$e,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(Rt)}catch(n){console.warn(n)}}}).catch(t=>{throw Li.create("idb-open",{originalErrorMessage:t.message})})),Ot}function $n(){return($n=Ze(function*(t){try{const n=(yield cn()).transaction(Rt),r=yield n.objectStore(Rt).get(wi(t));return yield n.done,r}catch(e){if(e instanceof Hf)nn.warn(e.message);else{const n=Li.create("idb-get",{originalErrorMessage:e?.message});nn.warn(n.message)}}})).apply(this,arguments)}function lr(t,e){return ci.apply(this,arguments)}function ci(){return(ci=Ze(function*(t,e){try{const r=(yield cn()).transaction(Rt,"readwrite");yield r.objectStore(Rt).put(e,wi(t)),yield r.done}catch(n){if(n instanceof Hf)nn.warn(n.message);else{const r=Li.create("idb-set",{originalErrorMessage:n?.message});nn.warn(r.message)}}})).apply(this,arguments)}function wi(t){return`${t.name}!${t.options.appId}`}class cr{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new js(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var e=this;return Ze(function*(){var n,r;const c=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),f=rr();if((null!=(null===(n=e._heartbeatsCache)||void 0===n?void 0:n.heartbeats)||(e._heartbeatsCache=yield e._heartbeatsCachePromise,null!=(null===(r=e._heartbeatsCache)||void 0===r?void 0:r.heartbeats)))&&e._heartbeatsCache.lastSentHeartbeatDate!==f&&!e._heartbeatsCache.heartbeats.some(v=>v.date===f))return e._heartbeatsCache.heartbeats.push({date:f,agent:c}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(v=>{const b=new Date(v.date).valueOf();return Date.now()-b<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return Ze(function*(){var n;if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null==(null===(n=e._heartbeatsCache)||void 0===n?void 0:n.heartbeats)||0===e._heartbeatsCache.heartbeats.length)return"";const r=rr(),{heartbeatsToSend:s,unsentEntries:c}=function bi(t,e=1024){const n=[];let r=t.slice();for(const s of t){const c=n.find(f=>f.agent===s.agent);if(c){if(c.dates.push(s.date),da(n)>e){c.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),da(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(e._heartbeatsCache.heartbeats),f=zf(JSON.stringify({version:2,heartbeats:s}));return e._heartbeatsCache.lastSentHeartbeatDate=r,c.length>0?(e._heartbeatsCache.heartbeats=c,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),f})()}}function rr(){return(new Date).toISOString().substring(0,10)}class js{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Ze(function*(){return!!U7()&&function wte(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var c;e((null===(c=s.error)||void 0===c?void 0:c.message)||"")}}catch(n){e(n)}})}().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return Ze(function*(){if(yield e._canUseIndexedDBPromise){const r=yield function nr(t){return $n.apply(this,arguments)}(e.app);return r?.heartbeats?r:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(e){var n=this;return Ze(function*(){var r;if(yield n._canUseIndexedDBPromise){const c=yield n.read();return lr(n.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:c.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var n=this;return Ze(function*(){var r;if(yield n._canUseIndexedDBPromise){const c=yield n.read();return lr(n.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:c.lastSentHeartbeatDate,heartbeats:[...c.heartbeats,...e.heartbeats]})}})()}}function da(t){return zf(JSON.stringify({version:2,heartbeats:t})).length}!function Dc(t){Dt(new Tp("platform-logger",e=>new We(e),"PRIVATE")),Dt(new Tp("heartbeat",e=>new cr(e),"PRIVATE")),Ue(Rn,"0.9.27",t),Ue(Rn,"0.9.27","esm2017"),Ue("fire-js","")}(""),Ue("firebase","10.8.0","app");const sl=function nT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},FN=new aD("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),lc=new g("@firebase/auth");function vd(t,...e){lc.logLevel<=o.ERROR&&lc.error(`Auth (${vi}): ${t}`,...e)}function Zi(t,...e){throw bd(t,...e)}function Ia(t,...e){return bd(t,...e)}function wd(t,e,n){const r=Object.assign(Object.assign({},sl()),{[e]:n});return new aD("auth","Firebase",r).create(e,{appName:t.name})}function bd(t,...e){if("string"!=typeof t){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return FN.create(t,...e)}function Pt(t,e,...n){if(!t)throw bd(e,...n)}function Rh(t){const e="INTERNAL ASSERTION FAILED: "+t;throw vd(e),new Error(e)}function Il(t,e){t||Rh(e)}function Ig(){var t;return typeof self<"u"&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function b_(){var t;return typeof self<"u"&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function fw(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function rT(){return"http:"===b_()||"https:"===b_()}()||function gte(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class Gf{constructor(e,n){this.shortDelay=e,this.longDelay=n,Il(n>e,"Short delay should be less than long delay!"),this.isMobile=function fte(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zs())}()||function yte(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return fw()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Sg(t,e){Il(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class VN{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void Rh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void Rh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void Rh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const dD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},BN=new Gf(3e4,6e4);function fs(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function Go(t,e,n,r){return E_.apply(this,arguments)}function E_(){return(E_=Ze(function*(t,e,n,r,s={}){return pD(t,s,Ze(function*(){let c={},f={};r&&("GET"===e?f=r:c={body:JSON.stringify(r)});const v=xg(Object.assign({key:t.config.apiKey},f)).slice(1),b=yield t._getAdditionalHeaders();return b["Content-Type"]="application/json",t.languageCode&&(b["X-Firebase-Locale"]=t.languageCode),VN.fetch()(fD(t,t.config.apiHost,n,v),Object.assign({method:e,headers:b,referrerPolicy:"no-referrer"},c))}))})).apply(this,arguments)}function pD(t,e,n){return iT.apply(this,arguments)}function iT(){return(iT=Ze(function*(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},dD),e);try{const s=new Ag(t),c=yield Promise.race([n(),s.promise]);s.clearNetworkTimeout();const f=yield c.json();if("needConfirmation"in f)throw Cp(t,"account-exists-with-different-credential",f);if(c.ok&&!("errorMessage"in f))return f;{const v=c.ok?f.errorMessage:f.error.message,[b,S]=v.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===b)throw Cp(t,"credential-already-in-use",f);if("EMAIL_EXISTS"===b)throw Cp(t,"email-already-in-use",f);if("USER_DISABLED"===b)throw Cp(t,"user-disabled",f);const k=r[b]||b.toLowerCase().replace(/[_\s]+/g,"-");if(S)throw wd(t,k,S);Zi(t,k)}}catch(s){if(s instanceof Hf)throw s;Zi(t,"network-request-failed",{message:String(s)})}})).apply(this,arguments)}function x_(){return(x_=Ze(function*(t,e,n,r,s={}){const c=yield Go(t,e,n,r,s);return"mfaPendingCredential"in c&&Zi(t,"multi-factor-auth-required",{_serverResponse:c}),c})).apply(this,arguments)}function fD(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Sg(t.config,s):`${t.config.apiScheme}://${s}`}class Ag{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ia(this.auth,"network-request-failed")),BN.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Cp(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Ia(t,e,r);return s.customData._tokenResponse=n,s}function C_(){return(C_=Ze(function*(t,e){return Go(t,"POST","/v1/accounts:delete",e)})).apply(this,arguments)}function I_(){return(I_=Ze(function*(t,e){return Go(t,"POST","/v1/accounts:lookup",e)})).apply(this,arguments)}function al(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Mg(){return(Mg=Ze(function*(t,e=!1){const n=xp(t),r=yield n.getIdToken(e),s=yw(r);Pt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const c="object"==typeof s.firebase?s.firebase:void 0,f=c?.sign_in_provider;return{claims:s,token:r,authTime:al(S_(s.auth_time)),issuedAtTime:al(S_(s.iat)),expirationTime:al(S_(s.exp)),signInProvider:f||null,signInSecondFactor:c?.sign_in_second_factor||null}})).apply(this,arguments)}function S_(t){return 1e3*Number(t)}function yw(t){const[e,n,r]=t.split(".");if(void 0===e||void 0===n||void 0===r)return vd("JWT malformed, contained fewer than 3 sections"),null;try{const s=tT(n);return s?JSON.parse(s):(vd("Failed to decode base64 JWT payload"),null)}catch(s){return vd("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Mc(t,e){return kg.apply(this,arguments)}function kg(){return(kg=Ze(function*(t,e,n=!1){if(n)return e;try{return yield e}catch(r){throw r instanceof Hf&&function _w({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(r)&&t.auth.currentUser===t&&(yield t.auth.signOut()),r}})).apply(this,arguments)}class Ip{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const s=(null!==(n=this.user.stsTokenManager.expirationTime)&&void 0!==n?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){var n=this;if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(Ze(function*(){yield n.iteration()}),r)}iteration(){var e=this;return Ze(function*(){try{yield e.user.getIdToken(!0)}catch(n){return void("auth/network-request-failed"===n?.code&&e.schedule(!0))}e.schedule()})()}}class vw{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=al(this.lastLoginAt),this.creationTime=al(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function xd(t){return sT.apply(this,arguments)}function sT(){return sT=Ze(function*(t){var e;const n=t.auth,r=yield t.getIdToken(),s=yield Mc(t,function Rg(t,e){return I_.apply(this,arguments)}(n,{idToken:r}));Pt(s?.users.length,n,"internal-error");const c=s.users[0];t._notifyReloadListener(c);const f=null!==(e=c.providerUserInfo)&&void 0!==e&&e.length?function A_(t){return t.map(e=>{var{providerId:n}=e,r=gb(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}(c.providerUserInfo):[],v=function _D(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}(t.providerData,f),k=!!t.isAnonymous&&!(t.email&&c.passwordHash||v?.length),F={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:v,metadata:new vw(c.createdAt,c.lastLoginAt),isAnonymous:k};Object.assign(t,F)}),sT.apply(this,arguments)}function Sp(){return(Sp=Ze(function*(t){const e=xp(t);yield xd(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})).apply(this,arguments)}function aT(){return(aT=Ze(function*(t,e){const n=yield pD(t,{},Ze(function*(){const r=xg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:c}=t.config,f=fD(t,s,"/v1/token",`key=${c}`),v=yield t._getAdditionalHeaders();return v["Content-Type"]="application/x-www-form-urlencoded",VN.fetch()(f,{method:"POST",headers:v,body:r})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}})).apply(this,arguments)}function Fi(){return(Fi=Ze(function*(t,e){return Go(t,"POST","/v2/accounts:revokeToken",fs(t,e))})).apply(this,arguments)}class Kf{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Pt(e.idToken,"internal-error"),Pt(typeof e.idToken<"u","internal-error"),Pt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):function jN(t){const e=yw(t);return Pt(e,"internal-error"),Pt(typeof e.exp<"u","internal-error"),Pt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}getToken(e,n=!1){var r=this;return Ze(function*(){return Pt(!r.accessToken||r.refreshToken,e,"user-token-expired"),n||!r.accessToken||r.isExpired?r.refreshToken?(yield r.refresh(e,r.refreshToken),r.accessToken):null:r.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,n){var r=this;return Ze(function*(){const{accessToken:s,refreshToken:c,expiresIn:f}=yield function D_(t,e){return aT.apply(this,arguments)}(e,n);r.updateTokensAndExpiration(s,c,Number(f))})()}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:c}=n,f=new Kf;return r&&(Pt("string"==typeof r,"internal-error",{appName:e}),f.refreshToken=r),s&&(Pt("string"==typeof s,"internal-error",{appName:e}),f.accessToken=s),c&&(Pt("number"==typeof c,"internal-error",{appName:e}),f.expirationTime=c),f}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Kf,this.toJSON())}_performRefresh(){return Rh("not implemented")}}function Wf(t,e){Pt("string"==typeof t||typeof t>"u","internal-error",{appName:e})}class Yf{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,c=gb(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ip(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new vw(c.createdAt||void 0,c.lastLoginAt||void 0)}getIdToken(e){var n=this;return Ze(function*(){const r=yield Mc(n,n.stsTokenManager.getToken(n.auth,e));return Pt(r,n.auth,"internal-error"),n.accessToken!==r&&(n.accessToken=r,yield n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)),r})()}getIdTokenResult(e){return function gD(t){return Mg.apply(this,arguments)}(this,e)}reload(){return function yD(t){return Sp.apply(this,arguments)}(this)}_assign(e){this!==e&&(Pt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Yf(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Pt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,n=!1){var r=this;return Ze(function*(){let s=!1;e.idToken&&e.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(e),s=!0),n&&(yield xd(r)),yield r.auth._persistUserIfCurrent(r),s&&r.auth._notifyListenersIfCurrent(r)})()}delete(){var e=this;return Ze(function*(){const n=yield e.getIdToken();return yield Mc(e,function Pg(t,e){return C_.apply(this,arguments)}(e.auth,{idToken:n})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,c,f,v,b,S,k;const F=null!==(r=n.displayName)&&void 0!==r?r:void 0,H=null!==(s=n.email)&&void 0!==s?s:void 0,Q=null!==(c=n.phoneNumber)&&void 0!==c?c:void 0,de=null!==(f=n.photoURL)&&void 0!==f?f:void 0,be=null!==(v=n.tenantId)&&void 0!==v?v:void 0,Ie=null!==(b=n._redirectEventId)&&void 0!==b?b:void 0,Be=null!==(S=n.createdAt)&&void 0!==S?S:void 0,Fe=null!==(k=n.lastLoginAt)&&void 0!==k?k:void 0,{uid:tt,emailVerified:mt,isAnonymous:Xt,providerData:bn,stsTokenManager:Or}=n;Pt(tt&&Or,e,"internal-error");const Bi=Kf.fromJSON(this.name,Or);Pt("string"==typeof tt,e,"internal-error"),Wf(F,e.name),Wf(H,e.name),Pt("boolean"==typeof mt,e,"internal-error"),Pt("boolean"==typeof Xt,e,"internal-error"),Wf(Q,e.name),Wf(de,e.name),Wf(be,e.name),Wf(Ie,e.name),Wf(Be,e.name),Wf(Fe,e.name);const ys=new Yf({uid:tt,auth:e,email:H,emailVerified:mt,displayName:F,isAnonymous:Xt,photoURL:de,phoneNumber:Q,tenantId:be,stsTokenManager:Bi,createdAt:Be,lastLoginAt:Fe});return bn&&Array.isArray(bn)&&(ys.providerData=bn.map(Ui=>Object.assign({},Ui))),Ie&&(ys._redirectEventId=Ie),ys}static _fromIdTokenResponse(e,n,r=!1){return Ze(function*(){const s=new Kf;s.updateFromServerResponse(n);const c=new Yf({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return yield xd(c),c})()}}const P_=new Map;function Ap(t){Il(t instanceof Function,"Expected a class definition");let e=P_.get(t);return e?(Il(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,P_.set(t,e),e)}const ww=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return Ze(function*(){return!0})()}_set(n,r){var s=this;return Ze(function*(){s.storage[n]=r})()}_get(n){var r=this;return Ze(function*(){const s=r.storage[n];return void 0===s?null:s})()}_remove(n){var r=this;return Ze(function*(){delete r.storage[n]})()}_addListener(n,r){}_removeListener(n,r){}}return t.type="NONE",t})();function lT(t,e,n){return`firebase:${t}:${e}:${n}`}class Zf{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:c}=this.auth;this.fullUserKey=lT(this.userKey,s.apiKey,c),this.fullPersistenceKey=lT("persistence",s.apiKey,c),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return Ze(function*(){const n=yield e.persistence._get(e.fullUserKey);return n?Yf._fromJSON(e.auth,n):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var n=this;return Ze(function*(){if(n.persistence===e)return;const r=yield n.getCurrentUser();return yield n.removeCurrentUser(),n.persistence=e,r?n.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,n,r="authUser"){return Ze(function*(){if(!n.length)return new Zf(Ap(ww),e,r);const s=(yield Promise.all(n.map(function(){var S=Ze(function*(k){if(yield k._isAvailable())return k});return function(k){return S.apply(this,arguments)}}()))).filter(S=>S);let c=s[0]||Ap(ww);const f=lT(r,e.config.apiKey,e.name);let v=null;for(const S of n)try{const k=yield S._get(f);if(k){const F=Yf._fromJSON(e,k);S!==c&&(v=F),c=S;break}}catch{}const b=s.filter(S=>S._shouldAllowMigration);return c._shouldAllowMigration&&b.length?(c=b[0],v&&(yield c._set(f,v.toJSON())),yield Promise.all(n.map(function(){var S=Ze(function*(k){if(k!==c)try{yield k._remove(f)}catch{}});return function(k){return S.apply(this,arguments)}}())),new Zf(c,e,r)):new Zf(c,e,r)})()}}function bw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ei(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ew(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Do(e))return"Blackberry";if(Tw(e))return"Webos";if(ss(e))return"Safari";if((e.includes("chrome/")||xw(e))&&!e.includes("edge/"))return"Chrome";if(as(e))return"Android";{const r=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function Ew(t=zs()){return/firefox\//i.test(t)}function ss(t=zs()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xw(t=zs()){return/crios\//i.test(t)}function Ei(t=zs()){return/iemobile/i.test(t)}function as(t=zs()){return/android/i.test(t)}function Do(t=zs()){return/blackberry/i.test(t)}function Tw(t=zs()){return/webos/i.test(t)}function Cw(t=zs()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function wD(t=zs()){return Cw(t)||as(t)||Tw(t)||Do(t)||/windows phone/i.test(t)||Ei(t)}function hT(t,e=[]){let n;switch(t){case"Browser":n=bw(zs());break;case"Worker":n=`${bw(zs())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${vi}/${r}`}class $N{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=c=>new Promise((f,v)=>{try{f(e(c))}catch(b){v(b)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}runMiddleware(e){var n=this;return Ze(function*(){if(n.auth.currentUser===e)return;const r=[];try{for(const s of n.queue)yield s(e),s.onAbort&&r.push(s.onAbort)}catch(s){r.reverse();for(const c of r)try{c()}catch{}throw n.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}})()}}function R_(){return(R_=Ze(function*(t,e={}){return Go(t,"GET","/v2/passwordPolicy",fs(t,e))})).apply(this,arguments)}class GN{constructor(e){var n,r,s,c;const f=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(n=f.minPasswordLength)&&void 0!==n?n:6,f.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=f.maxPasswordLength),void 0!==f.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=f.containsLowercaseCharacter),void 0!==f.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=f.containsUppercaseCharacter),void 0!==f.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=f.containsNumericCharacter),void 0!==f.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=f.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(s=null===(r=e.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==s?s:"",this.forceUpgradeOnSignin=null!==(c=e.forceUpgradeOnSignin)&&void 0!==c&&c,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,c,f,v;const b={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,b),this.validatePasswordCharacterOptions(e,b),b.isValid&&(b.isValid=null===(n=b.meetsMinPasswordLength)||void 0===n||n),b.isValid&&(b.isValid=null===(r=b.meetsMaxPasswordLength)||void 0===r||r),b.isValid&&(b.isValid=null===(s=b.containsLowercaseLetter)||void 0===s||s),b.isValid&&(b.isValid=null===(c=b.containsUppercaseLetter)||void 0===c||c),b.isValid&&(b.isValid=null===(f=b.containsNumericCharacter)||void 0===f||f),b.isValid&&(b.isValid=null===(v=b.containsNonAlphanumericCharacter)||void 0===v||v),b}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){let r;this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}class Ts{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lu(this),this.idTokenSubscription=new lu(this),this.beforeStateQueue=new $N(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=FN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){var r=this;return n&&(this._popupRedirectResolver=Ap(n)),this._initializationPromise=this.queue(Ze(function*(){var s,c;if(!r._deleted&&(r.persistenceManager=yield Zf.create(r,e),!r._deleted)){if(null!==(s=r._popupRedirectResolver)&&void 0!==s&&s._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(n),r.lastNotifiedUid=(null===(c=r.currentUser)||void 0===c?void 0:c.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return Ze(function*(){if(e._deleted)return;const n=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||n){if(e.currentUser&&n&&e.currentUser.uid===n.uid)return e._currentUser._assign(n),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(n,!0)}})()}initializeCurrentUser(e){var n=this;return Ze(function*(){var r;const s=yield n.assertedPersistence.getCurrentUser();let c=s,f=!1;if(e&&n.config.authDomain){yield n.getOrInitRedirectPersistenceManager();const v=null===(r=n.redirectUser)||void 0===r?void 0:r._redirectEventId,b=c?._redirectEventId,S=yield n.tryRedirectSignIn(e);(!v||v===b)&&S?.user&&(c=S.user,f=!0)}if(!c)return n.directlySetCurrentUser(null);if(!c._redirectEventId){if(f)try{yield n.beforeStateQueue.runMiddleware(c)}catch(v){c=s,n._popupRedirectResolver._overrideRedirectResult(n,()=>Promise.reject(v))}return c?n.reloadAndSetCurrentUserOrClear(c):n.directlySetCurrentUser(null)}return Pt(n._popupRedirectResolver,n,"argument-error"),yield n.getOrInitRedirectPersistenceManager(),n.redirectUser&&n.redirectUser._redirectEventId===c._redirectEventId?n.directlySetCurrentUser(c):n.reloadAndSetCurrentUserOrClear(c)})()}tryRedirectSignIn(e){var n=this;return Ze(function*(){let r=null;try{r=yield n._popupRedirectResolver._completeRedirectFn(n,e,!0)}catch{yield n._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(e){var n=this;return Ze(function*(){try{yield xd(e)}catch(r){if("auth/network-request-failed"!==r?.code)return n.directlySetCurrentUser(null)}return n.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function qf(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}_delete(){var e=this;return Ze(function*(){e._deleted=!0})()}updateCurrentUser(e){var n=this;return Ze(function*(){const r=e?xp(e):null;return r&&Pt(r.auth.config.apiKey===n.config.apiKey,n,"invalid-user-token"),n._updateCurrentUser(r&&r._clone(n))})()}_updateCurrentUser(e,n=!1){var r=this;return Ze(function*(){if(!r._deleted)return e&&Pt(r.tenantId===e.tenantId,r,"tenant-id-mismatch"),n||(yield r.beforeStateQueue.runMiddleware(e)),r.queue(Ze(function*(){yield r.directlySetCurrentUser(e),r.notifyAuthListeners()}))})()}signOut(){var e=this;return Ze(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var n=this;return this.queue(Ze(function*(){yield n.assertedPersistence.setPersistence(Ap(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){var n=this;return Ze(function*(){n._getPasswordPolicyInternal()||(yield n._updatePasswordPolicy());const r=n._getPasswordPolicyInternal();return r.schemaVersion!==n.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(n._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var e=this;return Ze(function*(){const n=yield function bD(t){return R_.apply(this,arguments)}(e),r=new GN(n);null===e.tenantId?e._projectPasswordPolicy=r:e._tenantPasswordPolicies[e.tenantId]=r})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new aD("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}revokeAccessToken(e){var n=this;return Ze(function*(){if(n.currentUser){const r=yield n.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};null!=n.tenantId&&(s.tenantId=n.tenantId),yield function vD(t,e){return Fi.apply(this,arguments)}(n,s)}})()}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,n){var r=this;return Ze(function*(){const s=yield r.getOrInitRedirectPersistenceManager(n);return null===e?s.removeCurrentUser():s.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var n=this;return Ze(function*(){if(!n.redirectPersistenceManager){const r=e&&Ap(e)||n._popupRedirectResolver;Pt(r,n,"argument-error"),n.redirectPersistenceManager=yield Zf.create(n,[Ap(r._redirectPersistence)],"redirectUser"),n.redirectUser=yield n.redirectPersistenceManager.getCurrentUser()}return n.redirectPersistenceManager})()}_redirectUserForId(e){var n=this;return Ze(function*(){var r,s;return n._isInitialized&&(yield n.queue(Ze(function*(){}))),(null===(r=n._currentUser)||void 0===r?void 0:r._redirectEventId)===e?n._currentUser:(null===(s=n.redirectUser)||void 0===s?void 0:s._redirectEventId)===e?n.redirectUser:null})()}_persistUserIfCurrent(e){var n=this;return Ze(function*(){if(e===n.currentUser)return n.queue(Ze(function*(){return n.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(n=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==n?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const c="function"==typeof n?n:n.next.bind(n);let f=!1;const v=this._isInitialized?Promise.resolve():this._initializationPromise;if(Pt(v,this,"internal-error"),v.then(()=>{f||c(this.currentUser)}),"function"==typeof n){const b=e.addObserver(n,r,s);return()=>{f=!0,b()}}{const b=e.addObserver(n);return()=>{f=!0,b()}}}directlySetCurrentUser(e){var n=this;return Ze(function*(){n.currentUser&&n.currentUser!==e&&n._currentUser._stopProactiveRefresh(),e&&n.isProactiveRefreshEnabled&&e._startProactiveRefresh(),n.currentUser=e,e?yield n.assertedPersistence.setCurrentUser(e):yield n.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Pt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return Ze(function*(){var n;const r={"X-Client-Version":e.clientVersion};e.app.options.appId&&(r["X-Firebase-gmpid"]=e.app.options.appId);const s=yield null===(n=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===n?void 0:n.getHeartbeatsHeader();s&&(r["X-Firebase-Client"]=s);const c=yield e._getAppCheckToken();return c&&(r["X-Firebase-AppCheck"]=c),r})()}_getAppCheckToken(){var e=this;return Ze(function*(){var n;const r=yield null===(n=e.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===n?void 0:n.getToken();return r?.error&&function hD(t,...e){lc.logLevel<=o.WARN&&lc.warn(`Auth (${vi}): ${t}`,...e)}(`Error while retrieving App Check token: ${r.error}`),r?.token})()}}function Ko(t){return xp(t)}class lu{constructor(e){this.auth=e,this.observer=null,this.addObserver=function f5(t,e){const n=new m5(t,e);return n.subscribe.bind(n)}(n=>this.observer=n)}get next(){return Pt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Og={loadJS:()=>Ze(function*(){throw new Error("Unable to load external scripts")})(),recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function TD(t){return`__${t}${Math.floor(1e6*Math.random())}`}function N_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function cu(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class Yu{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Rh("not implemented")}_getIdTokenResponse(e){return Rh("not implemented")}_linkToIdToken(e,n){return Rh("not implemented")}_getReauthenticationResolver(e){return Rh("not implemented")}}function Mp(t,e){return Oc.apply(this,arguments)}function Oc(){return(Oc=Ze(function*(t,e){return function Ed(t,e,n,r){return x_.apply(this,arguments)}(t,"POST","/v1/accounts:signInWithIdp",fs(t,e))})).apply(this,arguments)}class Bn extends Yu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Bn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Zi("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n="string"==typeof e?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,c=gb(n,["providerId","signInMethod"]);if(!r||!s)return null;const f=new Bn(r,s);return f.idToken=c.idToken||void 0,f.accessToken=c.accessToken||void 0,f.secret=c.secret,f.nonce=c.nonce,f.pendingToken=c.pendingToken||null,f}_getIdTokenResponse(e){return Mp(e,this.buildRequest())}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Mp(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Mp(e,n)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=xg(n)}return e}}class Td{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Nw extends Td{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let TT=(()=>{class t extends Nw{constructor(){super("google.com"),this.addScope("profile")}static credential(n,r){return Bn._fromParams({providerId:t.PROVIDER_ID,signInMethod:t.GOOGLE_SIGN_IN_METHOD,idToken:n,accessToken:r})}static credentialFromResult(n){return t.credentialFromTaggedObject(n)}static credentialFromError(n){return t.credentialFromTaggedObject(n.customData||{})}static credentialFromTaggedObject({_tokenResponse:n}){if(!n)return null;const{oauthIdToken:r,oauthAccessToken:s}=n;if(!r&&!s)return null;try{return t.credential(r,s)}catch{return null}}}return t.GOOGLE_SIGN_IN_METHOD="google.com",t.PROVIDER_ID="google.com",t})();class Nc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,n,r,s=!1){return Ze(function*(){const c=yield Yf._fromIdTokenResponse(e,r,s),f=Vw(r);return new Nc({user:c,providerId:f,_tokenResponse:r,operationType:n})})()}static _forOperation(e,n,r){return Ze(function*(){yield e._updateTokensIfNecessary(r,!0);const s=Vw(r);return new Nc({user:e,providerId:s,_tokenResponse:r,operationType:n})})()}}function Vw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class U_ extends Hf{constructor(e,n,r,s){var c;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,U_.prototype),this.customData={appName:e.name,tenantId:null!==(c=e.tenantId)&&void 0!==c?c:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new U_(e,n,r,s)}}function Fp(t,e,n,r){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(c=>{throw"auth/multi-factor-auth-required"===c.code?U_._fromErrorAndOperation(t,c,e,r):c})}function Uw(){return(Uw=Ze(function*(t,e,n=!1){const r=yield Mc(t,e._linkToIdToken(t.auth,yield t.getIdToken()),n);return Nc._forOperation(t,"link",r)})).apply(this,arguments)}function DT(){return(DT=Ze(function*(t,e,n=!1){const{auth:r}=t,s="reauthenticate";try{const c=yield Mc(t,Fp(r,s,e,t),n);Pt(c.idToken,r,"internal-error");const f=yw(c.idToken);Pt(f,r,"internal-error");const{sub:v}=f;return Pt(t.uid===v,r,"user-mismatch"),Nc._forOperation(t,s,c)}catch(c){throw"auth/user-not-found"===c?.code&&Zi(r,"user-mismatch"),c}})).apply(this,arguments)}function PT(){return(PT=Ze(function*(t,e,n=!1){const r="signIn",s=yield Fp(t,r,e),c=yield Nc._fromIdTokenResponse(t,r,s);return n||(yield t._updateCurrentUser(c.user)),c})).apply(this,arguments)}const hu="__sak";class zg{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(hu,"1"),this.storage.removeItem(hu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Sd=(()=>{class t extends zg{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(n,r)=>this.onStorageEvent(n,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function nm(){const t=zs();return ss(t)||Cw(t)}()&&function uT(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=wD(),this._shouldAllowMigration=!0}forAllChangedKeys(n){for(const r of Object.keys(this.listeners)){const s=this.storage.getItem(r),c=this.localCache[r];s!==c&&n(r,c,s)}}onStorageEvent(n,r=!1){if(!n.key)return void this.forAllChangedKeys((v,b,S)=>{this.notifyListeners(v,S)});const s=n.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const v=this.storage.getItem(s);if(n.newValue!==v)null!==n.newValue?this.storage.setItem(s,n.newValue):this.storage.removeItem(s);else if(this.localCache[s]===n.newValue&&!r)return}const c=()=>{const v=this.storage.getItem(s);!r&&this.localCache[s]===v||this.notifyListeners(s,v)},f=this.storage.getItem(s);!function cT(){return function _te(){const t=zs();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()&&10===document.documentMode}()||f===n.newValue||n.newValue===n.oldValue?c():setTimeout(c,10)}notifyListeners(n,r){this.localCache[n]=r;const s=this.listeners[n];if(s)for(const c of Array.from(s))c(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((n,r,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:n,oldValue:r,newValue:s}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(n,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[n]||(this.listeners[n]=new Set,this.localCache[n]=this.storage.getItem(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),0===this.listeners[n].size&&delete this.listeners[n]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(n,r){var s=()=>super._set,c=this;return Ze(function*(){yield s().call(c,n,r),c.localCache[n]=JSON.stringify(r)})()}_get(n){var r=()=>super._get,s=this;return Ze(function*(){const c=yield r().call(s,n);return s.localCache[n]=JSON.stringify(c),c})()}_remove(n){var r=()=>super._remove,s=this;return Ze(function*(){yield r().call(s,n),delete s.localCache[n]})()}}return t.type="LOCAL",t})(),Qu=(()=>{class t extends zg{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(n,r){}_removeListener(n,r){}}return t.type="SESSION",t})();let Y7=(()=>{class t{constructor(n){this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(n){const r=this.receivers.find(c=>c.isListeningto(n));if(r)return r;const s=new t(n);return this.receivers.push(s),s}isListeningto(n){return this.eventTarget===n}handleEvent(n){var r=this;return Ze(function*(){const s=n,{eventId:c,eventType:f,data:v}=s.data,b=r.handlersMap[f];if(!b?.size)return;s.ports[0].postMessage({status:"ack",eventId:c,eventType:f});const S=Array.from(b).map(function(){var F=Ze(function*(H){return H(s.origin,v)});return function(H){return F.apply(this,arguments)}}()),k=yield function kh(t){return Promise.all(t.map(function(){var e=Ze(function*(n){try{return{fulfilled:!0,value:yield n}}catch(r){return{fulfilled:!1,reason:r}}});return function(n){return e.apply(this,arguments)}}()))}(S);s.ports[0].postMessage({status:"done",eventId:c,eventType:f,response:k})})()}_subscribe(n,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[n]||(this.handlersMap[n]=new Set),this.handlersMap[n].add(r)}_unsubscribe(n,r){this.handlersMap[n]&&r&&this.handlersMap[n].delete(r),(!r||0===this.handlersMap[n].size)&&delete this.handlersMap[n],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return t.receivers=[],t})();function eL(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(10*Math.random());return t+n}class Z7{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,n,r=50){var s=this;return Ze(function*(){const c=typeof MessageChannel<"u"?new MessageChannel:null;if(!c)throw new Error("connection_unavailable");let f,v;return new Promise((b,S)=>{const k=eL("",20);c.port1.start();const F=setTimeout(()=>{S(new Error("unsupported_event"))},r);v={messageChannel:c,onMessage(H){const Q=H;if(Q.data.eventId===k)switch(Q.data.status){case"ack":clearTimeout(F),f=setTimeout(()=>{S(new Error("timeout"))},3e3);break;case"done":clearTimeout(f),b(Q.data.response);break;default:clearTimeout(F),clearTimeout(f),S(new Error("invalid_response"))}}},s.handlers.add(v),c.port1.addEventListener("message",v.onMessage),s.target.postMessage({eventType:e,eventId:k,data:n},[c.port2])}).finally(()=>{v&&s.removeMessageHandler(v)})})()}}function ja(){return window}function b5(){return typeof ja().WorkerGlobalScope<"u"&&"function"==typeof ja().importScripts}function tL(){return(tL=Ze(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Q7="firebaseLocalStorageDb",jg="firebaseLocalStorage",$s="fbase_key";class q_{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function UD(t,e){return t.transaction([jg],e?"readwrite":"readonly").objectStore(jg)}function NT(){const t=indexedDB.open(Q7,1);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(jg,{keyPath:$s})}catch(s){n(s)}}),t.addEventListener("success",Ze(function*(){const r=t.result;r.objectStoreNames.contains(jg)?e(r):(r.close(),yield function nL(){const t=indexedDB.deleteDatabase(Q7);return new q_(t).toPromise()}(),e(yield NT()))}))})}function LT(t,e,n){return rL.apply(this,arguments)}function rL(){return(rL=Ze(function*(t,e,n){const r=UD(t,!0).put({[$s]:e,value:n});return new q_(r).toPromise()})).apply(this,arguments)}function Gw(){return(Gw=Ze(function*(t,e){const n=UD(t,!1).get(e),r=yield new q_(n).toPromise();return void 0===r?null:r.value})).apply(this,arguments)}function iL(t,e){const n=UD(t,!0).delete(e);return new q_(n).toPromise()}const zD=(()=>{class t{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var n=this;return Ze(function*(){return n.db||(n.db=yield NT()),n.db})()}_withRetries(n){var r=this;return Ze(function*(){let s=0;for(;;)try{const c=yield r._openDb();return yield n(c)}catch(c){if(s++>3)throw c;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var n=this;return Ze(function*(){return b5()?n.initializeReceiver():n.initializeSender()})()}initializeReceiver(){var n=this;return Ze(function*(){n.receiver=Y7._getInstance(function BD(){return b5()?self:null}()),n.receiver._subscribe("keyChanged",function(){var r=Ze(function*(s,c){return{keyProcessed:(yield n._poll()).includes(c.key)}});return function(s,c){return r.apply(this,arguments)}}()),n.receiver._subscribe("ping",function(){var r=Ze(function*(s,c){return["keyChanged"]});return function(s,c){return r.apply(this,arguments)}}())})()}initializeSender(){var n=this;return Ze(function*(){var r,s;if(n.activeServiceWorker=yield function E5(){return tL.apply(this,arguments)}(),!n.activeServiceWorker)return;n.sender=new Z7(n.activeServiceWorker);const c=yield n.sender._send("ping",{},800);c&&null!==(r=c[0])&&void 0!==r&&r.fulfilled&&null!==(s=c[0])&&void 0!==s&&s.value.includes("keyChanged")&&(n.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(n){var r=this;return Ze(function*(){if(r.sender&&r.activeServiceWorker&&function qw(){var t;return(null===(t=navigator?.serviceWorker)||void 0===t?void 0:t.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:n},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return Ze(function*(){try{if(!indexedDB)return!1;const n=yield NT();return yield LT(n,hu,"1"),yield iL(n,hu),!0}catch{}return!1})()}_withPendingWrite(n){var r=this;return Ze(function*(){r.pendingWrites++;try{yield n()}finally{r.pendingWrites--}})()}_set(n,r){var s=this;return Ze(function*(){return s._withPendingWrite(Ze(function*(){return yield s._withRetries(c=>LT(c,n,r)),s.localCache[n]=r,s.notifyServiceWorker(n)}))})()}_get(n){var r=this;return Ze(function*(){const s=yield r._withRetries(c=>function X7(t,e){return Gw.apply(this,arguments)}(c,n));return r.localCache[n]=s,s})()}_remove(n){var r=this;return Ze(function*(){return r._withPendingWrite(Ze(function*(){return yield r._withRetries(s=>iL(s,n)),delete r.localCache[n],r.notifyServiceWorker(n)}))})()}_poll(){var n=this;return Ze(function*(){const r=yield n._withRetries(f=>{const v=UD(f,!1).getAll();return new q_(v).toPromise()});if(!r)return[];if(0!==n.pendingWrites)return[];const s=[],c=new Set;if(0!==r.length)for(const{fbase_key:f,value:v}of r)c.add(f),JSON.stringify(n.localCache[f])!==JSON.stringify(v)&&(n.notifyListeners(f,v),s.push(f));for(const f of Object.keys(n.localCache))n.localCache[f]&&!c.has(f)&&(n.notifyListeners(f,null),s.push(f));return s})()}notifyListeners(n,r){this.localCache[n]=r;const s=this.listeners[n];if(s)for(const c of Array.from(s))c(r)}startPolling(){var n=this;this.stopPolling(),this.pollTimer=setInterval(Ze(function*(){return n._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(n,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[n]||(this.listeners[n]=new Set,this._get(n)),this.listeners[n].add(r)}_removeListener(n,r){this.listeners[n]&&(this.listeners[n].delete(r),0===this.listeners[n].size&&delete this.listeners[n]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return t.type="LOCAL",t})();function Yw(t,e){return e?Ap(e):(Pt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}TD("rcb"),new Gf(3e4,6e4);class Zw extends Yu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Mp(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Mp(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Mp(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function rK(t){return function Bg(t,e){return PT.apply(this,arguments)}(t.auth,new Zw(t),t.bypassAuthState)}function Vte(t){const{auth:e,user:n}=t;return Pt(n,e,"internal-error"),function OD(t,e){return DT.apply(this,arguments)}(n,new Zw(t),t.bypassAuthState)}function Bte(t){return M5.apply(this,arguments)}function M5(){return(M5=Ze(function*(t){const{auth:e,user:n}=t;return Pt(n,e,"internal-error"),function ST(t,e){return Uw.apply(this,arguments)}(n,new Zw(t),t.bypassAuthState)})).apply(this,arguments)}class iK{constructor(e,n,r,s,c=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){var e=this;return new Promise(function(){var n=Ze(function*(r,s){e.pendingPromise={resolve:r,reject:s};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(c){e.reject(c)}});return function(r,s){return n.apply(this,arguments)}}())}onAuthEvent(e){var n=this;return Ze(function*(){const{urlResponse:r,sessionId:s,postBody:c,tenantId:f,error:v,type:b}=e;if(v)return void n.reject(v);const S={auth:n.auth,requestUri:r,sessionId:s,tenantId:f||void 0,postBody:c||void 0,user:n.user,bypassAuthState:n.bypassAuthState};try{n.resolve(yield n.getIdpTask(b)(S))}catch(k){n.reject(k)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return rK;case"linkViaPopup":case"linkViaRedirect":return Bte;case"reauthViaPopup":case"reauthViaRedirect":return Vte;default:Zi(this.auth,"internal-error")}}resolve(e){Il(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Il(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Ute=new Gf(2e3,1e4);function k5(){return(k5=Ze(function*(t,e,n){const r=Ko(t);!function fi(t,e,n){if(!(e instanceof n))throw n.name!==e.constructor.name&&Zi(t,"argument-error"),wd(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(t,e,Td);const s=Yw(r,n);return new lL(r,"signInViaPopup",e,s).executeNotNull()})).apply(this,arguments)}let lL=(()=>{class t extends iK{constructor(n,r,s,c,f){super(n,r,c,f),this.provider=s,this.authWindow=null,this.pollId=null,t.currentPopupAction&&t.currentPopupAction.cancel(),t.currentPopupAction=this}executeNotNull(){var n=this;return Ze(function*(){const r=yield n.execute();return Pt(r,n.auth,"internal-error"),r})()}onExecution(){var n=this;return Ze(function*(){Il(1===n.filter.length,"Popup operations only handle one event");const r=eL();n.authWindow=yield n.resolver._openPopup(n.auth,n.provider,n.filter[0],r),n.authWindow.associatedEvent=r,n.resolver._originValidation(n.auth).catch(s=>{n.reject(s)}),n.resolver._isIframeWebStorageSupported(n.auth,s=>{s||n.reject(Ia(n.auth,"web-storage-unsupported"))}),n.pollUserCancellation()})()}get eventId(){var n;return(null===(n=this.authWindow)||void 0===n?void 0:n.associatedEvent)||null}cancel(){this.reject(Ia(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,t.currentPopupAction=null}pollUserCancellation(){const n=()=>{var r,s;this.pollId=null!==(s=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==s&&s.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Ia(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(n,Ute.get())};n()}}return t.currentPopupAction=null,t})();const $te="pendingRedirect",Qw=new Map;class qte extends iK{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}execute(){var e=()=>super.execute,n=this;return Ze(function*(){let r=Qw.get(n.auth._key());if(!r){try{const c=(yield function oK(t,e){return O5.apply(this,arguments)}(n.resolver,n.auth))?yield e().call(n):null;r=()=>Promise.resolve(c)}catch(s){r=()=>Promise.reject(s)}Qw.set(n.auth._key(),r)}return n.bypassAuthState||Qw.set(n.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(e){var n=()=>super.onAuthEvent,r=this;return Ze(function*(){if("signInViaRedirect"===e.type)return n().call(r,e);if("unknown"!==e.type){if(e.eventId){const s=yield r.auth._redirectUserForId(e.eventId);if(s)return r.user=s,n().call(r,e);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return Ze(function*(){})()}cleanUp(){}}function O5(){return(O5=Ze(function*(t,e){const n=function VT(t){return lT($te,t.config.apiKey,t.name)}(e),r=function sK(t){return Ap(t._redirectPersistence)}(t);if(!(yield r._isAvailable()))return!1;const s="true"===(yield r._get(n));return yield r._remove(n),s})).apply(this,arguments)}function Kte(t,e){Qw.set(t._key(),e)}function F5(t,e){return V5.apply(this,arguments)}function V5(){return(V5=Ze(function*(t,e,n=!1){const r=Ko(t),s=Yw(r,e),f=yield new qte(r,s,n).execute();return f&&!n&&(delete f.user._redirectEventId,yield r._persistUserIfCurrent(f.user),yield r._setRedirectUser(null,e)),f})).apply(this,arguments)}class Yte{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function Zte(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hK(t);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!hK(e)){const s=(null===(r=e.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";n.onError(Ia(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=null===n.eventId||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(uK(e))}saveEventToCache(e){this.cachedEventUids.add(uK(e)),this.lastProcessedEventTime=Date.now()}}function uK(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function hK({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===e?.code}function BT(){return(BT=Ze(function*(t,e={}){return Go(t,"GET","/v1/projects",e)})).apply(this,arguments)}const UT=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dK=/^https?/;function $D(){return $D=Ze(function*(t){if(t.config.emulator)return;const{authorizedDomains:e}=yield function Qte(t){return BT.apply(this,arguments)}(t);for(const n of e)try{if(U5(n))return}catch{}Zi(t,"unauthorized-domain")}),$D.apply(this,arguments)}function U5(t){const e=Ig(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const f=new URL(t);return""===f.hostname&&""===r?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&f.hostname===r}if(!dK.test(n))return!1;if(UT.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const Xte=new Gf(3e4,6e4);function pK(){const t=ja().___jsl;if(t?.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}function Jte(t){return new Promise((e,n)=>{var r,s,c;function f(){pK(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pK(),n(Ia(t,"network-request-failed"))},timeout:Xte.get()})}if(null!==(s=null===(r=ja().gapi)||void 0===r?void 0:r.iframes)&&void 0!==s&&s.Iframe)e(gapi.iframes.getContext());else{if(null===(c=ja().gapi)||void 0===c||!c.load){const v=TD("iframefcb");return ja()[v]=()=>{gapi.load?f():n(Ia(t,"network-request-failed"))},function dT(t){return Og.loadJS(t)}(`${function xD(){return Og.gapiScript}()}?onload=${v}`).catch(b=>n(b))}f()}}).catch(e=>{throw qD=null,e})}let qD=null;const du=new Gf(5e3,15e3),z5="__/auth/iframe",mK="emulator/auth/iframe",GD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},KD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function zT(t){const e=t.config;Pt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Sg(e,mK):`https://${t.config.authDomain}/${z5}`,r={apiKey:e.apiKey,appName:t.name,v:vi},s=KD.get(t.config.apiHost);s&&(r.eid=s);const c=t._getFrameworks();return c.length&&(r.fw=c.join(",")),`${n}?${xg(r).slice(1)}`}function jT(){return jT=Ze(function*(t){const e=yield function fK(t){return qD=qD||Jte(t),qD}(t),n=ja().gapi;return Pt(n,t,"internal-error"),e.open({where:document.body,url:zT(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:GD,dontclear:!0},r=>new Promise(function(){var s=Ze(function*(c,f){yield r.restyle({setHideOnLeave:!1});const v=Ia(t,"network-request-failed"),b=ja().setTimeout(()=>{f(v)},du.get());function S(){ja().clearTimeout(b),c(r)}r.ping(S).then(S,()=>{f(v)})});return function(c,f){return s.apply(this,arguments)}}()))}),jT.apply(this,arguments)}const ene={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class pL{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const WD="__/auth/handler",rm="emulator/auth/handler",Y_=encodeURIComponent("fac");function H5(t,e,n,r,s,c){return YD.apply(this,arguments)}function YD(){return(YD=Ze(function*(t,e,n,r,s,c){Pt(t.config.authDomain,t,"auth-domain-config-required"),Pt(t.config.apiKey,t,"invalid-api-key");const f={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:vi,eventId:s};if(e instanceof Td){e.setDefaultLanguage(t.languageCode),f.providerId=e.providerId||"",function xte(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(f.customParameters=JSON.stringify(e.getCustomParameters()));for(const[k,F]of Object.entries(c||{}))f[k]=F}if(e instanceof Nw){const k=e.getScopes().filter(F=>""!==F);k.length>0&&(f.scopes=k.join(","))}t.tenantId&&(f.tid=t.tenantId);const v=f;for(const k of Object.keys(v))void 0===v[k]&&delete v[k];const b=yield t._getAppCheckToken(),S=b?`#${Y_}=${encodeURIComponent(b)}`:"";return`${function tne({config:t}){return t.emulator?Sg(t,rm):`https://${t.authDomain}/${WD}`}(t)}?${xg(v).slice(1)}${S}`})).apply(this,arguments)}const $5="webStorageSupport",q5=class fL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Qu,this._completeRedirectFn=F5,this._overrideRedirectResult=Kte}_openPopup(e,n,r,s){var c=this;return Ze(function*(){var f;Il(null===(f=c.eventManagers[e._key()])||void 0===f?void 0:f.manager,"_initialize() not called before _openPopup()");const v=yield H5(e,n,r,Ig(),s);return function vK(t,e,n,r=500,s=600){const c=Math.max((window.screen.availHeight-s)/2,0).toString(),f=Math.max((window.screen.availWidth-r)/2,0).toString();let v="";const b=Object.assign(Object.assign({},ene),{width:r.toString(),height:s.toString(),top:c,left:f}),S=zs().toLowerCase();n&&(v=xw(S)?"_blank":n),Ew(S)&&(e=e||"http://localhost",b.scrollbars="yes");const k=Object.entries(b).reduce((H,[Q,de])=>`${H}${Q}=${de},`,"");if(function y5(t=zs()){var e;return Cw(t)&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(S)&&"_self"!==v)return function wK(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(e||"",v),new pL(null);const F=window.open(e||"",v,k);Pt(F,t,"popup-blocked");try{F.focus()}catch{}return new pL(F)}(e,v,eL())})()}_openRedirect(e,n,r,s){var c=this;return Ze(function*(){return yield c._originValidation(e),function Pte(t){ja().location.href=t}(yield H5(e,n,r,Ig(),s)),new Promise(()=>{})})()}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:c}=this.eventManagers[n];return s?Promise.resolve(s):(Il(c,"If manager is not set, promise should be"),c)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}initAndGetManager(e){var n=this;return Ze(function*(){const r=yield function dL(t){return jT.apply(this,arguments)}(e),s=new Yte(e);return r.register("authEvent",c=>(Pt(c?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(c.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),n.eventManagers[e._key()]={manager:s},n.iframes[e._key()]=r,s})()}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send($5,{type:$5},s=>{var c;const f=null===(c=s?.[0])||void 0===c?void 0:c[$5];void 0!==f&&n(!!f),Zi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=function hL(t){return $D.apply(this,arguments)}(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return wD()||ss()||Cw()}};var gL="@firebase/auth";class yL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var n=this;return Ze(function*(){return n.assertAuthConfigured(),yield n.auth._initializationPromise,n.auth.currentUser?{accessToken:yield n.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Pt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const xK=V7("authIdTokenMaxAge")||300;let TK=null;const ine=t=>function(){var e=Ze(function*(n){const r=n&&(yield n.getIdTokenResult()),s=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(s&&s>xK)return;const c=r?.token;TK!==c&&(TK=c,yield fetch(t,{method:c?"POST":"DELETE",headers:c?{Authorization:`Bearer ${c}`}:{}}))});return function(n){return e.apply(this,arguments)}}();function one(t=J()){const e=qt(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function WN(t,e){const n=qt(t,"auth");if(n.isInitialized()){const s=n.getImmediate();if(MN(n.getOptions(),e??{}))return s;Zi(s,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:q5,persistence:[zD,Sd,Qu]}),r=V7("authTokenSyncURL");if(r){const c=ine(r);(function ll(t,e,n){xp(t).beforeAuthStateChanged(e,n)})(n,c,()=>c(n.currentUser)),function Mh(t,e,n,r){xp(t).onIdTokenChanged(e,n,r)}(n,f=>c(f))}const s=jf("auth");return s&&function Dp(t,e,n){const r=Ko(t);Pt(r._canInitEmulator,r,"emulator-config-failed"),Pt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!n?.disableWarnings,c=N_(e),{host:f,port:v}=function kc(t){const e=N_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const c=s[1];return{host:c,port:cu(r.substr(c.length+1))}}{const[c,f]=r.split(":");return{host:c,port:cu(f)}}}(e);r.config.emulator={url:`${c}//${f}${null===v?"":`:${v}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:f,port:v,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function SD(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${s}`),n}(function ED(t){Og=t})({loadJS:t=>new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const c=Ia("internal-error");c.customData=s,n(c)},r.type="text/javascript",r.charset="UTF-8",function sne(){var t,e;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),function nne(t){Dt(new Tp("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:f,authDomain:v}=r.options;Pt(f&&!f.includes(":"),"invalid-api-key",{appName:r.name});const b={apiKey:f,authDomain:v,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hT(t)},S=new Ts(r,s,c,b);return function mT(t,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(Ap);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}(S,n),S},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Dt(new Tp("auth-internal",e=>{const n=Ko(e.getProvider("auth").getImmediate());return new yL(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ue(gL,"1.6.0",function EK(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(t)),Ue(gL,"1.6.0","esm2017")}("Browser");const _L="firebasestorage.googleapis.com",Hg="storageBucket";class qs extends Hf{constructor(e,n,r=0){super(Y5(e),`Firebase Storage: ${n} (${Y5(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,qs.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Y5(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Fs=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Fs||{});function Y5(t){return"storage/"+t}function XD(){return new qs(Fs.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function bL(t){return new qs(Fs.INVALID_ARGUMENT,t)}function X5(){return new qs(Fs.APP_DELETED,"The Firebase app was deleted.")}function HT(t,e){return new qs(Fs.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Ad(t){throw new qs(Fs.INTERNAL_ERROR,"Internal error: "+t)}class Lc{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Lc.makeFromUrl(e,n)}catch{return new Lc(e,"")}if(""===r.path)return r;throw function JD(t){return new qs(Fs.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)",v=new RegExp("^gs://"+s+"(/(.*))?$","i");function S(mt){mt.path_=decodeURIComponent(mt.path)}const F=n.replace(/[.]/g,"\\."),tt=[{regex:v,indices:{bucket:1,path:3},postModify:function c(mt){"/"===mt.path.charAt(mt.path.length-1)&&(mt.path_=mt.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${F}/v[A-Za-z0-9_]+/b/${s}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:S},{regex:new RegExp(`^https?://${n===_L?"(?:storage.googleapis.com|storage.cloud.google.com)":n}/${s}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:S}];for(let mt=0;mt<tt.length;mt++){const Xt=tt[mt],bn=Xt.regex.exec(e);if(bn){let Bi=bn[Xt.indices.path];Bi||(Bi=""),r=new Lc(bn[Xt.indices.bucket],Bi),Xt.postModify(r);break}}if(null==r)throw function Nh(t){return new qs(Fs.INVALID_URL,"Invalid URL '"+t+"'.")}(e);return r}}class MK{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Xw(t){return"string"==typeof t||t instanceof String}function J5(t){return e6()&&t instanceof Blob}function e6(){return typeof Blob<"u"}function qT(t,e,n,r){if(r<e)throw bL(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw bL(`Invalid value for '${t}'. Expected ${n} or less.`)}var GT=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(GT||{});class KT{constructor(e,n,r,s,c,f,v,b,S,k,F,H=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=c,this.additionalRetryCodes_=f,this.callback_=v,this.errorCallback_=b,this.timeout_=S,this.progressCallback_=k,this.connectionFactory_=F,this.retry=H,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((Q,de)=>{this.resolve_=Q,this.reject_=de,this.start_()})}start_(){const n=(r,s)=>{const c=this.resolve_,f=this.reject_,v=s.connection;if(s.wasSuccessCode)try{const b=this.callback_(v,v.getResponse());!function dne(t){return void 0!==t}(b)?c():c(b)}catch(b){f(b)}else if(null!==v){const b=XD();b.serverResponse=v.getErrorText(),f(this.errorCallback_?this.errorCallback_(v,b):b)}else f(s.canceled?this.appDelete_?X5():function Z5(){return new qs(Fs.CANCELED,"User canceled the upload/download.")}():function wL(){return new qs(Fs.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}())};this.canceled_?n(0,new Up(!1,null,!0)):this.backoffId_=function kK(t,e,n){let r=1,s=null,c=null,f=!1,v=0;function b(){return 2===v}let S=!1;function k(...Ie){S||(S=!0,e.apply(null,Ie))}function F(Ie){s=setTimeout(()=>{s=null,t(Q,b())},Ie)}function H(){c&&clearTimeout(c)}function Q(Ie,...Be){if(S)return void H();if(Ie)return H(),void k.call(null,Ie,...Be);if(b()||f)return H(),void k.call(null,Ie,...Be);let tt;r<64&&(r*=2),1===v?(v=2,tt=0):tt=1e3*(r+Math.random()),F(tt)}let de=!1;function be(Ie){de||(de=!0,H(),!S&&(null!==s?(Ie||(v=2),clearTimeout(s),F(0)):Ie||(v=1)))}return F(0),c=setTimeout(()=>{f=!0,be(!0)},n),be}((r,s)=>{if(s)return void r(!1,new Up(!1,null,!0));const c=this.connectionFactory_();this.pendingConnection_=c;const f=v=>{null!==this.progressCallback_&&this.progressCallback_(v.loaded,v.lengthComputable?v.total:-1)};null!==this.progressCallback_&&c.addUploadProgressListener(f),c.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&c.removeUploadProgressListener(f),this.pendingConnection_=null;const v=c.getErrorCode()===GT.NO_ERROR,b=c.getStatus();if(!v||function FK(t,e){const n=t>=500&&t<600,s=-1!==[408,429].indexOf(t),c=-1!==e.indexOf(t);return n||s||c}(b,this.additionalRetryCodes_)&&this.retry){const k=c.getErrorCode()===GT.ABORT;return void r(!1,new Up(!1,null,k))}const S=-1!==this.successCodes_.indexOf(b);r(!0,new Up(S,c))})},n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function OK(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class Up{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function jK(...t){const e=function zK(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}if(e6())return new Blob(t);throw new qs(Fs.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Lh={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class EL{constructor(e,n){this.data=e,this.contentType=n||null}}function WT(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function xL(t,e){switch(t){case Lh.BASE64:{const s=-1!==e.indexOf("-"),c=-1!==e.indexOf("_");if(s||c)throw HT(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Lh.BASE64URL:{const s=-1!==e.indexOf("+"),c=-1!==e.indexOf("/");if(s||c)throw HT(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=function eP(t){if(typeof atob>"u")throw function RK(t){return new qs(Fs.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(t)}(e)}catch(s){throw s.message.includes("polyfill")?s:HT(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class TL{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(null===n)throw HT(Lh.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;null!=r&&(this.base64=function y(t,e){return t.length>=e.length&&t.substring(t.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class E{constructor(e,n){let r=0,s="";J5(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(J5(this.data_)){const s=function r6(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===s?null:new E(s)}{const r=new Uint8Array(this.data_.buffer,e,n-e);return new E(r,!0)}}static getBlob(...e){if(e6()){const n=e.map(r=>r instanceof E?r.data_:r);return new E(jK.apply(null,n))}{const n=e.map(f=>Xw(f)?function tP(t,e){switch(t){case Lh.RAW:return new EL(WT(e));case Lh.BASE64:case Lh.BASE64URL:return new EL(xL(t,e));case Lh.DATA_URL:return new EL(function m(t){const e=new TL(t);return e.base64?xL(Lh.BASE64,e.rest):function i6(t){let e;try{e=decodeURIComponent(t)}catch{throw HT(Lh.DATA_URL,"Malformed data URL.")}return WT(e)}(e.rest)}(e),function p(t){return new TL(t).contentType}(e))}throw XD()}(Lh.RAW,f).data:f.data_);let r=0;n.forEach(f=>{r+=f.byteLength});const s=new Uint8Array(r);let c=0;return n.forEach(f=>{for(let v=0;v<f.length;v++)s[c++]=f[v]}),new E(s,!0)}}uploadData(){return this.data_}}function L(t){const e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function V(t,e){return e}class q{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||V}}let $=null;function ve(t,e,n){const r=function I(t){let e;try{e=JSON.parse(t)}catch{return null}return function NK(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}(e);return null===r?null:function fe(t,e,n){const r={type:"file"},s=n.length;for(let c=0;c<s;c++){const f=n[c];r[f.local]=f.xform(r,e[f.server])}return function pe(t,e){Object.defineProperty(t,"ref",{get:function n(){const c=new Lc(t.bucket,t.fullPath);return e._makeStorageReference(c)}})}(r,t),r}(t,r,n)}class gt{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function vn(t,e){return function n(r,s){const c=ve(t,s,e);return function Vt(t){if(!t)throw XD()}(null!==c),c}}function Vi(t,e,n,r,s){const c=e.bucketOnlyServerUrl(),f={"X-Goog-Upload-Protocol":"multipart"},b=function v(){let tt="";for(let mt=0;mt<2;mt++)tt+=Math.random().toString().slice(2);return tt}();f["Content-Type"]="multipart/related; boundary="+b;const S=function Cr(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function Jr(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}(e,r,s),k=function _e(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const c=e[s];c.writable&&(n[c.server]=t[c.local])}return JSON.stringify(n)}(S,n),Q=E.getBlob("--"+b+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+k+"\r\n--"+b+"\r\nContent-Type: "+S.contentType+"\r\n\r\n",r,"\r\n--"+b+"--");if(null===Q)throw function Q5(){return new qs(Fs.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}();const de={name:S.fullPath},be=function $g(t,e,n){let r=e;return null==n&&(r=`https://${e}`),`${n}://${r}/v0${t}`}(c,t.host,t._protocol),Be=t.maxUploadRetryTime,Fe=new gt(be,"POST",vn(t,n),Be);return Fe.urlParams=de,Fe.headers=f,Fe.body=Q.uploadData(),Fe.errorHandler=function an(t){return function e(n,r){let s;return s=401===n.getStatus()?n.getErrorText().includes("Firebase App Check token is invalid")?function cne(){return new qs(Fs.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function vL(){return new qs(Fs.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===n.getStatus()?function lne(t){return new qs(Fs.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(t.bucket):403===n.getStatus()?function AK(t){return new qs(Fs.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}(t.path):r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}}(e),Fe}let zp=null;class hc{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=GT.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=GT.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=GT.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Ad("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),void 0!==s)for(const c in s)s.hasOwnProperty(c)&&this.xhr_.setRequestHeader(c,s[c].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ad("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ad("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ad("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ad("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Dd extends hc{initXhr(){this.xhr_.responseType="text"}}function Vh(){return zp?zp():new Dd}class hi{constructor(e,n){this._service=e,this._location=n instanceof Lc?n:Lc.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new hi(e,n)}get root(){const e=new Lc(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return L(this._location.path)}get storage(){return this._service}get parent(){const e=function R(t){if(0===t.length)return null;const e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;const n=new Lc(this._location.bucket,e);return new hi(this._service,n)}_throwIfRoot(e){if(""===this._location.path)throw function hne(t){return new qs(Fs.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Vs(t,e,n){t._throwIfRoot("uploadBytes");const r=Vi(t.storage,t._location,function ae(){if($)return $;const t=[];t.push(new q("bucket")),t.push(new q("generation")),t.push(new q("metageneration")),t.push(new q("name","fullPath",!0));const n=new q("name");n.xform=function e(c,f){return function Y(t){return!Xw(t)||t.length<2?t:L(t)}(f)},t.push(n);const s=new q("size");return s.xform=function r(c,f){return void 0!==f?Number(f):f},t.push(s),t.push(new q("timeCreated")),t.push(new q("updated")),t.push(new q("md5Hash",null,!0)),t.push(new q("cacheControl",null,!0)),t.push(new q("contentDisposition",null,!0)),t.push(new q("contentEncoding",null,!0)),t.push(new q("contentLanguage",null,!0)),t.push(new q("contentType",null,!0)),t.push(new q("metadata","customMetadata",!0)),$=t,$}(),new E(e,!0),n);return t.storage.makeRequestWithTokens(r,Vh).then(s=>({metadata:s,ref:t}))}function rP(t,e){if(t instanceof ZT){const n=t;if(null==n._bucket)throw function une(){return new qs(Fs.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Hg+"' property when initializing the app?")}();const r=new hi(n,n._bucket);return null!=e?rP(r,e):r}return void 0!==e?function jp(t,e){const n=function O(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new Lc(t._location.bucket,n);return new hi(t.storage,r)}(t,e):t}function iP(t,e){const n=e?.[Hg];return null==n?null:Lc.makeFromBucketSpec(n,t)}class ZT{constructor(e,n,r,s,c){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=c,this._bucket=null,this._host=_L,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=s?Lc.makeFromBucketSpec(s,this._host):iP(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?Lc.makeFromBucketSpec(this._url,e):iP(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){qT("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){qT("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return Ze(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const n=e._authProvider.getImmediate({optional:!0});if(n){const r=yield n.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return Ze(function*(){const n=e._appCheckProvider.getImmediate({optional:!0});return n?(yield n.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new hi(this,e)}_makeRequest(e,n,r,s,c=!0){if(this._deleted)return new MK(X5());{const f=function UK(t,e,n,r,s,c,f=!0){const v=function LK(t){const e=encodeURIComponent;let n="?";for(const r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n=n.slice(0,-1),n}(t.urlParams),b=t.url+v,S=Object.assign({},t.headers);return function BK(t,e){e&&(t["X-Firebase-GMPID"]=e)}(S,e),function t6(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(S,n),function VK(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(S,c),function n6(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(S,r),new KT(b,t.method,S,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,f)}(e,this._appId,r,s,n,this._firebaseVersion,c);return this._requests.add(f),f.getPromise().then(()=>this._requests.delete(f),()=>this._requests.delete(f)),f}}makeRequestWithTokens(e,n){var r=this;return Ze(function*(){const[s,c]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,n,s,c).getPromise()})()}}const Q_="@firebase/storage",Jw="storage";function l6(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new ZT(n,r,s,e,vi)}!function c6(){Dt(new Tp(Jw,l6,"PUBLIC").setMultipleInstances(!0)),Ue(Q_,"0.12.1",""),Ue(Q_,"0.12.1","esm2017")}();var wn,qK=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$a={},eb=eb||{},ei=qK||self;function eh(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function lP(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var JT="closure_uid_"+(1e9*Math.random()>>>0),Npe=0;function Lpe(t,e,n){return t.call.apply(t.bind,arguments)}function Fpe(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function th(t,e,n){return(th=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Lpe:Fpe).apply(null,arguments)}function KK(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Vc(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,s,c){for(var f=Array(arguments.length-2),v=2;v<arguments.length;v++)f[v-2]=arguments[v];return e.prototype[s].apply(r,f)}}function eC(){this.s=this.s,this.o=this.o}eC.prototype.s=!1,eC.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function GK(t){Object.prototype.hasOwnProperty.call(t,JT)&&t[JT]||(t[JT]=++Npe)}(this)},eC.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const ele=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function gne(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function tle(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(eh(r)){const s=t.length||0,c=r.length||0;t.length=s+c;for(let f=0;f<c;f++)t[s+f]=r[f]}else t.push(r)}}function nh(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}nh.prototype.h=function(){this.defaultPrevented=!0};var Bpe=function(){if(!ei.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const n=()=>{};ei.addEventListener("test",n,e),ei.removeEventListener("test",n,e)}catch{}return t}();function u6(t){return/^[\s\xa0]*$/.test(t)}function WK(){var t=ei.navigator;return t&&(t=t.userAgent)?t:""}function J_(t){return-1!=WK().indexOf(t)}function yne(t){return yne[" "](t),t}yne[" "]=function(){};var vne,t,zpe=J_("Opera"),IL=J_("Trident")||J_("MSIE"),nle=J_("Edge"),_ne=nle||IL,rle=J_("Gecko")&&!(-1!=WK().toLowerCase().indexOf("webkit")&&!J_("Edge"))&&!(J_("Trident")||J_("MSIE"))&&!J_("Edge"),jpe=-1!=WK().toLowerCase().indexOf("webkit")&&!J_("Edge");function ile(){var t=ei.document;return t?t.documentMode:void 0}e:{var wne="",bne=(t=WK(),rle?/rv:([^\);]+)(\)|;)/.exec(t):nle?/Edge\/([\d\.]+)/.exec(t):IL?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):jpe?/WebKit\/(\S+)/.exec(t):zpe?/(?:Version)[ \/]?(\S+)/.exec(t):void 0);if(bne&&(wne=bne?bne[1]:""),IL){var Ene=ile();if(null!=Ene&&Ene>parseFloat(wne)){vne=String(Ene);break e}}vne=wne}var Hpe=ei.document&&IL&&(ile()||parseInt(vne,10))||void 0;function h6(t,e){if(nh.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(rle){e:{try{yne(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:$pe[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&h6.$.h.call(this)}}Vc(h6,nh);var $pe={2:"touch",3:"pen",4:"mouse"};h6.prototype.h=function(){h6.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var d6="closure_listenable_"+(1e6*Math.random()|0),qpe=0;function Gpe(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=s,this.key=++qpe,this.fa=this.ia=!1}function YK(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Tne(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function sle(t){const e={};for(const n in t)e[n]=t[n];return e}const ale="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function lle(t,e){let n,r;for(let s=1;s<arguments.length;s++){for(n in r=arguments[s],r)t[n]=r[n];for(let c=0;c<ale.length;c++)n=ale[c],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ZK(t){this.src=t,this.g={},this.h=0}function Cne(t,e){var n=e.type;if(n in t.g){var c,r=t.g[n],s=ele(r,e);(c=0<=s)&&Array.prototype.splice.call(r,s,1),c&&(YK(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Ine(t,e,n,r){for(var s=0;s<t.length;++s){var c=t[s];if(!c.fa&&c.listener==e&&c.capture==!!n&&c.la==r)return s}return-1}ZK.prototype.add=function(t,e,n,r,s){var c=t.toString();(t=this.g[c])||(t=this.g[c]=[],this.h++);var f=Ine(t,e,r,s);return-1<f?(e=t[f],n||(e.ia=!1)):((e=new Gpe(e,this.src,c,!!r,s)).ia=n,t.push(e)),e};var Sne="closure_lm_"+(1e6*Math.random()|0),Ane={};function cle(t,e,n,r,s){if(r&&r.once)return hle(t,e,n,r,s);if(Array.isArray(e)){for(var c=0;c<e.length;c++)cle(t,e[c],n,r,s);return null}return n=Mne(n),t&&t[d6]?t.O(e,n,lP(r)?!!r.capture:!!r,s):ule(t,e,n,!1,r,s)}function ule(t,e,n,r,s,c){if(!e)throw Error("Invalid event type");var f=lP(s)?!!s.capture:!!s,v=Pne(t);if(v||(t[Sne]=v=new ZK(t)),(n=v.add(e,n,r,f,c)).proxy)return n;if(r=function Wpe(){const e=Ype;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Bpe||(s=f),void 0===s&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(ple(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function hle(t,e,n,r,s){if(Array.isArray(e)){for(var c=0;c<e.length;c++)hle(t,e[c],n,r,s);return null}return n=Mne(n),t&&t[d6]?t.P(e,n,lP(r)?!!r.capture:!!r,s):ule(t,e,n,!0,r,s)}function dle(t,e,n,r,s){if(Array.isArray(e))for(var c=0;c<e.length;c++)dle(t,e[c],n,r,s);else r=lP(r)?!!r.capture:!!r,n=Mne(n),t&&t[d6]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Ine(c=t.g[e],n,r,s))&&(YK(c[n]),Array.prototype.splice.call(c,n,1),0==c.length&&(delete t.g[e],t.h--))):t&&(t=Pne(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ine(e,n,r,s)),(n=-1<t?e[t]:null)&&Dne(n))}function Dne(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[d6])Cne(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ple(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Pne(e))?(Cne(n,t),0==n.h&&(n.src=null,e[Sne]=null)):YK(t)}}}function ple(t){return t in Ane?Ane[t]:Ane[t]="on"+t}function Ype(t,e){if(t.fa)t=!0;else{e=new h6(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Dne(t),t=n.call(r,e)}return t}function Pne(t){return(t=t[Sne])instanceof ZK?t:null}var Rne="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mne(t){return"function"==typeof t?t:(t[Rne]||(t[Rne]=function(e){return t.handleEvent(e)}),t[Rne])}function Bc(){eC.call(this),this.i=new ZK(this),this.S=this,this.J=null}function fu(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,"string"==typeof e)e=new nh(e,t);else if(e instanceof nh)e.target=e.target||t;else{var s=e;lle(e=new nh(r,t),s)}if(s=!0,n)for(var c=n.length-1;0<=c;c--){var f=e.g=n[c];s=QK(f,r,!0,e)&&s}if(s=QK(f=e.g=t,r,!0,e)&&s,s=QK(f,r,!1,e)&&s,n)for(c=0;c<n.length;c++)s=QK(f=e.g=n[c],r,!1,e)&&s}function QK(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,c=0;c<e.length;++c){var f=e[c];if(f&&!f.fa&&f.capture==n){var v=f.listener,b=f.la||f.src;f.ia&&Cne(t.i,f),s=!1!==v.call(b,r)&&s}}return s&&!r.defaultPrevented}Vc(Bc,eC),Bc.prototype[d6]=!0,Bc.prototype.removeEventListener=function(t,e,n,r){dle(this,t,e,n,r)},Bc.prototype.N=function(){if(Bc.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)YK(n[r]);delete t.g[e],t.h--}}this.J=null},Bc.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Bc.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var kne=ei.JSON.stringify;function Qpe(){var t=One;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var fle=new class Zpe{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new Jpe,t=>t.reset());class Jpe{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function efe(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function tfe(t){ei.setTimeout(()=>{throw t},0)}let p6,f6=!1,One=new class Xpe{constructor(){this.h=this.g=null}add(e,n){const r=fle.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},mle=()=>{const t=ei.Promise.resolve(void 0);p6=()=>{t.then(nfe)}};var nfe=()=>{for(var t;t=Qpe();){try{t.h.call(t.g)}catch(n){tfe(n)}var e=fle;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}f6=!1};function XK(t,e){Bc.call(this),this.h=t||1,this.g=e||ei,this.j=th(this.qb,this),this.l=Date.now()}function Nne(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function Lne(t,e,n){if("function"==typeof t)n&&(t=th(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=th(t.handleEvent,t)}return 2147483647<Number(e)?-1:ei.setTimeout(t,e||0)}function gle(t){t.g=Lne(()=>{t.g=null,t.i&&(t.i=!1,gle(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Vc(XK,Bc),(wn=XK.prototype).ga=!1,wn.T=null,wn.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),fu(this,"tick"),this.ga&&(Nne(this),this.start()))}},wn.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},wn.N=function(){XK.$.N.call(this),Nne(this),delete this.g};class rfe extends eC{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:gle(this)}N(){super.N(),this.g&&(ei.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function m6(t){eC.call(this),this.h=t,this.g={}}Vc(m6,eC);var yle=[];function _le(t,e,n,r){Array.isArray(n)||(n&&(yle[0]=n.toString()),n=yle);for(var s=0;s<n.length;s++){var c=cle(e,n[s],r||t.handleEvent,!1,t.h||t);if(!c)break;t.g[c.key]=c}}function vle(t){Tne(t.g,function(e,n){this.g.hasOwnProperty(n)&&Dne(e)},t),t.g={}}function JK(){this.g=!0}function SL(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function afe(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var c=s[0];if("noop"!=c&&"stop"!=c&&"close"!=c)for(var f=1;f<s.length;f++)s[f]=""}}}return kne(n)}catch{return e}}(t,n)+(r?" "+r:"")})}m6.prototype.N=function(){m6.$.N.call(this),vle(this)},m6.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},JK.prototype.Ea=function(){this.g=!1},JK.prototype.info=function(){};var cP={},wle=null;function eW(){return wle=wle||new Bc}function ble(t){nh.call(this,cP.Ta,t)}function g6(t){const e=eW();fu(e,new ble(e))}function Ele(t,e){nh.call(this,cP.STAT_EVENT,t),this.stat=e}function Uh(t){const e=eW();fu(e,new Ele(e,t))}function xle(t,e){nh.call(this,cP.Ua,t),this.size=e}function y6(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return ei.setTimeout(function(){t()},e)}cP.Ta="serverreachability",Vc(ble,nh),cP.STAT_EVENT="statevent",Vc(Ele,nh),cP.Ua="timingevent",Vc(xle,nh);var tW={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Tle={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Fne(){}function Ile(){}Fne.prototype.h=null;var Une,_6={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Vne(){nh.call(this,"d")}function Bne(){nh.call(this,"c")}function nW(){}function v6(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new m6(this),this.P=lfe,this.V=new XK(t=_ne?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Sle}function Sle(){this.i=null,this.g="",this.h=!1}Vc(Vne,nh),Vc(Bne,nh),Vc(nW,Fne),nW.prototype.g=function(){return new XMLHttpRequest},nW.prototype.i=function(){return{}},Une=new nW;var lfe=45e3,Ale={},zne={};function jne(t,e,n){t.L=1,t.A=sW(tb(e)),t.u=n,t.S=!0,Dle(t,null)}function Dle(t,e){t.G=Date.now(),w6(t),t.B=tb(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),Ble(n.i,"t",r),t.o=0,n=t.l.J,t.h=new Sle,t.g=cce(t.l,n?e:null,!t.u),0<t.O&&(t.M=new rfe(th(t.Pa,t,t.g),t.O)),_le(t.U,t.g,"readystatechange",t.nb),e=t.I?sle(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),g6(),function ife(t,e,n,r,s,c){t.info(function(){if(t.g)if(c)for(var f="",v=c.split("&"),b=0;b<v.length;b++){var S=v[b].split("=");if(1<S.length){var k=S[0];S=S[1];var F=k.split("_");f=2<=F.length&&"type"==F[1]?f+(k+"=")+S+"&":f+(k+"=redacted&")}}else f=null;else f=c;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+"\n"+n+"\n"+f})}(t.j,t.v,t.B,t.m,t.W,t.u)}function Ple(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function Rle(t,e,n){let s,r=!0;for(;!t.J&&t.o<n.length;){if(s=cfe(t,n),s==zne){4==e&&(t.s=4,Uh(14),r=!1),SL(t.j,t.m,null,"[Incomplete Response]");break}if(s==Ale){t.s=4,Uh(15),SL(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}SL(t.j,t.m,s,null),Hne(t,s)}Ple(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,Uh(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zne(e),e.M=!0,Uh(11))):(SL(t.j,t.m,n,"[Invalid Chunked Response]"),uP(t),b6(t))}function cfe(t,e){var n=t.o,r=e.indexOf("\n",n);return-1==r?zne:(n=Number(e.substring(n,r)),isNaN(n)?Ale:(r+=1)+n>e.length?zne:(e=e.slice(r,r+n),t.o=r+n,e))}function w6(t){t.Y=Date.now()+t.P,Mle(t,t.P)}function Mle(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=y6(th(t.lb,t),e)}function rW(t){t.C&&(ei.clearTimeout(t.C),t.C=null)}function b6(t){0==t.l.H||t.J||oce(t.l,t)}function uP(t){rW(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,Nne(t.V),vle(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Hne(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||$ne(n.i,t)))if(!t.K&&$ne(n.i,t)&&3==n.H){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break e;dW(n),uW(n)}Yne(n),Uh(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&0==n.A&&!n.v&&(n.v=y6(th(n.ib,n),6e3));if(1>=jle(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else dP(n,11)}else if((t.K||n.g==t)&&dW(n),!u6(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let S=s[e];if(n.V=S[0],S=S[1],2==n.H)if("c"==S[0]){n.K=S[1],n.pa=S[2];const k=S[3];null!=k&&(n.ra=k,n.l.info("VER="+n.ra));const F=S[4];null!=F&&(n.Ga=F,n.l.info("SVER="+n.Ga));const H=S[5];null!=H&&"number"==typeof H&&0<H&&(n.L=r=1.5*H,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const Q=t.g;if(Q){const de=Q.g?Q.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(de){var c=r.i;c.g||-1==de.indexOf("spdy")&&-1==de.indexOf("quic")&&-1==de.indexOf("h2")||(c.j=c.l,c.g=new Set,c.h&&(qne(c,c.h),c.h=null))}if(r.F){const be=Q.g?Q.g.getResponseHeader("X-HTTP-Session-Id"):null;be&&(r.Da=be,oa(r.I,r.F,be))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var f=t;if((r=n).wa=lce(r,r.J?r.pa:null,r.Y),f.K){Hle(r.i,f);var v=f,b=r.L;b&&v.setTimeout(b),v.C&&(rW(v),w6(v)),r.g=f}else rce(r);0<n.j.length&&hW(n)}else"stop"!=S[0]&&"close"!=S[0]||dP(n,7);else 3==n.H&&("stop"==S[0]||"close"==S[0]?"stop"==S[0]?dP(n,7):Wne(n):"noop"!=S[0]&&n.h&&n.h.Aa(S),n.A=0)}g6()}catch{}}function kle(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(eh(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function hfe(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(eh(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function ufe(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(eh(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),s=r.length,c=0;c<s;c++)e.call(void 0,r[c],n&&n[c],t)}(wn=v6.prototype).setTimeout=function(t){this.P=t},wn.nb=function(t){t=t.target;const e=this.M;e&&3==ev(t)?e.l():this.Pa(t)},wn.Pa=function(t){try{if(t==this.g)e:{const k=ev(this.g);var e=this.g.Ia();if(this.g.da(),!(3>k)&&(3!=k||_ne||this.g&&(this.h.h||this.g.ja()||Qle(this.g)))){this.J||4!=k||7==e||g6(),rW(this);var n=this.g.da();this.ca=n;t:if(Ple(this)){var r=Qle(this.g);t="";var s=r.length,c=4==ev(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){uP(this),b6(this);var f="";break t}this.h.i=new ei.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:c&&e==s-1});r.length=0,this.h.g+=t,this.o=0,f=this.h.g}else f=this.g.ja();if(this.i=200==n,function ofe(t,e,n,r,s,c,f){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+"\n"+n+"\n"+c+" "+f})}(this.j,this.v,this.B,this.m,this.W,k,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var v,b=this.g;if((v=b.g?b.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!u6(v)){var S=v;break t}}S=null}if(!(n=S)){this.i=!1,this.s=3,Uh(12),uP(this),b6(this);break e}SL(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hne(this,n)}this.S?(Rle(this,k,f),_ne&&this.i&&3==k&&(_le(this.U,this.V,"tick",this.mb),this.V.start())):(SL(this.j,this.m,f,null),Hne(this,f)),4==k&&uP(this),this.i&&!this.J&&(4==k?oce(this.l,this):(this.i=!1,w6(this)))}else(function Dfe(t){const e={};t=(t.g&&2<=ev(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(u6(t[r]))continue;var n=efe(t[r]);const s=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const c=e[s]||[];e[s]=c,c.push(n)}!function Kpe(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,function(r){return r.join(", ")})})(this.g),400==n&&0<f.indexOf("Unknown SID")?(this.s=3,Uh(12)):(this.s=0,Uh(13)),uP(this),b6(this)}}}catch{}},wn.mb=function(){if(this.g){var t=ev(this.g),e=this.g.ja();this.o<e.length&&(rW(this),Rle(this,t,e),this.i&&4!=t&&w6(this))}},wn.cancel=function(){this.J=!0,uP(this)},wn.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function sfe(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.j,this.B),2!=this.L&&(g6(),Uh(17)),uP(this),this.s=2,b6(this)):Mle(this,this.Y-t)};var Ole=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hP(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof hP){this.h=t.h,iW(this,t.j),this.s=t.s,this.g=t.g,oW(this,t.m),this.l=t.l;var e=t.i,n=new T6;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Nle(this,n),this.o=t.o}else t&&(e=String(t).match(Ole))?(this.h=!1,iW(this,e[1]||"",!0),this.s=E6(e[2]||""),this.g=E6(e[3]||"",!0),oW(this,e[4]),this.l=E6(e[5]||"",!0),Nle(this,e[6]||"",!0),this.o=E6(e[7]||"")):(this.h=!1,this.i=new T6(null,this.h))}function tb(t){return new hP(t)}function iW(t,e,n){t.j=n?E6(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function oW(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Nle(t,e,n){e instanceof T6?(t.i=e,function _fe(t,e){e&&!t.j&&(tC(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(Fle(this,r),Ble(this,s,n))},t)),t.j=e}(t.i,t.h)):(n||(e=x6(e,gfe)),t.i=new T6(e,t.h))}function oa(t,e,n){t.i.set(e,n)}function sW(t){return oa(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function E6(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function x6(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,pfe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function pfe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}hP.prototype.toString=function(){var t=[],e=this.j;e&&t.push(x6(e,Lle,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(x6(e,Lle,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(x6(n,"/"==n.charAt(0)?mfe:ffe,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",x6(n,yfe)),t.join("")};var Lle=/[#\/\?@]/g,ffe=/[#\?:]/g,mfe=/[#\?]/g,gfe=/[#\?@]/g,yfe=/#/g;function T6(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function tC(t){t.g||(t.g=new Map,t.h=0,t.i&&function dfe(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var c=t[n].substring(0,r);s=t[n].substring(r+1)}else c=t[n];e(c,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Fle(t,e){tC(t),e=AL(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Vle(t,e){return tC(t),e=AL(t,e),t.g.has(e)}function Ble(t,e,n){Fle(t,e),0<n.length&&(t.i=null,t.g.set(AL(t,e),gne(n)),t.h+=n.length)}function AL(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Ule(t){this.l=t||wfe,t=ei.PerformanceNavigationTiming?0<(t=ei.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(ei.g&&ei.g.Ka&&ei.g.Ka()&&ei.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(wn=T6.prototype).add=function(t,e){tC(this),this.i=null,t=AL(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},wn.forEach=function(t,e){tC(this),this.g.forEach(function(n,r){n.forEach(function(s){t.call(e,s,r,this)},this)},this)},wn.ta=function(){tC(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let c=0;c<s.length;c++)n.push(e[r])}return n},wn.Z=function(t){tC(this);let e=[];if("string"==typeof t)Vle(this,t)&&(e=e.concat(this.g.get(AL(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},wn.set=function(t,e){return tC(this),this.i=null,Vle(this,t=AL(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},wn.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},wn.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const c=encodeURIComponent(String(r)),f=this.Z(r);for(r=0;r<f.length;r++){var s=c;""!==f[r]&&(s+="="+encodeURIComponent(String(f[r]))),t.push(s)}}return this.i=t.join("&")};var wfe=10;function zle(t){return!!t.h||!!t.g&&t.g.size>=t.j}function jle(t){return t.h?1:t.g?t.g.size:0}function $ne(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function qne(t,e){t.g?t.g.add(e):t.h=e}function Hle(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function $le(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return gne(t.i)}Ule.prototype.cancel=function(){if(this.i=$le(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var bfe=class{stringify(t){return ei.JSON.stringify(t,void 0)}parse(t){return ei.JSON.parse(t,void 0)}};function Efe(){this.g=new bfe}function xfe(t,e,n){const r=n||"";try{kle(t,function(s,c){let f=s;lP(s)&&(f=kne(s)),e.push(r+c+"="+encodeURIComponent(f))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function aW(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function C6(t){this.l=t.ec||null,this.j=t.ob||!1}function lW(t,e){Bc.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Gne,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Vc(C6,Fne),C6.prototype.g=function(){return new lW(this.l,this.j)},C6.prototype.i=function(t){return function(){return t}}({}),Vc(lW,Bc);var Gne=0;function qle(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function I6(t){t.readyState=4,t.l=null,t.j=null,t.A=null,S6(t)}function S6(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(wn=lW.prototype).open=function(t,e){if(this.readyState!=Gne)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,S6(this)},wn.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||ei).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},wn.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,I6(this)),this.readyState=Gne},wn.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,S6(this)),this.g&&(this.readyState=3,S6(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof ei.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;qle(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},wn.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?I6(this):S6(this),3==this.readyState&&qle(this)}},wn.Za=function(t){this.g&&(this.response=this.responseText=t,I6(this))},wn.Ya=function(t){this.g&&(this.response=t,I6(this))},wn.ka=function(){this.g&&I6(this)},wn.setRequestHeader=function(t,e){this.v.append(t,e)},wn.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},wn.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)t.push((n=n.value)[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(lW.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Cfe=ei.JSON.parse;function qa(t){Bc.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Gle,this.L=this.M=!1}Vc(qa,Bc);var Gle="",Ife=/^https?$/i,Sfe=["POST","PUT"];function Kle(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Wle(t),cW(t)}function Wle(t){t.F||(t.F=!0,fu(t,"complete"),fu(t,"error"))}function Yle(t){if(t.h&&typeof eb<"u"&&(!t.C[1]||4!=ev(t)||2!=t.da()))if(t.v&&4==ev(t))Lne(t.La,0,t);else if(fu(t,"readystatechange"),4==ev(t)){t.h=!1;try{const f=t.da();e:switch(f){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=0===f){var s=String(t.I).match(Ole)[1]||null;!s&&ei.self&&ei.self.location&&(s=ei.self.location.protocol.slice(0,-1)),r=!Ife.test(s?s.toLowerCase():"")}n=r}if(n)fu(t,"complete"),fu(t,"success");else{t.m=6;try{var c=2<ev(t)?t.g.statusText:""}catch{c=""}t.j=c+" ["+t.da()+"]",Wle(t)}}finally{cW(t)}}}function cW(t,e){if(t.g){Zle(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||fu(t,"ready");try{n.onreadystatechange=r}catch{}}}function Zle(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(ei.clearTimeout(t.A),t.A=null)}function ev(t){return t.g?t.g.readyState:0}function Qle(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Gle:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function Xle(t){let e="";return Tne(t,function(n,r){e+=r,e+=":",e+=n,e+="\r\n"}),e}function Kne(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Xle(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):oa(t,e,n))}function A6(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Jle(t){this.Ga=0,this.j=[],this.l=new JK,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=A6("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=A6("baseRetryDelayMs",5e3,t),this.hb=A6("retryDelaySeedMs",1e4,t),this.eb=A6("forwardChannelMaxRetries",2,t),this.xa=A6("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new Ule(t&&t.concurrentRequestLimit),this.Ja=new Efe,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Wne(t){if(ece(t),3==t.H){var e=t.W++,n=tb(t.I);if(oa(n,"SID",t.K),oa(n,"RID",e),oa(n,"TYPE","terminate"),D6(t,n),(e=new v6(t,t.l,e)).L=2,e.A=sW(tb(n)),n=!1,ei.navigator&&ei.navigator.sendBeacon)try{n=ei.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&ei.Image&&((new Image).src=e.A,n=!0),n||(e.g=cce(e.l,null),e.g.ha(e.A)),e.G=Date.now(),w6(e)}ace(t)}function uW(t){t.g&&(Zne(t),t.g.cancel(),t.g=null)}function ece(t){uW(t),t.u&&(ei.clearTimeout(t.u),t.u=null),dW(t),t.i.cancel(),t.m&&("number"==typeof t.m&&ei.clearTimeout(t.m),t.m=null)}function hW(t){if(!zle(t.i)&&!t.m){t.m=!0;var e=t.Na;p6||mle(),f6||(p6(),f6=!0),One.add(e,t),t.C=0}}function tce(t,e){var n;n=e?e.m:t.W++;const r=tb(t.I);oa(r,"SID",t.K),oa(r,"RID",n),oa(r,"AID",t.V),D6(t,r),t.o&&t.s&&Kne(r,t.o,t.s),n=new v6(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=nce(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),qne(t.i,n),jne(n,r,e)}function D6(t,e){t.na&&Tne(t.na,function(n,r){oa(e,r,n)}),t.h&&kle({},function(n,r){oa(e,r,n)})}function nce(t,e,n){n=Math.min(t.j.length,n);var r=t.h?th(t.h.Va,t.h,t):null;e:{var s=t.j;let c=-1;for(;;){const f=["count="+n];-1==c?0<n?(c=s[0].g,f.push("ofs="+c)):c=0:f.push("ofs="+c);let v=!0;for(let b=0;b<n;b++){let S=s[b].g;const k=s[b].map;if(S-=c,0>S)c=Math.max(0,s[b].g-100),v=!1;else try{xfe(k,f,"req"+S+"_")}catch{r&&r(k)}}if(v){r=f.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function rce(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;p6||mle(),f6||(p6(),f6=!0),One.add(e,t),t.A=0}}function Yne(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=y6(th(t.Ma,t),sce(t,t.A)),t.A++,0))}function Zne(t){null!=t.B&&(ei.clearTimeout(t.B),t.B=null)}function ice(t){t.g=new v6(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=tb(t.wa);oa(e,"RID","rpc"),oa(e,"SID",t.K),oa(e,"AID",t.V),oa(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&oa(e,"TO",t.qa),oa(e,"TYPE","xmlhttp"),D6(t,e),t.o&&t.s&&Kne(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=sW(tb(e)),n.u=null,n.S=!0,Dle(n,t)}function dW(t){null!=t.v&&(ei.clearTimeout(t.v),t.v=null)}function oce(t,e){var n=null;if(t.g==e){dW(t),Zne(t),t.g=null;var r=2}else{if(!$ne(t.i,e))return;n=e.F,Hle(t.i,e),r=1}if(0!=t.H)if(e.i)if(1==r){n=e.u?e.u.length:0,e=Date.now()-e.G;var s=t.C;fu(r=eW(),new xle(r,n)),hW(t)}else rce(t);else if(3==(s=e.s)||0==s&&0<e.ca||!(1==r&&function Pfe(t,e){return!(jle(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=y6(th(t.Na,t,e),sce(t,t.C)),t.C++,0)))}(t,e)||2==r&&Yne(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:dP(t,5);break;case 4:dP(t,10);break;case 3:dP(t,6);break;default:dP(t,2)}}function sce(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function dP(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var r=th(t.pb,t);n||(n=new hP("//www.google.com/images/cleardot.gif"),ei.location&&"http"==ei.location.protocol||iW(n,"https"),sW(n)),function Tfe(t,e){const n=new JK;if(ei.Image){const r=new Image;r.onload=KK(aW,n,r,"TestLoadImage: loaded",!0,e),r.onerror=KK(aW,n,r,"TestLoadImage: error",!1,e),r.onabort=KK(aW,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=KK(aW,n,r,"TestLoadImage: timeout",!1,e),ei.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Uh(2);t.H=0,t.h&&t.h.za(e),ace(t),ece(t)}function ace(t){if(t.H=0,t.ma=[],t.h){const e=$le(t.i);(0!=e.length||0!=t.j.length)&&(tle(t.ma,e),tle(t.ma,t.j),t.i.i.length=0,gne(t.j),t.j.length=0),t.h.ya()}}function lce(t,e,n){var r=n instanceof hP?tb(n):new hP(n);if(""!=r.g)e&&(r.g=e+"."+r.g),oW(r,r.m);else{var s=ei.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var c=new hP(null);r&&iW(c,r),e&&(c.g=e),s&&oW(c,s),n&&(c.l=n),r=c}return e=t.Da,(n=t.F)&&e&&oa(r,n,e),oa(r,"VER",t.ra),D6(t,r),r}function cce(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new qa(t.Ha&&!t.va?new C6({ob:n}):t.va)).Oa(t.J),e}function uce(){}function pW(){if(IL&&!(10<=Number(Hpe)))throw Error("Environmental error: no available transport.")}function Hp(t,e){Bc.call(this),this.g=new Jle(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!u6(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!u6(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new DL(this)}function hce(t){Vne.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function dce(){Bne.call(this),this.status=1}function DL(t){this.g=t}function Gg(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Qne(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var s=0;16>s;++s)r[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;var c=t.g[3],f=(e=t.g[0])+(c^(n=t.g[1])&((s=t.g[2])^c))+r[0]+3614090360&4294967295;f=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=(n=(s=(c=(e=n+(f<<7&4294967295|f>>>25))+((f=c+(s^e&(n^s))+r[1]+3905402710&4294967295)<<12&4294967295|f>>>20))+((f=s+(n^c&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|f>>>15))+((f=n+(e^s&(c^e))+r[3]+3250441966&4294967295)<<22&4294967295|f>>>10))+((f=e+(c^n&(s^c))+r[4]+4118548399&4294967295)<<7&4294967295|f>>>25))+((f=c+(s^e&(n^s))+r[5]+1200080426&4294967295)<<12&4294967295|f>>>20))+((f=s+(n^c&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|f>>>15))+((f=n+(e^s&(c^e))+r[7]+4249261313&4294967295)<<22&4294967295|f>>>10))+((f=e+(c^n&(s^c))+r[8]+1770035416&4294967295)<<7&4294967295|f>>>25))+((f=c+(s^e&(n^s))+r[9]+2336552879&4294967295)<<12&4294967295|f>>>20))+((f=s+(n^c&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|f>>>15))+((f=n+(e^s&(c^e))+r[11]+2304563134&4294967295)<<22&4294967295|f>>>10))+((f=e+(c^n&(s^c))+r[12]+1804603682&4294967295)<<7&4294967295|f>>>25))+((f=c+(s^e&(n^s))+r[13]+4254626195&4294967295)<<12&4294967295|f>>>20))+((f=s+(n^c&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|f>>>15))+((f=n+(e^s&(c^e))+r[15]+1236535329&4294967295)<<22&4294967295|f>>>10))+((f=e+(s^c&(n^s))+r[1]+4129170786&4294967295)<<5&4294967295|f>>>27))+((f=c+(n^s&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|f>>>23))+((f=s+(e^n&(c^e))+r[11]+643717713&4294967295)<<14&4294967295|f>>>18))+((f=n+(c^e&(s^c))+r[0]+3921069994&4294967295)<<20&4294967295|f>>>12))+((f=e+(s^c&(n^s))+r[5]+3593408605&4294967295)<<5&4294967295|f>>>27))+((f=c+(n^s&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|f>>>23))+((f=s+(e^n&(c^e))+r[15]+3634488961&4294967295)<<14&4294967295|f>>>18))+((f=n+(c^e&(s^c))+r[4]+3889429448&4294967295)<<20&4294967295|f>>>12))+((f=e+(s^c&(n^s))+r[9]+568446438&4294967295)<<5&4294967295|f>>>27))+((f=c+(n^s&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|f>>>23))+((f=s+(e^n&(c^e))+r[3]+4107603335&4294967295)<<14&4294967295|f>>>18))+((f=n+(c^e&(s^c))+r[8]+1163531501&4294967295)<<20&4294967295|f>>>12))+((f=e+(s^c&(n^s))+r[13]+2850285829&4294967295)<<5&4294967295|f>>>27))+((f=c+(n^s&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|f>>>23))+((f=s+(e^n&(c^e))+r[7]+1735328473&4294967295)<<14&4294967295|f>>>18))+((f=n+(c^e&(s^c))+r[12]+2368359562&4294967295)<<20&4294967295|f>>>12))+((f=e+(n^s^c)+r[5]+4294588738&4294967295)<<4&4294967295|f>>>28))+((f=c+(e^n^s)+r[8]+2272392833&4294967295)<<11&4294967295|f>>>21))+((f=s+(c^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|f>>>16))+((f=n+(s^c^e)+r[14]+4259657740&4294967295)<<23&4294967295|f>>>9))+((f=e+(n^s^c)+r[1]+2763975236&4294967295)<<4&4294967295|f>>>28))+((f=c+(e^n^s)+r[4]+1272893353&4294967295)<<11&4294967295|f>>>21))+((f=s+(c^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|f>>>16))+((f=n+(s^c^e)+r[10]+3200236656&4294967295)<<23&4294967295|f>>>9))+((f=e+(n^s^c)+r[13]+681279174&4294967295)<<4&4294967295|f>>>28))+((f=c+(e^n^s)+r[0]+3936430074&4294967295)<<11&4294967295|f>>>21))+((f=s+(c^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|f>>>16))+((f=n+(s^c^e)+r[6]+76029189&4294967295)<<23&4294967295|f>>>9))+((f=e+(n^s^c)+r[9]+3654602809&4294967295)<<4&4294967295|f>>>28))+((f=c+(e^n^s)+r[12]+3873151461&4294967295)<<11&4294967295|f>>>21))+((f=s+(c^e^n)+r[15]+530742520&4294967295)<<16&4294967295|f>>>16))+((f=n+(s^c^e)+r[2]+3299628645&4294967295)<<23&4294967295|f>>>9))+((f=e+(s^(n|~c))+r[0]+4096336452&4294967295)<<6&4294967295|f>>>26))+((f=c+(n^(e|~s))+r[7]+1126891415&4294967295)<<10&4294967295|f>>>22))+((f=s+(e^(c|~n))+r[14]+2878612391&4294967295)<<15&4294967295|f>>>17))+((f=n+(c^(s|~e))+r[5]+4237533241&4294967295)<<21&4294967295|f>>>11))+((f=e+(s^(n|~c))+r[12]+1700485571&4294967295)<<6&4294967295|f>>>26))+((f=c+(n^(e|~s))+r[3]+2399980690&4294967295)<<10&4294967295|f>>>22))+((f=s+(e^(c|~n))+r[10]+4293915773&4294967295)<<15&4294967295|f>>>17))+((f=n+(c^(s|~e))+r[1]+2240044497&4294967295)<<21&4294967295|f>>>11))+((f=e+(s^(n|~c))+r[8]+1873313359&4294967295)<<6&4294967295|f>>>26))+((f=c+(n^(e|~s))+r[15]+4264355552&4294967295)<<10&4294967295|f>>>22))+((f=s+(e^(c|~n))+r[6]+2734768916&4294967295)<<15&4294967295|f>>>17))+((f=n+(c^(s|~e))+r[13]+1309151649&4294967295)<<21&4294967295|f>>>11))+((c=(e=n+((f=e+(s^(n|~c))+r[4]+4149444226&4294967295)<<6&4294967295|f>>>26))+((f=c+(n^(e|~s))+r[11]+3174756917&4294967295)<<10&4294967295|f>>>22))^((s=c+((f=s+(e^(c|~n))+r[2]+718787259&4294967295)<<15&4294967295|f>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(f<<21&4294967295|f>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+c&4294967295}function ms(t,e){this.h=e;for(var n=[],r=!0,s=t.length-1;0<=s;s--){var c=0|t[s];r&&c==e||(n[s]=c,r=!1)}this.g=n}(wn=qa.prototype).Oa=function(t){this.M=t},wn.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Une.g(),this.C=function Cle(t){return t.h||(t.h=t.i())}(this.u?this.u:Une),this.g.onreadystatechange=th(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(c){return void Kle(this,c)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const c of r.keys())n.set(c,r.get(c))}r=Array.from(n.keys()).find(c=>"content-type"==c.toLowerCase()),s=ei.FormData&&t instanceof ei.FormData,!(0<=ele(Sfe,e))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[c,f]of n)this.g.setRequestHeader(c,f);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Zle(this),0<this.B&&((this.L=function Afe(t){return IL&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=th(this.ua,this)):this.A=Lne(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(c){Kle(this,c)}},wn.ua=function(){typeof eb<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,fu(this,"timeout"),this.abort(8))},wn.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,fu(this,"complete"),fu(this,"abort"),cW(this))},wn.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),cW(this,!0)),qa.$.N.call(this)},wn.La=function(){this.s||(this.G||this.v||this.l?Yle(this):this.kb())},wn.kb=function(){Yle(this)},wn.isActive=function(){return!!this.g},wn.da=function(){try{return 2<ev(this)?this.g.status:-1}catch{return-1}},wn.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},wn.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Cfe(e)}},wn.Ia=function(){return this.m},wn.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(wn=Jle.prototype).ra=8,wn.H=1,wn.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new v6(this,this.l,t);let c=this.s;if(this.U&&(c?(c=sle(c),lle(c,this.U)):c=this.U),null!==this.o||this.O||(s.I=c,c=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break e}if(4096===e||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=nce(this,s,e),oa(n=tb(this.I),"RID",t),oa(n,"CVER",22),this.F&&oa(n,"X-HTTP-Session-Id",this.F),D6(this,n),c&&(this.O?e="headers="+encodeURIComponent(String(Xle(c)))+"&"+e:this.o&&Kne(n,this.o,c)),qne(this.i,s),this.bb&&oa(n,"TYPE","init"),this.P?(oa(n,"$req",e),oa(n,"SID","null"),s.aa=!0,jne(s,n,null)):jne(s,n,e),this.H=2}}else 3==this.H&&(t?tce(this,t):0==this.j.length||zle(this.i)||tce(this))},wn.Ma=function(){if(this.u=null,ice(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=y6(th(this.jb,this),t)}},wn.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Uh(10),uW(this),ice(this))},wn.ib=function(){null!=this.v&&(this.v=null,uW(this),Yne(this),Uh(19))},wn.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Uh(2)):(this.l.info("Failed to ping google.com"),Uh(1))},wn.isActive=function(){return!!this.h&&this.h.isActive(this)},(wn=uce.prototype).Ba=function(){},wn.Aa=function(){},wn.za=function(){},wn.ya=function(){},wn.isActive=function(){return!0},wn.Va=function(){},pW.prototype.g=function(t,e){return new Hp(t,e)},Vc(Hp,Bc),Hp.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Uh(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=lce(t,null,t.Y),hW(t)},Hp.prototype.close=function(){Wne(this.g)},Hp.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=kne(t),t=n);e.j.push(new class{constructor(t,e){this.g=t,this.map=e}}(e.fb++,t)),3==e.H&&hW(e)},Hp.prototype.N=function(){this.g.h=null,delete this.j,Wne(this.g),delete this.g,Hp.$.N.call(this)},Vc(hce,Vne),Vc(dce,Bne),Vc(DL,uce),DL.prototype.Ba=function(){fu(this.g,"a")},DL.prototype.Aa=function(t){fu(this.g,new hce(t))},DL.prototype.za=function(t){fu(this.g,new dce)},DL.prototype.ya=function(){fu(this.g,"b")},Vc(Gg,function Rfe(){this.blockSize=-1}),Gg.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Gg.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=this.m,s=this.h,c=0;c<e;){if(0==s)for(;c<=n;)Qne(this,t,c),c+=this.blockSize;if("string"==typeof t){for(;c<e;)if(r[s++]=t.charCodeAt(c++),s==this.blockSize){Qne(this,r),s=0;break}}else for(;c<e;)if(r[s++]=t[c++],s==this.blockSize){Qne(this,r),s=0;break}}this.h=s,this.i+=e},Gg.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var Mfe={};function Xne(t){return-128<=t&&128>t?function Upe(t,e){var n=Mfe;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(e){return new ms([0|e],0>e?-1:0)}):new ms([0|t],0>t?-1:0)}function tv(t){if(isNaN(t)||!isFinite(t))return PL;if(0>t)return mu(tv(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Jne;return new ms(e,0)}var Jne=4294967296,PL=Xne(0),ere=Xne(1),fce=Xne(16777216);function nb(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function am(t){return-1==t.h}function mu(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new ms(n,~t.h).add(ere)}function fW(t,e){return t.add(mu(e))}function mW(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function P6(t,e){this.g=t,this.h=e}function gW(t,e){if(nb(e))throw Error("division by zero");if(nb(t))return new P6(PL,PL);if(am(t))return e=gW(mu(t),e),new P6(mu(e.g),mu(e.h));if(am(e))return e=gW(t,mu(e)),new P6(mu(e.g),e.h);if(30<t.g.length){if(am(t)||am(e))throw Error("slowDivide_ only works with positive integers.");for(var n=ere,r=e;0>=r.X(t);)n=mce(n),r=mce(r);var s=RL(n,1),c=RL(r,1);for(r=RL(r,2),n=RL(n,2);!nb(r);){var f=c.add(r);0>=f.X(t)&&(s=s.add(n),c=f),r=RL(r,1),n=RL(n,1)}return e=fW(t,s.R(e)),new P6(s,e)}for(s=PL;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),f=(c=tv(n)).R(e);am(f)||0<f.X(t);)f=(c=tv(n-=r)).R(e);nb(c)&&(c=ere),s=s.add(c),t=fW(t,f)}return new P6(s,t)}function mce(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new ms(n,t.h)}function RL(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,s=[],c=0;c<r;c++)s[c]=0<e?t.D(c+n)>>>e|t.D(c+n+1)<<32-e:t.D(c+n);return new ms(s,t.h)}(wn=ms.prototype).ea=function(){if(am(this))return-mu(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Jne+r)*e,e*=Jne}return t},wn.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(nb(this))return"0";if(am(this))return"-"+mu(this).toString(t);for(var e=tv(Math.pow(t,6)),n=this,r="";;){var s=gW(n,e).g,c=((0<(n=fW(n,s.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(nb(n=s))return c+r;for(;6>c.length;)c="0"+c;r=c+r}},wn.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},wn.X=function(t){return am(t=fW(this,t))?-1:nb(t)?0:1},wn.abs=function(){return am(this)?mu(this):this},wn.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,s=0;s<=e;s++){var c=r+(65535&this.D(s))+(65535&t.D(s)),f=(c>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);r=f>>>16,n[s]=(f&=65535)<<16|(c&=65535)}return new ms(n,-2147483648&n[n.length-1]?-1:0)},wn.R=function(t){if(nb(this)||nb(t))return PL;if(am(this))return am(t)?mu(this).R(mu(t)):mu(mu(this).R(t));if(am(t))return mu(this.R(mu(t)));if(0>this.X(fce)&&0>t.X(fce))return tv(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<t.g.length;s++){var c=this.D(r)>>>16,f=65535&this.D(r),v=t.D(s)>>>16,b=65535&t.D(s);n[2*r+2*s]+=f*b,mW(n,2*r+2*s),n[2*r+2*s+1]+=c*b,mW(n,2*r+2*s+1),n[2*r+2*s+1]+=f*v,mW(n,2*r+2*s+1),n[2*r+2*s+2]+=c*v,mW(n,2*r+2*s+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new ms(n,0)},wn.gb=function(t){return gW(this,t).h},wn.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new ms(n,this.h&t.h)},wn.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new ms(n,this.h|t.h)},wn.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new ms(n,this.h^t.h)},pW.prototype.createWebChannel=pW.prototype.g,Hp.prototype.send=Hp.prototype.u,Hp.prototype.open=Hp.prototype.m,Hp.prototype.close=Hp.prototype.close,tW.NO_ERROR=0,tW.TIMEOUT=8,tW.HTTP_ERROR=6,Tle.COMPLETE="complete",Ile.EventType=_6,_6.OPEN="a",_6.CLOSE="b",_6.ERROR="c",_6.MESSAGE="d",Bc.prototype.listen=Bc.prototype.O,qa.prototype.listenOnce=qa.prototype.P,qa.prototype.getLastError=qa.prototype.Sa,qa.prototype.getLastErrorCode=qa.prototype.Ia,qa.prototype.getStatus=qa.prototype.da,qa.prototype.getResponseJson=qa.prototype.Wa,qa.prototype.getResponseText=qa.prototype.ja,qa.prototype.send=qa.prototype.ha,qa.prototype.setWithCredentials=qa.prototype.Oa,Gg.prototype.digest=Gg.prototype.l,Gg.prototype.reset=Gg.prototype.reset,Gg.prototype.update=Gg.prototype.j,ms.prototype.add=ms.prototype.add,ms.prototype.multiply=ms.prototype.R,ms.prototype.modulo=ms.prototype.gb,ms.prototype.compare=ms.prototype.X,ms.prototype.toNumber=ms.prototype.ea,ms.prototype.toString=ms.prototype.toString,ms.prototype.getBits=ms.prototype.D,ms.fromNumber=tv,ms.fromString=function pce(t,e){if(0==t.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==t.charAt(0))return mu(pce(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=tv(Math.pow(e,8)),r=PL,s=0;s<t.length;s+=8){var c=Math.min(8,t.length-s),f=parseInt(t.substring(s,s+c),e);8>c?(c=tv(Math.pow(e,c)),r=r.R(c).add(tv(f))):r=(r=r.R(n)).add(tv(f))}return r};var kfe=$a.createWebChannelTransport=function(){return new pW},Ofe=$a.getStatEventTarget=function(){return eW()},tre=$a.ErrorCode=tW,Nfe=$a.EventType=Tle,Lfe=$a.Event=cP,gce=$a.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},yW=($a.FetchXmlHttpFactory=C6,$a.WebChannel=Ile),Ffe=$a.XhrIo=qa,Vfe=$a.Md5=Gg,ML=$a.Integer=ms;const yce="@firebase/firestore";class Uc{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Uc.UNAUTHENTICATED=new Uc(null),Uc.GOOGLE_CREDENTIALS=new Uc("google-credentials-uid"),Uc.FIRST_PARTY=new Uc("first-party-uid"),Uc.MOCK_USER=new Uc("mock-user");let kL="10.8.0";const nC=new g("@firebase/firestore");function OL(){return nC.logLevel}function Yt(t,...e){if(nC.logLevel<=o.DEBUG){const n=e.map(nre);nC.debug(`Firestore (${kL}): ${t}`,...n)}}function cl(t,...e){if(nC.logLevel<=o.ERROR){const n=e.map(nre);nC.error(`Firestore (${kL}): ${t}`,...n)}}function $p(t,...e){if(nC.logLevel<=o.WARN){const n=e.map(nre);nC.warn(`Firestore (${kL}): ${t}`,...n)}}function nre(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch{return t}}function tr(t="Unexpected state"){const e=`FIRESTORE (${kL}) INTERNAL ASSERTION FAILED: `+t;throw cl(e),new Error(e)}function yr(t,e){t||tr()}function Pn(t,e){return t}const ft={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Zt extends Hf{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class pc{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}class _ce{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Bfe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Uc.UNAUTHENTICATED))}shutdown(){}}class Ufe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class zfe{constructor(e){this.t=e,this.currentUser=Uc.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){var r=this;let s=this.i;const c=S=>this.i!==s?(s=this.i,n(S)):Promise.resolve();let f=new pc;this.o=()=>{this.i++,this.currentUser=this.u(),f.resolve(),f=new pc,e.enqueueRetryable(()=>c(this.currentUser))};const v=()=>{const S=f;e.enqueueRetryable(Ze(function*(){yield S.promise,yield c(r.currentUser)}))},b=S=>{Yt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=S,this.auth.addAuthTokenListener(this.o),v()};this.t.onInit(S=>b(S)),setTimeout(()=>{if(!this.auth){const S=this.t.getImmediate({optional:!0});S?b(S):(Yt("FirebaseAuthCredentialsProvider","Auth not yet detected"),f.resolve(),f=new pc)}},0),v()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Yt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(yr("string"==typeof r.accessToken),new _ce(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return yr(null===e||"string"==typeof e),new Uc(e)}}class jfe{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Uc.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Hfe{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new jfe(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Uc.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class vce{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $fe{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){const r=c=>{null!=c.error&&Yt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const f=c.token!==this.R;return this.R=c.token,Yt("FirebaseAppCheckTokenProvider",`Received ${f?"new":"existing"} token.`),f?n(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable(()=>r(c))};const s=c=>{Yt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.appCheck.addTokenListener(this.o)};this.A.onInit(c=>s(c)),setTimeout(()=>{if(!this.appCheck){const c=this.A.getImmediate({optional:!0});c?s(c):Yt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(yr("string"==typeof n.token),this.R=n.token,new vce(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function qfe(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class wce{static newId(){const n=62*Math.floor(256/62);let r="";for(;r.length<20;){const s=qfe(40);for(let c=0;c<s.length;++c)r.length<20&&s[c]<n&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(s[c]%62))}return r}}function ri(t,e){return t<e?-1:t>e?1:0}function NL(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}class Da{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Zt(ft.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Zt(ft.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Zt(ft.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Zt(ft.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Da.fromMillis(Date.now())}static fromDate(e){return Da.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Da(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ri(this.nanoseconds,e.nanoseconds):ri(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class br{constructor(e){this.timestamp=e}static fromTimestamp(e){return new br(e)}static min(){return new br(new Da(0,0))}static max(){return new br(new Da(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class R6{constructor(e,n,r){void 0===n?n=0:n>e.length&&tr(),void 0===r?r=e.length-n:r>e.length-n&&tr(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return 0===R6.comparator(this,e)}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof R6?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const c=e.get(s),f=n.get(s);if(c<f)return-1;if(c>f)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ro extends R6{construct(e,n,r){return new ro(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Zt(ft.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ro(n)}static emptyPath(){return new ro([])}}const Gfe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ma extends R6{construct(e,n,r){return new ma(e,n,r)}static isValidIdentifier(e){return Gfe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ma.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ma(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const c=()=>{if(0===r.length)throw new Zt(ft.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let f=!1;for(;s<e.length;){const v=e[s];if("\\"===v){if(s+1===e.length)throw new Zt(ft.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const b=e[s+1];if("\\"!==b&&"."!==b&&"`"!==b)throw new Zt(ft.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=b,s+=2}else"`"===v?(f=!f,s++):"."!==v||f?(r+=v,s++):(c(),s++)}if(c(),f)throw new Zt(ft.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ma(n)}static emptyPath(){return new ma([])}}class kn{constructor(e){this.path=e}static fromPath(e){return new kn(ro.fromString(e))}static fromName(e){return new kn(ro.fromString(e).popFirst(5))}static empty(){return new kn(ro.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ro.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,n){return ro.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new kn(new ro(e.slice()))}}function xce(t){return new qp(t.readTime,t.key,-1)}class qp{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new qp(br.min(),kn.empty(),-1)}static max(){return new qp(br.max(),kn.empty(),-1)}}function ire(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=kn.comparator(t.documentKey,e.documentKey),0!==n?n:ri(t.largestBatchId,e.largestBatchId))}const Tce="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Yfe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function rC(t){return ore.apply(this,arguments)}function ore(){return ore=Ze(function*(t){if(t.code!==ft.FAILED_PRECONDITION||t.message!==Tce)throw t;Yt("LocalStore","Unexpectedly lost primary lease")}),ore.apply(this,arguments)}class rt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&tr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new rt((r,s)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(r,s)},this.catchCallback=c=>{this.wrapFailure(n,c).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof rt?n:rt.resolve(n)}catch(n){return rt.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):rt.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):rt.reject(n)}static resolve(e){return new rt((n,r)=>{n(e)})}static reject(e){return new rt((n,r)=>{r(e)})}static waitFor(e){return new rt((n,r)=>{let s=0,c=0,f=!1;e.forEach(v=>{++s,v.next(()=>{++c,f&&c===s&&n()},b=>r(b))}),f=!0,c===s&&n()})}static or(e){let n=rt.resolve(!1);for(const r of e)n=n.next(s=>s?rt.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,c)=>{r.push(n.call(this,s,c))}),this.waitFor(r)}static mapArray(e,n){return new rt((r,s)=>{const c=e.length,f=new Array(c);let v=0;for(let b=0;b<c;b++){const S=b;n(e[S]).next(k=>{f[S]=k,++v,v===c&&r(f)},k=>s(k))}})}static doWhile(e,n){return new rt((r,s)=>{const c=()=>{!0===e()?n().next(()=>{c()},s):r()};c()})}}class _W{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new pc,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new M6(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const s=sre(r.target.error);this.V.reject(new M6(e,s))}}static open(e,n,r,s){try{return new _W(n,e.transaction(s,r))}catch(c){throw new M6(n,c)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Yt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const n=this.transaction.objectStore(e);return new Qfe(n)}}class lm{constructor(e,n,r){this.name=e,this.version=n,this.p=r,12.2===lm.S(zs())&&cl("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Yt("SimpleDb","Removing database:",e),mP(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!U7())return!1;if(lm.C())return!0;const e=zs(),n=lm.S(e),r=0<n&&n<10,s=lm.v(e),c=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||c)}static C(){var e;return typeof process<"u"&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.F)}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){var n=this;return Ze(function*(){return n.db||(Yt("SimpleDb","Opening database:",n.name),n.db=yield new Promise((r,s)=>{const c=indexedDB.open(n.name,n.version);c.onsuccess=f=>{r(f.target.result)},c.onblocked=()=>{s(new M6(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},c.onerror=f=>{const v=f.target.error;s("VersionError"===v.name?new Zt(ft.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===v.name?new Zt(ft.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+v):new M6(e,v))},c.onupgradeneeded=f=>{Yt("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',f.oldVersion),n.p.N(f.target.result,c.transaction,f.oldVersion,n.version).next(()=>{Yt("SimpleDb","Database upgrade to version "+n.version+" complete")})}})),n.B&&(n.db.onversionchange=r=>n.B(r)),n.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,s){var c=this;return Ze(function*(){const f="readonly"===n;let v=0;for(;;){++v;try{c.db=yield c.O(e);const b=_W.open(c.db,e,f?"readonly":"readwrite",r),S=s(b).next(k=>(b.g(),k)).catch(k=>(b.abort(k),rt.reject(k))).toPromise();return S.catch(()=>{}),yield b.m,S}catch(b){const S=b,k="FirebaseError"!==S.name&&v<3;if(Yt("SimpleDb","Transaction failed with error:",S.message,"Retrying:",k),c.close(),!k)return Promise.reject(S)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Zfe{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return mP(this.k.delete())}}class M6 extends Zt{constructor(e,n){super(ft.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function iC(t){return"IndexedDbTransactionError"===t.name}class Qfe{constructor(e){this.store=e}put(e,n){let r;return void 0!==n?(Yt("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(Yt("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),mP(r)}add(e){return Yt("SimpleDb","ADD",this.store.name,e,e),mP(this.store.add(e))}get(e){return mP(this.store.get(e)).next(n=>(void 0===n&&(n=null),Yt("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return Yt("SimpleDb","DELETE",this.store.name,e),mP(this.store.delete(e))}count(){return Yt("SimpleDb","COUNT",this.store.name),mP(this.store.count())}W(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if("function"==typeof s.getAll){const c=s.getAll(r.range);return new rt((f,v)=>{c.onerror=b=>{v(b.target.error)},c.onsuccess=b=>{f(b.target.result)}})}{const c=this.cursor(r),f=[];return this.G(c,(v,b)=>{f.push(b)}).next(()=>f)}}j(e,n){const r=this.store.getAll(e,null===n?void 0:n);return new rt((s,c)=>{r.onerror=f=>{c(f.target.error)},r.onsuccess=f=>{s(f.target.result)}})}H(e,n){Yt("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.J=!1;const s=this.cursor(r);return this.G(s,(c,f,v)=>v.delete())}Y(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.G(s,n)}Z(e){const n=this.cursor({});return new rt((r,s)=>{n.onerror=c=>{const f=sre(c.target.error);s(f)},n.onsuccess=c=>{const f=c.target.result;f?e(f.primaryKey,f.value).next(v=>{v?f.continue():r()}):r()}})}G(e,n){const r=[];return new rt((s,c)=>{e.onerror=f=>{c(f.target.error)},e.onsuccess=f=>{const v=f.target.result;if(!v)return void s();const b=new Zfe(v),S=n(v.primaryKey,v.value,b);if(S instanceof rt){const k=S.catch(F=>(b.done(),rt.reject(F)));r.push(k)}b.isDone?s():null===b.$?v.continue():v.continue(b.$)}}).next(()=>rt.waitFor(r))}options(e,n){let r;return void 0!==e&&("string"==typeof e?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function mP(t){return new rt((e,n)=>{t.onsuccess=r=>{e(r.target.result)},t.onerror=r=>{const s=sre(r.target.error);n(s)}})}let Cce=!1;function sre(t){const e=lm.S(zs());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Zt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Cce||(Cce=!0,setTimeout(()=>{throw r},0)),r}}return t}let Gp=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=s=>this.se(s),this.oe=s=>r.writeSequenceNumber(s))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){const n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function k6(t){return null==t}function O6(t){return 0===t&&1/t==-1/0}function kce(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function oC(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}class Gs{constructor(e,n){this.comparator=e,this.root=n||gu.EMPTY}insert(e,n){return new Gs(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,gu.BLACK,null,null))}remove(e){return new Gs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gu.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(0===s)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wW(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wW(this.root,e,this.comparator,!1)}getReverseIterator(){return new wW(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wW(this.root,e,this.comparator,!0)}}class wW{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=n?r(e.key,n):1,n&&s&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(0===c){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gu{constructor(e,n,r,s,c){this.key=e,this.value=n,this.color=r??gu.RED,this.left=s??gu.EMPTY,this.right=c??gu.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,c){return new gu(e??this.key,n??this.value,r??this.color,s??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const c=r(e,s.key);return s=c<0?s.copy(null,null,null,s.left.insert(e,n,r),null):0===c?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return gu.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===n(e,s.key)){if(s.right.isEmpty())return gu.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gu.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw tr();const e=this.left.check();if(e!==this.right.check())throw tr();return e+(this.isRed()?0:1)}}gu.EMPTY=null,gu.RED=!0,gu.BLACK=!1,gu.EMPTY=new class{constructor(){this.size=0}get key(){throw tr()}get value(){throw tr()}get color(){throw tr()}get left(){throw tr()}get right(){throw tr()}copy(e,n,r,s,c){return this}insert(e,n,r){return new gu(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ss{constructor(e){this.comparator=e,this.data=new Gs(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=void 0!==n?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Nce(this.data.getIterator())}getIteratorFrom(e){return new Nce(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ss)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,c=r.getNext().key;if(0!==this.comparator(s,c))return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ss(this.comparator);return n.data=e,n}}class Nce{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Md{constructor(e){this.fields=e,e.sort(ma.comparator)}static empty(){return new Md([])}unionWith(e){let n=new Ss(ma.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Md(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return NL(this.fields,e.fields,(n,r)=>n.isEqual(r))}}class Lce extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class fc{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new Lce("Invalid base64 string: "+c):c}}(e);return new fc(n)}static fromUint8Array(e){const n=function(s){let c="";for(let f=0;f<s.length;++f)c+=String.fromCharCode(s[f]);return c}(e);return new fc(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ri(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fc.EMPTY_BYTE_STRING=new fc("");const _me=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sC(t){if(yr(!!t),"string"==typeof t){let e=0;const n=_me.exec(t);if(yr(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ga(t.seconds),nanos:Ga(t.nanos)}}function Ga(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function rb(t){return"string"==typeof t?fc.fromBase64String(t):fc.fromUint8Array(t)}function bW(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=t?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function EW(t){const e=t.mapValue.fields.__previous_value__;return bW(e)?EW(e):e}function N6(t){const e=sC(t.mapValue.fields.__local_write_time__.timestampValue);return new Da(e.seconds,e.nanos)}class vme{constructor(e,n,r,s,c,f,v,b,S){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=c,this.forceLongPolling=f,this.autoDetectLongPolling=v,this.longPollingOptions=b,this.useFetchStreams=S}}class gP{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new gP("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof gP&&e.projectId===this.projectId&&e.database===this.database}}const aC={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function lC(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?bW(t)?4:Uce(t)?9007199254740991:10:tr()}function rv(t,e){if(t===e)return!0;const n=lC(t);if(n!==lC(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return N6(t).isEqual(N6(e));case 3:return function(s,c){if("string"==typeof s.timestampValue&&"string"==typeof c.timestampValue&&s.timestampValue.length===c.timestampValue.length)return s.timestampValue===c.timestampValue;const f=sC(s.timestampValue),v=sC(c.timestampValue);return f.seconds===v.seconds&&f.nanos===v.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return c=e,rb(t.bytesValue).isEqual(rb(c.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,c){return Ga(s.geoPointValue.latitude)===Ga(c.geoPointValue.latitude)&&Ga(s.geoPointValue.longitude)===Ga(c.geoPointValue.longitude)}(t,e);case 2:return function(s,c){if("integerValue"in s&&"integerValue"in c)return Ga(s.integerValue)===Ga(c.integerValue);if("doubleValue"in s&&"doubleValue"in c){const f=Ga(s.doubleValue),v=Ga(c.doubleValue);return f===v?O6(f)===O6(v):isNaN(f)&&isNaN(v)}return!1}(t,e);case 9:return NL(t.arrayValue.values||[],e.arrayValue.values||[],rv);case 10:return function(s,c){const f=s.mapValue.fields||{},v=c.mapValue.fields||{};if(kce(f)!==kce(v))return!1;for(const b in f)if(f.hasOwnProperty(b)&&(void 0===v[b]||!rv(f[b],v[b])))return!1;return!0}(t,e);default:return tr()}var c}function L6(t,e){return void 0!==(t.values||[]).find(n=>rv(n,e))}function cC(t,e){if(t===e)return 0;const n=lC(t),r=lC(e);if(n!==r)return ri(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ri(t.booleanValue,e.booleanValue);case 2:return function(c,f){const v=Ga(c.integerValue||c.doubleValue),b=Ga(f.integerValue||f.doubleValue);return v<b?-1:v>b?1:v===b?0:isNaN(v)?isNaN(b)?0:-1:1}(t,e);case 3:return Fce(t.timestampValue,e.timestampValue);case 4:return Fce(N6(t),N6(e));case 5:return ri(t.stringValue,e.stringValue);case 6:return function(c,f){const v=rb(c),b=rb(f);return v.compareTo(b)}(t.bytesValue,e.bytesValue);case 7:return function(c,f){const v=c.split("/"),b=f.split("/");for(let S=0;S<v.length&&S<b.length;S++){const k=ri(v[S],b[S]);if(0!==k)return k}return ri(v.length,b.length)}(t.referenceValue,e.referenceValue);case 8:return function(c,f){const v=ri(Ga(c.latitude),Ga(f.latitude));return 0!==v?v:ri(Ga(c.longitude),Ga(f.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(c,f){const v=c.values||[],b=f.values||[];for(let S=0;S<v.length&&S<b.length;++S){const k=cC(v[S],b[S]);if(k)return k}return ri(v.length,b.length)}(t.arrayValue,e.arrayValue);case 10:return function(c,f){if(c===aC.mapValue&&f===aC.mapValue)return 0;if(c===aC.mapValue)return 1;if(f===aC.mapValue)return-1;const v=c.fields||{},b=Object.keys(v),S=f.fields||{},k=Object.keys(S);b.sort(),k.sort();for(let F=0;F<b.length&&F<k.length;++F){const H=ri(b[F],k[F]);if(0!==H)return H;const Q=cC(v[b[F]],S[k[F]]);if(0!==Q)return Q}return ri(b.length,k.length)}(t.mapValue,e.mapValue);default:throw tr()}}function Fce(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ri(t,e);const n=sC(t),r=sC(e),s=ri(n.seconds,r.seconds);return 0!==s?s:ri(n.nanos,r.nanos)}function BL(t){return lre(t)}function lre(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=sC(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?rb(t.bytesValue).toBase64():"referenceValue"in t?kn.fromName(t.referenceValue).toString():"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const c of n.values||[])s?s=!1:r+=",",r+=lre(c);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",c=!0;for(const f of r)c?c=!1:s+=",",s+=`${f}:${lre(n.fields[f])}`;return s+"}"}(t.mapValue):tr()}function cre(t){return!!t&&"integerValue"in t}function F6(t){return!!t&&"arrayValue"in t}function Vce(t){return!!t&&"nullValue"in t}function Bce(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function CW(t){return!!t&&"mapValue"in t}function V6(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return oC(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=V6(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=V6(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Uce(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class yu{constructor(e){this.value=e}static empty(){return new yu({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!CW(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=V6(n)}setAll(e){let n=ma.emptyPath(),r={},s=[];e.forEach((f,v)=>{if(!n.isImmediateParentOf(v)){const b=this.getFieldsMap(n);this.applyChanges(b,r,s),r={},s=[],n=v.popLast()}f?r[v.lastSegment()]=V6(f):s.push(v.lastSegment())});const c=this.getFieldsMap(n);this.applyChanges(c,r,s)}delete(e){const n=this.field(e.popLast());CW(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return rv(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];CW(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){oC(n,(s,c)=>e[s]=c);for(const s of r)delete e[s]}clone(){return new yu(V6(this.value))}}class sa{constructor(e,n,r,s,c,f,v){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=c,this.data=f,this.documentState=v}static newInvalidDocument(e){return new sa(e,0,br.min(),br.min(),br.min(),yu.empty(),0)}static newFoundDocument(e,n,r,s){return new sa(e,1,n,br.min(),r,s,0)}static newNoDocument(e,n){return new sa(e,2,n,br.min(),br.min(),yu.empty(),0)}static newUnknownDocument(e,n){return new sa(e,3,n,br.min(),br.min(),yu.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(br.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yu.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yu.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=br.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof sa&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new sa(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class uC{constructor(e,n){this.position=e,this.inclusive=n}}function $ce(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const c=e[s],f=t.position[s];if(r=c.field.isKeyField()?kn.comparator(kn.fromName(f.referenceValue),n.key):cC(f,n.data.field(c.field)),"desc"===c.dir&&(r*=-1),0!==r)break}return r}function qce(t,e){if(null===t)return null===e;if(null===e||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!rv(t.position[n],e.position[n]))return!1;return!0}class B6{constructor(e,n="asc"){this.field=e,this.dir=n}}function Eme(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Gce{}class io extends Gce{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.createKeyFieldInFilter(e,n,r):new xme(e,n,r):"array-contains"===n?new Ime(e,r):"in"===n?new Xce(e,r):"not-in"===n?new Sme(e,r):"array-contains-any"===n?new Ame(e,r):new io(e,n,r)}static createKeyFieldInFilter(e,n,r){return"in"===n?new Tme(e,r):new Cme(e,r)}matches(e){const n=e.data.field(this.field);return"!="===this.op?null!==n&&this.matchesComparison(cC(n,this.value)):null!==n&&lC(this.value)===lC(n)&&this.matchesComparison(cC(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return tr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class gs extends Gce{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new gs(e,n)}matches(e){return UL(this)?void 0===this.filters.find(n=>!n.matches(e)):void 0!==this.filters.find(n=>n.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function UL(t){return"and"===t.op}function hre(t){return function Kce(t){for(const e of t.filters)if(e instanceof gs)return!1;return!0}(t)&&UL(t)}function dre(t){if(t instanceof io)return t.field.canonicalString()+t.op.toString()+BL(t.value);if(hre(t))return t.filters.map(e=>dre(e)).join(",");{const e=t.filters.map(n=>dre(n)).join(",");return`${t.op}(${e})`}}function Wce(t,e){return t instanceof io?(r=t,(s=e)instanceof io&&r.op===s.op&&r.field.isEqual(s.field)&&rv(r.value,s.value)):t instanceof gs?function(r,s){return s instanceof gs&&r.op===s.op&&r.filters.length===s.filters.length&&r.filters.reduce((c,f,v)=>c&&Wce(f,s.filters[v]),!0)}(t,e):void tr();var r,s}function Zce(t){return t instanceof io?`${(n=t).field.canonicalString()} ${n.op} ${BL(n.value)}`:t instanceof gs?function(n){return n.op.toString()+" {"+n.getFilters().map(Zce).join(" ,")+"}"}(t):"Filter";var n}class xme extends io{constructor(e,n,r){super(e,n,r),this.key=kn.fromName(r.referenceValue)}matches(e){const n=kn.comparator(e.key,this.key);return this.matchesComparison(n)}}class Tme extends io{constructor(e,n){super(e,"in",n),this.keys=Qce(0,n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Cme extends io{constructor(e,n){super(e,"not-in",n),this.keys=Qce(0,n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Qce(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(r=>kn.fromName(r.referenceValue))}class Ime extends io{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return F6(n)&&L6(n.arrayValue,this.value)}}class Xce extends io{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return null!==n&&L6(this.value.arrayValue,n)}}class Sme extends io{constructor(e,n){super(e,"not-in",n)}matches(e){if(L6(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return null!==n&&!L6(this.value.arrayValue,n)}}class Ame extends io{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!F6(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>L6(this.value.arrayValue,r))}}class Dme{constructor(e,n=null,r=[],s=[],c=null,f=null,v=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=c,this.startAt=f,this.endAt=v,this.ce=null}}function pre(t,e=null,n=[],r=[],s=null,c=null,f=null){return new Dme(t,e,n,r,s,c,f)}function _P(t){const e=Pn(t);if(null===e.ce){let n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>dre(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>{return(c=r).field.canonicalString()+c.dir;var c}).join(","),k6(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>BL(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>BL(r)).join(",")),e.ce=n}return e.ce}function U6(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Eme(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Wce(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!qce(t.startAt,e.startAt)&&qce(t.endAt,e.endAt)}function IW(t){return kn.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class ib{constructor(e,n=null,r=[],s=[],c=null,f="F",v=null,b=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=c,this.limitType=f,this.startAt=v,this.endAt=b,this.le=null,this.he=null,this.Pe=null}}function zL(t){return new ib(t)}function nue(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function jL(t){const e=Pn(t);if(null===e.le){e.le=[];const n=new Set;for(const c of e.explicitOrderBy)e.le.push(c),n.add(c.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(f){let v=new Ss(ma.comparator);return f.filters.forEach(b=>{b.getFlattenedFilters().forEach(S=>{S.isInequality()&&(v=v.add(S.field))})}),v})(e).forEach(c=>{n.has(c.canonicalString())||c.isKeyField()||e.le.push(new B6(c,r))}),n.has(ma.keyField().canonicalString())||e.le.push(new B6(ma.keyField(),r))}return e.le}function zh(t){const e=Pn(t);return e.he||(e.he=function rue(t,e){if("F"===t.limitType)return pre(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>new B6(s.field,"desc"===s.dir?"asc":"desc"));const n=t.endAt?new uC(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new uC(t.startAt.position,t.startAt.inclusive):null;return pre(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,jL(t))),e.he}function AW(t,e,n){return new ib(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function z6(t,e){return U6(zh(t),zh(e))&&t.limitType===e.limitType}function iue(t){return`${_P(zh(t))}|lt:${t.limitType}`}function HL(t){return`Query(target=${function(n){let r=n.path.canonicalString();return null!==n.collectionGroup&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Zce(s)).join(", ")}]`),k6(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>{return`${(f=s).field.canonicalString()} (${f.dir})`;var f}).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>BL(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>BL(s)).join(",")),`Target(${r})`}(zh(t))}; limitType=${t.limitType})`}function j6(t,e){return e.isFoundDocument()&&function(r,s){const c=s.key.path;return null!==r.collectionGroup?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(c):kn.isDocumentKey(r.path)?r.path.isEqual(c):r.path.isImmediateParentOf(c)}(t,e)&&function(r,s){for(const c of jL(r))if(!c.field.isKeyField()&&null===s.data.field(c.field))return!1;return!0}(t,e)&&function(r,s){for(const c of r.filters)if(!c.matches(s))return!1;return!0}(t,e)&&(s=e,!((r=t).startAt&&!function(f,v,b){const S=$ce(f,v,b);return f.inclusive?S<=0:S<0}(r.startAt,jL(r),s)||r.endAt&&!function(f,v,b){const S=$ce(f,v,b);return f.inclusive?S>=0:S>0}(r.endAt,jL(r),s)));var r,s}function sue(t){return(e,n)=>{let r=!1;for(const s of jL(t)){const c=Pme(s,e,n);if(0!==c)return c;r=r||s.field.isKeyField()}return 0}}function Pme(t,e,n){const r=t.field.isKeyField()?kn.comparator(e.key,n.key):function(c,f,v){const b=f.data.field(c),S=v.data.field(c);return null!==b&&null!==S?cC(b,S):tr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return tr()}}class ob{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r)for(const[s,c]of r)if(this.equalsFn(s,e))return c}has(e){return void 0!==this.get(e)}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(void 0===s)return this.inner[r]=[[e,n]],void this.innerSize++;for(let c=0;c<s.length;c++)if(this.equalsFn(s[c][0],e))return void(s[c]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return 1===r.length?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){oC(this.inner,(n,r)=>{for(const[s,c]of r)e(s,c)})}isEmpty(){return function Oce(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(this.inner)}size(){return this.innerSize}}const Rme=new Gs(kn.comparator);function kd(){return Rme}const aue=new Gs(kn.comparator);function H6(...t){let e=aue;for(const n of t)e=e.insert(n.key,n);return e}function lue(t){let e=aue;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function iv(){return $6()}function cue(){return $6()}function $6(){return new ob(t=>t.toString(),(t,e)=>t.isEqual(e))}new Gs(kn.comparator);const kme=new Ss(kn.comparator);function Ii(...t){let e=kme;for(const n of t)e=e.add(n);return e}const Ome=new Ss(ri);class DW{constructor(){this._=void 0}}function Nme(t,e,n){return t instanceof $L?function(s,c){const f={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return c&&bW(c)&&(c=EW(c)),c&&(f.fields.__previous_value__=c),{mapValue:f}}(n,e):t instanceof vP?fue(t,e):t instanceof wP?mue(t,e):function(s,c){const f=function pue(t,e){return t instanceof qL?cre(r=e)||(c=r)&&"doubleValue"in c?e:{integerValue:0}:null;var r,c}(s,c),v=gue(f)+gue(s.Ie);return cre(f)&&cre(s.Ie)?function hue(t){return{integerValue:""+t}}(v):function uue(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:O6(e)?"-0":e}}(s.serializer,v)}(t,e)}function Lme(t,e,n){return t instanceof vP?fue(t,e):t instanceof wP?mue(t,e):n}class $L extends DW{}class vP extends DW{constructor(e){super(),this.elements=e}}function fue(t,e){const n=yue(e);for(const r of t.elements)n.some(s=>rv(s,r))||n.push(r);return{arrayValue:{values:n}}}class wP extends DW{constructor(e){super(),this.elements=e}}function mue(t,e){let n=yue(e);for(const r of t.elements)n=n.filter(s=>!rv(s,r));return{arrayValue:{values:n}}}class qL extends DW{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function gue(t){return Ga(t.integerValue||t.doubleValue)}function yue(t){return F6(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class ga{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ga}static exists(e){return new ga(void 0,e)}static updateTime(e){return new ga(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function PW(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class yre{}function _ue(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new KL(t.key,ga.none()):new GL(t.key,t.data,ga.none());{const n=t.data,r=yu.empty();let s=new Ss(ma.comparator);for(let c of e.fields)if(!s.has(c)){let f=n.field(c);null===f&&c.length>1&&(c=c.popLast(),f=n.field(c)),null===f?r.delete(c):r.set(c,f),s=s.add(c)}return new sb(t.key,r,new Md(s.toArray()),ga.none())}}function Bme(t,e,n){t instanceof GL?function(s,c,f){const v=s.value.clone(),b=bue(s.fieldTransforms,c,f.transformResults);v.setAll(b),c.convertToFoundDocument(f.version,v).setHasCommittedMutations()}(t,e,n):t instanceof sb?function(s,c,f){if(!PW(s.precondition,c))return void c.convertToUnknownDocument(f.version);const v=bue(s.fieldTransforms,c,f.transformResults),b=c.data;b.setAll(wue(s)),b.setAll(v),c.convertToFoundDocument(f.version,b).setHasCommittedMutations()}(t,e,n):e.convertToNoDocument(n.version).setHasCommittedMutations()}function G6(t,e,n,r){return t instanceof GL?function(c,f,v,b){if(!PW(c.precondition,f))return v;const S=c.value.clone(),k=Eue(c.fieldTransforms,b,f);return S.setAll(k),f.convertToFoundDocument(f.version,S).setHasLocalMutations(),null}(t,e,n,r):t instanceof sb?function(c,f,v,b){if(!PW(c.precondition,f))return v;const S=Eue(c.fieldTransforms,b,f),k=f.data;return k.setAll(wue(c)),k.setAll(S),f.convertToFoundDocument(f.version,k).setHasLocalMutations(),null===v?null:v.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map(F=>F.field))}(t,e,n,r):(v=n,PW(t.precondition,f=e)?(f.convertToNoDocument(f.version).setHasLocalMutations(),null):v);var f,v}function vue(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(s=e.fieldTransforms,!!(void 0===(r=t.fieldTransforms)&&void 0===s||r&&s&&NL(r,s,(c,f)=>function Fme(t,e){return t.field.isEqual(e.field)&&(s=e.transform,(r=t.transform)instanceof vP&&s instanceof vP||r instanceof wP&&s instanceof wP?NL(r.elements,s.elements,rv):r instanceof qL&&s instanceof qL?rv(r.Ie,s.Ie):r instanceof $L&&s instanceof $L);var r,s}(c,f))))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var r,s}class GL extends yre{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class sb extends yre{constructor(e,n,r,s,c=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function wue(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function bue(t,e,n){const r=new Map;yr(t.length===n.length);for(let s=0;s<n.length;s++){const c=t[s],f=c.transform,v=e.data.field(c.field);r.set(c.field,Lme(f,v,n[s]))}return r}function Eue(t,e,n){const r=new Map;for(const s of t){const c=s.transform,f=n.data.field(s.field);r.set(s.field,Nme(c,f,e))}return r}class KL extends yre{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vre{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const c=this.mutations[s];c.key.isEqual(e.key)&&Bme(c,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=G6(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=G6(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=cue();return this.mutations.forEach(s=>{const c=e.get(s.key),f=c.overlayedDocument;let v=this.applyToLocalView(f,c.mutatedFields);v=n.has(s.key)?null:v;const b=_ue(f,v);null!==b&&r.set(s.key,b),f.isValidDocument()||f.convertToNoDocument(br.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ii())}isEqual(e){return this.batchId===e.batchId&&NL(this.mutations,e.mutations,(n,r)=>vue(n,r))&&NL(this.baseMutations,e.baseMutations,(n,r)=>vue(n,r))}}class bre{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class jme{constructor(e,n){this.count=e,this.unchangedNames=n}}var kl,xo;function Tue(t){if(void 0===t)return cl("GRPC error has no .code"),ft.UNKNOWN;switch(t){case kl.OK:return ft.OK;case kl.CANCELLED:return ft.CANCELLED;case kl.UNKNOWN:return ft.UNKNOWN;case kl.DEADLINE_EXCEEDED:return ft.DEADLINE_EXCEEDED;case kl.RESOURCE_EXHAUSTED:return ft.RESOURCE_EXHAUSTED;case kl.INTERNAL:return ft.INTERNAL;case kl.UNAVAILABLE:return ft.UNAVAILABLE;case kl.UNAUTHENTICATED:return ft.UNAUTHENTICATED;case kl.INVALID_ARGUMENT:return ft.INVALID_ARGUMENT;case kl.NOT_FOUND:return ft.NOT_FOUND;case kl.ALREADY_EXISTS:return ft.ALREADY_EXISTS;case kl.PERMISSION_DENIED:return ft.PERMISSION_DENIED;case kl.FAILED_PRECONDITION:return ft.FAILED_PRECONDITION;case kl.ABORTED:return ft.ABORTED;case kl.OUT_OF_RANGE:return ft.OUT_OF_RANGE;case kl.UNIMPLEMENTED:return ft.UNIMPLEMENTED;case kl.DATA_LOSS:return ft.DATA_LOSS;default:return tr()}}(xo=kl||(kl={}))[xo.OK=0]="OK",xo[xo.CANCELLED=1]="CANCELLED",xo[xo.UNKNOWN=2]="UNKNOWN",xo[xo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xo[xo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xo[xo.NOT_FOUND=5]="NOT_FOUND",xo[xo.ALREADY_EXISTS=6]="ALREADY_EXISTS",xo[xo.PERMISSION_DENIED=7]="PERMISSION_DENIED",xo[xo.UNAUTHENTICATED=16]="UNAUTHENTICATED",xo[xo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xo[xo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xo[xo.ABORTED=10]="ABORTED",xo[xo.OUT_OF_RANGE=11]="OUT_OF_RANGE",xo[xo.UNIMPLEMENTED=12]="UNIMPLEMENTED",xo[xo.INTERNAL=13]="INTERNAL",xo[xo.UNAVAILABLE=14]="UNAVAILABLE",xo[xo.DATA_LOSS=15]="DATA_LOSS";const Hme=new ML([4294967295,4294967295],0);function Iue(t){const e=function Cue(){return new TextEncoder}().encode(t),n=new Vfe;return n.update(e),new Uint8Array(n.digest())}function Sue(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new ML([n,r],0),new ML([s,c],0)]}class Ere{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new K6(`Invalid padding: ${n}`);if(r<0)throw new K6(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new K6(`Invalid hash count: ${r}`);if(0===e.length&&0!==n)throw new K6(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=ML.fromNumber(this.Te)}de(e,n,r){let s=e.add(n.multiply(ML.fromNumber(r)));return 1===s.compare(Hme)&&(s=new ML([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const n=Iue(e),[r,s]=Sue(n);for(let c=0;c<this.hashCount;c++){const f=this.de(r,s,c);if(!this.Ae(f))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),f=new Ere(c,s,n);return r.forEach(v=>f.insert(v)),f}insert(e){if(0===this.Te)return;const n=Iue(e),[r,s]=Sue(n);for(let c=0;c<this.hashCount;c++){const f=this.de(r,s,c);this.Re(f)}}Re(e){const n=Math.floor(e/8);this.bitmap[n]|=1<<e%8}}class K6 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class W6{constructor(e,n,r,s,c){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Y6.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new W6(br.min(),s,new Gs(ri),kd(),Ii())}}class Y6{constructor(e,n,r,s,c){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Y6(r,n,Ii(),Ii(),Ii())}}class MW{constructor(e,n,r,s){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=s}}class Aue{constructor(e,n){this.targetId=e,this.fe=n}}class Due{constructor(e,n,r=fc.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Pue{constructor(){this.ge=0,this.pe=Mue(),this.ye=fc.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=Ii(),n=Ii(),r=Ii();return this.pe.forEach((s,c)=>{switch(c){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:tr()}}),new Y6(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=Mue()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,yr(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class $me{constructor(e){this.Le=e,this.ke=new Map,this.qe=kd(),this.Qe=Rue(),this.Ke=new Gs(ri)}$e(e){for(const n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(const n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{const r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:tr()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,s)=>{this.je(s)&&n(s)})}Je(e){const n=e.targetId,r=e.fe.count,s=this.Ye(n);if(s){const c=s.target;if(IW(c))if(0===r){const f=new kn(c.path);this.We(n,f,sa.newNoDocument(f,br.min()))}else yr(1===r);else{const f=this.Ze(n);if(f!==r){const v=this.Xe(e),b=v?this.et(v,e,f):1;0!==b&&(this.He(n),this.Ke=this.Ke.insert(n,2===b?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(e){const n=e.fe.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:c=0}=n;let f,v;try{f=rb(r).toUint8Array()}catch(b){if(b instanceof Lce)return $p("Decoding the base64 bloom filter in existence filter failed ("+b.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw b}try{v=new Ere(f,s,c)}catch(b){return $p(b instanceof K6?"BloomFilter error: ":"Applying bloom filter failed: ",b),null}return 0===v.Te?null:v}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(c=>{const f=this.Le.nt(),v=`projects/${f.projectId}/databases/${f.database}/documents/${c.path.canonicalString()}`;e.mightContain(v)||(this.We(n,c,null),s++)}),s}it(e){const n=new Map;this.ke.forEach((c,f)=>{const v=this.Ye(f);if(v){if(c.current&&IW(v.target)){const b=new kn(v.target.path);null!==this.qe.get(b)||this.st(f,b)||this.We(f,b,sa.newNoDocument(b,e))}c.De&&(n.set(f,c.ve()),c.Fe())}});let r=Ii();this.Qe.forEach((c,f)=>{let v=!0;f.forEachWhile(b=>{const S=this.Ye(b);return!S||"TargetPurposeLimboResolution"===S.purpose||(v=!1,!1)}),v&&(r=r.add(c))}),this.qe.forEach((c,f)=>f.setReadTime(e));const s=new W6(e,n,this.Ke,this.qe,r);return this.qe=kd(),this.Qe=Rue(),this.Ke=new Gs(ri),s}Ue(e,n){if(!this.je(e))return;const r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;const s=this.ze(e);this.st(e,n)?s.Me(n,1):s.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){const n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new Pue,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Ss(ri),this.Qe=this.Qe.insert(e,n)),n}je(e){const n=null!==this.Ye(e);return n||Yt("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){const n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Pue),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Rue(){return new Gs(kn.comparator)}function Mue(){return new Gs(kn.comparator)}const qme={asc:"ASCENDING",desc:"DESCENDING"},Gme={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Kme={and:"AND",or:"OR"};class Wme{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function xre(t,e){return t.useProto3Json||k6(e)?e:{value:e}}function ul(t){return yr(!!t),br.fromTimestamp(function(n){const r=sC(n);return new Da(r.seconds,r.nanos)}(t))}function Cre(t,e){const n=(s=t,new ro(["projects",s.projectId,"databases",s.database])).child("documents");var s;return void 0===e?n:n.child(e)}function Oue(t){const e=ro.fromString(t);return yr($ue(e)),e}function ov(t,e){const n=Oue(e);if(n.get(1)!==t.databaseId.projectId)throw new Zt(ft.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Zt(ft.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new kn(Fue(n))}function Nue(t,e){return function Tre(t,e){return Cre(t,e).canonicalString()}(t.databaseId,e)}function Ire(t){return new ro(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Fue(t){return yr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Uue(t,e){return{documents:[Nue(t,e.path)]}}function Are(t,e){const n={structuredQuery:{}},r=e.path;let s;null!==e.collectionGroup?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Nue(t,s);const c=function(S){if(0!==S.length)return Hue(gs.create(S,"and"))}(e.filters);c&&(n.structuredQuery.where=c);const f=function(S){if(0!==S.length)return S.map(k=>{return{field:hC((H=k).field),direction:ege(H.dir)};var H})}(e.orderBy);f&&(n.structuredQuery.orderBy=f);const v=xre(t,e.limit);return null!==v&&(n.structuredQuery.limit=v),e.startAt&&(n.structuredQuery.startAt={before:(S=e.startAt).inclusive,values:S.position}),e.endAt&&(n.structuredQuery.endAt=function(S){return{before:!S.inclusive,values:S.position}}(e.endAt)),{ut:n,parent:s};var S}function zue(t){let e=function Lue(t){const e=Oue(t);return 4===e.length?ro.emptyPath():Fue(e)}(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){yr(1===r);const k=n.from[0];k.allDescendants?s=k.collectionId:e=e.child(k.collectionId)}let c=[];n.where&&(c=function(F){const H=jue(F);return H instanceof gs&&hre(H)?H.getFilters():[H]}(n.where));let f=[];n.orderBy&&(f=n.orderBy.map(H=>{return new B6(YL((de=H).field),function(Ie){switch(Ie){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(de.direction));var de}));let v=null;n.limit&&(v=function(F){let H;return H="object"==typeof F?F.value:F,k6(H)?null:H}(n.limit));let b=null;var F;n.startAt&&(b=new uC((F=n.startAt).values||[],!!F.before));let S=null;return n.endAt&&(S=function(F){return new uC(F.values||[],!F.before)}(n.endAt)),function tue(t,e,n,r,s,c,f,v){return new ib(t,e,n,r,s,c,f,v)}(e,s,f,c,v,"F",b,S)}function jue(t){return void 0!==t.unaryFilter?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=YL(n.unaryFilter.field);return io.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=YL(n.unaryFilter.field);return io.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=YL(n.unaryFilter.field);return io.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const f=YL(n.unaryFilter.field);return io.create(f,"!=",{nullValue:"NULL_VALUE"});default:return tr()}}(t):void 0!==t.fieldFilter?io.create(YL((n=t).fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return tr()}}(n.fieldFilter.op),n.fieldFilter.value):void 0!==t.compositeFilter?function(n){return gs.create(n.compositeFilter.filters.map(r=>jue(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return tr()}}(n.compositeFilter.op))}(t):tr();var n}function ege(t){return qme[t]}function tge(t){return Gme[t]}function nge(t){return Kme[t]}function hC(t){return{fieldPath:t.canonicalString()}}function YL(t){return ma.fromServerFormat(t.fieldPath)}function Hue(t){return t instanceof io?function(n){if("=="===n.op){if(Bce(n.value))return{unaryFilter:{field:hC(n.field),op:"IS_NAN"}};if(Vce(n.value))return{unaryFilter:{field:hC(n.field),op:"IS_NULL"}}}else if("!="===n.op){if(Bce(n.value))return{unaryFilter:{field:hC(n.field),op:"IS_NOT_NAN"}};if(Vce(n.value))return{unaryFilter:{field:hC(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hC(n.field),op:tge(n.op),value:n.value}}}(t):t instanceof gs?function(n){const r=n.getFilters().map(s=>Hue(s));return 1===r.length?r[0]:{compositeFilter:{op:nge(n.op),filters:r}}}(t):tr()}function $ue(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class ab{constructor(e,n,r,s,c=br.min(),f=br.min(),v=fc.EMPTY_BYTE_STRING,b=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=f,this.resumeToken=v,this.expectedCount=b}withSequenceNumber(e){return new ab(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ab(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ab(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ab(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class que{constructor(e){this.ct=e}}function Dre(t){const e=zue({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?AW(e,e.limit,"L"):e}class TP{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Ga(e.integerValue));else if("doubleValue"in e){const r=Ga(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),O6(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){const r=e.timestampValue;this.Et(n,20),"string"==typeof r?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(rb(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?Uce(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):tr()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){const r=e.fields||{};this.Et(n,55);for(const s of Object.keys(r))this.Rt(s,n),this.It(r[s],n)}wt(e,n){const r=e.values||[];this.Et(n,50);for(const s of r)this.It(s,n)}gt(e,n){this.Et(n,37),kn.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}}TP.bt=new TP;class hge{constructor(){this._n=new Nre}addToCollectionParentIndex(e,n){return this._n.add(n),rt.resolve()}getCollectionParents(e,n){return rt.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return rt.resolve()}deleteFieldIndex(e,n){return rt.resolve()}deleteAllFieldIndexes(e){return rt.resolve()}createTargetIndexes(e,n){return rt.resolve()}getDocumentsMatchingTarget(e,n){return rt.resolve(null)}getIndexType(e,n){return rt.resolve(0)}getFieldIndexes(e,n){return rt.resolve([])}getNextCollectionGroupToUpdate(e){return rt.resolve(null)}getMinOffset(e,n){return rt.resolve(qp.min())}getMinOffsetFromCollectionGroup(e,n){return rt.resolve(qp.min())}updateCollectionGroup(e,n,r){return rt.resolve()}updateIndexEntries(e,n){return rt.resolve()}}class Nre{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Ss(ro.comparator),c=!s.has(r);return this.index[n]=s.add(r),c}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ss(ro.comparator)).toArray()}}new Uint8Array(0);class ih{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new ih(e,ih.DEFAULT_COLLECTION_PERCENTILE,ih.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}ih.DEFAULT_COLLECTION_PERCENTILE=10,ih.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ih.DEFAULT=new ih(41943040,ih.DEFAULT_COLLECTION_PERCENTILE,ih.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ih.DISABLED=new ih(-1,0,0);class IP{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new IP(0)}static Bn(){return new IP(-1)}}class yge{constructor(){this.changes=new ob(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,sa.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return void 0!==r?rt.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class wge{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class _he{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(null!==r&&G6(r.mutation,s,Md.empty(),Da.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ii()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ii()){const s=iv();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(c=>{let f=H6();return c.forEach((v,b)=>{f=f.insert(v,b.overlayedDocument)}),f}))}getOverlayedDocuments(e,n){const r=iv();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ii()))}populateOverlays(e,n,r){const s=[];return r.forEach(c=>{n.has(c)||s.push(c)}),this.documentOverlayCache.getOverlays(e,s).next(c=>{c.forEach((f,v)=>{n.set(f,v)})})}computeViews(e,n,r,s){let c=kd();const f=$6(),v=$6();return n.forEach((b,S)=>{const k=r.get(S.key);s.has(S.key)&&(void 0===k||k.mutation instanceof sb)?c=c.insert(S.key,S):void 0!==k?(f.set(S.key,k.mutation.getFieldMask()),G6(k.mutation,S,k.mutation.getFieldMask(),Da.now())):f.set(S.key,Md.empty())}),this.recalculateAndSaveOverlays(e,c).next(b=>(b.forEach((S,k)=>f.set(S,k)),n.forEach((S,k)=>{var F;return v.set(S,new wge(k,null!==(F=f.get(S))&&void 0!==F?F:null))}),v))}recalculateAndSaveOverlays(e,n){const r=$6();let s=new Gs((f,v)=>f-v),c=Ii();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(f=>{for(const v of f)v.keys().forEach(b=>{const S=n.get(b);if(null===S)return;let k=r.get(b)||Md.empty();k=v.applyToLocalView(S,k),r.set(b,k);const F=(s.get(v.batchId)||Ii()).add(b);s=s.insert(v.batchId,F)})}).next(()=>{const f=[],v=s.getReverseIterator();for(;v.hasNext();){const b=v.getNext(),S=b.key,k=b.value,F=cue();k.forEach(H=>{if(!c.has(H)){const Q=_ue(n.get(H),r.get(H));null!==Q&&F.set(H,Q),c=c.add(H)}}),f.push(this.documentOverlayCache.saveOverlays(e,S,F))}return rt.waitFor(f)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return kn.isDocumentKey((f=n).path)&&null===f.collectionGroup&&0===f.filters.length?this.getDocumentsMatchingDocumentQuery(e,n.path):function fre(t){return null!==t.collectionGroup}(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s);var f}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(c=>{const f=s-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-c.size):rt.resolve(iv());let v=-1,b=c;return f.next(S=>rt.forEach(S,(k,F)=>(v<F.largestBatchId&&(v=F.largestBatchId),c.get(k)?rt.resolve():this.remoteDocumentCache.getEntry(e,k).next(H=>{b=b.insert(k,H)}))).next(()=>this.populateOverlays(e,S,c)).next(()=>this.computeViews(e,b,S,Ii())).next(k=>({batchId:v,changes:lue(k)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new kn(n)).next(r=>{let s=H6();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const c=n.collectionGroup;let f=H6();return this.indexManager.getCollectionParents(e,c).next(v=>rt.forEach(v,b=>{const S=(F=n,H=b.child(c),new ib(H,null,F.explicitOrderBy.slice(),F.filters.slice(),F.limit,F.limitType,F.startAt,F.endAt));var F,H;return this.getDocumentsMatchingCollectionQuery(e,S,r,s).next(k=>{k.forEach((F,H)=>{f=f.insert(F,H)})})}).next(()=>f))}getDocumentsMatchingCollectionQuery(e,n,r,s){let c;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(f=>(c=f,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,c,s))).next(f=>{c.forEach((b,S)=>{const k=S.getKey();null===f.get(k)&&(f=f.insert(k,sa.newInvalidDocument(k)))});let v=H6();return f.forEach((b,S)=>{const k=c.get(b);void 0!==k&&G6(k.mutation,S,Md.empty(),Da.now()),j6(n,S)&&(v=v.insert(b,S))}),v})}}class bge{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return rt.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,{id:(s=n).id,version:s.version,createTime:ul(s.createTime)}),rt.resolve();var s}getNamedQuery(e,n){return rt.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,{name:(s=n).name,query:Dre(s.bundledQuery),readTime:ul(s.readTime)}),rt.resolve();var s}}class Ege{constructor(){this.overlays=new Gs(kn.comparator),this.hr=new Map}getOverlay(e,n){return rt.resolve(this.overlays.get(n))}getOverlays(e,n){const r=iv();return rt.forEach(n,s=>this.getOverlay(e,s).next(c=>{null!==c&&r.set(s,c)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,c)=>{this.ht(e,n,c)}),rt.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.hr.get(r);return void 0!==s&&(s.forEach(c=>this.overlays=this.overlays.remove(c)),this.hr.delete(r)),rt.resolve()}getOverlaysForCollection(e,n,r){const s=iv(),c=n.length+1,f=new kn(n.child("")),v=this.overlays.getIteratorFrom(f);for(;v.hasNext();){const b=v.getNext().value,S=b.getKey();if(!n.isPrefixOf(S.path))break;S.path.length===c&&b.largestBatchId>r&&s.set(b.getKey(),b)}return rt.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let c=new Gs((S,k)=>S-k);const f=this.overlays.getIterator();for(;f.hasNext();){const S=f.getNext().value;if(S.getKey().getCollectionGroup()===n&&S.largestBatchId>r){let k=c.get(S.largestBatchId);null===k&&(k=iv(),c=c.insert(S.largestBatchId,k)),k.set(S.getKey(),S)}}const v=iv(),b=c.getIterator();for(;b.hasNext()&&(b.getNext().value.forEach((S,k)=>v.set(S,k)),!(v.size()>=s)););return rt.resolve(v)}ht(e,n,r){const s=this.overlays.get(r.key);if(null!==s){const f=this.hr.get(s.largestBatchId).delete(r.key);this.hr.set(s.largestBatchId,f)}this.overlays=this.overlays.insert(r.key,new bre(n,r));let c=this.hr.get(n);void 0===c&&(c=Ii(),this.hr.set(n,c)),this.hr.set(n,c.add(r.key))}}class Lre{constructor(){this.Pr=new Ss(jc.Ir),this.Tr=new Ss(jc.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){const r=new jc(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new jc(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){const n=new kn(new ro([])),r=new jc(n,e),s=new jc(n,e+1),c=[];return this.Tr.forEachInRange([r,s],f=>{this.Ar(f),c.push(f.key)}),c}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const n=new kn(new ro([])),r=new jc(n,e),s=new jc(n,e+1);let c=Ii();return this.Tr.forEachInRange([r,s],f=>{c=c.add(f.key)}),c}containsKey(e){const n=new jc(e,0),r=this.Pr.firstAfterOrEqual(n);return null!==r&&e.isEqual(r.key)}}class jc{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return kn.comparator(e.key,n.key)||ri(e.pr,n.pr)}static Er(e,n){return ri(e.pr,n.pr)||kn.comparator(e.key,n.key)}}class xge{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Ss(jc.Ir)}checkEmpty(e){return rt.resolve(0===this.mutationQueue.length)}addMutationBatch(e,n,r,s){const c=this.yr;this.yr++;const f=new vre(c,n,r,s);this.mutationQueue.push(f);for(const v of s)this.wr=this.wr.add(new jc(v.key,c)),this.indexManager.addToCollectionParentIndex(e,v.key.path.popLast());return rt.resolve(f)}lookupMutationBatch(e,n){return rt.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){const s=this.br(n+1),c=s<0?0:s;return rt.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return rt.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(e){return rt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new jc(n,0),s=new jc(n,Number.POSITIVE_INFINITY),c=[];return this.wr.forEachInRange([r,s],f=>{const v=this.Sr(f.pr);c.push(v)}),rt.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ss(ri);return n.forEach(s=>{const c=new jc(s,0),f=new jc(s,Number.POSITIVE_INFINITY);this.wr.forEachInRange([c,f],v=>{r=r.add(v.pr)})}),rt.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let c=r;kn.isDocumentKey(c)||(c=c.child(""));const f=new jc(new kn(c),0);let v=new Ss(ri);return this.wr.forEachWhile(b=>{const S=b.key.path;return!!r.isPrefixOf(S)&&(S.length===s&&(v=v.add(b.pr)),!0)},f),rt.resolve(this.Dr(v))}Dr(e){const n=[];return e.forEach(r=>{const s=this.Sr(r);null!==s&&n.push(s)}),n}removeMutationBatch(e,n){yr(0===this.Cr(n.batchId,"removed")),this.mutationQueue.shift();let r=this.wr;return rt.forEach(n.mutations,s=>{const c=new jc(s.key,n.batchId);return r=r.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){const r=new jc(n,0),s=this.wr.firstAfterOrEqual(r);return rt.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return rt.resolve()}Cr(e,n){return this.br(e)}br(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Sr(e){const n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class Tge{constructor(e){this.vr=e,this.docs=new Gs(kn.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),c=s?s.size:0,f=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:f}),this.size+=f-c,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return rt.resolve(r?r.document.mutableCopy():sa.newInvalidDocument(n))}getEntries(e,n){let r=kd();return n.forEach(s=>{const c=this.docs.get(s);r=r.insert(s,c?c.document.mutableCopy():sa.newInvalidDocument(s))}),rt.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let c=kd();const f=n.path,v=new kn(f.child("")),b=this.docs.getIteratorFrom(v);for(;b.hasNext();){const{key:S,value:{document:k}}=b.getNext();if(!f.isPrefixOf(S.path))break;S.path.length>f.length+1||ire(xce(k),r)<=0||(s.has(k.key)||j6(n,k))&&(c=c.insert(k.key,k.mutableCopy()))}return rt.resolve(c)}getAllFromCollectionGroup(e,n,r,s){tr()}Fr(e,n){return rt.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Cge(this)}getSize(e){return rt.resolve(this.size)}}class Cge extends yge{constructor(e){super(),this.ar=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.ar.addEntry(e,s)):this.ar.removeEntry(r)}),rt.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}}class Ige{constructor(e){this.persistence=e,this.Mr=new ob(n=>_P(n),U6),this.lastRemoteSnapshotVersion=br.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Lre,this.targetCount=0,this.Br=IP.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,s)=>n(s)),rt.resolve()}getLastRemoteSnapshotVersion(e){return rt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return rt.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),rt.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),rt.resolve()}qn(e){this.Mr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Br=new IP(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,rt.resolve()}updateTargetData(e,n){return this.qn(n),rt.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,rt.resolve()}removeTargets(e,n,r){let s=0;const c=[];return this.Mr.forEach((f,v)=>{v.sequenceNumber<=n&&null===r.get(v.targetId)&&(this.Mr.delete(f),c.push(this.removeMatchingKeysForTargetId(e,v.targetId)),s++)}),rt.waitFor(c).next(()=>s)}getTargetCount(e){return rt.resolve(this.targetCount)}getTargetData(e,n){const r=this.Mr.get(n)||null;return rt.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),rt.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);const s=this.persistence.referenceDelegate,c=[];return s&&n.forEach(f=>{c.push(s.markPotentiallyOrphaned(e,f))}),rt.waitFor(c)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),rt.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Nr.gr(n);return rt.resolve(r)}containsKey(e,n){return rt.resolve(this.Nr.containsKey(n))}}class Fre{constructor(e,n){this.Lr={},this.overlays={},this.kr=new Gp(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Ige(this),this.indexManager=new hge,this.remoteDocumentCache=new Tge(r=>this.referenceDelegate.Kr(r)),this.serializer=new que(n),this.$r=new bge(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Ege,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new xge(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){Yt("MemoryPersistence","Starting transaction:",e);const s=new Sge(this.kr.next());return this.referenceDelegate.Ur(),r(s).next(c=>this.referenceDelegate.Wr(s).next(()=>c)).toPromise().then(c=>(s.raiseOnCommittedEvent(),c))}Gr(e,n){return rt.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}}class Sge extends Yfe{constructor(e){super(),this.currentSequenceNumber=e}}class UW{constructor(e){this.persistence=e,this.zr=new Lre,this.jr=null}static Hr(e){return new UW(e)}get Jr(){if(this.jr)return this.jr;throw tr()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),rt.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),rt.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),rt.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(s=>this.Jr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(c=>this.Jr.add(c.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return rt.forEach(this.Jr,r=>{const s=kn.fromPath(r);return this.Yr(e,s).next(c=>{c||n.removeEntry(s,br.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return rt.or([()=>rt.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}}class zre{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=s}static Ki(e,n){let r=Ii(),s=Ii();for(const c of n.docChanges)switch(c.type){case 0:r=r.add(c.doc.key);break;case 1:s=s.add(c.doc.key)}return new zre(e,n.fromCache,r,s)}}class Dge{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class whe{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function vte(){return!function mte(){var t;const e=null===(t=Ep())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}()?8:lm.v(zs())>0?6:4}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,s){const c={result:null};return this.ji(e,n).next(f=>{c.result=f}).next(()=>{if(!c.result)return this.Hi(e,n,s,r).next(f=>{c.result=f})}).next(()=>{if(c.result)return;const f=new Dge;return this.Ji(e,n,f).next(v=>{if(c.result=v,this.Ui)return this.Yi(e,n,f,v.size)})}).next(()=>c.result)}Yi(e,n,r,s){return r.documentReadCount<this.Wi?(OL()<=o.DEBUG&&Yt("QueryEngine","SDK will not create cache indexes for query:",HL(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),rt.resolve()):(OL()<=o.DEBUG&&Yt("QueryEngine","Query:",HL(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Gi*s?(OL()<=o.DEBUG&&Yt("QueryEngine","The SDK decides to create cache indexes for query:",HL(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zh(n))):rt.resolve())}ji(e,n){if(nue(n))return rt.resolve(null);let r=zh(n);return this.indexManager.getIndexType(e,r).next(s=>0===s?null:(null!==n.limit&&1===s&&(n=AW(n,null,"F"),r=zh(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(c=>{const f=Ii(...c);return this.zi.getDocuments(e,f).next(v=>this.indexManager.getMinOffset(e,r).next(b=>{const S=this.Zi(n,v);return this.Xi(n,S,f,b.readTime)?this.ji(e,AW(n,null,"F")):this.es(e,S,n,b)}))})))}Hi(e,n,r,s){return nue(n)||s.isEqual(br.min())?rt.resolve(null):this.zi.getDocuments(e,r).next(c=>{const f=this.Zi(n,c);return this.Xi(n,f,r,s)?rt.resolve(null):(OL()<=o.DEBUG&&Yt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),HL(n)),this.es(e,f,n,function Ece(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=br.fromTimestamp(1e9===r?new Da(n+1,0):new Da(n,r));return new qp(s,kn.empty(),e)}(s,-1)).next(v=>v))})}Zi(e,n){let r=new Ss(sue(e));return n.forEach((s,c)=>{j6(e,c)&&(r=r.add(c))}),r}Xi(e,n,r,s){if(null===e.limit)return!1;if(r.size!==n.size)return!0;const c="F"===e.limitType?n.last():n.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(s)>0)}Ji(e,n,r){return OL()<=o.DEBUG&&Yt("QueryEngine","Using full collection scan to execute query:",HL(n)),this.zi.getDocumentsMatchingQuery(e,n,qp.min(),r)}es(e,n,r,s){return this.zi.getDocumentsMatchingQuery(e,r,s).next(c=>(n.forEach(f=>{c=c.insert(f.key,f)}),c))}}class Pge{constructor(e,n,r,s){this.persistence=e,this.ts=n,this.serializer=s,this.ns=new Gs(ri),this.rs=new ob(c=>_P(c),U6),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _he(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}}function Ehe(t,e){return jre.apply(this,arguments)}function jre(){return jre=Ze(function*(t,e){const n=Pn(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(c=>(s=c,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(c=>{const f=[],v=[];let b=Ii();for(const S of s){f.push(S.batchId);for(const k of S.mutations)b=b.add(k.key)}for(const S of c){v.push(S.batchId);for(const k of S.mutations)b=b.add(k.key)}return n.localDocuments.getDocuments(r,b).next(S=>({us:S,removedBatchIds:f,addedBatchIds:v}))})})}),jre.apply(this,arguments)}function xhe(t){const e=Pn(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function tF(t,e,n){return Hre.apply(this,arguments)}function Hre(){return Hre=Ze(function*(t,e,n){const r=Pn(t),s=r.ns.get(e),c=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",c,f=>r.persistence.referenceDelegate.removeTarget(f,s)))}catch(f){if(!iC(f))throw f;Yt("LocalStore",`Failed to update sequence numbers for target ${e}: ${f}`)}r.ns=r.ns.remove(e),r.rs.delete(s.target)}),Hre.apply(this,arguments)}function HW(t,e,n){const r=Pn(t);let s=br.min(),c=Ii();return r.persistence.runTransaction("Execute query","readwrite",f=>function(b,S,k){const F=Pn(b),H=F.rs.get(k);return void 0!==H?rt.resolve(F.ns.get(H)):F.Qr.getTargetData(S,k)}(r,f,zh(e)).next(v=>{if(v)return s=v.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(f,v.targetId).next(b=>{c=b})}).next(()=>r.ts.getDocumentsMatchingQuery(f,e,n?s:br.min(),n?c:Ii())).next(v=>(function She(t,e,n){let r=t.ss.get(e)||br.min();n.forEach((s,c)=>{c.readTime.compareTo(r)>0&&(r=c.readTime)}),t.ss.set(e,r)}(r,function oue(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}(e),v),{documents:v,hs:c})))}class Wre{constructor(){this.activeTargetIds=function gre(){return Ome}()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Phe{constructor(){this.no=new Wre,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Wre,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Lge{io(e){}shutdown(){}}class Rhe{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Yt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){Yt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let GW=null;function Zre(){return null===GW?GW=268435456+Math.round(2147483648*Math.random()):GW++,"0x"+GW.toString(16)}const Fge={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Vge{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}}const oh="WebChannelConnection";class Bge extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),c=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${s}/databases/${c}`,this.yo="(default)"===this.databaseId.database?`project_id=${s}`:`project_id=${s}&database_id=${c}`}get wo(){return!1}So(n,r,s,c,f){const v=Zre(),b=this.bo(n,r.toUriEncodedString());Yt("RestConnection",`Sending RPC '${n}' ${v}:`,b,s);const S={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(S,c,f),this.Co(n,b,S,s).then(k=>(Yt("RestConnection",`Received RPC '${n}' ${v}: `,k),k),k=>{throw $p("RestConnection",`RPC '${n}' ${v} failed with error: `,k,"url: ",b,"request:",s),k})}vo(n,r,s,c,f,v){return this.So(n,r,s,c,f)}Do(n,r,s){n["X-Goog-Api-Client"]="gl-js/ fire/"+kL,n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((c,f)=>n[f]=c),s&&s.headers.forEach((c,f)=>n[f]=c)}bo(n,r){return`${this.fo}/v1/${r}:${Fge[n]}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,s){const c=Zre();return new Promise((f,v)=>{const b=new Ffe;b.setWithCredentials(!0),b.listenOnce(Nfe.COMPLETE,()=>{try{switch(b.getLastErrorCode()){case tre.NO_ERROR:const k=b.getResponseJson();Yt(oh,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(k)),f(k);break;case tre.TIMEOUT:Yt(oh,`RPC '${e}' ${c} timed out`),v(new Zt(ft.DEADLINE_EXCEEDED,"Request time out"));break;case tre.HTTP_ERROR:const F=b.getStatus();if(Yt(oh,`RPC '${e}' ${c} failed with status:`,F,"response text:",b.getResponseText()),F>0){let H=b.getResponseJson();Array.isArray(H)&&(H=H[0]);const Q=H?.error;if(Q&&Q.status&&Q.message){const de=function(Ie){const Be=Ie.toLowerCase().replace(/_/g,"-");return Object.values(ft).indexOf(Be)>=0?Be:ft.UNKNOWN}(Q.status);v(new Zt(de,Q.message))}else v(new Zt(ft.UNKNOWN,"Server responded with status "+b.getStatus()))}else v(new Zt(ft.UNAVAILABLE,"Connection failed."));break;default:tr()}}finally{Yt(oh,`RPC '${e}' ${c} completed.`)}});const S=JSON.stringify(s);Yt(oh,`RPC '${e}' ${c} sending request:`,s),b.send(n,"POST",S,r,15)})}Fo(e,n,r){const s=Zre(),c=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],f=kfe(),v=Ofe(),b={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},S=this.longPollingOptions.timeoutSeconds;void 0!==S&&(b.longPollingTimeout=Math.round(1e3*S)),this.useFetchStreams&&(b.useFetchStreams=!0),this.Do(b.initMessageHeaders,n,r),b.encodeInitMessageHeaders=!0;const k=c.join("");Yt(oh,`Creating RPC '${e}' stream ${s}: ${k}`,b);const F=f.createWebChannel(k,b);let H=!1,Q=!1;const de=new Vge({lo:Ie=>{Q?Yt(oh,`Not sending because RPC '${e}' stream ${s} is closed:`,Ie):(H||(Yt(oh,`Opening RPC '${e}' stream ${s} transport.`),F.open(),H=!0),Yt(oh,`RPC '${e}' stream ${s} sending:`,Ie),F.send(Ie))},ho:()=>F.close()}),be=(Ie,Be,Fe)=>{Ie.listen(Be,tt=>{try{Fe(tt)}catch(mt){setTimeout(()=>{throw mt},0)}})};return be(F,yW.EventType.OPEN,()=>{Q||Yt(oh,`RPC '${e}' stream ${s} transport opened.`)}),be(F,yW.EventType.CLOSE,()=>{Q||(Q=!0,Yt(oh,`RPC '${e}' stream ${s} transport closed`),de.Vo())}),be(F,yW.EventType.ERROR,Ie=>{Q||(Q=!0,$p(oh,`RPC '${e}' stream ${s} transport errored:`,Ie),de.Vo(new Zt(ft.UNAVAILABLE,"The operation could not be completed")))}),be(F,yW.EventType.MESSAGE,Ie=>{var Be;if(!Q){const Fe=Ie.data[0];yr(!!Fe);const mt=Fe.error||(null===(Be=Fe[0])||void 0===Be?void 0:Be.error);if(mt){Yt(oh,`RPC '${e}' stream ${s} received error:`,mt);const Xt=mt.status;let bn=function(ys){const Ui=kl[ys];if(void 0!==Ui)return Tue(Ui)}(Xt),Or=mt.message;void 0===bn&&(bn=ft.INTERNAL,Or="Unknown error status: "+Xt+" with message "+mt.message),Q=!0,de.Vo(new Zt(bn,Or)),F.close()}else Yt(oh,`RPC '${e}' stream ${s} received:`,Fe),de.mo(Fe)}}),be(v,Lfe.STAT_EVENT,Ie=>{Ie.stat===gce.PROXY?Yt(oh,`RPC '${e}' stream ${s} detected buffering proxy`):Ie.stat===gce.NOPROXY&&Yt(oh,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{de.Ro()},0),de}}function KW(){return typeof document<"u"?document:null}function oj(t){return new Wme(t,!0)}class Qre{constructor(e,n,r=1e3,s=1.5,c=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=s,this.Oo=c,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();const n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),s=Math.max(0,n-r);s>0&&Yt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,s,()=>(this.Lo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class Uge{constructor(e,n,r,s,c,f,v,b){this.oi=e,this.$o=r,this.Uo=s,this.connection=c,this.authCredentialsProvider=f,this.appCheckCredentialsProvider=v,this.listener=b,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Qre(e,n)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}stop(){var e=this;return Ze(function*(){e.Ho()&&(yield e.close(0))})()}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){var e=this;return Ze(function*(){if(e.Jo())return e.close(0)})()}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){var r=this;return Ze(function*(){r.n_(),r.r_(),r.jo.cancel(),r.Wo++,4!==e?r.jo.reset():n&&n.code===ft.RESOURCE_EXHAUSTED?(cl(n.toString()),cl("Using maximum backoff delay to prevent overloading the backend."),r.jo.ko()):n&&n.code===ft.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.i_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.To(n)})()}i_(){}auth(){this.state=1;const e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Wo===n&&this.o_(r,s)},r=>{e(()=>{const s=new Zt(ft.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(s)})})}o_(e,n){const r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(s=>{r(()=>this.__(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Yo(){var e=this;this.state=5,this.jo.qo(Ze(function*(){e.state=0,e.start()}))}__(e){return Yt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(Yt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class zge extends Uge{constructor(e,n,r,s,c,f){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,f),this.serializer=c}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();const n=function Qme(t,e){let n;if("targetChange"in e){const r="NO_CHANGE"===(S=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===S?1:"REMOVE"===S?2:"CURRENT"===S?3:"RESET"===S?4:tr(),s=e.targetChange.targetIds||[],c=function(S,k){return S.useProto3Json?(yr(void 0===k||"string"==typeof k),fc.fromBase64String(k||"")):(yr(void 0===k||k instanceof Uint8Array),fc.fromUint8Array(k||new Uint8Array))}(t,e.targetChange.resumeToken),f=e.targetChange.cause,v=f&&function(S){const k=void 0===S.code?ft.UNKNOWN:Tue(S.code);return new Zt(k,S.message||"")}(f);n=new Due(r,s,c,v||null)}else if("documentChange"in e){const r=e.documentChange,s=ov(t,r.document.name),c=ul(r.document.updateTime),f=r.document.createTime?ul(r.document.createTime):br.min(),v=new yu({mapValue:{fields:r.document.fields}}),b=sa.newFoundDocument(s,c,f,v);n=new MW(r.targetIds||[],r.removedTargetIds||[],b.key,b)}else if("documentDelete"in e){const r=e.documentDelete,s=ov(t,r.document),c=r.readTime?ul(r.readTime):br.min(),f=sa.newNoDocument(s,c);n=new MW([],r.removedTargetIds||[],f.key,f)}else if("documentRemove"in e){const r=e.documentRemove,s=ov(t,r.document);n=new MW([],r.removedTargetIds||[],s,null)}else{if(!("filter"in e))return tr();{const r=e.filter,{count:s=0,unchangedNames:c}=r,f=new jme(s,c);n=new Aue(r.targetId,f)}}var S;return n}(this.serializer,e),r=function(c){if(!("targetChange"in c))return br.min();const f=c.targetChange;return f.targetIds&&f.targetIds.length?br.min():f.readTime?ul(f.readTime):br.min()}(e);return this.listener.u_(n,r)}c_(e){const n={};n.database=Ire(this.serializer),n.addTarget=function(c,f){let v;const b=f.target;if(v=IW(b)?{documents:Uue(c,b)}:{query:Are(c,b).ut},v.targetId=f.targetId,f.resumeToken.approximateByteSize()>0){v.resumeToken=function kue(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}(c,f.resumeToken);const S=xre(c,f.expectedCount);null!==S&&(v.expectedCount=S)}else if(f.snapshotVersion.compareTo(br.min())>0){v.readTime=function WL(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}(c,f.snapshotVersion.toTimestamp());const S=xre(c,f.expectedCount);null!==S&&(v.expectedCount=S)}return v}(this.serializer,e);const r=function Jme(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return tr()}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);r&&(n.labels=r),this.t_(n)}l_(e){const n={};n.database=Ire(this.serializer),n.removeTarget=e,this.t_(n)}}class Hge extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.A_=!1}R_(){if(this.A_)throw new Zt(ft.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,f])=>this.connection.So(e,Cre(n,r),s,c,f)).catch(c=>{throw"FirebaseError"===c.name?(c.code===ft.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Zt(ft.UNKNOWN,c.toString())})}vo(e,n,r,s,c){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([f,v])=>this.connection.vo(e,Cre(n,r),s,f,v,c)).catch(f=>{throw"FirebaseError"===f.name?(f.code===ft.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),f):new Zt(ft.UNKNOWN,f.toString())})}terminate(){this.A_=!0,this.connection.terminate()}}class qge{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,"Online"===e&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){const n=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(cl(n),this.g_=!1):Yt("OnlineStateTracker",n)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class Gge{constructor(e,n,r,s,c){var f=this;this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=c,this.M_.io(v=>{r.enqueueAndForget(Ze(function*(){var b;mC(f)&&(Yt("RemoteStore","Restarting streams for network reachability change."),yield(b=Ze(function*(k){const F=Pn(k);F.v_.add(4),yield nF(F),F.x_.set("Unknown"),F.v_.delete(4),yield sj(F)}),function S(k){return b.apply(this,arguments)})(f))}))}),this.x_=new qge(r,s)}}function sj(t){return Jre.apply(this,arguments)}function Jre(){return Jre=Ze(function*(t){if(mC(t))for(const e of t.F_)yield e(!0)}),Jre.apply(this,arguments)}function nF(t){return eie.apply(this,arguments)}function eie(){return eie=Ze(function*(t){for(const e of t.F_)yield e(!1)}),eie.apply(this,arguments)}function WW(t,e){const n=Pn(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),rie(n)?nie(n):iF(n).Jo()&&tie(n,e))}function aj(t,e){const n=Pn(t),r=iF(n);n.C_.delete(e),r.Jo()&&khe(n,e),0===n.C_.size&&(r.Jo()?r.Xo():mC(n)&&n.x_.set("Unknown"))}function tie(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(br.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}iF(t).c_(e)}function khe(t,e){t.O_.Oe(e),iF(t).l_(e)}function nie(t){t.O_=new $me({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),iF(t).start(),t.x_.p_()}function rie(t){return mC(t)&&!iF(t).Ho()&&t.C_.size>0}function mC(t){return 0===Pn(t).v_.size}function Ohe(t){t.O_=void 0}function Kge(t){return iie.apply(this,arguments)}function iie(){return iie=Ze(function*(t){t.C_.forEach((e,n)=>{tie(t,e)})}),iie.apply(this,arguments)}function Wge(t,e){return oie.apply(this,arguments)}function oie(){return oie=Ze(function*(t,e){Ohe(t),rie(t)?(t.x_.S_(e),nie(t)):t.x_.set("Unknown")}),oie.apply(this,arguments)}function Yge(t,e,n){return sie.apply(this,arguments)}function sie(){return sie=Ze(function*(t,e,n){if(t.x_.set("Online"),e instanceof Due&&2===e.state&&e.cause)try{yield(r=Ze(function*(c,f){const v=f.cause;for(const b of f.targetIds)c.C_.has(b)&&(yield c.remoteSyncer.rejectListen(b,v),c.C_.delete(b),c.O_.removeTarget(b))}),function s(c,f){return r.apply(this,arguments)})(t,e)}catch(r){Yt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield YW(t,r)}else if(e instanceof MW?t.O_.$e(e):e instanceof Aue?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(br.min()))try{const r=yield xhe(t.localStore);n.compareTo(r)>=0&&(yield function(c,f){const v=c.O_.it(f);return v.targetChanges.forEach((b,S)=>{if(b.resumeToken.approximateByteSize()>0){const k=c.C_.get(S);k&&c.C_.set(S,k.withResumeToken(b.resumeToken,f))}}),v.targetMismatches.forEach((b,S)=>{const k=c.C_.get(b);if(!k)return;c.C_.set(b,k.withResumeToken(fc.EMPTY_BYTE_STRING,k.snapshotVersion)),khe(c,b);const F=new ab(k.target,b,S,k.sequenceNumber);tie(c,F)}),c.remoteSyncer.applyRemoteEvent(v)}(t,n))}catch(r){Yt("RemoteStore","Failed to raise snapshot:",r),yield YW(t,r)}var r}),sie.apply(this,arguments)}function YW(t,e,n){return aie.apply(this,arguments)}function aie(){return aie=Ze(function*(t,e,n){if(!iC(e))throw e;t.v_.add(1),yield nF(t),t.x_.set("Offline"),n||(n=()=>xhe(t.localStore)),t.asyncQueue.enqueueRetryable(Ze(function*(){Yt("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield sj(t)}))}),aie.apply(this,arguments)}function Vhe(t,e){return pie.apply(this,arguments)}function pie(){return pie=Ze(function*(t,e){const n=Pn(t);n.asyncQueue.verifyOperationInProgress(),Yt("RemoteStore","RemoteStore received new credentials");const r=mC(n);n.v_.add(3),yield nF(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield sj(n)}),pie.apply(this,arguments)}function mie(){return mie=Ze(function*(t,e){const n=Pn(t);e?(n.v_.delete(2),yield sj(n)):e||(n.v_.add(2),yield nF(n),n.x_.set("Unknown"))}),mie.apply(this,arguments)}function iF(t){return t.N_||(t.N_=function(n,r,s){const c=Pn(n);return c.R_(),new zge(r,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,s)}(t.datastore,t.asyncQueue,{Po:Kge.bind(null,t),To:Wge.bind(null,t),u_:Yge.bind(null,t)}),t.F_.push(function(){var e=Ze(function*(n){n?(t.N_.Zo(),rie(t)?nie(t):t.x_.set("Unknown")):(yield t.N_.stop(),Ohe(t))});return function(n){return e.apply(this,arguments)}}())),t.N_}class gie{constructor(e,n,r,s,c){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=c,this.deferred=new pc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(f=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,c){const f=Date.now()+r,v=new gie(e,n,f,s,c);return v.start(r),v}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Zt(ft.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function oF(t,e){if(cl("AsyncQueue",`${e}: ${t}`),iC(t))return new Zt(ft.UNAVAILABLE,`${e}: ${t}`);throw t}class sF{constructor(e){this.comparator=e?(n,r)=>e(n,r)||kn.comparator(n.key,r.key):(n,r)=>kn.comparator(n.key,r.key),this.keyedMap=H6(),this.sortedSet=new Gs(this.comparator)}static emptySet(e){return new sF(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof sF)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,c=r.getNext().key;if(!s.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,n){const r=new sF;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class Bhe{constructor(){this.L_=new Gs(kn.comparator)}track(e){const n=e.doc.key,r=this.L_.get(n);r?0!==e.type&&3===r.type?this.L_=this.L_.insert(n,e):3===e.type&&1!==r.type?this.L_=this.L_.insert(n,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.L_=this.L_.insert(n,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.L_=this.L_.remove(n):1===e.type&&2===r.type?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):tr():this.L_=this.L_.insert(n,e)}k_(){const e=[];return this.L_.inorderTraversal((n,r)=>{e.push(r)}),e}}class aF{constructor(e,n,r,s,c,f,v,b,S){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=c,this.fromCache=f,this.syncStateChanged=v,this.excludesMetadataChanges=b,this.hasCachedResults=S}static fromInitialDocuments(e,n,r,s,c){const f=[];return n.forEach(v=>{f.push({type:0,doc:v})}),new aF(e,n,sF.emptySet(n),f,r,s,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&z6(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}class nye{constructor(){this.q_=void 0,this.Q_=[]}}class rye{constructor(){this.queries=new ob(e=>iue(e),z6),this.onlineState="Unknown",this.K_=new Set}}function _ie(){return _ie=Ze(function*(t,e){const n=Pn(t),r=e.query;let s=!1,c=n.queries.get(r);if(c||(s=!0,c=new nye),s)try{c.q_=yield n.onListen(r)}catch(f){const v=oF(f,`Initialization of query '${HL(e.query)}' failed`);return void e.onError(v)}n.queries.set(r,c),c.Q_.push(e),e.U_(n.onlineState),c.q_&&e.W_(c.q_)&&bie(n)}),_ie.apply(this,arguments)}function wie(){return wie=Ze(function*(t,e){const n=Pn(t),r=e.query;let s=!1;const c=n.queries.get(r);if(c){const f=c.Q_.indexOf(e);f>=0&&(c.Q_.splice(f,1),s=0===c.Q_.length)}if(s)return n.queries.delete(r),n.onUnlisten(r)}),wie.apply(this,arguments)}function iye(t,e){const n=Pn(t);let r=!1;for(const s of e){const f=n.queries.get(s.query);if(f){for(const v of f.Q_)v.W_(s)&&(r=!0);f.q_=s}}r&&bie(n)}function oye(t,e,n){const r=Pn(t),s=r.queries.get(e);if(s)for(const c of s.Q_)c.onError(n);r.queries.delete(e)}function bie(t){t.K_.forEach(e=>{e.next()})}class Eie{constructor(e,n,r){this.query=e,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)3!==s.type&&r.push(s);e=new aF(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.z_?this.H_(e)&&(this.G_.next(e),n=!0):this.J_(e,this.onlineState)&&(this.Y_(e),n=!0),this.j_=e,n}onError(e){this.G_.error(e)}U_(e){this.onlineState=e;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,e)&&(this.Y_(this.j_),n=!0),n}J_(e,n){return!e.fromCache||(!this.options.Z_||!("Offline"!==n))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===n)}H_(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.j_&&this.j_.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Y_(e){e=aF.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.z_=!0,this.G_.next(e)}}class jhe{constructor(e){this.key=e}}class Hhe{constructor(e){this.key=e}}class $he{constructor(e,n){this.query=e,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=Ii(),this.mutatedKeys=Ii(),this.ua=sue(e),this.ca=new sF(this.ua)}get la(){return this.oa}ha(e,n){const r=n?n.Pa:new Bhe,s=n?n.ca:this.ca;let c=n?n.mutatedKeys:this.mutatedKeys,f=s,v=!1;const b="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,S="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((k,F)=>{const H=s.get(k),Q=j6(this.query,F)?F:null,de=!!H&&this.mutatedKeys.has(H.key),be=!!Q&&(Q.hasLocalMutations||this.mutatedKeys.has(Q.key)&&Q.hasCommittedMutations);let Ie=!1;H&&Q?H.data.isEqual(Q.data)?de!==be&&(r.track({type:3,doc:Q}),Ie=!0):this.Ia(H,Q)||(r.track({type:2,doc:Q}),Ie=!0,(b&&this.ua(Q,b)>0||S&&this.ua(Q,S)<0)&&(v=!0)):!H&&Q?(r.track({type:0,doc:Q}),Ie=!0):H&&!Q&&(r.track({type:1,doc:H}),Ie=!0,(b||S)&&(v=!0)),Ie&&(Q?(f=f.add(Q),c=be?c.add(k):c.delete(k)):(f=f.delete(k),c=c.delete(k)))}),null!==this.query.limit)for(;f.size>this.query.limit;){const k="F"===this.query.limitType?f.last():f.first();f=f.delete(k.key),c=c.delete(k.key),r.track({type:1,doc:k})}return{ca:f,Pa:r,Xi:v,mutatedKeys:c}}Ia(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const c=this.ca;this.ca=e.ca,this.mutatedKeys=e.mutatedKeys;const f=e.Pa.k_();f.sort((k,F)=>function(Q,de){const be=Ie=>{switch(Ie){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return tr()}};return be(Q)-be(de)}(k.type,F.type)||this.ua(k.doc,F.doc)),this.Ta(r),s=null!=s&&s;const v=n&&!s?this.Ea():[],b=0===this.aa.size&&this.current&&!s?1:0,S=b!==this._a;return this._a=b,0!==f.length||S?{snapshot:new aF(this.query,e.ca,c,f,e.mutatedKeys,0===b,S,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:v}:{da:v}}U_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new Bhe,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(e){return!this.oa.has(e)&&!!this.ca.has(e)&&!this.ca.get(e).hasLocalMutations}Ta(e){e&&(e.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=e.current)}Ea(){if(!this.current)return[];const e=this.aa;this.aa=Ii(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});const n=[];return e.forEach(r=>{this.aa.has(r)||n.push(new Hhe(r))}),this.aa.forEach(r=>{e.has(r)||n.push(new jhe(r))}),n}Ra(e){this.oa=e.hs,this.aa=Ii();const n=this.ha(e.documents);return this.applyChanges(n,!0)}Va(){return aF.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,0===this._a,this.hasCachedResults)}}class lye{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class cye{constructor(e){this.key=e,this.ma=!1}}class uye{constructor(e,n,r,s,c,f){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=c,this.maxConcurrentLimboResolutions=f,this.fa={},this.ga=new ob(v=>iue(v),z6),this.pa=new Map,this.ya=new Set,this.wa=new Gs(kn.comparator),this.Sa=new Map,this.ba=new Lre,this.Da={},this.Ca=new Map,this.va=IP.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}function hye(t,e){return xie.apply(this,arguments)}function xie(){return xie=Ze(function*(t,e){const n=function Gie(t){const e=Pn(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=qhe.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=wye.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=fye.bind(null,e),e.fa.u_=iye.bind(null,e.eventManager),e.fa.xa=oye.bind(null,e.eventManager),e}(t);let r,s;const c=n.ga.get(e);if(c)r=c.targetId,n.sharedClientState.addLocalQueryTarget(r),s=c.view.Va();else{const f=yield function eF(t,e){const n=Pn(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Qr.getTargetData(r,e).next(c=>c?(s=c,rt.resolve(s)):n.Qr.allocateTargetId(r).next(f=>(s=new ab(e,f,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.ns.get(r.targetId);return(null===s||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}(n.localStore,zh(e)),v=n.sharedClientState.addLocalQueryTarget(f.targetId);r=f.targetId,s=yield function Tie(t,e,n,r,s){return Cie.apply(this,arguments)}(n,e,r,"current"===v,f.resumeToken),n.isPrimaryClient&&WW(n.remoteStore,f)}return s}),xie.apply(this,arguments)}function Cie(){return Cie=Ze(function*(t,e,n,r,s){t.Ma=(F,H,Q)=>{return(de=Ze(function*(Ie,Be,Fe,tt){let mt=Be.view.ha(Fe);mt.Xi&&(mt=yield HW(Ie.localStore,Be.query,!1).then(({documents:Bi})=>Be.view.ha(Bi,mt)));const Xt=tt&&tt.targetChanges.get(Be.targetId),bn=tt&&null!=tt.targetMismatches.get(Be.targetId),Or=Be.view.applyChanges(mt,Ie.isPrimaryClient,Xt,bn);return Nie(Ie,Be.targetId,Or.da),Or.snapshot}),function be(Ie,Be,Fe,tt){return de.apply(this,arguments)})(t,F,H,Q);var de};const c=yield HW(t.localStore,e,!0),f=new $he(e,c.hs),v=f.ha(c.documents),b=Y6.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState,s),S=f.applyChanges(v,t.isPrimaryClient,b);Nie(t,n,S.da);const k=new lye(e,n,f);return t.ga.set(e,k),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),S.snapshot}),Cie.apply(this,arguments)}function dye(t,e){return Iie.apply(this,arguments)}function Iie(){return Iie=Ze(function*(t,e){const n=Pn(t),r=n.ga.get(e),s=n.pa.get(r.targetId);if(s.length>1)return n.pa.set(r.targetId,s.filter(c=>!z6(c,e))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield tF(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),aj(n.remoteStore,r.targetId),lF(n,r.targetId)}).catch(rC))):(lF(n,r.targetId),yield tF(n.localStore,r.targetId,!0))}),Iie.apply(this,arguments)}function qhe(t,e){return Aie.apply(this,arguments)}function Aie(){return Aie=Ze(function*(t,e){const n=Pn(t);try{const r=yield function Mge(t,e){const n=Pn(t),r=e.snapshotVersion;let s=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const f=n.os.newChangeBuffer({trackRemovals:!0});s=n.ns;const v=[];e.targetChanges.forEach((k,F)=>{const H=s.get(F);if(!H)return;v.push(n.Qr.removeMatchingKeys(c,k.removedDocuments,F).next(()=>n.Qr.addMatchingKeys(c,k.addedDocuments,F)));let Q=H.withSequenceNumber(c.currentSequenceNumber);var be,Ie,Be;null!==e.targetMismatches.get(F)?Q=Q.withResumeToken(fc.EMPTY_BYTE_STRING,br.min()).withLastLimboFreeSnapshotVersion(br.min()):k.resumeToken.approximateByteSize()>0&&(Q=Q.withResumeToken(k.resumeToken,r)),s=s.insert(F,Q),Ie=Q,Be=k,(0===(be=H).resumeToken.approximateByteSize()||Ie.snapshotVersion.toMicroseconds()-be.snapshotVersion.toMicroseconds()>=3e8||Be.addedDocuments.size+Be.modifiedDocuments.size+Be.removedDocuments.size>0)&&v.push(n.Qr.updateTargetData(c,Q))});let b=kd(),S=Ii();if(e.documentUpdates.forEach(k=>{e.resolvedLimboDocuments.has(k)&&v.push(n.persistence.referenceDelegate.updateLimboDocument(c,k))}),v.push(function The(t,e,n){let r=Ii(),s=Ii();return n.forEach(c=>r=r.add(c)),e.getEntries(t,r).next(c=>{let f=kd();return n.forEach((v,b)=>{const S=c.get(v);b.isFoundDocument()!==S.isFoundDocument()&&(s=s.add(v)),b.isNoDocument()&&b.version.isEqual(br.min())?(e.removeEntry(v,b.readTime),f=f.insert(v,b)):!S.isValidDocument()||b.version.compareTo(S.version)>0||0===b.version.compareTo(S.version)&&S.hasPendingWrites?(e.addEntry(b),f=f.insert(v,b)):Yt("LocalStore","Ignoring outdated watch update for ",v,". Current version:",S.version," Watch version:",b.version)}),{cs:f,ls:s}})}(c,f,e.documentUpdates).next(k=>{b=k.cs,S=k.ls})),!r.isEqual(br.min())){const k=n.Qr.getLastRemoteSnapshotVersion(c).next(F=>n.Qr.setTargetsMetadata(c,c.currentSequenceNumber,r));v.push(k)}return rt.waitFor(v).next(()=>f.apply(c)).next(()=>n.localDocuments.getLocalViewOfDocuments(c,b,S)).next(()=>b)}).then(c=>(n.ns=s,c))}(n.localStore,e);e.targetChanges.forEach((s,c)=>{const f=n.Sa.get(c);f&&(yr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?f.ma=!0:s.modifiedDocuments.size>0?yr(f.ma):s.removedDocuments.size>0&&(yr(f.ma),f.ma=!1))}),yield lb(n,r,e)}catch(r){yield rC(r)}}),Aie.apply(this,arguments)}function Ghe(t,e,n){const r=Pn(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const s=[];r.ga.forEach((c,f)=>{const v=f.view.U_(e);v.snapshot&&s.push(v.snapshot)}),function(f,v){const b=Pn(f);b.onlineState=v;let S=!1;b.queries.forEach((k,F)=>{for(const H of F.Q_)H.U_(v)&&(S=!0)}),S&&bie(b)}(r.eventManager,e),s.length&&r.fa.u_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function fye(t,e,n){return Die.apply(this,arguments)}function Die(){return Die=Ze(function*(t,e,n){const r=Pn(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Sa.get(e),c=s&&s.key;if(c){let f=new Gs(kn.comparator);f=f.insert(c,sa.newNoDocument(c,br.min()));const v=Ii().add(c),b=new W6(br.min(),new Map,new Gs(ri),f,v);yield qhe(r,b),r.wa=r.wa.remove(c),r.Sa.delete(e),Lie(r)}else yield tF(r.localStore,e,!1).then(()=>lF(r,e,n)).catch(rC)}),Die.apply(this,arguments)}function lF(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.pa.get(e))t.ga.delete(r),n&&t.fa.xa(r,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach(r=>{t.ba.containsKey(r)||Khe(t,r)})}function Khe(t,e){t.ya.delete(e.path.canonicalString());const n=t.wa.get(e);null!==n&&(aj(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),Lie(t))}function Nie(t,e,n){for(const r of n)r instanceof jhe?(t.ba.addReference(r.key,e),_ye(t,r)):r instanceof Hhe?(Yt("SyncEngine","Document no longer in limbo: "+r.key),t.ba.removeReference(r.key,e),t.ba.containsKey(r.key)||Khe(t,r.key)):tr()}function _ye(t,e){const n=e.key,r=n.path.canonicalString();t.wa.get(n)||t.ya.has(r)||(Yt("SyncEngine","New document in limbo: "+n),t.ya.add(r),Lie(t))}function Lie(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){const e=t.ya.values().next().value;t.ya.delete(e);const n=new kn(ro.fromString(e)),r=t.va.next();t.Sa.set(r,new cye(n)),t.wa=t.wa.insert(n,r),WW(t.remoteStore,new ab(zh(zL(n.path)),r,"TargetPurposeLimboResolution",Gp._e))}}function lb(t,e,n){return Fie.apply(this,arguments)}function Fie(){return Fie=Ze(function*(t,e,n){const r=Pn(t),s=[],c=[],f=[];var v;r.ga.isEmpty()||(r.ga.forEach((v,b)=>{f.push(r.Ma(b,e,n).then(S=>{if((S||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(b.targetId,S?.fromCache?"not-current":"current"),S){s.push(S);const k=zre.Ki(b.targetId,S);c.push(k)}}))}),yield Promise.all(f),r.fa.u_(s),yield(v=Ze(function*(S,k){const F=Pn(S);try{yield F.persistence.runTransaction("notifyLocalViewChanges","readwrite",H=>rt.forEach(k,Q=>rt.forEach(Q.qi,de=>F.persistence.referenceDelegate.addReference(H,Q.targetId,de)).next(()=>rt.forEach(Q.Qi,de=>F.persistence.referenceDelegate.removeReference(H,Q.targetId,de)))))}catch(H){if(!iC(H))throw H;Yt("LocalStore","Failed to update sequence numbers: "+H)}for(const H of k){const Q=H.targetId;if(!H.fromCache){const de=F.ns.get(Q),Ie=de.withLastLimboFreeSnapshotVersion(de.snapshotVersion);F.ns=F.ns.insert(Q,Ie)}}}),function b(S,k){return v.apply(this,arguments)})(r.localStore,c))}),Fie.apply(this,arguments)}function vye(t,e){return Vie.apply(this,arguments)}function Vie(){return Vie=Ze(function*(t,e){const n=Pn(t);if(!n.currentUser.isEqual(e)){Yt("SyncEngine","User change. New user:",e.toKey());const r=yield Ehe(n.localStore,e);n.currentUser=e,(c=n).Ca.forEach(v=>{v.forEach(b=>{b.reject(new Zt(ft.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),c.Ca.clear(),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield lb(n,r.us)}var c}),Vie.apply(this,arguments)}function wye(t,e){const n=Pn(t),r=n.Sa.get(e);if(r&&r.ma)return Ii().add(r.key);{let s=Ii();const c=n.pa.get(e);if(!c)return s;for(const f of c){const v=n.ga.get(f);s=s.unionWith(v.view.la)}return s}}class ZW{constructor(){this.synchronizeTabs=!1}initialize(e){var n=this;return Ze(function*(){n.serializer=oj(e.databaseInfo.databaseId),n.sharedClientState=n.createSharedClientState(e),n.persistence=n.createPersistence(e),yield n.persistence.start(),n.localStore=n.createLocalStore(e),n.gcScheduler=n.createGarbageCollectionScheduler(e,n.localStore),n.indexBackfillerScheduler=n.createIndexBackfillerScheduler(e,n.localStore)})()}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return function bhe(t,e,n,r){return new Pge(t,e,n,r)}(this.persistence,new whe,e.initialUser,this.serializer)}createPersistence(e){return new Fre(UW.Hr,this.serializer)}createSharedClientState(e){return new Phe}terminate(){var e=this;return Ze(function*(){var n,r;null===(n=e.gcScheduler)||void 0===n||n.stop(),null===(r=e.indexBackfillerScheduler)||void 0===r||r.stop(),e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class cF{initialize(e,n){var r=this;return Ze(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=s=>Ghe(r.syncEngine,s,1),r.remoteStore.remoteSyncer.handleCredentialChange=vye.bind(null,r.syncEngine),yield function fie(t,e){return mie.apply(this,arguments)}(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new rye}createDatastore(e){const n=oj(e.databaseInfo.databaseId),r=new Bge(e.databaseInfo);return new Hge(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return r=this.localStore,s=this.datastore,c=e.asyncQueue,f=n=>Ghe(this.syncEngine,n,0),v=Rhe.D()?new Rhe:new Lge,new Gge(r,s,c,f,v);var r,s,c,f,v}createSyncEngine(e,n){return function(s,c,f,v,b,S,k){const F=new uye(s,c,f,v,b,S);return k&&(F.Fa=!0),F}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){var e=this;return Ze(function*(){var n,r;yield(r=Ze(function*(c){const f=Pn(c);Yt("RemoteStore","RemoteStore shutting down."),f.v_.add(5),yield nF(f),f.M_.shutdown(),f.x_.set("Unknown")}),function s(c){return r.apply(this,arguments)})(e.remoteStore),null===(n=e.datastore)||void 0===n||n.terminate()})()}}class QW{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ba(this.observer.next,e)}error(e){this.observer.error?this.Ba(this.observer.error,e):cl("Uncaught Error in snapshot listener:",e.toString())}La(){this.muted=!0}Ba(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}class kye{constructor(e,n,r,s){var c=this;this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Uc.UNAUTHENTICATED,this.clientId=wce.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var f=Ze(function*(v){Yt("FirestoreClient","Received user=",v.uid),yield c.authCredentialListener(v),c.user=v});return function(v){return f.apply(this,arguments)}}()),this.appCheckCredentials.start(r,f=>(Yt("FirestoreClient","Received new app check token=",f),this.appCheckCredentialListener(f,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Zt(ft.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const n=new pc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(Ze(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),n.resolve()}catch(r){const s=oF(r,"Failed to shutdown persistence");n.reject(s)}})),n.promise}}function XW(t,e){return Wie.apply(this,arguments)}function Wie(){return Wie=Ze(function*(t,e){t.asyncQueue.verifyOperationInProgress(),Yt("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(function(){var s=Ze(function*(c){r.isEqual(c)||(yield Ehe(e.localStore,c),r=c)});return function(c){return s.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}),Wie.apply(this,arguments)}function Yie(t,e){return Zie.apply(this,arguments)}function Zie(){return Zie=Ze(function*(t,e){t.asyncQueue.verifyOperationInProgress();const n=yield function Qie(t){return Xie.apply(this,arguments)}(t);Yt("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Vhe(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Vhe(e.remoteStore,s)),t._onlineComponents=e}),Zie.apply(this,arguments)}function Xie(){return Xie=Ze(function*(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Yt("FirestoreClient","Using user provided OfflineComponentProvider");try{yield XW(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function Jhe(t){return"FirebaseError"===t.name?t.code===ft.FAILED_PRECONDITION||t.code===ft.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;$p("Error using user provided cache. Falling back to memory cache: "+n),yield XW(t,new ZW)}}else Yt("FirestoreClient","Using default OfflineComponentProvider"),yield XW(t,new ZW);return t._offlineComponents}),Xie.apply(this,arguments)}function Jie(){return Jie=Ze(function*(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Yt("FirestoreClient","Using user provided OnlineComponentProvider"),yield Yie(t,t._uninitializedComponentsProvider._online)):(Yt("FirestoreClient","Using default OnlineComponentProvider"),yield Yie(t,new cF))),t._onlineComponents}),Jie.apply(this,arguments)}function toe(){return toe=Ze(function*(t){const e=yield function JW(t){return Jie.apply(this,arguments)}(t),n=e.eventManager;return n.onListen=hye.bind(null,e.syncEngine),n.onUnlisten=dye.bind(null,e.syncEngine),n}),toe.apply(this,arguments)}function rde(t,e,n={}){const r=new pc;return t.asyncQueue.enqueueAndForget(Ze(function*(){return function(c,f,v,b,S){const k=new QW({next:H=>{f.enqueueAndForget(()=>function vie(t,e){return wie.apply(this,arguments)}(c,F));const Q=H.docs.has(v);!Q&&H.fromCache?S.reject(new Zt(ft.UNAVAILABLE,"Failed to get document because the client is offline.")):Q&&H.fromCache&&b&&"server"===b.source?S.reject(new Zt(ft.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):S.resolve(H)},error:H=>S.reject(H)}),F=new Eie(zL(v.path),k,{includeMetadataChanges:!0,Z_:!0});return function yie(t,e){return _ie.apply(this,arguments)}(c,F)}(yield function hF(t){return toe.apply(this,arguments)}(t),t.asyncQueue,e,n,r)})),r.promise}function ode(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const sde=new Map;function ade(t){if(!kn.isDocumentKey(t))throw new Zt(ft.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function oo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Zt(ft.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function eY(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=(r=t).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof t?"a function":tr()}(t);throw new Zt(ft.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class ude{constructor(e){var n,r;if(void 0===e.host){if(void 0!==e.ssl)throw new Zt(ft.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(n=e.ssl)||void 0===n||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Zt(ft.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function $ye(t,e,n,r){if(!0===e&&!0===r)throw new Zt(ft.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=ode(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(c){if(void 0!==c.timeoutSeconds){if(isNaN(c.timeoutSeconds))throw new Zt(ft.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new Zt(ft.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new Zt(ft.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class lj{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ude({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Zt(ft.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Zt(ft.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ude(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new Bfe;switch(r.type){case"firstParty":return new Hfe(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Zt(ft.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=sde.get(n);r&&(Yt("ComponentProvider","Removing Datastore"),sde.delete(n),r.terminate())}(this),Promise.resolve()}}class _u{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new _u(this.firestore,e,this._query)}}class hl{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new sv(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hl(this.firestore,e,this._key)}}class sv extends _u{constructor(e,n,r){super(e,n,zL(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hl(this.firestore,null,new kn(e))}withConverter(e){return new sv(this.firestore,e,this._path)}}function hde(t,e,...n){if(t=xp(t),1===arguments.length&&(e=wce.newId()),function noe(t,e,n){if(!n)throw new Zt(ft.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}("doc","path",e),t instanceof lj){const r=ro.fromString(e,...n);return ade(r),new hl(t,null,new kn(r))}{if(!(t instanceof hl||t instanceof sv))throw new Zt(ft.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ro.fromString(e,...n));return ade(r),new hl(t.firestore,t instanceof sv?t.converter:null,new kn(r))}}class Gye{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new Qre(this,"async_queue_retry"),this._u=()=>{const n=KW();n&&Yt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};const e=KW();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;const n=KW();n&&"function"==typeof n.removeEventListener&&n.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise(()=>{});const n=new pc;return this.uu(()=>this.tu&&this.su?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.eu.push(e),this.cu()))}cu(){var e=this;return Ze(function*(){if(0!==e.eu.length){try{yield e.eu[0](),e.eu.shift(),e.jo.reset()}catch(n){if(!iC(n))throw n;Yt("AsyncQueue","Operation failed with retryable error: "+n)}e.eu.length>0&&e.jo.qo(()=>e.cu())}})()}uu(e){const n=this.Xa.then(()=>(this.iu=!0,e().catch(r=>{throw this.ru=r,this.iu=!1,cl("INTERNAL UNHANDLED ERROR: ",function(f){let v=f.message||"";return f.stack&&(v=f.stack.includes(f.message)?f.stack:f.message+"\n"+f.stack),v}(r)),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(e,n,r){this.au(),this.ou.indexOf(e)>-1&&(n=0);const s=gie.createAndSchedule(this,e,n,r,c=>this.lu(c));return this.nu.push(s),s}au(){this.ru&&tr()}verifyOperationInProgress(){}hu(){var e=this;return Ze(function*(){let n;do{n=e.Xa,yield n}while(n!==e.Xa)})()}Pu(e){for(const n of this.nu)if(n.timerId===e)return!0;return!1}Iu(e){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.nu)if(n.skipDelay(),"all"!==e&&n.timerId===e)break;return this.hu()})}Tu(e){this.ou.push(e)}lu(e){const n=this.nu.indexOf(e);this.nu.splice(n,1)}}class Ks extends lj{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Gye,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||pde(this),this._firestoreClient.terminate()}}function pde(t){var e,n,r;const s=t._freezeSettings(),c=(b=(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",new vme(t._databaseId,b,t._persistenceKey,(k=s).host,k.ssl,k.experimentalForceLongPolling,k.experimentalAutoDetectLongPolling,ode(k.experimentalLongPollingOptions),k.useFetchStreams));var b,k;t._firestoreClient=new kye(t._authCredentials,t._appCheckCredentials,t._queue,c),null!==(n=s.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=s.localCache)&&void 0!==r&&r._onlineComponentProvider&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}class AP{constructor(e){this._byteString=e}static fromBase64String(e){try{return new AP(fc.fromBase64String(e))}catch(n){throw new Zt(ft.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new AP(fc.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class dF{constructor(...e){for(let n=0;n<e.length;++n)if(0===e[n].length)throw new Zt(ft.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ma(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class ioe{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Zt(ft.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Zt(ft.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ri(this._lat,e._lat)||ri(this._long,e._long)}}const Jye=new RegExp("[~\\*/\\[\\]]");function rY(t,e,n,r,s){const c=r&&!r.isEmpty(),f=void 0!==s;let v=`Function ${e}() called with invalid data`;n&&(v+=" (via `toFirestore()`)"),v+=". ";let b="";return(c||f)&&(b+=" (found",c&&(b+=` in field ${r}`),f&&(b+=` in document ${s}`),b+=")"),new Zt(ft.INVALID_ARGUMENT,v+t+b)}class hoe{constructor(e,n,r,s,c){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new hl(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new e_e(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(iY("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n)}}}class e_e extends hoe{data(){return super.data()}}function iY(t,e){return"string"==typeof e?function nY(t,e,n){if(e.search(Jye)>=0)throw rY(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new dF(...e.split("."))._internalPath}catch{throw rY(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e):e instanceof dF?e._internalPath:e._delegate._internalPath}class n_e{convertValue(e,n="none"){switch(lC(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ga(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(rb(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw tr()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return oC(e,(s,c)=>{r[s]=this.convertValue(c,n)}),r}convertGeoPoint(e){return new ioe(Ga(e.latitude),Ga(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=EW(e);return null==r?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(N6(e));default:return null}}convertTimestamp(e){const n=sC(e);return new Da(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ro.fromString(e);yr($ue(r));const s=new gP(r.get(1),r.get(3)),c=new kn(r.popFirst(5));return s.isEqual(n)||cl(`Document ${c} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),c}}class PP{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class mF extends hoe{constructor(e,n,r,s,c,f){super(e,n,r,s,f),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new lY(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(iY("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class lY extends mF{data(e={}){return super.data(e)}}class yC extends n_e{constructor(e){super(),this.firestore=e}convertBytes(e){return new AP(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new hl(this.firestore,null,n)}}!function(e,n=!0){kL=vi,Dt(new Tp("firestore",(r,{instanceIdentifier:s,options:c})=>{const f=r.getProvider("app").getImmediate(),v=new Ks(new zfe(r.getProvider("auth-internal")),new $fe(r.getProvider("app-check-internal")),function(S,k){if(!Object.prototype.hasOwnProperty.apply(S.options,["projectId"]))throw new Zt(ft.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gP(S.options.projectId,k)}(f,s),f);return c=Object.assign({useFetchStreams:n},c),v._setSettings(c),v},"PUBLIC").setMultipleInstances(!0)),Ue(yce,"4.4.2",e),Ue(yce,"4.4.2","esm2017")}();const __e={apiKey:"AIzaSyBKxLNANtuu69PEaJu3rXSxwcrwA2SmFVo",authDomain:"kgis-658b4.firebaseapp.com",projectId:"kgis-658b4",storageBucket:"kgis-658b4.appspot.com",messagingSenderId:"396734589054",appId:"1:396734589054:web:7285c9d8174a086423902f",measurementId:"G-HF6WYN45QJ"};let v_e=(()=>{class t{constructor(){this.app=me(__e),this.auth=one(this.app),this.googleProvider=new TT,this.storage=function HK(t=J(),e){const r=qt(t=xp(t),Jw).getImmediate({identifier:e}),s=L7("storage");return s&&function $K(t,e,n,r={}){!function Bh(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken="string"==typeof s?s:B7(s,t.app.options.projectId))}(t,e,n,r)}(r,...s),r}(this.app),this.firestore=function Wye(t,e){const r="string"==typeof t?t:e||"(default)",s=qt("object"==typeof t?t:J(),"firestore").getImmediate({identifier:r});if(!s._initialized){const c=L7("firestore");c&&function qye(t,e,n,r={}){var s;const c=(t=oo(t,lj))._getSettings(),f=`${e}:${n}`;if("firestore.googleapis.com"!==c.host&&c.host!==f&&$p("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},c),{host:f,ssl:!1})),r.mockUserToken){let v,b;if("string"==typeof r.mockUserToken)v=r.mockUserToken,b=Uc.MOCK_USER;else{v=B7(r.mockUserToken,null===(s=t._app)||void 0===s?void 0:s.options.projectId);const S=r.mockUserToken.sub||r.mockUserToken.user_id;if(!S)throw new Zt(ft.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new Uc(S)}t._authCredentials=new Ufe(new _ce(v,b))}}(s,...c)}return s}(this.app)}signInWithGoogle(){var n=this;return Ze(function*(){try{yield function zte(t,e,n){return k5.apply(this,arguments)}(n.auth,n.googleProvider)}catch(r){console.error("Error signing in with Google:",r)}})()}signOut(){var n=this;return Ze(function*(){try{yield function Po(t){return xp(t).signOut()}(n.auth)}catch(r){console.error("Error signing out:",r)}})()}uploadFile(n){var r=this;return Ze(function*(){const s=function XT(t,e){return function om(t,e){if(e&&function YT(t){return/^[A-Za-z]+:\/\//.test(t)}(e)){if(t instanceof ZT)return function im(t,e){return new hi(t,e)}(t,e);throw bL("To use ref(service, url), the first argument must be a Storage instance.")}return rP(t,e)}(t=xp(t),e)}(r.storage,"files/"+n.name);try{return yield function oP(t,e,n){return Vs(t=xp(t),e,n)}(s,n),console.log("File uploaded successfully!"),s}catch(c){throw console.error("Error uploading file:",c),c}})()}getValuesForProperty(n){var r=this;return Ze(function*(){const s=[];try{const c=hde(r.firestore,"properties",n),f=yield function o_e(t){t=oo(t,hl);const e=oo(t.firestore,Ks);return rde(function dl(t){return t._firestoreClient||pde(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(e),t._key).then(n=>function foe(t,e,n){const r=n.docs.get(e._key),s=new yC(t);return new mF(t,s,e._key,r,new PP(n.hasPendingWrites,n.fromCache),e.converter)}(e,t,n))}(c);if(f.exists()){const v=f.data();v&&v.values&&s.push(...v.values)}else console.log(`No document found for property: ${n}`)}catch(c){console.error("Error fetching property values:",c)}return s})()}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275prov=jn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const b_e=["addListener","removeListener"],E_e=["addEventListener","removeEventListener"],x_e=["on","off"];function fj(t,e,n,r){if(Si(n)&&(r=n,n=void 0),r)return fj(t,e,n).pipe(sx(r));const[s,c]=function I_e(t){return Si(t.addEventListener)&&Si(t.removeEventListener)}(t)?E_e.map(f=>v=>t[f](e,v,n)):function T_e(t){return Si(t.addListener)&&Si(t.removeListener)}(t)?b_e.map(Nde(t,e)):function C_e(t){return Si(t.on)&&Si(t.off)}(t)?x_e.map(Nde(t,e)):[];if(!s&&wb(t))return la(f=>fj(f,e,n))(Wa(t));if(!s)throw new TypeError("Invalid event target");return new ls(f=>{const v=(...b)=>f.next(1<b.length?b:b[0]);return s(v),()=>c(v)})}function Nde(t,e){return n=>r=>t[n](e,r)}var yF,mj=function(t){return t.LEFT="left",t.RIGHT="right",t.TOP="top",t.BOTTOM="bottom",t}(mj||{}),Lde=((yF={})[mj.LEFT]=function(t,e,n){return{top:t.top-Math.round(e.offsetHeight/2)+Math.round(n.height/2),left:Math.round(t.left-e.offsetWidth)}},yF[mj.RIGHT]=function(t,e,n){return{top:t.top-Math.round(e.offsetHeight/2)+Math.round(n.height/2),left:Math.round(t.left+n.width)}},yF[mj.TOP]=function(t,e,n){return{top:Math.round(t.top-e.offsetHeight),left:t.left-Math.round(e.offsetWidth/2)+Math.round(n.width/2)}},yF[mj.BOTTOM]=function(t,e,n){return{top:Math.round(t.top+n.height),left:t.left-Math.round(e.offsetWidth/2)+Math.round(n.width/2)}},yF),Fde=typeof window<"u"?window:{innerHeight:0,scrollY:0,innerWidth:0,scrollX:0},S_e=function(){function t(e){void 0===e&&(e={}),this.positions=Lde,this.positions=Object.assign({},Lde,e)}return t.prototype.getRelativeOffset=function(e){for(var n={left:e.offsetLeft,top:e.offsetTop};e.offsetParent&&"static"===getComputedStyle(e.offsetParent).position;)n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent;return n},t.prototype.getAbsoluteOffset=function(e){for(var n=e,r={top:0,left:0};n.offsetParent;){var s=getComputedStyle(n.offsetParent);"static"===s.position&&s.marginLeft&&s.marginTop&&(parseInt(s.marginTop,10)&&(r.top+=parseInt(s.marginTop,10)),parseInt(s.marginLeft,10)&&(r.left+=parseInt(s.marginLeft,10))),n=n.offsetParent}var c=e.getBoundingClientRect(),f=document.body.getBoundingClientRect();return{top:c.top-f.top+r.top,left:c.left-f.left+r.left}},t.prototype.findRelative=function(e,n,r){var s=this.getRelativeOffset(e),c=e.getBoundingClientRect();return this.calculatePosition(s,c,n,r)},t.prototype.findAbsolute=function(e,n,r){var s=this.getAbsoluteOffset(e),c=e.getBoundingClientRect();return this.calculatePosition(s,c,n,r)},t.prototype.findPosition=function(e,n,r,s){void 0===s&&(s=this.getAbsoluteOffset.bind(this));var c=s(e),f=e.getBoundingClientRect();return this.calculatePosition(c,f,n,r)},t.prototype.findPositionAt=function(e,n,r){return this.calculatePosition(e,{top:0,left:0,height:0,width:0},n,r)},t.prototype.getPlacementBox=function(e,n){return{top:n.top,bottom:e.offsetHeight+n.top,left:n.left,right:e.offsetWidth+n.left}},t.prototype.addOffset=function(e,n,r){return void 0===n&&(n=0),void 0===r&&(r=0),Object.assign({},e,{top:e.top+n,left:e.left+r})},t.prototype.setElement=function(e,n){e.style.top=n.top+"px",e.style.left=n.left+"px"},t.prototype.findBestPlacement=function(e,n,r,s,c){var f=this;void 0===s&&(s=this.defaultContainerFunction.bind(this)),void 0===c&&(c=this.findPosition.bind(this));var v=r.map(function(b){var S=c(e,n,b),k=f.getPlacementBox(n,S),F=0,H=0,Q=s();k.top<Q.top?F=Q.top-k.top:k.bottom>Q.height&&(F=k.bottom-Q.height),k.left<Q.left?H=Q.left-k.left:k.right>Q.width&&(H=k.right-Q.width),F&&!H?H=1:H&&!F&&(F=1);var de=n.offsetHeight*n.offsetWidth;return{placement:b,weight:(de-F*H)/de}});return v.sort(function(b,S){return S.weight-b.weight}),v[0].placement},t.prototype.findBestPlacementAt=function(e,n,r,s){var c=this;return void 0===s&&(s=this.defaultContainerFunction.bind(this)),this.findBestPlacement(null,n,r,s,function(v,b,S){return c.findPositionAt(e,b,S)})},t.prototype.defaultContainerFunction=function(){return{top:0,left:0,height:Fde.innerHeight,width:Fde.innerWidth}},t.prototype.calculatePosition=function(e,n,r,s){return this.positions[s]?this.positions[s](e,r,n):(console.error("No function found for placement, defaulting to 0,0"),{left:0,top:0})},t}(),goe=new S_e;let _F=(()=>{class t{constructor(n){this.ngZone=n,this.frameSource=new bu,this.tick=this.frameSource.asObservable(),this.ngZone.runOutsideAngular(()=>{this.animationFrameId=requestAnimationFrame(this.doTick.bind(this))})}ngOnDestroy(){cancelAnimationFrame(this.animationFrameId)}doTick(n){this.frameSource.next(n),this.ngZone.runOutsideAngular(()=>{requestAnimationFrame(this.doTick.bind(this))})}}return t.\u0275fac=function(n){return new(n||t)(hr(Ji))},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})(),Bde=(()=>{class t{constructor(n){this.singleton=n,this.tick=ki(this.singleton.tick)}}return t.\u0275fac=function(n){return new(n||t)(hr(_F))},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})();const Ude=(t,...e)=>{for(const n of e)for(const r in n)n.hasOwnProperty(r)&&(n[r]instanceof Object?(t[r]||(t[r]={}),t[r]=Ude(t[r],n[r])):t[r]=n[r]);return t},_oe=t=>{const e=getComputedStyle(t);return"auto"===e.overflow||"scroll"===e.overflow||"auto"===e["overflow-y"]||"scroll"===e["overflow-y"]||"auto"===e["overflow-x"]||"scroll"===e["overflow-x"]},P_e=(t,e)=>{const n=t.getBoundingClientRect(),r=e.getBoundingClientRect();if("BODY"===e.tagName||"HTML"===e.tagName){const f=n.bottom-t.clientHeight>(window.innerHeight||document.documentElement.clientHeight),v=n.right>(window.innerWidth||document.documentElement.clientWidth);return!(n.top<0&&n.top+t.clientHeight<0||f||n.left<0||v)}return n.bottom-t.clientHeight<=r.bottom+(e.offsetHeight-e.clientHeight)/2&&n.top>=-t.clientHeight},zde=t=>{const e=[document.body];for(;t.parentElement&&t!==document.body;)_oe(t)&&e.push(t),t=t.parentElement;return e};function M_e(t,e,n){const r=window.getComputedStyle(t);return n.includes(r[e])}let jde=(()=>{class t{constructor(n){this.singleton=n,this.tick=ki(this.singleton.tick)}visibility(n,r=n){const s=zde(r);return this.tick.pipe(go(()=>{for(const c of s)if(!P_e(n,c))return{visible:!1};return{visible:!0}}))}}return t.\u0275fac=function(n){return new(n||t)(hr(_F))},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})();const Hde=(t,e)=>{switch(e){case"scroll":case"resize":case"touchstart":case"touchmove":case"touchend":return fj(t,e,{passive:!0});default:return fj(t,e)}};let gj=(()=>{class t{constructor(){this.globalEvents=new Map,this.documentRef=document,this.subscriptions=new aa}handleEvent(n,r){this.globalEvents.has(n)||this.globalEvents.set(n,this.documentRef?Hde(this.documentRef,n):new ls);const s=this.globalEvents.get(n);this.subscriptions.add(s.subscribe(r))}handleClick(n){this.handleEvent("click",n)}ngOnDestroy(){this.subscriptions.unsubscribe(),this.globalEvents=null}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})(),O_e=(()=>{class t{constructor(n){this.documentService=n,this.subscriptions=new aa,this.targets=new WeakMap}on(n,r,s){this.targets.has(n)||this.targets.set(n,new Map);const c=this.targets.get(n);c.has(r)||c.set(r,Hde(n,r));const f=c.get(r).subscribe(s);this.subscriptions.add(f)}onDocument(n,r){this.documentService.handleEvent(n,r)}ngOnDestroy(){this.subscriptions.unsubscribe()}}return t.\u0275fac=function(n){return new(n||t)(hr(gj))},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})();const L_e={provide:gj,deps:[[new zd,new jd,gj]],useFactory:function N_e(t){return t||new gj}},V_e={provide:_F,deps:[[new zd,new jd,_F],Ji],useFactory:function F_e(t,e){return t||new _F(e)}};let B_e=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({providers:[L_e,V_e,_F,gj,Bde,jde,O_e]}),t})();var $de={BREADCRUMB:{LABEL:"Breadcrumb",OVERFLOW_MENU_DESCRIPTION:"Options"},CODE_SNIPPET:{CODE_SNIPPET_TEXT:"Code Snippet Text",SHOW_MORE:"Show more",SHOW_LESS:"Show less",SHOW_MORE_ICON:"Show more icon",COPY_CODE:"Copy code",COPIED:"Copied!"},COMBOBOX:{PLACEHOLDER:"Filter...",CLEAR_SELECTIONS:"Clear all selected items",CLEAR_SELECTED:"Clear selected item",A11Y:{OPEN_MENU:"Open menu",CLOSE_MENU:"Close menu",CLEAR_SELECTIONS:"Clear all selected items",CLEAR_SELECTED:"Clear Selection"}},DROPDOWN:{OPEN:"Open menu",SELECTED:"Selected",CLEAR:"Clear all selected items",FILTER:{SELECTED_ONLY:"Show selected only",SEARCH:"Search",NO_RESULTS:"No search results",RESET_SEARCH:"Reset search"}},DROPDOWN_LIST:{LABEL:"Listbox"},FILE_UPLOADER:{CHECKMARK:"Checkmark",OPEN:"Add file",REMOVE_BUTTON:"Close button"},LOADING:{TITLE:"Loading"},MODAL:{CLOSE:"Close modal"},NOTIFICATION:{CLOSE_BUTTON:"Close alert notification"},NUMBER:{INCREMENT:"Increment value",DECREMENT:"Decrement value"},OVERFLOW_MENU:{OVERFLOW:"Overflow",ICON_DESCRIPTION:"Options"},SEARCH:{LABEL:"Search",PLACEHOLDER:"Search",CLEAR_BUTTON:"Clear search input"},PAGINATION:{ITEMS_PER_PAGE:"Items per page:",OPEN_LIST_OF_OPTIONS:"Open list of options",BACKWARD:"Backward",FORWARD:"Forward",TOTAL_ITEMS_UNKNOWN:"{{start}}-{{end}} items",TOTAL_ITEMS:"{{start}}-{{end}} of {{total}} items",TOTAL_ITEM:"{{start}}-{{end}} of {{total}} item",PAGE:"page",OF_LAST_PAGES:"of {{last}} pages",OF_LAST_PAGE:"of {{last}} page",NEXT:"Next",PREVIOUS:"Previous",SELECT_ARIA:"Select page number"},PROGRESS_INDICATOR:{CURRENT:"Current",INCOMPLETE:"Incomplete",COMPLETE:"Complete",INVALID:"Invalid"},TABLE:{FILTER:"Filter",END_OF_DATA:"You've reached the end of your content",SCROLL_TOP:"Scroll to top",CHECKBOX_HEADER:"Select all rows",CHECKBOX_ROW:"Select {{value}}",EXPAND_BUTTON:"Expand row",EXPAND_ALL_BUTTON:"Expand all rows",SORT_DESCENDING:"Sort rows by this header in descending order",SORT_ASCENDING:"Sort rows by this header in ascending order",ROW:"row"},TABLE_TOOLBAR:{ACTION_BAR:"Table action bar",BATCH_TEXT:"",BATCH_TEXT_SINGLE:"1 item selected",BATCH_TEXT_MULTIPLE:"{{count}} items selected",CANCEL:"Cancel"},TABS:{BUTTON_ARIA_LEFT:"Go to the previous tab",BUTTON_ARIA_RIGHT:"Go to the next tab",HEADER_ARIA_LABEL:"List of tabs"},TILES:{TILE:"tile",EXPAND:"Expand",COLLAPSE:"Collapse"},TOGGLE:{OFF:"Off",ON:"On"},UI_SHELL:{SKIP_TO:"Skip to content",HEADER:{OPEN_MENU:"Open menu",CLOSE_MENU:"Close menu"},SIDE_NAV:{TOGGLE_OPEN:"Open",TOGGLE_CLOSE:"Close"}}};class z_e{constructor(e,n){this.path=e,this.i18n=n,this.baseTranslation=this.i18n.get(this.path),this.isOverridden=!1;const r=this.i18n.getValueFromPath(this.path);this.$override=new pl(r),this._value=r}get value(){return this._value}set value(e){this.override(e)}get subject(){return function w_e(t,e,n){return Dz(()=>t()?e:n)}(()=>this.isOverridden,this.$override,this.baseTranslation)}override(e){this.isOverridden=!0,this.subscription&&(this.subscription.unsubscribe(),this.subscription=null),this._value=e,d_(e)?this.subscription=e.subscribe(n=>{this.$override.next(n)}):this.$override.next(e)}}let av=(()=>{class t{constructor(){this.translationStrings=$de,this.translations=new Map,this.locale=new pl("en")}setLocale(n,r){this.locale.next(n),r&&this.set(r)}getLocale(){return this.locale.value}getLocaleObservable(){return this.locale.asObservable()}set(n){this.translationStrings=Ude({},$de,n);const r=Array.from(this.translations);for(const[s,c]of r)c.next(this.getValueFromPath(s))}get(n){return n?this.getSubject(n):this.translationStrings}getMultiple(n){const r=this.getValueFromPath(n),s={};for(const c of Object.keys(r))s[c]=r[c]===Object(r[c])?this.getMultiple(`${n}.${c}`):this.getSubject(`${n}.${c}`);return s}getOverridable(n){return new z_e(n,this)}replace(n,r){return((t,e)=>t.pipe(go(n=>{const r=Object.keys(e);for(const s of r){const c=e[s];n=n.replace(new RegExp(`{{\\s*${s}\\s*}}`,"g"),c)}return n})))(n,r)}getValueFromPath(n){let r=this.translationStrings;for(const s of n.split(".")){if(null==r[s])throw new Error(`no key ${s} at ${n}`);r=r[s]}return r}getSubject(n){try{const r=this.getValueFromPath(n);if(this.translations.has(n))return this.translations.get(n);const s=new pl(r);return this.translations.set(n,s),s}catch(r){console.error(r)}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})();const H_e={provide:av,deps:[[new zd,new jd,av]],useFactory:function j_e(t){return t||new av}};let dY=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({providers:[av,H_e]}),t})();const vF=Math.min,RP=Math.max,pY=Math.round,fY=Math.floor,_C=t=>({x:t,y:t}),$_e={left:"right",right:"left",bottom:"top",top:"bottom"},q_e={start:"end",end:"start"};function mY(t,e){return"function"==typeof t?t(e):t}function wF(t){return t.split("-")[0]}function yj(t){return t.split("-")[1]}function voe(t){return"y"===t?"height":"width"}function _j(t){return["top","bottom"].includes(wF(t))?"y":"x"}function woe(t){return function K_e(t){return"x"===t?"y":"x"}(_j(t))}function boe(t){return t.replace(/start|end/g,e=>q_e[e])}function gY(t){return t.replace(/left|right|bottom|top/g,e=>$_e[e])}function qde(t){return"number"!=typeof t?function X_e(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function yY(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function Gde(t,e,n){let{reference:r,floating:s}=t;const c=_j(e),f=woe(e),v=voe(f),b=wF(e),S="y"===c,k=r.x+r.width/2-s.width/2,F=r.y+r.height/2-s.height/2,H=r[v]/2-s[v]/2;let Q;switch(b){case"top":Q={x:k,y:r.y-s.height};break;case"bottom":Q={x:k,y:r.y+r.height};break;case"right":Q={x:r.x+r.width,y:F};break;case"left":Q={x:r.x-s.width,y:F};break;default:Q={x:r.x,y:r.y}}switch(yj(e)){case"start":Q[f]-=H*(n&&S?-1:1);break;case"end":Q[f]+=H*(n&&S?-1:1)}return Q}const J_e=function(){var t=Ze(function*(e,n,r){const{placement:s="bottom",strategy:c="absolute",middleware:f=[],platform:v}=r,b=f.filter(Boolean),S=yield null==v.isRTL?void 0:v.isRTL(n);let k=yield v.getElementRects({reference:e,floating:n,strategy:c}),{x:F,y:H}=Gde(k,s,S),Q=s,de={},be=0;for(let Ie=0;Ie<b.length;Ie++){const{name:Be,fn:Fe}=b[Ie],{x:tt,y:mt,data:Xt,reset:bn}=yield Fe({x:F,y:H,initialPlacement:s,placement:Q,strategy:c,middlewareData:de,rects:k,platform:v,elements:{reference:e,floating:n}});F=tt??F,H=mt??H,de={...de,[Be]:{...de[Be],...Xt}},bn&&be<=50&&(be++,"object"==typeof bn&&(bn.placement&&(Q=bn.placement),bn.rects&&(k=!0===bn.rects?yield v.getElementRects({reference:e,floating:n,strategy:c}):bn.rects),({x:F,y:H}=Gde(k,Q,S))),Ie=-1)}return{x:F,y:H,placement:Q,strategy:c,middlewareData:de}});return function(n,r,s){return t.apply(this,arguments)}}();function Eoe(){return Eoe=Ze(function*(t,e){var n;void 0===e&&(e={});const{x:r,y:s,platform:c,rects:f,elements:v,strategy:b}=t,{boundary:S="clippingAncestors",rootBoundary:k="viewport",elementContext:F="floating",altBoundary:H=!1,padding:Q=0}=mY(e,t),de=qde(Q),Ie=v[H?"floating"===F?"reference":"floating":F],Be=yY(yield c.getClippingRect({element:null==(n=yield null==c.isElement?void 0:c.isElement(Ie))||n?Ie:Ie.contextElement||(yield null==c.getDocumentElement?void 0:c.getDocumentElement(v.floating)),boundary:S,rootBoundary:k,strategy:b})),Fe="floating"===F?{x:r,y:s,width:f.floating.width,height:f.floating.height}:f.reference,tt=yield null==c.getOffsetParent?void 0:c.getOffsetParent(v.floating),mt=(yield null==c.isElement?void 0:c.isElement(tt))&&(yield null==c.getScale?void 0:c.getScale(tt))||{x:1,y:1},Xt=yY(c.convertOffsetParentRelativeRectToViewportRelativeRect?yield c.convertOffsetParentRelativeRectToViewportRelativeRect({elements:v,rect:Fe,offsetParent:tt,strategy:b}):Fe);return{top:(Be.top-Xt.top+de.top)/mt.y,bottom:(Xt.bottom-Be.bottom+de.bottom)/mt.y,left:(Be.left-Xt.left+de.left)/mt.x,right:(Xt.right-Be.right+de.right)/mt.x}}),Eoe.apply(this,arguments)}function xoe(){return xoe=Ze(function*(t,e){const{placement:n,platform:r,elements:s}=t,c=yield null==r.isRTL?void 0:r.isRTL(s.floating),f=wF(n),v=yj(n),b="y"===_j(n),S=["left","top"].includes(f)?-1:1,k=c&&b?-1:1,F=mY(e,t);let{mainAxis:H,crossAxis:Q,alignmentAxis:de}="number"==typeof F?{mainAxis:F,crossAxis:0,alignmentAxis:null}:{mainAxis:F.mainAxis||0,crossAxis:F.crossAxis||0,alignmentAxis:F.alignmentAxis};return v&&"number"==typeof de&&(Q="end"===v?-1*de:de),b?{x:Q*k,y:H*S}:{x:H*S,y:Q*k}}),xoe.apply(this,arguments)}const ove=function(t){return void 0===t&&(t=0),{name:"offset",options:t,fn:e=>Ze(function*(){var n,r;const{x:s,y:c,placement:f,middlewareData:v}=e,b=yield function ive(t,e){return xoe.apply(this,arguments)}(e,t);return f===(null==(n=v.offset)?void 0:n.placement)&&null!=(r=v.arrow)&&r.alignmentOffset?{}:{x:s+b.x,y:c+b.y,data:{...b,placement:f}}})()}};function _Y(){return typeof window<"u"}function vC(t){return Zde(t)?(t.nodeName||"").toLowerCase():"#document"}function Kp(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function cb(t){var e;return null==(e=(Zde(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function Zde(t){return!!_Y()&&(t instanceof Node||t instanceof Kp(t).Node)}function lv(t){return!!_Y()&&(t instanceof Element||t instanceof Kp(t).Element)}function cv(t){return!!_Y()&&(t instanceof HTMLElement||t instanceof Kp(t).HTMLElement)}function Qde(t){return!(!_Y()||typeof ShadowRoot>"u")&&(t instanceof ShadowRoot||t instanceof Kp(t).ShadowRoot)}function vj(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=cm(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(s)}function sve(t){return["table","td","th"].includes(vC(t))}function ave(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Toe(t){const e=Coe(),n=lv(t)?cm(t):t;return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Coe(){return!(typeof CSS>"u"||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function vY(t){return["html","body","#document"].includes(vC(t))}function cm(t){return Kp(t).getComputedStyle(t)}function wY(t){return lv(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function EF(t){if("html"===vC(t))return t;const e=t.assignedSlot||t.parentNode||Qde(t)&&t.host||cb(t);return Qde(e)?e.host:e}function Xde(t){const e=EF(t);return vY(e)?t.ownerDocument?t.ownerDocument.body:t.body:cv(e)&&vj(e)?e:Xde(e)}function wj(t,e,n){var r;void 0===e&&(e=[]),void 0===n&&(n=!0);const s=Xde(t),c=s===(null==(r=t.ownerDocument)?void 0:r.body),f=Kp(s);if(c){const v=function cve(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}(f);return e.concat(f,f.visualViewport||[],vj(s)?s:[],v&&n?wj(v):[])}return e.concat(s,wj(s,[],n))}function Jde(t){const e=cm(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=cv(t),c=s?t.offsetWidth:n,f=s?t.offsetHeight:r,v=pY(n)!==c||pY(r)!==f;return v&&(n=c,r=f),{width:n,height:r,$:v}}function Ioe(t){return lv(t)?t:t.contextElement}function xF(t){const e=Ioe(t);if(!cv(e))return _C(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:c}=Jde(e);let f=(c?pY(n.width):n.width)/r,v=(c?pY(n.height):n.height)/s;return(!f||!Number.isFinite(f))&&(f=1),(!v||!Number.isFinite(v))&&(v=1),{x:f,y:v}}const uve=_C(0);function epe(t){const e=Kp(t);return Coe()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:uve}function MP(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=!1);const s=t.getBoundingClientRect(),c=Ioe(t);let f=_C(1);e&&(r?lv(r)&&(f=xF(r)):f=xF(t));const v=function hve(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==Kp(t))&&e}(c,n,r)?epe(c):_C(0);let b=(s.left+v.x)/f.x,S=(s.top+v.y)/f.y,k=s.width/f.x,F=s.height/f.y;if(c){const H=Kp(c),Q=r&&lv(r)?Kp(r):r;let de=H,be=de.frameElement;for(;be&&r&&Q!==de;){const Ie=xF(be),Be=be.getBoundingClientRect(),Fe=cm(be),tt=Be.left+(be.clientLeft+parseFloat(Fe.paddingLeft))*Ie.x,mt=Be.top+(be.clientTop+parseFloat(Fe.paddingTop))*Ie.y;b*=Ie.x,S*=Ie.y,k*=Ie.x,F*=Ie.y,b+=tt,S+=mt,de=Kp(be),be=de.frameElement}}return yY({width:k,height:F,x:b,y:S})}const dve=[":popover-open",":modal"];function tpe(t){return dve.some(e=>{try{return t.matches(e)}catch{return!1}})}function npe(t){return MP(cb(t)).left+wY(t).scrollLeft}function rpe(t,e,n){let r;if("viewport"===e)r=function gve(t,e){const n=Kp(t),r=cb(t),s=n.visualViewport;let c=r.clientWidth,f=r.clientHeight,v=0,b=0;if(s){c=s.width,f=s.height;const S=Coe();(!S||S&&"fixed"===e)&&(v=s.offsetLeft,b=s.offsetTop)}return{width:c,height:f,x:v,y:b}}(t,n);else if("document"===e)r=function mve(t){const e=cb(t),n=wY(t),r=t.ownerDocument.body,s=RP(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),c=RP(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let f=-n.scrollLeft+npe(t);const v=-n.scrollTop;return"rtl"===cm(r).direction&&(f+=RP(e.clientWidth,r.clientWidth)-s),{width:s,height:c,x:f,y:v}}(cb(t));else if(lv(e))r=function yve(t,e){const n=MP(t,!0,"fixed"===e),r=n.top+t.clientTop,s=n.left+t.clientLeft,c=cv(t)?xF(t):_C(1);return{width:t.clientWidth*c.x,height:t.clientHeight*c.y,x:s*c.x,y:r*c.y}}(e,n);else{const s=epe(t);r={...e,x:e.x-s.x,y:e.y-s.y}}return yY(r)}function ipe(t,e){const n=EF(t);return!(n===e||!lv(n)||vY(n))&&("fixed"===cm(n).position||ipe(n,e))}function _ve(t,e){const n=e.get(t);if(n)return n;let r=wj(t,[],!1).filter(v=>lv(v)&&"body"!==vC(v)),s=null;const c="fixed"===cm(t).position;let f=c?EF(t):t;for(;lv(f)&&!vY(f);){const v=cm(f),b=Toe(f);!b&&"fixed"===v.position&&(s=null),(c?!b&&!s:!b&&"static"===v.position&&s&&["absolute","fixed"].includes(s.position)||vj(f)&&!b&&ipe(t,f))?r=r.filter(k=>k!==f):s=v,f=EF(f)}return e.set(t,r),r}function bve(t,e,n){const r=cv(e),s=cb(e),c="fixed"===n,f=MP(t,!0,c,e);let v={scrollLeft:0,scrollTop:0};const b=_C(0);if(r||!r&&!c)if(("body"!==vC(e)||vj(s))&&(v=wY(e)),r){const F=MP(e,!0,c,e);b.x=F.x+e.clientLeft,b.y=F.y+e.clientTop}else s&&(b.x=npe(s));return{x:f.left+v.scrollLeft-b.x,y:f.top+v.scrollTop-b.y,width:f.width,height:f.height}}function ope(t,e){return cv(t)&&"fixed"!==cm(t).position?e?e(t):t.offsetParent:null}function spe(t,e){const n=Kp(t);if(!cv(t)||tpe(t))return n;let r=ope(t,e);for(;r&&sve(r)&&"static"===cm(r).position;)r=ope(r,e);return r&&("html"===vC(r)||"body"===vC(r)&&"static"===cm(r).position&&!Toe(r))?n:r||function lve(t){let e=EF(t);for(;cv(e)&&!vY(e);){if(Toe(e))return e;if(ave(e))return null;e=EF(e)}return null}(t)||n}const Eve=function(){var t=Ze(function*(e){const n=this.getOffsetParent||spe,r=this.getDimensions;return{reference:bve(e.reference,yield n(e.floating),e.strategy),floating:{x:0,y:0,...yield r(e.floating)}}});return function(n){return t.apply(this,arguments)}}(),Tve={convertOffsetParentRelativeRectToViewportRelativeRect:function pve(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const c="fixed"===s,f=cb(r),v=!!e&&tpe(e.floating);if(r===f||v&&c)return n;let b={scrollLeft:0,scrollTop:0},S=_C(1);const k=_C(0),F=cv(r);if((F||!F&&!c)&&(("body"!==vC(r)||vj(f))&&(b=wY(r)),cv(r))){const H=MP(r);S=xF(r),k.x=H.x+r.clientLeft,k.y=H.y+r.clientTop}return{width:n.width*S.x,height:n.height*S.y,x:n.x*S.x-b.scrollLeft*S.x+k.x,y:n.y*S.y-b.scrollTop*S.y+k.y}},getDocumentElement:cb,getClippingRect:function vve(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const f=[..."clippingAncestors"===n?_ve(e,this._c):[].concat(n),r],b=f.reduce((S,k)=>{const F=rpe(e,k,s);return S.top=RP(F.top,S.top),S.right=vF(F.right,S.right),S.bottom=vF(F.bottom,S.bottom),S.left=RP(F.left,S.left),S},rpe(e,f[0],s));return{width:b.right-b.left,height:b.bottom-b.top,x:b.left,y:b.top}},getOffsetParent:spe,getElementRects:Eve,getClientRects:function fve(t){return Array.from(t.getClientRects())},getDimensions:function wve(t){const{width:e,height:n}=Jde(t);return{width:e,height:n}},getScale:xF,isElement:lv,isRTL:function xve(t){return"rtl"===cm(t).direction}};const Sve=function(t){return void 0===t&&(t={}),{name:"flip",options:t,fn:e=>Ze(function*(){var n,r;const{placement:s,middlewareData:c,rects:f,initialPlacement:v,platform:b,elements:S}=e,{mainAxis:k=!0,crossAxis:F=!0,fallbackPlacements:H,fallbackStrategy:Q="bestFit",fallbackAxisSideDirection:de="none",flipAlignment:be=!0,...Ie}=mY(t,e);if(null!=(n=c.arrow)&&n.alignmentOffset)return{};const Be=wF(s),Fe=_j(v),tt=wF(v)===v,mt=yield null==b.isRTL?void 0:b.isRTL(S.floating),Xt=H||(tt||!be?[gY(v)]:function Y_e(t){const e=gY(t);return[boe(t),e,boe(e)]}(v)),bn="none"!==de;!H&&bn&&Xt.push(...function Q_e(t,e,n,r){const s=yj(t);let c=function Z_e(t,e,n){const r=["left","right"],s=["right","left"],c=["top","bottom"],f=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:r:e?r:s;case"left":case"right":return e?c:f;default:return[]}}(wF(t),"start"===n,r);return s&&(c=c.map(f=>f+"-"+s),e&&(c=c.concat(c.map(boe)))),c}(v,be,de,mt));const Or=[v,...Xt],Bi=yield function bF(t,e){return Eoe.apply(this,arguments)}(e,Ie),ys=[];let Ui=(null==(r=c.flip)?void 0:r.overflows)||[];if(k&&ys.push(Bi[Be]),F){const Hc=function W_e(t,e,n){void 0===n&&(n=!1);const r=yj(t),s=woe(t),c=voe(s);let f="x"===s?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return e.reference[c]>e.floating[c]&&(f=gY(f)),[f,gY(f)]}(s,f,mt);ys.push(Bi[Hc[0]],Bi[Hc[1]])}if(Ui=[...Ui,{placement:s,overflows:ys}],!ys.every(Hc=>Hc<=0)){var Ol,jh;const Hc=((null==(Ol=c.flip)?void 0:Ol.index)||0)+1,uv=Or[Hc];if(uv)return{data:{index:Hc,overflows:Ui},reset:{placement:uv}};let um=null==(jh=Ui.filter(hm=>hm.overflows[0]<=0).sort((hm,hv)=>hm.overflows[1]-hv.overflows[1])[0])?void 0:jh.placement;if(!um)switch(Q){case"bestFit":{var Od;const hm=null==(Od=Ui.filter(hv=>{if(bn){const wC=_j(hv.placement);return wC===Fe||"y"===wC}return!0}).map(hv=>[hv.placement,hv.overflows.filter(wC=>wC>0).reduce((wC,N1e)=>wC+N1e,0)]).sort((hv,wC)=>hv[1]-wC[1])[0])?void 0:Od[0];hm&&(um=hm);break}case"initialPlacement":um=v}if(s!==um)return{reset:{placement:um}}}return{}})()}},Ave=t=>({name:"arrow",options:t,fn:e=>Ze(function*(){const{x:n,y:r,placement:s,rects:c,platform:f,elements:v,middlewareData:b}=e,{element:S,padding:k=0}=mY(t,e)||{};if(null==S)return{};const F=qde(k),H={x:n,y:r},Q=woe(s),de=voe(Q),be=yield f.getDimensions(S),Ie="y"===Q,Be=Ie?"top":"left",Fe=Ie?"bottom":"right",tt=Ie?"clientHeight":"clientWidth",mt=c.reference[de]+c.reference[Q]-H[Q]-c.floating[de],Xt=H[Q]-c.reference[Q],bn=yield null==f.getOffsetParent?void 0:f.getOffsetParent(S);let Or=bn?bn[tt]:0;(!Or||!(yield null==f.isElement?void 0:f.isElement(bn)))&&(Or=v.floating[tt]||c.floating[de]);const Bi=mt/2-Xt/2,ys=Or/2-be[de]/2-1,Ui=vF(F[Be],ys),Ol=vF(F[Fe],ys),jh=Ui,Od=Or-be[de]-Ol,Hc=Or/2-be[de]/2+Bi,uv=function G_e(t,e,n){return RP(t,vF(e,n))}(jh,Hc,Od),um=!b.arrow&&null!=yj(s)&&Hc!==uv&&c.reference[de]/2-(Hc<jh?Ui:Ol)-be[de]/2<0,hm=um?Hc<jh?Hc-jh:Hc-Od:0;return{[Q]:H[Q]+hm,data:{[Q]:uv,centerOffset:Hc-uv-hm,...um&&{alignmentOffset:hm}},reset:um}})()});let Pve=(()=>{class t{constructor(n,r,s,c){this.elementRef=n,this.ngZone=r,this.renderer=s,this.changeDetectorRef=c,this._align="bottom",this.alignmentClassPrefix="cds--popover--",this.onClose=new Rr,this.onOpen=new Rr,this.isOpenChange=new Rr,this.caret=!0,this.dropShadow=!0,this.highContrast=!1,this.autoAlign=!1,this.containerClass=!0,this.isOpen=!1}set align(n){if(!n)return;const r=this._align;switch(n){case"top-left":this._align="top-start";break;case"top-right":this._align="top-end";break;case"bottom-left":this._align="bottom-start";break;case"bottom-right":this._align="bottom-end";break;case"left-top":this._align="left-start";break;case"left-bottom":this._align="left-end";break;case"right-top":this._align="right-start";break;case"right-bottom":this._align="right-end";break;default:this._align=n}this.updateAlignmentClass(this._align,r)}handleChange(n,r){if(this.isOpen!==n&&r&&this.isOpenChange.emit(n),n){if(r&&this.onOpen.emit(r),this.autoAlign){if(this.caretRef){const s=getComputedStyle(this.caretRef),c=s.getPropertyValue("--cds-popover-offset"),f=s.getPropertyValue("--cds-popover-caret-height");this.caretOffset=(c?.includes("px")?Number(c.split("px",1)[0]):16*Number(c.split("rem",1)[0]))||10,this.caretHeight=(f?.includes("px")?Number(f.split("px",1)[0]):16*Number(f.split("rem",1)[0]))||6}this.elementRef.nativeElement&&this.popoverContentRef&&(this.unmountFloatingElement=function Ive(t,e,n,r){void 0===r&&(r={});const{ancestorScroll:s=!0,ancestorResize:c=!0,elementResize:f="function"==typeof ResizeObserver,layoutShift:v="function"==typeof IntersectionObserver,animationFrame:b=!1}=r,S=Ioe(t),k=s||c?[...S?wj(S):[],...wj(e)]:[];k.forEach(Be=>{s&&Be.addEventListener("scroll",n,{passive:!0}),c&&Be.addEventListener("resize",n)});const F=S&&v?function Cve(t,e){let r,n=null;const s=cb(t);function c(){var v;clearTimeout(r),null==(v=n)||v.disconnect(),n=null}return function f(v,b){void 0===v&&(v=!1),void 0===b&&(b=1),c();const{left:S,top:k,width:F,height:H}=t.getBoundingClientRect();if(v||e(),!F||!H)return;const Fe={rootMargin:-fY(k)+"px "+-fY(s.clientWidth-(S+F))+"px "+-fY(s.clientHeight-(k+H))+"px "+-fY(S)+"px",threshold:RP(0,vF(1,b))||1};let tt=!0;function mt(Xt){const bn=Xt[0].intersectionRatio;if(bn!==b){if(!tt)return f();bn?f(!1,bn):r=setTimeout(()=>{f(!1,1e-7)},100)}tt=!1}try{n=new IntersectionObserver(mt,{...Fe,root:s.ownerDocument})}catch{n=new IntersectionObserver(mt,Fe)}n.observe(t)}(!0),c}(S,n):null;let H=-1,Q=null;f&&(Q=new ResizeObserver(Be=>{let[Fe]=Be;Fe&&Fe.target===S&&Q&&(Q.unobserve(e),cancelAnimationFrame(H),H=requestAnimationFrame(()=>{var tt;null==(tt=Q)||tt.observe(e)})),n()}),S&&!b&&Q.observe(S),Q.observe(e));let de,be=b?MP(t):null;return b&&function Ie(){const Be=MP(t);be&&(Be.x!==be.x||Be.y!==be.y||Be.width!==be.width||Be.height!==be.height)&&n(),be=Be,de=requestAnimationFrame(Ie)}(),n(),()=>{var Be;k.forEach(Fe=>{s&&Fe.removeEventListener("scroll",n),c&&Fe.removeEventListener("resize",n)}),F?.(),null==(Be=Q)||Be.disconnect(),Q=null,b&&cancelAnimationFrame(de)}}(this.elementRef.nativeElement,this.popoverContentRef,this.recomputePosition.bind(this)))}}else this.cleanUp(),r&&this.onClose.emit(r);this.isOpen=n,this.changeDetectorRef.markForCheck()}roundByDPR(n){const r=window.devicePixelRatio||1;return Math.round(n*r)/r}recomputePosition(){var n=this;this.ngZone.runOutsideAngular(Ze(function*(){const{x:r,y:s,placement:c,middlewareData:f}=yield((t,e,n)=>{const s={platform:Tve,...n},c={...s.platform,_c:new Map};return J_e(t,e,{...s,platform:c})})(n.elementRef.nativeElement,n.popoverContentRef,{placement:n._align,strategy:"fixed",middleware:[ove(n.caretOffset),Sve({fallbackAxisSideDirection:"start"}),Ave({element:n.caretRef})]}),v=n._align;if(n._align=c,n.updateAlignmentClass(n._align,v),Object.assign(n.popoverContentRef.style,{position:"fixed",top:"0",left:"0",transform:`translate(${n.roundByDPR(r)}px,${n.roundByDPR(s)}px)`}),f.arrow){const{x:b,y:S}=f.arrow,k={top:"bottom",right:"left",bottom:"top",left:"right"}[c.split("-")[0]];n.caretRef.style.left=null!=b?`${b}px`:"",n.caretRef.style.top=null!=S?`${S}px`:"",n.caretRef.style.right="",n.caretRef.style.bottom="",k&&(n.caretRef.style[k]=-n.caretHeight+"px")}}))}ngOnChanges(n){const r=this.isOpen;this.handleChange(!1),n.autoAlign&&!n.autoAlign.firstChange&&(this.popoverContentRef=this.elementRef.nativeElement.querySelector(".cds--popover-content"),this.popoverContentRef.setAttribute("style",""),this.caretRef=this.elementRef.nativeElement.querySelector("span.cds--popover-caret")),this.handleChange(r)}ngAfterViewInit(){this.initializeReferences()}initializeReferences(){this.updateAlignmentClass(this._align),this.popoverContentRef=this.elementRef.nativeElement.querySelector(".cds--popover-content"),this.caretRef=this.elementRef.nativeElement.querySelector("span.cds--popover-caret"),this.handleChange(this.isOpen)}ngOnDestroy(){this.cleanUp()}cleanUp(){this.unmountFloatingElement&&this.unmountFloatingElement(),this.unmountFloatingElement=void 0}updateAlignmentClass(n,r){if(this.elementRef.nativeElement&&r!==n){const s=new RegExp("right|top|left|bottom");this.elementRef.nativeElement.classList.forEach(c=>{s.test(c)&&this.renderer.removeClass(this.elementRef.nativeElement,`${c}`)}),this.renderer.addClass(this.elementRef.nativeElement,`${this.alignmentClassPrefix}${n}`)}}}return t.\u0275fac=function(n){return new(n||t)(vt(yl),vt(Ji),vt(Kc),vt(Pf))},t.\u0275dir=vr({type:t,selectors:[["","cdsPopover",""],["","ibmPopover",""]],hostVars:12,hostBindings:function(n,r){2&n&&Xl("cds--popover--caret",r.caret)("cds--popover--drop-shadow",r.dropShadow)("cds--popover--high-contrast",r.highContrast)("cds--popover--auto-align",r.autoAlign)("cds--popover-container",r.containerClass)("cds--popover--open",r.isOpen)},inputs:{align:"align",caret:"caret",dropShadow:"dropShadow",highContrast:"highContrast",autoAlign:"autoAlign",isOpen:"isOpen"},outputs:{onClose:"onClose",onOpen:"onOpen",isOpenChange:"isOpenChange"},features:[ml]}),t})(),Rve=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({imports:[ld]}),t})();const Mve=["contentWrapper"];function kve(t,e){if(1&t&&(bc(0),Ho(1),Qc()),2&t){const n=or(3);fn(1),Xs(n.description)}}function Ove(t,e){}const ape=function(t){return{$implicit:t}};function Nve(t,e){if(1&t&&mr(0,Ove,0,0,"ng-template",7),2&t){const n=or(3);un("ngTemplateOutlet",n.description)("ngTemplateOutletContext",vh(2,ape,n.templateContext))}}function Lve(t,e){1&t&&Rs(0,"span",8)}function Fve(t,e){1&t&&Rs(0,"span",9)}function Vve(t,e){if(1&t&&(bc(0),Gn(1,"span",4),mr(2,kve,2,1,"ng-container",3),mr(3,Nve,1,4,null,3),mr(4,Lve,1,0,"span",5),_r(),mr(5,Fve,1,0,"span",6),Qc()),2&t){const n=or(2);fn(2),un("ngIf",!n.isTemplate(n.description)),fn(1),un("ngIf",n.isTemplate(n.description)),fn(1),un("ngIf",n.autoAlign),fn(1),un("ngIf",!n.autoAlign)}}function Bve(t,e){if(1&t&&(Gn(0,"span",2),mr(1,Vve,6,4,"ng-container",3),_r()),2&t){const n=or();un("id",n.id),ca("aria-hidden",!n.isOpen),fn(1),un("ngIf",!n.disabled)}}const Uve=["*"];let Gve=(()=>{class t extends Pve{constructor(n,r,s,c){super(n,r,s,c),this.elementRef=n,this.ngZone=r,this.renderer=s,this.changeDetectorRef=c,this.tooltipClass=!0,this.id="tooltip-"+t.tooltipCount++,this.enterDelayMs=100,this.leaveDelayMs=300,this.disabled=!1,this.highContrast=!0,this.dropShadow=!1}mouseenter(n){clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.handleChange(!0,n)},this.enterDelayMs)}mouseleave(n){clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.handleChange(!1,n)},this.leaveDelayMs)}hostkeys(n){open&&"Escape"===n.key&&(n.stopPropagation(),this.handleChange(!1,n))}handleFocus(n){this.handleChange(!0,n)}handleFocusOut(n){this.handleChange(!1,n)}isTemplate(n){return n instanceof nd}ngOnChanges(n){const r=this.isOpen;this.handleChange(!1),(n.autoAlign&&!n.autoAlign.firstChange||n.disabled&&!n.disabled.firstChange&&!n.disabled.currentValue)&&(this.changeDetectorRef.detectChanges(),this.popoverContentRef=this.elementRef.nativeElement.querySelector(".cds--popover-content"),this.popoverContentRef.setAttribute("style",""),this.caretRef=this.elementRef.nativeElement.querySelector("span.cds--popover-caret")),this.handleChange(r)}ngAfterContentChecked(){if(this.wrapper){const n=this.wrapper.nativeElement.querySelector("button");n&&!n.getAttribute("aria-labelledby")&&n.setAttribute("aria-labelledby",this.id)}}}return t.tooltipCount=0,t.\u0275fac=function(n){return new(n||t)(vt(yl),vt(Ji),vt(Kc),vt(Pf))},t.\u0275cmp=Ra({type:t,selectors:[["cds-tooltip"],["ibm-tooltip"]],viewQuery:function(n,r){if(1&n&&Es(Mve,5),2&n){let s;yi(s=Mu())&&(r.wrapper=s.first)}},hostVars:2,hostBindings:function(n,r){1&n&&Ar("mouseenter",function(c){return r.mouseenter(c)})("mouseleave",function(c){return r.mouseleave(c)})("keyup",function(c){return r.hostkeys(c)})("focusin",function(c){return r.handleFocus(c)})("focusout",function(c){return r.handleFocusOut(c)}),2&n&&Xl("cds--tooltip",r.tooltipClass)},inputs:{id:"id",enterDelayMs:"enterDelayMs",leaveDelayMs:"leaveDelayMs",disabled:"disabled",description:"description",templateContext:"templateContext"},features:[_o,ml],ngContentSelectors:Uve,decls:4,vars:1,consts:[["contentWrapper",""],["class","cds--popover","role","tooltip",3,"id",4,"ngIf"],["role","tooltip",1,"cds--popover",3,"id"],[4,"ngIf"],[1,"cds--popover-content","cds--tooltip-content"],["class","cds--popover-caret cds--popover--auto-align",4,"ngIf"],["class","cds--popover-caret",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cds--popover-caret","cds--popover--auto-align"],[1,"cds--popover-caret"]],template:function(n,r){1&n&&(qd(),Gn(0,"span",null,0),Oa(2),_r(),mr(3,Bve,2,3,"span",1)),2&n&&(fn(3),un("ngIf",r.description))},dependencies:[dp,Ky],encapsulation:2,changeDetection:0}),t})(),Kve=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({imports:[ld,Rve]}),t})();const Wve=["*"],Yve=["button"];let bY=(()=>{class t{constructor(){this.cdsButton="primary",this.skeleton=!1,this.iconOnly=!1,this.isExpressive=!1,this.baseClass=!0}set ibmButton(n){this.cdsButton=n}get primaryButton(){return"primary"===this.cdsButton||!this.cdsButton}get secondaryButton(){return"secondary"===this.cdsButton}get tertiaryButton(){return"tertiary"===this.cdsButton}get ghostButton(){return"ghost"===this.cdsButton}get dangerButton(){return"danger"===this.cdsButton||"danger--primary"===this.cdsButton}get dangerTertiary(){return"danger--tertiary"===this.cdsButton}get dangerGhost(){return"danger--ghost"===this.cdsButton}get smallSize(){return"sm"===this.size&&!this.isExpressive}get mediumSize(){return"md"===this.size&&!this.isExpressive}get largeSize(){return"lg"===this.size}get extraLargeSize(){return"xl"===this.size}get twoExtraLargeSize(){return"2xl"===this.size}get smallLayoutSize(){return"sm"===this.size&&!this.isExpressive}get mediumLayoutSize(){return"md"===this.size&&!this.isExpressive}get largeLayoutSize(){return"lg"===this.size}get extraLargeLayoutSize(){return"xl"===this.size}get twoExtraLargeLayoutSize(){return"2xl"===this.size}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=vr({type:t,selectors:[["","cdsButton",""],["","ibmButton",""]],hostVars:42,hostBindings:function(n,r){2&n&&Xl("cds--skeleton",r.skeleton)("cds--btn--icon-only",r.iconOnly)("cds--btn--expressive",r.isExpressive)("cds--btn",r.baseClass)("cds--btn--primary",r.primaryButton)("cds--btn--secondary",r.secondaryButton)("cds--btn--tertiary",r.tertiaryButton)("cds--btn--ghost",r.ghostButton)("cds--btn--danger",r.dangerButton)("cds--btn--danger--tertiary",r.dangerTertiary)("cds--btn--danger--ghost",r.dangerGhost)("cds--btn--sm",r.smallSize)("cds--btn--md",r.mediumSize)("cds--btn--lg",r.largeSize)("cds--btn--xl",r.extraLargeSize)("cds--btn--2xl",r.twoExtraLargeSize)("cds--layout--size-sm",r.smallLayoutSize)("cds--layout--size-md",r.mediumLayoutSize)("cds--layout--size-lg",r.largeLayoutSize)("cds--layout--size-xl",r.extraLargeLayoutSize)("cds--layout--size-2xl",r.twoExtraLargeLayoutSize)},inputs:{ibmButton:"ibmButton",cdsButton:"cdsButton",size:"size",skeleton:"skeleton",iconOnly:"iconOnly",isExpressive:"isExpressive"}}),t})(),Zve=(()=>{class t{constructor(){this.caret=!0,this.dropShadow=!0,this.highContrast=!0,this.isOpen=!1,this.align="bottom",this.autoAlign=!1,this.enterDelayMs=100,this.leaveDelayMs=300}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Ra({type:t,selectors:[["ng-component"]],inputs:{caret:"caret",dropShadow:"dropShadow",highContrast:"highContrast",isOpen:"isOpen",align:"align",autoAlign:"autoAlign",enterDelayMs:"enterDelayMs",leaveDelayMs:"leaveDelayMs"},decls:0,vars:0,template:function(n,r){},encapsulation:2}),t})(),Qve=(()=>{class t extends Zve{constructor(n){super(),this.renderer=n,this.buttonId="icon-btn-"+t.iconButtonCounter++,this.kind="primary",this.size="lg",this.type="button",this.isExpressive=!1,this.disabled=!1,this.click=new Rr,this.focus=new Rr,this.blur=new Rr,this.tooltipClick=new Rr,this.classList={},this.attributeList={}}set buttonNgClass(n){this.classList=Object.assign({"cds--btn--disabled":this.disabled},n)}get buttonNgClass(){return this.classList}set buttonAttributes(n){this.button&&(Object.keys(this.attributeList).forEach(r=>{this.renderer.removeAttribute(this.button.nativeElement,r)}),Object.keys(n).forEach(r=>{this.renderer.setAttribute(this.button.nativeElement,r,n[r])})),this.attributeList=n}get buttonAttributes(){return this.buttonAttributes}ngAfterViewInit(){this.buttonAttributes=this.attributeList}emitClickEvent(n,r="button"){n.preventDefault(),n.stopPropagation(),"tooltip"!==r?this.click.emit(n):this.tooltipClick.emit(n)}}return t.iconButtonCounter=0,t.\u0275fac=function(n){return new(n||t)(vt(Kc))},t.\u0275cmp=Ra({type:t,selectors:[["cds-icon-button"],["ibm-icon-button"]],viewQuery:function(n,r){if(1&n&&Es(Yve,5),2&n){let s;yi(s=Mu())&&(r.button=s.first)}},inputs:{buttonNgClass:"buttonNgClass",buttonAttributes:"buttonAttributes",buttonId:"buttonId",kind:"kind",size:"size",type:"type",isExpressive:"isExpressive",disabled:"disabled",description:"description"},outputs:{click:"click",focus:"focus",blur:"blur",tooltipClick:"tooltipClick"},features:[_o],ngContentSelectors:Wve,decls:4,vars:18,consts:[[1,"cds--icon-tooltip",3,"description","disabled","caret","dropShadow","highContrast","isOpen","align","autoAlign","enterDelayMs","leaveDelayMs","click"],[3,"id","disabled","iconOnly","ngClass","cdsButton","size","isExpressive","click","focus","blur"],["button",""]],template:function(n,r){1&n&&(qd(),Gn(0,"cds-tooltip",0),Ar("click",function(c){return r.emitClickEvent(c,"tooltip")}),Gn(1,"button",1,2),Ar("click",function(c){return r.emitClickEvent(c)})("focus",function(c){return r.focus.emit(c)})("blur",function(c){return r.blur.emit(c)}),Oa(3),_r()()),2&n&&(un("description",r.description)("disabled",r.disabled)("caret",r.caret)("dropShadow",r.dropShadow)("highContrast",r.highContrast)("isOpen",r.isOpen)("align",r.align)("autoAlign",r.autoAlign)("enterDelayMs",r.enterDelayMs)("leaveDelayMs",r.leaveDelayMs),fn(1),un("id",r.buttonId)("disabled",r.disabled)("iconOnly",!0)("ngClass",r.buttonNgClass)("cdsButton",r.kind)("size",r.size)("isExpressive",r.isExpressive),ca("type",r.type))},dependencies:[hp,Gve,bY],encapsulation:2}),t})(),Soe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({imports:[ld,Kve]}),t})();const Xve=function(t,e,n){return{"cds--loading--small":t,"cds--loading--stop":e,"cds--loading-overlay--stop":n}};let Jve=(()=>{class t{constructor(n){this.i18n=n,this.title=this.i18n.get().LOADING.TITLE,this.isActive=!0,this.size="normal",this.overlay=!1}}return t.\u0275fac=function(n){return new(n||t)(vt(av))},t.\u0275cmp=Ra({type:t,selectors:[["cds-loading"],["ibm-loading"]],hostVars:2,hostBindings:function(n,r){2&n&&Xl("cds--loading-overlay",r.overlay)},inputs:{title:"title",isActive:"isActive",size:"size",overlay:"overlay"},decls:5,vars:6,consts:[[1,"cds--loading",3,"ngClass"],["viewBox","0 0 100 100",1,"cds--loading__svg"],["cx","50%","cy","50%","r","44",1,"cds--loading__stroke"]],template:function(n,r){1&n&&(Gn(0,"div",0),vc(),Gn(1,"svg",1)(2,"title"),Ho(3),_r(),Rs(4,"circle",2),_r()()),2&n&&(un("ngClass",sk(2,Xve,"sm"===r.size,!r.isActive&&!r.overlay,!r.isActive&&r.overlay)),fn(3),Xs(r.title))},dependencies:[hp],encapsulation:2}),t})(),e0e=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({imports:[ld,dY]}),t})();function lpe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Aoe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lpe(Object(n),!0).forEach(function(r){t0e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lpe(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function t0e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cpe(t,e){if(null==t)return{};var r,s,n=function n0e(t,e){if(null==t)return{};var s,c,n={},r=Object.keys(t);for(c=0;c<r.length;c++)!(e.indexOf(s=r[c])>=0)&&(n[s]=t[s]);return n}(t,e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(t);for(s=0;s<c.length;s++)!(e.indexOf(r=c[s])>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}var r0e=["width","height","viewBox"],i0e=["tabindex"],o0e={focusable:"false",preserveAspectRatio:"xMidYMid meet"};function Doe(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,n=t.height,r=t.viewBox,s=void 0===r?"0 0 ".concat(e," ").concat(n):r,c=cpe(t,r0e),f=c.tabindex,v=cpe(c,i0e),b=Aoe(Aoe(Aoe({},o0e),v),{},{width:e,height:n,viewBox:s});return b["aria-label"]||b["aria-labelledby"]||b.title?(b.role="img",null!=f&&(b.focusable="true",b.tabindex=f)):b["aria-hidden"]=!0,b}function upe(t){var e=t.elem,n=void 0===e?"svg":e,r=t.attrs,s=void 0===r?{}:r,c=t.content,v=(void 0===c?[]:c).map(upe).join("");return"svg"!==n?"<".concat(n," ").concat(hpe(s),">").concat(v,"</").concat(n,">"):"<".concat(n," ").concat(hpe(Doe(s)),">").concat(v,"</").concat(n,">")}function hpe(t){return Object.keys(t).reduce(function(e,n,r){var s="".concat(n,'="').concat(t[n],'"');return 0===r?s:e+" "+s},"")}var a0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M17 15L17 8 15 8 15 15 8 15 8 17 15 17 15 24 17 24 17 17 24 17 24 15z"}}],name:"add",size:16},l0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M17 15L17 8 15 8 15 15 8 15 8 17 15 17 15 24 17 24 17 17 24 17 24 15z"}}],name:"add",size:20},c0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M16 10a6 6 0 00-6 6v8a6 6 0 0012 0V16A6 6 0 0016 10zm-4.25 7.87h8.5v4.25h-8.5zM16 28.25A4.27 4.27 0 0111.75 24v-.13h8.5V24A4.27 4.27 0 0116 28.25zm4.25-12.13h-8.5V16a4.25 4.25 0 018.5 0zM30.66 19.21L24 13v9.1a4 4 0 008 0A3.83 3.83 0 0030.66 19.21zM28 24.35a2.25 2.25 0 01-2.25-2.25V17l3.72 3.47h0A2.05 2.05 0 0130.2 22 2.25 2.25 0 0128 24.35zM0 22.1a4 4 0 008 0V13L1.34 19.21A3.88 3.88 0 000 22.1zm2.48-1.56h0L6.25 17v5.1a2.25 2.25 0 01-4.5 0A2.05 2.05 0 012.48 20.54zM15 5.5A3.5 3.5 0 1011.5 9 3.5 3.5 0 0015 5.5zm-5.25 0A1.75 1.75 0 1111.5 7.25 1.77 1.77 0 019.75 5.5zM20.5 2A3.5 3.5 0 1024 5.5 3.5 3.5 0 0020.5 2zm0 5.25A1.75 1.75 0 1122.25 5.5 1.77 1.77 0 0120.5 7.25z"}}],name:"bee",size:16},u0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M16 10a6 6 0 00-6 6v8a6 6 0 0012 0V16A6 6 0 0016 10zm-4.25 7.87h8.5v4.25h-8.5zM16 28.25A4.27 4.27 0 0111.75 24v-.13h8.5V24A4.27 4.27 0 0116 28.25zm4.25-12.13h-8.5V16a4.25 4.25 0 018.5 0zM30.66 19.21L24 13v9.1a4 4 0 008 0A3.83 3.83 0 0030.66 19.21zM28 24.35a2.25 2.25 0 01-2.25-2.25V17l3.72 3.47h0A2.05 2.05 0 0130.2 22 2.25 2.25 0 0128 24.35zM0 22.1a4 4 0 008 0V13L1.34 19.21A3.88 3.88 0 000 22.1zm2.48-1.56h0L6.25 17v5.1a2.25 2.25 0 01-4.5 0A2.05 2.05 0 012.48 20.54zM15 5.5A3.5 3.5 0 1011.5 9 3.5 3.5 0 0015 5.5zm-5.25 0A1.75 1.75 0 1111.5 7.25 1.77 1.77 0 019.75 5.5zM20.5 2A3.5 3.5 0 1024 5.5 3.5 3.5 0 0020.5 2zm0 5.25A1.75 1.75 0 1122.25 5.5 1.77 1.77 0 0120.5 7.25z"}}],name:"bee",size:20},h0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M26,4h-4V2h-2v2h-8V2h-2v2H6C4.9,4,4,4.9,4,6v20c0,1.1,0.9,2,2,2h20c1.1,0,2-0.9,2-2V6C28,4.9,27.1,4,26,4z M26,26H6V12h20\tV26z M26,10H6V6h4v2h2V6h8v2h2V6h4V10z"}}],name:"calendar",size:16},d0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M13.5,30.8149a1.0011,1.0011,0,0,1-.4927-.13l-8.5-4.815A1,1,0,0,1,4,25V15a1,1,0,0,1,.5073-.87l8.5-4.815a1.0013,1.0013,0,0,1,.9854,0l8.5,4.815A1,1,0,0,1,23,15V25a1,1,0,0,1-.5073.87l-8.5,4.815A1.0011,1.0011,0,0,1,13.5,30.8149ZM6,24.417l7.5,4.2485L21,24.417V15.583l-7.5-4.2485L6,15.583Z"}},{elem:"path",attrs:{d:"M28,17H26V7.583L18.5,3.3345,10.4927,7.87,9.5073,6.13l8.5-4.815a1.0013,1.0013,0,0,1,.9854,0l8.5,4.815A1,1,0,0,1,28,7Z"}}],name:"carbon",size:16},p0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M13.5,30.8149a1.0011,1.0011,0,0,1-.4927-.13l-8.5-4.815A1,1,0,0,1,4,25V15a1,1,0,0,1,.5073-.87l8.5-4.815a1.0013,1.0013,0,0,1,.9854,0l8.5,4.815A1,1,0,0,1,23,15V25a1,1,0,0,1-.5073.87l-8.5,4.815A1.0011,1.0011,0,0,1,13.5,30.8149ZM6,24.417l7.5,4.2485L21,24.417V15.583l-7.5-4.2485L6,15.583Z"}},{elem:"path",attrs:{d:"M28,17H26V7.583L18.5,3.3345,10.4927,7.87,9.5073,6.13l8.5-4.815a1.0013,1.0013,0,0,1,.9854,0l8.5,4.815A1,1,0,0,1,28,7Z"}}],name:"carbon",size:20},f0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M24 12L16 22 8 12z"}}],name:"caret--down",size:16},m0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M20 24L10 16 20 8z"}}],name:"caret--left",size:16},g0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M12 8L22 16 12 24z"}}],name:"caret--right",size:16},y0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M8 20L16 10 24 20z"}}],name:"caret--up",size:16},_0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M13 24L4 15 5.414 13.586 13 21.171 26.586 7.586 28 9 13 24z"}}],name:"checkmark",size:16},v0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M8,1C4.1,1,1,4.1,1,8c0,3.9,3.1,7,7,7s7-3.1,7-7C15,4.1,11.9,1,8,1z M7,11L4.3,8.3l0.9-0.8L7,9.3l4-3.9l0.9,0.8L7,11z"}},{elem:"path",attrs:{d:"M7,11L4.3,8.3l0.9-0.8L7,9.3l4-3.9l0.9,0.8L7,11z","data-icon-path":"inner-path",opacity:"0"}}],name:"checkmark--filled",size:16},w0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M10,1c-4.9,0-9,4.1-9,9s4.1,9,9,9s9-4,9-9S15,1,10,1z M8.7,13.5l-3.2-3.2l1-1l2.2,2.2l4.8-4.8l1,1L8.7,13.5z"}},{elem:"path",attrs:{fill:"none",d:"M8.7,13.5l-3.2-3.2l1-1l2.2,2.2l4.8-4.8l1,1L8.7,13.5z","data-icon-path":"inner-path",opacity:"0"}}],name:"checkmark--filled",size:20},b0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M14 21.414L9 16.413 10.413 15 14 18.586 21.585 11 23 12.415 14 21.414z"}},{elem:"path",attrs:{d:"M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Zm0,26A12,12,0,1,1,28,16,12,12,0,0,1,16,28Z"}}],name:"checkmark--outline",size:16},E0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M8 11L3 6 3.7 5.3 8 9.6 12.3 5.3 13 6z"}}],name:"chevron--down",size:16},x0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M11 8L6 13 5.3 12.3 9.6 8 5.3 3.7 6 3z"}}],name:"chevron--right",size:16},T0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M7.7 4.7a14.7 14.7 0 00-3 3.1L6.3 9A13.26 13.26 0 018.9 6.3zM4.6 12.3l-1.9-.6A12.51 12.51 0 002 16H4A11.48 11.48 0 014.6 12.3zM2.7 20.4a14.4 14.4 0 002 3.9l1.6-1.2a12.89 12.89 0 01-1.7-3.3zM7.8 27.3a14.4 14.4 0 003.9 2l.6-1.9A12.89 12.89 0 019 25.7zM11.7 2.7l.6 1.9A11.48 11.48 0 0116 4V2A12.51 12.51 0 0011.7 2.7zM24.2 27.3a15.18 15.18 0 003.1-3.1L25.7 23A11.53 11.53 0 0123 25.7zM27.4 19.7l1.9.6A15.47 15.47 0 0030 16H28A11.48 11.48 0 0127.4 19.7zM29.2 11.6a14.4 14.4 0 00-2-3.9L25.6 8.9a12.89 12.89 0 011.7 3.3zM24.1 4.6a14.4 14.4 0 00-3.9-2l-.6 1.9a12.89 12.89 0 013.3 1.7zM20.3 29.3l-.6-1.9A11.48 11.48 0 0116 28v2A21.42 21.42 0 0020.3 29.3z"}}],name:"circle-dash",size:16},C0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"}}],name:"close",size:16},I0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"}}],name:"close",size:20},S0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z"}},{elem:"path",attrs:{d:"M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z"}}],name:"copy",size:16},A0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z"}},{elem:"path",attrs:{d:"M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z"}}],name:"copy",size:20},D0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M4 6H15V8H4zM18 6H28V8H18zM21 12H28V14H21zM11 12H18V14H11zM4 12H8V14H4zM4 18H28V20H4zM4 24H21V26H4zM24 24H28V26H24z"}}],name:"data--2",size:16},P0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M4 6H15V8H4zM18 6H28V8H18zM21 12H28V14H21zM11 12H18V14H11zM4 12H8V14H4zM4 18H28V20H4zM4 24H21V26H4zM24 24H28V26H24z"}}],name:"data--2",size:20},R0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M25.7,9.3l-7-7C18.5,2.1,18.3,2,18,2H8C6.9,2,6,2.9,6,4v24c0,1.1,0.9,2,2,2h16c1.1,0,2-0.9,2-2V10C26,9.7,25.9,9.5,25.7,9.3\tz M18,4.4l5.6,5.6H18V4.4z M24,28H8V4h8v6c0,1.1,0.9,2,2,2h6V28z"}},{elem:"path",attrs:{d:"M10 22H22V24H10zM10 16H22V18H10z"}}],name:"document",size:16},M0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M25.7,9.3l-7-7C18.5,2.1,18.3,2,18,2H8C6.9,2,6,2.9,6,4v24c0,1.1,0.9,2,2,2h16c1.1,0,2-0.9,2-2V10C26,9.7,25.9,9.5,25.7,9.3\tz M18,4.4l5.6,5.6H18V4.4z M24,28H8V4h8v6c0,1.1,0.9,2,2,2h6V28z"}},{elem:"path",attrs:{d:"M10 22H22V24H10zM10 16H22V18H10z"}}],name:"document",size:20},k0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M13 7L12.3 6.3 8.5 10.1 8.5 1 7.5 1 7.5 10.1 3.7 6.3 3 7 8 12zM13 12v2H3v-2H2v2l0 0c0 .6.4 1 1 1h10c.6 0 1-.4 1-1l0 0v-2H13z"}}],name:"download",size:16},O0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M8,1C4.1,1,1,4.1,1,8s3.1,7,7,7s7-3.1,7-7S11.9,1,8,1z M10.7,11.5L4.5,5.3l0.8-0.8l6.2,6.2L10.7,11.5z"}},{elem:"path",attrs:{fill:"none",d:"M10.7,11.5L4.5,5.3l0.8-0.8l6.2,6.2L10.7,11.5z","data-icon-path":"inner-path",opacity:"0"}}],name:"error--filled",size:16},N0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M10,1c-5,0-9,4-9,9s4,9,9,9s9-4,9-9S15,1,10,1z M13.5,14.5l-8-8l1-1l8,8L13.5,14.5z"}},{elem:"path",attrs:{d:"M13.5,14.5l-8-8l1-1l8,8L13.5,14.5z","data-icon-path":"inner-path",opacity:"0"}}],name:"error--filled",size:20},L0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M4.1 12.6l-.6.8c.6.5 1.3.9 2.1 1.2l.3-.9C5.3 13.4 4.7 13 4.1 12.6zM2.1 9l-1 .2c.1.8.4 1.6.8 2.3L2.8 11C2.4 10.4 2.2 9.7 2.1 9zM5.9 2.4L5.6 1.4C4.8 1.7 4.1 2.1 3.5 2.7l.6.8C4.7 3 5.3 2.6 5.9 2.4zM2.8 5L1.9 4.5C1.5 5.2 1.3 6 1.1 6.8l1 .2C2.2 6.3 2.5 5.6 2.8 5zM8 1v1c3.3 0 6 2.7 6 6s-2.7 6-6 6v1c3.9 0 7-3.1 7-7S11.9 1 8 1z"}}],name:"fade",size:16},F0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M8.24 25.14L7 26.67a13.79 13.79 0 004.18 2.44l.69-1.87A12 12 0 018.24 25.14zM4.19 18l-2 .41A14.09 14.09 0 003.86 23L5.59 22A12.44 12.44 0 014.19 18zM11.82 4.76l-.69-1.87A13.79 13.79 0 007 5.33L8.24 6.86A12 12 0 0111.82 4.76zM5.59 10L3.86 9a14.37 14.37 0 00-1.64 4.59l2 .34A12.05 12.05 0 015.59 10zM16 2V4a12 12 0 010 24v2A14 14 0 0016 2z"}}],name:"fade",size:20},V0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M11.17,6l3.42,3.41.58.59H28V26H4V6h7.17m0-2H4A2,2,0,0,0,2,6V26a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2H16L12.59,4.59A2,2,0,0,0,11.17,4Z"}}],name:"folder",size:16},B0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M23.7642 6.8593l1.2851-1.5315A13.976 13.976 0 0020.8672 2.887l-.6836 1.8776A11.9729 11.9729 0 0123.7642 6.8593zM27.81 14l1.9677-.4128A13.8888 13.8888 0 0028.14 9.0457L26.4087 10A12.52 12.52 0 0127.81 14zM20.1836 27.2354l.6836 1.8776a13.976 13.976 0 004.1821-2.4408l-1.2851-1.5315A11.9729 11.9729 0 0120.1836 27.2354zM26.4087 22L28.14 23a14.14 14.14 0 001.6382-4.5872L27.81 18.0659A12.1519 12.1519 0 0126.4087 22zM16 30V2a14 14 0 000 28z"}}],name:"incomplete",size:16},U0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{fill:"none",d:"M16,8a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,16,8Zm4,13.875H17.125v-8H13v2.25h1.875v5.75H12v2.25h8Z","data-icon-path":"inner-path"}},{elem:"path",attrs:{d:"M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Zm0,6a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,16,8Zm4,16.125H12v-2.25h2.875v-5.75H13v-2.25h4.125v8H20Z"}}],name:"information--filled",size:16},z0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{fill:"none",d:"M16,8a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,16,8Zm4,13.875H17.125v-8H13v2.25h1.875v5.75H12v2.25h8Z","data-icon-path":"inner-path"}},{elem:"path",attrs:{d:"M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Zm0,6a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,16,8Zm4,16.125H12v-2.25h2.875v-5.75H13v-2.25h4.125v8H20Z"}}],name:"information--filled",size:20},j0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{fill:"none",d:"M16,8a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,16,8Zm4,13.875H17.125v-8H13v2.25h1.875v5.75H12v2.25h8Z","data-icon-path":"inner-path"}},{elem:"path",attrs:{d:"M26,4H6A2,2,0,0,0,4,6V26a2,2,0,0,0,2,2H26a2,2,0,0,0,2-2V6A2,2,0,0,0,26,4ZM16,8a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,16,8Zm4,16.125H12v-2.25h2.875v-5.75H13v-2.25h4.125v8H20Z"}}],name:"information--square--filled",size:20},H0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M2 12H14V13H2zM2 9H14V10H2zM2 6H14V7H2zM2 3H14V4H2z"}}],name:"menu",size:16},$0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M2 14.8H18V16H2zM2 11.2H18V12.399999999999999H2zM2 7.6H18V8.799999999999999H2zM2 4H18V5.2H2z"}}],name:"menu",size:20},q0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"circle",attrs:{cx:"16",cy:"8",r:"2"}},{elem:"circle",attrs:{cx:"16",cy:"16",r:"2"}},{elem:"circle",attrs:{cx:"16",cy:"24",r:"2"}}],name:"overflow-menu--vertical",size:16},G0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"circle",attrs:{cx:"8",cy:"16",r:"2"}},{elem:"circle",attrs:{cx:"16",cy:"16",r:"2"}},{elem:"circle",attrs:{cx:"24",cy:"16",r:"2"}}],name:"overflow-menu--horizontal",size:16},K0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M13.9,4.6l-2.5-2.5C11.3,2.1,11.1,2,11,2H3C2.4,2,2,2.4,2,3v10c0,0.6,0.4,1,1,1h10c0.6,0,1-0.4,1-1V5\tC14,4.9,13.9,4.7,13.9,4.6z M6,3h4v2H6V3z M10,13H6V9h4V13z M11,13V9c0-0.6-0.4-1-1-1H6C5.4,8,5,8.4,5,9v4H3V3h2v2c0,0.6,0.4,1,1,1\th4c0.6,0,1-0.4,1-1V3.2l2,2V13H11z"}}],name:"save",size:16},W0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M15,14.3L10.7,10c1.9-2.3,1.6-5.8-0.7-7.7S4.2,0.7,2.3,3S0.7,8.8,3,10.7c2,1.7,5,1.7,7,0l4.3,4.3L15,14.3z M2,6.5\tC2,4,4,2,6.5,2S11,4,11,6.5S9,11,6.5,11S2,9,2,6.5z"}}],name:"search",size:16},Y0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M13.5,8.4c0-0.1,0-0.3,0-0.4c0-0.1,0-0.3,0-0.4l1-0.8c0.4-0.3,0.4-0.9,0.2-1.3l-1.2-2C13.3,3.2,13,3,12.6,3\tc-0.1,0-0.2,0-0.3,0.1l-1.2,0.4c-0.2-0.1-0.4-0.3-0.7-0.4l-0.3-1.3C10.1,1.3,9.7,1,9.2,1H6.8c-0.5,0-0.9,0.3-1,0.8L5.6,3.1\tC5.3,3.2,5.1,3.3,4.9,3.4L3.7,3C3.6,3,3.5,3,3.4,3C3,3,2.7,3.2,2.5,3.5l-1.2,2C1.1,5.9,1.2,6.4,1.6,6.8l0.9,0.9c0,0.1,0,0.3,0,0.4\tc0,0.1,0,0.3,0,0.4L1.6,9.2c-0.4,0.3-0.5,0.9-0.2,1.3l1.2,2C2.7,12.8,3,13,3.4,13c0.1,0,0.2,0,0.3-0.1l1.2-0.4\tc0.2,0.1,0.4,0.3,0.7,0.4l0.3,1.3c0.1,0.5,0.5,0.8,1,0.8h2.4c0.5,0,0.9-0.3,1-0.8l0.3-1.3c0.2-0.1,0.4-0.2,0.7-0.4l1.2,0.4\tc0.1,0,0.2,0.1,0.3,0.1c0.4,0,0.7-0.2,0.9-0.5l1.1-2c0.2-0.4,0.2-0.9-0.2-1.3L13.5,8.4z M12.6,12l-1.7-0.6c-0.4,0.3-0.9,0.6-1.4,0.8\tL9.2,14H6.8l-0.4-1.8c-0.5-0.2-0.9-0.5-1.4-0.8L3.4,12l-1.2-2l1.4-1.2c-0.1-0.5-0.1-1.1,0-1.6L2.2,6l1.2-2l1.7,0.6\tC5.5,4.2,6,4,6.5,3.8L6.8,2h2.4l0.4,1.8c0.5,0.2,0.9,0.5,1.4,0.8L12.6,4l1.2,2l-1.4,1.2c0.1,0.5,0.1,1.1,0,1.6l1.4,1.2L12.6,12z"}},{elem:"path",attrs:{d:"M8,11c-1.7,0-3-1.3-3-3s1.3-3,3-3s3,1.3,3,3C11,9.6,9.7,11,8,11C8,11,8,11,8,11z M8,6C6.9,6,6,6.8,6,7.9C6,7.9,6,8,6,8\tc0,1.1,0.8,2,1.9,2c0,0,0.1,0,0.1,0c1.1,0,2-0.8,2-1.9c0,0,0-0.1,0-0.1C10,6.9,9.2,6,8,6C8.1,6,8,6,8,6z"}}],name:"settings",size:16},Z0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M30 8h-4.1c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2v2h14.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30V8zM21 12c-1.7 0-3-1.3-3-3s1.3-3 3-3 3 1.3 3 3S22.7 12 21 12zM2 24h4.1c.5 2.3 2.5 4 4.9 4s4.4-1.7 4.9-4H30v-2H15.9c-.5-2.3-2.5-4-4.9-4s-4.4 1.7-4.9 4H2V24zM11 20c1.7 0 3 1.3 3 3s-1.3 3-3 3-3-1.3-3-3S9.3 20 11 20z"}}],name:"settings--adjust",size:16},Q0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M8 15H24V17H8z"}}],name:"subtract",size:16},X0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M12 12H14V24H12zM18 12H20V24H18z"}},{elem:"path",attrs:{d:"M4 6V8H6V28a2 2 0 002 2H24a2 2 0 002-2V8h2V6zM8 28V8H24V28zM12 2H20V4H12z"}}],name:"trash-can",size:16},J0e={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M8,1C4.1,1,1,4.1,1,8s3.1,7,7,7s7-3.1,7-7S11.9,1,8,1z M8,14c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S11.3,14,8,14z"}},{elem:"path",attrs:{d:"M7.5 4H8.5V9H7.5zM8 10.2c-.4 0-.8.3-.8.8s.3.8.8.8c.4 0 .8-.3.8-.8S8.4 10.2 8 10.2z"}}],name:"warning",size:16},ewe={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M8,1C4.2,1,1,4.2,1,8s3.2,7,7,7s7-3.1,7-7S11.9,1,8,1z M7.5,4h1v5h-1C7.5,9,7.5,4,7.5,4z M8,12.2\tc-0.4,0-0.8-0.4-0.8-0.8s0.3-0.8,0.8-0.8c0.4,0,0.8,0.4,0.8,0.8S8.4,12.2,8,12.2z"}},{elem:"path",attrs:{d:"M7.5,4h1v5h-1C7.5,9,7.5,4,7.5,4z M8,12.2c-0.4,0-0.8-0.4-0.8-0.8s0.3-0.8,0.8-0.8\tc0.4,0,0.8,0.4,0.8,0.8S8.4,12.2,8,12.2z","data-icon-path":"inner-path",opacity:"0"}}],name:"warning--filled",size:16},twe={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{d:"M10,1c-5,0-9,4-9,9s4,9,9,9s9-4,9-9S15,1,10,1z M9.2,5h1.5v7H9.2V5z M10,16c-0.6,0-1-0.4-1-1s0.4-1,1-1\ts1,0.4,1,1S10.6,16,10,16z"}},{elem:"path",attrs:{d:"M9.2,5h1.5v7H9.2V5z M10,16c-0.6,0-1-0.4-1-1s0.4-1,1-1s1,0.4,1,1S10.6,16,10,16z","data-icon-path":"inner-path",opacity:"0"}}],name:"warning--filled",size:20},nwe={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{fill:"none",d:"M16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Zm-1.125-5h2.25V12h-2.25Z","data-icon-path":"inner-path"}},{elem:"path",attrs:{d:"M16.002,6.1714h-.004L4.6487,27.9966,4.6506,28H27.3494l.0019-.0034ZM14.875,12h2.25v9h-2.25ZM16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Z"}},{elem:"path",attrs:{d:"M29,30H3a1,1,0,0,1-.8872-1.4614l13-25a1,1,0,0,1,1.7744,0l13,25A1,1,0,0,1,29,30ZM4.6507,28H27.3493l.002-.0033L16.002,6.1714h-.004L4.6487,27.9967Z"}}],name:"warning--alt--filled",size:16},rwe={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:20,height:20},content:[{elem:"path",attrs:{fill:"none",d:"M16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Zm-1.125-5h2.25V12h-2.25Z","data-icon-path":"inner-path"}},{elem:"path",attrs:{d:"M16.002,6.1714h-.004L4.6487,27.9966,4.6506,28H27.3494l.0019-.0034ZM14.875,12h2.25v9h-2.25ZM16,26a1.5,1.5,0,1,1,1.5-1.5A1.5,1.5,0,0,1,16,26Z"}},{elem:"path",attrs:{d:"M29,30H3a1,1,0,0,1-.8872-1.4614l13-25a1,1,0,0,1,1.7744,0l13,25A1,1,0,0,1,29,30ZM4.6507,28H27.3493l.002-.0033L16.002,6.1714h-.004L4.6487,27.9967Z"}}],name:"warning--alt--filled",size:20},iwe={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M15.5,7.8C14.3,4.7,11.3,2.6,8,2.5C4.7,2.6,1.7,4.7,0.5,7.8c0,0.1,0,0.2,0,0.3c1.2,3.1,4.1,5.2,7.5,5.3\tc3.3-0.1,6.3-2.2,7.5-5.3C15.5,8.1,15.5,7.9,15.5,7.8z M8,12.5c-2.7,0-5.4-2-6.5-4.5c1-2.5,3.8-4.5,6.5-4.5s5.4,2,6.5,4.5\tC13.4,10.5,10.6,12.5,8,12.5z"}},{elem:"path",attrs:{d:"M8,5C6.3,5,5,6.3,5,8s1.3,3,3,3s3-1.3,3-3S9.7,5,8,5z M8,10c-1.1,0-2-0.9-2-2s0.9-2,2-2s2,0.9,2,2S9.1,10,8,10z"}}],name:"view",size:16},owe={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},content:[{elem:"path",attrs:{d:"M2.6,11.3l0.7-0.7C2.6,9.8,1.9,9,1.5,8c1-2.5,3.8-4.5,6.5-4.5c0.7,0,1.4,0.1,2,0.4l0.8-0.8C9.9,2.7,9,2.5,8,2.5\tC4.7,2.6,1.7,4.7,0.5,7.8c0,0.1,0,0.2,0,0.3C1,9.3,1.7,10.4,2.6,11.3z"}},{elem:"path",attrs:{d:"M6 7.9c.1-1 .9-1.8 1.8-1.8l.9-.9C7.2 4.7 5.5 5.6 5.1 7.2 5 7.7 5 8.3 5.1 8.8L6 7.9zM15.5 7.8c-.6-1.5-1.6-2.8-2.9-3.7L15 1.7 14.3 1 1 14.3 1.7 15l2.6-2.6c1.1.7 2.4 1 3.7 1.1 3.3-.1 6.3-2.2 7.5-5.3C15.5 8.1 15.5 7.9 15.5 7.8zM10 8c0 1.1-.9 2-2 2-.3 0-.7-.1-1-.3L9.7 7C9.9 7.3 10 7.6 10 8zM8 12.5c-1 0-2.1-.3-3-.8l1.3-1.3c1.4.9 3.2.6 4.2-.8.7-1 .7-2.4 0-3.4l1.4-1.4c1.1.8 2 1.9 2.6 3.2C13.4 10.5 10.6 12.5 8 12.5z"}}],name:"view--off",size:16};class swe{}class awe extends Error{constructor(e){super(`Icon ${e} not found`)}}class lwe extends Error{constructor(e,n){super("Size ${size} for ${name} not found")}}class cwe extends swe{constructor(){super(...arguments),this.iconMap=new Map}get(e,n){if(!this.iconMap.has(e))throw new awe(e);const r=this.iconMap.get(e);if(!r.has(n))throw new lwe(n,e);return r.get(n)}set(e,n,r){this.iconMap.has(e)||this.iconMap.set(e,new Map),this.iconMap.get(e).set(n,r)}}let bj=(()=>{class t{constructor(){this.iconCache=new cwe}registerAll(n){n.forEach(r=>this.register(r))}register(n){const{name:r}=n;this.registerAs(r,n)}registerAs(n,r){const{size:s}=r;this.iconCache.set(n,s.toString(),r)}get(n,r){try{const s=this.iconCache.get(n,r.toString());return s.svg||(s.svg=upe(s)),s}catch(s){throw s}}configure(n){this.iconCache=n.cache}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})(),EY=(()=>{class t{constructor(n,r){this.elementRef=n,this.iconService=r,this.cdsIcon="",this.size="16",this.title="",this.ariaLabel="",this.ariaLabelledBy="",this.ariaHidden="",this.isFocusable=!1}set ibmIcon(n){this.cdsIcon=n}renderIcon(n){const r=this.elementRef.nativeElement;let s;try{s=this.iconService.get(n,this.size.toString())}catch(H){return void console.warn(H)}const v=(new DOMParser).parseFromString(s.svg,"image/svg+xml").documentElement;let b="SVG"!==r.tagName.toUpperCase()?v:v.firstChild;for(r.innerHTML="";b;)r.appendChild(r.ownerDocument.importNode(b,!0)),b=b.nextSibling;const S="SVG"!==r.tagName.toUpperCase()?v:r;S.setAttribute("xmlns","http://www.w3.org/2000/svg");const k=Doe({width:s.attrs.width,height:s.attrs.height,viewBox:s.attrs.viewBox,title:this.title,"aria-label":this.ariaLabel,"aria-labelledby":this.ariaLabelledBy,"aria-hidden":this.ariaHidden,focusable:this.isFocusable.toString()}),F=Object.keys(k);for(let H=0;H<F.length;H++){const Q=F[H],de=k[Q];"title"!==Q&&de&&S.setAttribute(Q,de)}if(k.title){const H=document.createElement("title");H.textContent=k.title,t.titleIdCounter++,H.setAttribute("id",`${s.name}-title-${t.titleIdCounter}`),S.insertBefore(H,S.firstElementChild),S.setAttribute("aria-labelledby",`${s.name}-title-${t.titleIdCounter}`)}}ngAfterViewInit(){this.renderIcon(this.cdsIcon)}ngOnChanges({cdsIcon:n}){n&&!n.isFirstChange()&&this.renderIcon(this.cdsIcon)}}return t.titleIdCounter=0,t.\u0275fac=function(n){return new(n||t)(vt(yl),vt(bj))},t.\u0275dir=vr({type:t,selectors:[["","cdsIcon",""],["","ibmIcon",""]],inputs:{ibmIcon:"ibmIcon",cdsIcon:"cdsIcon",size:"size",title:"title",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",ariaHidden:"ariaHidden",isFocusable:"isFocusable"},features:[ml]}),t})();const hwe={provide:bj,deps:[[new zd,new jd,bj]],useFactory:function uwe(t){return t||new bj}};let xY=(()=>{class t{constructor(n){this.iconService=n,n.registerAll([a0e,l0e,c0e,u0e,h0e,d0e,p0e,f0e,m0e,g0e,y0e,_0e,v0e,w0e,b0e,E0e,x0e,T0e,C0e,I0e,S0e,A0e,D0e,P0e,R0e,M0e,k0e,O0e,N0e,L0e,F0e,V0e,B0e,U0e,z0e,j0e,H0e,$0e,q0e,G0e,K0e,W0e,Y0e,Z0e,Q0e,X0e,iwe,owe,J0e,ewe,twe,nwe,rwe])}}return t.\u0275fac=function(n){return new(n||t)(hr(bj))},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({providers:[hwe],imports:[ld]}),t})();function dwe(t,e){1&t&&(vc(),Rs(0,"svg",8))}function pwe(t,e){if(1&t){const n=$d();Gn(0,"span",4),mr(1,dwe,1,0,"svg",5),Gn(2,"button",6),Ar("click",function(){return va(n),Zs(or().remove.emit())})("keyup.enter",function(){return va(n),Zs(or().remove.emit())})("keyup.space",function(){return va(n),Zs(or().remove.emit())}),vc(),Rs(3,"svg",7),_r()()}if(2&t){const n=or();fn(1),un("ngIf",n.isInvalidText),fn(1),ca("aria-label",n.translations.REMOVE_BUTTON)}}function fwe(t,e){1&t&&(Gn(0,"span")(1,"div",9),Rs(2,"cds-loading",10),_r()())}function mwe(t,e){if(1&t&&(Gn(0,"span",4),vc(),Rs(1,"svg",11),_r()),2&t){const n=or();fn(1),un("ariaLabel",n.translations.CHECKMARK)}}function gwe(t,e){if(1&t&&(Gn(0,"div",12)(1,"div",13),Ho(2),_r(),Gn(3,"p",14),Ho(4),_r()()),2&t){const n=or();fn(2),Xs(n.fileItem.invalidTitle),fn(2),Xs(n.fileItem.invalidText)}}const ywe=["fileInput"];function _we(t,e){if(1&t&&(bc(0),Ho(1),Qc()),2&t){const n=or(3);fn(1),Xs(n.dropText)}}function vwe(t,e){}function wwe(t,e){1&t&&mr(0,vwe,0,0,"ng-template",14),2&t&&un("ngTemplateOutlet",or(3).dropText)}const bwe=function(t){return{"cds--file-browse-btn--disabled":t}},Ewe=function(t){return{"cds--file__drop-container--drag-over":t}};function xwe(t,e){if(1&t){const n=$d();Gn(0,"label",11),Ar("keyup.enter",function(){return va(n),or(),Zs(Ql(9).click())})("keyup.space",function(){return va(n),or(),Zs(Ql(9).click())}),Gn(1,"div",12),Ar("click",function(){return va(n),or(),Zs(Ql(9).click())})("dragover",function(s){return va(n),Zs(or(2).onDragOver(s))})("dragleave",function(s){return va(n),Zs(or(2).onDragLeave(s))})("drop",function(s){return va(n),Zs(or(2).onDrop(s))}),mr(2,_we,2,1,"ng-container",13),mr(3,wwe,1,1,null,13),_r()()}if(2&t){const n=or(2);un("ngClass",vh(5,bwe,n.disabled)),fn(1),un("ngClass",vh(7,Ewe,n.dragOver)),ca("for",n.fileUploaderId),fn(1),un("ngIf",!n.isTemplate(n.dropText)),fn(1),un("ngIf",n.isTemplate(n.dropText))}}function Twe(t,e){if(1&t){const n=$d();Gn(0,"button",15),Ar("click",function(){return va(n),or(),Zs(Ql(9).click())}),Ho(1),_r()}if(2&t){const n=or(2);un("cdsButton",n.buttonType)("size",n.size)("disabled",n.disabled),ca("for",n.fileUploaderId),fn(1),rE(" ",n.buttonText," ")}}function Cwe(t,e){if(1&t){const n=$d();bc(0),Gn(1,"cds-file",16),Ar("remove",function(){const c=va(n).$implicit;return Zs(or(2).removeFile(c))}),_r(),Qc()}if(2&t){const n=e.$implicit,r=or(2);fn(1),un("fileItem",n)("size",r.fileItemSize)}}function Iwe(t,e){if(1&t){const n=$d();bc(0),Gn(1,"label",2),Ho(2),_r(),Gn(3,"p",3),Ho(4),_r(),Gn(5,"div",4),mr(6,xwe,4,9,"label",5),mr(7,Twe,2,5,"button",6),Gn(8,"input",7,8),Ar("change",function(){return va(n),Zs(or().onFilesAdded())}),_r(),Gn(10,"div",9),mr(11,Cwe,2,2,"ng-container",10),_r()(),Qc()}if(2&t){const n=or();fn(1),un("for",n.fileUploaderId),fn(1),Xs(n.title),fn(2),Xs(n.description),fn(2),un("ngIf",n.drop),fn(1),un("ngIf",!n.drop),fn(1),un("accept",n.accept)("id",n.fileUploaderId)("multiple",n.multiple)("disabled",n.disabled),fn(3),un("ngForOf",n.files)}}function Swe(t,e){1&t&&Rs(0,"div",17)(1,"div",18)(2,"button",19)}let Awe=(()=>{class t{constructor(n){this.i18n=n,this.translations=this.i18n.get().FILE_UPLOADER,this.size="lg",this.remove=new Rr,this.selectedFile=!0}get isInvalidText(){return this.fileItem.invalidText}get fileSizeSmall(){return"sm"===this.size}get fileSizeMedium(){return"md"===this.size}get fileSizeLarge(){return"lg"===this.size}ngOnDestroy(){this.remove.emit()}}return t.\u0275fac=function(n){return new(n||t)(vt(av))},t.\u0275cmp=Ra({type:t,selectors:[["cds-file"],["ibm-file"]],hostVars:10,hostBindings:function(n,r){2&n&&Xl("cds--file__selected-file",r.selectedFile)("cds--file__selected-file--invalid",r.isInvalidText)("cds--file__selected-file--sm",r.fileSizeSmall)("cds--file__selected-file--md",r.fileSizeMedium)("cds--file__selected-file--lg",r.fileSizeLarge)},inputs:{translations:"translations",fileItem:"fileItem",size:"size"},outputs:{remove:"remove"},decls:6,vars:6,consts:[[1,"cds--file-filename",3,"title"],["class","cds--file__state-container",4,"ngIf"],[4,"ngIf"],["class","cds--form-requirement","role","alert",4,"ngIf"],[1,"cds--file__state-container"],["cdsIcon","warning--filled","class","cds--file--invalid","size","16",4,"ngIf"],["type","button","tabindex","0",1,"cds--file-close",3,"click","keyup.enter","keyup.space"],["cdsIcon","close","size","16"],["cdsIcon","warning--filled","size","16",1,"cds--file--invalid"],[1,"cds--inline-loading__animation"],["size","sm"],["cdsIcon","checkmark--filled","size","16",1,"cds--file-complete",3,"ariaLabel"],["role","alert",1,"cds--form-requirement"],[1,"cds--form-requirement__title"],[1,"cds--form-requirement__supplement"]],template:function(n,r){1&n&&(Gn(0,"p",0),Ho(1),_r(),mr(2,pwe,4,2,"span",1),mr(3,fwe,3,0,"span",2),mr(4,mwe,2,1,"span",1),mr(5,gwe,5,2,"div",3)),2&n&&(un("title",r.fileItem.file.name),fn(1),Xs(r.fileItem.file.name),fn(1),un("ngIf","edit"===r.fileItem.state),fn(1),un("ngIf","upload"===r.fileItem.state),fn(1),un("ngIf","complete"===r.fileItem.state),fn(1),un("ngIf",r.fileItem.invalid))},dependencies:[dp,Jve,EY],encapsulation:2}),t})();const dpe=()=>{};let Dwe=(()=>{class t{constructor(n){this.i18n=n,this.buttonText=this.i18n.get().FILE_UPLOADER.OPEN,this.buttonType="primary",this.accept=[],this.multiple=!0,this.skeleton=!1,this.fileItemSize="lg",this.drop=!1,this.fileUploaderId=`file-uploader-${t.fileUploaderCount}`,this.files=new Set,this.disabled=!1,this.filesChange=new Rr,this.dragOver=!1,this.onTouchedCallback=dpe,this.onChangeCallback=dpe,t.fileUploaderCount++}get value(){return this.files}set value(n){n!==this.files&&(this.files=n,this.onChangeCallback(n))}onBlur(){this.onTouchedCallback()}get fileList(){return Array.from(this.fileInput.nativeElement.files)}writeValue(n){n!==this.value&&(this.files=n)}createFileItem(n){return{uploaded:!1,state:"edit",invalid:!1,invalidText:"",file:n}}onFilesAdded(){const n=new Set(this.files);this.multiple||n.clear();for(let r of this.fileList){const s=this.createFileItem(r);n.add(s)}this.value=n,this.filesChange.emit(n)}onDragOver(n){n.stopPropagation(),n.preventDefault(),!this.disabled&&(this.dragOver=!0)}onDragLeave(n){n.stopPropagation(),n.preventDefault(),this.dragOver=!1}onDrop(n){if(n.stopPropagation(),n.preventDefault(),this.disabled)return;const r=Array.from(n.dataTransfer.files),s=new Set(this.files);r.filter(({name:c,type:f})=>{const v=c.split(".").pop().replace(/^/,".");return this.accept.includes(f)||this.accept.includes(v)||!this.accept.length}).forEach(c=>{if(!s.size||this.multiple){const f=this.createFileItem(c);s.add(f)}}),this.value=s,this.filesChange.emit(s),this.dragOver=!1}removeFile(n){if(this.files&&this.files.has(n)){const r=new Set(this.files);r.delete(n),this.filesChange.emit(r),this.value=r}this.fileInput.nativeElement.value=""}isTemplate(n){return n instanceof nd}registerOnTouched(n){this.onTouchedCallback=n}registerOnChange(n){this.onChangeCallback=n}setDisabledState(n){this.disabled=n}}return t.fileUploaderCount=0,t.\u0275fac=function(n){return new(n||t)(vt(av))},t.\u0275cmp=Ra({type:t,selectors:[["cds-file-uploader"],["ibm-file-uploader"]],viewQuery:function(n,r){if(1&n&&Es(ywe,5),2&n){let s;yi(s=Mu())&&(r.fileInput=s.first)}},inputs:{buttonText:"buttonText",buttonType:"buttonType",title:"title",description:"description",accept:"accept",multiple:"multiple",skeleton:"skeleton",size:"size",fileItemSize:"fileItemSize",drop:"drop",dropText:"dropText",fileUploaderId:"fileUploaderId",files:"files",disabled:"disabled"},outputs:{filesChange:"filesChange"},features:[ns([{provide:Wi,useExisting:t,multi:!0}])],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["skeletonTemplate",""],[1,"cds--file--label",3,"for"],["role","alert",1,"cds--label-description"],[1,"cds--file"],["class","cds--file-browse-btn","tabindex","0",3,"ngClass","keyup.enter","keyup.space",4,"ngIf"],["type","button",3,"cdsButton","size","disabled","click",4,"ngIf"],["type","file","tabindex","-1",1,"cds--file-input",3,"accept","id","multiple","disabled","change"],["fileInput",""],[1,"cds--file-container"],[4,"ngFor","ngForOf"],["tabindex","0",1,"cds--file-browse-btn",3,"ngClass","keyup.enter","keyup.space"],["role","button",1,"cds--file__drop-container",3,"ngClass","click","dragover","dragleave","drop"],[4,"ngIf"],[3,"ngTemplateOutlet"],["type","button",3,"cdsButton","size","disabled","click"],[3,"fileItem","size","remove"],[1,"cds--skeleton__text",2,"width","100px"],[1,"cds--skeleton__text",2,"width","225px"],["cdsButton","","skeleton","true"]],template:function(n,r){if(1&n&&(mr(0,Iwe,12,10,"ng-container",0),mr(1,Swe,3,0,"ng-template",null,1,zS)),2&n){const s=Ql(2);un("ngIf",!r.skeleton)("ngIfElse",s)}},dependencies:[hp,cA,dp,Ky,bY,Awe],encapsulation:2}),t})(),Pwe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({imports:[ld,Soe,e0e,xY]}),t})(),Rwe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({imports:[ld]}),t})();const Mwe=["*"];let jwe=(()=>{class t{constructor(){this.tileClass=!0,this.theme="dark"}get lightThemeEnabled(){return"light"===this.theme}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Ra({type:t,selectors:[["cds-tile"],["ibm-tile"]],hostVars:4,hostBindings:function(n,r){2&n&&Xl("cds--tile",r.tileClass)("cds--tile--light",r.lightThemeEnabled)},inputs:{theme:"theme"},ngContentSelectors:Mwe,decls:1,vars:0,template:function(n,r){1&n&&(qd(),Oa(0))},encapsulation:2}),t})(),mpe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({imports:[ld,dY,xY,Rwe]}),t})();function Poe(t,e="a[href], area[href], input:not([disabled]):not([tabindex='-1']), button:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']), textarea:not([disabled]):not([tabindex='-1']), iframe, object, embed, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]"){let n=t.querySelectorAll(e);return n&&Array.prototype.filter.call(n,r=>function Ywe(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}(r))}class Qwe extends aa{constructor(e,n){super()}schedule(e,n=0){return this}}const TY={setInterval(t,e,...n){const{delegate:r}=TY;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){const{delegate:e}=TY;return(e?.clearInterval||clearInterval)(t)},delegate:void 0},gpe={now:()=>(gpe.delegate||Date).now(),delegate:void 0};class Ej{constructor(e,n=Ej.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}}Ej.now=gpe.now;const Roe=new class Jwe extends Ej{constructor(e,n=Ej.now){super(e,n),this.actions=[],this._active=!1}flush(e){const{actions:n}=this;if(this._active)return void n.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}}(class Xwe extends Qwe{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;const s=this.id,c=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(c,s,n)),this.pending=!0,this.delay=n,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(c,this.id,n),this}requestAsyncId(e,n,r=0){return TY.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return n;null!=n&&TY.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,n);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let s,r=!1;try{this.work(e)}catch(c){r=!0,s=c||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,pn(r,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}}),ebe=Roe;function ype(t,e){return e?n=>JO(e.pipe(Vf(1),function tbe(){return Ws((t,e)=>{t.subscribe(Bs(e,Kg))})}()),n.pipe(ype(t))):la((n,r)=>Wa(t(n,r)).pipe(Vf(1),Rz(n)))}let TF=(()=>{class t{constructor(){this.viewContainerRef=null,this.viewContainerMap=new Map}registerViewContainerRef(n,r){r?this.viewContainerMap.set(r,n):this.viewContainerRef=n}createComponent(n,r,s){return s?this.viewContainerMap.has(s)?this.viewContainerMap.get(s).createComponent(n,{index:this.viewContainerMap.size,injector:r}):void console.error(`No view container with id ${s} found`):this.viewContainerRef?this.viewContainerRef.createComponent(n,{index:this.viewContainerRef.length,injector:r}):void console.error("No view container defined! Likely due to a missing `cds-placeholder`")}destroyComponent(n){n.destroy()}hasComponentRef(n,r){return r?!(this.viewContainerMap.get(r).indexOf(n.hostView)<0):!(this.viewContainerRef.indexOf(n.hostView)<0)}hasPlaceholderRef(n){return n?this.viewContainerMap.has(n):!!this.viewContainerRef}appendElement(n,r){return r?this.viewContainerMap.get(r).element.nativeElement.appendChild(n):this.viewContainerRef.element.nativeElement.appendChild(n)}removeElement(n,r){return r?this.viewContainerMap.get(r).element.nativeElement.removeChild(n):this.viewContainerRef.element.nativeElement.removeChild(n)}hasElement(n,r){return r?this.viewContainerMap.get(r).element.nativeElement.contains(n):this.viewContainerRef.element.nativeElement.contains(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})();const sbe={provide:TF,deps:[[new zd,new jd,TF]],useFactory:function obe(t){return t||new TF}};let _pe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({providers:[sbe],imports:[ld]}),t})(),CY=(()=>{class t{constructor(){this.experiments=new Map}addExperiment(n,r={enabled:!1}){this.experiments.has(n)||this.experiments.set(n,r)}enableExperiment(n){this.getExperiment(n).enabled=!0}disableExperiment(n){this.getExperiment(n).enabled=!1}getExperiment(n){return this.experiments.has(n)?this.experiments.get(n):(this.addExperiment(n),this.getExperiment(n))}getExperiments(){return Array.from(this.experiments.entries())}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})();const lbe={provide:CY,deps:[[new zd,new jd,CY]],useFactory:function abe(t){return t||new CY}};let cbe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({providers:[CY,lbe]}),t})();const ube=["overlay"],hbe=function(t,e){return{"cds--modal--danger":t,"is-visible":e}},IY=["*"],dbe=["modal"],pbe=function(t,e,n,r){return{"cds--modal-container--xs":t,"cds--modal-container--sm":e,"cds--modal-container--md":n,"cds--modal-container--lg":r}};function fbe(t,e){if(1&t){const n=$d();Gn(0,"cds-icon-button",2),Ar("click",function(){return va(n),Zs(or().onClose())}),vc(),Rs(1,"svg",3),_r()}if(2&t){const n=or();un("buttonNgClass",n.buttonNgClass)("buttonAttributes",n.buttonAttributes)("description",n.closeLabel)}}const mbe=["modalContent"];function gbe(t,e){if(1&t){const n=$d();bc(0),Gn(1,"button",9),Ar("click",function(){const c=va(n).index;return Zs(or(2).buttonClicked(c))}),Ho(2),_r(),Qc()}if(2&t){const n=e.$implicit;fn(1),un("cdsButton",n.type)("id",n.id),ca("modal-primary-focus",-1!==n.type.indexOf("primary")?"":null),fn(1),rE(" ",n.text," ")}}function ybe(t,e){if(1&t&&(Gn(0,"cds-modal-footer"),mr(1,gbe,3,4,"ng-container",8),_r()),2&t){const n=or();fn(1),un("ngForOf",n.buttons)}}let _be=(()=>{class t{constructor(){this.close=new Rr,this.open=!1}closeModal(){this.close.emit()}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=vr({type:t,selectors:[["","cdsBaseModal",""],["","ibmBaseModal",""]],inputs:{open:"open"},outputs:{close:"close"}}),t})(),Moe=(()=>{class t{constructor(n){this.placeholderService=n}create(n){n=Object.assign({},{inputs:{}},n);const s=Object.keys(n.inputs).map(b=>({provide:b,useValue:n.inputs[b]})),c=fh.create({providers:s}),f=this.placeholderService.createComponent(n.component,c);let v=document.activeElement;return setTimeout(()=>{f.instance.open=!0}),f.previouslyFocusedElement=v,f.instance.close.pipe(rc(()=>{f.instance.open=!1}),function ibe(t,e=Roe){const n=function rbe(t=0,e,n=ebe){let r=-1;return null!=e&&(Ib(e)?n=e:r=e),new ls(s=>{let c=function nbe(t){return t instanceof Date&&!isNaN(t)}(t)?+t-n.now():t;c<0&&(c=0);let f=0;return n.schedule(function(){s.closed||(s.next(f++),0<=r?this.schedule(void 0,r):s.complete())},c)})}(t,e);return ype(()=>n)}(240)).subscribe(()=>{this.placeholderService.destroyComponent(f),t.modalList=t.modalList.filter(b=>b!==f)}),f.onDestroy(()=>{v.focus()}),t.modalList.push(f),f}destroy(n=-1){n>=t.modalList.length||0===t.modalList.length||(n<0&&(n=t.modalList.length-1),setTimeout(()=>{t.modalList[n]&&(this.placeholderService.destroyComponent(t.modalList[n]),t.modalList.splice(n,1))},240))}}return t.modalList=[],t.\u0275fac=function(n){return new(n||t)(hr(TF))},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})(),vbe=(()=>{class t{constructor(){this.theme="default",this.open=!1,this.overlaySelect=new Rr}overlayClick(n){n.target===this.overlay.nativeElement&&(n.stopPropagation(),this.overlaySelect.emit(n))}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Ra({type:t,selectors:[["cds-overlay"],["ibm-overlay"]],viewQuery:function(n,r){if(1&n&&Es(ube,7),2&n){let s;yi(s=Mu())&&(r.overlay=s.first)}},inputs:{theme:"theme",open:"open"},outputs:{overlaySelect:"overlaySelect"},ngContentSelectors:IY,decls:3,vars:4,consts:[[1,"cds--modal","cds--modal-tall",3,"ngClass","click"],["overlay",""]],template:function(n,r){1&n&&(qd(),Gn(0,"section",0,1),Ar("click",function(c){return r.overlayClick(c)}),Oa(2),_r()),2&n&&un("ngClass",ok(1,hbe,"danger"===r.theme,r.open))},dependencies:[hp],encapsulation:2}),t})(),vpe=(()=>{class t{constructor(n,r,s){this.modalService=n,this.document=r,this.renderer=s,this.size="md",this.theme="default",this.ariaLabel="default",this.open=!1,this.hasScrollingContent=null,this.overlaySelected=new Rr,this.close=new Rr,this.selectorPrimaryFocus="[modal-primary-focus]"}ngOnChanges({open:n,hasScrollingContent:r}){n&&(n.currentValue?(setTimeout(()=>this.focusInitialElement(),100),this.renderer.addClass(this.document.body,"cds--body--with-modal-open")):n.currentValue?this.trigger&&this.trigger.focus():this.renderer.removeClass(this.document.body,"cds--body--with-modal-open")),r&&this.updateScrollbar()}ngAfterViewInit(){this.focusInitialElement(),this.updateScrollbar()}handleKeyboardEvent(n){switch(n.key){case"Escape":n.stopImmediatePropagation(),this.open=!1,this.close.emit(),this.modalService.destroy();break;case"Tab":!function Zwe(t,e){if("Tab"===t.key){let n=Poe(e),r=!1;t.shiftKey?(function $we(t,e){return e.length>0&&(t.target||t.srcElement)===e[0]}(t,n)||function Gwe(t,e){return(t.target||t.srcElement)===e}(t,e))&&(r=function Wwe(t){return t.length>0&&(t[t.length-1].focus(),!0)}(n)):function qwe(t,e){return e.length>0&&(t.target||t.srcElement)===e[e.length-1]}(t,n)&&(r=function Kwe(t){return t.length>0&&(t[0].focus(),!0)}(n)),r&&(t.preventDefault(),t.stopPropagation())}}(n,this.modal.nativeElement)}}get shouldShowScrollbar(){const n=this.modal?this.modal.nativeElement.querySelector(".cds--modal-content"):null;if(n){const r=Math.ceil(n.getBoundingClientRect().height);return n.scrollHeight>r}return!1}ngOnDestroy(){this.renderer.removeClass(this.document.body,"cds--body--with-modal-open")}focusInitialElement(){const n=this.modal.nativeElement.querySelector(this.selectorPrimaryFocus);n&&n.focus?setTimeout(()=>n.focus()):Poe(this.modal.nativeElement).length>0?setTimeout(()=>Poe(this.modal.nativeElement)[0].focus()):setTimeout(()=>this.modal.nativeElement.focus())}updateScrollbar(){const n=this.modal?this.modal.nativeElement.querySelector(".cds--modal-content"):null;n&&((null!==this.hasScrollingContent?this.hasScrollingContent:this.shouldShowScrollbar)?this.renderer.addClass(n,"cds--modal-scroll-content"):this.renderer.removeClass(n,"cds--modal-scroll-content"))}}return t.\u0275fac=function(n){return new(n||t)(vt(Moe),vt(ru),vt(Kc))},t.\u0275cmp=Ra({type:t,selectors:[["cds-modal"],["ibm-modal"]],viewQuery:function(n,r){if(1&n&&Es(dbe,7),2&n){let s;yi(s=Mu())&&(r.modal=s.first)}},hostBindings:function(n,r){1&n&&Ar("keydown",function(c){return r.handleKeyboardEvent(c)})},inputs:{size:"size",theme:"theme",ariaLabel:"ariaLabel",open:"open",trigger:"trigger",hasScrollingContent:"hasScrollingContent"},outputs:{overlaySelected:"overlaySelected",close:"close"},features:[ml],ngContentSelectors:IY,decls:4,vars:9,consts:[[3,"theme","open","overlaySelect"],["role","dialog","aria-modal","true",1,"cds--modal-container",2,"z-index","1",3,"ngClass"],["modal",""]],template:function(n,r){1&n&&(qd(),Gn(0,"cds-overlay",0),Ar("overlaySelect",function(){return r.overlaySelected.emit()}),Gn(1,"div",1,2),Oa(3),_r()()),2&n&&(un("theme",r.theme)("open",r.open),fn(1),un("ngClass",rq(4,pbe,"xs"===r.size,"sm"===r.size,"md"===r.size,"lg"===r.size)),ca("aria-label",r.ariaLabel))},dependencies:[hp,vbe],encapsulation:2}),t})(),wbe=(()=>{class t{constructor(n){this.i18n=n,this.theme="default",this.closeLabel=this.i18n.get().MODAL.CLOSE,this.showCloseButton=!0,this.closeSelect=new Rr,this.buttonNgClass={"cds--modal-close":!0},this.buttonAttributes={"aria-label":this.i18n.get().MODAL.CLOSE}}onClose(){this.closeSelect.emit()}}return t.\u0275fac=function(n){return new(n||t)(vt(av))},t.\u0275cmp=Ra({type:t,selectors:[["cds-modal-header"],["ibm-modal-header"]],inputs:{theme:"theme",closeLabel:"closeLabel",showCloseButton:"showCloseButton"},outputs:{closeSelect:"closeSelect"},ngContentSelectors:IY,decls:4,vars:4,consts:[[1,"cds--modal-close-button"],["type","button","align","left",3,"buttonNgClass","buttonAttributes","description","click",4,"ngIf"],["type","button","align","left",3,"buttonNgClass","buttonAttributes","description","click"],["cdsIcon","close","size","20",1,"cds--modal-close__icon"]],template:function(n,r){1&n&&(qd(),Gn(0,"header"),Oa(1),Gn(2,"div",0),mr(3,fbe,2,3,"cds-icon-button",1),_r()()),2&n&&(o0("cds--modal-header ",r.theme,""),fn(3),un("ngIf",r.showCloseButton))},dependencies:[dp,Qve,EY],encapsulation:2}),t})(),bbe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=Ra({type:t,selectors:[["cds-modal-footer"],["ibm-modal-footer"]],ngContentSelectors:IY,decls:2,vars:0,consts:[[1,"cds--modal-footer"]],template:function(n,r){1&n&&(qd(),Gn(0,"footer",0),Oa(1),_r())},encapsulation:2}),t})(),Ebe=(()=>{class t{constructor(){this.modalContentClass=!0,this.hasForm=!1}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=vr({type:t,selectors:[["","cdsModalContent",""],["","ibmModalContent",""]],hostVars:4,hostBindings:function(n,r){2&n&&Xl("cds--modal-content",r.modalContentClass)("cds--modal-content--with-form",r.hasForm)},inputs:{hasForm:"hasForm"}}),t})(),xbe=(()=>{class t{constructor(){this.modalHeaderHeadingClass=!0}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=vr({type:t,selectors:[["","cdsModalHeaderHeading",""],["","ibmModalHeaderHeading",""]],hostVars:2,hostBindings:function(n,r){2&n&&Xl("cds--modal-header__heading",r.modalHeaderHeadingClass)}}),t})(),Tbe=(()=>{class t{constructor(){this.modalHeaderLabelClass=!0}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=vr({type:t,selectors:[["","cdsModalHeaderLabel",""],["","ibmModalHeaderLabel",""]],hostVars:2,hostBindings:function(n,r){2&n&&Xl("cds--modal-header__label",r.modalHeaderLabelClass)}}),t})(),Cbe=(()=>{class t extends _be{constructor(n="default",r,s,c,f,v=null,b=[],S,k=!0){super(),this.type=n,this.label=r,this.title=s,this.content=c,this.size=f,this.hasScrollingContent=v,this.buttons=b,this.onClose=S,this.showCloseButton=k;for(let F=0;F<this.buttons.length;F++){const H=this.buttons[F];H.id||(H.id=`alert-modal-button-${F}`),H.type||(H.type="secondary")}}ngAfterViewInit(){if(!this.modalContent)return!1;const n=this.modalContent.nativeElement;n.tabIndex=n.scrollHeight>n.clientHeight?0:-1}buttonClicked(n){const r=this.buttons[n];r.click&&r.click(),this.closeModal()}dismissModal(n){this.onClose&&!1===this.onClose(n)||this.closeModal()}}return t.\u0275fac=function(n){return new(n||t)(vt("type",8),vt("label",8),vt("title",8),vt("content",8),vt("size",8),vt("hasScrollingContent",8),vt("buttons",8),vt("close",8),vt("showCloseButton",8))},t.\u0275cmp=Ra({type:t,selectors:[["cds-alert-modal"],["ibm-alert-modal"]],viewQuery:function(n,r){if(1&n&&Es(mbe,7),2&n){let s;yi(s=Mu())&&(r.modalContent=s.first)}},features:[_o],decls:10,vars:10,consts:[[3,"size","theme","ariaLabel","hasScrollingContent","open","overlaySelected"],[3,"showCloseButton","closeSelect"],["cdsModalHeaderLabel","",1,"cds--type-delta"],["cdsModalHeaderHeading","",1,"cds--type-beta"],["cdsModalContent",""],["modalContent",""],[3,"innerHTML"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"cdsButton","id","click"]],template:function(n,r){1&n&&(Gn(0,"cds-modal",0),Ar("overlaySelected",function(){return r.dismissModal("overlay")}),Gn(1,"cds-modal-header",1),Ar("closeSelect",function(){return r.dismissModal("close")}),Gn(2,"p",2),Ho(3),_r(),Gn(4,"p",3),Ho(5),_r()(),Gn(6,"div",4,5),Rs(8,"p",6),_r(),mr(9,ybe,2,1,"cds-modal-footer",7),_r()),2&n&&(un("size",r.size)("theme",r.type)("ariaLabel",r.title)("hasScrollingContent",r.hasScrollingContent)("open",r.open),fn(1),un("showCloseButton",r.showCloseButton),fn(2),Xs(r.label),fn(2),Xs(r.title),fn(3),un("innerHTML",r.content,HH),fn(1),un("ngIf",r.buttons.length>0))},dependencies:[cA,dp,bY,vpe,wbe,bbe,Ebe,xbe,Tbe],encapsulation:2}),t})(),Abe=(()=>{class t extends Moe{constructor(n){super(n),this.placeholderService=n}show(n){return this.create({component:Cbe,inputs:{type:n.type,label:n.label,title:n.title,content:n.content,hasScrollingContent:void 0!==n.hasScrollingContent?n.hasScrollingContent:null,size:n.size,buttons:n.buttons||[],close:n.close||(()=>{}),showCloseButton:n.showCloseButton}})}}return t.\u0275fac=function(n){return new(n||t)(hr(TF))},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})(),Dbe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({providers:[Moe,Abe],imports:[ld,Soe,dY,_pe,cbe,xY]}),t})();const Rbe=["dropdownButton"],Mbe=["dropdownMenu"];function kbe(t,e){if(1&t&&(bc(0),Ho(1),Qc()),2&t){const n=or(2);fn(1),Xs(n.label)}}function Obe(t,e){}function Nbe(t,e){1&t&&mr(0,Obe,0,0,"ng-template",16),2&t&&un("ngTemplateOutlet",or(2).label)}const Lbe=function(t,e){return{"cds--label--disabled":t,"cds--visually-hidden":e}};function Fbe(t,e){if(1&t&&(Gn(0,"label",15),mr(1,kbe,2,1,"ng-container",6),mr(2,Nbe,1,1,null,6),_r()),2&t){const n=or();un("for",n.id)("ngClass",ok(4,Lbe,n.disabled,n.hideLabel)),fn(1),un("ngIf",!n.isTemplate(n.label)),fn(1),un("ngIf",n.isTemplate(n.label))}}function Vbe(t,e){if(1&t){const n=$d();Gn(0,"div",17),Ar("click",function(){return va(n),Zs(or().clearSelected())})("keydown.enter",function(){return va(n),Zs(or().clearSelected())}),Ho(1),vc(),Gn(2,"svg",18),Rs(3,"path",19),_r()()}if(2&t){const n=or();un("title",n.clearText),fn(1),rE(" ",n.getSelectedCount()," ")}}function Bbe(t,e){if(1&t&&(Gn(0,"span",20),Ho(1),function ck(t,e){const n=Gi();let r;const s=t+Oi;n.firstCreatePass?(r=function oq(t,e){if(e)for(let n=e.length-1;n>=0;n--){const r=e[n];if(t===r.name)return r}}(e,n.pipeRegistry),n.data[s]=r,r.onDestroy&&(n.destroyHooks??=[]).push(s,r.onDestroy)):r=n.data[s];const c=r.factory||(r.factory=Tm(r.type)),v=gc(vt);try{const b=s1(!1),S=c();return s1(b),function v2(t,e,n,r){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=r}(n,Bt(),s,S),S}finally{gc(v)}}(2,"async"),_r()),2&t){const n=or();fn(1),Xs(sq(2,1,n.getDisplayStringValue()))}}function Ube(t,e){}function zbe(t,e){if(1&t&&mr(0,Ube,0,0,"ng-template",21),2&t){const n=or();un("ngTemplateOutletContext",n.getRenderTemplateContext())("ngTemplateOutlet",n.displayValue)}}function jbe(t,e){1&t&&(vc(),Rs(0,"svg",22))}function Hbe(t,e){1&t&&(vc(),Rs(0,"svg",23))}const $be=function(t){return{"cds--list-box__menu-icon--open":t}};function qbe(t,e){if(1&t&&(vc(),Rs(0,"svg",24)),2&t){const n=or();un("ngClass",vh(2,$be,!n.menuIsClosed)),ca("aria-label",n.menuButtonLabel)}}function Gbe(t,e){1&t&&Oa(0,0,["*ngIf","!menuIsClosed"])}function Kbe(t,e){if(1&t&&(bc(0),Ho(1),Qc()),2&t){const n=or(2);fn(1),Xs(n.helperText)}}function Wbe(t,e){}function Ybe(t,e){1&t&&mr(0,Wbe,0,0,"ng-template",16),2&t&&un("ngTemplateOutlet",or(2).helperText)}const Zbe=function(t){return{"cds--form__helper-text--disabled":t}};function Qbe(t,e){if(1&t&&(Gn(0,"div",25),mr(1,Kbe,2,1,"ng-container",6),mr(2,Ybe,1,1,null,6),_r()),2&t){const n=or();un("ngClass",vh(3,Zbe,n.disabled)),fn(1),un("ngIf",!n.isTemplate(n.helperText)),fn(1),un("ngIf",n.isTemplate(n.helperText))}}function Xbe(t,e){if(1&t&&(bc(0),Ho(1),Qc()),2&t){const n=or(2);fn(1),Xs(n.invalidText)}}function Jbe(t,e){}function e1e(t,e){1&t&&mr(0,Jbe,0,0,"ng-template",16),2&t&&un("ngTemplateOutlet",or(2).invalidText)}function t1e(t,e){if(1&t&&(Gn(0,"div",26),mr(1,Xbe,2,1,"ng-container",6),mr(2,e1e,1,1,null,6),_r()),2&t){const n=or();fn(1),un("ngIf",!n.isTemplate(n.invalidText)),fn(1),un("ngIf",n.isTemplate(n.invalidText))}}function n1e(t,e){if(1&t&&(bc(0),Ho(1),Qc()),2&t){const n=or(2);fn(1),Xs(n.warnText)}}function r1e(t,e){}function i1e(t,e){1&t&&mr(0,r1e,0,0,"ng-template",16),2&t&&un("ngTemplateOutlet",or(2).warnText)}function o1e(t,e){if(1&t&&(Gn(0,"div",26),mr(1,n1e,2,1,"ng-container",6),mr(2,i1e,1,1,null,6),_r()),2&t){const n=or();fn(1),un("ngIf",!n.isTemplate(n.warnText)),fn(1),un("ngIf",n.isTemplate(n.warnText))}}const s1e=function(t,e,n,r,s,c,f,v,b,S,k,F,H,Q,de){return{"cds--dropdown":t,"cds--multiselect":e,"cds--multi-select--selected":n,"cds--dropdown--light":r,"cds--list-box--light":s,"cds--list-box--inline":c,"cds--skeleton":f,"cds--dropdown--disabled cds--list-box--disabled":v,"cds--dropdown--readonly":b,"cds--dropdown--invalid":S,"cds--dropdown--warning cds--list-box--warning":k,"cds--dropdown--sm cds--list-box--sm":F,"cds--dropdown--md cds--list-box--md":H,"cds--dropdown--lg cds--list-box--lg":Q,"cds--list-box--expanded":de}},a1e=function(t){return{a:t}},l1e=function(t){return{"cds--list-box--up":t}},c1e=["*"],u1e=["list"],h1e=["listItem"];function d1e(t,e){if(1&t&&(Gn(0,"div",9)(1,"label",10),Rs(2,"input",11)(3,"span",12),Gn(4,"span",13),Ho(5),_r()()()),2&t){const n=or().$implicit;fn(1),ca("data-contained-checkbox-state",n.selected),fn(1),un("checked",n.selected)("disabled",n.disabled),fn(3),Xs(n.content)}}function p1e(t,e){if(1&t&&(bc(0),Ho(1),Qc()),2&t){const n=or().$implicit;fn(1),Xs(n.content)}}function f1e(t,e){1&t&&(vc(),Rs(0,"svg",14))}function m1e(t,e){}const g1e=function(t){return{item:t}};function y1e(t,e){if(1&t&&mr(0,m1e,0,0,"ng-template",15),2&t){const n=or().$implicit,r=or();un("ngTemplateOutletContext",vh(2,g1e,n))("ngTemplateOutlet",r.listTpl)}}const _1e=function(t,e){return{"cds--list-box__menu-item--active":t,"cds--list-box__menu-item--highlighted":e}};function v1e(t,e){if(1&t){const n=$d();Gn(0,"li",3),Ar("click",function(s){const f=va(n).$implicit;return Zs(or().doClick(s,f))}),Gn(1,"div",4,5),mr(3,d1e,6,4,"div",6),mr(4,p1e,2,1,"ng-container",7),mr(5,f1e,1,0,"svg",8),mr(6,y1e,1,4,null,7),_r()()}if(2&t){const n=e.$implicit,r=e.index,s=or();un("id",s.getItemId(r))("ngClass",ok(9,_1e,n.selected,s.highlightedItem===s.getItemId(r))),ca("aria-selected",n.selected)("title",s.showTitles?n.content:null)("disabled",!!n.disabled||null),fn(3),un("ngIf",!s.listTpl&&"multi"===s.type),fn(1),un("ngIf",!s.listTpl&&"single"===s.type),fn(1),un("ngIf",!s.listTpl&&"single"===s.type),fn(1),un("ngIf",s.listTpl)}}let wpe=(()=>{class t{constructor(){this.type="single",this.size="md"}set items(n){}get items(){}getNextItem(){}hasNextElement(){}getNextElement(){}getPrevItem(){}hasPrevElement(){}getPrevElement(){}getSelected(){}getCurrentItem(){}getCurrentElement(){}getListItems(){}propagateSelected(n){}filterBy(n){}initFocus(){}onItemsReady(n){}reorderSelected(n){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=vr({type:t,selectors:[["","cdsAbstractDropdownView",""],["","ibmAbstractDropdownView",""]],inputs:{items:"items"},outputs:{select:"select",blurIntent:"blurIntent"}}),t})();const bpe={top:0,left:0};let Epe=(()=>{class t{constructor(n,r){this.placeholderService=n,this.animationFrameService=r,this.animationFrameSubscription=new aa,this._offset=bpe}set offset(n){this._offset=Object.assign({},bpe,n)}get offset(){return this._offset}appendToBody(n,r,s){r.style.display="block";const c=document.createElement("div");return c.className=`dropdown ${s}`,c.style.width=n.offsetWidth+"px",c.style.position="absolute",c.appendChild(r),this.placeholderService.hasPlaceholderRef()?this.placeholderService.appendElement(c):document.body.appendChild(c),this.menuInstance=c,this.animationFrameSubscription=this.animationFrameService.tick.subscribe(()=>{this.positionDropdown(n,c)}),this.positionDropdown(n,c),c}appendToDropdown(n){if(!this.menuInstance)return;const r=this.menuInstance,s=r.firstElementChild;return this.menuInstance=null,s.style.display="none",n.appendChild(s),this.animationFrameSubscription.unsubscribe(),this.placeholderService.hasPlaceholderRef()&&this.placeholderService.hasElement(r)?this.placeholderService.removeElement(r):document.body.contains(r)&&document.body.removeChild(r),r}updatePosition(n){this.positionDropdown(n,this.menuInstance)}ngOnDestroy(){this.animationFrameSubscription.unsubscribe()}positionDropdown(n,r){if(!r)return;let s=0;const c=r.querySelector(".cds--list-box__menu");c&&(n.getBoundingClientRect().left!==c.getBoundingClientRect().left?n.getBoundingClientRect().left-c.getBoundingClientRect().left+c.getBoundingClientRect().right>(window.innerWidth||document.documentElement.clientWidth)&&(s=n.offsetWidth-c.offsetWidth):c.getBoundingClientRect().right>(window.innerWidth||document.documentElement.clientWidth)&&(s=n.offsetWidth-c.offsetWidth));const f=function k_e(t,e,n){let r=n;if(!n)return null;do{if(M_e(r,t,e))return r;r=r.parentElement||r.parentNode}while(null!==r&&1===r.nodeType);return null}("position",["relative","fixed","absolute"],r.parentElement),v=f?-1*f.getBoundingClientRect().top:this.offset.top,b=f?-1*f.getBoundingClientRect().left:this.offset.left+s;let S=goe.findAbsolute(n,r,"bottom");S=goe.addOffset(S,v,b),goe.setElement(r,S)}}return t.\u0275fac=function(n){return new(n||t)(hr(TF),hr(Bde))},t.\u0275prov=jn({token:t,factory:t.\u0275fac}),t})(),w1e=(()=>{class t{constructor(n,r,s,c){this.elementRef=n,this.i18n=r,this.dropdownService=s,this.elementService=c,this.id="dropdown-"+t.dropdownCount++,this.hideLabel=!1,this.placeholder="",this.displayValue="",this.clearText=this.i18n.get().DROPDOWN.CLEAR,this.size="md",this.type="single",this.theme="dark",this.disabled=!1,this.readonly=!1,this.skeleton=!1,this.inline=!1,this.disableArrowKeys=!1,this.invalid=!1,this.warn=!1,this.appendInline=null,this.selectionFeedback="top-after-reopen",this.menuButtonLabel=this.i18n.get().DROPDOWN.OPEN,this.selectedLabel=this.i18n.get().DROPDOWN.SELECTED,this.selected=new Rr,this.onClose=new Rr,this.close=new Rr,this.hostClass=!0,this.menuIsClosed=!0,this._dropUp=!1,this.noop=this._noop.bind(this),this.outsideClick=this._outsideClick.bind(this),this.outsideKey=this._outsideKey.bind(this),this.keyboardNav=this._keyboardNav.bind(this),this.visibilitySubscription=new aa,this.onTouchedCallback=this._noop,this._writtenValue=[],this.propagateChange=f=>{}}get writtenValue(){return this._writtenValue}set writtenValue(n){n&&0===n.length&&this.clearSelected(),this._writtenValue=n}ngOnInit(){this.view&&(this.view.type=this.type)}ngAfterContentInit(){if(!this.view)return;(this.writtenValue&&this.writtenValue.length||"number"==typeof this.writtenValue)&&this.writeValue(this.writtenValue),this.view.type=this.type,this.view.size=this.size;const n=r=>r&&r.isUpdate;this.view.select.subscribe(r=>{if("single"===this.type&&!n(r)&&!Array.isArray(r)&&(this.closeMenu(),this.propagateChange(r.item&&r.item.selected?this.itemValueKey?r.item[this.itemValueKey]:r.item:null)),"multi"===this.type&&!n(r))if(this.itemValueKey&&this.view.getSelected()){const s=this.view.getSelected().map(c=>c[this.itemValueKey]);this.propagateChange(s)}else this.propagateChange(this.view.getSelected());n(r)||(this.checkForReorder(),this.selected.emit(r))})}ngAfterViewInit(){null===this.appendInline&&(t=>{for(;t.parentElement&&t!==document.body;){if(_oe(t))return!0;t=t.parentElement}return!1})(this.elementRef.nativeElement)?this.appendInline=!1:null===this.appendInline&&(this.appendInline=!0),this.checkForReorder()}ngOnDestroy(){this.appendInline||this._appendToDropdown()}writeValue(n){this.writtenValue=n,this.view.onItemsReady(()=>{if(n)if("single"===this.type)if(this.itemValueKey){const r=Object.assign({},this.view.getListItems().find(s=>s[this.itemValueKey]===n));r.selected=!0,this.view.propagateSelected([r])}else this.view.propagateSelected([n]);else if(this.itemValueKey){let r=[];for(const s of n)for(const c of this.view.getListItems())c[this.itemValueKey]===s&&r.push(Object.assign({},c,{selected:!0}));this.view.propagateSelected(r)}else this.view.propagateSelected(n);else this.view.propagateSelected([n]);this.checkForReorder()})}onBlur(){this.onTouchedCallback()}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){this.onTouchedCallback=n}setDisabledState(n){this.disabled=n}onKeyDown(n){if(!this.readonly){if("Escape"===n.key&&!this.menuIsClosed&&n.stopImmediatePropagation(),"Escape"===n.key)n.preventDefault(),this.closeMenu(),this.dropdownButton.nativeElement.focus();else if(this.menuIsClosed&&(" "===n.key||"ArrowDown"===n.key||"ArrowUp"===n.key)){if(this.disableArrowKeys&&("ArrowDown"===n.key||"ArrowUp"===n.key))return;n.preventDefault(),this.openMenu()}!this.menuIsClosed&&"Tab"===n.key&&this.dropdownMenu.nativeElement.contains(n.target)&&this.closeMenu(),!this.menuIsClosed&&"Tab"===n.key&&n.shiftKey&&this.closeMenu(),"multi"!==this.type&&this.menuIsClosed&&this.closedDropdownNavigation(n)}}closedDropdownNavigation(n){if("ArrowDown"===n.key){n.preventDefault(),this.view.getCurrentItem().selected=!1;let r=this.view.getNextItem();r&&(r.selected=!0)}else if("ArrowUp"===n.key){n.preventDefault(),this.view.getCurrentItem().selected=!1;let r=this.view.getPrevItem();r&&(r.selected=!0)}}getDisplayStringValue(){if(!this.view||this.skeleton)return;let n=this.view.getSelected();return!n.length||this.displayValue&&this.isRenderString()?n.length&&this.isRenderString()?Sr(this.displayValue):Sr(this.placeholder):Sr("multi"===this.type?this.placeholder:n[0].content)}isRenderString(){return"string"==typeof this.displayValue}getRenderTemplateContext(){if(!this.view)return;let n=this.view.getSelected();return"multi"===this.type?{items:n}:n&&n.length>0?{item:n[0]}:{}}getSelectedCount(){if(this.view.getSelected())return this.view.getSelected().length}clearSelected(){if(!this.disabled&&0!==this.getSelectedCount()){for(const n of this.view.getListItems())n.selected=!1;this.selected.emit([]),this.propagateChange([])}}valueSelected(){return!!this.view.getSelected()}_noop(){}_outsideClick(n){!this.elementRef.nativeElement.contains(n.target)&&!this.dropdownMenu.nativeElement.contains(n.target)&&this.closeMenu()}_outsideKey(n){!this.menuIsClosed&&"Tab"===n.key&&this.dropdownMenu.nativeElement.contains(n.target)&&this.closeMenu()}_keyboardNav(n){"Escape"===n.key&&!this.menuIsClosed&&n.stopImmediatePropagation(),"Escape"===n.key?(n.preventDefault(),this.closeMenu(),this.dropdownButton.nativeElement.focus()):!this.menuIsClosed&&"Tab"===n.key&&(this.dropdownButton.nativeElement.focus(),this.dropdownButton.nativeElement.dispatchEvent(new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Tab"})),this.closeMenu())}_appendToDropdown(){this.dropdownService.appendToDropdown(this.elementRef.nativeElement),this.dropdownMenu.nativeElement.removeEventListener("keydown",this.keyboardNav,!0)}_appendToBody(){this.dropdownService.appendToBody(this.dropdownButton.nativeElement,this.dropdownMenu.nativeElement,`${this.elementRef.nativeElement.className}${"light"===this.theme?" cds--list-box--light":""}${this.menuIsClosed?"":" cds--list-box--expanded"}`),this.dropdownMenu.nativeElement.addEventListener("keydown",this.keyboardNav,!0)}_shouldDropUp(){const n=this.dropdownMenu&&this.dropdownMenu.nativeElement.querySelector(".cds--list-box__menu"),r=n&&n.getBoundingClientRect();return!(!n||!r)&&zde(n).reduce((c,f)=>{const v=f.getBoundingClientRect();return c||!(r.bottom<=v.bottom)},!1)}openMenu(){0!==this.view.getListItems().length&&(this._dropUp=!1,this.menuIsClosed=!1,this.appendInline||(this.visibilitySubscription=this.elementService.visibility(this.dropdownButton.nativeElement,this.elementRef.nativeElement).subscribe(s=>{s.visible||this.closeMenu()}),this._appendToBody()),setTimeout(()=>{null==this.dropUp&&(this._dropUp=this._shouldDropUp())},0),document.body.firstElementChild.addEventListener("click",this.noop,!0),document.body.firstElementChild.addEventListener("keydown",this.noop,!0),document.addEventListener("click",this.outsideClick,!0),document.addEventListener("keydown",this.outsideKey,!0),setTimeout(()=>this.view.initFocus(),0))}closeMenu(){this.menuIsClosed||(this.menuIsClosed=!0,this.checkForReorder(),this.onClose.emit(),this.close.emit(),this.dropdownButton.nativeElement.focus(),this.view.disableScroll&&this.view.disableScroll(),this.appendInline||(this.visibilitySubscription.unsubscribe(),this._appendToDropdown()),document.body.firstElementChild.removeEventListener("click",this.noop,!0),document.body.firstElementChild.removeEventListener("keydown",this.noop,!0),document.removeEventListener("click",this.outsideClick,!0),document.removeEventListener("keydown",this.outsideKey,!0))}toggleMenu(){this.menuIsClosed?this.openMenu():this.closeMenu()}isTemplate(n){return n instanceof nd}checkForReorder(){"multi"===this.type&&(this.menuIsClosed&&"top-after-reopen"===this.selectionFeedback||"top"===this.selectionFeedback)&&this.view.reorderSelected()}}return t.dropdownCount=0,t.\u0275fac=function(n){return new(n||t)(vt(yl),vt(av),vt(Epe),vt(jde))},t.\u0275cmp=Ra({type:t,selectors:[["cds-dropdown"],["ibm-dropdown"]],contentQueries:function(n,r,s){if(1&n&&function gk(t,e,n,r){const s=Gi();if(s.firstCreatePass){const c=Xa();pq(s,new dq(e,n,r),c.index),function fq(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(n.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(s,t),2==(2&n)&&(s.staticContentQueries=!0)}IE(s,Bt(),n)}(s,wpe,7),2&n){let c;yi(c=Mu())&&(r.view=c.first)}},viewQuery:function(n,r){if(1&n&&(Es(Rbe,7),Es(Mbe,7)),2&n){let s;yi(s=Mu())&&(r.dropdownButton=s.first),yi(s=Mu())&&(r.dropdownMenu=s.first)}},hostVars:2,hostBindings:function(n,r){1&n&&Ar("keydown",function(c){return r.onKeyDown(c)}),2&n&&Xl("cds--dropdown__wrapper",r.hostClass)},inputs:{id:"id",label:"label",hideLabel:"hideLabel",helperText:"helperText",placeholder:"placeholder",displayValue:"displayValue",clearText:"clearText",size:"size",type:"type",theme:"theme",disabled:"disabled",readonly:"readonly",skeleton:"skeleton",inline:"inline",disableArrowKeys:"disableArrowKeys",invalid:"invalid",invalidText:"invalidText",warn:"warn",warnText:"warnText",appendInline:"appendInline",scrollableContainer:"scrollableContainer",itemValueKey:"itemValueKey",selectionFeedback:"selectionFeedback",menuButtonLabel:"menuButtonLabel",selectedLabel:"selectedLabel",dropUp:"dropUp"},outputs:{selected:"selected",onClose:"onClose",close:"close"},features:[ns([{provide:Wi,useExisting:t,multi:!0}])],ngContentSelectors:c1e,decls:17,vars:39,consts:[["class","cds--label",3,"for","ngClass",4,"ngIf"],[1,"cds--list-box",3,"ngClass"],["type","button","aria-haspopup","listbox",1,"cds--list-box__field",3,"id","ngClass","click","blur"],["dropdownButton",""],["class","cds--list-box__selection cds--tag--filter cds--list-box__selection--multi","tabindex","0",3,"title","click","keydown.enter",4,"ngIf"],["class","cds--list-box__label",4,"ngIf"],[4,"ngIf"],["class","cds--dropdown__invalid-icon","cdsIcon","warning--filled","size","16",4,"ngIf"],["cdsIcon","warning--alt--filled","size","16","class","cds--list-box__invalid-icon cds--list-box__invalid-icon--warning",4,"ngIf"],[1,"cds--list-box__menu-icon"],["cdsIcon","chevron--down","size","16",3,"ngClass",4,"ngIf"],[3,"ngClass"],["dropdownMenu",""],["class","cds--form__helper-text",3,"ngClass",4,"ngIf"],["class","cds--form-requirement",4,"ngIf"],[1,"cds--label",3,"for","ngClass"],[3,"ngTemplateOutlet"],["tabindex","0",1,"cds--list-box__selection","cds--tag--filter","cds--list-box__selection--multi",3,"title","click","keydown.enter"],["focusable","false","preserveAspectRatio","xMidYMid meet","role","img","xmlns","http://www.w3.org/2000/svg","width","16","height","16","viewBox","0 0 16 16","aria-hidden","true",2,"will-change","transform"],["d","M12 4.7l-.7-.7L8 7.3 4.7 4l-.7.7L7.3 8 4 11.3l.7.7L8 8.7l3.3 3.3.7-.7L8.7 8z"],[1,"cds--list-box__label"],[3,"ngTemplateOutletContext","ngTemplateOutlet"],["cdsIcon","warning--filled","size","16",1,"cds--dropdown__invalid-icon"],["cdsIcon","warning--alt--filled","size","16",1,"cds--list-box__invalid-icon","cds--list-box__invalid-icon--warning"],["cdsIcon","chevron--down","size","16",3,"ngClass"],[1,"cds--form__helper-text",3,"ngClass"],[1,"cds--form-requirement"]],template:function(n,r){1&n&&(qd(),mr(0,Fbe,3,7,"label",0),Gn(1,"div",1)(2,"button",2,3),Ar("click",function(c){return r.disabled||r.readonly?c.stopPropagation():r.toggleMenu()})("blur",function(){return r.onBlur()}),mr(4,Vbe,4,2,"div",4),mr(5,Bbe,3,3,"span",5),mr(6,zbe,1,2,null,6),mr(7,jbe,1,0,"svg",7),mr(8,Hbe,1,0,"svg",8),Gn(9,"span",9),mr(10,qbe,1,4,"svg",10),_r()(),Gn(11,"div",11,12),mr(13,Gbe,1,0,"ng-content",6),_r()(),mr(14,Qbe,3,5,"div",13),mr(15,t1e,3,2,"div",14),mr(16,o1e,3,2,"div",14)),2&n&&(un("ngIf",r.label&&!r.skeleton),fn(1),un("ngClass",ak(19,s1e,["multi"!==r.type,"multi"===r.type,"multi"===r.type&&r.getSelectedCount()>0,"light"===r.theme,"light"===r.theme,r.inline,r.skeleton,r.disabled,r.readonly,r.invalid,r.warn,"sm"===r.size,"md"===r.size,"lg"===r.size,!r.menuIsClosed])),fn(1),un("id",r.id)("ngClass",vh(35,a1e,!r.menuIsClosed)),ca("aria-expanded",!r.menuIsClosed)("aria-disabled",r.disabled)("aria-readonly",r.readonly)("disabled",!!r.disabled||null),fn(2),un("ngIf","multi"===r.type&&r.getSelectedCount()>0),fn(1),un("ngIf",r.isRenderString()),fn(1),un("ngIf",!r.isRenderString()),fn(1),un("ngIf",r.invalid),fn(1),un("ngIf",!r.invalid&&r.warn),fn(2),un("ngIf",!r.skeleton),fn(1),un("ngClass",vh(37,l1e,null!=r.dropUp?r.dropUp:r._dropUp)),fn(2),un("ngIf",!r.menuIsClosed),fn(1),un("ngIf",r.helperText&&!r.invalid&&!r.warn&&!r.skeleton),fn(1),un("ngIf",r.invalid),fn(1),un("ngIf",!r.invalid&&r.warn))},dependencies:[hp,dp,Ky,EY,EU],encapsulation:2}),t})();let E1e=(()=>{class t{constructor(n,r,s){this.elementRef=n,this.i18n=r,this.appRef=s,this.ariaLabel=this.i18n.get().DROPDOWN_LIST.LABEL,this.listTpl=null,this.select=new Rr,this.scroll=new Rr,this.blurIntent=new Rr,this.type="single",this.showTitles=!0,this.size="md",this.listId="listbox-"+t.listCount++,this.highlightedItem=null,this.displayItems=[],this.index=-1,this._items=[]}set items(n){d_(n)?(this._itemsSubscription&&this._itemsSubscription.unsubscribe(),this._itemsReady=new ls(r=>{this._itemsSubscription=n.subscribe(s=>{this.updateList(s),r.next(!0),r.complete()})}),this.onItemsReady(null)):this.updateList(n),this._originalItems=n}get items(){return this._originalItems}ngAfterViewInit(){this.index=this.getListItems().findIndex(n=>n.selected),this.setupFocusObservable(),setTimeout(()=>{this.doEmitSelect(!0)})}ngOnDestroy(){this.focusJump&&this.focusJump.unsubscribe(),this._itemsSubscription&&this._itemsSubscription.unsubscribe()}doEmitSelect(n=!0){if("single"===this.type)this.select.emit({item:this._items.find(r=>r.selected),isUpdate:n});else{const r=this.getSelected()||[];r.isUpdate=n,this.select.emit(r)}}getItemId(n){return`${this.listId}-${n}`}updateList(n){this._items=n.map(r=>Object.assign({},r)),this.displayItems=this._items,this.updateIndex(),this.setupFocusObservable(),this.doEmitSelect()}filterBy(n=""){n?(this.displayItems=this.getListItems().filter(r=>r.content.toLowerCase().includes(n.toLowerCase())),this.displayItems&&(this.index=0)):this.displayItems=this.getListItems(),this.updateIndex()}setupFocusObservable(){if(!this.list)return;this.focusJump&&this.focusJump.unsubscribe();let n=Array.from(this.list.nativeElement.querySelectorAll("li"));this.focusJump=function b1e(t,e){return fj(t,"keydown").pipe(function Pbe(t,e=Roe){return Ws((n,r)=>{let s=null,c=null,f=null;const v=()=>{if(s){s.unsubscribe(),s=null;const S=c;c=null,r.next(S)}};function b(){const S=f+t,k=e.now();if(k<S)return s=this.schedule(void 0,S-k),void r.add(s);v()}n.subscribe(Bs(r,S=>{c=S,f=e.now(),s||(s=e.schedule(b,t),r.add(s))},()=>{v(),r.complete()},void 0,()=>{c=s=null}))})}(150),go(n=>{let r=e.find(s=>s.textContent.trim().toLowerCase().startsWith(n.key));if(r)return r}),pg(n=>!!n))}(this.list.nativeElement,n).subscribe(r=>{r.focus()})}getNextItem(){return this.index<this.displayItems.length-1&&this.index++,this.displayItems[this.index]}hasNextElement(){return this.index<this.displayItems.length-1&&(this.index!==this.displayItems.length-2||!this.displayItems[this.index+1].disabled)}getNextElement(){const n=this.listElementList?this.listElementList.toArray():[];if(!n.length)return null;for(let r=this.index+1;r<n.length;r++)if(!this.displayItems[r].disabled)return this.index=r,n[r].nativeElement;return n[this.index]?.nativeElement}getPrevItem(){return this.index>0&&this.index--,this.displayItems[this.index]}hasPrevElement(){return this.index>0&&(1!==this.index||!this.displayItems[0].disabled)}getPrevElement(){const n=this.listElementList?this.listElementList.toArray():[];if(!n.length)return null;for(let r=this.index-1;r<this.index&&r>=0;r--)if(!this.displayItems[r].disabled)return this.index=r,n[r].nativeElement;return n[this.index].nativeElement}getCurrentItem(){return this.index<0?this.displayItems[0]:this.displayItems[this.index]}getCurrentElement(){return this.index<0?this.listElementList.first.nativeElement:this.listElementList.toArray()[this.index].nativeElement}getListItems(){return this._items}getSelected(){let n=this.getListItems().filter(r=>r.selected);return 0===n.length?[]:n}propagateSelected(n){Array.isArray(n)||console.error(`${this.constructor.name}.propagateSelected expects an Array<ListItem>, got ${JSON.stringify(n)}`),this.onItemsReady(()=>{const r=[];for(let s of n)if(s&&s.selected){let c=Object.assign({},s);delete c.selected,c=JSON.stringify(c),r.push(c)}for(let s of this.getListItems()){if(0===r.length){s.selected=!1;continue}let c=Object.assign({},s);delete c.selected,c=JSON.stringify(c);for(let f of r){if(c.includes(f)){s.selected=!0;break}s.selected=!1}}})}initFocus(){this.index<0&&this.updateIndex(),this.list.nativeElement.focus(),setTimeout(()=>{this.highlightedItem=this.getItemId(this.index)})}updateIndex(){const n=this.getSelected();n.length?this.index=this.displayItems.indexOf(n[0]):this.hasNextElement()&&this.getNextElement()}navigateList(n){"Enter"===n.key||" "===n.key?(this.listElementList.some(r=>r.nativeElement===n.target)&&n.preventDefault(),"Enter"===n.key&&this.doClick(n,this.getCurrentItem())):("ArrowDown"===n.key||"ArrowUp"===n.key)&&(n.preventDefault(),"ArrowDown"===n.key?this.hasNextElement()?this.getNextElement()?.scrollIntoView({block:"end"}):this.blurIntent.emit("bottom"):"ArrowUp"===n.key&&(this.hasPrevElement()?this.getPrevElement().scrollIntoView({block:"nearest"}):this.blurIntent.emit("top")),setTimeout(()=>{this.highlightedItem=this.getItemId(this.index)}))}doClick(n,r){if(n.preventDefault(),r&&!r.disabled){if(this.list.nativeElement.focus(),"single"===this.type){r.selected=!0;for(let s of this.getListItems())r!==s&&(s.selected=!1)}else r.selected=!r.selected;this.index=this.displayItems.indexOf(r),this.highlightedItem=this.getItemId(this.index),this.doEmitSelect(!1),this.appRef.tick()}}onItemFocus(n){const r=this.listElementList.toArray()[n].nativeElement;r.classList.add("cds--list-box__menu-item--highlighted"),r.tabIndex=0}onItemBlur(n){const r=this.listElementList.toArray()[n].nativeElement;r.classList.remove("cds--list-box__menu-item--highlighted"),r.tabIndex=-1}emitScroll(n){this.scroll.emit({atTop:0===n.srcElement.scrollTop,atBottom:n.srcElement.scrollHeight-n.srcElement.scrollTop===n.srcElement.clientHeight,event:n})}onItemsReady(n){(this._itemsReady||Sr(!0)).pipe(p_()).subscribe(n)}reorderSelected(n=!0){this.displayItems=[...this.getSelected(),...this.getListItems().filter(r=>!r.selected)],n&&setTimeout(()=>{this.updateIndex(),this.highlightedItem=this.getItemId(this.index)})}}return t.listCount=0,t.\u0275fac=function(n){return new(n||t)(vt(yl),vt(av),vt(Ou))},t.\u0275cmp=Ra({type:t,selectors:[["cds-dropdown-list"],["ibm-dropdown-list"]],viewQuery:function(n,r){if(1&n&&(Es(u1e,7),Es(h1e,5)),2&n){let s;yi(s=Mu())&&(r.list=s.first),yi(s=Mu())&&(r.listElementList=s)}},inputs:{ariaLabel:"ariaLabel",items:"items",listTpl:"listTpl",type:"type",showTitles:"showTitles"},outputs:{select:"select",scroll:"scroll",blurIntent:"blurIntent"},features:[ns([{provide:wpe,useExisting:t}])],decls:3,vars:4,consts:[["role","listbox","tabindex","-1",1,"cds--list-box__menu","cds--multi-select",3,"id","scroll","keydown"],["list",""],["role","option","class","cds--list-box__menu-item",3,"id","ngClass","click",4,"ngFor","ngForOf"],["role","option",1,"cds--list-box__menu-item",3,"id","ngClass","click"],["tabindex","-1",1,"cds--list-box__menu-item__option"],["listItem",""],["class","cds--form-item cds--checkbox-wrapper",4,"ngIf"],[4,"ngIf"],["cdsIcon","checkmark","size","16","class","cds--list-box__menu-item__selected-icon",4,"ngIf"],[1,"cds--form-item","cds--checkbox-wrapper"],[1,"cds--checkbox-label"],["type","checkbox","tabindex","-1",1,"cds--checkbox",3,"checked","disabled"],[1,"cds--checkbox-appearance"],[1,"cds--checkbox-label-text"],["cdsIcon","checkmark","size","16",1,"cds--list-box__menu-item__selected-icon"],[3,"ngTemplateOutletContext","ngTemplateOutlet"]],template:function(n,r){1&n&&(Gn(0,"ul",0,1),Ar("scroll",function(c){return r.emitScroll(c)})("keydown",function(c){return r.navigateList(c)}),mr(2,v1e,7,12,"li",2),_r()),2&n&&(un("id",r.listId),ca("aria-label",r.ariaLabel)("aria-activedescendant",r.highlightedItem),fn(2),un("ngForOf",r.displayItems))},dependencies:[hp,cA,dp,Ky,EY],encapsulation:2}),t})(),x1e=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=_s({type:t}),t.\u0275inj=cs({providers:[Epe],imports:[ld,H9,dY,_pe,B_e,xY]}),t})();const T1e=["mapContainerInner"];function C1e(t,e){if(1&t){const n=$d();Gn(0,"div",18)(1,"span"),Ho(2),_r(),Gn(3,"input",19),Ar("input",function(s){const f=va(n).$implicit;return Zs(or(2).changeColor(f,s))}),_r()()}if(2&t){const n=e.$implicit;fn(2),Xs(n)}}function I1e(t,e){if(1&t&&(Gn(0,"div"),mr(1,C1e,4,1,"div",17),_r()),2&t){const n=or();fn(1),un("ngForOf",n.selectedPropertyValues)}}function S1e(t,e){1&t&&(bc(0),Gn(1,"span",20),Ho(2,"\u25b6"),_r(),Qc())}function A1e(t,e){1&t&&(Gn(0,"span",20),Ho(1,"\u25c0"),_r())}const D1e=function(t){return{"hidden-panel":t}},P1e=function(){return[".geojson",".json"]},R1e=[{path:"",redirectTo:"/map",pathMatch:"full"},{path:"map",component:(()=>{class t{constructor(n){this.firebaseService=n,this.features=[],this.currentMeasurement=null,this.properties=[],this.selectedPropertyValues=[],this.valueColorMap={},this.label="Property",this.hideLabel=!1,this.skeleton=!1,this.helperText="Select a property",this.size="md",this.dropUp=!1,this.invalid=!1,this.invalidText="",this.warn=!1,this.warnText="",this.theme="light",this.disabled=!1,this.readonly=!1,this.measurementInfo="",this.color="#000000",this.isPanelHidden=!1,this.isModalOpen=!0}ngAfterViewInit(){this.initMap(),this.initDrawingManager()}togglePanel(){this.isPanelHidden=!this.isPanelHidden}openModal(){this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}onClose(n){}initMap(){this.map=new Ns.Map(this.mapContainerInner.nativeElement,{center:[0,0],zoom:2,authOptions:{authType:Ns.AuthenticationType.subscriptionKey,subscriptionKey:"5px69u6-Ip7aV4oN98U9OuqW_CoTU4lokXmi5J1w9sk"}}),this.map.events.add("ready",()=>{this.initDrawingManager(),this.addMapClickEvent(),this.map.controls.add([new Ns.control.ZoomControl,new Ns.control.PitchControl,new Ns.control.CompassControl,new Ns.control.StyleControl({mapStyles:"all"})],{position:Ns.ControlPosition.TopRight})})}initDrawingManager(){this.drawingManager=new P7.VO.DrawingManager(this.map,{toolbar:new P7.$C.DrawingToolbar({buttons:["draw-line","draw-polygon","draw-rectangle","draw-circle","edit-geometry"],position:"top-right",style:"light"})}),this.map.events.add("drawingmodechanged",this.drawingManager,n=>{n.startsWith("draw")&&(this.drawingManager.getSource().clear(),this.measurementInfo="")}),this.map.events.add("drawingchanging",this.drawingManager,n=>this.measureShape(n)),this.map.events.add("drawingchanged",this.drawingManager,n=>this.measureShape(n)),this.map.events.add("drawingcomplete",this.drawingManager,n=>this.drawingComplete(n))}drawingComplete(n){this.drawingManager.setOptions({mode:null}),this.measureShape(n)}measureShape(n){let r="";if(n.isCircle()){const s=Ns.math.convertDistance(n.getProperties().radius,"meters","miles",2);r=`Radius: ${s} mi<br/>Area: ${Math.round(2*Math.PI*s*s*100)/100} sq mi<br/>Perimeter: ${Math.round(2*Math.PI*s*100)/100} mi`}else{const s=n.toJson().geometry;let c;switch(n.getType()){case"LineString":Array.isArray(s.coordinates)&&(r=`Length: ${Math.round(100*Ns.math.getLengthOfPath(s.coordinates,"miles"))/100} mi`),"draw-polygon"===this.drawingManager.getOptions().mode&&(c=new Ns.data.Polygon(s.coordinates));break;case"Polygon":Array.isArray(s.coordinates)&&(c=s,r=`Perimeter: ${Math.round(100*Ns.math.getLengthOfPath(s.coordinates[0],"miles"))/100} mi`)}c&&(r+=`<br/>Area: ${(Ns.math.getArea(c,Ns.math.AreaUnits.squareMeters,2)/2589988.11).toFixed(2)} sq mi`)}this.measurementInfo=r,document.getElementById("measurementInfo").innerHTML=r}addMapClickEvent(){this.map.events.add("click",n=>{const r=this.map.layers.getRenderedShapes(n.position);if(r.length>0){let s="<table>";r.forEach(c=>{const f=c instanceof Ns.Shape?c.getProperties():c.properties;for(const v in f)if(f.hasOwnProperty(v)){const b=f[v];null!==b&&"string"==typeof b&&""!==b.trim()&&(s+=`<tr><td>${v}</td><td>${b}</td></tr>`)}}),s+="</table>",new Ns.Popup({position:n.position,content:s}).open(this.map)}})}onFileSelected(n){const r=n.target.files[0];if(!r)return void console.error("No file selected");const s=new FileReader;s.onload=c=>{try{const f=JSON.parse(c.target.result);if(!this.map)return void console.error("Map is not initialized");const v=new Ns.source.DataSource;v.add(f),this.map.sources.add(v),this.pointLayer=new Ns.layer.BubbleLayer(v,null,{filter:["in","$type","Point"]}),this.lineLayer=new Ns.layer.LineLayer(v,null,{filter:["in","$type","LineString"]}),this.polygonLayer=new Ns.layer.PolygonLayer(v,null,{filter:["in","$type","Polygon"]}),this.map.layers.add([this.pointLayer,this.lineLayer,this.polygonLayer]),this.features=v.getShapes(),this.properties=[];const b=new Set;this.features.forEach(k=>{const F=k.getProperties();Object.keys(F).forEach(H=>{b.has(H)||(b.add(H),this.properties.push({content:H,selected:!1}))})});const S=Ns.data.BoundingBox.fromData(f);this.map.setCamera({bounds:S,padding:40}),this.firebaseService.uploadFile(r).then(()=>{console.log("File uploaded to Firebase Storage"),this.closeModal()}).catch(k=>{console.error("Error uploading file:",k)}),this.updateMapLayers()}catch(f){console.error("Error processing GeoJSON file:",f)}},s.readAsText(r)}selectProperty(n){this.selectedProperty=n.item.content,console.log("Selected property:",this.selectedProperty),this.selectedPropertyValues=this.getValues(this.selectedProperty),console.log("Selected property values:",this.selectedPropertyValues),this.updateMapLayers()}changeColor(n,r){this.valueColorMap[n]=r.target.value,this.updateMapLayers()}updateMapLayers(){const n=this.selectedProperty;this.getValues(n),this.map.layers.remove(this.pointLayer),this.map.layers.remove(this.lineLayer),this.map.layers.remove(this.polygonLayer);const s=new Ns.source.DataSource;this.features.forEach(c=>{const f=c.getProperties(),b=this.valueColorMap[f[n]]||"green";c instanceof Ns.Shape&&c.setProperties({...f,color:b}),s.add(c)}),this.pointLayer=new Ns.layer.BubbleLayer(s,null,{filter:["in","$type","Point"],color:["get","color"]}),this.lineLayer=new Ns.layer.LineLayer(s,null,{filter:["in","$type","LineString"],strokeColor:["get","color"]}),this.polygonLayer=new Ns.layer.PolygonLayer(s,null,{filter:["in","$type","Polygon"],fillColor:["get","color"]}),this.map.sources.add(s),this.map.layers.add([this.pointLayer,this.lineLayer,this.polygonLayer])}getValues(n){return n?this.features.map(r=>r.getProperties()[n]).filter((r,s,c)=>c.indexOf(r)===s):[]}static#e=this.\u0275fac=function(r){return new(r||t)(vt(v_e))};static#t=this.\u0275cmp=Ra({type:t,selectors:[["app-map"]],viewQuery:function(r,s){if(1&r&&Es(T1e,7),2&r){let c;yi(c=Mu())&&(s.mapContainerInner=c.first)}},decls:21,vars:38,consts:[[2,"position","fixed","top","1","left","0","/* aligns with the left edge */\n    z-index","1000","/* high z-index to ensure visibility */\n    padding","15px","background-color","#ccc","border","1px solid #ccc","width","300px","/* adjust width as needed */\n    height","calc(100vh - 20px)","/* full height minus some padding */\n    display","flex","flex-direction","column","gap","15px","overflow-y","auto","transition","transform 0.5s ease-in-out","/* add transition for smooth rail effect */\n    transform","translateX(0)",3,"ngClass"],["cdsButton","primary",3,"click"],["for","property-select"],["placeholder","Choose Property",3,"label","hideLabel","skeleton","helperText","size","dropUp","invalid","invalidText","warn","warnText","theme","disabled","readonly","selected","onClose"],[2,"max-height","calc(1.5rem * 7)","overflow-y","auto",3,"items"],[4,"ngIf"],["cdsButton","primary",2,"position","fixed","top","10px","/* adjusted to add margin */\n    left","310px","/* aligns at the right edge of the tile plus margin */\n    z-index","1010","padding","10px","/* equal padding around the sign */\n    margin","5px","/* added margin */\n    transition","left 0.5s ease-in-out",3,"click"],[4,"ngIf","ngIfElse"],["openSign",""],["modalTitle","Upload GeoJSON File",2,"display","flex","align-items","center","justify-content","center",3,"open","size","overlaySelected"],["cdsButton","ghost",2,"position","absolute","top","10px","right","10px","font-size","20px","background","none","border","none","cursor","pointer","color","#333",3,"click"],[2,"display","flex","align-items","center","justify-content","center","width","100%"],[2,"max-width","400px","width","100%",3,"drop","title","description","buttonText","buttonType","accept","multiple","size","fileItemSize","disabled","dropText","change"],["id","mapContainer",1,"map-container",2,"position","relative"],[1,"map-container-inner"],["mapContainerInner",""],["id","measurementInfo",2,"position","absolute","bottom","10px","left","10px","background-color","white","border-radius","10px","padding","10px","z-index","1"],["class","color-picker",4,"ngFor","ngForOf"],[1,"color-picker"],["type","color",3,"input"],[2,"padding","5px"]],template:function(r,s){if(1&r&&(Gn(0,"cds-tile",0)(1,"button",1),Ar("click",function(){return s.openModal()}),Ho(2,"Upload GeoJSON File"),_r(),Gn(3,"label",2),Ho(4,"Choose Property:"),_r(),Gn(5,"cds-dropdown",3),Ar("selected",function(f){return s.selectProperty(f)})("onClose",function(f){return s.onClose(f)}),Rs(6,"cds-dropdown-list",4),_r(),mr(7,I1e,2,1,"div",5),_r(),Gn(8,"button",6),Ar("click",function(){return s.togglePanel()}),mr(9,S1e,3,0,"ng-container",7),mr(10,A1e,2,0,"ng-template",null,8,zS),_r(),Gn(12,"cds-modal",9),Ar("overlaySelected",function(){return s.closeModal()}),Gn(13,"button",10),Ar("click",function(){return s.closeModal()}),Ho(14," \u2715 "),_r(),Gn(15,"div",11)(16,"cds-file-uploader",12),Ar("change",function(f){return s.onFileSelected(f)}),_r()()(),Gn(17,"div",13),Rs(18,"div",14,15)(20,"div",16),_r()),2&r){const c=Ql(11);tE("transform",s.isPanelHidden?"translateX(-100%)":"translateX(0)"),un("ngClass",vh(35,D1e,s.isPanelHidden)),fn(5),un("label",s.label)("hideLabel",s.hideLabel)("skeleton",s.skeleton)("helperText",s.helperText)("size","md")("dropUp",s.dropUp)("invalid",s.invalid)("invalidText",s.invalidText)("warn",s.warn)("warnText",s.warnText)("theme","light")("disabled",s.disabled)("readonly",s.readonly),fn(1),un("items",s.properties),fn(1),un("ngIf",(null==s.selectedPropertyValues?null:s.selectedPropertyValues.length)>0),fn(1),tE("left",s.isPanelHidden?"5px":"310px"),fn(1),un("ngIf",s.isPanelHidden)("ngIfElse",c),fn(3),un("open",s.isModalOpen)("size","lg"),fn(4),un("drop",!0)("title","Upload GeoJSON File")("description","Select a GeoJSON file to upload and display on the map.")("buttonText","Upload File")("buttonType","primary")("accept",function ik(t,e,n){const r=zl()+t,s=Bt();return s[r]===Ur?Xh(s,r,n?e.call(n):e()):function bS(t,e){return t[e]}(s,r)}(37,P1e))("multiple",!1)("size","md")("fileItemSize","lg")("disabled",!1)("dropText","Drag and drop files here or upload")}},dependencies:[hp,cA,dp,Dwe,bY,jwe,vpe,w1e,E1e],styles:["#mapContainer[_ngcontent-%COMP%]{width:100%;height:100vh}.map-container[_ngcontent-%COMP%]{position:relative}.map-container[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;z-index:1000}.map-container-inner[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.right-panel[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background-color:#fff;border-radius:10px;padding:10px;z-index:1001;max-width:200px;overflow-y:auto;box-shadow:0 4px 6px #0000001a}#measurementToolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:5px}cds-tile[_ngcontent-%COMP%]{transition:transform .5s ease-in-out}.hidden-panel[_ngcontent-%COMP%]{transform:translate(-110%)}"]})}return t})()}];let M1e=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=_s({type:t});static#n=this.\u0275inj=cs({imports:[S7.forRoot(R1e),S7]})}return t})(),k1e=(()=>{class t{constructor(){this.title="KGIS"}static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275cmp=Ra({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(r,s){1&r&&Rs(0,"router-outlet")},dependencies:[qz]})}return t})(),O1e=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#t=this.\u0275mod=_s({type:t,bootstrap:[k1e]});static#n=this.\u0275inj=cs({imports:[t9,M1e,H9,Pwe,Soe,mpe,Dbe,x1e,mpe]})}return t})();j0().bootstrapModule(O1e).catch(t=>console.error(t))},155:(CF,ub,hb)=>{hb.r(ub),hb.d(ub,{AuthenticationType:()=>so,ControlPosition:()=>Ll,ControlStyle:()=>ya,HtmlMarker:()=>f2,Map:()=>Cg,Pixel:()=>_l,Popup:()=>Q1,PopupTemplate:()=>q7,Shape:()=>ws,_enableRTLTextPlugin:()=>ZP,_getAssetDomain:()=>YP,_getDomain:()=>Jp,_hasMaxParallelImageRequests:()=>ym,_hasSetAuthenticationOptions:()=>jC,_hasSetDomain:()=>HC,_hasSetLanguage:()=>WP,_hasSetSessionId:()=>Ab,_hasSetStyleDefinitionsPath:()=>Ib,_hasSetStyleDefinitionsVersion:()=>Sb,_hasSetView:()=>Db,_hasWorkerCount:()=>$C,addImageTemplate:()=>GP,addProtocol:()=>gm,clearPrewarmedResources:()=>la,control:()=>KZ,data:()=>O$,default:()=>Dte,getAllImageTemplateNames:()=>$h,getAuthenticationOptions:()=>IC,getDomain:()=>Yg,getImageTemplate:()=>zC,getLanguage:()=>RC,getMaxParallelImageRequests:()=>PC,getSessionId:()=>MC,getStaticAssetsDomain:()=>SC,getStyleAPIVersion:()=>DC,getStyleDefinitionsPath:()=>AC,getStyleDefinitionsVersion:()=>Zg,getSubscriptionKey:()=>qP,getUserRegion:()=>wb,getVersion:()=>kC,getView:()=>bb,getWorkerCount:()=>mm,internal:()=>JP,isSupported:()=>Eb,layer:()=>a8,math:()=>N$,prewarm:()=>KP,removeProtocol:()=>sh,setAuthenticationOptions:()=>OC,setDomain:()=>NC,setLanguage:()=>FC,setMaxParallelImageRequests:()=>Wa,setSessionId:()=>VC,setStyleAPIVersion:()=>xb,setStyleDefinitionsPath:()=>LC,setStyleDefinitionsVersion:()=>gv,setSubscriptionKey:()=>BC,setUserRegion:()=>Cb,setView:()=>UC,setWorkerCount:()=>Tb,source:()=>X$});var Si=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nl(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var so,a,pn={exports:{}},Ka=Nl((pn.exports=function(){var o={},i={};function l(u,h,g){i[u]=g,"index"===u&&(g="var sharedModule = {}; ("+i.shared+")(sharedModule); ("+i.worker+")(sharedModule);",i.shared(u={}),i.index(o,u),typeof window<"u")&&o.setWorkerUrl(window.URL.createObjectURL(new Blob([g],{type:"text/javascript"})))}return l("shared",0,function(u){function h(m,p,y,E){return new(y=y||Promise)(function(I,R){function O(q){try{V(E.next(q))}catch($){R($)}}function L(q){try{V(E.throw(q))}catch($){R($)}}function V(q){var $;q.done?I(q.value):(($=q.value)instanceof y?$:new y(function(Y){Y($)})).then(O,L)}V((E=E.apply(m,p||[])).next())})}function g(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var w=T;function T(m,p){this.x=m,this.y=p}T.prototype={clone:function(){return new T(this.x,this.y)},add:function(m){return this.clone()._add(m)},sub:function(m){return this.clone()._sub(m)},multByPoint:function(m){return this.clone()._multByPoint(m)},divByPoint:function(m){return this.clone()._divByPoint(m)},mult:function(m){return this.clone()._mult(m)},div:function(m){return this.clone()._div(m)},rotate:function(m){return this.clone()._rotate(m)},rotateAround:function(m,p){return this.clone()._rotateAround(m,p)},matMult:function(m){return this.clone()._matMult(m)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(m){return this.x===m.x&&this.y===m.y},dist:function(m){return Math.sqrt(this.distSqr(m))},distSqr:function(y){var p=y.x-this.x;return p*p+(y=y.y-this.y)*y},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(m){return Math.atan2(this.y-m.y,this.x-m.x)},angleWith:function(m){return this.angleWithSep(m.x,m.y)},angleWithSep:function(m,p){return Math.atan2(this.x*p-this.y*m,this.x*m+this.y*p)},_matMult:function(y){var p=y[0]*this.x+y[1]*this.y;return y=y[2]*this.x+y[3]*this.y,this.x=p,this.y=y,this},_add:function(m){return this.x+=m.x,this.y+=m.y,this},_sub:function(m){return this.x-=m.x,this.y-=m.y,this},_mult:function(m){return this.x*=m,this.y*=m,this},_div:function(m){return this.x/=m,this.y/=m,this},_multByPoint:function(m){return this.x*=m.x,this.y*=m.y,this},_divByPoint:function(m){return this.x/=m.x,this.y/=m.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var m=this.y;return this.y=this.x,this.x=-m,this},_rotate:function(E){var p=Math.cos(E),y=(E=Math.sin(E),p*this.x-E*this.y);return E=E*this.x+p*this.y,this.x=y,this.y=E,this},_rotateAround:function(I,p){var y=Math.cos(I),E=(I=Math.sin(I),p.x+y*(this.x-p.x)-I*(this.y-p.y));return I=p.y+I*(this.x-p.x)+y*(this.y-p.y),this.x=E,this.y=I,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},T.convert=function(m){return m instanceof T||!Array.isArray(m)?m:new T(m[0],m[1])};var D=g(w),P=N;function N(m,p,y,E){this.cx=3*m,this.bx=3*(y-m)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*p,this.by=3*(E-p)-this.cy,this.ay=1-this.cy-this.by,this.p1x=m,this.p1y=p,this.p2x=y,this.p2y=E}N.prototype={sampleCurveX:function(m){return((this.ax*m+this.bx)*m+this.cx)*m},sampleCurveY:function(m){return((this.ay*m+this.by)*m+this.cy)*m},sampleCurveDerivativeX:function(m){return(3*this.ax*m+2*this.bx)*m+this.cx},solveCurveX:function(m,p){if(void 0===p&&(p=1e-6),m<0)return 0;if(1<m)return 1;for(var y=m,E=0;E<8;E++){var I=this.sampleCurveX(y)-m;if(Math.abs(I)<p)return y;var R=this.sampleCurveDerivativeX(y);if(Math.abs(R)<1e-6)break;y-=I/R}var O=0,L=1;for(y=m,E=0;E<20&&(I=this.sampleCurveX(y),!(Math.abs(I-m)<p));E++)I<m?O=y:L=y,y=.5*(L-O)+O;return y},solve:function(m,p){return this.sampleCurveY(this.solveCurveX(m,p))}};var z=g(P);let W,ge;function ue(){return W=W??(typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap)}function we(){if(null==ge&&(ge=!1,ue())){var m=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(m){for(let E=0;E<25;E++){var p=4*E;m.fillStyle=`rgb(${p},${1+p},${2+p})`,m.fillRect(E%5,Math.floor(E/5),1,1)}var y=m.getImageData(0,0,5,5).data;for(let E=0;E<100;E++)if(E%4!=3&&y[E]!==E){ge=!0;break}}}return ge||!1}function et(m,p,y,E){const I=new z(m,p,y,E);return function(R){return I.solve(R)}}function Mt(m,p,y){return Math.min(y,Math.max(p,m))}function St(I,p,y){var E=y-p;return(I=((I-p)%E+E)%E+p)===p?y:I}function Qt(m,...p){for(const y of p)for(const E in y)m[E]=y[E];return m}P=et(.25,.1,.25,1);let Le=1;function Je(m,p,y){var E={};for(const I in m)E[I]=p.call(y||this,m[I],I,m);return E}function ot(m,p,y){var E={};for(const I in m)p.call(y||this,m[I],I,m)&&(E[I]=m[I]);return E}function Et(m){return Array.isArray(m)?m.map(Et):"object"==typeof m&&m?Je(m,Et):m}const Ne={};function lt(m){Ne[m]||(typeof console<"u"&&console.warn(m),Ne[m]=!0)}function It(m,p,y){return(y.y-m.y)*(p.x-m.x)>(p.y-m.y)*(y.x-m.x)}function xt(m){return typeof WorkerGlobalScope<"u"&&void 0!==m&&m instanceof WorkerGlobalScope}let ln=null;function Sn(m){return typeof ImageBitmap<"u"&&m instanceof ImageBitmap}const We="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function on(m,p,y,E,I){return h(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");var R,O,L,V,q,$,Y,ae,pe,fe=new VideoFrame(m,{timestamp:0});try{var ve=fe?.format;if(!ve||!ve.startsWith("BGR")&&!ve.startsWith("RGB"))throw new Error("Unrecognized format "+ve);var ke=ve.startsWith("BGR"),_e=new Uint8ClampedArray(E*I*4);if(yield fe.copyTo(_e,(R=m,O=p,L=y,V=E,q=I,$=4*Math.max(-O,0),$=(Math.max(0,L)-L)*V*4+$,Y=4*V,ae=Math.max(0,O),pe=Math.max(0,L),{rect:{x:ae,y:pe,width:Math.min(R.width,O+V)-ae,height:Math.min(R.height,L+q)-pe},layout:[{offset:$,stride:Y}]})),ke)for(let Qe=0;Qe<_e.length;Qe+=4){var ze=_e[Qe];_e[Qe]=_e[Qe+2],_e[Qe+2]=ze}return _e}finally{fe.close()}})}let Rn,sr;const dt="AbortError";function pi(){return new Error(dt)}const Qn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ar(m){return Qn.REGISTERED_PROTOCOLS[m.substring(0,m.indexOf("://"))]}const Wr="global-dispatcher";class zn extends Error{constructor(p,y,E,I){super(`AJAXError: ${y} (${p}): `+E),this.status=p,this.statusText=y,this.url=E,this.body=I}}const Fr=()=>xt(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href;function Ao(m,p){if(/:\/\//.test(m.url)&&!/^https?:|^file:/.test(m.url)){var y=ar(m.url);if(y)return y(m,p);if(xt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:m,targetMapId:Wr},p)}if(!(m=>/^file:/.test(m)||/^file:/.test(Fr())&&!/^\w+:/.test(m))(m.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(R,O){return h(this,void 0,void 0,function*(){var L=new Request(R.url,{method:R.method||"GET",body:R.body,credentials:R.credentials,headers:R.headers,cache:R.cache,referrer:Fr(),signal:O.signal});if(!("json"===R.type&&L.headers.set("Accept","application/json"),L=yield fetch(L)).ok)throw q=yield L.blob(),new zn(L.status,L.statusText,R.url,q);let V;var q=yield V="arrayBuffer"===R.type||"image"===R.type?L.arrayBuffer():"json"===R.type?L.json():L.text();if(O.signal.aborted)throw pi();return{data:q,cacheControl:L.headers.get("Cache-Control"),expires:L.headers.get("Expires")}})}(m,p);if(xt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:m,mustQueue:!0,targetMapId:Wr},p)}return E=m,I=p,new Promise((R,O)=>{const L=new XMLHttpRequest;L.open(E.method||"GET",E.url,!0),"arrayBuffer"!==E.type&&"image"!==E.type||(L.responseType="arraybuffer");for(const V in E.headers)L.setRequestHeader(V,E.headers[V]);"json"===E.type&&(L.responseType="text",L.setRequestHeader("Accept","application/json")),L.withCredentials="include"===E.credentials,L.onerror=()=>{O(new Error(L.statusText))},L.onload=()=>{if(!I.signal.aborted)if((200<=L.status&&L.status<300||0===L.status)&&null!==L.response){let q=L.response;if("json"===E.type)try{q=JSON.parse(L.response)}catch($){return void O($)}R({data:q,cacheControl:L.getResponseHeader("Cache-Control"),expires:L.getResponseHeader("Expires")})}else{var V=new Blob([L.response],{type:L.getResponseHeader("Content-Type")});O(new zn(L.status,L.statusText,E.url,V))}},I.signal.addEventListener("abort",()=>{L.abort(),O(pi())}),L.send(E.body)});var E,I}function Ht(m){var p;return!m||m.indexOf("://")<=0||0===m.indexOf("data:image/")||0===m.indexOf("blob:")||(m=new URL(m),p=window.location,m.protocol===p.protocol&&m.host===p.host)}function yn(m,p,y){y[m]&&-1!==y[m].indexOf(p)||(y[m]=y[m]||[],y[m].push(p))}function gr(m,p,y){y&&y[m]&&-1!==(p=y[m].indexOf(p))&&y[m].splice(p,1)}class st{constructor(p,y={}){Qt(this,y),this.type=p}}class Ut extends st{constructor(p,y={}){super("error",Qt({error:p},y))}}class Jt{on(p,y){return this._listeners=this._listeners||{},yn(p,y,this._listeners),this}off(p,y){return gr(p,y,this._listeners),gr(p,y,this._oneTimeListeners),this}once(p,y){return y?(this._oneTimeListeners=this._oneTimeListeners||{},yn(p,y,this._oneTimeListeners),this):new Promise(E=>this.once(p,E))}fire(p,y){var E=(p="string"==typeof p?new st(p,y||{}):p).type;if(this.listens(E)){for(const I of(p.target=this)._listeners&&this._listeners[E]?this._listeners[E].slice():[])I.call(this,p);for(const I of this._oneTimeListeners&&this._oneTimeListeners[E]?this._oneTimeListeners[E].slice():[])gr(E,I,this._oneTimeListeners),I.call(this,p);(y=this._eventedParent)&&(Qt(p,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),y.fire(p))}else p instanceof Ut&&console.error(p.error);return this}listens(p){return this._listeners&&this._listeners[p]&&0<this._listeners[p].length||this._oneTimeListeners&&this._oneTimeListeners[p]&&0<this._oneTimeListeners[p].length||this._eventedParent&&this._eventedParent.listens(p)}setEventedParent(p,y){return this._eventedParent=p,this._eventedParentData=y,this}}var oe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ne=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function X(m,p){if(Array.isArray(m)){if(!Array.isArray(p)||m.length!==p.length)return;for(let y=0;y<m.length;y++)if(!X(m[y],p[y]))return;return 1}if("object"!=typeof m||null===m||null===p)return m===p;if("object"==typeof p&&Object.keys(m).length===Object.keys(p).length){for(const y in m)if(!X(m[y],p[y]))return;return 1}}function ie(m,p){m.push(p)}function ye(m,p,y){ie(y,{command:"addSource",args:[m,p[m]]})}function De(m,p,y){ie(p,{command:"removeSource",args:[m]}),y[m]=!0}function ct(m,p,y,E,I,R){p=p||{};for(const O in m=m||{})!Object.prototype.hasOwnProperty.call(m,O)||X(m[O],p[O])||y.push({command:R,args:[E,O,p[O],I]});for(const O in p)!Object.prototype.hasOwnProperty.call(p,O)||Object.prototype.hasOwnProperty.call(m,O)||X(m[O],p[O])||y.push({command:R,args:[E,O,p[O],I]})}function wt(m){return m.id}function Me(m,p){return m[p.id]=p,m}class Pe{constructor(p,y,E,I){this.message=(p?p+": ":"")+E,I&&(this.identifier=I),null!=y&&y.__line__&&(this.line=y.__line__)}}function Ft(m,...p){for(const y of p)for(const E in y)m[E]=y[E];return m}class kt extends Error{constructor(p,y){super(y),this.message=y,this.key=p}}class en{constructor(p,y=[]){for(var[E,I]of(this.parent=p,this.bindings={},y))this.bindings[E]=I}concat(p){return new en(this,p)}get(p){if(this.bindings[p])return this.bindings[p];if(this.parent)return this.parent.get(p);throw new Error(p+" not found in scope.")}has(p){return!!this.bindings[p]||!!this.parent&&this.parent.has(p)}}const Yn={kind:"null"},ut={kind:"number"},Dt={kind:"string"},qt={kind:"boolean"},Tr={kind:"color"},_i={kind:"object"},In={kind:"value"},Li={kind:"collator"},os={kind:"formatted"},vi={kind:"padding"},me={kind:"resolvedImage"},J={kind:"variableAnchorOffsetCollection"};function se(m,p){return{kind:"array",itemType:m,N:p}}function le(m){var p;return"array"===m.kind?(p=le(m.itemType),"number"==typeof m.N?`array<${p}, ${m.N}>`:"value"===m.itemType.kind?"array":`array<${p}>`):m.kind}const Ce=[Yn,ut,Dt,qt,Tr,os,_i,se(In),vi,me,J];function Ue(m,p){if("error"===p.kind)return null;if("array"===m.kind){if("array"===p.kind&&(0===p.N&&"value"===p.itemType.kind||!Ue(m.itemType,p.itemType))&&("number"!=typeof m.N||m.N===p.N))return null}else{if(m.kind===p.kind)return null;if("value"===m.kind)for(const y of Ce)if(!Ue(y,p))return null}return`Expected ${le(m)} but found ${le(p)} instead.`}function Xe(m,p){return p.some(y=>y.kind===m.kind)}function He(m,p){return p.some(y=>"null"===y?null===m:"array"===y?Array.isArray(m):"object"===y?m&&!Array.isArray(m)&&"object"==typeof m:y===typeof m)}function Ve(m,p){return"array"===m.kind&&"array"===p.kind?m.itemType.kind===p.itemType.kind&&"number"==typeof m.N:m.kind===p.kind}const cn=4/29,nr=6/29,$n=3*nr*nr,lr=nr*nr*nr,ci=Math.PI/180,wi=180/Math.PI;function Yr(m){return(m%=360)<0&&(m+=360),m}function ni([L,p,y,E]){let I,R;var O=rr((.2225045*(L=cr(L))+.7168786*(p=cr(p))+.0606169*(y=cr(y)))/1);return[(L===p&&p===y?I=R=O:(I=rr((.4360747*L+.3850649*p+.1430804*y)/.96422),R=rr((.0139322*L+.0971045*p+.7141733*y)/.82521)),(L=116*O-16)<0?0:L),500*(I-O),200*(O-R),E]}function cr(m){return m<=.04045?m/12.92:Math.pow((m+.055)/1.055,2.4)}function rr(m){return m>lr?Math.pow(m,1/3):m/$n+cn}function bi([m,p,y,E]){return m=(m+16)/116,p=isNaN(p)?m:m+p/500,y=isNaN(y)?m:m-y/200,m=1*da(m),[js(3.1338561*(p=.96422*da(p))-1.6168667*m-.4906146*(y=.82521*da(y))),js(-.9787684*p+1.9161415*m+.033454*y),js(.0719453*p-.2289914*m+1.4052427*y),E]}function js(m){return(m=m<=.00304?12.92*m:1.055*Math.pow(m,1/2.4)-.055)<0?0:1<m?1:m}function da(m){return m>nr?m*m*m:$n*(m-cn)}function Pc(m){return parseInt(m.padEnd(2,m),16)/255}function uD(m,p){return pw(p?m/100:m,0,1)}function pw(m,p,y){return Math.min(Math.max(p,m),y)}function g5(m){return!m.some(Number.isNaN)}const G7={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class wo{constructor(p,y,E,I=1,R=!0){this.r=p,this.g=y,this.b=E,this.a=I,R||(this.r*=I,this.g*=I,this.b*=I,I)||this.overwriteGetter("rgb",[p,y,E,I])}static parse(p){return p instanceof wo?p:"string"==typeof p&&(p=function Ua(m){if("transparent"===(m=m.toLowerCase().trim()))return[0,0,0,0];var Y,ae,pe,fe;if(fe=G7[m])return[fe,y,p]=fe,[fe/255,y/255,p/255,1];if(m.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(m))return[Pc(m.slice(y=1,y+=fe=m.length<6?1:2)),Pc(m.slice(y,y+=fe)),Pc(m.slice(y,y+=fe)),Pc(m.slice(y,y+fe)||"ff")];if(m.startsWith("rgb")&&(p=m.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/))){var p,[,y,fe,p,E,I,R,O,L,V,q,$]=p;return("  "===(p=[p||" ",R||" ",V].join(""))||"  /"===p||",,"===p||",,,"===p)&&(V="%%%"===(R=[fe,I,L].join(""))?100:""===R?255:0)&&g5(p=[pw(+y/V,0,1),pw(+E/V,0,1),pw(+O/V,0,1),q?uD(+q,$):1])?p:void 0}if(fe=m.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/)){var $,[,I,L,R,y,E,O,V,q]=fe;if(("  "===($=[L||" ",y||" ",O].join(""))||"  /"===$||",,"===$||",,,"===$)&&g5(p=[+I,pw(+R,0,100),pw(+E,0,100),V?uD(+V,q):1]))return[Y,ae,pe,m]=[p][0],Y=Yr(Y),ae/=100,pe/=100,[ve(0),ve(8),ve(4),m]}function ve(_e){_e=(_e+Y/30)%12;var ze=ae*Math.min(pe,1-pe);return pe-ze*Math.max(-1,Math.min(_e-3,9-_e,1))}}(p))?new wo(...p,!1):void 0}get rgb(){var{r:p,g:y,b:E,a:I}=this,R=I||1/0;return this.overwriteGetter("rgb",[p/R,y/R,E/R,I])}get hcl(){return this.overwriteGetter("hcl",function Dc(p){var[p,y,E,I]=ni(p),R=Math.sqrt(y*y+E*E);return[Math.round(1e4*R)?Yr(Math.atan2(E,y)*wi):NaN,R,p,I]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ni(this.rgb))}overwriteGetter(p,y){return Object.defineProperty(this,p,{value:y}),y}toString(){var[p,y,E,I]=this.rgb;return`rgba(${[p,y,E].map(R=>Math.round(255*R)).join(",")},${I})`}}wo.black=new wo(0,0,0,1),wo.white=new wo(1,1,1,1),wo.transparent=new wo(0,0,0,0),wo.red=new wo(1,0,0,1);class w_{constructor(p,y,E){this.sensitivity=p?y?"variant":"case":y?"accent":"base",this.locale=E,this.collator=new Intl.Collator(this.locale||[],{sensitivity:this.sensitivity,usage:"search"})}compare(p,y){return this.collator.compare(p,y)}resolvedLocale(){return new Intl.Collator(this.locale||[]).resolvedOptions().locale}}class nT{constructor(p,y,E,I,R){this.text=p,this.image=y,this.scale=E,this.fontStack=I,this.textColor=R}}class Ku{constructor(p){this.sections=p}static fromString(p){return new Ku([new nT(p,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(p=>0!==p.text.length||p.image&&0!==p.image.name.length)}static factory(p){return p instanceof Ku?p:Ku.fromString(p)}toString(){return 0===this.sections.length?"":this.sections.map(p=>p.text).join("")}}class sl{constructor(p){this.values=p.slice()}static parse(p){if(p instanceof sl)return p;if("number"==typeof p)return new sl([p,p,p,p]);if(Array.isArray(p)&&!(p.length<1||4<p.length)){for(const y of p)if("number"!=typeof y)return;switch(p.length){case 1:p=[p[0],p[0],p[0],p[0]];break;case 2:p=[p[0],p[1],p[0],p[1]];break;case 3:p=[p[0],p[1],p[2],p[1]]}return new sl(p)}}toString(){return JSON.stringify(this.values)}}const FN=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ph{constructor(p){this.values=p.slice()}static parse(p){if(p instanceof Ph)return p;if(Array.isArray(p)&&!(p.length<1)&&p.length%2==0){for(let I=0;I<p.length;I+=2){var y=p[I],E=p[I+1];if("string"!=typeof y||!FN.has(y)||!Array.isArray(E)||2!==E.length||"number"!=typeof E[0]||"number"!=typeof E[1])return}return new Ph(p)}}toString(){return JSON.stringify(this.values)}}class lc{constructor(p){this.name=p.name,this.available=p.available}toString(){return this.name}static fromString(p){return p?new lc({name:p,available:!1}):null}}function hD(m,p,y,E){return"number"==typeof m&&0<=m&&m<=255&&"number"==typeof p&&0<=p&&p<=255&&"number"==typeof y&&0<=y&&y<=255?void 0===E||"number"==typeof E&&0<=E&&E<=1?null:`Invalid rgba value [${[m,p,y,E].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof E?[m,p,y,E]:[m,p,y]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function vd(m){if(null===m||"string"==typeof m||"boolean"==typeof m||"number"==typeof m||m instanceof wo||m instanceof w_||m instanceof Ku||m instanceof sl||m instanceof Ph||m instanceof lc)return 1;if(Array.isArray(m)){for(const p of m)if(!vd(p))return;return 1}if("object"==typeof m){for(const p in m)if(!vd(m[p]))return;return 1}}function Zi(m){if(null===m)return Yn;if("string"==typeof m)return Dt;if("boolean"==typeof m)return qt;if("number"==typeof m)return ut;if(m instanceof wo)return Tr;if(m instanceof w_)return Li;if(m instanceof Ku)return os;if(m instanceof sl)return vi;if(m instanceof Ph)return J;if(m instanceof lc)return me;if(Array.isArray(m)){var p=m.length;let E;for(const I of m){var y=Zi(I);if(E){if(E!==y){E=In;break}}else E=y}return se(E||In,p)}return _i}function Ia(m){var p=typeof m;return null===m?"":"string"==p||"number"==p||"boolean"==p?String(m):m instanceof wo||m instanceof Ku||m instanceof sl||m instanceof Ph||m instanceof lc?m.toString():JSON.stringify(m)}class wd{constructor(p,y){this.type=p,this.value=y}static parse(p,y){if(2!==p.length)return y.error(`'literal' expression requires exactly one argument, but found ${p.length-1} instead.`);if(!vd(p[1]))return y.error("invalid value");let E=Zi(p=p[1]);return y=y.expectedType,"array"!==E.kind||0!==E.N||!y||"array"!==y.kind||"number"==typeof y.N&&0!==y.N||(E=y),new wd(E,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class fi{constructor(p){this.name="ExpressionEvaluationError",this.message=p}toJSON(){return this.message}}const bd={string:Dt,number:ut,boolean:qt,object:_i};class Pt{constructor(p,y){this.type=p,this.args=y}static parse(p,y){if(p.length<2)return y.error("Expected at least one argument.");let I,E=1;var R=p[0];if("array"===R){let V,q;if(2<p.length){const $=p[1];if("string"!=typeof $||!($ in bd)||"object"===$)return y.error('The item type argument of "array" must be one of string, number, boolean',1);V=bd[$],E++}else V=In;if(3<p.length){if(null!==p[2]&&("number"!=typeof p[2]||p[2]<0||p[2]!==Math.floor(p[2])))return y.error('The length argument to "array" must be a positive integer literal',2);q=p[2],E++}I=se(V,q)}else{if(!bd[R])throw new Error("Types doesn't contain name = "+R);I=bd[R]}for(var O=[];E<p.length;E++){var L=y.parse(p[E],E,In);if(!L)return null;O.push(L)}return new Pt(I,O)}evaluate(p){for(let E=0;E<this.args.length;E++){var y=this.args[E].evaluate(p);if(!Ue(this.type,Zi(y)))return y;if(E===this.args.length-1)throw new fi(`Expected value to be of type ${le(this.type)}, but found ${le(Zi(y))} instead.`)}throw new Error}eachChild(p){this.args.forEach(p)}outputDefined(){return this.args.every(p=>p.outputDefined())}}const Rh={"to-boolean":qt,"to-color":Tr,"to-number":ut,"to-string":Dt};class Il{constructor(p,y){this.type=p,this.args=y}static parse(p,y){if(p.length<2)return y.error("Expected at least one argument.");if(!Rh[E=p[0]])throw new Error(`Can't parse ${E} as it is not part of the known types`);if(("to-boolean"===E||"to-string"===E)&&2!==p.length)return y.error("Expected one argument.");var E=Rh[E],I=[];for(let O=1;O<p.length;O++){var R=y.parse(p[O],O,In);if(!R)return null;I.push(R)}return new Il(E,I)}evaluate(p){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(p);case"color":{let O,L;for(const V of this.args){if(O=V.evaluate(p),L=null,O instanceof wo)return O;if("string"==typeof O){var y=p.parseColor(O);if(y)return y}else if(Array.isArray(O)&&!(L=O.length<3||4<O.length?`Invalid rbga value ${JSON.stringify(O)}: expected an array containing either three or four numeric values.`:hD(O[0],O[1],O[2],O[3])))return new wo(O[0]/255,O[1]/255,O[2]/255,O[3])}throw new fi(L||`Could not parse color from value '${"string"==typeof O?O:JSON.stringify(O)}'`)}case"padding":{let O;for(const L of this.args){O=L.evaluate(p);var E=sl.parse(O);if(E)return E}throw new fi(`Could not parse padding from value '${"string"==typeof O?O:JSON.stringify(O)}'`)}case"variableAnchorOffsetCollection":{let O;for(const L of this.args){O=L.evaluate(p);var I=Ph.parse(O);if(I)return I}throw new fi(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof O?O:JSON.stringify(O)}'`)}case"number":{let O=null;for(const L of this.args){if(null===(O=L.evaluate(p)))return 0;var R=Number(O);if(!isNaN(R))return R}throw new fi(`Could not convert ${JSON.stringify(O)} to number.`)}case"formatted":return Ku.fromString(Ia(this.args[0].evaluate(p)));case"resolvedImage":return lc.fromString(Ia(this.args[0].evaluate(p)));default:return Ia(this.args[0].evaluate(p))}}eachChild(p){this.args.forEach(p)}outputDefined(){return this.args.every(p=>p.outputDefined())}}const Ig=["Unknown","Point","LineString","Polygon"];class rT{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ig[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(p){return this._parseColorCache[p]||(this._parseColorCache[p]=wo.parse(p))}}class b_{constructor(p,y,E=[],I,R=new en,O=[]){this.registry=p,this.path=E,this.key=E.map(L=>`[${L}]`).join(""),this.scope=R,this.errors=O,this.expectedType=I,this._isConstant=y}parse(p,y,E,I,R={}){return(y?this.concat(y,E,I):this)._parse(p,R)}_parse(p,y){function E(L,V,q){return"assert"===q?new Pt(V,[L]):"coerce"===q?new Il(V,[L]):L}if(null!==p&&"string"!=typeof p&&"boolean"!=typeof p&&"number"!=typeof p||(p=["literal",p]),Array.isArray(p)){if(0===p.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var I=p[0];if("string"!=typeof I)return this.error(`Expression name must be a string, but found ${typeof I} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;if(R=this.registry[I]){let L=R.parse(p,this);if(!L)return null;if(this.expectedType){var R,O=L.type;if("string"!==(R=this.expectedType).kind&&"number"!==R.kind&&"boolean"!==R.kind&&"object"!==R.kind&&"array"!==R.kind||"value"!==O.kind)if("color"!==R.kind&&"formatted"!==R.kind&&"resolvedImage"!==R.kind||"value"!==O.kind&&"string"!==O.kind)if("padding"!==R.kind||"value"!==O.kind&&"number"!==O.kind&&"array"!==O.kind)if("variableAnchorOffsetCollection"!==R.kind||"value"!==O.kind&&"array"!==O.kind){if(this.checkSubtype(R,O))return null}else L=E(L,R,y.typeAnnotation||"coerce");else L=E(L,R,y.typeAnnotation||"coerce");else L=E(L,R,y.typeAnnotation||"coerce");else L=E(L,R,y.typeAnnotation||"assert")}if(!(L instanceof wd)&&"resolvedImage"!==L.type.kind&&this._isConstant(L)){O=new rT;try{L=new wd(L.type,L.evaluate(O))}catch(V){return this.error(V.message),null}}return L}return this.error(`Unknown expression "${I}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===p?"'undefined' value invalid. Use null instead.":"object"==typeof p?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof p} instead.`)}concat(p,y,E){return p="number"==typeof p?this.path.concat(p):this.path,E=E?this.scope.concat(E):this.scope,new b_(this.registry,this._isConstant,p,y||null,E,this.errors)}error(p,...y){y=""+this.key+y.map(E=>`[${E}]`).join(""),this.errors.push(new kt(y,p))}checkSubtype(p,y){return(p=Ue(p,y))&&this.error(p),p}}class fw{constructor(p,y,E){this.type=Li,this.locale=E,this.caseSensitive=p,this.diacriticSensitive=y}static parse(p,y){if(2!==p.length)return y.error("Expected one argument.");if("object"!=typeof(p=p[1])||Array.isArray(p))return y.error("Collator options argument must be an object.");var E=y.parse(void 0!==p["case-sensitive"]&&p["case-sensitive"],1,qt);if(!E)return null;var I=y.parse(void 0!==p["diacritic-sensitive"]&&p["diacritic-sensitive"],1,qt);if(!I)return null;let R=null;return p.locale&&!(R=y.parse(p.locale,1,Dt))?null:new fw(E,I,R)}evaluate(p){return new w_(this.caseSensitive.evaluate(p),this.diacriticSensitive.evaluate(p),this.locale?this.locale.evaluate(p):null)}eachChild(p){p(this.caseSensitive),p(this.diacriticSensitive),this.locale&&p(this.locale)}outputDefined(){return!1}}const qf=8192;function Gf(m,p){m[0]=Math.min(m[0],p[0]),m[1]=Math.min(m[1],p[1]),m[2]=Math.max(m[2],p[0]),m[3]=Math.max(m[3],p[1])}function Sg(m,p){return!(m[0]<=p[0]||m[2]>=p[2]||m[1]<=p[1]||m[3]>=p[3])}function VN(E,I){var y=(180+E[0])/360;return E=E[1],E=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+E*Math.PI/360)))/360,I=Math.pow(2,I.z),[Math.round(y*I*qf),Math.round(E*I*qf)]}function dD(m,p){let y=!1;for(let q=0,$=p.length;q<$;q++){var E=p[q];for(let Y=0,ae=E.length;Y<ae-1;Y++){if(V=L=void 0,L=(I=m)[0]-(R=E[Y])[0],R=I[1]-R[1],V=I[0]-(O=E[Y+1])[0],L*(I=I[1]-O[1])-V*R==0&&L*V<=0&&R*I<=0)return;(L=E[Y])[1]>(O=m)[1]!=(V=E[Y+1])[1]>O[1]&&O[0]<(V[0]-L[0])*(O[1]-L[1])/(V[1]-L[1])+L[0]&&(y=!y)}}var I,R,O,L,V;return y}function BN(I,O,q,V){var R=O[0]-q[0],L=(O=O[1]-q[1],V[0]-q[0]),$=(q=($=I[0]-q[0])*(V=V[1]-q[1])-L*(I=I[1]-q[1]),R*V-L*O);return 0<q&&$<0||q<0&&0<$}function fs(m,p,y){for(const q of y)for(let $=0;$<q.length-1;++$)if((V=[(O=q[$+1])[0]-(R=q[$])[0],O[1]-R[1]])[0]*(L=[(I=p)[0]-(E=m)[0],I[1]-E[1]])[1]-V[1]*L[0]!=0&&BN(E,I,R,O)&&BN(R,O,E,I))return 1;var E,I,R,O,L,V}function Go(m,p){for(let y=0;y<m.length;++y)if(!dD(m[y],p))return;for(let y=0;y<m.length-1;++y)if(fs(m[y],m[y+1],p))return;return 1}function E_(m,p,y){var E=[];for(let O=0;O<m.length;O++){var I=[];for(let L=0;L<m[O].length;L++){var R=VN(m[O][L],y);Gf(p,R),I.push(R)}E.push(I)}return E}function pD(m,p,y){var E=[];for(let R=0;R<m.length;R++){var I=E_(m[R],p,y);E.push(I)}return E}function iT(m,p,y,E){if(m[0]<y[0]||m[0]>y[2]){var I=.5*E;let R=m[0]-y[0]>I?-E:y[0]-m[0]>I?E:0;0===R&&(R=m[0]-y[2]>I?-E:y[2]-m[0]>I?E:0),m[0]+=R}Gf(p,m)}function Ed(m,p,y,E){var I=Math.pow(2,E.z)*qf,R=[E.x*qf,E.y*qf],O=[];for(const V of m)for(const q of V){var L=[q.x+R[0],q.y+R[1]];iT(L,p,y,I),O.push(L)}return O}function x_(m,p,y,E){var I=Math.pow(2,E.z)*qf,R=[E.x*qf,E.y*qf],O=[];for(const q of m){var L=[];for(const $ of q){var V=[$.x+R[0],$.y+R[1]];Gf(p,V),L.push(V)}O.push(L)}if(p[2]-p[0]<=I/2){(E=p)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const q of O)for(const $ of q)iT($,p,y,I)}return O}class Ag{constructor(p,y){this.type=qt,this.geojson=p,this.geometries=y}static parse(p,y){if(2!==p.length)return y.error(`'within' expression requires exactly one argument, but found ${p.length-1} instead.`);if(vd(p[1]))if("FeatureCollection"===(p=p[1]).type){var E=[];for(const L of p.features){var{type:I,coordinates:R}=L.geometry;"Polygon"===I&&E.push(R),"MultiPolygon"===I&&E.push(...R)}if(E.length)return new Ag(p,O={type:"MultiPolygon",coordinates:E})}else if("Feature"===p.type){var O=p.geometry.type;if("Polygon"===O||"MultiPolygon"===O)return new Ag(p,p.geometry)}else if("Polygon"===p.type||"MultiPolygon"===p.type)return new Ag(p,p);return y.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(p){if(null!=p.geometry()&&null!=p.canonicalID()){if("Point"===p.geometryType())return function fD(m,p){var y=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],I=m.canonicalID();if("Polygon"===p.type){var R=E_(p.coordinates,E,I),O=Ed(m.geometry(),y,E,I);if(!Sg(y,E))return!1;for(const V of O)if(!dD(V,R))return!1}if("MultiPolygon"===p.type){var L=pD(p.coordinates,E,I);if(O=Ed(m.geometry(),y,E,I),!Sg(y,E))return!1;for(const q of O)if(!function($,Y){for(let ae=0;ae<Y.length;ae++)if(dD($,Y[ae]))return 1}(q,L))return!1}return!0}(p,this.geometries);if("LineString"===p.geometryType())return function UN(m,p){var y=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],I=m.canonicalID();if("Polygon"===p.type){var R=E_(p.coordinates,E,I),O=x_(m.geometry(),y,E,I);if(!Sg(y,E))return!1;for(const V of O)if(!Go(V,R))return!1}if("MultiPolygon"===p.type){var L=pD(p.coordinates,E,I);if(O=x_(m.geometry(),y,E,I),!Sg(y,E))return!1;for(const q of O)if(!function($,Y){for(let ae=0;ae<Y.length;ae++)if(Go($,Y[ae]))return 1}(q,L))return!1}return!0}(p,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Cp{constructor(p,y){this.type=y.type,this.name=p,this.boundExpression=y}static parse(p,y){return 2!==p.length||"string"!=typeof p[1]?y.error("'var' expression requires exactly one string literal argument."):y.scope.has(p=p[1])?new Cp(p,y.scope.get(p)):y.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(p){return this.boundExpression.evaluate(p)}eachChild(){}outputDefined(){return!1}}class Rc{constructor(p,y,E,I){this.name=p,this.type=y,this._evaluate=E,this.args=I}evaluate(p){return this._evaluate(p,this.args)}eachChild(p){this.args.forEach(p)}outputDefined(){return!1}static parse(p,y){var E=p[0];if(!(L=Rc.definitions[E]))return y.error(`Unknown expression "${E}". If you wanted a literal array, use ["literal", [...]].`,0);var I,R,L,O=Array.isArray(L)?L[0]:L.type,V=(L=Array.isArray(L)?[[L[1],L[2]]]:L.overloads).filter(([_e])=>!Array.isArray(_e)||_e.length===p.length-1);let q=null;for([I,R]of V){q=new b_(y.registry,mw,y.path,null,y.scope);var $=[];let _e=!1;for(let ze=1;ze<p.length;ze++){var ae=p[ze],Y=Array.isArray(I)?I[ze-1]:I.type;if(!(ae=q.parse(ae,1+$.length,Y))){_e=!0;break}$.push(ae)}if(!_e)if(Array.isArray(I)&&I.length!==$.length)q.error(`Expected ${I.length} arguments, but found ${$.length} instead.`);else{for(let ze=0;ze<$.length;ze++){var pe=Array.isArray(I)?I[ze]:I.type,fe=$[ze];q.concat(ze+1).checkSubtype(pe,fe.type)}if(0===q.errors.length)return new Rc(E,O,R,$)}}if(1===V.length)y.errors.push(...q.errors);else{V=(V.length?V:L).map(([ze])=>function zN(m){return Array.isArray(m)?`(${m.map(le).join(", ")})`:`(${le(m.type)}...)`}(ze)).join(" | ");var ve=[];for(let ze=1;ze<p.length;ze++){var ke=y.parse(p[ze],1+ve.length);if(!ke)return null;ve.push(le(ke.type))}y.error(`Expected arguments of type ${V}, but found (${ve.join(", ")}) instead.`)}return null}static register(p,y){for(const E in Rc.definitions=y)p[E]=Rc}}function mw(m){if(m instanceof Cp)return mw(m.boundExpression);if(m instanceof Rc&&"error"===m.name||m instanceof fw||m instanceof Ag)return!1;const p=m instanceof Il||m instanceof Pt;let y=!0;return m.eachChild(E=>{y=p?y&&mw(E):y&&E instanceof wd}),!!y&&oT(m)&&gw(m,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function oT(m){if(m instanceof Rc&&("get"===m.name&&1===m.args.length||"feature-state"===m.name||"has"===m.name&&1===m.args.length||"properties"===m.name||"geometry-type"===m.name||"id"===m.name||/^filter-/.test(m.name))||m instanceof Ag)return!1;let p=!0;return m.eachChild(y=>{p&&!oT(y)&&(p=!1)}),p}function Dg(m){if(!(m instanceof Rc&&"feature-state"===m.name)){let p=!0;return m.eachChild(y=>{p&&!Dg(y)&&(p=!1)}),p}}function gw(m,p){if(m instanceof Rc&&0<=p.indexOf(m.name))return!1;let y=!0;return m.eachChild(E=>{y&&!gw(E,p)&&(y=!1)}),y}function T_(m,p){var y=m.length-1;let E=0,I=y;for(var R,O;E<=I;)if((O=m[R=Math.floor((E+I)/2)])<=p){if(R===y||p<m[R+1])return R;E=R+1}else{if(!(p<O))throw new fi("Input is not a number.");I=R-1}return 0}class Pg{constructor(p,y,E){for(var[I,R]of(this.type=p,this.input=y,this.labels=[],this.outputs=[],E))this.labels.push(I),this.outputs.push(R)}static parse(p,y){if(p.length-1<4)return y.error(`Expected at least 4 arguments, but found only ${p.length-1}.`);if((p.length-1)%2!=0)return y.error("Expected an even number of arguments.");var E=y.parse(p[1],1,ut);if(!E)return null;var I=[];let R=null;y.expectedType&&"value"!==y.expectedType.kind&&(R=y.expectedType);for(let $=1;$<p.length;$+=2){var O=1===$?-1/0:p[$],L=p[$+1],V=$,q=$+1;if("number"!=typeof O)return y.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(I.length&&I[I.length-1][0]>=O)return y.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',V);if(!(V=y.parse(L,q,R)))return null;R=R||V.type,I.push([O,V])}return new Pg(R,E,I)}evaluate(p){var y,E,I=this.labels,R=this.outputs;return(1===I.length||(y=this.input.evaluate(p))<=I[0]?R[0]:y>=I[(E=I.length)-1]?R[E-1]:R[T_(I,y)]).evaluate(p)}eachChild(p){p(this.input);for(const y of this.outputs)p(y)}outputDefined(){return this.outputs.every(p=>p.outputDefined())}}var kg=Qi;function Qi(m,p,y,E){this.cx=3*m,this.bx=3*(y-m)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*p,this.by=3*(E-p)-this.cy,this.ay=1-this.cy-this.by,this.p1x=m,this.p1y=p,this.p2x=y,this.p2y=E}Qi.prototype={sampleCurveX:function(m){return((this.ax*m+this.bx)*m+this.cx)*m},sampleCurveY:function(m){return((this.ay*m+this.by)*m+this.cy)*m},sampleCurveDerivativeX:function(m){return(3*this.ax*m+2*this.bx)*m+this.cx},solveCurveX:function(m,p){if(void 0===p&&(p=1e-6),m<0)return 0;if(1<m)return 1;for(var y=m,E=0;E<8;E++){var I=this.sampleCurveX(y)-m;if(Math.abs(I)<p)return y;var R=this.sampleCurveDerivativeX(y);if(Math.abs(R)<1e-6)break;y-=I/R}var O=0,L=1;for(y=m,E=0;E<20&&(I=this.sampleCurveX(y),!(Math.abs(I-m)<p));E++)I<m?O=y:L=y,y=.5*(L-O)+O;return y},solve:function(m,p){return this.sampleCurveY(this.solveCurveX(m,p))}};var mD=function C_(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}(kg);function Rg(m,p,y){return m+y*(p-m)}function I_(m,p,y){return m.map((E,I)=>Rg(E,p[I],y))}const al={number:Rg,color:function(m,p,y,E="rgb"){switch(E){case"rgb":var[I,R,$,O]=I_(m.rgb,p.rgb,y);return new wo(I,R,$,O,!1);case"hcl":{var[I,R,$,O]=m.hcl,[V,q,Y,L]=p.hcl;let ke,_e;if(isNaN(I)||isNaN(V))isNaN(I)?isNaN(V)?ke=NaN:(ke=V,1!==$&&0!==$||(_e=q)):(ke=I,1!==Y&&0!==Y||(_e=R));else{let pt=V-I;I<V&&180<pt?pt-=360:V<I&&180<I-V&&(pt+=360),ke=I+y*pt}[V,I,R,q]=[ke,_e??Rg(R,q,y),Rg($,Y,y),Rg(O,L,y)],V=isNaN(V)?0:V*ci;var[$,Y,O,L]=bi([R,Math.cos(V)*I,Math.sin(V)*I,q]);return new wo($,Y,O,L,!1)}case"lab":var[V,q,$,Y]=bi(I_(m.lab,p.lab,y));return new wo(V,q,$,Y,!1)}},array:I_,padding:function(m,p,y){return new sl(I_(m.values,p.values,y))},variableAnchorOffsetCollection:function(m,p,y){var E=m.values,I=p.values;if(E.length!==I.length)throw new fi(`Cannot interpolate values of different length. from: ${m.toString()}, to: `+p.toString());var R=[];for(let $=0;$<E.length;$+=2){if(E[$]!==I[$])throw new fi(`Cannot interpolate values containing mismatched anchors. from[${$}]: ${E[$]}, to[${$}]: `+I[$]);R.push(E[$]);var[O,L]=E[$+1],[V,q]=I[$+1];R.push([Rg(O,V,y),Rg(L,q,y)])}return new Ph(R)}};class Wu{constructor(p,y,E,I,R){for(var[O,L]of(this.type=p,this.operator=y,this.interpolation=E,this.input=I,this.labels=[],this.outputs=[],R))this.labels.push(O),this.outputs.push(L)}static interpolationFactor(p,y,E,I){let R=0;return"exponential"===p.name?R=gD(y,p.base,E,I):"linear"===p.name?R=gD(y,1,E,I):"cubic-bezier"===p.name&&(R=(p=new mD((p=p.controlPoints)[0],p[1],p[2],p[3])).solve(gD(y,1,E,I))),R}static parse(p,y){let[E,I,R,...O]=p;if(!Array.isArray(I)||0===I.length)return y.error("Expected an interpolation type expression.",1);if("linear"===I[0])I={name:"linear"};else if("exponential"===I[0]){var L=I[1];if("number"!=typeof L)return y.error("Exponential interpolation requires a numeric base.",1,1);I={name:"exponential",base:L}}else{if("cubic-bezier"!==I[0])return y.error("Unknown interpolation type "+String(I[0]),1,0);if(4!==(L=I.slice(1)).length||L.some(fe=>"number"!=typeof fe||fe<0||1<fe))return y.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);I={name:"cubic-bezier",controlPoints:L}}if(p.length-1<4)return y.error(`Expected at least 4 arguments, but found only ${p.length-1}.`);if((p.length-1)%2!=0)return y.error("Expected an even number of arguments.");if(!(R=y.parse(R,2,ut)))return null;var V=[];let q=null;"interpolate-hcl"===E||"interpolate-lab"===E?q=Tr:y.expectedType&&"value"!==y.expectedType.kind&&(q=y.expectedType);for(let fe=0;fe<O.length;fe+=2){var $=O[fe],Y=O[fe+1],ae=fe+3,pe=fe+4;if("number"!=typeof $)return y.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ae);if(V.length&&V[V.length-1][0]>=$)return y.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ae);if(!(ae=y.parse(Y,pe,q)))return null;q=q||ae.type,V.push([$,ae])}return Ve(q,ut)||Ve(q,Tr)||Ve(q,vi)||Ve(q,J)||Ve(q,se(ut))?new Wu(q,E,I,R,V):y.error(`Type ${le(q)} is not interpolatable.`)}evaluate(p){var y=this.outputs;if(1===(O=this.labels).length)return y[0].evaluate(p);var E=this.input.evaluate(p);if(E<=O[0])return y[0].evaluate(p);if(E>=O[(I=O.length)-1])return y[I-1].evaluate(p);var O,I=T_(O,E),L=Wu.interpolationFactor(this.interpolation,E,O[I],O=O[I+1]),V=y[I].evaluate(p),q=y[I+1].evaluate(p);switch(this.operator){case"interpolate":return al[this.type.kind](V,q,L);case"interpolate-hcl":return al.color(V,q,L,"hcl");case"interpolate-lab":return al.color(V,q,L,"lab")}}eachChild(p){p(this.input);for(const y of this.outputs)p(y)}outputDefined(){return this.outputs.every(p=>p.outputDefined())}}function gD(m,p,y,E){return m-=y,0==(E-=y)?0:1===p?m/E:(Math.pow(p,m)-1)/(Math.pow(p,E)-1)}class Mg{constructor(p,y){this.type=p,this.args=y}static parse(p,y){if(p.length<2)return y.error("Expectected at least one argument.");let E=null;const I=y.expectedType;I&&"value"!==I.kind&&(E=I);var R=[];for(const L of p.slice(1)){var O=y.parse(L,1+R.length,E,void 0,{typeAnnotation:"omit"});if(!O)return null;E=E||O.type,R.push(O)}if(E)return I&&R.some(L=>Ue(I,L.type))?new Mg(In,R):new Mg(E,R);throw new Error("No output type")}evaluate(p){let I,y=null,E=0;for(const R of this.args)if(E++,null!==(y=(y=R.evaluate(p))&&y instanceof lc&&!y.available&&(I=I||y.name,y=null,E===this.args.length)?I:y))break;return y}eachChild(p){this.args.forEach(p)}outputDefined(){return this.args.every(p=>p.outputDefined())}}class S_{constructor(p,y){this.type=y.type,this.bindings=[].concat(p),this.result=y}evaluate(p){return this.result.evaluate(p)}eachChild(p){for(const y of this.bindings)p(y[1]);p(this.result)}static parse(p,y){if(p.length<4)return y.error(`Expected at least 3 arguments, but found ${p.length-1} instead.`);var E=[];for(let L=1;L<p.length-1;L+=2){var I=p[L];if("string"!=typeof I)return y.error(`Expected string, but found ${typeof I} instead.`,L);if(/[^a-zA-Z0-9_]/.test(I))return y.error("Variable names must contain only alphanumeric characters or '_'.",L);var R=y.parse(p[L+1],L+1);if(!R)return null;E.push([I,R])}var O=y.parse(p[p.length-1],p.length-1,y.expectedType,E);return O?new S_(E,O):null}outputDefined(){return this.result.outputDefined()}}function yw(m,p){return"=="===m||"!="===m?"boolean"===p.kind||"string"===p.kind||"number"===p.kind||"null"===p.kind||"value"===p.kind:"string"===p.kind||"number"===p.kind||"value"===p.kind}function jN(m,p,y,E){return 0===E.compare(p,y)}function Mc(m,p,y){const E="=="!==m&&"!="!==m;return class xpe{constructor(R,O,L){this.type=qt,this.lhs=R,this.rhs=O,this.collator=L,this.hasUntypedArgument="value"===R.type.kind||"value"===O.type.kind}static parse(R,O){if(3!==R.length&&4!==R.length)return O.error("Expected two or three arguments.");var L=R[0];let V=O.parse(R[1],1,In);if(!V)return null;if(!yw(L,V.type))return O.concat(1).error(`"${L}" comparisons are not supported for type '${le(V.type)}'.`);let q=O.parse(R[2],2,In);if(!q)return null;if(!yw(L,q.type))return O.concat(2).error(`"${L}" comparisons are not supported for type '${le(q.type)}'.`);if(V.type.kind!==q.type.kind&&"value"!==V.type.kind&&"value"!==q.type.kind)return O.error(`Cannot compare types '${le(V.type)}' and '${le(q.type)}'.`);E&&("value"===V.type.kind&&"value"!==q.type.kind?V=new Pt(q.type,[V]):"value"!==V.type.kind&&"value"===q.type.kind&&(q=new Pt(V.type,[q])));let $=null;if(4===R.length){if("string"!==V.type.kind&&"string"!==q.type.kind&&"value"!==V.type.kind&&"value"!==q.type.kind)return O.error("Cannot use collator to compare non-string types.");if(!($=O.parse(R[3],3,Li)))return null}return new xpe(V,q,$)}evaluate(R){var O=this.lhs.evaluate(R),L=this.rhs.evaluate(R);if(E&&this.hasUntypedArgument){var V=Zi(O),q=Zi(L);if(V.kind!==q.kind||"string"!==V.kind&&"number"!==V.kind)throw new fi(`Expected arguments for "${m}" to be (string, string) or (number, number), but found (${V.kind}, ${q.kind}) instead.`)}return this.collator&&!E&&this.hasUntypedArgument&&(V=Zi(O),q=Zi(L),"string"!==V.kind||"string"!==q.kind)?p(R,O,L):this.collator?y(R,O,L,this.collator.evaluate(R)):p(R,O,L)}eachChild(R){R(this.lhs),R(this.rhs),this.collator&&R(this.collator)}outputDefined(){return!0}}}kg=Mc("==",function(m,p,y){return p===y},jN);var ra=Mc("!=",function(m,p,y){return p!==y},function(m,p,y,E){return!jN(0,p,y,E)}),Oh=Mc("<",function(m,p,y){return p<y},function(m,p,y,E){return E.compare(p,y)<0}),_w=Mc(">",function(m,p,y){return y<p},function(m,p,y,E){return 0<E.compare(p,y)}),Ip=Mc("<=",function(m,p,y){return p<=y},function(m,p,y,E){return E.compare(p,y)<=0}),po=Mc(">=",function(m,p,y){return y<=p},function(m,p,y,E){return 0<=E.compare(p,y)});class vw{constructor(p){this.type=os,this.sections=p}static parse(p,y){if(p.length<2)return y.error("Expected at least one argument.");var E=p[1];if(!Array.isArray(E)&&"object"==typeof E)return y.error("First argument must be an image or text section.");var I=[];let R=!1;for(let V=1;V<=p.length-1;++V){var O=p[V];if(R&&"object"==typeof O&&!Array.isArray(O)){R=!1;let q=null;if(O["font-scale"]&&!(q=y.parse(O["font-scale"],1,ut)))return null;let $=null;if(O["text-font"]&&!($=y.parse(O["text-font"],1,se(Dt))))return null;let Y=null;if(O["text-color"]&&!(Y=y.parse(O["text-color"],1,Tr)))return null;(O=I[I.length-1]).scale=q,O.font=$,O.textColor=Y}else{if(!(O=y.parse(p[V],1,In)))return null;var L=O.type.kind;if("string"!==L&&"value"!==L&&"null"!==L&&"resolvedImage"!==L)return y.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");R=!0,I.push({content:O,scale:null,font:null,textColor:null})}}return new vw(I)}evaluate(p){return new Ku(this.sections.map(y=>{var E=y.content.evaluate(p);return Zi(E)===me?new nT("",E,null,null,null):new nT(Ia(E),null,y.scale?y.scale.evaluate(p):null,y.font?y.font.evaluate(p).join(","):null,y.textColor?y.textColor.evaluate(p):null)}))}eachChild(p){for(const y of this.sections)p(y.content),y.scale&&p(y.scale),y.font&&p(y.font),y.textColor&&p(y.textColor)}outputDefined(){return!1}}const xd={"==":kg,"!=":ra,">":_w,"<":Oh,">=":po,"<=":Ip,array:Pt,at:class Tpe{constructor(p,y,E){this.type=p,this.index=y,this.input=E}static parse(p,y){var E;return 3!==p.length?y.error(`Expected 2 arguments, but found ${p.length-1} instead.`):(E=y.parse(p[1],1,ut),p=y.parse(p[2],2,se(y.expectedType||In)),E&&p?new Tpe((y=p.type).itemType,E,p):null)}evaluate(E){var y=this.index.evaluate(E);if(E=this.input.evaluate(E),y<0)throw new fi(`Array index out of bounds: ${y} < 0.`);if(y>=E.length)throw new fi(`Array index out of bounds: ${y} > ${E.length-1}.`);if(y!==Math.floor(y))throw new fi(`Array index must be an integer, but found ${y} instead.`);return E[y]}eachChild(p){p(this.index),p(this.input)}outputDefined(){return!1}},boolean:Pt,case:class Cpe{constructor(p,y,E){this.type=p,this.branches=y,this.otherwise=E}static parse(p,y){if(p.length<4)return y.error(`Expected at least 3 arguments, but found only ${p.length-1}.`);if(p.length%2!=0)return y.error("Expected an odd number of arguments.");let E;y.expectedType&&"value"!==y.expectedType.kind&&(E=y.expectedType);var I=[];for(let V=1;V<p.length-1;V+=2){var R=y.parse(p[V],V,qt);if(!R)return null;var O=y.parse(p[V+1],V+1,E);if(!O)return null;I.push([R,O]),E=E||O.type}var L=y.parse(p[p.length-1],p.length-1,E);if(!L)return null;if(E)return new Cpe(E,I,L);throw new Error("Can't infer output type")}evaluate(p){for(var[y,E]of this.branches)if(y.evaluate(p))return E.evaluate(p);return this.otherwise.evaluate(p)}eachChild(p){for(var[y,E]of this.branches)p(y),p(E);p(this.otherwise)}outputDefined(){return this.branches.every(([,p])=>p.outputDefined())&&this.otherwise.outputDefined()}},coalesce:Mg,collator:fw,format:vw,image:class Ipe{constructor(p){this.type=me,this.input=p}static parse(p,y){return 2!==p.length?y.error("Expected two arguments."):(p=y.parse(p[1],1,Dt))?new Ipe(p):y.error("No image name provided.")}evaluate(p){var y=this.input.evaluate(p),E=lc.fromString(y);return E&&p.availableImages&&(E.available=-1<p.availableImages.indexOf(y)),E}eachChild(p){p(this.input)}outputDefined(){return!1}},in:class Spe{constructor(p,y){this.type=qt,this.needle=p,this.haystack=y}static parse(p,y){var E;return 3!==p.length?y.error(`Expected 2 arguments, but found ${p.length-1} instead.`):(E=y.parse(p[1],1,In),p=y.parse(p[2],2,In),E&&p?Xe(E.type,[qt,Dt,ut,Yn,In])?new Spe(E,p):y.error(`Expected first argument to be of type boolean, string, number or null, but found ${le(E.type)} instead`):null)}evaluate(p){var y=this.needle.evaluate(p);if(!(p=this.haystack.evaluate(p)))return!1;if(!He(y,["boolean","string","number","null"]))throw new fi(`Expected first argument to be of type boolean, string, number or null, but found ${le(Zi(y))} instead.`);if(He(p,["string","array"]))return 0<=p.indexOf(y);throw new fi(`Expected second argument to be of type array or string, but found ${le(Zi(p))} instead.`)}eachChild(p){p(this.needle),p(this.haystack)}outputDefined(){return!0}},"index-of":class koe{constructor(p,y,E){this.type=ut,this.needle=p,this.haystack=y,this.fromIndex=E}static parse(p,y){var E,I;return p.length<=2||5<=p.length?y.error(`Expected 3 or 4 arguments, but found ${p.length-1} instead.`):(E=y.parse(p[1],1,In),I=y.parse(p[2],2,In),E&&I?Xe(E.type,[qt,Dt,ut,Yn,In])?4===p.length?(p=y.parse(p[3],3,ut))?new koe(E,I,p):null:new koe(E,I):y.error(`Expected first argument to be of type boolean, string, number or null, but found ${le(E.type)} instead`):null)}evaluate(p){var y=this.needle.evaluate(p),E=this.haystack.evaluate(p);if(!He(y,["boolean","string","number","null"]))throw new fi(`Expected first argument to be of type boolean, string, number or null, but found ${le(Zi(y))} instead.`);if(He(E,["string","array"]))return this.fromIndex?(p=this.fromIndex.evaluate(p),E.indexOf(y,p)):E.indexOf(y);throw new fi(`Expected second argument to be of type array or string, but found ${le(Zi(E))} instead.`)}eachChild(p){p(this.needle),p(this.haystack),this.fromIndex&&p(this.fromIndex)}outputDefined(){return!1}},interpolate:Wu,"interpolate-hcl":Wu,"interpolate-lab":Wu,length:class Ape{constructor(p){this.type=ut,this.input=p}static parse(p,y){return 2!==p.length?y.error(`Expected 1 argument, but found ${p.length-1} instead.`):(p=y.parse(p[1],1))?"array"!==p.type.kind&&"string"!==p.type.kind&&"value"!==p.type.kind?y.error(`Expected argument of type string or array, but found ${le(p.type)} instead.`):new Ape(p):null}evaluate(p){if("string"==typeof(p=this.input.evaluate(p))||Array.isArray(p))return p.length;throw new fi(`Expected value to be of type string or array, but found ${le(Zi(p))} instead.`)}eachChild(p){p(this.input)}outputDefined(){return!1}},let:S_,literal:wd,match:class Dpe{constructor(p,y,E,I,R,O){this.inputType=p,this.type=y,this.input=E,this.cases=I,this.outputs=R,this.otherwise=O}static parse(p,y){if(p.length<5)return y.error(`Expected at least 4 arguments, but found only ${p.length-1}.`);if(p.length%2!=1)return y.error("Expected an even number of arguments.");let E,I;y.expectedType&&"value"!==y.expectedType.kind&&(I=y.expectedType);var R={},O=[];for(let Y=2;Y<p.length-1;Y+=2){let ae=p[Y];var L=p[Y+1],V=(Array.isArray(ae)||(ae=[ae]),y.concat(Y));if(0===ae.length)return V.error("Expected at least one branch label.");for(const pe of ae){if("number"!=typeof pe&&"string"!=typeof pe)return V.error("Branch labels must be numbers or strings.");if("number"==typeof pe&&Math.abs(pe)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof pe&&Math.floor(pe)!==pe)return V.error("Numeric branch labels must be integer values.");if(E){if(V.checkSubtype(E,Zi(pe)))return null}else E=Zi(pe);if(void 0!==R[String(pe)])return V.error("Branch labels must be unique.");R[String(pe)]=O.length}if(!(L=y.parse(L,Y,I)))return null;I=I||L.type,O.push(L)}var q,$=y.parse(p[1],1,In);return!$||!(q=y.parse(p[p.length-1],p.length-1,I))||"value"!==$.type.kind&&y.concat(1).checkSubtype(E,$.type)?null:new Dpe(E,I,$,R,O,q)}evaluate(p){var y=this.input.evaluate(p);return(Zi(y)===this.inputType&&this.outputs[this.cases[y]]||this.otherwise).evaluate(p)}eachChild(p){p(this.input),this.outputs.forEach(p),p(this.otherwise)}outputDefined(){return this.outputs.every(p=>p.outputDefined())&&this.otherwise.outputDefined()}},number:Pt,"number-format":class Ppe{constructor(p,y,E,I,R){this.type=Dt,this.number=p,this.locale=y,this.currency=E,this.minFractionDigits=I,this.maxFractionDigits=R}static parse(p,y){if(3!==p.length)return y.error("Expected two arguments.");var E=y.parse(p[1],1,ut);if(!E)return null;if("object"!=typeof(p=p[2])||Array.isArray(p))return y.error("NumberFormat options argument must be an object.");let I=null;if(p.locale&&!(I=y.parse(p.locale,1,Dt)))return null;let R=null;if(p.currency&&!(R=y.parse(p.currency,1,Dt)))return null;let O=null;if(p["min-fraction-digits"]&&!(O=y.parse(p["min-fraction-digits"],1,ut)))return null;let L=null;return p["max-fraction-digits"]&&!(L=y.parse(p["max-fraction-digits"],1,ut))?null:new Ppe(E,I,R,O,L)}evaluate(p){return new Intl.NumberFormat(this.locale?this.locale.evaluate(p):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(p):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(p):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(p):void 0}).format(this.number.evaluate(p))}eachChild(p){p(this.number),this.locale&&p(this.locale),this.currency&&p(this.currency),this.minFractionDigits&&p(this.minFractionDigits),this.maxFractionDigits&&p(this.maxFractionDigits)}outputDefined(){return!1}},object:Pt,slice:class Ooe{constructor(p,y,E,I){this.type=p,this.input=y,this.beginIndex=E,this.endIndex=I}static parse(p,y){var E,I;return p.length<=2||5<=p.length?y.error(`Expected 3 or 4 arguments, but found ${p.length-1} instead.`):(E=y.parse(p[1],1,In),I=y.parse(p[2],2,ut),E&&I?Xe(E.type,[se(In),Dt,In])?4===p.length?(p=y.parse(p[3],3,ut))?new Ooe(E.type,E,I,p):null:new Ooe(E.type,E,I):y.error(`Expected first argument to be of type array or string, but found ${le(E.type)} instead`):null)}evaluate(p){var y=this.input.evaluate(p),E=this.beginIndex.evaluate(p);if(He(y,["string","array"]))return this.endIndex?(p=this.endIndex.evaluate(p),y.slice(E,p)):y.slice(E);throw new fi(`Expected first argument to be of type array or string, but found ${le(Zi(y))} instead.`)}eachChild(p){p(this.input),p(this.beginIndex),this.endIndex&&p(this.endIndex)}outputDefined(){return!1}},step:Pg,string:Pt,"to-boolean":Il,"to-color":Il,"to-number":Il,"to-string":Il,var:Cp,within:Ag};function sT(m,[p,y,E,I]){if(m=hD(p=p.evaluate(m),y=y.evaluate(m),E=E.evaluate(m),I=I?I.evaluate(m):1))throw new fi(m);return new wo(p/255,y/255,E/255,I,!1)}function yD(m,p){return void 0===(p=p[m])?null:p}function Sp(m){return{type:m}}function _D(m){return{result:"success",value:m}}function A_(m){return{result:"error",value:m}}function D_(m){return"data-driven"===m["property-type"]||"cross-faded-data-driven"===m["property-type"]}function aT(m){return m.expression&&-1<m.expression.parameters.indexOf("zoom")}function vD(m){return m.expression&&m.expression.interpolated}function Fi(m){return m instanceof Number?"number":m instanceof String?"string":m instanceof Boolean?"boolean":Array.isArray(m)?"array":null===m?"null":typeof m}function Kf(m){return"object"==typeof m&&null!==m&&!Array.isArray(m)}function Wf(m){return m}function Yf(m,p){var y="color"===p.type,E=m.stops&&"object"==typeof m.stops[0][0],I=E||void 0!==m.property,R=(I=E||!I,m.type||(vD(p)?"exponential":"interval"));if(y||"padding"===p.type){const pe=(y?wo:sl).parse;(m=Ft({},m)).stops&&(m.stops=m.stops.map(fe=>[fe[0],pe(fe[1])])),m.default=pe(m.default?m.default:p.default)}if(m.colorSpace&&"rgb"!==(y=m.colorSpace)&&"hcl"!==y&&"lab"!==y)throw new Error(`Unknown color space: "${m.colorSpace}"`);let O,L,V;if("exponential"===R)O=ww;else if("interval"===R)O=K7;else if("categorical"===R){O=Ap,L=Object.create(null);for(const pe of m.stops)L[pe[0]]=pe[1];V=typeof m.stops[0][0]}else{if("identity"!==R)throw new Error(`Unknown function type "${R}"`);O=lT}if(E){var q={},$=[];for(let fe=0;fe<m.stops.length;fe++){var Y=m.stops[fe],ae=Y[0].zoom;void 0===q[ae]&&(q[ae]={zoom:ae,type:m.type,property:m.property,default:m.default,stops:[]},$.push(ae)),q[ae].stops.push([Y[0].value,Y[1]])}const pe=[];for(const fe of $)pe.push([q[fe].zoom,Yf(q[fe],p)]);return{kind:"composite",interpolationType:y={name:"linear"},interpolationFactor:Wu.interpolationFactor.bind(void 0,y),zoomStops:pe.map(fe=>fe[0]),evaluate:({zoom:fe},ve)=>ww({stops:pe,base:m.base},p,fe).evaluate(fe,ve)}}return I?{kind:"camera",interpolationType:E="exponential"===R?{name:"exponential",base:void 0!==m.base?m.base:1}:null,interpolationFactor:Wu.interpolationFactor.bind(void 0,E),zoomStops:m.stops.map(pe=>pe[0]),evaluate:({zoom:pe})=>O(m,p,pe,L,V)}:{kind:"source",evaluate:(pe,fe)=>void 0===(fe=fe&&fe.properties?fe.properties[m.property]:void 0)?P_(m.default,p.default):O(m,p,fe,L,V)}}function P_(m,p,y){return void 0!==m?m:void 0!==p?p:void 0!==y?y:void 0}function Ap(m,p,y,E,I){return P_(typeof y===I?E[y]:void 0,m.default,p.default)}function K7(m,p,y){return"number"!==Fi(y)?P_(m.default,p.default):(1===(p=m.stops.length)||y<=m.stops[0][0]?m.stops[0]:y>=m.stops[p-1][0]?m.stops[p-1]:(p=T_(m.stops.map(E=>E[0]),y),m.stops[p]))[1]}function ww(m,p,y){var E=void 0!==m.base?m.base:1;if("number"!==Fi(y))return P_(m.default,p.default);var I=m.stops.length;if(1===I||y<=m.stops[0][0])return m.stops[0][1];if(y>=m.stops[I-1][0])return m.stops[I-1][1];I=T_(m.stops.map(q=>q[0]),y);const R=(q=y,$=E,ae=m.stops[I+1][0],q-=Y=m.stops[I][0],0==(ae-=Y)?0:1===$?q/ae:(Math.pow($,q)-1)/(Math.pow($,ae)-1)),O=m.stops[I][1],L=m.stops[I+1][1],V=al[p.type]||Wf;var q,$,Y,ae;return"function"==typeof O.evaluate?{evaluate(...Y){var $=O.evaluate.apply(void 0,Y);if(Y=L.evaluate.apply(void 0,Y),void 0!==$&&void 0!==Y)return V($,Y,R,m.colorSpace)}}:V(O,L,R,m.colorSpace)}function lT(m,p,y){switch(p.type){case"color":y=wo.parse(y);break;case"formatted":y=Ku.fromString(y.toString());break;case"resolvedImage":y=lc.fromString(y.toString());break;case"padding":y=sl.parse(y);break;default:Fi(y)===p.type||"enum"===p.type&&p.values[y]||(y=void 0)}return P_(y,m.default,p.default)}Rc.register(xd,{error:[{kind:"error"},[Dt],(m,[p])=>{throw new fi(p.evaluate(m))}],typeof:[Dt,[In],(m,[p])=>le(Zi(p.evaluate(m)))],"to-rgba":[se(ut,4),[Tr],(E,[y])=>{var[y,E,I,R]=y.evaluate(E).rgb;return[255*y,255*E,255*I,R]}],rgb:[Tr,[ut,ut,ut],sT],rgba:[Tr,[ut,ut,ut,ut],sT],has:{type:qt,overloads:[[[Dt],(m,[p])=>p.evaluate(m)in m.properties()],[[Dt,_i],(m,[p,y])=>p.evaluate(m)in y.evaluate(m)]]},get:{type:In,overloads:[[[Dt],(m,[p])=>yD(p.evaluate(m),m.properties())],[[Dt,_i],(m,[p,y])=>yD(p.evaluate(m),y.evaluate(m))]]},"feature-state":[In,[Dt],(m,[p])=>yD(p.evaluate(m),m.featureState||{})],properties:[_i,[],m=>m.properties()],"geometry-type":[Dt,[],m=>m.geometryType()],id:[In,[],m=>m.id()],zoom:[ut,[],m=>m.globals.zoom],"heatmap-density":[ut,[],m=>m.globals.heatmapDensity||0],"line-progress":[ut,[],m=>m.globals.lineProgress||0],accumulated:[In,[],m=>void 0===m.globals.accumulated?null:m.globals.accumulated],"+":[ut,Sp(ut),(m,p)=>{let y=0;for(const E of p)y+=E.evaluate(m);return y}],"*":[ut,Sp(ut),(m,p)=>{let y=1;for(const E of p)y*=E.evaluate(m);return y}],"-":{type:ut,overloads:[[[ut,ut],(m,[p,y])=>p.evaluate(m)-y.evaluate(m)],[[ut],(m,[p])=>-p.evaluate(m)]]},"/":[ut,[ut,ut],(m,[p,y])=>p.evaluate(m)/y.evaluate(m)],"%":[ut,[ut,ut],(m,[p,y])=>p.evaluate(m)%y.evaluate(m)],ln2:[ut,[],()=>Math.LN2],pi:[ut,[],()=>Math.PI],e:[ut,[],()=>Math.E],"^":[ut,[ut,ut],(m,[p,y])=>Math.pow(p.evaluate(m),y.evaluate(m))],sqrt:[ut,[ut],(m,[p])=>Math.sqrt(p.evaluate(m))],log10:[ut,[ut],(m,[p])=>Math.log(p.evaluate(m))/Math.LN10],ln:[ut,[ut],(m,[p])=>Math.log(p.evaluate(m))],log2:[ut,[ut],(m,[p])=>Math.log(p.evaluate(m))/Math.LN2],sin:[ut,[ut],(m,[p])=>Math.sin(p.evaluate(m))],cos:[ut,[ut],(m,[p])=>Math.cos(p.evaluate(m))],tan:[ut,[ut],(m,[p])=>Math.tan(p.evaluate(m))],asin:[ut,[ut],(m,[p])=>Math.asin(p.evaluate(m))],acos:[ut,[ut],(m,[p])=>Math.acos(p.evaluate(m))],atan:[ut,[ut],(m,[p])=>Math.atan(p.evaluate(m))],min:[ut,Sp(ut),(m,p)=>Math.min(...p.map(y=>y.evaluate(m)))],max:[ut,Sp(ut),(m,p)=>Math.max(...p.map(y=>y.evaluate(m)))],abs:[ut,[ut],(m,[p])=>Math.abs(p.evaluate(m))],round:[ut,[ut],(m,[p])=>(p=p.evaluate(m))<0?-Math.round(-p):Math.round(p)],floor:[ut,[ut],(m,[p])=>Math.floor(p.evaluate(m))],ceil:[ut,[ut],(m,[p])=>Math.ceil(p.evaluate(m))],"filter-==":[qt,[Dt,In],(m,[p,y])=>m.properties()[p.value]===y.value],"filter-id-==":[qt,[In],(m,[p])=>m.id()===p.value],"filter-type-==":[qt,[Dt],(m,[p])=>m.geometryType()===p.value],"filter-<":[qt,[Dt,In],(m,[p,y])=>typeof(m=m.properties()[p.value])==typeof(p=y.value)&&m<p],"filter-id-<":[qt,[In],(m,[p])=>typeof(m=m.id())==typeof(p=p.value)&&m<p],"filter->":[qt,[Dt,In],(m,[p,y])=>typeof(m=m.properties()[p.value])==typeof(p=y.value)&&p<m],"filter-id->":[qt,[In],(m,[p])=>typeof(m=m.id())==typeof(p=p.value)&&p<m],"filter-<=":[qt,[Dt,In],(m,[p,y])=>typeof(m=m.properties()[p.value])==typeof(p=y.value)&&m<=p],"filter-id-<=":[qt,[In],(m,[p])=>typeof(m=m.id())==typeof(p=p.value)&&m<=p],"filter->=":[qt,[Dt,In],(m,[p,y])=>typeof(m=m.properties()[p.value])==typeof(p=y.value)&&p<=m],"filter-id->=":[qt,[In],(m,[p])=>typeof(m=m.id())==typeof(p=p.value)&&p<=m],"filter-has":[qt,[In],(m,[p])=>p.value in m.properties()],"filter-has-id":[qt,[],m=>null!==m.id()&&void 0!==m.id()],"filter-type-in":[qt,[se(Dt)],(m,[p])=>0<=p.value.indexOf(m.geometryType())],"filter-id-in":[qt,[se(In)],(m,[p])=>0<=p.value.indexOf(m.id())],"filter-in-small":[qt,[Dt,se(In)],(m,[p,y])=>0<=y.value.indexOf(m.properties()[p.value])],"filter-in-large":[qt,[Dt,se(In)],(m,[p,y])=>{for(var E=m.properties()[p.value],I=y.value,R=0,O=y.value.length-1;R<=O;){var L=R+O>>1;if(I[L]===E)return!0;I[L]>E?O=L-1:R=1+L}return!1}],all:{type:qt,overloads:[[[qt,qt],(m,[p,y])=>p.evaluate(m)&&y.evaluate(m)],[Sp(qt),(m,p)=>{for(const y of p)if(!y.evaluate(m))return!1;return!0}]]},any:{type:qt,overloads:[[[qt,qt],(m,[p,y])=>p.evaluate(m)||y.evaluate(m)],[Sp(qt),(m,p)=>{for(const y of p)if(y.evaluate(m))return!0;return!1}]]},"!":[qt,[qt],(m,[p])=>!p.evaluate(m)],"is-supported-script":[qt,[Dt],(m,[p])=>{var y=m.globals&&m.globals.isSupportedScript;return!y||y(p.evaluate(m))}],upcase:[Dt,[Dt],(m,[p])=>p.evaluate(m).toUpperCase()],downcase:[Dt,[Dt],(m,[p])=>p.evaluate(m).toLowerCase()],concat:[Dt,Sp(In),(m,p)=>p.map(y=>Ia(y.evaluate(m))).join("")],"resolved-locale":[Dt,[Li],(m,[p])=>p.evaluate(m).resolvedLocale()]});class Zf{constructor(p,y){this.expression=p,this._warningHistory={},this._evaluator=new rT,this._defaultValue=y?function Cw(m){return"color"===m.type&&Kf(m.default)?new wo(0,0,0,0):"color"===m.type?wo.parse(m.default)||null:"padding"===m.type?sl.parse(m.default)||null:"variableAnchorOffsetCollection"===m.type?Ph.parse(m.default)||null:void 0===m.default?null:m.default}(y):null,this._enumValues=y&&"enum"===y.type?y.values:null}evaluateWithoutErrorHandling(p,y,E,I,R,O){return this._evaluator.globals=p,this._evaluator.feature=y,this._evaluator.featureState=E,this._evaluator.canonical=I,this._evaluator.availableImages=R||null,this._evaluator.formattedSection=O,this.expression.evaluate(this._evaluator)}evaluate(p,y,E,I,R,O){this._evaluator.globals=p,this._evaluator.feature=y||null,this._evaluator.featureState=E||null,this._evaluator.canonical=I,this._evaluator.availableImages=R||null,this._evaluator.formattedSection=O||null;try{var L=this.expression.evaluate(this._evaluator);if(null==L||"number"==typeof L&&L!=L)return this._defaultValue;if(!this._enumValues||L in this._enumValues)return L;throw new fi(`Expected value to be one of ${Object.keys(this._enumValues).map(V=>JSON.stringify(V)).join(", ")}, but found ${JSON.stringify(L)} instead.`)}catch(V){return this._warningHistory[V.message]||(this._warningHistory[V.message]=!0,typeof console<"u"&&console.warn(V.message)),this._defaultValue}}}function bw(m){return Array.isArray(m)&&0<m.length&&"string"==typeof m[0]&&m[0]in xd}function Ew(m,p){var y=new b_(xd,mw,[],p?(y={color:Tr,string:Dt,number:ut,enum:Dt,boolean:qt,formatted:os,padding:vi,resolvedImage:me,variableAnchorOffsetCollection:J},"array"!==(E=p).type?y[E.type]:se(y[E.value]||In,E.length)):void 0),E=y.parse(m,void 0,void 0,void 0,p&&"string"===p.type?{typeAnnotation:"coerce"}:void 0);return E?_D(new Zf(E,p)):A_(y.errors)}class ss{constructor(p,y){this.kind=p,this._styleExpression=y,this.isStateDependent="constant"!==p&&!Dg(y.expression)}evaluateWithoutErrorHandling(p,y,E,I,R,O){return this._styleExpression.evaluateWithoutErrorHandling(p,y,E,I,R,O)}evaluate(p,y,E,I,R,O){return this._styleExpression.evaluate(p,y,E,I,R,O)}}class xw{constructor(p,y,E,I){this.kind=p,this.zoomStops=E,this._styleExpression=y,this.isStateDependent="camera"!==p&&!Dg(y.expression),this.interpolationType=I}evaluateWithoutErrorHandling(p,y,E,I,R,O){return this._styleExpression.evaluateWithoutErrorHandling(p,y,E,I,R,O)}evaluate(p,y,E,I,R,O){return this._styleExpression.evaluate(p,y,E,I,R,O)}interpolationFactor(p,y,E){return this.interpolationType?Wu.interpolationFactor(this.interpolationType,p,y,E):0}}function as(R,p){var y,E,I;return"error"===(R=Ew(R,p)).result?R:(y=oT(E=R.value.expression))||D_(p)?(I=gw(E,["zoom"]))||aT(p)?(E=function O(L){let V=null;if(L instanceof S_)V=O(L.result);else if(L instanceof Mg){for(const q of L.args)if(V=O(q))break}else(L instanceof Pg||L instanceof Wu)&&L.input instanceof Rc&&"zoom"===L.input.name&&(V=L);return V instanceof kt||L.eachChild(q=>{const $=O(q);$ instanceof kt?V=$:!V&&$?V=new kt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):V&&$&&V!==$&&(V=new kt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),V}(E))||I?E instanceof kt?A_([E]):E instanceof Wu&&!vD(p)?A_([new kt("",'"interpolate" expressions cannot be used with this property')]):_D(E?new xw(y?"camera":"composite",R.value,E.labels,I=E instanceof Wu?E.interpolation:void 0):new ss(y?"constant":"source",R.value)):A_([new kt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]):A_([new kt("","zoom expressions not supported")]):A_([new kt("","data expressions not supported")])}class Do{constructor(p,y){this._parameters=p,this._specification=y,Ft(this,Yf(this._parameters,this._specification))}static deserialize(p){return new Do(p._parameters,p._specification)}static serialize(p){return{_parameters:p._parameters,_specification:p._specification}}}function HN(m){if(!0===m||!1===m)return 1;if(Array.isArray(m)&&0!==m.length)switch(m[0]){case"has":return 2<=m.length&&"$id"!==m[1]&&"$type"!==m[1];case"in":return 3<=m.length&&("string"!=typeof m[1]||Array.isArray(m[2]));case"!in":case"!has":case"none":return;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==m.length||Array.isArray(m[1])||Array.isArray(m[2]);case"any":case"all":for(const p of m.slice(1))if(!HN(p)&&"boolean"!=typeof p)return;return 1;default:return 1}}const y5={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function cT(m){if(null==m)return{filter:()=>!0,needGeometry:!1};const p=Ew(m=HN(m)?m:uT(m),y5);if("error"===p.result)throw new Error(p.value.map(y=>y.key+": "+y.message).join(", "));return{filter:(y,E,I)=>p.value.evaluate(y,E,{},I),needGeometry:function y(E){if(!Array.isArray(E))return!1;if("within"===E[0])return!0;for(let I=1;I<E.length;I++)if(y(E[I]))return!0;return!1}(m)}}function wD(m,p){return m<p?-1:p<m?1:0}function uT(m){var p,y;return!m||(p=m[0],m.length<=1?"any"!==p:"=="===p?hT(m[1],m[2],"=="):"!="===p?R_(hT(m[1],m[2],"==")):"<"===p||">"===p||"<="===p||">="===p?hT(m[1],m[2],p):"any"===p?(y=m.slice(1),["any"].concat(y.map(uT))):"all"===p?["all"].concat(m.slice(1).map(uT)):"none"===p?["all"].concat(m.slice(1).map(uT).map(R_)):"in"===p?$N(m[1],m.slice(2)):"!in"===p?R_($N(m[1],m.slice(2))):"has"===p?bD(m[1]):"!has"===p?R_(bD(m[1])):"within"!==p||m)}function hT(m,p,y){switch(m){case"$type":return["filter-type-"+y,p];case"$id":return["filter-id-"+y,p];default:return["filter-"+y,m,p]}}function $N(m,p){if(0===p.length)return!1;switch(m){case"$type":return["filter-type-in",["literal",p]];case"$id":return["filter-id-in",["literal",p]];default:return 200<p.length&&!p.some(y=>typeof y!=typeof p[0])?["filter-in-large",m,["literal",p.sort(wD)]]:["filter-in-small",m,["literal",p]]}}function bD(m){switch(m){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",m]}}function R_(m){return["!",m]}function qN(m){let p="";for(const y of ne)p+="/"+function E(I){var R=typeof I;if("number"==R||"boolean"==R||"string"==R||null==I)return JSON.stringify(I);if(Array.isArray(I)){let V="[";for(const q of I)V+=E(q)+",";return V+"]"}var O=Object.keys(I).sort();let L="{";for(let V=0;V<O.length;V++)L+=`${JSON.stringify(O[V])}:${E(I[O[V]])},`;return L+"}"}(m[y]);return p}function GN(y){var p=y.key;return(y=y.value)?[new Pe(p,y,"constants have been deprecated as of v8")]:[]}function Ts(m){return m instanceof Number||m instanceof String||m instanceof Boolean?m.valueOf():m}function Ko(m){if(Array.isArray(m))return m.map(Ko);if(m instanceof Object&&!(m instanceof Number||m instanceof String||m instanceof Boolean)){var p={};for(const y in m)p[y]=Ko(m[y]);return p}return Ts(m)}function lu(m){var p=m.key,y=m.value,E=m.valueSpec||{},I=m.objectElementValidators||{},R=m.style,O=m.styleSpec,L=m.validateSpec;let V=[];if("object"!==(m=Fi(y)))return[new Pe(p,y,`object expected, ${m} found`)];for(const Y in y){var q=Y.split(".")[0],$=E[q]||E["*"];let ae;if(I[q])ae=I[q];else if(E[q])ae=L;else if(I["*"])ae=I["*"];else{if(!E["*"]){V.push(new Pe(p,y[Y],`unknown property "${Y}"`));continue}ae=L}V=V.concat(ae({key:(p&&p+".")+Y,value:y[Y],valueSpec:$,style:R,styleSpec:O,object:y,objectKey:Y,validateSpec:L},y))}for(const Y in E)I[Y]||E[Y].required&&void 0===E[Y].default&&void 0===y[Y]&&V.push(new Pe(p,y,`missing required property "${Y}"`));return V}function Og(m){var p=m.value,y=m.valueSpec,I=m.style,R=m.styleSpec,O=m.key,L=m.arrayElementValidator||m.validateSpec;if("array"!==Fi(p))return[new Pe(O,p,`array expected, ${Fi(p)} found`)];if(y.length&&p.length!==y.length)return[new Pe(O,p,`array length ${y.length} expected, length ${p.length} found`)];if(y["min-length"]&&p.length<y["min-length"])return[new Pe(O,p,`array length at least ${y["min-length"]} expected, length ${p.length} found`)];let V={type:y.value,values:y.values},q=(R.$version<7&&(V.function=y.function),"object"===Fi(y.value)&&(V=y.value),[]);for(let $=0;$<p.length;$++)q=q.concat(L({array:p,arrayIndex:$,value:p[$],valueSpec:V,validateSpec:m.validateSpec,style:I,styleSpec:R,key:`${O}[${$}]`}));return q}function ED(E){var p=E.key,y=E.value;E=E.valueSpec;let I=Fi(y);return"number"!==(I="number"===I&&y!=y?"NaN":I)?[new Pe(p,y,`number expected, ${I} found`)]:"minimum"in E&&y<E.minimum?[new Pe(p,y,y+" is less than the minimum value "+E.minimum)]:"maximum"in E&&y>E.maximum?[new Pe(p,y,y+" is greater than the maximum value "+E.maximum)]:[]}function dT(m){const p=m.valueSpec,y=Ts(m.value.type);let E,R,O,I={};var L="categorical"!==y&&void 0===m.value.property,V=!L;const q="array"===Fi(m.value.stops)&&"array"===Fi(m.value.stops[0])&&"object"===Fi(m.value.stops[0][0]);var $=lu({key:m.key,value:m.value,valueSpec:m.styleSpec.function,validateSpec:m.validateSpec,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(pe){if("identity"===y)return[new Pe(pe.key,pe.value,'identity function may not have a "stops" property')];let fe=[];var ve=pe.value;return fe=fe.concat(Og({key:pe.key,value:ve,valueSpec:pe.valueSpec,validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec,arrayElementValidator:Y})),"array"===Fi(ve)&&0===ve.length&&fe.push(new Pe(pe.key,ve,"array must have at least one stop")),fe},default:function(pe){return pe.validateSpec({key:pe.key,value:pe.value,valueSpec:p,validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec})}}});return"identity"===y&&L&&$.push(new Pe(m.key,m.value,'missing required property "property"')),"identity"===y||m.value.stops||$.push(new Pe(m.key,m.value,'missing required property "stops"')),"exponential"===y&&m.valueSpec.expression&&!vD(m.valueSpec)&&$.push(new Pe(m.key,m.value,"exponential functions not supported")),8<=m.styleSpec.$version&&(V&&!D_(m.valueSpec)?$.push(new Pe(m.key,m.value,"property functions not supported")):L&&!aT(m.valueSpec)&&$.push(new Pe(m.key,m.value,"zoom functions not supported"))),"categorical"!==y&&!q||void 0!==m.value.property||$.push(new Pe(m.key,m.value,'"property" property is required')),$;function Y(pe){let fe=[];var ve=pe.value,ke=pe.key;if("array"!==Fi(ve))return[new Pe(ke,ve,`array expected, ${Fi(ve)} found`)];if(2!==ve.length)return[new Pe(ke,ve,`array length 2 expected, length ${ve.length} found`)];if(q){if("object"!==Fi(ve[0]))return[new Pe(ke,ve,`object expected, ${Fi(ve[0])} found`)];if(void 0===ve[0].zoom)return[new Pe(ke,ve,"object stop key must have zoom")];if(void 0===ve[0].value)return[new Pe(ke,ve,"object stop key must have value")];if(O&&O>Ts(ve[0].zoom))return[new Pe(ke,ve[0].zoom,"stop zoom values must appear in ascending order")];Ts(ve[0].zoom)!==O&&(O=Ts(ve[0].zoom),R=void 0,I={}),fe=fe.concat(lu({key:ke+"[0]",value:ve[0],valueSpec:{zoom:{}},validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec,objectElementValidators:{zoom:ED,value:ae}}))}else fe=fe.concat(ae({key:ke+"[0]",value:ve[0],valueSpec:{},validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec},ve));return bw(Ko(ve[1]))?fe.concat([new Pe(ke+"[1]",ve[1],"expressions are not allowed in function stops.")]):fe.concat(pe.validateSpec({key:ke+"[1]",value:ve[1],valueSpec:p,validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec}))}function ae(pe,_e){var ve=Fi(pe.value),ke=Ts(pe.value);if(_e=null!==pe.value?pe.value:_e,E){if(ve!==E)return[new Pe(pe.key,_e,ve+" stop domain type must match previous stop domain type "+E)]}else E=ve;if("number"!==ve&&"string"!==ve&&"boolean"!==ve)return[new Pe(pe.key,_e,"stop domain value must be a number, string, or boolean")];if("number"===ve||"categorical"===y)return"categorical"!==y||"number"!==ve||isFinite(ke)&&Math.floor(ke)===ke?"categorical"!==y&&"number"===ve&&void 0!==R&&ke<R?[new Pe(pe.key,_e,"stop domain values must appear in ascending order")]:(R=ke,"categorical"===y&&ke in I?[new Pe(pe.key,_e,"stop domain values must be unique")]:(I[ke]=!0,[])):[new Pe(pe.key,_e,"integer expected, found "+ke)];{let ze=`number expected, ${ve} found`;return D_(p)&&void 0===y&&(ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Pe(pe.key,_e,ze)]}}}function M_(m){var p=("property"===m.expressionContext?as:Ew)(Ko(m.value),m.valueSpec);if("error"===p.result)return p.value.map(y=>new Pe(""+m.key+y.key,m.value,y.message));if(p=p.value.expression||p.value._styleExpression.expression,"property"===m.expressionContext&&"text-font"===m.propertyKey&&!p.outputDefined())return[new Pe(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===m.expressionContext&&"layout"===m.propertyType&&!Dg(p))return[new Pe(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===m.expressionContext&&!Dg(p))return[new Pe(m.key,m.value,'"feature-state" data expressions are not supported with filters.')];if(m.expressionContext&&0===m.expressionContext.indexOf("cluster")){if(!gw(p,["zoom","feature-state"]))return[new Pe(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===m.expressionContext&&!oT(p))return[new Pe(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Iw(E){var p=E.key,y=E.value,I=(E=E.valueSpec,[]);return Array.isArray(E.values)?-1===E.values.indexOf(Ts(y))&&I.push(new Pe(p,y,`expected one of [${E.values.join(", ")}], ${JSON.stringify(y)} found`)):-1===Object.keys(E.values).indexOf(Ts(y))&&I.push(new Pe(p,y,`expected one of [${Object.keys(E.values).join(", ")}], ${JSON.stringify(y)} found`)),I}function xD(m){return HN(Ko(m.value))?M_(Ft({},m,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function p(y){const E=y.value,I=y.key;if("array"!==Fi(E))return[new Pe(I,E,`array expected, ${Fi(E)} found`)];const R=y.styleSpec;let O,L=[];if(E.length<1)return[new Pe(I,E,"filter array must have at least 1 element")];switch(L=L.concat(Iw({key:I+"[0]",value:E[0],valueSpec:R.filter_operator,style:y.style,styleSpec:y.styleSpec})),Ts(E[0])){case"<":case"<=":case">":case">=":2<=E.length&&"$type"===Ts(E[1])&&L.push(new Pe(I,E,`"$type" cannot be use with operator "${E[0]}"`));case"==":case"!=":3!==E.length&&L.push(new Pe(I,E,`filter array for operator "${E[0]}" must have 3 elements`));case"in":case"!in":2<=E.length&&"string"!==(O=Fi(E[1]))&&L.push(new Pe(I+"[1]",E[1],`string expected, ${O} found`));for(let V=2;V<E.length;V++)O=Fi(E[V]),"$type"===Ts(E[1])?L=L.concat(Iw({key:`${I}[${V}]`,value:E[V],valueSpec:R.geometry_type,style:y.style,styleSpec:y.styleSpec})):"string"!==O&&"number"!==O&&"boolean"!==O&&L.push(new Pe(`${I}[${V}]`,E[V],`string, number, or boolean expected, ${O} found`));break;case"any":case"all":case"none":for(let V=1;V<E.length;V++)L=L.concat(p({key:`${I}[${V}]`,value:E[V],style:y.style,styleSpec:y.styleSpec}));break;case"has":case"!has":O=Fi(E[1]),2!==E.length?L.push(new Pe(I,E,`filter array for "${E[0]}" operator must have 2 elements`)):"string"!==O&&L.push(new Pe(I+"[1]",E[1],`string expected, ${O} found`));break;case"within":O=Fi(E[1]),2!==E.length?L.push(new Pe(I,E,`filter array for "${E[0]}" operator must have 2 elements`)):"object"!==O&&L.push(new Pe(I+"[1]",E[1],`object expected, ${O} found`))}return L}(m)}function TD(m,p){var y=m.key,E=m.validateSpec,I=m.style,R=m.styleSpec,O=m.value,L=m.objectKey,V=R[p+"_"+m.layerType];if(!V)return[];var q=L.match(/^(.*)-transition$/);if("paint"===p&&q&&V[q[1]]&&V[q[1]].transition)return E({key:y,value:O,valueSpec:R.transition,style:I,styleSpec:R});if(!(q=m.valueSpec||V[L]))return[new Pe(y,O,`unknown property "${L}"`)];let $;return"string"===Fi(O)&&D_(q)&&!q.tokens&&($=/^{([^}]+)}$/.exec(O))?[new Pe(y,O,`"${L}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify($[1])} }\`.`)]:(V=[],"symbol"===m.layerType&&("text-field"===L&&I&&!I.glyphs&&V.push(new Pe(y,O,'use of "text-field" requires a style "glyphs" property')),"text-font"===L)&&Kf(Ko(O))&&"identity"===Ts(O.type)&&V.push(new Pe(y,O,'"text-font" does not support identity functions')),V.concat(E({key:m.key,value:O,valueSpec:q,style:I,styleSpec:R,expressionContext:"property",propertyType:p,propertyKey:L})))}function CD(m){return TD(m,"paint")}function ID(m){return TD(m,"layout")}function k_(m){let p=[];const y=m.value,E=m.key;var I,R,O=m.style;const L=m.styleSpec;y.type||y.ref||p.push(new Pe(E,y,'either "type" or "ref" is required'));let V=Ts(y.type);const q=Ts(y.ref);if(y.id){var $=Ts(y.id);for(let ae=0;ae<m.arrayIndex;ae++){var Y=O.layers[ae];Ts(Y.id)===$&&p.push(new Pe(E,y.id,`duplicate layer id "${y.id}", previously used at line `+Y.id.__line__))}}if("ref"in y){let ae;["type","source","source-layer","filter","layout"].forEach(pe=>{pe in y&&p.push(new Pe(E,y[pe],`"${pe}" is prohibited for ref layers`))}),O.layers.forEach(pe=>{Ts(pe.id)===q&&(ae=pe)}),ae?ae.ref?p.push(new Pe(E,y.ref,"ref cannot reference another ref layer")):V=Ts(ae.type):p.push(new Pe(E,y.ref,`ref layer "${q}" not found`))}else"background"!==V&&(y.source?(R=(I=O.sources&&O.sources[y.source])&&Ts(I.type),I?"vector"===R&&"raster"===V?p.push(new Pe(E,y.source,`layer "${y.id}" requires a raster source`)):"raster-dem"!==R&&"hillshade"===V?p.push(new Pe(E,y.source,`layer "${y.id}" requires a raster-dem source`)):"raster"===R&&"raster"!==V?p.push(new Pe(E,y.source,`layer "${y.id}" requires a vector source`)):"vector"!==R||y["source-layer"]?"raster-dem"===R&&"hillshade"!==V?p.push(new Pe(E,y.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==V||!y.paint||!y.paint["line-gradient"]||"geojson"===R&&I.lineMetrics||p.push(new Pe(E,y,`layer "${y.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):p.push(new Pe(E,y,`layer "${y.id}" must specify a "source-layer"`)):p.push(new Pe(E,y.source,`source "${y.source}" not found`))):p.push(new Pe(E,y,'missing required property "source"')));return p=p.concat(lu({key:E,value:y,valueSpec:L.layer,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,objectElementValidators:{"*":()=>[],type:()=>m.validateSpec({key:E+".type",value:y.type,valueSpec:L.layer.type,style:m.style,styleSpec:m.styleSpec,validateSpec:m.validateSpec,object:y,objectKey:"type"}),filter:xD,layout:ae=>lu({layer:y,key:ae.key,value:ae.value,style:ae.style,styleSpec:ae.styleSpec,validateSpec:ae.validateSpec,objectElementValidators:{"*":pe=>ID(Ft({layerType:V},pe))}}),paint:ae=>lu({layer:y,key:ae.key,value:ae.value,style:ae.style,styleSpec:ae.styleSpec,validateSpec:ae.validateSpec,objectElementValidators:{"*":pe=>CD(Ft({layerType:V},pe))}})}}))}function Qf(y){var p=y.value,E=(y=y.key,Fi(p));return"string"!==E?[new Pe(y,p,`string expected, ${E} found`)]:[]}const pT={promoteId:function({key:m,value:p}){if("string"===Fi(p))return Qf({key:m,value:p});var y=[];for(const E in p)y.push(...Qf({key:m+"."+E,value:p[E]}));return y}};function O_(m){var p=m.value,y=m.key,E=m.styleSpec,I=m.style,R=m.validateSpec;if(!p.type)return[new Pe(y,p,'"type" is required')];var O=Ts(p.type);let L;switch(O){case"vector":case"raster":return lu({key:y,value:p,valueSpec:E["source_"+O.replace("-","_")],style:m.style,styleSpec:E,objectElementValidators:pT,validateSpec:R});case"raster-dem":return function($){var Y=null!=(_e=$.sourceName)?_e:"",ae=$.value,pe=$.styleSpec,fe=pe.source_raster_dem,ve=$.style;let ke=[];var _e=Fi(ae);if(void 0!==ae)if("object"!==_e)ke.push(new Pe("source_raster_dem",ae,`object expected, ${_e} found`));else{var ze="custom"===Ts(ae.encoding),Qe=["redFactor","greenFactor","blueFactor","baseShift"],ht=$.value.encoding?`"${$.value.encoding}"`:"Default";for(const pt in ae)!ze&&Qe.includes(pt)?ke.push(new Pe(pt,ae[pt],`In "${Y}": "${pt}" is only valid when "encoding" is set to "custom". ${ht} encoding found`)):fe[pt]?ke=ke.concat($.validateSpec({key:pt,value:ae[pt],valueSpec:fe[pt],validateSpec:$.validateSpec,style:ve,styleSpec:pe})):ke.push(new Pe(pt,ae[pt],`unknown property "${pt}"`))}return ke}({sourceName:y,value:p,style:m.style,styleSpec:E,validateSpec:R});case"geojson":if(L=lu({key:y,value:p,valueSpec:E.source_geojson,style:I,styleSpec:E,validateSpec:R,objectElementValidators:pT}),p.cluster)for(const $ in p.clusterProperties){var[q,V]=p.clusterProperties[$],q="string"==typeof q?[q,["accumulated"],["get",$]]:q;L.push(...M_({key:`${y}.${$}.map`,value:V,validateSpec:R,expressionContext:"cluster-map"})),L.push(...M_({key:`${y}.${$}.reduce`,value:q,validateSpec:R,expressionContext:"cluster-reduce"}))}return L;case"video":return lu({key:y,value:p,valueSpec:E.source_video,style:I,validateSpec:R,styleSpec:E});case"image":return lu({key:y,value:p,valueSpec:E.source_image,style:I,validateSpec:R,styleSpec:E});case"canvas":return[new Pe(y,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Iw({key:y+".type",value:p.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:I,validateSpec:R,styleSpec:E})}}function fT(m){var p=m.value,y=m.styleSpec,E=y.light,I=m.style;let R=[];var O=Fi(p);if(void 0!==p){if("object"!==O)return R.concat([new Pe("light",p,`object expected, ${O} found`)]);for(const V in p){var L=V.match(/^(.*)-transition$/);R=R.concat(L&&E[L[1]]&&E[L[1]].transition?m.validateSpec({key:V,value:p[V],valueSpec:y.transition,validateSpec:m.validateSpec,style:I,styleSpec:y}):E[V]?m.validateSpec({key:V,value:p[V],valueSpec:E[V],validateSpec:m.validateSpec,style:I,styleSpec:y}):[new Pe(V,p[V],`unknown property "${V}"`)])}}return R}function KN(R){var p=R.value,y=R.styleSpec,E=y.sky,I=R.style;if(R=Fi(p),void 0===p)return[];if("object"!==R)return[new Pe("sky",p,`object expected, ${R} found`)];let O=[];for(const L in p)O=O.concat(E[L]?Dp({key:L,value:p[L],valueSpec:E[L],style:I,styleSpec:y}):[new Pe(L,p[L],`unknown property "${L}"`)]);return O}function Sw(m){var p=m.value,y=m.styleSpec,E=y.terrain,I=m.style;let R=[];var O=Fi(p);if(void 0!==p){if("object"!==O)return R.concat([new Pe("terrain",p,`object expected, ${O} found`)]);for(const L in p)R=R.concat(E[L]?m.validateSpec({key:L,value:p[L],valueSpec:E[L],validateSpec:m.validateSpec,style:I,styleSpec:y}):[new Pe(L,p[L],`unknown property "${L}"`)])}return R}function WN(m){let p=[];var y=m.value,E=m.key;if(Array.isArray(y)){var I=[],R=[];for(const O in y)y[O].id&&I.includes(y[O].id)&&p.push(new Pe(E,y,`all the sprites' ids must be unique, but ${y[O].id} is duplicated`)),I.push(y[O].id),y[O].url&&R.includes(y[O].url)&&p.push(new Pe(E,y,`all the sprites' URLs must be unique, but ${y[O].url} is duplicated`)),R.push(y[O].url),p=p.concat(lu({key:`${E}[${O}]`,value:y[O],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:m.validateSpec}));return p}return Qf({key:E,value:y})}const mT={"*":()=>[],array:Og,boolean:function(y){var p=y.value,E=(y=y.key,Fi(p));return"boolean"!==E?[new Pe(y,p,`boolean expected, ${E} found`)]:[]},number:ED,color:function(m){var p=m.key,y=Fi(m=m.value);return"string"!==y?[new Pe(p,m,`color expected, ${y} found`)]:wo.parse(String(m))?[]:[new Pe(p,m,`color expected, "${m}" found`)]},constants:GN,enum:Iw,filter:xD,function:dT,layer:k_,object:lu,source:O_,light:fT,sky:KN,terrain:Sw,string:Qf,formatted:function(m){return 0===Qf(m).length?[]:M_(m)},resolvedImage:function(m){return 0===Qf(m).length?[]:M_(m)},padding:function(m){var p=m.key,y=m.value;if("array"!==Fi(y))return ED({key:p,value:y,valueSpec:{}});{if(y.length<1||4<y.length)return[new Pe(p,y,`padding requires 1 to 4 values; ${y.length} values found`)];var E={type:"number"};let I=[];for(let R=0;R<y.length;R++)I=I.concat(m.validateSpec({key:`${p}[${R}]`,value:y[R],validateSpec:m.validateSpec,valueSpec:E}));return I}},variableAnchorOffsetCollection:function(m){var p=m.key,y=m.value,E=Fi(y),I=m.styleSpec;if("array"!==E||y.length<1||y.length%2!=0)return[new Pe(p,y,"variableAnchorOffsetCollection requires a non-empty array of even length")];let R=[];for(let O=0;O<y.length;O+=2)R=(R=R.concat(Iw({key:`${p}[${O}]`,value:y[O],valueSpec:I.layout_symbol["text-anchor"]}))).concat(Og({key:`${p}[${O+1}]`,value:y[O+1],valueSpec:{length:2,value:"number"},validateSpec:m.validateSpec,style:m.style,styleSpec:I}));return R},sprite:WN};function Dp(m){var p=m.value,y=m.valueSpec,E=m.styleSpec;return m.validateSpec=Dp,y.expression&&Kf(Ts(p))?dT(m):y.expression&&bw(Ko(p))?M_(m):y.type&&mT[y.type]?mT[y.type](m):lu(Ft({},m,{valueSpec:y.type?E[y.type]:y}))}function N_(E){var p=E.value,y=E.key;return(E=Qf(E)).length||(-1===p.indexOf("{fontstack}")&&E.push(new Pe(y,p,'"glyphs" url must include a "{fontstack}" token')),-1===p.indexOf("{range}")&&E.push(new Pe(y,p,'"glyphs" url must include a "{range}" token'))),E}function kc(m,p=oe){let y=[];return y=y.concat(Dp({key:"",value:m,valueSpec:p.$root,styleSpec:p,style:m,validateSpec:Dp,objectElementValidators:{glyphs:N_,"*":()=>[]}})),SD(y=m.constants?y.concat(GN({key:"constants",value:m.constants,style:m,styleSpec:p,validateSpec:Dp})):y)}function cu(m){return function(p){return m({...p,validateSpec:Dp})}}function SD(m){return[].concat(m).sort((p,y)=>p.line-y.line)}function Yu(m){return function(...p){return SD(m.apply(this,p))}}kc.source=Yu(cu(O_)),kc.sprite=Yu(cu(WN)),kc.glyphs=Yu(cu(N_)),kc.light=Yu(cu(fT)),kc.sky=Yu(cu(KN)),kc.terrain=Yu(cu(Sw)),kc.layer=Yu(cu(k_)),kc.filter=Yu(cu(xD)),kc.paintProperty=Yu(cu(CD)),kc.layoutProperty=Yu(cu(ID));const Pp=kc;kg=Pp.light;const AD=Pp.paintProperty,_5=Pp.layoutProperty;function gT(m,p){let y=!1;if(p&&p.length)for(const E of p)m.fire(new Ut(new Error(E.message))),y=!0;return y}class Aw{constructor(p,y,E){var I=this.cells=[];if(p instanceof ArrayBuffer){this.arrayBuffer=p;var R=new Int32Array(this.arrayBuffer);p=R[0],this.d=(y=R[1])+2*(E=R[2]);for(let $=0;$<this.d*this.d;$++){var O=R[3+$],L=R[3+$+1];I.push(O===L?null:R.subarray(O,L))}var V=R[3+I.length],q=R[3+I.length+1];this.keys=R.subarray(V,q),this.bboxes=R.subarray(q),this.insert=this._insertReadonly}else{this.d=y+2*E;for(let $=0;$<this.d*this.d;$++)I.push([]);this.keys=[],this.bboxes=[]}this.n=y,this.extent=p,this.padding=E,this.scale=y/p,this.uid=0,this.min=-(V=E/y*p),this.max=p+V}insert(p,y,E,I,R){this._forEachCell(y,E,I,R,this._insertCell,this.uid++,void 0,void 0),this.keys.push(p),this.bboxes.push(y),this.bboxes.push(E),this.bboxes.push(I),this.bboxes.push(R)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(p,y,E,I,R,O){this.cells[R].push(O)}query(p,y,E,I,R){var O=this.min,L=this.max;return p<=O&&y<=O&&L<=E&&L<=I&&!R?Array.prototype.slice.call(this.keys):(this._forEachCell(p,y,E,I,this._queryCell,O=[],{},R),O)}_queryCell(p,y,E,I,R,O,L,V){var q=this.cells[R];if(null!==q){var $=this.keys,Y=this.bboxes;for(let fe=0;fe<q.length;fe++){var ae,pe=q[fe];void 0===L[pe]&&(ae=4*pe,(V?V(Y[0+ae],Y[1+ae],Y[2+ae],Y[3+ae]):p<=Y[2+ae]&&y<=Y[3+ae]&&E>=Y[0+ae]&&I>=Y[1+ae])?(L[pe]=!0,O.push($[pe])):L[pe]=!1)}}}_forEachCell(p,y,E,I,R,O,L,V){var q=this._convertToCellCoord(p),$=this._convertToCellCoord(y),Y=this._convertToCellCoord(E),ae=this._convertToCellCoord(I);for(let fe=q;fe<=Y;fe++)for(let ve=$;ve<=ae;ve++){var pe=this.d*ve+fe;if((!V||V(this._convertFromCellCoord(fe),this._convertFromCellCoord(ve),this._convertFromCellCoord(fe+1),this._convertFromCellCoord(ve+1)))&&R.call(this,p,y,E,I,pe,O,L,V))return}}_convertFromCellCoord(p){return(p-this.padding)/this.scale}_convertToCellCoord(p){return Math.max(0,Math.min(this.d-1,Math.floor(p*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;var p=this.cells,y=3+this.cells.length+1+1;let E=0;for(let L=0;L<this.cells.length;L++)E+=this.cells[L].length;var I=new Int32Array(y+E+this.keys.length+this.bboxes.length);I[0]=this.extent,I[1]=this.n,I[2]=this.padding;let R=y;for(let L=0;L<p.length;L++){var O=p[L];I[3+L]=R,I.set(O,R),R+=O.length}return I[3+p.length]=R,I.set(this.keys,R),R+=this.keys.length,I[3+p.length+1]=R,I.set(this.bboxes,R),R+=this.bboxes.length,I.buffer}static serialize(p,y){return p=p.toArrayBuffer(),y&&y.push(p),{buffer:p}}static deserialize(p){return new Aw(p.buffer)}}const uu={};function Cn(m,p,y={}){if(uu[m])throw new Error(m+" is already registered.");Object.defineProperty(p,"_classRegistryKey",{value:m,writeable:!1}),uu[m]={klass:p,omit:y.omit||[],shallow:y.shallow||[]}}Cn("Object",Object),Cn("TransferableGridIndex",Aw),Cn("Color",wo),Cn("Error",Error),Cn("AJAXError",zn),Cn("ResolvedImage",lc),Cn("StylePropertyFunction",Do),Cn("StyleExpression",Zf,{omit:["_evaluator"]}),Cn("ZoomDependentExpression",xw),Cn("ZoomConstantExpression",ss),Cn("CompoundExpression",Rc,{omit:["_evaluate"]});for(const m in xd)xd[m]._classRegistryKey||Cn("Expression_"+m,xd[m]);function Sl(m){return m&&typeof ArrayBuffer<"u"&&(m instanceof ArrayBuffer||m.constructor&&"ArrayBuffer"===m.constructor.name)}function Rp(m,p){if(null==m||"boolean"==typeof m||"number"==typeof m||"string"==typeof m||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||m instanceof Blob||m instanceof Error)return m;if(Sl(m)||Sn(m))return p&&p.push(m),m;if(ArrayBuffer.isView(m))return E=m,p&&p.push(E.buffer),E;if(m instanceof ImageData)return p&&p.push(m.data.buffer),m;if(Array.isArray(m)){var y=[];for(const L of m)y.push(Rp(L,p));return y}if("object"!=typeof m)throw new Error("can't serialize object of type "+typeof m);var E=m.constructor,I=E._classRegistryKey;if(!I)throw new Error("can't serialize object of unregistered class "+E.name);if(!uu[I])throw new Error(I+" is not registered.");var R,O=E.serialize?E.serialize(m,p):{};if(E.serialize){if(p&&O===p[p.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const L in m)!m.hasOwnProperty(L)||0<=uu[I].omit.indexOf(L)||(R=m[L],O[L]=0<=uu[I].shallow.indexOf(L)?R:Rp(R,p));m instanceof Error&&(O.message=m.message)}if(O.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==I&&(O.$name=I),O}function Xf(m){if(null==m||"boolean"==typeof m||"number"==typeof m||"string"==typeof m||m instanceof Boolean||m instanceof Number||m instanceof String||m instanceof Date||m instanceof RegExp||m instanceof Blob||m instanceof Error||Sl(m)||Sn(m)||ArrayBuffer.isView(m)||m instanceof ImageData)return m;if(Array.isArray(m))return m.map(Xf);if("object"!=typeof m)throw new Error("can't deserialize object of type "+typeof m);var p=m.$name||"Object";if(!uu[p])throw new Error("can't deserialize unregistered class "+p);var y=uu[p].klass;if(!y)throw new Error("can't deserialize unregistered class "+p);if(y.deserialize)return y.deserialize(m);var E,I=Object.create(y.prototype);for(const R of Object.keys(m))"$name"!==R&&(E=m[R],I[R]=0<=uu[p].shallow.indexOf(R)?E:Xf(E));return I}class Dw{constructor(){this.first=!0}update(p,y){var E=Math.floor(p);return this.first?(this.first=!1,this.lastIntegerZoom=E,this.lastIntegerZoomTime=0,this.lastZoom=p,this.lastFloorZoom=E,!0):(this.lastFloorZoom>E?(this.lastIntegerZoom=E+1,this.lastIntegerZoomTime=y):this.lastFloorZoom<E&&(this.lastIntegerZoom=E,this.lastIntegerZoomTime=y),p!==this.lastZoom&&(this.lastZoom=p,this.lastFloorZoom=E,!0))}}const _n={"Latin-1 Supplement":m=>128<=m&&m<=255,Arabic:m=>1536<=m&&m<=1791,"Arabic Supplement":m=>1872<=m&&m<=1919,"Arabic Extended-A":m=>2208<=m&&m<=2303,"Hangul Jamo":m=>4352<=m&&m<=4607,"Unified Canadian Aboriginal Syllabics":m=>5120<=m&&m<=5759,Khmer:m=>6016<=m&&m<=6143,"Unified Canadian Aboriginal Syllabics Extended":m=>6320<=m&&m<=6399,"General Punctuation":m=>8192<=m&&m<=8303,"Letterlike Symbols":m=>8448<=m&&m<=8527,"Number Forms":m=>8528<=m&&m<=8591,"Miscellaneous Technical":m=>8960<=m&&m<=9215,"Control Pictures":m=>9216<=m&&m<=9279,"Optical Character Recognition":m=>9280<=m&&m<=9311,"Enclosed Alphanumerics":m=>9312<=m&&m<=9471,"Geometric Shapes":m=>9632<=m&&m<=9727,"Miscellaneous Symbols":m=>9728<=m&&m<=9983,"Miscellaneous Symbols and Arrows":m=>11008<=m&&m<=11263,"CJK Radicals Supplement":m=>11904<=m&&m<=12031,"Kangxi Radicals":m=>12032<=m&&m<=12255,"Ideographic Description Characters":m=>12272<=m&&m<=12287,"CJK Symbols and Punctuation":m=>12288<=m&&m<=12351,Hiragana:m=>12352<=m&&m<=12447,Katakana:m=>12448<=m&&m<=12543,Bopomofo:m=>12544<=m&&m<=12591,"Hangul Compatibility Jamo":m=>12592<=m&&m<=12687,Kanbun:m=>12688<=m&&m<=12703,"Bopomofo Extended":m=>12704<=m&&m<=12735,"CJK Strokes":m=>12736<=m&&m<=12783,"Katakana Phonetic Extensions":m=>12784<=m&&m<=12799,"Enclosed CJK Letters and Months":m=>12800<=m&&m<=13055,"CJK Compatibility":m=>13056<=m&&m<=13311,"CJK Unified Ideographs Extension A":m=>13312<=m&&m<=19903,"Yijing Hexagram Symbols":m=>19904<=m&&m<=19967,"CJK Unified Ideographs":m=>19968<=m&&m<=40959,"Yi Syllables":m=>40960<=m&&m<=42127,"Yi Radicals":m=>42128<=m&&m<=42191,"Hangul Jamo Extended-A":m=>43360<=m&&m<=43391,"Hangul Syllables":m=>44032<=m&&m<=55215,"Hangul Jamo Extended-B":m=>55216<=m&&m<=55295,"Private Use Area":m=>57344<=m&&m<=63743,"CJK Compatibility Ideographs":m=>63744<=m&&m<=64255,"Arabic Presentation Forms-A":m=>64336<=m&&m<=65023,"Vertical Forms":m=>65040<=m&&m<=65055,"CJK Compatibility Forms":m=>65072<=m&&m<=65103,"Small Form Variants":m=>65104<=m&&m<=65135,"Arabic Presentation Forms-B":m=>65136<=m&&m<=65279,"Halfwidth and Fullwidth Forms":m=>65280<=m&&m<=65519};function Ng(m){for(const p of m)if(Pw(p.charCodeAt(0)))return!0;return!1}function yT(m){for(const y of m)if(p=y.charCodeAt(0),_n.Arabic(p)||_n["Arabic Supplement"](p)||_n["Arabic Extended-A"](p)||_n["Arabic Presentation Forms-A"](p)||_n["Arabic Presentation Forms-B"](p))return;var p;return 1}function Pw(m){return 746===m||747===m||!(m<4352)&&(_n["Bopomofo Extended"](m)||_n.Bopomofo(m)||_n["CJK Compatibility Forms"](m)&&!(65097<=m&&m<=65103)||_n["CJK Compatibility Ideographs"](m)||_n["CJK Compatibility"](m)||_n["CJK Radicals Supplement"](m)||_n["CJK Strokes"](m)||!(!_n["CJK Symbols and Punctuation"](m)||12296<=m&&m<=12305||12308<=m&&m<=12319||12336===m)||_n["CJK Unified Ideographs Extension A"](m)||_n["CJK Unified Ideographs"](m)||_n["Enclosed CJK Letters and Months"](m)||_n["Hangul Compatibility Jamo"](m)||_n["Hangul Jamo Extended-A"](m)||_n["Hangul Jamo Extended-B"](m)||_n["Hangul Jamo"](m)||_n["Hangul Syllables"](m)||_n.Hiragana(m)||_n["Ideographic Description Characters"](m)||_n.Kanbun(m)||_n["Kangxi Radicals"](m)||_n["Katakana Phonetic Extensions"](m)||_n.Katakana(m)&&12540!==m||!(!_n["Halfwidth and Fullwidth Forms"](m)||65288===m||65289===m||65293===m||65306<=m&&m<=65310||65339===m||65341===m||65343===m||65371<=m&&m<=65503||65507===m||65512<=m&&m<=65519)||!(!_n["Small Form Variants"](m)||65112<=m&&m<=65118||65123<=m&&m<=65126)||_n["Unified Canadian Aboriginal Syllabics"](m)||_n["Unified Canadian Aboriginal Syllabics Extended"](m)||_n["Vertical Forms"](m)||_n["Yijing Hexagram Symbols"](m)||_n["Yi Syllables"](m)||!!_n["Yi Radicals"](m))}function _T(m){return!(Pw(m)||_n["Latin-1 Supplement"](m)&&(167===m||169===m||174===m||177===m||188===m||189===m||190===m||215===m||247===m)||_n["General Punctuation"](m)&&(8214===m||8224===m||8225===m||8240===m||8241===m||8251===m||8252===m||8258===m||8263===m||8264===m||8265===m||8273===m)||_n["Letterlike Symbols"](m)||_n["Number Forms"](m)||_n["Miscellaneous Technical"](m)&&(8960<=m&&m<=8967||8972<=m&&m<=8991||8996<=m&&m<=9e3||9003===m||9085<=m&&m<=9114||9150<=m&&m<=9165||9167===m||9169<=m&&m<=9179||9186<=m&&m<=9215)||_n["Control Pictures"](m)&&9251!==m||_n["Optical Character Recognition"](m)||_n["Enclosed Alphanumerics"](m)||_n["Geometric Shapes"](m)||_n["Miscellaneous Symbols"](m)&&!(9754<=m&&m<=9759)||_n["Miscellaneous Symbols and Arrows"](m)&&(11026<=m&&m<=11055||11088<=m&&m<=11097||11192<=m&&m<=11243)||_n["CJK Symbols and Punctuation"](m)||_n.Katakana(m)||_n["Private Use Area"](m)||_n["CJK Compatibility Forms"](m)||_n["Small Form Variants"](m)||_n["Halfwidth and Fullwidth Forms"](m)||8734===m||8756===m||8757===m||9984<=m&&m<=10087||10102<=m&&m<=10131||65532===m||65533===m)}function YN(m){return 1424<=m&&m<=2303||_n["Arabic Presentation Forms-A"](m)||_n["Arabic Presentation Forms-B"](m)}const Lg=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(m){this.pluginStatus=m.pluginStatus,this.pluginURL=m.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(m){this.applyArabicShaping=m.applyArabicShaping,this.processBidirectionalText=m.processBidirectionalText,this.processStyledBidirectionalText=m.processStyledBidirectionalText}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class uo{constructor(p,y){this.zoom=p,y?(this.now=y.now,this.fadeDuration=y.fadeDuration,this.zoomHistory=y.zoomHistory,this.transition=y.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Dw,this.transition={})}isSupportedScript(p){return function Rw(m,p){for(const E of m)if(y=E.charCodeAt(0),!p&&YN(y)||2304<=y&&y<=3583||3840<=y&&y<=4255||_n.Khmer(y))return!1;var y;return!0}(p,"loaded"===Lg.getRTLTextPluginStatus())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){var p=this.zoom,y=p-Math.floor(p),E=this.crossFadingFactor();return p>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:y+(1-y)*E}:{fromScale:.5,toScale:1,t:1-(1-E)*y}}}class vT{constructor(p,y){this.property=p,this.value=y,this.expression=function Tw(m,p){if(Kf(m))return new Do(m,p);if(bw(m)){var y=as(m,p);if("error"===y.result)throw new Error(y.value.map(E=>E.key+": "+E.message).join(", "));return y.value}{let E=m;return"color"===p.type&&"string"==typeof m?E=wo.parse(m):"padding"!==p.type||"number"!=typeof m&&!Array.isArray(m)?"variableAnchorOffsetCollection"===p.type&&Array.isArray(m)&&(E=Ph.parse(m)):E=sl.parse(m),{kind:"constant",evaluate:()=>E}}}(void 0===y?p.specification.default:y,p.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(p,y,E){return this.property.possiblyEvaluate(this,p,y,E)}}class Mw{constructor(p){this.property=p,this.value=new vT(p,void 0)}transitioned(p,y){return new kw(this.property,this.value,y,Qt({},p.transition,this.transition),p.now)}untransitioned(){return new kw(this.property,this.value,null,{},0)}}class wT{constructor(p){this._properties=p,this._values=Object.create(p.defaultTransitionablePropertyValues)}getValue(p){return Et(this._values[p].value.value)}setValue(p,y){Object.prototype.hasOwnProperty.call(this._values,p)||(this._values[p]=new Mw(this._values[p].property)),this._values[p].value=new vT(this._values[p].property,null===y?void 0:Et(y))}getTransition(p){return Et(this._values[p].transition)}setTransition(p,y){Object.prototype.hasOwnProperty.call(this._values,p)||(this._values[p]=new Mw(this._values[p].property)),this._values[p].transition=Et(y)||void 0}serialize(){var p={};for(const E of Object.keys(this._values)){var y;void 0!==(void 0!==(y=this.getValue(E))&&(p[E]=y),y=this.getTransition(E))&&(p[E+"-transition"]=y)}return p}transitioned(p,y){var E=new L_(this._properties);for(const I of Object.keys(this._values))E._values[I]=this._values[I].transitioned(p,y._values[I]);return E}untransitioned(){var p=new L_(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].untransitioned();return p}}class kw{constructor(p,y,E,I,R){this.property=p,this.value=y,this.begin=R+I.delay||0,this.end=this.begin+I.duration||0,p.specification.transition&&(I.delay||I.duration)&&(this.prior=E)}possiblyEvaluate(p,y,E){var I=p.now||0,R=this.value.possiblyEvaluate(p,y,E),O=this.prior;return O?I>this.end||this.value.isDataDriven()?(this.prior=null,R):I<this.begin?O.possiblyEvaluate(p,y,E):(I=(I-this.begin)/(this.end-this.begin),this.property.interpolate(O.possiblyEvaluate(p,y,E),R,function Re(m){var p,y;return m<=0?0:1<=m?1:(y=(p=m*m)*m,4*(m<.5?y:3*(m-p)+y-.75))}(I))):R}}class L_{constructor(p){this._properties=p,this._values=Object.create(p.defaultTransitioningPropertyValues)}possiblyEvaluate(p,y,E){var I=new Ow(this._properties);for(const R of Object.keys(this._values))I._values[R]=this._values[R].possiblyEvaluate(p,y,E);return I}hasTransition(){for(const p of Object.keys(this._values))if(this._values[p].prior)return!0;return!1}}class Mp{constructor(p){this._properties=p,this._values=Object.create(p.defaultPropertyValues)}hasValue(p){return void 0!==this._values[p].value}getValue(p){return Et(this._values[p].value)}setValue(p,y){this._values[p]=new vT(this._values[p].property,null===y?void 0:Et(y))}serialize(){var p={};for(const E of Object.keys(this._values)){var y=this.getValue(E);void 0!==y&&(p[E]=y)}return p}possiblyEvaluate(p,y,E){var I=new Ow(this._properties);for(const R of Object.keys(this._values))I._values[R]=this._values[R].possiblyEvaluate(p,y,E);return I}}class Oc{constructor(p,y,E){this.property=p,this.value=y,this.parameters=E}isConstant(){return"constant"===this.value.kind}constantOr(p){return"constant"===this.value.kind?this.value.value:p}evaluate(p,y,E,I){return this.property.evaluate(this.value,this.parameters,p,y,E,I)}}class Ow{constructor(p){this._properties=p,this._values=Object.create(p.defaultPossiblyEvaluatedValues)}get(p){return this._values[p]}}class Bn{constructor(p){this.specification=p}possiblyEvaluate(p,y){if(p.isDataDriven())throw new Error("Value should not be data driven");return p.expression.evaluate(y)}interpolate(p,y,E){var I;return(I=al[I=this.specification.type])?I(p,y,E):p}}class pr{constructor(p,y){this.specification=p,this.overrides=y}possiblyEvaluate(p,y,E,I){return new Oc(this,"constant"===p.expression.kind||"camera"===p.expression.kind?{kind:"constant",value:p.expression.evaluate(y,null,{},E,I)}:p.expression,y)}interpolate(p,y,E){var I;return"constant"!==p.value.kind||"constant"!==y.value.kind?p:void 0===p.value.value||void 0===y.value.value?new Oc(this,{kind:"constant",value:void 0},p.parameters):(I=al[I=this.specification.type])?(I=I(p.value.value,y.value.value,E),new Oc(this,{kind:"constant",value:I},p.parameters)):p}evaluate(p,y,E,I,R,O){return"constant"===p.kind?p.value:p.evaluate(y,E,I,R,O)}}class kp extends pr{possiblyEvaluate(p,y,E,I){return void 0===p.value?new Oc(this,{kind:"constant",value:void 0},y):"constant"===p.expression.kind?(E=p.expression.evaluate(y,null,{},E,I),E=this._calculate(I="resolvedImage"===p.property.specification.type&&"string"!=typeof E?E.name:E,I,I,y),new Oc(this,{kind:"constant",value:E},y)):"camera"===p.expression.kind?(I=this._calculate(p.expression.evaluate({zoom:y.zoom-1}),p.expression.evaluate({zoom:y.zoom}),p.expression.evaluate({zoom:y.zoom+1}),y),new Oc(this,{kind:"constant",value:I},y)):new Oc(this,p.expression,y)}evaluate(p,y,E,I,R,O){return"source"===p.kind?(R=p.evaluate(y,E,I,R,O),this._calculate(R,R,R,y)):"composite"===p.kind?this._calculate(p.evaluate({zoom:Math.floor(y.zoom)-1},E,I),p.evaluate({zoom:Math.floor(y.zoom)},E,I),p.evaluate({zoom:Math.floor(y.zoom)+1},E,I),y):p.value}_calculate(p,y,E,I){return I.zoom>I.zoomHistory.lastIntegerZoom?{from:p,to:y}:{from:E,to:y}}interpolate(p){return p}}class bT{constructor(p){this.specification=p}possiblyEvaluate(p,y,E,I){if(void 0!==p.value)return"constant"===p.expression.kind?(E=p.expression.evaluate(y,null,{},E,I),this._calculate(E,E,E,y)):this._calculate(p.expression.evaluate(new uo(Math.floor(y.zoom-1),y)),p.expression.evaluate(new uo(Math.floor(y.zoom),y)),p.expression.evaluate(new uo(Math.floor(y.zoom+1),y)),y)}_calculate(p,y,E,I){return I.zoom>I.zoomHistory.lastIntegerZoom?{from:p,to:y}:{from:E,to:y}}interpolate(p){return p}}class F_{constructor(p){this.specification=p}possiblyEvaluate(p,y,E,I){return!!p.expression.evaluate(y,null,{},E,I)}interpolate(){return!1}}class cc{constructor(p){this.properties=p,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const I in p){var y=((E=p[I]).specification.overridable&&this.overridableProperties.push(I),this.defaultPropertyValues[I]=new vT(E,void 0)),E=this.defaultTransitionablePropertyValues[I]=new Mw(E);this.defaultTransitioningPropertyValues[I]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[I]=y.possiblyEvaluate({})}}}Cn("DataDrivenProperty",pr),Cn("DataConstantProperty",Bn),Cn("CrossFadedDataDrivenProperty",kp),Cn("CrossFadedProperty",bT),Cn("ColorRampProperty",F_);const Fg="-transition";class Zu extends Jt{constructor(p,y){if(super(),this.id=p.id,this.type=p.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==p.type&&(this.metadata=p.metadata,this.minzoom=p.minzoom,this.maxzoom=p.maxzoom,"background"!==p.type&&(this.source=p.source,this.sourceLayer=p["source-layer"],this.filter=p.filter),y.layout&&(this._unevaluatedLayout=new Mp(y.layout)),y.paint)){this._transitionablePaint=new wT(y.paint);for(const E in p.paint)this.setPaintProperty(E,p.paint[E],{validate:!1});for(const E in p.layout)this.setLayoutProperty(E,p.layout[E],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ow(y.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(p){return"visibility"===p?this.visibility:this._unevaluatedLayout.getValue(p)}setLayoutProperty(p,y,E={}){null!=y&&this._validate(_5,`layers.${this.id}.layout.`+p,p,y,E)||("visibility"===p?this.visibility=y:this._unevaluatedLayout.setValue(p,y))}getPaintProperty(p){return p.endsWith(Fg)?this._transitionablePaint.getTransition(p.slice(0,-11)):this._transitionablePaint.getValue(p)}setPaintProperty(p,y,E={}){if(null!=y){var I=`layers.${this.id}.paint.`+p;if(this._validate(AD,I,p,y,E))return!1}var R;return p.endsWith(Fg)?(this._transitionablePaint.setTransition(p.slice(0,-11),y||void 0),!1):(E="cross-faded-data-driven"===(I=this._transitionablePaint._values[p]).property.specification["property-type"],R=I.value.isDataDriven(),I=I.value,this._transitionablePaint.setValue(p,y),this._handleSpecialPaintPropertyUpdate(p),(y=this._transitionablePaint._values[p].value).isDataDriven()||R||E||this._handleOverridablePaintPropertyUpdate(p,I,y))}_handleSpecialPaintPropertyUpdate(p){}_handleOverridablePaintPropertyUpdate(p,y,E){return!1}isHidden(p){return!!(this.minzoom&&p<this.minzoom)||!!(this.maxzoom&&p>=this.maxzoom)||"none"===this.visibility}updateTransitions(p){this._transitioningPaint=this._transitionablePaint.transitioned(p,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(p,y){p.getCrossfadeParameters&&(this._crossfadeParameters=p.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(p,void 0,y)),this.paint=this._transitioningPaint.possiblyEvaluate(p,void 0,y)}serialize(){var p={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(p.layout=p.layout||{},p.layout.visibility=this.visibility),ot(p,(y,E)=>!(void 0===y||"layout"===E&&!Object.keys(y).length||"paint"===E&&!Object.keys(y).length))}_validate(p,y,E,I,R={}){return(!R||!1!==R.validate)&&gT(this,p.call(Pp,{key:y,layerType:this.type,objectKey:E,value:I,styleSpec:oe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const y in this.paint._values){var p=this.paint.get(y);if(p instanceof Oc&&D_(p.property.specification)&&("source"===p.value.kind||"composite"===p.value.kind)&&p.value.isStateDependent)return!0}return!1}}const ZN={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Vg{constructor(p,y){this._structArray=p,this._pos1=y*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class No{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(p,y){return p._trim(),y&&(p.isTransferred=!0,y.push(p.arrayBuffer)),{length:p.length,arrayBuffer:p.arrayBuffer}}static deserialize(p){var y=Object.create(this.prototype);return y.arrayBuffer=p.arrayBuffer,y.length=p.length,y.capacity=p.arrayBuffer.byteLength/y.bytesPerElement,y._refreshViews(),y}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(p){this.reserve(p),this.length=p}reserve(p){p>this.capacity&&(this.capacity=Math.max(p,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement),p=this.uint8,this._refreshViews(),p)&&this.uint8.set(p)}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ta(m,p=1){let y=0,E=0;return{members:m.map(I=>{var R=ZN[R=I.type].BYTES_PER_ELEMENT,O=y=DD(y,Math.max(p,R)),L=I.components||1;return E=Math.max(E,R),y+=R*L,{name:I.name,type:I.type,components:L,offset:O}}),size:DD(y,Math.max(E,p)),alignment:p}}function DD(m,p){return Math.ceil(m/p)*p}class Op extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(p,y){var E=this.length;return this.resize(E+1),this.emplace(E,p,y)}emplace(p,y,E){var I=2*p;return this.int16[0+I]=y,this.int16[1+I]=E,p}}Op.prototype.bytesPerElement=4,Cn("StructArrayLayout2i4",Op);class ET extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(p,y,E){var I=this.length;return this.resize(I+1),this.emplace(I,p,y,E)}emplace(p,y,E,I){var R=3*p;return this.int16[0+R]=y,this.int16[1+R]=E,this.int16[2+R]=I,p}}ET.prototype.bytesPerElement=6,Cn("StructArrayLayout3i6",ET);class xT extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(p,y,E,I){var R=this.length;return this.resize(R+1),this.emplace(R,p,y,E,I)}emplace(p,y,E,I,R){var O=4*p;return this.int16[0+O]=y,this.int16[1+O]=E,this.int16[2+O]=I,this.int16[3+O]=R,p}}xT.prototype.bytesPerElement=8,Cn("StructArrayLayout4i8",xT);class Td extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(p,y,E,I,R,O){var L=this.length;return this.resize(L+1),this.emplace(L,p,y,E,I,R,O)}emplace(p,y,E,I,R,O,L){var V=6*p;return this.int16[0+V]=y,this.int16[1+V]=E,this.int16[2+V]=I,this.int16[3+V]=R,this.int16[4+V]=O,this.int16[5+V]=L,p}}Td.prototype.bytesPerElement=12,Cn("StructArrayLayout2i4i12",Td);class Nw extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(p,y,E,I,R,O){var L=this.length;return this.resize(L+1),this.emplace(L,p,y,E,I,R,O)}emplace(p,y,E,I,R,O,L){var V=4*p,q=8*p;return this.int16[0+V]=y,this.int16[1+V]=E,this.uint8[4+q]=I,this.uint8[5+q]=R,this.uint8[6+q]=O,this.uint8[7+q]=L,p}}Nw.prototype.bytesPerElement=8,Cn("StructArrayLayout2i4ub8",Nw);class Np extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(p,y){var E=this.length;return this.resize(E+1),this.emplace(E,p,y)}emplace(p,y,E){var I=2*p;return this.float32[0+I]=y,this.float32[1+I]=E,p}}Np.prototype.bytesPerElement=8,Cn("StructArrayLayout2f8",Np);class PD extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(p,y,E,I,R,O,L,V,q,$){var Y=this.length;return this.resize(Y+1),this.emplace(Y,p,y,E,I,R,O,L,V,q,$)}emplace(p,y,E,I,R,O,L,V,q,$,Y){var ae=10*p;return this.uint16[0+ae]=y,this.uint16[1+ae]=E,this.uint16[2+ae]=I,this.uint16[3+ae]=R,this.uint16[4+ae]=O,this.uint16[5+ae]=L,this.uint16[6+ae]=V,this.uint16[7+ae]=q,this.uint16[8+ae]=$,this.uint16[9+ae]=Y,p}}PD.prototype.bytesPerElement=20,Cn("StructArrayLayout10ui20",PD);class TT extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(p,y,E,I,R,O,L,V,q,$,Y,ae){var pe=this.length;return this.resize(pe+1),this.emplace(pe,p,y,E,I,R,O,L,V,q,$,Y,ae)}emplace(p,y,E,I,R,O,L,V,q,$,Y,ae,pe){var fe=12*p;return this.int16[0+fe]=y,this.int16[1+fe]=E,this.int16[2+fe]=I,this.int16[3+fe]=R,this.uint16[4+fe]=O,this.uint16[5+fe]=L,this.uint16[6+fe]=V,this.uint16[7+fe]=q,this.int16[8+fe]=$,this.int16[9+fe]=Y,this.int16[10+fe]=ae,this.int16[11+fe]=pe,p}}TT.prototype.bytesPerElement=24,Cn("StructArrayLayout4i4ui4i24",TT);class Lw extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(p,y,E){var I=this.length;return this.resize(I+1),this.emplace(I,p,y,E)}emplace(p,y,E,I){var R=3*p;return this.float32[0+R]=y,this.float32[1+R]=E,this.float32[2+R]=I,p}}Lw.prototype.bytesPerElement=12,Cn("StructArrayLayout3f12",Lw);class RD extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(p){var y=this.length;return this.resize(y+1),this.emplace(y,p)}emplace(p,y){return this.uint32[+p+0]=y,p}}RD.prototype.bytesPerElement=4,Cn("StructArrayLayout1ul4",RD);class Lp extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(p,y,E,I,R,O,L,V,q){var $=this.length;return this.resize($+1),this.emplace($,p,y,E,I,R,O,L,V,q)}emplace(p,y,E,I,R,O,L,V,q,$){var Y=10*p,ae=5*p;return this.int16[0+Y]=y,this.int16[1+Y]=E,this.int16[2+Y]=I,this.int16[3+Y]=R,this.int16[4+Y]=O,this.int16[5+Y]=L,this.uint32[3+ae]=V,this.uint16[8+Y]=q,this.uint16[9+Y]=$,p}}Lp.prototype.bytesPerElement=20,Cn("StructArrayLayout6i1ul2ui20",Lp);class MD extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(p,y,E,I,R,O){var L=this.length;return this.resize(L+1),this.emplace(L,p,y,E,I,R,O)}emplace(p,y,E,I,R,O,L){var V=6*p;return this.int16[0+V]=y,this.int16[1+V]=E,this.int16[2+V]=I,this.int16[3+V]=R,this.int16[4+V]=O,this.int16[5+V]=L,p}}MD.prototype.bytesPerElement=12,Cn("StructArrayLayout2i2i2i12",MD);class Fw extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(p,y,E,I,R){var O=this.length;return this.resize(O+1),this.emplace(O,p,y,E,I,R)}emplace(p,y,E,I,R,O){var L=4*p,V=8*p;return this.float32[0+L]=y,this.float32[1+L]=E,this.float32[2+L]=I,this.int16[6+V]=R,this.int16[7+V]=O,p}}Fw.prototype.bytesPerElement=16,Cn("StructArrayLayout2f1f2i16",Fw);class kD extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(p,y,E,I){var R=this.length;return this.resize(R+1),this.emplace(R,p,y,E,I)}emplace(p,y,E,I,R){var O=12*p,L=3*p;return this.uint8[0+O]=y,this.uint8[1+O]=E,this.float32[1+L]=I,this.float32[2+L]=R,p}}kD.prototype.bytesPerElement=12,Cn("StructArrayLayout2ub2f12",kD);class V_ extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(p,y,E){var I=this.length;return this.resize(I+1),this.emplace(I,p,y,E)}emplace(p,y,E,I){var R=3*p;return this.uint16[0+R]=y,this.uint16[1+R]=E,this.uint16[2+R]=I,p}}V_.prototype.bytesPerElement=6,Cn("StructArrayLayout3ui6",V_);class B_ extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(p,y,E,I,R,O,L,V,q,$,Y,ae,pe,fe,ve,ke,_e){var ze=this.length;return this.resize(ze+1),this.emplace(ze,p,y,E,I,R,O,L,V,q,$,Y,ae,pe,fe,ve,ke,_e)}emplace(p,y,E,I,R,O,L,V,q,$,Y,ae,pe,fe,ve,ke,_e,ze){var Qe=24*p,ht=12*p,pt=48*p;return this.int16[0+Qe]=y,this.int16[1+Qe]=E,this.uint16[2+Qe]=I,this.uint16[3+Qe]=R,this.uint32[2+ht]=O,this.uint32[3+ht]=L,this.uint32[4+ht]=V,this.uint16[10+Qe]=q,this.uint16[11+Qe]=$,this.uint16[12+Qe]=Y,this.float32[7+ht]=ae,this.float32[8+ht]=pe,this.uint8[36+pt]=fe,this.uint8[37+pt]=ve,this.uint8[38+pt]=ke,this.uint32[10+ht]=_e,this.int16[22+Qe]=ze,p}}B_.prototype.bytesPerElement=48,Cn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",B_);class Nc extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(p,y,E,I,R,O,L,V,q,$,Y,ae,pe,fe,ve,ke,_e,ze,Qe,ht,pt,gt,Vt,vn,gn,zt,an,Wt){var $t=this.length;return this.resize($t+1),this.emplace($t,p,y,E,I,R,O,L,V,q,$,Y,ae,pe,fe,ve,ke,_e,ze,Qe,ht,pt,gt,Vt,vn,gn,zt,an,Wt)}emplace(p,y,E,I,R,O,L,V,q,$,Y,ae,pe,fe,ve,ke,_e,ze,Qe,ht,pt,gt,Vt,vn,gn,zt,an,Wt,$t){var Tt=32*p,Dn=16*p;return this.int16[0+Tt]=y,this.int16[1+Tt]=E,this.int16[2+Tt]=I,this.int16[3+Tt]=R,this.int16[4+Tt]=O,this.int16[5+Tt]=L,this.int16[6+Tt]=V,this.int16[7+Tt]=q,this.uint16[8+Tt]=$,this.uint16[9+Tt]=Y,this.uint16[10+Tt]=ae,this.uint16[11+Tt]=pe,this.uint16[12+Tt]=fe,this.uint16[13+Tt]=ve,this.uint16[14+Tt]=ke,this.uint16[15+Tt]=_e,this.uint16[16+Tt]=ze,this.uint16[17+Tt]=Qe,this.uint16[18+Tt]=ht,this.uint16[19+Tt]=pt,this.uint16[20+Tt]=gt,this.uint16[21+Tt]=Vt,this.uint16[22+Tt]=vn,this.uint32[12+Dn]=gn,this.float32[13+Dn]=zt,this.float32[14+Dn]=an,this.uint16[30+Tt]=Wt,this.uint16[31+Tt]=$t,p}}Nc.prototype.bytesPerElement=64,Cn("StructArrayLayout8i15ui1ul2f2ui64",Nc);class Vw extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(p){var y=this.length;return this.resize(y+1),this.emplace(y,p)}emplace(p,y){return this.float32[+p+0]=y,p}}Vw.prototype.bytesPerElement=4,Cn("StructArrayLayout1f4",Vw);class QN extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(p,y,E){var I=this.length;return this.resize(I+1),this.emplace(I,p,y,E)}emplace(p,y,E,I){var R=3*p;return this.uint16[0+6*p]=y,this.float32[1+R]=E,this.float32[2+R]=I,p}}QN.prototype.bytesPerElement=12,Cn("StructArrayLayout1ui2f12",QN);class Bw extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(p,y,E){var I=this.length;return this.resize(I+1),this.emplace(I,p,y,E)}emplace(p,y,E,I){var R=4*p;return this.uint32[0+2*p]=y,this.uint16[2+R]=E,this.uint16[3+R]=I,p}}Bw.prototype.bytesPerElement=8,Cn("StructArrayLayout1ul2ui8",Bw);class U_ extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(p,y){var E=this.length;return this.resize(E+1),this.emplace(E,p,y)}emplace(p,y,E){var I=2*p;return this.uint16[0+I]=y,this.uint16[1+I]=E,p}}U_.prototype.bytesPerElement=4,Cn("StructArrayLayout2ui4",U_);class Fp extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(p){var y=this.length;return this.resize(y+1),this.emplace(y,p)}emplace(p,y){return this.uint16[+p+0]=y,p}}Fp.prototype.bytesPerElement=2,Cn("StructArrayLayout1ui2",Fp);class CT extends No{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(p,y,E,I){var R=this.length;return this.resize(R+1),this.emplace(R,p,y,E,I)}emplace(p,y,E,I,R){var O=4*p;return this.float32[0+O]=y,this.float32[1+O]=E,this.float32[2+O]=I,this.float32[3+O]=R,p}}CT.prototype.bytesPerElement=16,Cn("StructArrayLayout4f16",CT);class v5 extends Vg{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new D(this.anchorPointX,this.anchorPointY)}}v5.prototype.size=20;class IT extends Lp{get(p){return new v5(this,p)}}Cn("CollisionBoxArray",IT);class ST extends Vg{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(p){this._structArray.uint8[this._pos1+37]=p}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(p){this._structArray.uint8[this._pos1+38]=p}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(p){this._structArray.uint32[this._pos4+10]=p}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ST.prototype.size=48;class Uw extends B_{get(p){return new ST(this,p)}}Cn("PlacedSymbolArray",Uw);class zw extends Vg{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(p){this._structArray.uint32[this._pos4+12]=p}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}zw.prototype.size=64;class AT extends Nc{get(p){return new zw(this,p)}}Cn("SymbolInstanceArray",AT);class OD extends Vw{getoffsetX(p){return this.float32[+p+0]}}Cn("GlyphOffsetArray",OD);class DT extends ET{getx(p){return this.int16[3*p+0]}gety(p){return this.int16[3*p+1]}gettileUnitDistanceFromAnchor(p){return this.int16[3*p+2]}}Cn("SymbolLineVertexArray",DT);class Bg extends Vg{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Bg.prototype.size=12;class PT extends QN{get(p){return new Bg(this,p)}}Cn("TextAnchorOffsetArray",PT);class jw extends Vg{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}jw.prototype.size=8;class z_ extends Bw{get(p){return new jw(this,p)}}Cn("FeatureIndexArray",z_);class ND extends Op{}class Hw extends Op{}class w5 extends Op{}class j_ extends Td{}class RT extends Nw{}class LD extends Np{}class $w extends PD{}class MT extends TT{}class Ug extends Lw{}class FD extends RD{}class kT extends MD{}class OT extends kD{}class Jf extends V_{}class H_ extends U_{}const W7=ta([{name:"a_pos",components:2,type:"Int16"}],4).members;class A{constructor(p=[]){this.segments=p}prepareSegment(p,y,E,I){let R=this.segments[this.segments.length-1];return p>A.MAX_VERTEX_ARRAY_LENGTH&&lt(`Max vertices per segment is ${A.MAX_VERTEX_ARRAY_LENGTH}: bucket requested `+p),(!R||R.vertexLength+p>A.MAX_VERTEX_ARRAY_LENGTH||R.sortKey!==I)&&(R={vertexOffset:y.length,primitiveOffset:E.length,vertexLength:0,primitiveLength:0},void 0!==I&&(R.sortKey=I),this.segments.push(R)),R}get(){return this.segments}destroy(){for(const p of this.segments)for(const y in p.vaos)p.vaos[y].destroy()}static simpleSegment(p,y,E,I){return new A([{vertexOffset:p,primitiveOffset:y,vertexLength:E,primitiveLength:I,vaos:{},sortKey:0}])}}function d(m,p){return 256*(m=Mt(Math.floor(m),0,255))+Mt(Math.floor(p),0,255)}A.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Cn("SegmentVector",A);const _=ta([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);Ip=(Oh={exports:{},exports:function(m,p){for(var y,E=m.length,I=p^E,R=0;4<=E;)y=1540483477*(65535&(y=255&m.charCodeAt(R)|(255&m.charCodeAt(++R))<<8|(255&m.charCodeAt(++R))<<16|(255&m.charCodeAt(++R))<<24))+((1540483477*(y>>>16)&65535)<<16),I=1540483477*(65535&I)+((1540483477*(I>>>16)&65535)<<16)^1540483477*(65535&(y^=y>>>24))+((1540483477*(y>>>16)&65535)<<16),E-=4,++R;switch(E){case 3:I^=(255&m.charCodeAt(R+2))<<16;case 2:I^=(255&m.charCodeAt(R+1))<<8;case 1:I=1540483477*(65535&(I^=255&m.charCodeAt(R)))+((1540483477*(I>>>16)&65535)<<16)}return I=1540483477*(65535&(I^=I>>>13))+((1540483477*(I>>>16)&65535)<<16),(I^=I>>>15)>>>0}}).exports,(ra={exports:{}}).exports=po=(_w={exports:{},exports:function(m,p){for(var y,E,I=3&m.length,R=m.length-I,O=p,L=3432918353,V=461845907,q=0;q<R;)E=255&m.charCodeAt(q)|(255&m.charCodeAt(++q))<<8|(255&m.charCodeAt(++q))<<16|(255&m.charCodeAt(++q))<<24,++q,O=27492+(65535&(y=5*(65535&(O=(O^=E=(65535&(E=(E=(65535&E)*L+(((E>>>16)*L&65535)<<16)&4294967295)<<15|E>>>17))*V+(((E>>>16)*V&65535)<<16)&4294967295)<<13|O>>>19))+((5*(O>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(E=0,I){case 3:E^=(255&m.charCodeAt(q+2))<<16;case 2:E^=(255&m.charCodeAt(q+1))<<8;case 1:O^=E=(65535&(E=(E=(65535&(E^=255&m.charCodeAt(q)))*L+(((E>>>16)*L&65535)<<16)&4294967295)<<15|E>>>17))*V+(((E>>>16)*V&65535)<<16)&4294967295}return O=2246822507*(65535&(O=(O^=m.length)^O>>>16))+((2246822507*(O>>>16)&65535)<<16)&4294967295,O=3266489909*(65535&(O^=O>>>13))+((3266489909*(O>>>16)&65535)<<16)&4294967295,(O^=O>>>16)>>>0}}).exports,ra.exports.murmur3=po,ra.exports.murmur2=Ip;var x=g(ra.exports);class C{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(p,y,E,I){this.ids.push(M(p)),this.positions.push(y,E,I)}getPositions(p){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");var y=M(p);let E=0,I=this.ids.length-1;for(;E<I;){var R=E+I>>1;this.ids[R]>=y?I=R:E=1+R}for(var O=[];this.ids[E]===y;)O.push({index:this.positions[3*E],start:this.positions[3*E+1],end:this.positions[3*E+2]}),E++;return O}static serialize(I,y){var E=new Float64Array(I.ids);return B(E,I=new Uint32Array(I.positions),0,E.length-1),y&&y.push(E.buffer,I.buffer),{ids:E,positions:I}}static deserialize(p){var y=new C;return y.ids=p.ids,y.positions=p.positions,y.indexed=!0,y}}function M(m){var p=+m;return!isNaN(p)&&p<=Number.MAX_SAFE_INTEGER?p:x(String(m))}function B(m,p,y,E){for(;y<E;){var I=m[y+E>>1];let R=y-1,O=E+1;for(;;){for(;m[++R]<I;);for(;m[--O]>I;);if(R>=O)break;U(m,R,O),U(p,3*R,3*O),U(p,3*R+1,3*O+1),U(p,3*R+2,3*O+2)}O-y<E-O?(B(m,p,y,O),y=O+1):(B(m,p,O+1,E),E=O)}}function U(m,p,y){var E=m[p];m[p]=m[y],m[y]=E}Cn("FeaturePositionMap",C);class K{constructor(p,y){this.gl=p.gl,this.location=y}}class re extends K{constructor(p,y){super(p,y),this.current=0}set(p){this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class ce extends K{constructor(p,y){super(p,y),this.current=[0,0,0,0]}set(p){p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3]))}}class ee extends K{constructor(p,y){super(p,y),this.current=wo.transparent}set(p){p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a))}}const he=new Float32Array(16);function Ee(m){return[d(255*m.r,255*m.g),d(255*m.b,255*m.a)]}class Se{constructor(p,y,E){this.value=p,this.uniformNames=y.map(I=>"u_"+I),this.type=E}setUniform(p,y,E){p.set(E.constantOr(this.value))}getBinding(p,y,E){return new("color"===this.type?ee:re)(p,y)}}class Oe{constructor(p,y){this.uniformNames=y.map(E=>"u_"+E),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(p,y){this.pixelRatioFrom=y.pixelRatio,this.pixelRatioTo=p.pixelRatio,this.patternFrom=y.tlbr,this.patternTo=p.tlbr}setUniform(p,y,E,I){(I="u_pattern_to"===I?this.patternTo:"u_pattern_from"===I?this.patternFrom:"u_pixel_ratio_to"===I?this.pixelRatioTo:"u_pixel_ratio_from"===I?this.pixelRatioFrom:null)&&p.set(I)}getBinding(p,y,E){return new("u_pattern"===E.substr(0,9)?ce:re)(p,y)}}class Ae{constructor(p,y,E,I){this.expression=p,this.type=E,this.maxValue=0,this.paintVertexAttributes=y.map(R=>({name:"a_"+R,type:"Float32",components:"color"===E?2:1,offset:0})),this.paintVertexArray=new I}populatePaintArray(p,L,E,I,R){var O=this.paintVertexArray.length;L=this.expression.evaluate(new uo(0),L,{},I,[],R),this.paintVertexArray.resize(p),this._setPaintValue(O,p,L)}updatePaintArray(p,y,E,I){E=this.expression.evaluate({zoom:0},E,I),this._setPaintValue(p,y,E)}_setPaintValue(p,y,E){if("color"===this.type){var I=Ee(E);for(let R=p;R<y;R++)this.paintVertexArray.emplace(R,I[0],I[1])}else{for(let R=p;R<y;R++)this.paintVertexArray.emplace(R,E);this.maxValue=Math.max(this.maxValue,Math.abs(E))}}upload(p){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=p.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class qe{constructor(p,y,E,I,R,O){this.expression=p,this.uniformNames=y.map(L=>`u_${L}_t`),this.type=E,this.useIntegerZoom=I,this.zoom=R,this.maxValue=0,this.paintVertexAttributes=y.map(L=>({name:"a_"+L,type:"Float32",components:"color"===E?4:2,offset:0})),this.paintVertexArray=new O}populatePaintArray(p,L,E,V,R){var O=this.expression.evaluate(new uo(this.zoom),L,{},V,[],R);L=this.expression.evaluate(new uo(this.zoom+1),L,{},V,[],R),V=this.paintVertexArray.length,this.paintVertexArray.resize(p),this._setPaintValue(V,p,O,L)}updatePaintArray(p,y,O,I){var R=this.expression.evaluate({zoom:this.zoom},O,I);O=this.expression.evaluate({zoom:this.zoom+1},O,I),this._setPaintValue(p,y,R,O)}_setPaintValue(p,y,E,I){if("color"===this.type){var R=Ee(E),O=Ee(I);for(let L=p;L<y;L++)this.paintVertexArray.emplace(L,R[0],R[1],O[0],O[1])}else{for(let L=p;L<y;L++)this.paintVertexArray.emplace(L,E,I);this.maxValue=Math.max(this.maxValue,Math.abs(E),Math.abs(I))}}upload(p){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=p.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(p,y){y=this.useIntegerZoom?Math.floor(y.zoom):y.zoom,y=Mt(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1),p.set(y)}getBinding(p,y,E){return new re(p,y)}}class Ge{constructor(p,y,E,I,R,O){this.expression=p,this.type=y,this.useIntegerZoom=E,this.zoom=I,this.layerId=O,this.zoomInPaintVertexArray=new R,this.zoomOutPaintVertexArray=new R}populatePaintArray(p,y,E){var I=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(p),this.zoomOutPaintVertexArray.resize(p),this._setPaintValues(I,p,y.patterns&&y.patterns[this.layerId],E)}updatePaintArray(p,y,E,I,R){this._setPaintValues(p,y,E.patterns&&E.patterns[this.layerId],R)}_setPaintValues(p,y,E,I){if(I&&E){var{min:E,mid:R,max:O}=E,L=I[E],V=I[R],q=I[O];if(L&&V&&q)for(let Y=p;Y<y;Y++)this.zoomInPaintVertexArray.emplace(Y,V.tl[0],V.tl[1],V.br[0],V.br[1],L.tl[0],L.tl[1],L.br[0],L.br[1],V.pixelRatio,L.pixelRatio),this.zoomOutPaintVertexArray.emplace(Y,V.tl[0],V.tl[1],V.br[0],V.br[1],q.tl[0],q.tl[1],q.br[0],q.br[1],V.pixelRatio,q.pixelRatio)}}upload(p){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=p.createVertexBuffer(this.zoomInPaintVertexArray,_.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=p.createVertexBuffer(this.zoomOutPaintVertexArray,_.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ye{constructor(p,y,E){this.binders={},this._buffers=[];var I,R,O,L,V,q,$=[];for(const Y in p.paint._values)E(Y)&&(q=p.paint.get(Y))instanceof Oc&&D_(q.property.specification)&&(I=bt(Y,p.type),R=q.value,O=q.property.specification.type,L=q.property.useIntegerZoom,q="cross-faded"===(q=q.property.specification["property-type"])||"cross-faded-data-driven"===q,"constant"===R.kind?(this.binders[Y]=q?new Oe(R.value,I):new Se(R.value,I,O),$.push("/u_"+Y)):"source"===R.kind||q?(V=yt(Y,O,"source"),this.binders[Y]=q?new Ge(R,O,L,y,V,p.id):new Ae(R,I,O,V),$.push("/a_"+Y)):(q=yt(Y,O,"composite"),this.binders[Y]=new qe(R,I,O,L,y,q),$.push("/z_"+Y)));this.cacheKey=$.sort().join("")}getMaxValue(p){return(p=this.binders[p])instanceof Ae||p instanceof qe?p.maxValue:0}populatePaintArrays(p,y,E,I,R){for(const L in this.binders){var O=this.binders[L];(O instanceof Ae||O instanceof qe||O instanceof Ge)&&O.populatePaintArray(p,y,E,I,R)}}setConstantPatternPositions(p,y){for(const I in this.binders){var E=this.binders[I];E instanceof Oe&&E.setConstantPatternPositions(p,y)}}updatePaintArrays(p,y,E,I,R){let O=!1;for(const $ in p)for(const Y of y.getPositions($)){var L=E.feature(Y.index);for(const ae in this.binders){var V,q=this.binders[ae];(q instanceof Ae||q instanceof qe||q instanceof Ge)&&!0===q.expression.isStateDependent&&(V=I.paint.get(ae),q.expression=V.value,q.updatePaintArray(Y.start,Y.end,L,p[$],R),O=!0)}}return O}defines(){var p=[];for(const E in this.binders){var y=this.binders[E];(y instanceof Se||y instanceof Oe)&&p.push(...y.uniformNames.map(I=>"#define HAS_UNIFORM_"+I))}return p}getBinderAttributes(){var p=[];for(const E in this.binders){var y=this.binders[E];if(y instanceof Ae||y instanceof qe)for(let I=0;I<y.paintVertexAttributes.length;I++)p.push(y.paintVertexAttributes[I].name);else if(y instanceof Ge)for(let I=0;I<_.members.length;I++)p.push(_.members[I].name)}return p}getBinderUniforms(){var p=[];for(const E in this.binders){var y=this.binders[E];if(y instanceof Se||y instanceof Oe||y instanceof qe)for(const I of y.uniformNames)p.push(I)}return p}getPaintVertexBuffers(){return this._buffers}getUniforms(p,y){var E=[];for(const O in this.binders){var I,R=this.binders[O];if(R instanceof Se||R instanceof Oe||R instanceof qe)for(const L of R.uniformNames)y[L]&&(I=R.getBinding(p,y[L],L),E.push({name:L,property:O,binding:I}))}return E}setUniforms(p,y,E,I){for(var{name:R,property:O,binding:L}of y)this.binders[O].setUniform(L,I,E.get(O),R)}updatePaintBuffers(p){this._buffers=[];for(const I in this.binders){var y,E=this.binders[I];p&&E instanceof Ge?(y=2===p.fromScale?E.zoomInPaintVertexBuffer:E.zoomOutPaintVertexBuffer)&&this._buffers.push(y):(E instanceof Ae||E instanceof qe)&&E.paintVertexBuffer&&this._buffers.push(E.paintVertexBuffer)}}upload(p){for(const E in this.binders){var y=this.binders[E];(y instanceof Ae||y instanceof qe||y instanceof Ge)&&y.upload(p)}this.updatePaintBuffers()}destroy(){for(const y in this.binders){var p=this.binders[y];(p instanceof Ae||p instanceof qe||p instanceof Ge)&&p.destroy()}}}class _t{constructor(p,y,E=(()=>!0)){this.programConfigurations={};for(const I of p)this.programConfigurations[I.id]=new Ye(I,y,E);this.needsUpload=!1,this._featureMap=new C,this._bufferOffset=0}populatePaintArrays(p,y,E,I,R,O){for(const L in this.programConfigurations)this.programConfigurations[L].populatePaintArrays(p,y,I,R,O);void 0!==y.id&&this._featureMap.add(y.id,E,this._bufferOffset,p),this._bufferOffset=p,this.needsUpload=!0}updatePaintArrays(p,y,E,I){for(const R of E)this.needsUpload=this.programConfigurations[R.id].updatePaintArrays(p,this._featureMap,y,R,I)||this.needsUpload}get(p){return this.programConfigurations[p]}upload(p){if(this.needsUpload){for(const y in this.programConfigurations)this.programConfigurations[y].upload(p);this.needsUpload=!1}}destroy(){for(const p in this.programConfigurations)this.programConfigurations[p].destroy()}}function bt(m,p){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[m]||[m.replace(p+"-","").replace(/-/g,"_")]}function yt(I,p,y){return(I={"line-pattern":{source:$w,composite:$w},"fill-pattern":{source:$w,composite:$w},"fill-extrusion-pattern":{source:$w,composite:$w}}[I])&&I[y]||{color:{source:Np,composite:CT},number:{source:Vw,composite:Np}}[p][y]}Cn("ConstantBinder",Se),Cn("CrossFadedConstantBinder",Oe),Cn("SourceExpressionBinder",Ae),Cn("CrossFadedCompositeBinder",Ge),Cn("CompositeExpressionBinder",qe),Cn("ProgramConfiguration",Ye,{omit:["_buffers"]}),Cn("ProgramConfigurationSet",_t);const Nt=8192,At=Math.pow(2,14)-1,rn=-At-1;function mn(m){var p=Nt/m.extent,y=m.loadGeometry();for(let L=0;L<y.length;L++){var E=y[L];for(let V=0;V<E.length;V++){var I=E[V],R=Math.round(I.x*p),O=Math.round(I.y*p);I.x=Mt(R,rn,At),I.y=Mt(O,rn,At),(R<I.x||R>I.x+1||O<I.y||O>I.y+1)&&lt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return y}function Fn(m,p){return{type:m.type,id:m.id,properties:m.properties,geometry:p?mn(m):[]}}function er(m,p,y,E,I){m.emplaceBack(2*p+(E+1)/2,2*y+(I+1)/2)}class ur{constructor(p){this.zoom=p.zoom,this.overscaling=p.overscaling,this.layers=p.layers,this.layerIds=this.layers.map(y=>y.id),this.index=p.index,this.hasPattern=!1,this.layoutVertexArray=new Hw,this.indexArray=new Jf,this.segments=new A,this.programConfigurations=new _t(p.layers,p.zoom),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id)}populate(p,y,E){var I,R,O,L,V=this.layers[0],q=[];let $=null,Y=!1;for({feature:I,id:R,index:O,sourceLayerIndex:L}of("circle"===V.type&&($=V.layout.get("circle-sort-key"),Y=!$.isConstant()),p)){var ae,pe=this.layers[0]._featureFilter.needGeometry,fe=Fn(I,pe);this.layers[0]._featureFilter.filter(new uo(this.zoom),fe,E)&&(ae=Y?$.evaluate(fe,{},E):void 0,pe={id:R,properties:I.properties,type:I.type,sourceLayerIndex:L,index:O,geometry:pe?fe.geometry:mn(I),patterns:{},sortKey:ae},q.push(pe))}Y&&q.sort((Qe,ht)=>Qe.sortKey-ht.sortKey);for(const Qe of q){var{geometry:ve,index:ke,sourceLayerIndex:_e}=Qe,ze=p[ke].feature;this.addFeature(Qe,ve,ke,E),y.featureIndex.insert(ze,ve,ke,_e,this.index)}}update(p,y,E){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(p,y,this.stateDependentLayers,E)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(p){this.uploaded||(this.layoutVertexBuffer=p.createVertexBuffer(this.layoutVertexArray,W7),this.indexBuffer=p.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(p),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(p,y,E,I){for(const V of y)for(const q of V){var R=q.x,O=q.y;if(!(R<0||R>=Nt||O<0||O>=Nt)){var L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,p.sortKey);const $=L.vertexLength;er(this.layoutVertexArray,R,O,-1,-1),er(this.layoutVertexArray,R,O,1,-1),er(this.layoutVertexArray,R,O,1,1),er(this.layoutVertexArray,R,O,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+3,$+2),L.vertexLength+=4,L.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,p,E,{},I)}}function Un(m,p){for(let y=0;y<m.length;y++)if(Ti(p,m[y]))return!0;for(let y=0;y<p.length;y++)if(Ti(m,p[y]))return!0;return!!An(m,p)}function qn(m,p){if(1===m.length)return ui(p,m[0]);for(let E=0;E<p.length;E++){var y=p[E];for(let I=0;I<y.length;I++)if(Ti(m,y[I]))return!0}for(let E=0;E<m.length;E++)if(ui(p,m[E]))return!0;for(let E=0;E<p.length;E++)if(An(m,p[E]))return!0;return!1}function An(m,p){var y,E;if(0!==m.length&&0!==p.length)for(let V=0;V<m.length-1;V++){var I=m[V],R=m[V+1];for(let q=0;q<p.length-1;q++){var O=p[q],L=p[q+1];if(E=R,It(y=I,O,L)!==It(E,O,L)&&It(y,E,O)!==It(y,E,L))return 1}}}function xi(m,p,y){var E=y*y;if(1===p.length)return m.distSqr(p[0])<E;for(let I=1;I<p.length;I++)if(ho(m,p[I-1],p[I])<E)return 1}function ho(m,p,y){var E=p.distSqr(y);return 0===E||(E=((m.x-p.x)*(y.x-p.x)+(m.y-p.y)*(y.y-p.y))/E)<0?m.distSqr(p):m.distSqr(1<E?y:y.sub(p)._mult(E)._add(p))}function ui(m,p){let E,I,R,y=!1;for(let O=0;O<m.length;O++)for(let L=0,V=(E=m[O]).length-1;L<E.length;V=L++)I=E[L],R=E[V],I.y>p.y!=R.y>p.y&&p.x<(R.x-I.x)*(p.y-I.y)/(R.y-I.y)+I.x&&(y=!y);return y}function Ti(m,p){let y=!1;for(let R=0,O=m.length-1;R<m.length;O=R++){var E=m[R],I=m[O];E.y>p.y!=I.y>p.y&&p.x<(I.x-E.x)*(p.y-E.y)/(I.y-E.y)+E.x&&(y=!y)}return y}function bo(m,p,y){var E=p.paint.get(m).value;return"constant"===E.kind?E.value:y.programConfigurations.get(p.id).getMaxValue(m)}function Ri(m){return Math.sqrt(m[0]*m[0]+m[1]*m[1])}function no(m,p,y,E,I){if(!p[0]&&!p[1])return m;var R=D.convert(p)._mult(I),O=("viewport"===y&&R._rotate(-E),[]);for(let V=0;V<m.length;V++)O.push(m[V].sub(R));return O}let na,Mh;Cn("CircleBucket",ur,{omit:["layers"]});var ll={get paint(){return Mh=Mh||new cc({"circle-radius":new pr(oe.paint_circle["circle-radius"]),"circle-color":new pr(oe.paint_circle["circle-color"]),"circle-blur":new pr(oe.paint_circle["circle-blur"]),"circle-opacity":new pr(oe.paint_circle["circle-opacity"]),"circle-translate":new Bn(oe.paint_circle["circle-translate"]),"circle-translate-anchor":new Bn(oe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Bn(oe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Bn(oe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new pr(oe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new pr(oe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new pr(oe.paint_circle["circle-stroke-opacity"])})},get layout(){return na=na||new cc({"circle-sort-key":new pr(oe.layout_circle["circle-sort-key"])})}},Cs=1e-6,Ls=typeof Float32Array<"u"?Float32Array:Array;function Vp(){var m=new Ls(9);return Ls!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[5]=0,m[6]=0,m[7]=0),m[0]=1,m[4]=1,m[8]=1,m}function Po(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m}function Dl(m,ze,y){var E=ze[0],I=ze[1],R=ze[2],O=ze[3],L=ze[4],V=ze[5],q=ze[6],$=ze[7],Y=ze[8],ae=ze[9],pe=ze[10],fe=ze[11],ve=ze[12],ke=ze[13],_e=ze[14],Qe=(ze=ze[15],y[0]),ht=y[1],pt=y[2],gt=y[3];return m[0]=Qe*E+ht*L+pt*Y+gt*ve,m[1]=Qe*I+ht*V+pt*ae+gt*ke,m[2]=Qe*R+ht*q+pt*pe+gt*_e,m[3]=Qe*O+ht*$+pt*fe+gt*ze,m[4]=(Qe=y[4])*E+(ht=y[5])*L+(pt=y[6])*Y+(gt=y[7])*ve,m[5]=Qe*I+ht*V+pt*ae+gt*ke,m[6]=Qe*R+ht*q+pt*pe+gt*_e,m[7]=Qe*O+ht*$+pt*fe+gt*ze,m[8]=(Qe=y[8])*E+(ht=y[9])*L+(pt=y[10])*Y+(gt=y[11])*ve,m[9]=Qe*I+ht*V+pt*ae+gt*ke,m[10]=Qe*R+ht*q+pt*pe+gt*_e,m[11]=Qe*O+ht*$+pt*fe+gt*ze,m[12]=(Qe=y[12])*E+(ht=y[13])*L+(pt=y[14])*Y+(gt=y[15])*ve,m[13]=Qe*I+ht*V+pt*ae+gt*ke,m[14]=Qe*R+ht*q+pt*pe+gt*_e,m[15]=Qe*O+ht*$+pt*fe+gt*ze,m}function Hs(){var m=new Ls(3);return Ls!=Float32Array&&(m[0]=0,m[1]=0,m[2]=0),m}function Wo(m,p,y){var E=new Ls(3);return E[0]=m,E[1]=p,E[2]=y,E}function Id(m,O,y){var E=O[0],I=O[1],R=O[2];return m[0]=y[0]*E+y[4]*I+y[8]*R+y[12]*(O=O[3]),m[1]=y[1]*E+y[5]*I+y[9]*R+y[13]*O,m[2]=y[2]*E+y[6]*I+y[10]*R+y[14]*O,m[3]=y[3]*E+y[7]*I+y[11]*R+y[15]*O,m}function Ro(){var m=new Ls(4);return Ls!=Float32Array&&(m[0]=0,m[1]=0,m[2]=0),m[3]=1,m}Math.hypot||(Math.hypot=function(){for(var m=0,p=arguments.length;p--;)m+=arguments[p]*arguments[p];return Math.sqrt(m)}),_w=Dl,Hs(),Oh=new Ls(4),Ls!=Float32Array&&(Oh[0]=0,Oh[1]=0,Oh[2]=0,Oh[3]=0),Hs(),Wo(1,0,0),Wo(0,1,0),Ro(),Ro(),Vp(),po=new Ls(2),Ls!=Float32Array&&(po[0]=0,po[1]=0);class Bp extends Zu{constructor(p){super(p,ll)}createBucket(p){return new ur(p)}queryRadius(p){return bo("circle-radius",this,p)+bo("circle-stroke-width",this,p)+Ri(this.paint.get("circle-translate"))}queryIntersectsFeature(q,$,E,I,R,O,L,V){q=no(q,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),O.angle,L),$=this.paint.get("circle-radius").evaluate($,E)+this.paint.get("circle-stroke-width").evaluate($,E);var m,p,y,Y="map"===this.paint.get("circle-pitch-alignment"),ae=Y?q:function zg(m,p){return m.map(y=>hu(y,p))}(q,V),pe=Y?$*L:$;for(const ke of I)for(const _e of ke){var fe=Y?_e:hu(_e,V);let ze=pe;var ve=Id([],[_e.x,_e.y,0,1],V);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?ze*=ve[3]/O.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(ze*=O.cameraToCenterDistance/ve[3]),y=ze,Ti(m=ae,p=fe)||xi(p,m,y))return!0}return!1}}function hu(m,p){return m=Id([],[m.x,m.y,0,1],p),new D(m[0]/m[3],m[1]/m[3])}class nm extends ur{}let VD;Cn("HeatmapBucket",nm,{omit:["layers"]});var XN={get paint(){return VD=VD||new cc({"heatmap-radius":new pr(oe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new pr(oe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Bn(oe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new F_(oe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Bn(oe.paint_heatmap["heatmap-opacity"])})}};function JN(m,{width:p,height:y},E,I){if(I){if(I instanceof Uint8ClampedArray)I=new Uint8Array(I.buffer);else if(I.length!==p*y*E)throw new RangeError(`mismatched image size. expected: ${I.length} but got: `+p*y*E)}else I=new Uint8Array(p*y*E);return m.width=p,m.height=y,m.data=I,m}function Sd(m,{width:p,height:y},E){var I;p===m.width&&y===m.height||($_(m,I=JN({},{width:p,height:y},E),{x:0,y:0},{x:0,y:0},{width:Math.min(m.width,p),height:Math.min(m.height,y)},E),m.width=p,m.height=y,m.data=I.data)}function $_(m,p,y,E,I,R){if(0!==I.width&&0!==I.height){if(I.width>m.width||I.height>m.height||y.x>m.width-I.width||y.y>m.height-I.height)throw new RangeError("out of range source coordinates for image copy");if(I.width>p.width||I.height>p.height||E.x>p.width-I.width||E.y>p.height-I.height)throw new RangeError("out of range destination coordinates for image copy");var O=m.data,L=p.data;if(O===L)throw new Error("srcData equals dstData, so image is already copied");for(let $=0;$<I.height;$++){var V=((y.y+$)*m.width+y.x)*R,q=((E.y+$)*p.width+E.x)*R;for(let Y=0;Y<I.width*R;Y++)L[q+Y]=O[V+Y]}}}class Qu{constructor(p,y){JN(this,p,1,y)}resize(p){Sd(this,p,1)}clone(){return new Qu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(p,y,E,I,R){$_(p,y,E,I,R,1)}}class kh{constructor(p,y){JN(this,p,4,y)}resize(p){Sd(this,p,4)}replace(p,y){y?this.data.set(p):this.data=p instanceof Uint8ClampedArray?new Uint8Array(p.buffer):p}clone(){return new kh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(p,y,E,I,R){$_(p,y,E,I,R,4)}}function Y7(m){const p={};var y=m.resolution||256,E=m.clips?m.clips.length:1;const I=m.image||new kh({width:y,height:E});if(Math.log(y)/Math.LN2%1!=0)throw new Error("width is not a power of 2 - "+y);var R=($,Y,ae)=>{p[m.evaluationKey]=ae,ae=m.expression.evaluate(p),I.data[$+Y+0]=Math.floor(255*ae.r/ae.a),I.data[$+Y+1]=Math.floor(255*ae.g/ae.a),I.data[$+Y+2]=Math.floor(255*ae.b/ae.a),I.data[$+Y+3]=Math.floor(255*ae.a)};if(m.clips)for(let $=0,Y=0;$<E;++$,Y+=4*y)for(let ae=0,pe=0;ae<y;ae++,pe+=4){var O=ae/(y-1),{start:L,end:V}=m.clips[$];R(Y,pe,L*(1-O)+V*O)}else for(let $=0,Y=0;$<y;$++,Y+=4)R(0,Y,$/(y-1));return I}Cn("AlphaImage",Qu),Cn("RGBAImage",kh);class eL extends Zu{createBucket(p){return new nm(p)}constructor(p){super(p,XN),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(p){"heatmap-color"===p&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Y7({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let Z7;var ja={get paint(){return Z7=Z7||new cc({"hillshade-illumination-direction":new Bn(oe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Bn(oe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Bn(oe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Bn(oe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Bn(oe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Bn(oe.paint_hillshade["hillshade-accent-color"])})}};class Pte extends Zu{constructor(p){super(p,ja)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const b5=ta([{name:"a_pos",components:2,type:"Int16"}],4).members;function E5(m,p,y){y=y||2;var E,I,R,O,L,V=p&&p.length,q=V?p[0]*y:m.length,$=tL(m,0,q,y,!0),Y=[];if($&&$.next!==$.prev){if(V&&($=function(ve,ke,_e,ze){var Qe,ht,gt,vn,gn,zt,Vt=[];for(Qe=0,ht=ke.length;Qe<ht;Qe++)(gt=tL(ve,gt=ke[Qe]*ze,Qe<ht-1?ke[Qe+1]*ze:ve.length,ze,!1))===gt.next&&(gt.steiner=!0),Vt.push(function(vn){for(var gn=vn,zt=vn;(gn.x<zt.x||gn.x===zt.x&&gn.y<zt.y)&&(zt=gn),(gn=gn.next)!==vn;);return zt}(gt));for(Vt.sort(Q7),Qe=0;Qe<Vt.length;Qe++)void 0,_e=(zt=function(an,Wt){var $t,Tt=Wt,Dn=an.x,Tn=an.y,Nn=-1/0;do{if(Tn<=Tt.y&&Tn>=Tt.next.y&&Tt.next.y!==Tt.y){var wr=Tt.x+(Tn-Tt.y)*(Tt.next.x-Tt.x)/(Tt.next.y-Tt.y);if(wr<=Dn&&Nn<wr&&(Nn=wr,$t=Tt.x<Tt.next.x?Tt:Tt.next,wr===Dn))return $t}}while((Tt=Tt.next)!==Wt);if(!$t)return null;var Jr,Ci,mo,Cr=$t,Vi=$t.x,Zn=$t.y,kr=1/0;for(Tt=$t;Dn>=Tt.x&&Tt.x>=Vi&&Dn!==Tt.x&&jg(Tn<Zn?Dn:Nn,Tn,Vi,Zn,Tn<Zn?Nn:Dn,Tn,Tt.x,Tt.y)&&(Jr=Math.abs(Tn-Tt.y)/(Dn-Tt.x),LT(Tt,an))&&(Jr<kr||Jr===kr&&(Tt.x>$t.x||Tt.x===$t.x&&$s((Ci=$t).prev,Ci,(mo=Tt).prev)<0&&$s(mo.next,Ci,Ci.next)<0))&&($t=Tt,kr=Jr),(Tt=Tt.next)!==Cr;);return $t}(vn=Vt[Qe],gn=_e))?(qw(vn=rL(zt,vn),vn.next),qw(zt,zt.next)):gn;return _e}(m,p,$,y)),m.length>80*y){for(var ae=E=m[0],pe=I=m[1],fe=y;fe<q;fe+=y)(R=m[fe])<ae&&(ae=R),(O=m[fe+1])<pe&&(pe=O),E<R&&(E=R),I<O&&(I=O);L=0!==(L=Math.max(E-ae,I-pe))?32767/L:0}BD($,Y,y,ae,pe,L,0)}return Y}function tL(m,p,y,E,I){var R,O;if(I===0<T5(m,p,y,E))for(R=p;R<y;R+=E)O=X7(R,m[R],m[R+1],O);else for(R=y-E;p<=R;R-=E)O=X7(R,m[R],m[R+1],O);return O&&q_(O,O.next)&&(Gw(O),O=O.next),O}function qw(m,p){if(!m)return m;p=p||m;var y,E=m;do{if(y=!1,E.steiner||!q_(E,E.next)&&0!==$s(E.prev,E,E.next))E=E.next;else{if(Gw(E),(E=p=E.prev)===E.next)break;y=!0}}while(y||E!==p);return p}function BD(m,p,y,E,I,R,O){if(m){if(!O&&R){for(var L=m,V=E,q=I,$=R,Y=L;0===Y.z&&(Y.z=x5(Y.x,Y.y,V,q,$)),Y.prevZ=Y.prev,Y.nextZ=Y.next,(Y=Y.next)!==L;);Y.prevZ.nextZ=null,Y.prevZ=null;var ae,pe,fe,ve,ke,_e,ze,Qe,ht=Y,pt=1;do{for(pe=ht,ke=ht=null,_e=0;pe;){for(_e++,fe=pe,ae=ze=0;ae<pt&&(ze++,fe=fe.nextZ);ae++);for(Qe=pt;0<ze||0<Qe&&fe;)0!==ze&&(0===Qe||!fe||pe.z<=fe.z)?(pe=(ve=pe).nextZ,ze--):(fe=(ve=fe).nextZ,Qe--),ke?ke.nextZ=ve:ht=ve,ve.prevZ=ke,ke=ve;pe=fe}}while(ke.nextZ=null,pt*=2,1<_e)}for(var gt,Vt,vn=m;m.prev!==m.next;)if(gt=m.prev,Vt=m.next,R?function(gn,zt,an,Wt){var $t=gn.prev,Tt=gn,Dn=gn.next;if(!(0<=$s($t,Tt,Dn))){for(var Tn=$t.x,Nn=Tt.x,wr=Dn.x,Jr=$t.y,Cr=Tt.y,Vi=Dn.y,Zn=Tn<Nn?Tn<wr?Tn:wr:Nn<wr?Nn:wr,kr=Jr<Cr?Jr<Vi?Jr:Vi:Cr<Vi?Cr:Vi,Ci=Nn<Tn?wr<Tn?Tn:wr:wr<Nn?Nn:wr,mo=Cr<Jr?Vi<Jr?Jr:Vi:Vi<Cr?Cr:Vi,Xu=x5(Zn,kr,zt,an,Wt),Fc=x5(Ci,mo,zt,an,Wt),Mi=gn.prevZ,Ir=gn.nextZ;Mi&&Mi.z>=Xu&&Ir&&Ir.z<=Fc;){if(Mi.x>=Zn&&Mi.x<=Ci&&Mi.y>=kr&&Mi.y<=mo&&Mi!==$t&&Mi!==Dn&&jg(Tn,Jr,Nn,Cr,wr,Vi,Mi.x,Mi.y)&&0<=$s(Mi.prev,Mi,Mi.next)||(Mi=Mi.prevZ,Ir.x>=Zn&&Ir.x<=Ci&&Ir.y>=kr&&Ir.y<=mo&&Ir!==$t&&Ir!==Dn&&jg(Tn,Jr,Nn,Cr,wr,Vi,Ir.x,Ir.y)&&0<=$s(Ir.prev,Ir,Ir.next)))return;Ir=Ir.nextZ}for(;Mi&&Mi.z>=Xu;){if(Mi.x>=Zn&&Mi.x<=Ci&&Mi.y>=kr&&Mi.y<=mo&&Mi!==$t&&Mi!==Dn&&jg(Tn,Jr,Nn,Cr,wr,Vi,Mi.x,Mi.y)&&0<=$s(Mi.prev,Mi,Mi.next))return;Mi=Mi.prevZ}for(;Ir&&Ir.z<=Fc;){if(Ir.x>=Zn&&Ir.x<=Ci&&Ir.y>=kr&&Ir.y<=mo&&Ir!==$t&&Ir!==Dn&&jg(Tn,Jr,Nn,Cr,wr,Vi,Ir.x,Ir.y)&&0<=$s(Ir.prev,Ir,Ir.next))return;Ir=Ir.nextZ}return 1}}(m,E,I,R):function(Wt){var zt=Wt.prev,an=Wt;if(!(0<=$s(zt,an,Wt=Wt.next))){for(var $t=zt.x,Tt=an.x,Dn=Wt.x,Tn=zt.y,Nn=an.y,wr=Wt.y,Jr=$t<Tt?$t<Dn?$t:Dn:Tt<Dn?Tt:Dn,Cr=Tn<Nn?Tn<wr?Tn:wr:Nn<wr?Nn:wr,Vi=Tt<$t?Dn<$t?$t:Dn:Dn<Tt?Tt:Dn,Zn=Nn<Tn?wr<Tn?Tn:wr:wr<Nn?Nn:wr,kr=Wt.next;kr!==zt;){if(kr.x>=Jr&&kr.x<=Vi&&kr.y>=Cr&&kr.y<=Zn&&jg($t,Tn,Tt,Nn,Dn,wr,kr.x,kr.y)&&0<=$s(kr.prev,kr,kr.next))return;kr=kr.next}return 1}}(m))p.push(gt.i/y|0),p.push(m.i/y|0),p.push(Vt.i/y|0),Gw(m),m=Vt.next,vn=Vt.next;else if((m=Vt)===vn){O?1===O?BD(m=function(gn,zt,an){var Wt=gn;do{var $t=Wt.prev,Tt=Wt.next.next}while(!q_($t,Tt)&&UD($t,Wt,Wt.next,Tt)&&LT($t,Tt)&&LT(Tt,$t)&&(zt.push($t.i/an|0),zt.push(Wt.i/an|0),zt.push(Tt.i/an|0),Gw(Wt),Gw(Wt.next),Wt=gn=Tt),(Wt=Wt.next)!==gn);return qw(Wt)}(qw(m),p,y),p,y,E,I,R,2):2===O&&function(gn,zt,an,Wt,$t,Tt){var wr,Jr,Dn=gn;do{for(var Tn,Nn=Dn.next.next;Nn!==Dn.prev;){if(Dn.i!==Nn.i&&(wr=Dn).next.i!==(Jr=Nn).i&&wr.prev.i!==Jr.i&&!function(Cr,Vi){var Zn=Cr;do{if(Zn.i!==Cr.i&&Zn.next.i!==Cr.i&&Zn.i!==Vi.i&&Zn.next.i!==Vi.i&&UD(Zn,Zn.next,Cr,Vi))return 1}while((Zn=Zn.next)!==Cr)}(wr,Jr)&&(LT(wr,Jr)&&LT(Jr,wr)&&function(Cr,Vi){for(var Zn=Cr,kr=!1,Ci=(Cr.x+Vi.x)/2,mo=(Cr.y+Vi.y)/2;Zn.y>mo!=Zn.next.y>mo&&Zn.next.y!==Zn.y&&Ci<(Zn.next.x-Zn.x)*(mo-Zn.y)/(Zn.next.y-Zn.y)+Zn.x&&(kr=!kr),(Zn=Zn.next)!==Cr;);return kr}(wr,Jr)&&($s(wr.prev,wr,Jr.prev)||$s(wr,Jr.prev,Jr))||q_(wr,Jr)&&0<$s(wr.prev,wr,wr.next)&&0<$s(Jr.prev,Jr,Jr.next)))return Tn=rL(Dn,Nn),Dn=qw(Dn,Dn.next),Tn=qw(Tn,Tn.next),BD(Dn,zt,an,Wt,$t,Tt,0),BD(Tn,zt,an,Wt,$t,Tt,0);Nn=Nn.next}}while((Dn=Dn.next)!==gn)}(m,p,y,E,I,R):BD(qw(m),p,y,E,I,R,1);break}}}function Q7(m,p){return m.x-p.x}function x5(m,p,y,E,I){return(m=1431655765&((m=858993459&((m=252645135&((m=16711935&((m=(m-y)*I|0)|m<<8))|m<<4))|m<<2))|m<<1))|(p=1431655765&((p=858993459&((p=252645135&((p=16711935&((p=(p-E)*I|0)|p<<8))|p<<4))|p<<2))|p<<1))<<1}function jg(m,p,y,E,I,R,O,L){return(m-O)*(R-L)<=(I-O)*(p-L)&&(y-O)*(p-L)<=(m-O)*(E-L)&&(I-O)*(E-L)<=(y-O)*(R-L)}function $s(m,p,y){return(p.y-m.y)*(y.x-p.x)-(p.x-m.x)*(y.y-p.y)}function q_(m,p){return m.x===p.x&&m.y===p.y}function UD(m,p,y,E){var I=NT($s(m,p,y)),R=NT($s(m,p,E)),O=NT($s(y,E,m)),L=NT($s(y,E,p));return I!==R&&O!==L||0===I&&nL(m,y,p)||0===R&&nL(m,E,p)||0===O&&nL(y,m,E)||!(0!==L||!nL(y,p,E))}function nL(m,p,y){return p.x<=Math.max(m.x,y.x)&&p.x>=Math.min(m.x,y.x)&&p.y<=Math.max(m.y,y.y)&&p.y>=Math.min(m.y,y.y)}function NT(m){return 0<m?1:m<0?-1:0}function LT(m,p){return $s(m.prev,m,m.next)<0?0<=$s(m,p,m.next)&&0<=$s(m,m.prev,p):$s(m,p,m.prev)<0||$s(m,m.next,p)<0}function rL(m,p){var y=new iL(m.i,m.x,m.y),E=new iL(p.i,p.x,p.y),I=m.next,R=p.prev;return(m.next=p).prev=m,(y.next=I).prev=y,(E.next=y).prev=E,(R.next=E).prev=R,E}function X7(m,p,y,E){return m=new iL(m,p,y),E?(m.next=E.next,(m.prev=E).next.prev=m,E.next=m):(m.prev=m).next=m,m}function Gw(m){m.next.prev=m.prev,m.prev.next=m.next,m.prevZ&&(m.prevZ.nextZ=m.nextZ),m.nextZ&&(m.nextZ.prevZ=m.prevZ)}function iL(m,p,y){this.i=m,this.x=p,this.y=y,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T5(m,p,y,E){for(var I=0,R=p,O=y-E;R<y;R+=E)I+=(m[O]-m[R])*(m[R+1]+m[O+1]),O=R;return I}(Ip={exports:{}}).exports=E5,(Ip.exports.default=E5).deviation=function(m,p,y,E){var I=p&&p.length,O=Math.abs(T5(m,0,I?p[0]*y:m.length,y));if(I)for(var L=0,V=p.length;L<V;L++)O-=Math.abs(T5(m,p[L]*y,L<V-1?p[L+1]*y:m.length,y));var Y=0;for(L=0;L<E.length;L+=3){var ae=E[L]*y,pe=E[L+1]*y,fe=E[L+2]*y;Y+=Math.abs((m[ae]-m[fe])*(m[1+pe]-m[1+ae])-(m[ae]-m[pe])*(m[1+fe]-m[1+ae]))}return 0===O&&0===Y?0:Math.abs((Y-O)/O)},E5.flatten=function(m){for(var p=m[0][0].length,y={vertices:[],holes:[],dimensions:p},E=0,I=0;I<m.length;I++){for(var R=0;R<m[I].length;R++)for(var O=0;O<p;O++)y.vertices.push(m[I][R][O]);0<I&&y.holes.push(E+=m[I-1].length)}return y};var J7=g(Ip.exports);function qae(m,p,y,E,I){!function R(O,L,V,q,$){for(;V<q;){600<q-V&&(Y=q-V+1,ve=L-V+1,pe=Math.log(Y),ae=.5*Math.exp(2*pe/3),pe=.5*Math.sqrt(pe*ae*(Y-ae)/Y)*(ve-Y/2<0?-1:1),R(O,L,Math.max(V,Math.floor(L-ve*ae/Y+pe)),ve=Math.min(q,Math.floor(L+(Y-ve)*ae/Y+pe)),$));var Y,ae,pe,ve,ke=O[L],_e=V,ze=q;for(zD(O,V,L),0<$(O[q],ke)&&zD(O,V,q);_e<ze;){for(zD(O,_e,ze),_e++,ze--;$(O[_e],ke)<0;)_e++;for(;0<$(O[ze],ke);)ze--}0===$(O[V],ke)?zD(O,V,ze):zD(O,++ze,q),ze<=L&&(V=ze+1),L<=ze&&(q=ze-1)}}(m,p,y||0,E||m.length-1,I||Rte)}function zD(m,p,y){var E=m[p];m[p]=m[y],m[y]=E}function Rte(m,p){return m<p?-1:p<m?1:0}function C5(m,p){var y=m.length;if(y<=1)return[m];var E=[];let I,R;for(let L=0;L<y;L++){var O=function(V){let q=0;for(let pe,fe,$=0,Y=V.length,ae=Y-1;$<Y;ae=$++)pe=V[$],fe=V[ae],q+=(fe.x-pe.x)*(pe.y+fe.y);return q}(m[L]);0!==O&&(m[L].area=Math.abs(O),(R=void 0===R?O<0:R)===O<0?(I&&E.push(I),I=[m[L]]):I.push(m[L]))}if(I&&E.push(I),1<p)for(let L=0;L<E.length;L++)E[L].length<=p||(qae(E[L],p,1,E[L].length-1,Mte),E[L]=E[L].slice(0,p));return E}function Mte(m,p){return p.area-m.area}function I5(m,p,y){var E=y.patternDependencies;let I=!1;for(const O of p){var R;(R=O.paint.get(m+"-pattern")).isConstant()||(I=!0),(R=R.constantOr(null))&&(I=!0,E[R.to]=!0,E[R.from]=!0)}return I}function S5(m,p,y,E,I){var R=I.patternDependencies;for(const q of p){var O,L,V=q.paint.get(m+"-pattern").value;"constant"!==V.kind&&(O=V.evaluate({zoom:E-1},y,{},I.availableImages),L=V.evaluate({zoom:E},y,{},I.availableImages),V=V.evaluate({zoom:E+1},y,{},I.availableImages),L=L&&L.name?L.name:L,V=V&&V.name?V.name:V,R[O=O&&O.name?O.name:O]=!0,R[L]=!0,R[V]=!0,y.patterns[q.id]={min:O,mid:L,max:V})}return y}class FT{constructor(p){this.zoom=p.zoom,this.overscaling=p.overscaling,this.layers=p.layers,this.layerIds=this.layers.map(y=>y.id),this.index=p.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new w5,this.indexArray=new Jf,this.indexArray2=new H_,this.programConfigurations=new _t(p.layers,p.zoom),this.segments=new A,this.segments2=new A,this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id)}populate(p,y,E){this.hasPattern=I5("fill",this.layers,y);var I,R,O,L,V=this.layers[0].layout.get("fill-sort-key"),q=!V.isConstant(),$=[];for({feature:I,id:R,index:O,sourceLayerIndex:L}of p){var Y,ae=this.layers[0]._featureFilter.needGeometry,pe=Fn(I,ae);this.layers[0]._featureFilter.filter(new uo(this.zoom),pe,E)&&(Y=q?V.evaluate(pe,{},E,y.availableImages):void 0,ae={id:R,properties:I.properties,type:I.type,sourceLayerIndex:L,index:O,geometry:ae?pe.geometry:mn(I),patterns:{},sortKey:Y},$.push(ae))}q&&$.sort((ze,Qe)=>ze.sortKey-Qe.sortKey);for(const ze of $){var{geometry:fe,index:ve,sourceLayerIndex:ke}=ze,_e=(this.hasPattern?(_e=S5("fill",this.layers,ze,this.zoom,y),this.patternFeatures.push(_e)):this.addFeature(ze,fe,ve,E,{}),p[ve].feature);y.featureIndex.insert(_e,fe,ve,ke,this.index)}}update(p,y,E){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(p,y,this.stateDependentLayers,E)}addFeatures(p,y,E){for(const I of this.patternFeatures)this.addFeature(I,I.geometry,I.index,y,E)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(p){this.uploaded||(this.layoutVertexBuffer=p.createVertexBuffer(this.layoutVertexArray,b5),this.indexBuffer=p.createIndexBuffer(this.indexArray),this.indexBuffer2=p.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(p),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(p,y,E,I,R){for(const pe of C5(y,500)){let fe=0;for(const ve of pe)fe+=ve.length;var O=this.segments.prepareSegment(fe,this.layoutVertexArray,this.indexArray),L=O.vertexLength,V=[],q=[];for(const ve of pe)if(0!==ve.length){ve!==pe[0]&&q.push(V.length/2);var $=this.segments2.prepareSegment(ve.length,this.layoutVertexArray,this.indexArray2),Y=$.vertexLength;this.layoutVertexArray.emplaceBack(ve[0].x,ve[0].y),this.indexArray2.emplaceBack(Y+ve.length-1,Y),V.push(ve[0].x),V.push(ve[0].y);for(let ke=1;ke<ve.length;ke++)this.layoutVertexArray.emplaceBack(ve[ke].x,ve[ke].y),this.indexArray2.emplaceBack(Y+ke-1,Y+ke),V.push(ve[ke].x),V.push(ve[ke].y);$.vertexLength+=ve.length,$.primitiveLength+=ve.length}var ae=J7(V,q);for(let ve=0;ve<ae.length;ve+=3)this.indexArray.emplaceBack(L+ae[ve],L+ae[ve+1],L+ae[ve+2]);O.vertexLength+=fe,O.primitiveLength+=ae.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,p,E,R,I)}}let eK,tK;Cn("FillBucket",FT,{omit:["layers","patternFeatures"]});var kte={get paint(){return tK=tK||new cc({"fill-antialias":new Bn(oe.paint_fill["fill-antialias"]),"fill-opacity":new pr(oe.paint_fill["fill-opacity"]),"fill-color":new pr(oe.paint_fill["fill-color"]),"fill-outline-color":new pr(oe.paint_fill["fill-outline-color"]),"fill-translate":new Bn(oe.paint_fill["fill-translate"]),"fill-translate-anchor":new Bn(oe.paint_fill["fill-translate-anchor"]),"fill-pattern":new kp(oe.paint_fill["fill-pattern"])})},get layout(){return eK=eK||new cc({"fill-sort-key":new pr(oe.layout_fill["fill-sort-key"])})}};class A5 extends Zu{constructor(p){super(p,kte)}recalculate(p,y){super.recalculate(p,y),"constant"===(p=this.paint._values["fill-outline-color"]).value.kind&&void 0===p.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(p){return new FT(p)}queryRadius(){return Ri(this.paint.get("fill-translate"))}queryIntersectsFeature(p,y,E,I,R,O,L){return qn(no(p,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),O.angle,L),I)}isTileClipped(){return!0}}ra=ta([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4);const Ote=ta([{name:"a_centroid",components:2,type:"Int16"}],4),Nte=ra.members;var G_={},Lte=w;function Kw(m,p,y,E,I){this.properties={},this.extent=y,this.type=0,this._pbf=m,this._geometry=-1,this._keys=E,this._values=I,m.readFields(Fte,this,p)}function Fte(m,p,y){if(1==m)p.id=y.readVarint();else if(2==m)for(var E=y,I=p,R=E.readVarint()+E.pos;E.pos<R;){var O=I._keys[E.readVarint()],L=I._values[E.readVarint()];I.properties[O]=L}else 3==m?p.type=y.readVarint():4==m&&(p._geometry=y.pos)}Oh=Kw,Kw.types=["Unknown","Point","LineString","Polygon"],Kw.prototype.loadGeometry=function(){for(var m,p,y=this._pbf,E=(y.pos=this._geometry,y.readVarint()+y.pos),I=1,R=0,O=0,L=0,V=[];y.pos<E;)if(R<=0&&(I=7&(p=y.readVarint()),R=p>>3),R--,1===I||2===I)O+=y.readSVarint(),L+=y.readSVarint(),1===I&&(m&&V.push(m),m=[]),m.push(new Lte(O,L));else{if(7!==I)throw new Error("unknown command "+I);m&&m.push(m[0].clone())}return m&&V.push(m),V},Kw.prototype.bbox=function(){for(var m,p=this._pbf,y=(p.pos=this._geometry,p.readVarint()+p.pos),E=1,I=0,R=0,O=0,L=1/0,V=-1/0,q=1/0,$=-1/0;p.pos<y;)if(I<=0&&(E=7&(m=p.readVarint()),I=m>>3),I--,1===E||2===E)(R+=p.readSVarint())<L&&(L=R),V<R&&(V=R),(O+=p.readSVarint())<q&&(q=O),$<O&&($=O);else if(7!==E)throw new Error("unknown command "+E);return[L,q,V,$]},Kw.prototype.toGeoJSON=function(m,p,V){var E,I=this.extent*Math.pow(2,V),R=this.extent*m,O=this.extent*p,L=this.loadGeometry();function q(ae){for(var pe=0;pe<ae.length;pe++){var fe=ae[pe];ae[pe]=[360*(fe.x+R)/I-180,360/Math.PI*Math.atan(Math.exp((180-360*(fe.y+O)/I)*Math.PI/180))-90]}}switch(V=Kw.types[this.type],this.type){case 1:for(var $=[],Y=0;Y<L.length;Y++)$[Y]=L[Y][0];q(L=$);break;case 2:for(Y=0;Y<L.length;Y++)q(L[Y]);break;case 3:for(L=function(ae){var pe=ae.length;if(pe<=1)return[ae];for(var fe,ve,ke=[],_e=0;_e<pe;_e++){var ze=function(Qe){for(var ht,pt,gt=0,Vt=0,vn=Qe.length,gn=vn-1;Vt<vn;gn=Vt++)gt+=((pt=Qe[gn]).x-(ht=Qe[Vt]).x)*(ht.y+pt.y);return gt}(ae[_e]);0!==ze&&((ve=void 0===ve?ze<0:ve)===ze<0?(fe&&ke.push(fe),fe=[ae[_e]]):fe.push(ae[_e]))}return fe&&ke.push(fe),ke}(L),Y=0;Y<L.length;Y++)for(E=0;E<L[Y].length;E++)q(L[Y][E])}return 1===L.length?L=L[0]:V="Multi"+V,m={type:"Feature",geometry:{type:V,coordinates:L},properties:this.properties},"id"in this&&(m.id=this.id),m};var Gae=Oh;function oL(m,p){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=m,this._keys=[],this._values=[],this._features=[],m.readFields(Kae,this,p),this.length=this._features.length}function Kae(m,p,y){15===m?p.version=y.readVarint():1===m?p.name=y.readString():5===m?p.extent=y.readVarint():2===m?p._features.push(y.pos):3===m?p._keys.push(y.readString()):4===m&&p._values.push(function(E){for(var I=null,R=E.readVarint()+E.pos;E.pos<R;){var O=E.readVarint()>>3;I=1==O?E.readString():2==O?E.readFloat():3==O?E.readDouble():4==O?E.readVarint64():5==O?E.readVarint():6==O?E.readSVarint():7==O?E.readBoolean():null}return I}(y))}po=oL,oL.prototype.feature=function(m){if(m<0||m>=this._features.length)throw new Error("feature index out of bounds");return this._pbf.pos=this._features[m],m=this._pbf.readVarint()+this._pbf.pos,new Gae(this._pbf,m,this.extent,this._keys,this._values)};var D5=po;function Wae(m,p,y){3===m&&(m=new D5(y,y.readVarint()+y.pos)).length&&(p[m.name]=m)}G_.VectorTile=function(m,p){this.layers=m.readFields(Wae,{},p)},G_.VectorTileFeature=Oh,G_.VectorTileLayer=po;const P5=G_.VectorTileFeature.types,nK=Math.pow(2,13);function Ww(m,p,y,E,I,R,O,L){m.emplaceBack(p,y,2*Math.floor(E*nK)+O,I*nK*2,R*nK*2,Math.round(L))}class jD{constructor(p){this.zoom=p.zoom,this.overscaling=p.overscaling,this.layers=p.layers,this.layerIds=this.layers.map(y=>y.id),this.index=p.index,this.hasPattern=!1,this.layoutVertexArray=new j_,this.centroidVertexArray=new ND,this.indexArray=new Jf,this.programConfigurations=new _t(p.layers,p.zoom),this.segments=new A,this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id)}populate(p,y,E){for(var{feature:I,id:R,index:O,sourceLayerIndex:L}of(this.features=[],this.hasPattern=I5("fill-extrusion",this.layers,y),p)){var V=this.layers[0]._featureFilter.needGeometry,q=Fn(I,V);this.layers[0]._featureFilter.filter(new uo(this.zoom),q,E)&&(R={id:R,sourceLayerIndex:L,index:O,geometry:V?q.geometry:mn(I),properties:I.properties,type:I.type,patterns:{}},this.hasPattern?this.features.push(S5("fill-extrusion",this.layers,R,this.zoom,y)):this.addFeature(R,R.geometry,O,E,{}),y.featureIndex.insert(I,R.geometry,O,L,this.index,!0))}}addFeatures(p,y,E){for(const R of this.features)this.addFeature(R,R.geometry,R.index,y,E)}update(p,y,E){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(p,y,this.stateDependentLayers,E)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(p){this.uploaded||(this.layoutVertexBuffer=p.createVertexBuffer(this.layoutVertexArray,Nte),this.centroidVertexBuffer=p.createVertexBuffer(this.centroidVertexArray,Ote.members,!0),this.indexBuffer=p.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(p),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(p,y,E,I,R){var m,O={x:0,y:0,vertexCount:0};for(const ke of C5(y,500)){let _e=0;for(const Qe of ke)_e+=Qe.length;let ze=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Qe of ke)if(0!==Qe.length&&!((m=Qe).every(p=>p.x<0)||m.every(p=>p.x>Nt)||m.every(p=>p.y<0)||m.every(p=>p.y>Nt))){let ht=0;for(let pt=0;pt<Qe.length;pt++){var L,V,q,$=Qe[pt];1<=pt&&(R5($,L=Qe[pt-1])||(ze.vertexLength+4>A.MAX_VERTEX_ARRAY_LENGTH&&(ze=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)),V=$.sub(L)._perp()._unit(),32768<ht+(q=L.dist($))&&(ht=0),Ww(this.layoutVertexArray,$.x,$.y,V.x,V.y,0,0,ht),Ww(this.layoutVertexArray,$.x,$.y,V.x,V.y,0,1,ht),O.x+=2*$.x,O.y+=2*$.y,O.vertexCount+=2,ht+=q,Ww(this.layoutVertexArray,L.x,L.y,V.x,V.y,0,0,ht),Ww(this.layoutVertexArray,L.x,L.y,V.x,V.y,0,1,ht),O.x+=2*L.x,O.y+=2*L.y,O.vertexCount+=2,this.indexArray.emplaceBack($=ze.vertexLength,$+2,$+1),this.indexArray.emplaceBack($+1,$+2,$+3),ze.vertexLength+=4,ze.primitiveLength+=2))}}if(ze.vertexLength+_e>A.MAX_VERTEX_ARRAY_LENGTH&&(ze=this.segments.prepareSegment(_e,this.layoutVertexArray,this.indexArray)),"Polygon"===P5[p.type]){var Y=[],ae=[],pe=ze.vertexLength;for(const Qe of ke)if(0!==Qe.length){Qe!==ke[0]&&ae.push(Y.length/2);for(let ht=0;ht<Qe.length;ht++){var fe=Qe[ht];Ww(this.layoutVertexArray,fe.x,fe.y,0,0,1,1,0),O.x+=fe.x,O.y+=fe.y,O.vertexCount+=1,Y.push(fe.x),Y.push(fe.y)}}var ve=J7(Y,ae);for(let Qe=0;Qe<ve.length;Qe+=3)this.indexArray.emplaceBack(pe+ve[Qe],pe+ve[Qe+2],pe+ve[Qe+1]);ze.primitiveLength+=ve.length/3,ze.vertexLength+=_e}}for(let ke=0;ke<O.vertexCount;ke++)this.centroidVertexArray.emplaceBack(Math.floor(O.x/O.vertexCount),Math.floor(O.y/O.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,p,E,R,I)}}function R5(m,p){return m.x===p.x&&(m.x<0||m.x>Nt)||m.y===p.y&&(m.y<0||m.y>Nt)}let sL;Cn("FillExtrusionBucket",jD,{omit:["layers","features"]});var Zae={get paint(){return sL=sL||new cc({"fill-extrusion-opacity":new Bn(oe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new pr(oe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Bn(oe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Bn(oe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new kp(oe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new pr(oe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new pr(oe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Bn(oe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Yw extends Zu{constructor(p){super(p,Zae)}createBucket(p){return new jD(p)}queryRadius(){return Ri(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(p,y,E,I,R,O,L,V){return p=no(p,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),O.angle,L),L=this.paint.get("fill-extrusion-height").evaluate(y,E),y=this.paint.get("fill-extrusion-base").evaluate(y,E),E=function M5(m,p,y,E){var I=[];for(const O of m){var R=[O.x,O.y,E,1];Id(R,R,p),I.push(new D(R[0]/R[3],R[1]/R[3]))}return I}(p,V,0,0),p=function Bte(m,p,y,E){var I=[],R=[],O=E[8]*p,L=E[9]*p,V=E[10]*p,q=E[11]*p,$=E[8]*y,Y=E[9]*y,ae=E[10]*y,pe=E[11]*y;for(const vn of m){var fe=[],ve=[];for(const gn of vn){var gt=E[0]*(pt=gn.x)+E[4]*(ke=gn.y)+E[12],Vt=E[1]*pt+E[5]*ke+E[13],ht=E[2]*pt+E[6]*ke+E[14],pt=E[3]*pt+E[7]*ke+E[15],ke=ht+V,_e=pt+q,ze=gt+$,Qe=Vt+Y;ht+=ae,pt+=pe,((gt=new D((gt+O)/_e,(Vt+L)/_e)).z=ke/_e,fe.push(gt),Vt=new D(ze/pt,Qe/pt)).z=ht/pt,ve.push(Vt)}I.push(fe),R.push(ve)}return[I,R]}(I,y,L,V),function Vte(m,p,y){let E=1/0;qn(y,p)&&(E=rK(y,p[0]));for(let q=0;q<p.length;q++){var I=p[q],R=m[q];for(let $=0;$<I.length-1;$++){var V,O=I[$];Un(y,V=[O,V=I[$+1],R[$+1],R[$],O])&&(E=Math.min(E,rK(y,V)))}}return E!==1/0&&E}(p[0],p[1],E)}}function Zw(m,p){return m.x*p.x+m.y*p.y}function rK(m,p){if(1===m.length){let $=0;var y=p[$++];let Y;for(;!Y||y.equals(Y);)if(!(Y=p[$++]))return 1/0;for(;$<p.length;$++){var E=p[$],q=m[0],R=Y.sub(y),O=E.sub(y),V=(q=q.sub(y),Zw(R,R)),I=Zw(R,O),L=Zw(O,O);if(R=Zw(q,R),q=Zw(q,O),q=y.z*(1-(L=(L*R-I*q)/(O=V*L-I*I))-(V=(V*q-I*R)/O))+Y.z*L+E.z*V,isFinite(q))return q}return 1/0}{let $=1/0;for(const Y of p)$=Math.min($,Y.z);return $}}const iK=ta([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Ute=ta([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,zte=G_.VectorTileFeature.types,k5=Math.cos(Math.PI/180*37.5),jte=Math.pow(2,14)/.5;class HD{constructor(p){this.zoom=p.zoom,this.overscaling=p.overscaling,this.layers=p.layers,this.layerIds=this.layers.map(y=>y.id),this.index=p.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(y=>{this.gradients[y.id]={}}),this.layoutVertexArray=new RT,this.layoutVertexArray2=new LD,this.indexArray=new Jf,this.programConfigurations=new _t(p.layers,p.zoom),this.segments=new A,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id)}populate(p,y,E){this.hasPattern=I5("line",this.layers,y);var I,R,O,L,V=this.layers[0].layout.get("line-sort-key"),q=!V.isConstant(),$=[];for({feature:I,id:R,index:O,sourceLayerIndex:L}of p){var Y,ae=this.layers[0]._featureFilter.needGeometry,pe=Fn(I,ae);this.layers[0]._featureFilter.filter(new uo(this.zoom),pe,E)&&(Y=q?V.evaluate(pe,{},E):void 0,ae={id:R,properties:I.properties,type:I.type,sourceLayerIndex:L,index:O,geometry:ae?pe.geometry:mn(I),patterns:{},sortKey:Y},$.push(ae))}q&&$.sort((ze,Qe)=>ze.sortKey-Qe.sortKey);for(const ze of $){var{geometry:fe,index:ve,sourceLayerIndex:ke}=ze,_e=(this.hasPattern?(_e=S5("line",this.layers,ze,this.zoom,y),this.patternFeatures.push(_e)):this.addFeature(ze,fe,ve,E,{}),p[ve].feature);y.featureIndex.insert(_e,fe,ve,ke,this.index)}}update(p,y,E){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(p,y,this.stateDependentLayers,E)}addFeatures(p,y,E){for(const I of this.patternFeatures)this.addFeature(I,I.geometry,I.index,y,E)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(p){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=p.createVertexBuffer(this.layoutVertexArray2,Ute)),this.layoutVertexBuffer=p.createVertexBuffer(this.layoutVertexArray,iK),this.indexBuffer=p.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(p),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(p){if(p.properties&&Object.prototype.hasOwnProperty.call(p.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(p.properties,"mapbox_clip_end"))return{start:+p.properties.mapbox_clip_start,end:+p.properties.mapbox_clip_end}}addFeature(p,y,E,I,R){var O=this.layers[0].layout,L=O.get("line-join").evaluate(p,{}),V=O.get("line-cap"),q=O.get("line-miter-limit"),$=O.get("line-round-limit");this.lineClips=this.lineFeatureClips(p);for(const Y of y)this.addLine(Y,p,L,V,q,$);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,p,E,R,I)}addLine(p,y,E,I,R,O){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Vt=0;Vt<p.length-1;Vt++)this.totalDistance+=p[Vt].dist(p[Vt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}var L="Polygon"===zte[y.type];let V=p.length;for(;2<=V&&p[V-1].equals(p[V-2]);)V--;let q=0;for(;q<V-1&&p[q].equals(p[q+1]);)q++;if(!(V<(L?3:2))){"bevel"===E&&(R=1.05);var $,Y=this.overscaling<=16?15*Nt/(512*this.overscaling):0,ae=this.segments.prepareSegment(10*V,this.layoutVertexArray,this.indexArray);let Vt,vn,gn,zt;this.e1=this.e2=-1,L&&(Vt=p[V-2],zt=p[q].sub(Vt)._unit()._perp());for(let an=q;an<V;an++)if(!($=an===V-1?L?p[q+1]:void 0:p[an+1])||!p[an].equals($)){zt&&(gn=zt),Vt&&(vn=Vt),Vt=p[an],zt=$?$.sub(Vt)._unit()._perp():gn;let Wt=(gn=gn||zt).add(zt);0===Wt.x&&0===Wt.y||Wt._unit();var ke,pe=gn.x*zt.x+gn.y*zt.y,fe=0!=(ke=Wt.x*zt.x+Wt.y*zt.y)?1/ke:1/0,ve=2*Math.sqrt(2-2*ke),_e=0<gn.x*zt.y-gn.y*zt.x,ze=((ke=ke<k5&&vn&&$)&&an>q&&2*Y<(ze=Vt.dist(vn))&&(ze=Vt.sub(Vt.sub(vn)._mult(Y/ze)._round()),this.updateDistance(vn,ze),this.addCurrentVertex(ze,gn,0,0,ae),vn=ze),vn&&$);let $t=ze?E:L?"butt":I;if(ze&&"round"===$t&&(fe<O?$t="miter":fe<=2&&($t="fakeround")),"bevel"===($t="miter"===$t&&R<fe?"bevel":$t)&&(2<fe&&($t="flipbevel"),fe<R)&&($t="miter"),vn&&this.updateDistance(vn,Vt),"miter"===$t)Wt._mult(fe),this.addCurrentVertex(Vt,Wt,0,0,ae);else if("flipbevel"===$t)100<fe?Wt=zt.mult(-1):(Qe=fe*gn.add(zt).mag()/gn.sub(zt).mag(),Wt._perp()._mult(Qe*(_e?-1:1))),this.addCurrentVertex(Vt,Wt,0,0,ae),this.addCurrentVertex(Vt,Wt.mult(-1),0,0,ae);else if("bevel"===$t||"fakeround"===$t){var Qe=-Math.sqrt(fe*fe-1),ht=(fe=_e?Qe:0,_e?0:Qe);if(vn&&this.addCurrentVertex(Vt,gn,fe,ht,ae),"fakeround"===$t){var pt=Math.round(180*ve/Math.PI/20);for(let Dn=1;Dn<pt;Dn++){let Tn=Dn/pt;.5!==Tn&&(Tn+=Tn*(gt=Tn-.5)*(Tn-1)*((1.0904+pe*(pe*(3.55645-1.43519*pe)-3.2452))*gt*gt+(.848013+pe*(.215638*pe-1.06021))));var gt=zt.sub(gn)._mult(Tn)._add(gn)._unit()._mult(_e?-1:1);this.addHalfVertex(Vt,gt.x,gt.y,!1,_e,0,ae)}}$&&this.addCurrentVertex(Vt,zt,-fe,-ht,ae)}else"butt"===$t?this.addCurrentVertex(Vt,Wt,0,0,ae):"square"===$t?this.addCurrentVertex(Vt,Wt,ve=vn?1:-1,ve,ae):"round"===$t&&(vn&&(this.addCurrentVertex(Vt,gn,0,0,ae),this.addCurrentVertex(Vt,gn,1,1,ae,!0)),$)&&(this.addCurrentVertex(Vt,zt,-1,-1,ae,!0),this.addCurrentVertex(Vt,zt,0,0,ae));ke&&an<V-1&&2*Y<(fe=Vt.dist($))&&(ht=Vt.add($.sub(Vt)._mult(Y/fe)._round()),this.updateDistance(Vt,ht),this.addCurrentVertex(ht,zt,0,0,ae),Vt=ht)}}}addCurrentVertex(p,y,E,I,R,O=!1){var q=y.y*I-y.x,$=-y.y-y.x*I;this.addHalfVertex(p,y.x+y.y*E,y.y-y.x*E,O,!1,E,R),this.addHalfVertex(p,q,$,O,!0,-I,R),this.distance>jte/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(p,y,E,I,R,O))}addHalfVertex({x:p,y:$},E,I,R,O,L,V){var q=.5*(this.lineClips?this.scaledDistance*(jte-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((p<<1)+(R?1:0),($<<1)+(O?1:0),Math.round(63*E)+128,Math.round(63*I)+128,1+(0===L?0:L<0?-1:1)|(63&q)<<2,q>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((p=this.scaledDistance-this.lineClips.start)/(R=this.lineClips.end-this.lineClips.start),this.lineClipsArray.length),$=V.vertexLength++,0<=this.e1&&0<=this.e2&&(this.indexArray.emplaceBack(this.e1,this.e2,$),V.primitiveLength++),O?this.e2=$:this.e1=$}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(p,y){this.distance+=p.dist(y),this.updateScaledDistance()}}let Hte,aL;Cn("LineBucket",HD,{omit:["layers","patternFeatures"]});var lL={get paint(){return aL=aL||new cc({"line-opacity":new pr(oe.paint_line["line-opacity"]),"line-color":new pr(oe.paint_line["line-color"]),"line-translate":new Bn(oe.paint_line["line-translate"]),"line-translate-anchor":new Bn(oe.paint_line["line-translate-anchor"]),"line-width":new pr(oe.paint_line["line-width"]),"line-gap-width":new pr(oe.paint_line["line-gap-width"]),"line-offset":new pr(oe.paint_line["line-offset"]),"line-blur":new pr(oe.paint_line["line-blur"]),"line-dasharray":new bT(oe.paint_line["line-dasharray"]),"line-pattern":new kp(oe.paint_line["line-pattern"]),"line-gradient":new F_(oe.paint_line["line-gradient"])})},get layout(){return Hte=Hte||new cc({"line-cap":new Bn(oe.layout_line["line-cap"]),"line-join":new pr(oe.layout_line["line-join"]),"line-miter-limit":new Bn(oe.layout_line["line-miter-limit"]),"line-round-limit":new Bn(oe.layout_line["line-round-limit"]),"line-sort-key":new pr(oe.layout_line["line-sort-key"])})}};class $te extends pr{possiblyEvaluate(p,y){return y=new uo(Math.floor(y.zoom),{now:y.now,fadeDuration:y.fadeDuration,zoomHistory:y.zoomHistory,transition:y.transition}),super.possiblyEvaluate(p,y)}evaluate(p,y,E,I){return y=Qt({},y,{zoom:Math.floor(y.zoom)}),super.evaluate(p,y,E,I)}}let Qw;class qte extends Zu{constructor(p){super(p,lL),this.gradientVersion=0,Qw||((Qw=new $te(lL.paint.properties["line-width"].specification)).useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(p){"line-gradient"===p&&(this.stepInterpolant=!!function Ei(m){return void 0!==m._styleExpression}(p=this.gradientExpression())&&p._styleExpression.expression instanceof Pg,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(p,y){super.recalculate(p,y),this.paint._values["line-floorwidth"]=Qw.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,p)}createBucket(p){return new HD(p)}queryRadius(E){var y=oK(bo("line-width",this,E),bo("line-gap-width",this,E));return E=bo("line-offset",this,E),y/2+Math.abs(E)+Ri(this.paint.get("line-translate"))}queryIntersectsFeature(p,y,E,I,R,O,L){return p=no(p,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),O.angle,L),O=L/2*oK(this.paint.get("line-width").evaluate(y,E),this.paint.get("line-gap-width").evaluate(y,E)),function Dr(m,p,y){for(let I=0;I<p.length;I++){var E=p[I];if(3<=m.length)for(let R=0;R<E.length;R++)if(Ti(m,E[R]))return!0;if(function(R,O,L){if(1<R.length){if(An(R,O))return 1;for(let V=0;V<O.length;V++)if(xi(O[V],R,L))return 1}for(let V=0;V<R.length;V++)if(xi(R[V],O,L))return 1}(m,E,y))return!0}return!1}(p,I=(y=this.paint.get("line-offset").evaluate(y,E))?function Al(m,p){var y=[];for(let V=0;V<m.length;V++){var E=m[V],I=[];for(let q=0;q<E.length;q++){var O=E[q-1],R=E[q],L=E[q+1];O=0===q?new D(0,0):R.sub(O)._unit()._perp(),L=q===E.length-1?new D(0,0):L.sub(R)._unit()._perp(),0!=(L=(O=O._add(L)._unit()).x*L.x+O.y*L.y)&&O._mult(1/L),I.push(O._mult(p)._add(R))}y.push(I)}return y}(I,y*L):I,O)}isTileClipped(){return!0}}function oK(m,p){return 0<p?p+2*m:m}const O5=ta([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),N5=ta([{name:"a_projected_pos",components:3,type:"Float32"}],4),L5=(ta([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ta([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Gte=(ta([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),ta([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4));function Kte(m,p,y){return m.sections.forEach(E=>{var I,R;E.text=(E=E.text,R=y,"uppercase"===(I=(I=p).layout.get("text-transform").evaluate(R,{}))?E=E.toLocaleUpperCase():"lowercase"===I&&(E=E.toLocaleLowerCase()),E=Lg.applyArabicShaping?Lg.applyArabicShaping(E):E)}),m}Ip=ta([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4),ta([{name:"triangle",components:3,type:"Uint16"}]),ta([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ta([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ta([{type:"Float32",name:"offsetX"}]),ta([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ta([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const VT={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var Sa=24,cL=(Oh=fo,ra={read:function(m,p,y,E,pe){var R,O,L=8*pe-E-1,V=(1<<L)-1,q=V>>1,$=-7,Y=y?pe-1:0,ae=y?-1:1;for(pe=m[p+Y],Y+=ae,R=pe&(1<<-$)-1,pe>>=-$,$+=L;0<$;R=256*R+m[p+Y],Y+=ae,$-=8);for(O=R&(1<<-$)-1,R>>=-$,$+=E;0<$;O=256*O+m[p+Y],Y+=ae,$-=8);if(0===R)R=1-q;else{if(R===V)return O?NaN:1/0*(pe?-1:1);O+=Math.pow(2,E),R-=q}return(pe?-1:1)*O*Math.pow(2,R-E)},write:function(m,p,y,E,I,fe){var O,L,V=8*fe-I-1,q=(1<<V)-1,$=q>>1,Y=23===I?Math.pow(2,-24)-Math.pow(2,-77):0,ae=E?0:fe-1,pe=E?1:-1;for(fe=p<0||0===p&&1/p<0?1:0,p=Math.abs(p),isNaN(p)||p===1/0?(L=isNaN(p)?1:0,O=q):(O=Math.floor(Math.log(p)/Math.LN2),p*(E=Math.pow(2,-O))<1&&(O--,E*=2),2<=(p+=1<=O+$?Y/E:Y*Math.pow(2,1-$))*E&&(O++,E/=2),q<=O+$?(L=0,O=q):1<=O+$?(L=(p*E-1)*Math.pow(2,I),O+=$):(L=p*Math.pow(2,$-1)*Math.pow(2,I),O=0));8<=I;m[y+ae]=255&L,ae+=pe,L/=256,I-=8);for(O=O<<I|L,V+=I;0<V;m[y+ae]=255&O,ae+=pe,O/=256,V-=8);m[y+ae-pe]|=128*fe}});function fo(m){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(m)?m:new Uint8Array(m||0),this.pos=0,this.type=0,this.length=this.buf.length}fo.Varint=0,fo.Fixed64=1,fo.Bytes=2,fo.Fixed32=5;var aK=4294967296,lK=1/aK,uL=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function K_(m){return m.type===fo.Bytes?m.readVarint()+m.pos:m.pos+1}function F5(m,p,y){var E=p<=16383?1:p<=2097151?2:p<=268435455?3:Math.floor(Math.log(p)/(7*Math.LN2));y.realloc(E);for(var I=y.pos-1;m<=I;I--)y.buf[I+E]=y.buf[I]}function V5(m,p){for(var y=0;y<m.length;y++)p.writeVarint(m[y])}function cK(m,p){for(var y=0;y<m.length;y++)p.writeSVarint(m[y])}function B5(m,p){for(var y=0;y<m.length;y++)p.writeFloat(m[y])}function Wte(m,p){for(var y=0;y<m.length;y++)p.writeDouble(m[y])}function Yte(m,p){for(var y=0;y<m.length;y++)p.writeBoolean(m[y])}function uK(m,p){for(var y=0;y<m.length;y++)p.writeFixed32(m[y])}function hK(m,p){for(var y=0;y<m.length;y++)p.writeSFixed32(m[y])}function Zte(m,p){for(var y=0;y<m.length;y++)p.writeFixed64(m[y])}function Qte(m,p){for(var y=0;y<m.length;y++)p.writeSFixed64(m[y])}function BT(m,p){return(m[p]|m[p+1]<<8|m[p+2]<<16)+16777216*m[p+3]}function UT(m,p,y){m[y]=p,m[y+1]=p>>>8,m[y+2]=p>>>16,m[y+3]=p>>>24}function dK(m,p){return(m[p]|m[p+1]<<8|m[p+2]<<16)+(m[p+3]<<24)}fo.prototype={destroy:function(){this.buf=null},readFields:function(m,p,y){for(y=y||this.length;this.pos<y;){var E=this.readVarint(),I=E>>3,R=this.pos;this.type=7&E,m(I,p,this),this.pos===R&&this.skip(E)}return p},readMessage:function(m,p){return this.readFields(m,p,this.readVarint()+this.pos)},readFixed32:function(){var m=BT(this.buf,this.pos);return this.pos+=4,m},readSFixed32:function(){var m=dK(this.buf,this.pos);return this.pos+=4,m},readFixed64:function(){var m=BT(this.buf,this.pos)+BT(this.buf,this.pos+4)*aK;return this.pos+=8,m},readSFixed64:function(){var m=BT(this.buf,this.pos)+dK(this.buf,this.pos+4)*aK;return this.pos+=8,m},readFloat:function(){var m=cL.read(this.buf,this.pos,!0,23,4);return this.pos+=4,m},readDouble:function(){var m=cL.read(this.buf,this.pos,!0,52,8);return this.pos+=8,m},readVarint:function(O){var R=127&(E=(I=this.buf)[this.pos++]);if(E<128||(R|=(127&(E=I[this.pos++]))<<7,E<128)||(R|=(127&(E=I[this.pos++]))<<14,E<128)||(R|=(127&(E=I[this.pos++]))<<21,E<128))return R;var p,y,E=R|=(15&I[this.pos])<<28,I=O;if(p=(112&(y=(O=(R=this).buf)[R.pos++]))>>4,y<128||(p|=(127&(y=O[R.pos++]))<<3,y<128)||(p|=(127&(y=O[R.pos++]))<<10,y<128)||(p|=(127&(y=O[R.pos++]))<<17,y<128)||(p|=(127&(y=O[R.pos++]))<<24,y<128)||(p|=(1&(y=O[R.pos++]))<<31,y<128))return function W_(m,p,y){return y?4294967296*p+(m>>>0):4294967296*(p>>>0)+(m>>>0)}(E,p,I);throw new Error("Expected varint not more than 10 bytes")},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var m=this.readVarint();return m%2==1?(m+1)/-2:m/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var m=this.readVarint()+this.pos,p=this.pos;if(12<=(this.pos=m)-p&&uL)return uL.decode(this.buf.subarray(p,m));for(var E,I,R,O=this.buf,L=m,V="",q=p;q<L;){var $=O[q],Y=null,ae=239<$?4:223<$?3:191<$?2:1;if(L<q+ae)break;1===ae?$<128&&(Y=$):2===ae?128==(192&(E=O[q+1]))&&(Y=(31&$)<<6|63&E)<=127&&(Y=null):3===ae?(I=O[q+2],128==(192&(E=O[q+1]))&&128==(192&I)&&((Y=(15&$)<<12|(63&E)<<6|63&I)<=2047||55296<=Y&&Y<=57343)&&(Y=null)):4===ae&&(I=O[q+2],R=O[q+3],128==(192&(E=O[q+1])))&&128==(192&I)&&128==(192&R)&&((Y=(15&$)<<18|(63&E)<<12|(63&I)<<6|63&R)<=65535||1114112<=Y)&&(Y=null),null===Y?(Y=65533,ae=1):65535<Y&&(Y-=65536,V+=String.fromCharCode(Y>>>10&1023|55296),Y=56320|1023&Y),V+=String.fromCharCode(Y),q+=ae}return V},readBytes:function(){var m=this.readVarint()+this.pos,p=this.buf.subarray(this.pos,m);return this.pos=m,p},readPackedVarint:function(m,p){if(this.type!==fo.Bytes)return m.push(this.readVarint(p));var y=K_(this);for(m=m||[];this.pos<y;)m.push(this.readVarint(p));return m},readPackedSVarint:function(m){if(this.type!==fo.Bytes)return m.push(this.readSVarint());var p=K_(this);for(m=m||[];this.pos<p;)m.push(this.readSVarint());return m},readPackedBoolean:function(m){if(this.type!==fo.Bytes)return m.push(this.readBoolean());var p=K_(this);for(m=m||[];this.pos<p;)m.push(this.readBoolean());return m},readPackedFloat:function(m){if(this.type!==fo.Bytes)return m.push(this.readFloat());var p=K_(this);for(m=m||[];this.pos<p;)m.push(this.readFloat());return m},readPackedDouble:function(m){if(this.type!==fo.Bytes)return m.push(this.readDouble());var p=K_(this);for(m=m||[];this.pos<p;)m.push(this.readDouble());return m},readPackedFixed32:function(m){if(this.type!==fo.Bytes)return m.push(this.readFixed32());var p=K_(this);for(m=m||[];this.pos<p;)m.push(this.readFixed32());return m},readPackedSFixed32:function(m){if(this.type!==fo.Bytes)return m.push(this.readSFixed32());var p=K_(this);for(m=m||[];this.pos<p;)m.push(this.readSFixed32());return m},readPackedFixed64:function(m){if(this.type!==fo.Bytes)return m.push(this.readFixed64());var p=K_(this);for(m=m||[];this.pos<p;)m.push(this.readFixed64());return m},readPackedSFixed64:function(m){if(this.type!==fo.Bytes)return m.push(this.readSFixed64());var p=K_(this);for(m=m||[];this.pos<p;)m.push(this.readSFixed64());return m},skip:function(m){if((m&=7)===fo.Varint)for(;127<this.buf[this.pos++];);else if(m===fo.Bytes)this.pos=this.readVarint()+this.pos;else if(m===fo.Fixed32)this.pos+=4;else{if(m!==fo.Fixed64)throw new Error("Unimplemented type: "+m);this.pos+=8}},writeTag:function(m,p){this.writeVarint(m<<3|p)},realloc:function(m){for(var p,y=this.length||16;y<this.pos+m;)y*=2;y!==this.length&&((p=new Uint8Array(y)).set(this.buf),this.buf=p,this.length=y)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(m){this.realloc(4),UT(this.buf,m,this.pos),this.pos+=4},writeSFixed32:function(m){this.realloc(4),UT(this.buf,m,this.pos),this.pos+=4},writeFixed64:function(m){this.realloc(8),UT(this.buf,-1&m,this.pos),UT(this.buf,Math.floor(m*lK),this.pos+4),this.pos+=8},writeSFixed64:function(m){this.realloc(8),UT(this.buf,-1&m,this.pos),UT(this.buf,Math.floor(m*lK),this.pos+4),this.pos+=8},writeVarint:function(m){if(268435455<(m=+m||0)||m<0){var I=this;if(0<=(y=m)?(p=y%4294967296|0,E=y/4294967296|0):(E=~(-y/4294967296),4294967295^(p=~(-y%4294967296))?p=p+1|0:E=E+1|(p=0)),0x10000000000000000<=y||y<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");I.realloc(10);var y=p,p=I,E=(p.buf[p.pos++]=127&y|128,y>>>=7,p.buf[p.pos++]=127&y|128,y>>>=7,p.buf[p.pos++]=127&y|128,y>>>=7,p.buf[p.pos++]=127&y|128,p.buf[p.pos]=127&(y>>>=7),y=E,I);I=(7&y)<<4,E.buf[E.pos++]|=I|((y>>>=3)?128:0),y&&(E.buf[E.pos++]=127&y|((y>>>=7)?128:0),y)&&(E.buf[E.pos++]=127&y|((y>>>=7)?128:0),y)&&(E.buf[E.pos++]=127&y|((y>>>=7)?128:0),y)&&(E.buf[E.pos++]=127&y|((y>>>=7)?128:0),y)&&(E.buf[E.pos++]=127&y)}else this.realloc(4),this.buf[this.pos++]=127&m|(127<m?128:0),m<=127||(this.buf[this.pos++]=127&(m>>>=7)|(127<m?128:0),m<=127)||(this.buf[this.pos++]=127&(m>>>=7)|(127<m?128:0),m<=127)||(this.buf[this.pos++]=m>>>7&127)},writeSVarint:function(m){this.writeVarint(m<0?2*-m-1:2*m)},writeBoolean:function(m){this.writeVarint(!!m)},writeString:function(y){y=String(y),this.realloc(4*y.length),this.pos++;var p=this.pos;128<=(this.pos=function(E,I,R){for(var O,L,V=0;V<I.length;V++){if(55295<(O=I.charCodeAt(V))&&O<57344){if(!L){56319<O||V+1===I.length?(E[R++]=239,E[R++]=191,E[R++]=189):L=O;continue}if(O<56320){E[R++]=239,E[R++]=191,E[R++]=189,L=O;continue}O=L-55296<<10|O-56320|65536,L=null}else L&&(E[R++]=239,E[R++]=191,E[R++]=189,L=null);O<128?E[R++]=O:(O<2048?E[R++]=O>>6|192:(O<65536?E[R++]=O>>12|224:(E[R++]=O>>18|240,E[R++]=O>>12&63|128),E[R++]=O>>6&63|128),E[R++]=63&O|128)}return R}(this.buf,y,this.pos),y=this.pos-p)&&F5(p,y,this),this.pos=p-1,this.writeVarint(y),this.pos+=y},writeFloat:function(m){this.realloc(4),cL.write(this.buf,m,this.pos,!0,23,4),this.pos+=4},writeDouble:function(m){this.realloc(8),cL.write(this.buf,m,this.pos,!0,52,8),this.pos+=8},writeBytes:function(m){var p=m.length;this.writeVarint(p),this.realloc(p);for(var y=0;y<p;y++)this.buf[this.pos++]=m[y]},writeRawMessage:function(E,p){this.pos++;var y=this.pos;128<=(E(p,this),E=this.pos-y)&&F5(y,E,this),this.pos=y-1,this.writeVarint(E),this.pos+=E},writeMessage:function(m,p,y){this.writeTag(m,fo.Bytes),this.writeRawMessage(p,y)},writePackedVarint:function(m,p){p.length&&this.writeMessage(m,V5,p)},writePackedSVarint:function(m,p){p.length&&this.writeMessage(m,cK,p)},writePackedBoolean:function(m,p){p.length&&this.writeMessage(m,Yte,p)},writePackedFloat:function(m,p){p.length&&this.writeMessage(m,B5,p)},writePackedDouble:function(m,p){p.length&&this.writeMessage(m,Wte,p)},writePackedFixed32:function(m,p){p.length&&this.writeMessage(m,uK,p)},writePackedSFixed32:function(m,p){p.length&&this.writeMessage(m,hK,p)},writePackedFixed64:function(m,p){p.length&&this.writeMessage(m,Zte,p)},writePackedSFixed64:function(m,p){p.length&&this.writeMessage(m,Qte,p)},writeBytesField:function(m,p){this.writeTag(m,fo.Bytes),this.writeBytes(p)},writeFixed32Field:function(m,p){this.writeTag(m,fo.Fixed32),this.writeFixed32(p)},writeSFixed32Field:function(m,p){this.writeTag(m,fo.Fixed32),this.writeSFixed32(p)},writeFixed64Field:function(m,p){this.writeTag(m,fo.Fixed64),this.writeFixed64(p)},writeSFixed64Field:function(m,p){this.writeTag(m,fo.Fixed64),this.writeSFixed64(p)},writeVarintField:function(m,p){this.writeTag(m,fo.Varint),this.writeVarint(p)},writeSVarintField:function(m,p){this.writeTag(m,fo.Varint),this.writeSVarint(p)},writeStringField:function(m,p){this.writeTag(m,fo.Bytes),this.writeString(p)},writeFloatField:function(m,p){this.writeTag(m,fo.Fixed32),this.writeFloat(p)},writeDoubleField:function(m,p){this.writeTag(m,fo.Fixed64),this.writeDouble(p)},writeBooleanField:function(m,p){this.writeVarintField(m,!!p)}};var hL,$D=g(Oh);const U5=3;function Xte(m,p,y){1===m&&y.readMessage(pK,p)}function pK(m,p,y){var E,I,R,O,L;3===m&&(({id:m,bitmap:y,width:E,height:I,left:R,top:O,advance:L}=y.readMessage(Jte,{})),p.push({id:m,bitmap:new Qu({width:E+2*U5,height:I+2*U5},y),metrics:{width:E,height:I,left:R,top:O,advance:L}}))}function Jte(m,p,y){1===m?p.id=y.readVarint():2===m?p.bitmap=y.readBytes():3===m?p.width=y.readVarint():4===m?p.height=y.readVarint():5===m?p.left=y.readSVarint():6===m?p.top=y.readSVarint():7===m&&(p.advance=y.readVarint())}const qD=U5;function fK(m){let p=0,y=0;for(const V of m)p+=V.w*V.h,y=Math.max(y,V.w);m.sort((V,q)=>q.h-V.h);var E=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(p/.95)),y),h:1/0}];let I=0,R=0;for(const V of m)for(let q=E.length-1;0<=q;q--){var O,L=E[q];if(!(V.w>L.w||V.h>L.h)){V.x=L.x,V.y=L.y,R=Math.max(R,V.y+V.h),I=Math.max(I,V.x+V.w),V.w===L.w&&V.h===L.h?(O=E.pop(),q<E.length&&(E[q]=O)):V.h===L.h?(L.x+=V.w,L.w-=V.w):(V.w!==L.w&&E.push({x:L.x+V.w,y:L.y,w:L.w-V.w,h:V.h}),L.y+=V.h,L.h-=V.h);break}}return{w:I,h:R,fill:p/(I*R)||0}}(po=hL=hL||{}).none="none",po.height="height",po.width="width";class z5{constructor(p,{pixelRatio:y,version:E,stretchX:I,stretchY:R,content:O,contentMatch:L}){this.paddedRect=p,this.pixelRatio=y,this.stretchX=I,this.stretchY=R,this.content=O,this.version=E,this.contentMatch=L}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class mK{constructor(p,y){var E={},I={},R=(this.haveRenderCallbacks=[],[]);this.addImages(p,E,R),this.addImages(y,I,R);const{w:O,h:L}=fK(R);var V=new kh({width:O||1,height:L||1});for(const pe in p){var q=p[pe],$=E[pe].paddedRect;kh.copy(q.data,V,{x:0,y:0},{x:$.x+1,y:$.y+1},q.data)}for(const pe in y){var Y=y[pe],ae=I[pe].paddedRect;const fe=ae.x+1,ve=ae.y+1,ke=Y.data.width,_e=Y.data.height;kh.copy(Y.data,V,{x:0,y:0},{x:fe,y:ve},Y.data),kh.copy(Y.data,V,{x:0,y:_e-1},{x:fe,y:ve-1},{width:ke,height:1}),kh.copy(Y.data,V,{x:0,y:0},{x:fe,y:ve+_e},{width:ke,height:1}),kh.copy(Y.data,V,{x:ke-1,y:0},{x:fe-1,y:ve},{width:1,height:_e}),kh.copy(Y.data,V,{x:0,y:0},{x:fe+ke,y:ve},{width:1,height:_e})}this.image=V,this.iconPositions=E,this.patternPositions=I}addImages(p,y,E){for(const O in p){var I=p[O],R={x:0,y:0,w:I.data.width+2,h:I.data.height+2};E.push(R),y[O]=new z5(R,I),I.hasRenderCallback&&this.haveRenderCallbacks.push(O)}}patchUpdatedImages(p,y){p.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const E in p.updatedImages)this.patchUpdatedImage(this.iconPositions[E],p.getImage(E),y),this.patchUpdatedImage(this.patternPositions[E],p.getImage(E),y)}patchUpdatedImage(p,y,E){var I;p&&y&&p.version!==y.version&&(p.version=y.version,[p,I]=p.tl,E.update(y.data,void 0,{x:p,y:I}))}}Cn("ImagePosition",z5),Cn("ImageAtlas",mK),u.WritingMode=void 0,(ra=u.WritingMode||(u.WritingMode={}))[ra.none=0]="none",ra[ra.horizontal=1]="horizontal",ra[ra.vertical=2]="vertical",ra[ra.horizontalOnly=3]="horizontalOnly";class KD{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(p,y){var E=new KD;return E.scale=p||1,E.fontStack=y,E}static forImage(p){var y=new KD;return y.imageName=p,y}}class zT{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(p,y){var E=new zT;for(let R=0;R<p.sections.length;R++){var I=p.sections[R];I.image?E.addImageSection(I):E.addTextSection(I,y)}return E}length(){return this.text.length}getSection(p){return this.sections[this.sectionIndex[p]]}getSectionIndex(p){return this.sectionIndex[p]}getCharCode(p){return this.text.charCodeAt(p)}verticalizePunctuation(){this.text=function Qae(m){let p="";for(let I=0;I<m.length;I++){var y=m.charCodeAt(I+1)||null,E=m.charCodeAt(I-1)||null;y&&_T(y)&&!VT[m[I+1]]||E&&_T(E)&&!VT[m[I-1]]||!VT[m[I]]?p+=m[I]:p+=VT[m[I]]}return p}(this.text)}trim(){let p=0;for(let E=0;E<this.text.length&&jT[this.text.charCodeAt(E)];E++)p++;let y=this.text.length;for(let E=this.text.length-1;0<=E&&E>=p&&jT[this.text.charCodeAt(E)];E--)y--;this.text=this.text.substring(p,y),this.sectionIndex=this.sectionIndex.slice(p,y)}substring(p,y){var E=new zT;return E.text=this.text.substring(p,y),E.sectionIndex=this.sectionIndex.slice(p,y),E.sections=this.sections,E}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((p,y)=>Math.max(p,this.sections[y].scale),0)}addTextSection(p,y){this.text+=p.text,this.sections.push(KD.forText(p.scale,p.fontStack||y));var E=this.sections.length-1;for(let I=0;I<p.text.length;++I)this.sectionIndex.push(E)}addImageSection(E){var y;0===(E=E.image?E.image.name:"").length?lt("Can't add FormattedSection with an empty image."):(y=this.getNextImageSectionCharCode())?(this.text+=String.fromCharCode(y),this.sections.push(KD.forImage(E)),this.sectionIndex.push(this.sections.length-1)):lt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?63743<=this.imageSectionID?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function dL(ze,p,y,E,Qe,R,O,L,V,q,$,Y,ae,pe,fe,ve){var ke=zT.fromFeature(ze,Qe);let _e;Y===u.WritingMode.vertical&&ke.verticalizePunctuation();var dc,{processBidirectionalText:ze,processStyledBidirectionalText:Qe}=Lg;if(ze&&1===ke.sections.length){_e=[];for(const Aa of ze(ke.toString(),j5(ke,q,R,p,E,pe,fe))){var ht=new zT;ht.text=Aa,ht.sections=ke.sections;for(let Pl=0;Pl<Aa.length;Pl++)ht.sectionIndex.push(0);_e.push(ht)}}else if(Qe){_e=[];for(const Aa of Qe(ke.text,ke.sectionIndex,j5(ke,q,R,p,E,pe,fe))){var pt=new zT;pt.text=Aa[0],pt.sectionIndex=Aa[1],pt.sections=ke.sections,_e.push(pt)}}else _e=function(Aa,Pl){var Pd=[],qg=Aa.text;let hi=0;for(const ji of Pl)Pd.push(Aa.substring(hi,ji)),hi=ji;return hi<qg.length&&Pd.push(Aa.substring(hi,qg.length)),Pd}(ke,j5(ke,q,R,p,E,pe,fe));{var gt=Qe={positionedLines:ze=[],text:ke.toString(),top:$[1],bottom:$[1],left:$[0],right:$[0],writingMode:Y,iconsInText:!1,verticalizable:!1},Vt=p,vn=y,gn=E,zt=(R=_e,O),an=(pe=L,fe=V,Y),Wt=q,$t=ae,Tt=ve;let Aa=0,Pl=-17,Pd=0,qg=0;var Dn="right"===fe?1:"left"===fe?0:.5;let hi=0;for(const fa of R){fa.trim();var Tn=fa.getMaxScale(),Nn=(Tn-1)*Sa,wr={positionedGlyphs:[],lineOffset:0},Jr=(gt.positionedLines[hi]=wr).positionedGlyphs;let pu=0;if(fa.length()){for(let Fo=0;Fo<fa.length();Fo++){var Cr=fa.getSection(Fo),Vi=fa.getSectionIndex(Fo),Zn=fa.getCharCode(Fo);let ia=0,Ha=null,Rl=null,Ju=null,Ml=Sa;var kr=!(an===u.WritingMode.horizontal||!$t&&!Pw(Zn)||$t&&(jT[Zn]||(dc=Zn,_n.Arabic(dc)||_n["Arabic Supplement"](dc)||_n["Arabic Extended-A"](dc)||_n["Arabic Presentation Forms-A"](dc)||_n["Arabic Presentation Forms-B"](dc))));if(Cr.imageName){if(!(Ci=gn[Cr.imageName]))continue;Ju=Cr.imageName,gt.iconsInText=gt.iconsInText||!0,Rl=Ci.paddedRect;var mo,Ci=Ci.displaySize;0<(ia=Nn+(Cr.scale=Cr.scale*Sa/Tt,Ha={width:Ci[0],height:Ci[1],left:1,top:-qD,advance:kr?Ci[1]:Ci[0]},mo=Sa-Ci[1]*Cr.scale),Ml=Ha.advance,mo=kr?Ci[0]*Cr.scale-Sa*Tn:Ci[1]*Cr.scale-Sa*Tn)&&mo>pu&&(pu=mo)}else{if((mo=(Ci=vn[Cr.fontStack])&&Ci[Zn])&&mo.rect)Rl=mo.rect,Ha=mo.metrics;else{var Xu;if(!(Xu=(Xu=Vt[Cr.fontStack])&&Xu[Zn]))continue;Ha=Xu.metrics}ia=(Tn-Cr.scale)*Sa}kr?(gt.verticalizable=!0,Jr.push({glyph:Zn,imageName:Ju,x:Aa,y:Pl+ia,vertical:kr,scale:Cr.scale,fontStack:Cr.fontStack,sectionIndex:Vi,metrics:Ha,rect:Rl}),Aa+=Ml*Cr.scale+Wt):(Jr.push({glyph:Zn,imageName:Ju,x:Aa,y:Pl+ia,vertical:kr,scale:Cr.scale,fontStack:Cr.fontStack,sectionIndex:Vi,metrics:Ha,rect:Rl}),Aa+=Ha.advance*Cr.scale+Wt)}0!==Jr.length&&(Fc=Aa-Wt,Pd=Math.max(Fc,Pd),function(Fo,ia,Ha,Rl,Ju){if(Rl||Ju){var Ml,dc=(Fo[Ha].x+(Ml=(Ml=Fo[Ha]).metrics.advance*Ml.scale))*Rl;for(let Rd=0;Rd<=Ha;Rd++)Fo[Rd].x-=dc,Fo[Rd].y+=Ju}}(Jr,0,Jr.length-1,Dn,pu)),Aa=0;var Fc=zt*Tn+pu;wr.lineOffset=Math.max(pu,Nn),Pl+=Fc,qg=Math.max(Fc,qg)}else Pl+=zt;++hi}fe=Pl- -17;var{horizontalAlign:pe,verticalAlign:$}=pL(pe);{var Mi=gt.positionedLines,nP=(Dn-pe)*Pd;let fa=0;fa=qg!==zt?-fe*$- -17:(-$*R.length+.5)*zt;for(const pu of Mi)for(const Fo of pu.positionedGlyphs)Fo.x+=nP,Fo.y+=fa}gt.top+=-$*fe,gt.bottom=gt.top+fe,gt.left+=-pe*Pd,gt.right=gt.left+Pd}return!function(Aa){for(const Pl of Aa)if(0!==Pl.positionedGlyphs.length)return;return 1}(ze)&&Qe}const jT={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ene={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function gK(m,p,y,E,I,R){return p.imageName?(E=E[p.imageName])?E.displaySize[0]*p.scale*Sa/R+I:0:(R=(E=y[p.fontStack])&&E[m])?R.metrics.advance*p.scale+I:0}function yK(m,p,y,E){var I=Math.pow(m-p,2);return E?m<p?I/2:2*I:I+Math.abs(y)*y}function _K(m,p,y,E,I,R){let O=null,L=yK(p,y,I,R);for(const q of E){var V=yK(p-q.x,y,I,R)+q.badness;V<=L&&(O=q,L=V)}return{index:m,x:p,priorBreak:O,badness:L}}function j5(m,p,y,E,I,R,O){if("point"!==R)return[];if(!m)return[];var L=[],V=function(fe,ve,ke,_e,ze,Qe){let ht=0;for(let gt=0;gt<fe.length();gt++){var pt=fe.getSection(gt);ht+=gK(fe.getCharCode(gt),pt,_e,ze,ve,Qe)}return ht/Math.max(1,Math.ceil(ht/ke))}(m,p,y,E,I,O),q=0<=m.text.indexOf("\u200b");let $=0;for(let fe=0;fe<m.length();fe++){var Y,ae=m.getSection(fe),pe=m.getCharCode(fe);jT[pe]||($+=gK(pe,ae,E,I,p,O)),fe<m.length()-1&&(Y=!((Y=pe)<11904||!_n["Bopomofo Extended"](Y)&&!(_n.Bopomofo(Y)||_n["CJK Compatibility Forms"](Y)||_n["CJK Compatibility Ideographs"](Y)||_n["CJK Compatibility"](Y)||_n["CJK Radicals Supplement"](Y)||_n["CJK Strokes"](Y)||_n["CJK Symbols and Punctuation"](Y)||_n["CJK Unified Ideographs Extension A"](Y)||_n["CJK Unified Ideographs"](Y)||_n["Enclosed CJK Letters and Months"](Y)||_n["Halfwidth and Fullwidth Forms"](Y)||_n.Hiragana(Y)||_n["Ideographic Description Characters"](Y)||_n["Kangxi Radicals"](Y)||_n["Katakana Phonetic Extensions"](Y)||_n.Katakana(Y)||_n["Vertical Forms"](Y)||_n["Yi Radicals"](Y)||_n["Yi Syllables"](Y))),ene[pe]||Y||ae.imageName)&&L.push(_K(fe+1,$,V,L,function(ve,ke,_e){let ze=0;return 10===ve&&(ze-=1e4),_e&&(ze+=150),40!==ve&&65288!==ve||(ze+=50),41!==ke&&65289!==ke||(ze+=50),ze}(pe,m.getCharCode(fe+1),Y&&q),!1))}return function fe(ve){return ve?fe(ve.priorBreak).concat(ve.index):[]}(_K(m.length(),$,V,L,0,!0))}function pL(m){let p=.5,y=.5;switch(m){case"right":case"top-right":case"bottom-right":p=1;break;case"left":case"top-left":case"bottom-left":p=0}switch(m){case"bottom":case"bottom-right":case"bottom-left":y=1;break;case"top":case"top-right":case"top-left":y=0}return{horizontalAlign:p,verticalAlign:y}}function vK(m){let p=m.left,y=m.top,E=m.right-p,I=m.bottom-y;var R=m.image.content[2]-m.image.content[0],O=m.image.content[3]-m.image.content[1];return 0!=O&&0!==E&&0!==I&&(R/=O,m.image.contentMatch===hL.height?E/I<R&&(p*=(O=I*R)/E,E=O):m.image.contentMatch===hL.width&&0!=R&&E/I>R&&(y*=(O=E/R)/O,I=O)),{x1:p,y1:y,x2:p+E,y2:y+I}}function wK(m,p,y,E,I,R){let O;(m=m.image).content&&(O=[(L=m.content)[0]/(V=m.pixelRatio||1),L[1]/V,m.displaySize[0]-L[2]/V,m.displaySize[1]-L[3]/V]);var L=p.left*R,V=p.right*R;let q,$,Y,ae;return $="width"===y||"both"===y?(ae=I[0]+L-E[3],I[0]+V+E[1]):(ae=I[0]+(L+V-m.displaySize[0])/2)+m.displaySize[0],L=p.top*R,V=p.bottom*R,Y="height"===y||"both"===y?(q=I[1]+L-E[0],I[1]+V+E[2]):(q=I[1]+(L+V-m.displaySize[1])/2)+m.displaySize[1],{image:m,top:q,right:$,bottom:Y,left:ae,collisionPadding:O}}const rm=128,Y_=32640;function H5(m,p){if("constant"===(p=p.expression).kind)return{kind:"constant",layoutSize:p.evaluate(new uo(m+1))};if("source"===p.kind)return{kind:"source"};{var{zoomStops:y,interpolationType:E}=p;let O=0;for(;O<y.length&&y[O]<=m;)O++;let L=O=Math.max(0,O-1);for(;L<y.length&&y[L]<m+1;)L++;L=Math.min(y.length-1,L);var I=y[O],R=y[L];return"composite"===p.kind?{kind:"composite",minZoom:I,maxZoom:R,interpolationType:E}:{kind:"camera",minZoom:I,maxZoom:R,minSize:p.evaluate(new uo(I)),maxSize:p.evaluate(new uo(R)),interpolationType:E}}}function YD(m,p,y){let E="never";return(p=m.get(p))?E=p:m.get(y)&&(E="always"),E}const tne=G_.VectorTileFeature.types,$5=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function fL(m,p,y,E,I,R,O,fe,V,q,$,Y,ae){var pe=fe?Math.min(Y_,Math.round(fe[0])):0;fe=fe?Math.min(Y_,Math.round(fe[1])):0,m.emplaceBack(p,y,Math.round(32*E),Math.round(32*I),R,O,(pe<<1)+(V?1:0),fe,16*q,16*$,256*Y,256*ae)}function q5(m,p,y){m.emplaceBack(p.x,p.y,y),m.emplaceBack(p.x,p.y,y),m.emplaceBack(p.x,p.y,y),m.emplaceBack(p.x,p.y,y)}function Xae(m){for(const p of m.sections)if(function(y){for(const E of y)if(YN(E.charCodeAt(0)))return 1}(p.text))return!0;return!1}class mL{constructor(p){this.layoutVertexArray=new MT,this.indexArray=new Jf,this.programConfigurations=p,this.segments=new A,this.dynamicLayoutVertexArray=new Ug,this.opacityVertexArray=new FD,this.hasVisibleVertices=!1,this.placedSymbolArray=new Uw}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(p,y,E,I){!this.isEmpty()&&(E&&(this.layoutVertexBuffer=p.createVertexBuffer(this.layoutVertexArray,O5.members),this.indexBuffer=p.createIndexBuffer(this.indexArray,y),this.dynamicLayoutVertexBuffer=p.createVertexBuffer(this.dynamicLayoutVertexArray,N5.members,!0),this.opacityVertexBuffer=p.createVertexBuffer(this.opacityVertexArray,$5,!0),this.opacityVertexBuffer.itemSize=1),E||I)&&this.programConfigurations.upload(p)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Cn("SymbolBuffers",mL);class bK{constructor(p,y,E){this.layoutVertexArray=new p,this.layoutAttributes=y,this.indexArray=new E,this.segments=new A,this.collisionVertexArray=new OT}upload(p){this.layoutVertexBuffer=p.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=p.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=p.createVertexBuffer(this.collisionVertexArray,L5.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Cn("CollisionBuffers",bK);class ZD{constructor(p){this.collisionBoxArray=p.collisionBoxArray,this.zoom=p.zoom,this.overscaling=p.overscaling,this.layers=p.layers,this.layerIds=this.layers.map(R=>R.id),this.index=p.index,this.pixelRatio=p.pixelRatio,this.sourceLayerIndex=p.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Po([]),this.placementViewportMatrix=Po([]);var y,I=(this.textSizeData=H5(this.zoom,(y=this.layers[0]._unevaluatedLayout._values)["text-size"]),this.iconSizeData=H5(this.zoom,y["icon-size"]),y=this.layers[0].layout).get("symbol-sort-key"),E=y.get("symbol-z-order");this.canOverlap="never"!==YD(y,"text-overlap","text-allow-overlap")||"never"!==YD(y,"icon-overlap","icon-allow-overlap")||y.get("text-ignore-placement")||y.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==E&&!I.isConstant(),this.sortFeaturesByY=(I="viewport-y"===E||"auto"===E&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===y.get("symbol-placement")&&(this.writingModes=y.get("text-writing-mode").map(R=>u.WritingMode[R])),this.stateDependentLayerIds=this.layers.filter(R=>R.isStateDependent()).map(R=>R.id),this.sourceID=p.sourceID}createArrays(){this.text=new mL(new _t(this.layers,this.zoom,p=>/^text/.test(p))),this.icon=new mL(new _t(this.layers,this.zoom,p=>/^icon/.test(p))),this.glyphOffsetArray=new OD,this.lineVertexArray=new DT,this.symbolInstances=new AT,this.textAnchorOffsets=new PT}calculateGlyphDependencies(p,y,E,I,R){for(let L=0;L<p.length;L++){var O;y[p.charCodeAt(L)]=!0,(E||I)&&R&&(O=VT[p.charAt(L)])&&(y[O.charCodeAt(0)]=!0)}}populate(p,y,E){var I=this.layers[0],R=I.layout,O=R.get("text-font"),L=R.get("text-field"),V=R.get("icon-image"),q=("constant"!==L.value.kind||L.value.value instanceof Ku&&!L.value.value.isEmpty()||0<L.value.value.toString().length)&&("constant"!==O.value.kind||0<O.value.value.length),$="constant"!==V.value.kind||!!V.value.value||0<Object.keys(V.parameters).length,Y=R.get("symbol-sort-key");if(this.features=[],q||$){var ae,pe,fe,ve,ke=y.iconDependencies,_e=y.glyphDependencies,ze=y.availableImages,Qe=new uo(this.zoom);for({feature:ae,id:pe,index:fe,sourceLayerIndex:ve}of p){var ht,pt=I._featureFilter.needGeometry,gt=Fn(ae,pt);if(I._featureFilter.filter(Qe,gt,E)){let an,Wt;if(pt||(gt.geometry=mn(ae)),q&&(pt=I.getValueAndResolveTokens("text-field",gt,E,ze),pt=Ku.factory(pt),!(ht=this.hasRTLText=this.hasRTLText||Xae(pt))||"unavailable"===Lg.getRTLTextPluginStatus()||ht&&Lg.isParsed())&&(an=Kte(pt,I,gt)),$&&(Wt=(ht=I.getValueAndResolveTokens("icon-image",gt,E,ze))instanceof lc?ht:lc.fromString(ht)),(an||Wt)&&(pt=this.sortFeaturesByKey?Y.evaluate(gt,{},E):void 0,this.features.push(pt={id:pe,text:an,icon:Wt,index:fe,sourceLayerIndex:ve,geometry:gt.geometry,properties:ae.properties,type:tne[ae.type],sortKey:pt}),Wt&&(ke[Wt.name]=!0),an)){var Vt,vn,gn=O.evaluate(gt,{},E).join(","),zt="viewport"!==R.get("text-rotation-alignment")&&"point"!==R.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&0<=this.writingModes.indexOf(u.WritingMode.vertical);for(const $t of an.sections)$t.image?ke[$t.image.name]=!0:(Vt=Ng(an.toString()),vn=_e[vn=$t.fontStack||gn]=_e[vn]||{},this.calculateGlyphDependencies($t.text,vn,zt,this.allowVerticalPlacement,Vt))}}}"line"===R.get("symbol-placement")&&(this.features=function sK(m){const p={},y={},E=[];let I=0;function R(ve){E.push(m[ve]),I++}function O(ve,ke,_e){var ze=y[ve];return delete y[ve],y[ke]=ze,E[ze].geometry[0].pop(),E[ze].geometry[0]=E[ze].geometry[0].concat(_e[0]),ze}function L(ve,ke,_e){var ze=p[ke];return delete p[ke],p[ve]=ze,E[ze].geometry[0].shift(),E[ze].geometry[0]=_e[0].concat(E[ze].geometry[0]),ze}function V(ve,ke,_e){return`${ve}:${(_e=_e?ke[0][ke[0].length-1]:ke[0][0]).x}:`+_e.y}for(let ve=0;ve<m.length;ve++){var q,$,Y,ae,fe,pe=(fe=m[ve]).geometry;(fe=fe.text?fe.text.toString():null)?(q=V(fe,pe),$=V(fe,pe,!0),q in y&&$ in p&&y[q]!==p[$]?(Y=L(q,$,pe),ae=O(q,$,E[Y].geometry),delete p[q],delete y[$],y[V(fe,E[ae].geometry,!0)]=ae,E[Y].geometry=null):q in y?O(q,$,pe):$ in p?L(q,$,pe):(R(ve),p[q]=I-1,y[$]=I-1)):R(ve)}return E.filter(ve=>ve.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((an,Wt)=>an.sortKey-Wt.sortKey)}}update(p,y,E){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(p,y,this.layers,E),this.icon.programConfigurations.updatePaintArrays(p,y,this.layers,E))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(p){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(p),this.iconCollisionBox.upload(p)),this.text.upload(p,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(p,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(p,y){var E=this.lineVertexArray.length;if(void 0!==p.segment){let O=p.dist(y[p.segment+1]),L=p.dist(y[p.segment]);var I={};for(let V=p.segment+1;V<y.length;V++)I[V]={x:y[V].x,y:y[V].y,tileUnitDistanceFromAnchor:O},V<y.length-1&&(O+=y[V+1].dist(y[V]));for(let V=p.segment||0;0<=V;V--)I[V]={x:y[V].x,y:y[V].y,tileUnitDistanceFromAnchor:L},0<V&&(L+=y[V-1].dist(y[V]));for(let V=0;V<y.length;V++){var R=I[V];this.lineVertexArray.emplaceBack(R.x,R.y,R.tileUnitDistanceFromAnchor)}}return{lineStartIndex:E,lineLength:this.lineVertexArray.length-E}}addSymbols(p,y,E,I,R,O,L,V,q,$,Y,ae){var pe=p.indexArray,fe=p.layoutVertexArray,ve=p.segments.prepareSegment(4*y.length,fe,pe,this.canOverlap?O.sortKey:void 0),ke=this.glyphOffsetArray.length,_e=ve.vertexLength,ze=this.allowVerticalPlacement&&L===u.WritingMode.vertical?Math.PI/2:0,Qe=O.text&&O.text.sections;for(let wr=0;wr<y.length;wr++){var{tl:ht,tr:pt,bl:gt,br:Vt,tex:vn,pixelOffsetTL:gn,pixelOffsetBR:zt,minFontScaleX:an,minFontScaleY:Wt,glyphOffset:$t,isSDF:Tt,sectionIndex:Dn}=y[wr],Tn=ve.vertexLength,Nn=$t[1];fL(fe,V.x,V.y,ht.x,Nn+ht.y,vn.x,vn.y,E,Tt,gn.x,gn.y,an,Wt),fL(fe,V.x,V.y,pt.x,Nn+pt.y,vn.x+vn.w,vn.y,E,Tt,zt.x,gn.y,an,Wt),fL(fe,V.x,V.y,gt.x,Nn+gt.y,vn.x,vn.y+vn.h,E,Tt,gn.x,zt.y,an,Wt),fL(fe,V.x,V.y,Vt.x,Nn+Vt.y,vn.x+vn.w,vn.y+vn.h,E,Tt,zt.x,zt.y,an,Wt),q5(p.dynamicLayoutVertexArray,V,ze),pe.emplaceBack(Tn,Tn+1,Tn+2),pe.emplaceBack(Tn+1,Tn+2,Tn+3),ve.vertexLength+=4,ve.primitiveLength+=2,this.glyphOffsetArray.emplaceBack($t[0]),wr!==y.length-1&&Dn===y[wr+1].sectionIndex||p.programConfigurations.populatePaintArrays(fe.length,O,O.index,{},ae,Qe&&Qe[Dn])}p.placedSymbolArray.emplaceBack(V.x,V.y,ke,this.glyphOffsetArray.length-ke,_e,q,$,V.segment,E?E[0]:0,E?E[1]:0,I[0],I[1],L,0,!1,0,Y)}_addCollisionDebugVertex(p,y,E,I,R,O){return y.emplaceBack(0,0),p.emplaceBack(E.x,E.y,I,R,Math.round(O.x),Math.round(O.y))}addCollisionDebugVertices(p,fe,E,I,R,O,pe){var V=R.segments.prepareSegment(4,R.layoutVertexArray,R.indexArray),q=V.vertexLength,$=R.layoutVertexArray,Y=R.collisionVertexArray,ae=pe.anchorX;(this._addCollisionDebugVertex($,Y,O,ae,pe=pe.anchorY,new D(p,fe)),this._addCollisionDebugVertex($,Y,O,ae,pe,new D(E,fe)),this._addCollisionDebugVertex($,Y,O,ae,pe,new D(E,I)),this._addCollisionDebugVertex($,Y,O,ae,pe,new D(p,I)),V.vertexLength+=4,fe=R.indexArray).emplaceBack(q,q+1),fe.emplaceBack(q+1,q+2),fe.emplaceBack(q+2,q+3),fe.emplaceBack(q+3,q),V.primitiveLength+=4}addDebugCollisionBoxes(p,y,E,I){for(let $=p;$<y;$++){var R=this.collisionBoxArray.get($);this.addCollisionDebugVertices(R.x1,R.y1,R.x2,R.y2,I?this.textCollisionBox:this.iconCollisionBox,R.anchorPoint,E)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new bK(kT,Gte.members,H_),this.iconCollisionBox=new bK(kT,Gte.members,H_);for(let y=0;y<this.symbolInstances.length;y++){var p=this.symbolInstances.get(y);this.addDebugCollisionBoxes(p.textBoxStartIndex,p.textBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.iconBoxStartIndex,p.iconBoxEndIndex,p,!1),this.addDebugCollisionBoxes(p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p,!1)}}_deserializeCollisionBoxesForSymbol(p,y,E,I,R,O,L,V,q){var $={};for(let ve=y;ve<E;ve++){var Y=p.get(ve);$.textBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},$.textFeatureIndex=Y.featureIndex;break}for(let ve=I;ve<R;ve++){var ae=p.get(ve);$.verticalTextBox={x1:ae.x1,y1:ae.y1,x2:ae.x2,y2:ae.y2,anchorPointX:ae.anchorPointX,anchorPointY:ae.anchorPointY},$.verticalTextFeatureIndex=ae.featureIndex;break}for(let ve=O;ve<L;ve++){var pe=p.get(ve);$.iconBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},$.iconFeatureIndex=pe.featureIndex;break}for(let ve=V;ve<q;ve++){var fe=p.get(ve);$.verticalIconBox={x1:fe.x1,y1:fe.y1,x2:fe.x2,y2:fe.y2,anchorPointX:fe.anchorPointX,anchorPointY:fe.anchorPointY},$.verticalIconFeatureIndex=fe.featureIndex;break}return $}deserializeCollisionBoxes(p){this.collisionArrays=[];for(let E=0;E<this.symbolInstances.length;E++){var y=this.symbolInstances.get(E);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(p,y.textBoxStartIndex,y.textBoxEndIndex,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y.iconBoxStartIndex,y.iconBoxEndIndex,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex))}}hasTextData(){return 0<this.text.segments.get().length}hasIconData(){return 0<this.icon.segments.get().length}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&0<this.textCollisionBox.segments.get().length}hasIconCollisionBoxData(){return this.hasDebugData()&&0<this.iconCollisionBox.segments.get().length}addIndicesForPlacedSymbol(p,E){var I=(E=p.placedSymbolArray.get(E)).vertexStartIndex+4*E.numGlyphs;for(let R=E.vertexStartIndex;R<I;R+=4)p.indexArray.emplaceBack(R,R+1,R+2),p.indexArray.emplaceBack(R+1,R+2,R+3)}getSortedSymbolIndexes(p){if(this.sortedAngle===p&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;var y=Math.sin(p),E=Math.cos(p);const I=[],R=[];var O=[];for(let V=0;V<this.symbolInstances.length;++V){O.push(V);var L=this.symbolInstances.get(V);I.push(0|Math.round(y*L.anchorX+E*L.anchorY)),R.push(L.featureIndex)}return O.sort((V,q)=>I[V]-I[q]||R[q]-R[V]),O}addToSortKeyRanges(p,y){var E=this.sortKeyRanges[this.sortKeyRanges.length-1];E&&E.sortKey===y?E.symbolInstanceEnd=p+1:this.sortKeyRanges.push({sortKey:y,symbolInstanceStart:p,symbolInstanceEnd:p+1})}sortFeatures(p){if(this.sortFeaturesByY&&this.sortedAngle!==p&&!(1<this.text.segments.get().length||1<this.icon.segments.get().length)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(p),this.sortedAngle=p,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const E of this.symbolInstanceIndexes){var y=this.symbolInstances.get(E);this.featureSortOrder.push(y.featureIndex),[y.rightJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.leftJustifiedTextSymbolIndex].forEach((I,R,O)=>{0<=I&&O.indexOf(I)===R&&this.addIndicesForPlacedSymbol(this.text,I)}),0<=y.verticalPlacedTextSymbolIndex&&this.addIndicesForPlacedSymbol(this.text,y.verticalPlacedTextSymbolIndex),0<=y.placedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,y.placedIconSymbolIndex),0<=y.verticalPlacedIconSymbolIndex&&this.addIndicesForPlacedSymbol(this.icon,y.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let K5,QD;Cn("SymbolBucket",ZD,{omit:["layers","collisionBoxArray","features","compareText"]}),ZD.MAX_GLYPHS=65535,ZD.addDynamicAttributes=q5;var gL={get paint(){return QD=QD||new cc({"icon-opacity":new pr(oe.paint_symbol["icon-opacity"]),"icon-color":new pr(oe.paint_symbol["icon-color"]),"icon-halo-color":new pr(oe.paint_symbol["icon-halo-color"]),"icon-halo-width":new pr(oe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new pr(oe.paint_symbol["icon-halo-blur"]),"icon-translate":new Bn(oe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Bn(oe.paint_symbol["icon-translate-anchor"]),"text-opacity":new pr(oe.paint_symbol["text-opacity"]),"text-color":new pr(oe.paint_symbol["text-color"],{runtimeType:Tr,getOverride:m=>m.textColor,hasOverride:m=>!!m.textColor}),"text-halo-color":new pr(oe.paint_symbol["text-halo-color"]),"text-halo-width":new pr(oe.paint_symbol["text-halo-width"]),"text-halo-blur":new pr(oe.paint_symbol["text-halo-blur"]),"text-translate":new Bn(oe.paint_symbol["text-translate"]),"text-translate-anchor":new Bn(oe.paint_symbol["text-translate-anchor"])})},get layout(){return K5=K5||new cc({"symbol-placement":new Bn(oe.layout_symbol["symbol-placement"]),"symbol-spacing":new Bn(oe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Bn(oe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new pr(oe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Bn(oe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Bn(oe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Bn(oe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Bn(oe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Bn(oe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Bn(oe.layout_symbol["icon-rotation-alignment"]),"icon-size":new pr(oe.layout_symbol["icon-size"]),"icon-text-fit":new Bn(oe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Bn(oe.layout_symbol["icon-text-fit-padding"]),"icon-image":new pr(oe.layout_symbol["icon-image"]),"icon-rotate":new pr(oe.layout_symbol["icon-rotate"]),"icon-padding":new pr(oe.layout_symbol["icon-padding"]),"icon-keep-upright":new Bn(oe.layout_symbol["icon-keep-upright"]),"icon-offset":new pr(oe.layout_symbol["icon-offset"]),"icon-anchor":new pr(oe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Bn(oe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Bn(oe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Bn(oe.layout_symbol["text-rotation-alignment"]),"text-field":new pr(oe.layout_symbol["text-field"]),"text-font":new pr(oe.layout_symbol["text-font"]),"text-size":new pr(oe.layout_symbol["text-size"]),"text-max-width":new pr(oe.layout_symbol["text-max-width"]),"text-line-height":new Bn(oe.layout_symbol["text-line-height"]),"text-letter-spacing":new pr(oe.layout_symbol["text-letter-spacing"]),"text-justify":new pr(oe.layout_symbol["text-justify"]),"text-radial-offset":new pr(oe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Bn(oe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new pr(oe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new pr(oe.layout_symbol["text-anchor"]),"text-max-angle":new Bn(oe.layout_symbol["text-max-angle"]),"text-writing-mode":new Bn(oe.layout_symbol["text-writing-mode"]),"text-rotate":new pr(oe.layout_symbol["text-rotate"]),"text-padding":new Bn(oe.layout_symbol["text-padding"]),"text-keep-upright":new Bn(oe.layout_symbol["text-keep-upright"]),"text-transform":new pr(oe.layout_symbol["text-transform"]),"text-offset":new pr(oe.layout_symbol["text-offset"]),"text-allow-overlap":new Bn(oe.layout_symbol["text-allow-overlap"]),"text-overlap":new Bn(oe.layout_symbol["text-overlap"]),"text-ignore-placement":new Bn(oe.layout_symbol["text-ignore-placement"]),"text-optional":new Bn(oe.layout_symbol["text-optional"])})}};class W5{constructor(p){if(void 0===p.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=p.property.overrides?p.property.overrides.runtimeType:Yn,this.defaultValue=p}evaluate(p){if(p.formattedSection){var y=this.defaultValue.property.overrides;if(y&&y.hasOverride(p.formattedSection))return y.getOverride(p.formattedSection)}return p.feature&&p.featureState?this.defaultValue.evaluate(p.feature,p.featureState):this.defaultValue.property.specification.default}eachChild(p){this.defaultValue.isConstant()||p(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Cn("FormatSectionOverride",W5,{omit:["defaultValue"]});class yL extends Zu{constructor(p){super(p,gL)}recalculate(p,y){if(super.recalculate(p,y),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement"))if(p=this.layout.get("text-writing-mode")){var E=[];for(const I of p)E.indexOf(I)<0&&E.push(I);this.layout._values["text-writing-mode"]=E}else this.layout._values["text-writing-mode"]=["horizontal"];this._setPaintOverrides()}getValueAndResolveTokens(p,y,E,I){return E=this.layout.get(p).evaluate(y,{},E,I),(I=this._unevaluatedLayout._values[p]).isDataDriven()||bw(I.value)||!E?E:function G5(m,p){return p.replace(/{([^{}]+)}/g,(y,E)=>m&&E in m?String(m[E]):"")}(y.properties,E)}createBucket(p){return new ZD(p)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const E of gL.paint.overridableProperties)if(yL.hasPaintOverride(this.layout,E)){var p=this.paint.get(E),y=new W5(p);y=new Zf(y,p.property.specification);let I=null;I="constant"===p.value.kind||"source"===p.value.kind?new ss("source",y):new xw("composite",y,p.value.zoomStops),this.paint._values[E]=new Oc(p.property,I,p.parameters)}}_handleOverridablePaintPropertyUpdate(p,y,E){return!(!this.layout||y.isDataDriven()||E.isDataDriven())&&yL.hasPaintOverride(this.layout,p)}static hasPaintOverride(p,y){p=p.get("text-field");const E=gL.paint.properties[y];let I=!1;const R=O=>{for(const L of O)if(E.overrides&&E.overrides.hasOverride(L))return void(I=!0)};if("constant"===p.value.kind&&p.value.value instanceof Ku)R(p.value.value.sections);else if("source"===p.value.kind){const O=L=>{I||(L instanceof wd&&Zi(L.value)===os?R(L.value.sections):L instanceof vw?R(L.sections):L.eachChild(O))};(y=p.value)._styleExpression&&O(y._styleExpression.expression)}return I}}let EK;var nne={get paint(){return EK=EK||new cc({"background-color":new Bn(oe.paint_background["background-color"]),"background-pattern":new bT(oe.paint_background["background-pattern"]),"background-opacity":new Bn(oe.paint_background["background-opacity"])})}};class rne extends Zu{constructor(p){super(p,nne)}}let xK;var TK={get paint(){return xK=xK||new cc({"raster-opacity":new Bn(oe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Bn(oe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Bn(oe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Bn(oe.paint_raster["raster-brightness-max"]),"raster-saturation":new Bn(oe.paint_raster["raster-saturation"]),"raster-contrast":new Bn(oe.paint_raster["raster-contrast"]),"raster-resampling":new Bn(oe.paint_raster["raster-resampling"]),"raster-fade-duration":new Bn(oe.paint_raster["raster-fade-duration"])})}};class ine extends Zu{constructor(p){super(p,TK)}}class one extends Zu{constructor(p){super(p,{}),this.onAdd=y=>{this.implementation.onAdd&&this.implementation.onAdd(y,y.painter.context.gl)},this.onRemove=y=>{this.implementation.onRemove&&this.implementation.onRemove(y,y.painter.context.gl)},this.implementation=p}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class sne{constructor(p){this._methodToThrottle=p,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const _L=6371008.8;class Hg{constructor(p,y){if(isNaN(p)||isNaN(y))throw new Error(`Invalid LngLat object: (${p}, ${y})`);if(this.lng=+p,this.lat=+y,90<this.lat||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Hg(St(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(p){var y=Math.PI/180,I=this.lat*y,E=p.lat*y;return I=Math.sin(I)*Math.sin(E)+Math.cos(I)*Math.cos(E)*Math.cos((p.lng-this.lng)*y),_L*Math.acos(Math.min(I,1))}static convert(p){if(p instanceof Hg)return p;if(Array.isArray(p)&&(2===p.length||3===p.length))return new Hg(Number(p[0]),Number(p[1]));if(Array.isArray(p)||"object"!=typeof p||null===p)throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]");return new Hg(Number("lng"in p?p.lng:p.lon),Number(p.lat))}}const CK=2*Math.PI*_L;function IK(m){return CK*Math.cos(m*Math.PI/180)}function SK(m){return(180+m)/360}function qs(m){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+m*Math.PI/360)))/360}function Fs(m,p){return m/IK(p)}function XD(m){return 360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90}class vL{constructor(p,y,E=0){this.x=+p,this.y=+y,this.z=+E}static fromLngLat(p,y=0){return p=Hg.convert(p),new vL(SK(p.lng),qs(p.lat),Fs(y,p.lat))}toLngLat(){return new Hg(function Y5(m){return 360*m-180}(this.x),XD(this.y))}toAltitude(){return function ane(m,p){return m*IK(XD(p))}(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/CK*function lne(m){return 1/Math.cos(m*Math.PI/180)}(XD(this.y))}}function AK(m,p,y){return[m*(y=2*Math.PI*6378137/256/Math.pow(2,y))-2*Math.PI*6378137/2,p*y-2*Math.PI*6378137/2]}class wL{constructor(p,y,E){if(p<0||25<p||E<0||E>=Math.pow(2,p)||y<0||y>=Math.pow(2,p))throw new Error(`x=${y}, y=${E}, z=${p} outside of bounds. 0<=x<${Math.pow(2,p)}, 0<=y<${Math.pow(2,p)} 0<=z<=25 `);this.z=p,this.x=y,this.y=E,this.key=JD(0,p,p,y,E)}equals(p){return this.z===p.z&&this.x===p.x&&this.y===p.y}url(p,y,E){var I=function cne(I,p,y){var E=AK(256*I,256*(p=Math.pow(2,y)-p-1),y);return I=AK(256*(I+1),256*(p+1),y),E[0]+","+E[1]+","+I[0]+","+I[1]}(this.x,this.y,this.z),R=function une(m,p,y){let I,E="";for(let R=m;0<R;R--)I=1<<R-1,E+=(p&I?1:0)+(y&I?2:0);return E}(this.z,this.x,this.y);return p[(this.x+this.y)%p.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===E?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,1<y?"@2x":"").replace(/{quadkey}/g,R).replace(/{bbox-epsg-3857}/g,I)}isChildOf(p){var y=this.z-p.z;return 0<y&&p.x===this.x>>y&&p.y===this.y>>y}getTilePoint(p){var y=Math.pow(2,this.z);return new D((p.x*y-this.x)*Nt,(p.y*y-this.y)*Nt)}toString(){return`${this.z}/${this.x}/`+this.y}}class Z5{constructor(p,y){this.wrap=p,this.canonical=y,this.key=JD(p,y.z,y.z,y.x,y.y)}}class Nh{constructor(p,y,E,I,R){if(p<E)throw new Error(`overscaledZ should be >= z; overscaledZ = ${p}; z = `+E);this.overscaledZ=p,this.wrap=y,this.canonical=new wL(E,+I,+R),this.key=JD(y,p,E,I,R)}clone(){return new Nh(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(p){return this.overscaledZ===p.overscaledZ&&this.wrap===p.wrap&&this.canonical.equals(p.canonical)}scaledTo(p){if(p>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${p}; overscaledZ = `+this.overscaledZ);var y=this.canonical.z-p;return p>this.canonical.z?new Nh(p,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Nh(p,this.wrap,p,this.canonical.x>>y,this.canonical.y>>y)}calculateScaledKey(p,y){if(p>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${p}; overscaledZ = `+this.overscaledZ);var E=this.canonical.z-p;return p>this.canonical.z?JD(this.wrap*+y,p,this.canonical.z,this.canonical.x,this.canonical.y):JD(this.wrap*+y,p,p,this.canonical.x>>E,this.canonical.y>>E)}isChildOf(p){var y;return p.wrap===this.wrap&&(y=this.canonical.z-p.canonical.z,0===p.overscaledZ||p.overscaledZ<this.overscaledZ&&p.canonical.x===this.canonical.x>>y&&p.canonical.y===this.canonical.y>>y)}children(p){var y,E;return this.overscaledZ>=p?[new Nh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)]:[new Nh(p=this.canonical.z+1,this.wrap,p,y=2*this.canonical.x,E=2*this.canonical.y),new Nh(p,this.wrap,p,1+y,E),new Nh(p,this.wrap,p,y,1+E),new Nh(p,this.wrap,p,1+y,1+E)]}isLessThan(p){return this.wrap<p.wrap||!(this.wrap>p.wrap)&&(this.overscaledZ<p.overscaledZ||!(this.overscaledZ>p.overscaledZ)&&(this.canonical.x<p.canonical.x||!(this.canonical.x>p.canonical.x)&&this.canonical.y<p.canonical.y))}wrapped(){return new Nh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(p){return new Nh(this.overscaledZ,p,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Z5(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/`+this.canonical.y}getTilePoint(p){return this.canonical.getTilePoint(new vL(p.x-this.wrap,p.y))}}function JD(m,p,y,E,I){var R=1<<y;return(R*R*(m=(m*=2)<0?-1*m-1:m)+R*I+E).toString(36)+y.toString(36)+p.toString(36)}Cn("CanonicalTileID",wL),Cn("OverscaledTileID",Nh,{omit:["posMatrix"]});class Q5{constructor(p,y,E,I=1,R=1,O=1,L=0){if(this.uid=p,y.height!==y.width)throw new RangeError("DEM tiles must be square");if(E&&!["mapbox","terrarium","custom"].includes(E))lt(`"${E}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);else{this.stride=y.height;var V=this.dim=y.height-2;switch(this.data=new Uint32Array(y.data.buffer),E){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=I,this.greenFactor=R,this.blueFactor=O,this.baseShift=L;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let $=0;$<V;$++)this.data[this._idx(-1,$)]=this.data[this._idx(0,$)],this.data[this._idx(V,$)]=this.data[this._idx(V-1,$)],this.data[this._idx($,-1)]=this.data[this._idx($,0)],this.data[this._idx($,V)]=this.data[this._idx($,V-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(V,-1)]=this.data[this._idx(V-1,0)],this.data[this._idx(-1,V)]=this.data[this._idx(0,V-1)],this.data[this._idx(V,V)]=this.data[this._idx(V-1,V-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let $=0;$<V;$++)for(let Y=0;Y<V;Y++){var q=this.get($,Y);q>this.max&&(this.max=q),q<this.min&&(this.min=q)}}}get(I,y){var E=new Uint8Array(this.data.buffer);return I=4*this._idx(I,y),this.unpack(E[I],E[1+I],E[2+I])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(p,y){if(p<-1||p>=this.dim+1||y<-1||y>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(y+1)*this.stride+(p+1)}unpack(p,y,E){return p*this.redFactor+y*this.greenFactor+E*this.blueFactor-this.baseShift}getPixels(){return new kh({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(p,y,E){if(this.dim!==p.dim)throw new Error("dem dimension mismatch");let I=y*this.dim,R=y*this.dim+this.dim,O=E*this.dim,L=E*this.dim+this.dim;switch(y){case-1:I=R-1;break;case 1:R=I+1}switch(E){case-1:O=L-1;break;case 1:L=O+1}var V=-y*this.dim,q=-E*this.dim;for(let $=O;$<L;$++)for(let Y=I;Y<R;Y++)this.data[this._idx(Y,$)]=p.data[this._idx(Y+V,$+q)]}}Cn("DEMData",Q5);class DK{constructor(p){this._stringToNumber={},this._numberToString=[];for(let E=0;E<p.length;E++){var y=p[E];this._stringToNumber[y]=E,this._numberToString[E]=y}}encode(p){return this._stringToNumber[p]}decode(p){if(p>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${p} can't be >= this._numberToString.length `+this._numberToString.length);return this._numberToString[p]}}class PK{constructor(p,y,E,I,R){this.type="Feature",(this._vectorTileFeature=p)._z=y,p._x=E,p._y=I,this.properties=p.properties,this.id=R}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(p){this._geometry=p}toJSON(){var p={geometry:this.geometry};for(const y in this)"_geometry"!==y&&"_vectorTileFeature"!==y&&(p[y]=this[y]);return p}}class RK{constructor(p,y){this.tileID=p,this.x=p.canonical.x,this.y=p.canonical.y,this.z=p.canonical.z,this.grid=new Aw(Nt,16,0),this.grid3D=new Aw(Nt,16,0),this.featureIndexArray=new z_,this.promoteId=y}insert(p,y,E,I,R,O){var L=this.featureIndexArray.length,V=(this.featureIndexArray.emplaceBack(E,I,R),O?this.grid3D:this.grid);for(let ae=0;ae<y.length;ae++){var q=y[ae],$=[1/0,1/0,-1/0,-1/0];for(let pe=0;pe<q.length;pe++){var Y=q[pe];$[0]=Math.min($[0],Y.x),$[1]=Math.min($[1],Y.y),$[2]=Math.max($[2],Y.x),$[3]=Math.max($[3],Y.y)}$[0]<Nt&&$[1]<Nt&&0<=$[2]&&0<=$[3]&&V.insert(L,$[0],$[1],$[2],$[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new G_.VectorTile(new $D(this.rawTileData)).layers,this.sourceLayerCoder=new DK(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(p,y,E,I){this.loadVTLayers();const R=p.params||{},O=Nt/p.tileSize/p.scale,L=cT(R.filter),V=p.queryGeometry,q=p.queryPadding*O;var Y=X5(V),$=this.grid.query(Y.minX-q,Y.minY-q,Y.maxX+q,Y.maxY+q);Y=X5(p.cameraQueryGeometry);for(const ve of this.grid3D.query(Y.minX-q,Y.minY-q,Y.maxX+q,Y.maxY+q,(ke,_e,ze,Qe)=>function Br(m,p,y,E,I){for(const O of m)if(p<=O.x&&y<=O.y&&E>=O.x&&I>=O.y)return!0;var R=[new D(p,y),new D(p,I),new D(E,I),new D(E,y)];if(2<m.length)for(const O of R)if(Ti(m,O))return!0;for(let O=0;O<m.length-1;O++)if(function(L,V,q){var $=q[0],Y=q[2];if(!(L.x<$.x&&V.x<$.x||L.x>Y.x&&V.x>Y.x||L.y<$.y&&V.y<$.y||L.y>Y.y&&V.y>Y.y))return($=It(L,V,q[0]))!==It(L,V,q[1])||$!==It(L,V,q[2])||$!==It(L,V,q[3])}(m[O],m[O+1],R))return!0;return!1}(p.cameraQueryGeometry,ke-q,_e-q,ze+q,Qe+q)))$.push(ve);$.sort(hne);var ae={};let pe;for(let ve=0;ve<$.length;ve++){var fe=$[ve];if(fe!==pe){pe=fe,fe=this.featureIndexArray.get(fe);let ke=null;this.loadMatchingFeature(ae,fe.bucketIndex,fe.sourceLayerIndex,fe.featureIndex,L,R.layers,R.availableImages,y,E,I,(_e,ze,Qe)=>(ke=ke||mn(_e),ze.queryIntersectsFeature(V,_e,Qe,ke,this.z,p.transform,O,p.pixelPosMatrix)))}}return ae}loadMatchingFeature(p,y,E,I,R,O,L,V,q,$,Y){var ae=this.bucketLayerIDs[y];if(!O||function Kt(m,p){for(let y=0;y<m.length;y++)if(0<=p.indexOf(m[y]))return 1}(O,ae)){y=this.sourceLayerCoder.decode(E);var pe=this.vtLayers[y].feature(I);if(R.needGeometry){if(E=Fn(pe,!0),!R.filter(new uo(this.tileID.overscaledZ),E,this.tileID.canonical))return}else if(!R.filter(new uo(this.tileID.overscaledZ),pe))return;var fe=this.getId(pe,y);for(let ht=0;ht<ae.length;ht++){var ve=ae[ht];if(!(O&&O.indexOf(ve)<0)&&(ke=V[ve])){let pt={};fe&&$&&(pt=$.getState(ke.sourceLayer||"_geojsonTileLayer",fe));var ke,_e=Qt({},q[ve]);if(_e.paint=bL(_e.paint,ke.paint,pe,pt,L),_e.layout=bL(_e.layout,ke.layout,pe,pt,L),ke=!Y||Y(pe,ke,pt)){var ze=new PK(pe,this.z,this.x,this.y,fe);ze.layer=_e;let Vt=p[ve];(Vt=void 0===Vt?p[ve]=[]:Vt).push({featureIndex:I,feature:ze,intersectionZ:ke})}}}}}lookupSymbolFeatures(p,y,E,I,R,O,L,V){var q={},$=(this.loadVTLayers(),cT(R));for(const Y of p)this.loadMatchingFeature(q,E,I,Y,$,O,L,V,y);return q}hasLayer(p){for(const y of this.bucketLayerIDs)for(const E of y)if(p===E)return!0;return!1}getId(p,y){let E=p.id;return this.promoteId&&"boolean"==typeof(E=p.properties[y="string"==typeof this.promoteId?this.promoteId:this.promoteId[y]])?Number(E):E}}function bL(m,p,y,E,I){return Je(m,(R,O)=>(O=p instanceof Ow?p.get(O):null)&&O.evaluate?O.evaluate(y,E,I):O)}function X5(m){let p=1/0,y=1/0,E=-1/0,I=-1/0;for(const R of m)p=Math.min(p,R.x),y=Math.min(y,R.y),E=Math.max(E,R.x),I=Math.max(I,R.y);return{minX:p,minY:y,maxX:E,maxY:I}}function hne(m,p){return p-m}function HT(m,p,y,E,I){var R=[];for(let L=0;L<m.length;L++){var O=m[L];let V;for(let q=0;q<O.length-1;q++){let $=O[q],Y=O[q+1];$.x<p&&Y.x<p||($.x<p?$=new D(p,$.y+(p-$.x)/(Y.x-$.x)*(Y.y-$.y))._round():Y.x<p&&(Y=new D(p,$.y+(p-$.x)/(Y.x-$.x)*(Y.y-$.y))._round()),$.y<y&&Y.y<y)||($.y<y?$=new D($.x+(y-$.y)/(Y.y-$.y)*(Y.x-$.x),y)._round():Y.y<y&&(Y=new D($.x+(y-$.y)/(Y.y-$.y)*(Y.x-$.x),y)._round()),$.x>=E&&Y.x>=E)||($.x>=E?$=new D(E,$.y+(E-$.x)/(Y.x-$.x)*(Y.y-$.y))._round():Y.x>=E&&(Y=new D(E,$.y+(E-$.x)/(Y.x-$.x)*(Y.y-$.y))._round()),$.y>=I&&Y.y>=I)||($.y>=I?$=new D($.x+(I-$.y)/(Y.y-$.y)*(Y.x-$.x),I)._round():Y.y>=I&&(Y=new D($.x+(I-$.y)/(Y.y-$.y)*(Y.x-$.x),I)._round()),V&&$.equals(V[V.length-1])||(V=[$],R.push(V)),V.push(Y))}}return R}Cn("FeatureIndex",RK,{omit:["rawTileData","sourceLayerCoder"]});class Ad extends D{constructor(p,y,E,I){super(p,y),this.angle=E,void 0!==I&&(this.segment=I)}clone(){return new Ad(this.x,this.y,this.angle,this.segment)}}function Lc(m,p,y,E,I){if(void 0!==p.segment&&0!==y){let q=p,$=p.segment+1,Y=0;for(;Y>-y/2;){if(--$<0)return;Y-=m[$].dist(q),q=m[$]}Y+=m[$].dist(m[$+1]),$++;var R=[];let ae=0;for(;Y<y/2;){var O=m[$-1],L=m[$],V=m[$+1];if(!V)return;for(O=O.angleTo(L)-L.angleTo(V),O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),R.push({distance:Y,angleDelta:O}),ae+=O;Y-R[0].distance>E;)ae-=R.shift().angleDelta;if(ae>I)return;$++,Y+=L.dist(V)}}return 1}function MK(m){let p=0;for(let y=0;y<m.length-1;y++)p+=m[y].dist(m[y+1]);return p}function kK(m,p,y){return m?.6*p*y:0}function OK(m,p){return Math.max(m?m.right-m.left:0,p?p.right-p.left:0)}function dne(m,p,y,$,Y,pe,O,L,V){var q=kK($,pe,O),ae=($=OK($,Y),0===m[0].x||m[0].x===V||0===m[0].y||m[0].y===V);return p-(Y=$*O)<p/4&&(p=Y+p/4),pe*=2,function fe(ve,ke,_e,ze,Qe,ht,pt,gt,Vt){const vn=ht/2,gn=MK(ve);let zt=0,an=ke-_e,Wt=[];for(let $t=0;$t<ve.length-1;$t++){const Tt=ve[$t],Dn=ve[$t+1],Tn=Tt.dist(Dn),Nn=Dn.angleTo(Tt);for(;an+_e<zt+Tn;){const wr=((an+=_e)-zt)/Tn,Jr=al.number(Tt.x,Dn.x,wr),Cr=al.number(Tt.y,Dn.y,wr);if(0<=Jr&&Jr<Vt&&0<=Cr&&Cr<Vt&&0<=an-vn&&an+vn<=gn){const Vi=new Ad(Jr,Cr,Nn,$t);Vi._round(),ze&&!Lc(ve,Vi,ht,ze,Qe)||Wt.push(Vi)}}zt+=Tn}return gt||Wt.length||pt||(Wt=fe(ve,zt/2,_e,ze,Qe,ht,pt,!0,Vt)),Wt}(m,ae?p/2*L%p:($/2+pe)*O*L%p,p,q,y,Y,ae,!1,V)}Cn("Anchor",Ad);const $T=1;function NK(m,p,y,E){var I=[];const R=m.image,O=R.pixelRatio;var L=R.paddedRect.w-2*$T,V=R.paddedRect.h-2*$T;let q={x1:m.left,y1:m.top,x2:m.right,y2:m.bottom};var $=R.stretchX||[[0,L]],Y=R.stretchY||[[0,V]];const ae=$.reduce(_e=(Zn,kr)=>Zn+kr[1]-kr[0],0),pe=Y.reduce(_e,0);var fe,ve,ke,_e,ze=V-pe;let Qe=0,ht=ae,pt=0,gt=pe,Vt=0,vn=_e=L-ae,gn=0,zt=ze;R.content&&E&&(ve=(fe=R.content)[2]-fe[0],ke=fe[3]-fe[1],R.contentMatch&&R.content&&(q=vK(m)),Qe=Xw($,0,fe[0]),pt=Xw(Y,0,fe[1]),ht=Xw($,fe[0],fe[2]),gt=Xw(Y,fe[1],fe[3]),Vt=fe[0]-Qe,gn=fe[1]-pt,vn=ve-ht,zt=ke-gt);const an=q.x1,Wt=q.y1,$t=q.x2-an,Tt=q.y2-Wt;var Dn=(Dd,kr,Ci,mo)=>{var Z_=Dd.fixed-Vt-vn*Dd.stretch/ae,hc=kr.fixed-gn-zt*kr.stretch/pe,Mi=(Ci.stretch-Qe)/ht*$t+an,uc=Ci.fixed-Vt-vn*Ci.stretch/ae,Fh=(mo.stretch-pt)/gt*Tt+Wt,zp=mo.fixed-gn-zt*mo.stretch/pe,Xu=new D(Ir=(Dd.stretch-Qe)/ht*$t+an,Fc=(kr.stretch-pt)/gt*Tt+Wt),Fc=new D(Mi,Fc),Ir=(Mi=new D(Mi,Fh),new D(Ir,Fh));return Fh=new D(Z_/O,hc/O),Z_=new D(uc/O,zp/O),(hc=p*Math.PI/180)&&(uc=Math.sin(hc),zp=Math.cos(hc),Xu._matMult(hc=[zp,-uc,uc,zp]),Fc._matMult(hc),Ir._matMult(hc),Mi._matMult(hc)),{tl:Xu,tr:Fc,bl:Ir,br:Mi,tex:{x:R.paddedRect.x+$T+(uc=Dd.stretch+Dd.fixed),y:R.paddedRect.y+$T+(hc=kr.stretch+kr.fixed),w:(zp=Ci.stretch+Ci.fixed)-uc,h:(Dd=mo.stretch+mo.fixed)-hc},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Fh,pixelOffsetBR:Z_,minFontScaleX:vn/O/$t,minFontScaleY:zt/O/Tt,isSDF:y}};if(E&&(R.stretchX||R.stretchY)){var Tn=J5($,_e,ae),Nn=J5(Y,ze,pe);for(let Zn=0;Zn<Tn.length-1;Zn++){var wr=Tn[Zn],Jr=Tn[Zn+1];for(let kr=0;kr<Nn.length-1;kr++)I.push(Dn(wr,Nn[kr],Jr,Nn[kr+1]))}}else I.push(Dn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:1+L},{fixed:0,stretch:1+V}));return I}function Xw(m,p,y){let E=0;for(const I of m)E+=Math.max(p,Math.min(y,I[1]))-Math.max(p,Math.min(y,I[0]));return E}function J5(m,p,y){var E,I,R=[{fixed:-$T,stretch:0}];for([E,I]of m){var O=R[R.length-1];R.push({fixed:E-O.stretch,stretch:O.stretch}),R.push({fixed:E-O.stretch,stretch:O.stretch+(I-E)})}return R.push({fixed:p+$T,stretch:y}),R}class qT{constructor(p,y,E,I,R,O,L,V,q,$){if(this.boxStartIndex=p.length,q){let ae=O.top,pe=O.bottom;0<((q=O.collisionPadding)&&(ae-=q[1],pe+=q[3]),q=pe-ae)&&(q=Math.max(10,q),this.circleDiameter=q)}else{var Y;(q=null!=(q=O.image)&&q.contentMatch&&O.image.content?vK(O):{x1:O.left,y1:O.top,x2:O.right,y2:O.bottom}).y1=q.y1*L-V[0],q.x2=q.x2*L+V[1],q.y2=q.y2*L+V[2],q.x1=q.x1*L-V[3],(V=O.collisionPadding)&&(q.x1-=V[0]*L,q.y1-=V[1]*L,q.x2+=V[2]*L,q.y2+=V[3]*L),$&&(O=new D(q.x1,q.y1),V=new D(q.x2,q.y1),L=new D(q.x1,q.y2),Y=new D(q.x2,q.y2),$=$*Math.PI/180,O._rotate($),V._rotate($),L._rotate($),Y._rotate($),q.x1=Math.min(O.x,V.x,L.x,Y.x),q.x2=Math.max(O.x,V.x,L.x,Y.x),q.y1=Math.min(O.y,V.y,L.y,Y.y),q.y2=Math.max(O.y,V.y,L.y,Y.y)),p.emplaceBack(y.x,y.y,q.x1,q.y1,q.x2,q.y2,E,I,R)}this.boxEndIndex=p.length}}class $g{constructor(p=[],y=LK){if(this.data=p,this.length=this.data.length,this.compare=y,0<this.length)for(let E=(this.length>>1)-1;0<=E;E--)this._down(E)}push(p){this.data.push(p),this.length++,this._up(this.length-1)}pop(){var p,y;if(0!==this.length)return p=this.data[0],y=this.data.pop(),this.length--,0<this.length&&(this.data[0]=y,this._down(0)),p}peek(){return this.data[0]}_up(p){for(var{data:y,compare:E}=this,I=y[p];0<p;){var R=p-1>>1,O=y[R];if(0<=E(I,O))break;y[p]=O,p=R}y[p]=I}_down(p){for(var{data:y,compare:E}=this,I=this.length>>1,R=y[p];p<I;){let L=1+(p<<1),V=y[L];var O=L+1;if(O<this.length&&E(y[O],V)<0&&(L=O,V=y[O]),0<=E(V,R))break;y[p]=V,p=L}y[p]=R}}function LK(m,p){return m<p?-1:p<m?1:0}function GT(m,p=1,y=!1){let E=1/0,I=1/0,R=-1/0,O=-1/0;var L=m[0];for(let _e=0;_e<L.length;_e++){var V=L[_e];(!_e||V.x<E)&&(E=V.x),(!_e||V.y<I)&&(I=V.y),(!_e||V.x>R)&&(R=V.x),(!_e||V.y>O)&&(O=V.y)}var Y=Math.min(R-E,O-I);let ae=Y/2;var pe=new $g([],FK);if(0===Y)return new D(E,I);for(let _e=E;_e<R;_e+=Y)for(let ze=I;ze<O;ze+=Y)pe.push(new KT(_e+ae,ze+ae,ae,m));let fe=function(_e){let ze=0,Qe=0,ht=0;var pt=_e[0];for(let gn=0,zt=pt.length,an=zt-1;gn<zt;an=gn++){var gt=pt[gn],Vt=pt[an],vn=gt.x*Vt.y-Vt.x*gt.y;Qe+=(gt.x+Vt.x)*vn,ht+=(gt.y+Vt.y)*vn,ze+=3*vn}return new KT(Qe/ze,ht/ze,0,_e)}(m),ve=pe.length;for(;pe.length;){var ke=pe.pop();(ke.d>fe.d||!fe.d)&&(fe=ke,y)&&console.log("found best %d after %d probes",Math.round(1e4*ke.d)/1e4,ve),ke.max-fe.d<=p||(ae=ke.h/2,pe.push(new KT(ke.p.x-ae,ke.p.y-ae,ae,m)),pe.push(new KT(ke.p.x+ae,ke.p.y-ae,ae,m)),pe.push(new KT(ke.p.x-ae,ke.p.y+ae,ae,m)),pe.push(new KT(ke.p.x+ae,ke.p.y+ae,ae,m)),ve+=4)}return y&&(console.log("num probes: "+ve),console.log("best distance: "+fe.d)),fe.p}function FK(m,p){return p.max-m.max}function KT(m,p,y,E){this.p=new D(m,p),this.h=y,this.d=function(I,R){let O=!1,L=1/0;for(let Y=0;Y<R.length;Y++){var V=R[Y];for(let ae=0,pe=V.length,fe=pe-1;ae<pe;fe=ae++){var q=V[ae],$=V[fe];q.y>I.y!=$.y>I.y&&I.x<($.x-q.x)*(I.y-q.y)/($.y-q.y)+q.x&&(O=!O),L=Math.min(L,ho(I,q,$))}}return(O?1:-1)*Math.sqrt(L)}(this.p,E),this.max=this.d+this.h*Math.SQRT2}u.TextAnchorEnum=void 0,(po=u.TextAnchorEnum||(u.TextAnchorEnum={}))[po.center=1]="center",po[po.left=2]="left",po[po.right=3]="right",po[po.top=4]="top",po[po.bottom=5]="bottom",po[po["top-left"]=6]="top-left",po[po["top-right"]=7]="top-right",po[po["bottom-left"]=8]="bottom-left",po[po["bottom-right"]=9]="bottom-right";const Up=7,t6=Number.POSITIVE_INFINITY;function VK(m,p){if(p[1]!==t6){var y=m,E=p[0],I=p[1];let L=0,V=0;switch(E=Math.abs(E),I=Math.abs(I),y){case"top-right":case"top-left":case"top":V=I-Up;break;case"bottom-right":case"bottom-left":case"bottom":V=-I+Up}switch(y){case"top-right":case"bottom-right":case"right":L=-E;break;case"top-left":case"bottom-left":case"left":L=E}return[L,V]}{y=m;var R=p[0];let V=0,q=0;var O=(R=R<0?0:R)/Math.SQRT2;switch(y){case"top-right":case"top-left":q=O-Up;break;case"bottom-right":case"bottom-left":q=-O+Up;break;case"bottom":q=-R+Up;break;case"top":q=R-Up}switch(y){case"top-right":case"bottom-right":V=-O;break;case"top-left":case"bottom-left":V=O;break;case"left":V=R;break;case"right":V=-R}return[V,q]}}function BK(m,p,y){var E=m.layout,I=null==(I=E.get("text-variable-anchor-offset"))?void 0:I.evaluate(p,{},y);if(I){var R=I.values,O=[];for(let $=0;$<R.length;$+=2){var L=O[$]=R[$],V=R[$+1].map(Y=>Y*Sa);L.startsWith("top")?V[1]-=Up:L.startsWith("bottom")&&(V[1]+=Up),O[$+1]=V}return new Ph(O)}if(I=E.get("text-variable-anchor")){let $;var q=($=void 0!==(m=m._unevaluatedLayout).getValue("text-radial-offset")?[E.get("text-radial-offset").evaluate(p,{},y)*Sa,t6]:E.get("text-offset").evaluate(p,{},y).map(ae=>ae*Sa),[]);for(const ae of I)q.push(ae,VK(ae,$));return new Ph(q)}return null}function n6(m){switch(m){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function UK(m,p,y,E,I,R,O,L,V,q,$,Y,ae,pe,fe){y=function e6(m,p,y,E,I,R,O,L){var V=E.layout.get("text-rotate").evaluate(R,{})*Math.PI/180,q=[];for(const pt of p.positionedLines)for(const gt of pt.positionedGlyphs)if(gt.rect){var $=gt.rect||{};let Vt=qD+1,vn=!0,gn=1,zt=0;var Y,ae=gt.metrics.advance*gt.scale/2,pe=(L&&p.verticalizable&&(pe=(gt.scale-1)*Sa,Y=(Sa-gt.metrics.width*gt.scale)/2,zt=pt.lineOffset/2-(gt.imageName?-Y:pe)),gt.imageName&&(vn=(Y=O[gt.imageName]).sdf,gn=Y.pixelRatio,Vt=1/gn),I?[gt.x+ae,gt.y]:[0,0]);let an=I?[0,0]:[gt.x+ae+y[0],gt.y+y[1]-zt],Wt=[0,0];(ht=(I||L)&&gt.vertical)&&(Wt=an,an=[0,0]);var ze=(_e=(gt.metrics.left-Vt)*gt.scale-ae+an[0])+$.w/(fe=gt.metrics.isDoubleResolution?2:1)*gt.scale/gn,fe=(ke=(-gt.metrics.top-Vt)*gt.scale+an[1])+$.h/fe*gt.scale/gn,ve=new D(_e,ke),ke=new D(ze,ke),_e=new D(_e,fe),Qe=(ze=new D(ze,fe),ht&&(fe=new D(-ae,ae- -17),ht=-Math.PI/2,ae=new D(22-(ae=Sa/2-ae),-(Qe=gt.imageName?ae:0)),Qe=new D(...Wt),ve._rotateAround(ht,fe)._add(ae)._add(Qe),ke._rotateAround(ht,fe)._add(ae)._add(Qe),_e._rotateAround(ht,fe)._add(ae)._add(Qe),ze._rotateAround(ht,fe)._add(ae)._add(Qe)),V&&(ht=Math.sin(V),fe=Math.cos(V),ve._matMult(ae=[fe,-ht,ht,fe]),ke._matMult(ae),_e._matMult(ae),ze._matMult(ae)),new D(0,0)),ht=new D(0,0);q.push({tl:ve,tr:ke,bl:_e,br:ze,tex:$,writingMode:p.writingMode,glyphOffset:pe,sectionIndex:gt.sectionIndex,isSDF:vn,pixelOffsetTL:Qe,pixelOffsetBR:ht,minFontScaleX:0,minFontScaleY:0})}return q}(0,y,L,I,R,O,E,m.allowVerticalPlacement);let ve=null;"source"===(E=m.textSizeData).kind?(ve=[rm*I.layout.get("text-size").evaluate(O,{})])[0]>Y_&&lt(`${m.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`):"composite"===E.kind&&((ve=[rm*pe.compositeTextSizes[0].evaluate(O,{},fe),rm*pe.compositeTextSizes[1].evaluate(O,{},fe)])[0]>Y_||ve[1]>Y_)&&lt(`${m.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`),m.addSymbols(m.text,y,ve,L,R,O,q,p,V.lineStartIndex,V.lineLength,ae,fe);for(const ke of $)Y[ke]=m.text.placedSymbolArray.length-1;return 4*y.length}function zK(m){for(const p in m)return m[p];return null}const jK=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];function r6(m,p,y,E,I,R){var O;I-E<=y||(function L(V,q,$,Y,ae,pe){for(;Y<ae;){if(600<ae-Y){const _e=ae-Y+1,ze=$-Y+1,Qe=Math.log(_e),ht=.5*Math.exp(2*Qe/3),pt=.5*Math.sqrt(Qe*ht*(_e-ht)/_e)*(ze-_e/2<0?-1:1);L(V,q,$,Math.max(Y,Math.floor($-ze*ht/_e+pt)),Math.min(ae,Math.floor($+(_e-ze)*ht/_e+pt)),pe)}const fe=q[2*$+pe];let ve=Y,ke=ae;for(eP(V,q,Y,$),q[2*ae+pe]>fe&&eP(V,q,Y,ae);ve<ke;){for(eP(V,q,ve,ke),ve++,ke--;q[2*ve+pe]<fe;)ve++;for(;q[2*ke+pe]>fe;)ke--}q[2*Y+pe]===fe?eP(V,q,Y,ke):(ke++,eP(V,q,ke,ae)),ke<=$&&(Y=ke+1),$<=ke&&(ae=ke-1)}}(m,p,O=E+I>>1,E,I,R),r6(m,p,y,E,O-1,1-R),r6(m,p,y,1+O,I,1-R))}function eP(m,p,y,E){Lh(m,y,E),Lh(p,2*y,2*E),Lh(p,2*y+1,2*E+1)}function Lh(m,p,y){var E=m[p];m[p]=m[y],m[y]=E}function EL(m,p,y,E){return(m-=y)*m+(y=p-E)*y}u.PerformanceMarkers=void 0,(ra=u.PerformanceMarkers||(u.PerformanceMarkers={})).create="create",ra.load="load",ra.fullLoad="fullLoad";let tP=null,WT=[];const i6=1e3/60,xL="loadTime",TL="fullLoadTime";po={mark(m){performance.mark(m)},frame(m){null!=tP&&WT.push(m-tP),tP=m},clearMetrics(){tP=null,WT=[],performance.clearMeasures(xL),performance.clearMeasures(TL);for(const m in u.PerformanceMarkers)performance.clearMarks(u.PerformanceMarkers[m])},getPerformanceMetrics(){performance.measure(xL,u.PerformanceMarkers.create,u.PerformanceMarkers.load),performance.measure(TL,u.PerformanceMarkers.create,u.PerformanceMarkers.fullLoad);var m=performance.getEntriesByName(xL)[0].duration,p=performance.getEntriesByName(TL)[0].duration,y=WT.length,E=1/(WT.reduce((R,O)=>R+O,0)/y/1e3),I=WT.filter(R=>R>i6).reduce((R,O)=>R+(O-i6)/i6,0);return{loadTime:m,fullLoadTime:p,fps:E,percentDroppedFrames:I/(y+I)*100,totalFrames:y}}},u.AJAXError=zn,u.Actor=class{constructor(m,p){this.target=m,this.mapId=p,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new sne(()=>this.process()),this.subscription=function nn(m,p,y,E){return m.addEventListener(p,y,E),{unsubscribe:()=>{m.removeEventListener(p,y,E)}}}(this.target,"message",y=>this.receive(y),!1),this.globalScope=xt(self)?m:window}registerMessageHandler(m,p){this.messageHandlers[m]=p}sendAsync(m,p){return new Promise((y,E)=>{const I=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[I]={resolve:y,reject:E},p&&p.signal.addEventListener("abort",()=>{delete this.resolveRejects[I];var R={id:I,type:"<cancel>",origin:location.origin,targetMapId:m.targetMapId,sourceMapId:this.mapId};this.target.postMessage(R)},{once:!0}),y=[],E=Object.assign(Object.assign({},m),{id:I,sourceMapId:this.mapId,origin:location.origin,data:Rp(m.data,y)}),this.target.postMessage(E,{transfer:y})})}receive(y){var p,E=(y=y.data).id;"file://"!==y.origin&&"file://"!==location.origin&&y.origin!==location.origin||y.targetMapId&&this.mapId!==y.targetMapId||("<cancel>"===y.type?(delete this.tasks[E],p=this.abortControllers[E],delete this.abortControllers[E],p&&p.abort()):xt(self)||y.mustQueue?(this.tasks[E]=y,this.taskQueue.push(E),this.invoker.trigger()):this.processTask(E,y))}process(){var m,p;0!==this.taskQueue.length&&(m=this.taskQueue.shift(),p=this.tasks[m],delete this.tasks[m],0<this.taskQueue.length&&this.invoker.trigger(),p)&&this.processTask(m,p)}processTask(m,p){return h(this,void 0,void 0,function*(){if("<response>"===p.type)return y=this.resolveRejects[m],delete this.resolveRejects[m],y?void(p.error?y.reject(Xf(p.error)):y.resolve(Xf(p.data))):void 0;if(this.messageHandlers[p.type]){var y=Xf(p.data),E=new AbortController;this.abortControllers[m]=E;try{var I=yield this.messageHandlers[p.type](p.sourceMapId,y,E);this.completeTask(m,null,I)}catch(R){this.completeTask(m,R)}}else this.completeTask(m,new Error(`Could not find a registered handler for ${p.type}, map ID: ${this.mapId}, available handlers: `+Object.keys(this.messageHandlers).join(", ")))})}completeTask(I,p,y){var E=[];delete this.abortControllers[I],I={id:I,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:p?Rp(p):null,data:Rp(y,E)},this.target.postMessage(I,{transfer:E})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},u.AlphaImage=Qu,u.CanonicalTileID=wL,u.CollisionBoxArray=IT,u.CollisionCircleLayoutArray=class extends Fw{},u.Color=wo,u.DEMData=Q5,u.DataConstantProperty=Bn,u.DictionaryCoder=DK,u.EXTENT=Nt,u.ErrorEvent=Ut,u.EvaluationParameters=uo,u.Event=st,u.Evented=Jt,u.FeatureIndex=RK,u.FillBucket=FT,u.FillExtrusionBucket=jD,u.GLOBAL_DISPATCHER_ID=Wr,u.GeoJSONFeature=PK,u.ImageAtlas=mK,u.ImagePosition=z5,u.KDBush=class Rpe{static from(p){if(!(p instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var y,[E,I]=new Uint8Array(p,0,2);if(219!==E)throw new Error("Data does not appear to be in a KDBush format.");if(1!=(E=I>>4))throw new Error(`Got v${E} data when expected v1.`);if(E=jK[15&I])return[I]=new Uint16Array(p,2,1),[y]=new Uint32Array(p,4,1),new Rpe(y,I,E,p);throw new Error("Unrecognized array type.")}constructor(p,y=64,E=Float64Array,I){if(isNaN(p)||p<0)throw new Error(`Unpexpected numItems value: ${p}.`);this.numItems=+p,this.nodeSize=Math.min(Math.max(+y,2),65535),this.ArrayType=E,this.IndexArrayType=p<65536?Uint16Array:Uint32Array;var R=jK.indexOf(this.ArrayType),O=2*p*this.ArrayType.BYTES_PER_ELEMENT,L=p*this.IndexArrayType.BYTES_PER_ELEMENT,V=(8-L%8)%8;if(R<0)throw new Error(`Unexpected typed array class: ${E}.`);I&&I instanceof ArrayBuffer?(this.data=I,this.ids=new this.IndexArrayType(this.data,8,p),this.coords=new this.ArrayType(this.data,8+L+V,2*p),this._pos=2*p,this._finished=!0):(this.data=new ArrayBuffer(8+O+L+V),this.ids=new this.IndexArrayType(this.data,8,p),this.coords=new this.ArrayType(this.data,8+L+V,2*p),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+R]),new Uint16Array(this.data,2,1)[0]=y,new Uint32Array(this.data,4,1)[0]=p)}add(p,y){var E=this._pos>>1;return this.ids[E]=E,this.coords[this._pos++]=p,this.coords[this._pos++]=y,E}finish(){var p=this._pos>>1;if(p!==this.numItems)throw new Error(`Added ${p} items when expected ${this.numItems}.`);return r6(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(p,y,E,I){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:R,coords:O,nodeSize:L}=this,V=[0,R.length-1,0],q=[];V.length;){var $=V.pop()||0,Y=V.pop()||0,ae=V.pop()||0;if(Y-ae<=L)for(let ze=ae;ze<=Y;ze++){var pe=O[2*ze],fe=O[2*ze+1];p<=pe&&pe<=E&&y<=fe&&fe<=I&&q.push(R[ze])}else{var ve=ae+Y>>1,ke=O[2*ve],_e=O[2*ve+1];p<=ke&&ke<=E&&y<=_e&&_e<=I&&q.push(R[ve]),(0===$?p<=ke:y<=_e)&&(V.push(ae),V.push(ve-1),V.push(1-$)),(0===$?ke<=E:_e<=I)&&(V.push(1+ve),V.push(Y),V.push(1-$))}}return q}within(p,y,E){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:I,coords:R,nodeSize:O}=this,L=[0,I.length-1,0],V=[],q=E*E;L.length;){var $=L.pop()||0,Y=L.pop()||0,ae=L.pop()||0;if(Y-ae<=O)for(let ke=ae;ke<=Y;ke++)EL(R[2*ke],R[2*ke+1],p,y)<=q&&V.push(I[ke]);else{var pe=ae+Y>>1,fe=R[2*pe],ve=R[2*pe+1];EL(fe,ve,p,y)<=q&&V.push(I[pe]),(0===$?p-E<=fe:y-E<=ve)&&(L.push(ae),L.push(pe-1),L.push(1-$)),(0===$?fe<=p+E:ve<=y+E)&&(L.push(1+pe),L.push(Y),L.push(1-$))}}return V}},u.LineBucket=HD,u.LineStripIndexArray=class extends Fp{},u.LngLat=Hg,u.MercatorCoordinate=vL,u.ONE_EM=Sa,u.OverscaledTileID=Nh,u.PerformanceUtils=po,u.Point=D,u.Pos3dArray=class extends ET{},u.PosArray=ND,u.Properties=cc,u.Protobuf=$D,u.QuadTriangleArray=class extends V_{},u.RGBAImage=kh,u.RasterBoundsArray=class extends xT{},u.RequestPerformance=class{constructor(m){this._marks={start:[m.url,"start"].join("#"),end:[m.url,"end"].join("#"),measure:m.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let m=performance.getEntriesByName(this._marks.measure);return 0===m.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),m=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),m}},u.SegmentVector=A,u.SymbolBucket=ZD,u.Transitionable=wT,u.TriangleIndexArray=Jf,u.Uniform1f=re,u.Uniform1i=class extends K{constructor(m,p){super(m,p),this.current=0}set(m){this.current!==m&&(this.current=m,this.gl.uniform1i(this.location,m))}},u.Uniform2f=class extends K{constructor(m,p){super(m,p),this.current=[0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]||(this.current=m,this.gl.uniform2f(this.location,m[0],m[1]))}},u.Uniform3f=class extends K{constructor(m,p){super(m,p),this.current=[0,0,0]}set(m){m[0]===this.current[0]&&m[1]===this.current[1]&&m[2]===this.current[2]||(this.current=m,this.gl.uniform3f(this.location,m[0],m[1],m[2]))}},u.Uniform4f=ce,u.UniformColor=ee,u.UniformMatrix4f=class extends K{constructor(m,p){super(m,p),this.current=he}set(m){if(m[12]!==this.current[12]||m[0]!==this.current[0])this.current=m,this.gl.uniformMatrix4fv(this.location,!1,m);else for(let p=1;p<16;p++)if(m[p]!==this.current[p]){this.current=m,this.gl.uniformMatrix4fv(this.location,!1,m);break}}},u.UnwrappedTileID=Z5,u.ValidationError=Pe,u.ZoomHistory=Dw,u.__awaiter=h,u.add=function(m,p,y){return m[0]=p[0]+y[0],m[1]=p[1]+y[1],m[2]=p[2]+y[2],m},u.addDynamicAttributes=q5,u.addProtocol=function(m,p){Qn.REGISTERED_PROTOCOLS[m]=p},u.arrayBufferToImage=m=>new Promise((p,y)=>{const E=new Image;E.onload=()=>{p(E),URL.revokeObjectURL(E.src),E.onload=null,window.requestAnimationFrame(()=>{E.src=We})},E.onerror=()=>y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));var I=new Blob([new Uint8Array(m)],{type:"image/png"});E.src=m.byteLength?URL.createObjectURL(I):We}),u.arrayBufferToImageBitmap=m=>h(void 0,void 0,void 0,function*(){if(0===m.byteLength)return createImageBitmap(new ImageData(1,1));var p=new Blob([new Uint8Array(m)],{type:"image/png"});try{return createImageBitmap(p)}catch(y){throw new Error(`Could not load image because of ${y.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),u.bezier=et,u.clamp=Mt,u.clipLine=HT,u.clone=function(m){var p=new Ls(16);return p[0]=m[0],p[1]=m[1],p[2]=m[2],p[3]=m[3],p[4]=m[4],p[5]=m[5],p[6]=m[6],p[7]=m[7],p[8]=m[8],p[9]=m[9],p[10]=m[10],p[11]=m[11],p[12]=m[12],p[13]=m[13],p[14]=m[14],p[15]=m[15],p},u.clone$1=Et,u.clone$2=function(m){var p=new Ls(3);return p[0]=m[0],p[1]=m[1],p[2]=m[2],p},u.collisionCircleLayout=Ip,u.config=Qn,u.copy=function(m,p){return m[0]=p[0],m[1]=p[1],m[2]=p[2],m[3]=p[3],m[4]=p[4],m[5]=p[5],m[6]=p[6],m[7]=p[7],m[8]=p[8],m[9]=p[9],m[10]=p[10],m[11]=p[11],m[12]=p[12],m[13]=p[13],m[14]=p[14],m[15]=p[15],m},u.create=function(){var m=new Ls(16);return Ls!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=0,m[12]=0,m[13]=0,m[14]=0),m[0]=1,m[5]=1,m[10]=1,m[15]=1,m},u.create$1=Vp,u.create$2=function(){var m=new Ls(4);return Ls!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m},u.createAbortError=pi,u.createExpression=Ew,u.createFilter=cT,u.createLayout=ta,u.createStyleLayer=function(m){if("custom"===m.type)return new one(m);switch(m.type){case"background":return new rne(m);case"circle":return new Bp(m);case"fill":return new A5(m);case"fill-extrusion":return new Yw(m);case"heatmap":return new eL(m);case"hillshade":return new Pte(m);case"line":return new qte(m);case"raster":return new ine(m);case"symbol":return new yL(m)}},u.cross=function Cd(m,R,V){var E=R[0],I=R[1],O=V[0],L=V[1];return m[0]=I*(V=V[2])-(R=R[2])*L,m[1]=R*O-E*V,m[2]=E*L-I*O,m},u.deepEqual=function m(p,y){if(Array.isArray(p)){if(!Array.isArray(y)||p.length!==y.length)return!1;for(let E=0;E<p.length;E++)if(!m(p[E],y[E]))return!1}else{if("object"!=typeof p||null===p||null===y)return p===y;if("object"!=typeof y||Object.keys(p).length!==Object.keys(y).length)return!1;for(const E in p)if(!m(p[E],y[E]))return!1}return!0},u.defaultEasing=P,u.degreesToRadians=function(m){return m*Math.PI/180},u.derefLayers=function(m){m=m.slice();var p=Object.create(null);for(let y=0;y<m.length;y++)p[m[y].id]=m[y];for(let y=0;y<m.length;y++)"ref"in m[y]&&(m[y]=function(E,I){const R={};for(const O in E)"ref"!==O&&(R[O]=E[O]);return ne.forEach(O=>{O in I&&(R[O]=I[O])}),R}(m[y],p[m[y].ref]));return m},u.diffStyles=function(m,p){if(!m)return[{command:"setStyle",args:[p]}];let y=[];try{if(!X(m.version,p.version))return[{command:"setStyle",args:[p]}];X(m.center,p.center)||y.push({command:"setCenter",args:[p.center]}),X(m.zoom,p.zoom)||y.push({command:"setZoom",args:[p.zoom]}),X(m.bearing,p.bearing)||y.push({command:"setBearing",args:[p.bearing]}),X(m.pitch,p.pitch)||y.push({command:"setPitch",args:[p.pitch]}),X(m.sprite,p.sprite)||y.push({command:"setSprite",args:[p.sprite]}),X(m.glyphs,p.glyphs)||y.push({command:"setGlyphs",args:[p.glyphs]}),X(m.transition,p.transition)||y.push({command:"setTransition",args:[p.transition]}),X(m.light,p.light)||y.push({command:"setLight",args:[p.light]}),X(m.terrain,p.terrain)||y.push({command:"setTerrain",args:[p.terrain]}),X(m.sky,p.sky)||y.push({command:"setSky",args:[p.sky]});const ve={};var E=[];!function Ke(m,p,y,E){let I;for(I in p=p||{},m=m||{})!Object.prototype.hasOwnProperty.call(m,I)||Object.prototype.hasOwnProperty.call(p,I)||De(I,y,E);for(I in p)Object.prototype.hasOwnProperty.call(p,I)&&(Object.prototype.hasOwnProperty.call(m,I)?X(m[I],p[I])||("geojson"===m[I].type&&"geojson"===p[I].type&&function(V,q,$){let Y;for(Y in V[$])if(Object.prototype.hasOwnProperty.call(V[$],Y)&&"data"!==Y&&!X(V[$][Y],q[$][Y]))return;for(Y in q[$])if(Object.prototype.hasOwnProperty.call(q[$],Y)&&"data"!==Y&&!X(V[$][Y],q[$][Y]))return;return 1}(m,p,I)?ie(y,{command:"setGeoJSONSourceData",args:[I,p[I].data]}):(O=p,De(R=I,L=y,E),ye(R,O,L))):ye(I,p,y));var R,O,L}(m.sources,p.sources,E,ve);const ke=[];m.layers&&m.layers.forEach(_e=>{"source"in _e&&ve[_e.source]?y.push({command:"removeLayer",args:[_e.id]}):ke.push(_e)}),y=y.concat(E);{var I=ke,R=p.layers,O=y;R=R||[];var L,V,q=(I=I||[]).map(wt),$=R.map(wt),Y=I.reduce(Me,{}),ae=R.reduce(Me,{}),pe=q.slice(),fe=Object.create(null);let _e,ze,Qe;for(let ht=0,pt=0;ht<q.length;ht++)_e=q[ht],Object.prototype.hasOwnProperty.call(ae,_e)?pt++:(ie(O,{command:"removeLayer",args:[_e]}),pe.splice(pe.indexOf(_e,pt),1));for(let ht=0,pt=0;ht<$.length;ht++)_e=$[$.length-1-ht],pe[pe.length-1-ht]!==_e&&(Object.prototype.hasOwnProperty.call(Y,_e)?(ie(O,{command:"removeLayer",args:[_e]}),pe.splice(pe.lastIndexOf(_e,pe.length-pt),1)):pt++,ze=pe[pe.length-ht],ie(O,{command:"addLayer",args:[ae[_e],ze]}),pe.splice(pe.length-ht,0,_e),fe[_e]=!0);for(let ht=0;ht<$.length;ht++)if(L=Y[_e=$[ht]],V=ae[_e],!fe[_e]&&!X(L,V))if(X(L.source,V.source)&&X(L["source-layer"],V["source-layer"])&&X(L.type,V.type)){for(Qe in ct(L.layout,V.layout,O,_e,null,"setLayoutProperty"),ct(L.paint,V.paint,O,_e,null,"setPaintProperty"),X(L.filter,V.filter)||ie(O,{command:"setFilter",args:[_e,V.filter]}),X(L.minzoom,V.minzoom)&&X(L.maxzoom,V.maxzoom)||ie(O,{command:"setLayerZoomRange",args:[_e,V.minzoom,V.maxzoom]}),L)Object.prototype.hasOwnProperty.call(L,Qe)&&"layout"!==Qe&&"paint"!==Qe&&"filter"!==Qe&&"metadata"!==Qe&&"minzoom"!==Qe&&"maxzoom"!==Qe&&(0===Qe.indexOf("paint.")?ct(L[Qe],V[Qe],O,_e,Qe.slice(6),"setPaintProperty"):X(L[Qe],V[Qe])||ie(O,{command:"setLayerProperty",args:[_e,Qe,V[Qe]]}));for(Qe in V)Object.prototype.hasOwnProperty.call(V,Qe)&&!Object.prototype.hasOwnProperty.call(L,Qe)&&"layout"!==Qe&&"paint"!==Qe&&"filter"!==Qe&&"metadata"!==Qe&&"minzoom"!==Qe&&"maxzoom"!==Qe&&(0===Qe.indexOf("paint.")?ct(L[Qe],V[Qe],O,_e,Qe.slice(6),"setPaintProperty"):X(L[Qe],V[Qe])||ie(O,{command:"setLayerProperty",args:[_e,Qe,V[Qe]]}))}else ie(O,{command:"removeLayer",args:[_e]}),ie(O,{command:"addLayer",args:[V,ze=pe[pe.lastIndexOf(_e)+1]]})}}catch(ve){console.warn("Unable to compute style diff:",ve),y=[{command:"setStyle",args:[p]}]}return y},u.dot=function em(m,p){return m[0]*p[0]+m[1]*p[1]+m[2]*p[2]},u.dot$1=function(m,p){return m[0]*p[0]+m[1]*p[1]+m[2]*p[2]+m[3]*p[3]},u.earthRadius=_L,u.emitValidationErrors=gT,u.emptyStyle=function(){var m={},p=oe.$version;for(const E in oe.$root){var y=oe.$root[E];if(y.required){let I=null;null!=(I="version"===E?p:"array"===y.type?[]:{})&&(m[E]=I)}}return m},u.equals=function(_e,Nn){var y=_e[0],E=_e[1],I=_e[2],R=_e[3],O=_e[4],L=_e[5],V=_e[6],q=_e[7],$=_e[8],Y=_e[9],ae=_e[10],pe=_e[11],fe=_e[12],ve=_e[13],ke=_e[14],ze=(_e=_e[15],Nn[0]),Qe=Nn[1],ht=Nn[2],pt=Nn[3],gt=Nn[4],Vt=Nn[5],vn=Nn[6],gn=Nn[7],zt=Nn[8],an=Nn[9],Wt=Nn[10],$t=Nn[11],Tt=Nn[12],Dn=Nn[13],Tn=Nn[14];return Nn=Nn[15],Math.abs(y-ze)<=Cs*Math.max(1,Math.abs(y),Math.abs(ze))&&Math.abs(E-Qe)<=Cs*Math.max(1,Math.abs(E),Math.abs(Qe))&&Math.abs(I-ht)<=Cs*Math.max(1,Math.abs(I),Math.abs(ht))&&Math.abs(R-pt)<=Cs*Math.max(1,Math.abs(R),Math.abs(pt))&&Math.abs(O-gt)<=Cs*Math.max(1,Math.abs(O),Math.abs(gt))&&Math.abs(L-Vt)<=Cs*Math.max(1,Math.abs(L),Math.abs(Vt))&&Math.abs(V-vn)<=Cs*Math.max(1,Math.abs(V),Math.abs(vn))&&Math.abs(q-gn)<=Cs*Math.max(1,Math.abs(q),Math.abs(gn))&&Math.abs($-zt)<=Cs*Math.max(1,Math.abs($),Math.abs(zt))&&Math.abs(Y-an)<=Cs*Math.max(1,Math.abs(Y),Math.abs(an))&&Math.abs(ae-Wt)<=Cs*Math.max(1,Math.abs(ae),Math.abs(Wt))&&Math.abs(pe-$t)<=Cs*Math.max(1,Math.abs(pe),Math.abs($t))&&Math.abs(fe-Tt)<=Cs*Math.max(1,Math.abs(fe),Math.abs(Tt))&&Math.abs(ve-Dn)<=Cs*Math.max(1,Math.abs(ve),Math.abs(Dn))&&Math.abs(ke-Tn)<=Cs*Math.max(1,Math.abs(ke),Math.abs(Tn))&&Math.abs(_e-Nn)<=Cs*Math.max(1,Math.abs(_e),Math.abs(Nn))},u.evaluateSizeForFeature=function(m,{uSize:p,uSizeT:y},{lowerSize:E,upperSize:I}){return"source"===m.kind?E/rm:"composite"===m.kind?al.number(E/rm,I/rm,y):p},u.evaluateSizeForZoom=function(m,p){let y=0,E=0;var I,R,O;return"constant"===m.kind?E=m.layoutSize:"source"!==m.kind&&(({interpolationType:O,minZoom:I,maxZoom:R}=m),O=O?Mt(Wu.interpolationFactor(O,p,I,R),0,1):0,"camera"===m.kind?E=al.number(m.minSize,m.maxSize,O):y=O),{uSizeT:y,uSize:E}},u.exactEquals=function(m,p){return m[0]===p[0]&&m[1]===p[1]&&m[2]===p[2]&&m[3]===p[3]&&m[4]===p[4]&&m[5]===p[5]&&m[6]===p[6]&&m[7]===p[7]&&m[8]===p[8]&&m[9]===p[9]&&m[10]===p[10]&&m[11]===p[11]&&m[12]===p[12]&&m[13]===p[13]&&m[14]===p[14]&&m[15]===p[15]},u.extend=Qt,u.filterObject=ot,u.findLineIntersection=function(m,R,y,L){var I=R.y-m.y,O=L.y-y.y,V=O*(R=R.x-m.x)-(L=L.x-y.x)*I;return 0==V?null:new D(m.x+(L=(L*(m.y-y.y)-O*(m.x-y.x))/V)*R,m.y+L*I)},u.fromRotation=function(m,E){var y=Math.sin(E);return E=Math.cos(E),m[0]=E,m[1]=y,m[2]=0,m[3]=-y,m[4]=E,m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},u.fromScaling=function(m,p){return m[0]=p[0],m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=p[1],m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=p[2],m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m},u.getAnchorAlignment=pL,u.getAnchorJustification=n6,u.getArrayBuffer=(m,p)=>Ao(Qt(m,{type:"arrayBuffer"}),p),u.getDefaultExportFromCjs=g,u.getImageData=function(m,p,y,E,I){return h(this,void 0,void 0,function*(){if(we())try{return yield on(m,p,y,E,I)}catch{}return O=p,L=y,V=E,q=I,$=(R=m).width,Y=R.height,Rn&&sr||(Rn=new OffscreenCanvas($,Y),sr=Rn.getContext("2d",{willReadFrequently:!0})),Rn.width=$,Rn.height=Y,sr.drawImage(R,0,0,$,Y),R=sr.getImageData(O,L,V,q),sr.clearRect(0,0,$,Y),R.data;var R,O,L,V,q,$,Y})},u.getJSON=(m,p)=>Ao(Qt(m,{type:"json"}),p),u.getOverlapMode=YD,u.getProtocol=ar,u.getReferrer=Fr,u.getVideo=m=>{const p=window.document.createElement("video");return p.muted=!0,new Promise(y=>{p.onloadstart=()=>{y(p)};for(const I of m){var E=window.document.createElement("source");Ht(I)||(p.crossOrigin="Anonymous"),E.src=I,p.appendChild(E)}})},u.groupByLayout=function(m,p){var y={};for(let R=0;R<m.length;R++){var E=p&&p[m[R].id]||qN(m[R]);p&&(p[m[R].id]=E);let O=y[E];(O=O||(y[E]=[])).push(m[R])}var I=[];for(const R in y)I.push(y[R]);return I},u.identity=Po,u.interpolate=al,u.invert=function(m,_e){var y=_e[0],E=_e[1],I=_e[2],R=_e[3],O=_e[4],L=_e[5],V=_e[6],q=_e[7],$=_e[8],Y=_e[9],ae=_e[10],pe=_e[11],fe=_e[12],ve=_e[13],ke=_e[14],ze=y*L-E*O,Qe=y*V-I*O,ht=y*q-R*O,pt=E*V-I*L,gt=E*q-R*L,Vt=I*q-R*V,vn=$*ve-Y*fe,gn=$*ke-ae*fe,zt=$*(_e=_e[15])-pe*fe,an=Y*ke-ae*ve,Wt=Y*_e-pe*ve,$t=ae*_e-pe*ke,Tt=ze*$t-Qe*Wt+ht*an+pt*zt-gt*gn+Vt*vn;return Tt?(m[0]=(L*$t-V*Wt+q*an)*(Tt=1/Tt),m[1]=(I*Wt-E*$t-R*an)*Tt,m[2]=(ve*Vt-ke*gt+_e*pt)*Tt,m[3]=(ae*gt-Y*Vt-pe*pt)*Tt,m[4]=(V*zt-O*$t-q*gn)*Tt,m[5]=(y*$t-I*zt+R*gn)*Tt,m[6]=(ke*ht-fe*Vt-_e*Qe)*Tt,m[7]=($*Vt-ae*ht+pe*Qe)*Tt,m[8]=(O*Wt-L*zt+q*vn)*Tt,m[9]=(E*zt-y*Wt-R*vn)*Tt,m[10]=(fe*gt-ve*ht+_e*ze)*Tt,m[11]=(Y*ht-$*gt-pe*ze)*Tt,m[12]=(L*gn-O*an-V*vn)*Tt,m[13]=(y*an-E*gn+I*vn)*Tt,m[14]=(ve*Qe-fe*pt-ke*ze)*Tt,m[15]=($*pt-Y*Qe+ae*ze)*Tt,m):null},u.isAbortError=function(m){return m.message===dt},u.isImageBitmap=Sn,u.isOffscreenCanvasDistorted=we,u.isSafari=function(m){var p;return null==ln&&(p=m.navigator?m.navigator.userAgent:null,ln=!!m.safari||!(!p||!(/\b(iPad|iPhone|iPod)\b/.test(p)||p.match("Safari")&&!p.match("Chrome")))),ln},u.isWorker=xt,u.keysDifference=function(m,p){var y=[];for(const E in m)E in p||y.push(E);return y},u.makeRequest=Ao,u.mapObject=Je,u.mercatorXfromLng=SK,u.mercatorYfromLat=qs,u.mercatorZfromAltitude=Fs,u.mul=_w,u.mul$1=function tm(m,p,y){return m[0]=p[0]*y[0],m[1]=p[1]*y[1],m[2]=p[2]*y[2],m[3]=p[3]*y[3],m},u.multiply=Dl,u.nextPowerOfTwo=function(m){return m<=1?1:Math.pow(2,Math.ceil(Math.log(m)/Math.LN2))},u.normalize=function za(m,p){var I,y=p[1],E=p[2];return 0<(I=(I=p[0])*I+y*y+E*E)&&(I=1/Math.sqrt(I)),m[0]=p[0]*I,m[1]=p[1]*I,m[2]=p[2]*I,m},u.offscreenCanvasSupported=ue,u.ortho=function Eo(m,p,y,E,I,R,O){var L=1/(p-y),V=1/(E-I),q=1/(R-O);return m[0]=-2*L,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=-2*V,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=2*q,m[11]=0,m[12]=(p+y)*L,m[13]=(I+E)*V,m[14]=(O+R)*q,m[15]=1,m},u.parseCacheControl=function(m){const p={};return m.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(y,E,I,R)=>(p[E]=!(I=I||R)||I.toLowerCase(),"")),p["max-age"]&&(m=parseInt(p["max-age"],10),isNaN(m)?delete p["max-age"]:p["max-age"]=m),p},u.parseGlyphPbf=function(m){return new $D(m).readFields(Xte,[])},u.pbf=Oh,u.performSymbolLayout=function(m){m.bucket.createArrays();var p,y,E=512*m.bucket.overscaling,I=(m.bucket.tilePixelRatio=Nt/E,m.bucket.compareText={},m.bucket.iconsNeedLinear=!1,m.bucket.layers[0]),R=I.layout,O={layoutIconSize:(E=I._unevaluatedLayout._values)["icon-size"].possiblyEvaluate(new uo(m.bucket.zoom+1),m.canonical),layoutTextSize:E["text-size"].possiblyEvaluate(new uo(m.bucket.zoom+1),m.canonical),textMaxSize:E["text-size"].possiblyEvaluate(new uo(18))};"composite"===m.bucket.textSizeData.kind&&(({minZoom:p,maxZoom:y}=m.bucket.textSizeData),O.compositeTextSizes=[E["text-size"].possiblyEvaluate(new uo(p),m.canonical),E["text-size"].possiblyEvaluate(new uo(y),m.canonical)]),"composite"===m.bucket.iconSizeData.kind&&(({minZoom:p,maxZoom:y}=m.bucket.iconSizeData),O.compositeIconSizes=[E["icon-size"].possiblyEvaluate(new uo(p),m.canonical),E["icon-size"].possiblyEvaluate(new uo(y),m.canonical)]);const L=R.get("text-line-height")*Sa;var V="viewport"!==R.get("text-rotation-alignment")&&"point"!==R.get("symbol-placement"),q=R.get("text-keep-upright"),$=R.get("text-size");for(const _e of m.bucket.features){const ze=R.get("text-font").evaluate(_e,{},m.canonical).join(","),Qe=$.evaluate(_e,{},m.canonical),ht=O.layoutTextSize.evaluate(_e,{},m.canonical);var Y=O.layoutIconSize.evaluate(_e,{},m.canonical);const pt={horizontal:{},vertical:void 0},gt=_e.text;let Vt=[0,0];if(gt){const zt=gt.toString();var ae=R.get("text-letter-spacing").evaluate(_e,{},m.canonical)*Sa;const an=yT(zt)?ae:0,Wt=R.get("text-anchor").evaluate(_e,{},m.canonical);var pe=BK(I,_e,m.canonical);pe||(ae=R.get("text-radial-offset").evaluate(_e,{},m.canonical),Vt=ae?VK(Wt,[ae*Sa,t6]):R.get("text-offset").evaluate(_e,{},m.canonical).map(Tn=>Tn*Sa));let $t=V?"center":R.get("text-justify").evaluate(_e,{},m.canonical);const Tt=R.get("symbol-placement"),Dn="point"===Tt?R.get("text-max-width").evaluate(_e,{},m.canonical)*Sa:0;if(ae=()=>{m.bucket.allowVerticalPlacement&&Ng(zt)&&(pt.vertical=dL(gt,m.glyphMap,m.glyphPositions,m.imagePositions,ze,Dn,L,Wt,"left",an,Vt,u.WritingMode.vertical,!0,Tt,ht,Qe))},!V&&pe){var fe,ve=new Set;if("auto"===$t)for(let Nn=0;Nn<pe.values.length;Nn+=2)ve.add(n6(pe.values[Nn]));else ve.add($t);let Tn=!1;for(const Nn of ve)pt.horizontal[Nn]||(Tn?pt.horizontal[Nn]=pt.horizontal[0]:(fe=dL(gt,m.glyphMap,m.glyphPositions,m.imagePositions,ze,Dn,L,"center",Nn,an,Vt,u.WritingMode.horizontal,!1,Tt,ht,Qe))&&(pt.horizontal[Nn]=fe,Tn=1===fe.positionedLines.length));ae()}else{"auto"===$t&&($t=n6(Wt));var ke=dL(gt,m.glyphMap,m.glyphPositions,m.imagePositions,ze,Dn,L,Wt,$t,an,Vt,u.WritingMode.horizontal,!1,Tt,ht,Qe);ke&&(pt.horizontal[$t]=ke),ae(),Ng(zt)&&V&&q&&(pt.vertical=dL(gt,m.glyphMap,m.glyphPositions,m.imagePositions,ze,Dn,L,Wt,$t,an,Vt,u.WritingMode.vertical,!1,Tt,ht,Qe))}}let vn,gn=!1;_e.icon&&_e.icon.name&&(ke=m.imageMap[_e.icon.name])&&(vn=function(zt,Tn,Dn){var{horizontalAlign:Dn,verticalAlign:$t}=pL(Dn),Tt=Tn[0];return Dn=(Tt-=zt.displaySize[0]*Dn)+zt.displaySize[0],{image:zt,top:Tn=(Tn=Tn[1])-zt.displaySize[1]*$t,bottom:Tn+zt.displaySize[1],left:Tt,right:Dn}}(m.imagePositions[_e.icon.name],R.get("icon-offset").evaluate(_e,{},m.canonical),R.get("icon-anchor").evaluate(_e,{},m.canonical)),gn=!!ke.sdf,void 0===m.bucket.sdfIcons?m.bucket.sdfIcons=gn:m.bucket.sdfIcons!==gn&&lt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),ke.pixelRatio!==m.bucket.pixelRatio||0!==R.get("icon-rotate").constantOr(1))&&(m.bucket.iconsNeedLinear=!0),ae=zK(pt.horizontal)||pt.vertical,m.bucket.iconsInText=!!ae&&ae.iconsInText,(ae||vn)&&function(zt,an,Wt,$t,Tt,Dn,Tn,Nn,wr,Jr,Cr){let Vi=Dn.textMaxSize.evaluate(an,{});void 0===Vi&&(Vi=Tn);const Zn=zt.layers[0].layout,kr=Zn.get("icon-offset").evaluate(an,{},Cr),Ci=zK(Wt.horizontal),mo=Tn/24,Xu=zt.tilePixelRatio*mo,Fc=zt.tilePixelRatio*Vi/24,Mi=zt.tilePixelRatio*Nn,Ir=zt.tilePixelRatio*Zn.get("symbol-spacing"),Fh=Zn.get("text-padding")*zt.tilePixelRatio,Z_=function(hi,ji,Hi,Vs=1){return[(ji=(hi=hi.get("icon-padding").evaluate(ji,{},Hi))&&hi.values)[0]*Vs,ji[1]*Vs,ji[2]*Vs,ji[3]*Vs]}(Zn,an,Cr,zt.tilePixelRatio),uc=Zn.get("text-max-angle")/180*Math.PI,zp="viewport"!==Zn.get("text-rotation-alignment")&&"point"!==Zn.get("symbol-placement"),hc="map"===Zn.get("icon-rotation-alignment")&&"point"!==Zn.get("symbol-placement"),Dd=Zn.get("symbol-placement"),Vh=Ir/2,nP=Zn.get("icon-text-fit");let Aa;$t&&"none"!==nP&&(zt.allowVerticalPlacement&&Wt.vertical&&(Aa=wK($t,Wt.vertical,nP,Zn.get("icon-text-fit-padding"),kr,mo)),Ci)&&($t=wK($t,Ci,nP,Zn.get("icon-text-fit-padding"),kr,mo));var Pl=(hi,ji)=>{if(!(ji.x<0||ji.x>=Nt||ji.y<0||ji.y>=Nt)){var Hi=zt,Vs=ji;ji=hi;var fa=Wt;hi=$t;var pu=Tt,Fo=Aa,ia=zt.layers[0],Ha=zt.collisionBoxArray,Rl=an.index,Ju=an.sourceLayerIndex,Ml=zt.index,dc=Xu,Rd=[Fh,Fh,Fh,Fh],jp=zp,YT=wr,im=Mi,rP=Z_,om=hc,iP=kr,Bh=an,ZT=Dn,Q_=Jr,sm=Cr,CL=Tn,Jw=Hi.addToLineVertexArray(Vs,ji);let QT,sP,XT,aP,HK=0,$K=0,fne=0,mne=0,l6=-1,c6=-1;var X_={};let qK=x("");if(Hi.allowVerticalPlacement&&fa.vertical&&(ji=ia.layout.get("text-rotate").evaluate(Bh,{},sm)+90,XT=new qT(Ha,Vs,Rl,Ju,Ml,oP=fa.vertical,dc,Rd,jp,ji),Fo)&&(aP=new qT(Ha,Vs,Rl,Ju,Ml,Fo,im,rP,jp,ji)),hi){var oP=ia.layout.get("icon-rotate").evaluate(Bh,{}),o6=NK(hi,oP,Q_,ji="none"!==ia.layout.get("icon-text-fit"));Fo=Fo?NK(Fo,oP,Q_,ji):void 0;let eh=null;"source"===(sP=new qT(Ha,Vs,Rl,Ju,Ml,hi,im,rP,!1,oP),HK=4*o6.length,Q_=Hi.iconSizeData).kind?(eh=[rm*ia.layout.get("icon-size").evaluate(Bh,{})])[0]>Y_&&lt(`${Hi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`):"composite"===Q_.kind&&((eh=[rm*ZT.compositeIconSizes[0].evaluate(Bh,{},sm),rm*ZT.compositeIconSizes[1].evaluate(Bh,{},sm)])[0]>Y_||eh[1]>Y_)&&lt(`${Hi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`),Hi.addSymbols(Hi.icon,o6,eh,iP,om,Bh,u.WritingMode.none,Vs,Jw.lineStartIndex,Jw.lineLength,-1,sm),l6=Hi.icon.placedSymbolArray.length-1,Fo&&($K=4*Fo.length,Hi.addSymbols(Hi.icon,Fo,eh,iP,om,Bh,u.WritingMode.vertical,Vs,Jw.lineStartIndex,Jw.lineLength,-1,sm),c6=Hi.icon.placedSymbolArray.length-1)}var pne=Object.keys(fa.horizontal);for(const wn of pne){var s6=fa.horizontal[wn],a6=(QT||(qK=x(s6.text),a6=ia.layout.get("text-rotate").evaluate(Bh,{},sm),QT=new qT(Ha,Vs,Rl,Ju,Ml,s6,dc,Rd,jp,a6)),1===s6.positionedLines.length);if(fne+=UK(Hi,Vs,s6,pu,ia,jp,Bh,YT,Jw,fa.vertical?u.WritingMode.horizontal:u.WritingMode.horizontalOnly,a6?pne:[wn],X_,l6,ZT,sm),a6)break}fa.vertical&&(mne+=UK(Hi,Vs,fa.vertical,pu,ia,jp,Bh,YT,Jw,u.WritingMode.vertical,["vertical"],X_,c6,ZT,sm)),ji=QT?QT.boxStartIndex:Hi.collisionBoxArray.length,hi=QT?QT.boxEndIndex:Hi.collisionBoxArray.length,im=XT?XT.boxStartIndex:Hi.collisionBoxArray.length,rP=XT?XT.boxEndIndex:Hi.collisionBoxArray.length,Q_=sP?sP.boxStartIndex:Hi.collisionBoxArray.length,o6=sP?sP.boxEndIndex:Hi.collisionBoxArray.length,Fo=aP?aP.boxStartIndex:Hi.collisionBoxArray.length,iP=aP?aP.boxEndIndex:Hi.collisionBoxArray.length;let $a=-1;$a=(om=(wn,eb)=>wn&&wn.circleDiameter?Math.max(wn.circleDiameter,eb):eb)(QT,$a),$a=om(XT,$a),$a=om(sP,$a),(om=-1<($a=om(aP,$a))?1:0)&&($a*=CL/Sa),Hi.glyphOffsetArray.length>=ZD.MAX_GLYPHS&&lt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Bh.sortKey&&Hi.addToSortKeyRanges(Hi.symbolInstances.length,Bh.sortKey),CL=BK(ia,Bh,sm);var[CL,Jae]=function(wn,eb){var ei=wn.length,eh=eb?.values;if(0<eh?.length)for(let JT=0;JT<eh.length;JT+=2){var GK=eh[JT+1];wn.emplaceBack(u.TextAnchorEnum[eh[JT]],GK[0],GK[1])}return[ei,wn.length]}(Hi.textAnchorOffsets,CL);Hi.symbolInstances.emplaceBack(Vs.x,Vs.y,0<=X_.right?X_.right:-1,0<=X_.center?X_.center:-1,0<=X_.left?X_.left:-1,X_.vertical||-1,l6,c6,qK,ji,hi,im,rP,Q_,o6,Fo,iP,Rl,fne,mne,HK,$K,om,0,dc,$a,CL,Jae)}};if("line"===Dd)for(const hi of HT(an.geometry,0,0,Nt,Nt))for(const ji of dne(hi,Ir,uc,Wt.vertical||Ci,$t,24,Fc,zt.overscaling,Nt))Ci&&function(Hi,Vs,fa,pu){if(Vs in(Hi=Hi.compareText)){var Fo=Hi[Vs];for(let ia=Fo.length-1;0<=ia;ia--)if(pu.dist(Fo[ia])<fa)return 1}else Hi[Vs]=[];return Hi[Vs].push(pu),0}(zt,Ci.text,Vh,ji)||Pl(hi,ji);else if("line-center"===Dd)for(const hi of an.geometry){var Pd;1<hi.length&&(Pd=function(ji,Hi,Vs,fa,pu,Fo){var ia=kK(Vs,24,Fo),Ha=OK(Vs,fa)*Fo;let Rl=0;var Ju=MK(ji)/2;for(let im=0;im<ji.length-1;im++){var Ml,dc,Rd=ji[im],jp=ji[im+1],YT=Rd.dist(jp);if(Rl+YT>Ju)return dc=al.number(Rd.x,jp.x,Ml=(Ju-Rl)/YT),Ml=al.number(Rd.y,jp.y,Ml),(dc=new Ad(dc,Ml,jp.angleTo(Rd),im))._round(),!ia||Lc(ji,dc,Ha,ia,Hi)?dc:void 0;Rl+=YT}}(hi,uc,Wt.vertical||Ci,$t,0,Fc))&&Pl(hi,Pd)}else if("Polygon"===an.type)for(const hi of C5(an.geometry,0)){var qg=GT(hi,16);Pl(hi[0],new Ad(qg.x,qg.y,0))}else if("LineString"===an.type)for(const hi of an.geometry)Pl(hi,new Ad(hi[0].x,hi[0].y,0));else if("Point"===an.type)for(const hi of an.geometry)for(const ji of hi)Pl([ji],new Ad(ji.x,ji.y,0))}(m.bucket,_e,pt,vn,m.imageMap,O,ht,Y,Vt,gn,m.canonical)}m.showCollisionBoxes&&m.bucket.generateCollisionDebugBuffers()},u.perspective=function Lo(m,p,y,E,I){return p=1/Math.tan(p/2),m[0]=p/y,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=p,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[11]=-1,m[12]=0,m[13]=0,m[15]=0,null!=I&&I!==1/0?(m[10]=(I+E)*(y=1/(E-I)),m[14]=2*I*E*y):(m[10]=-1,m[14]=-2*E),m},u.pick=function(m,p){var y={};for(let I=0;I<p.length;I++){var E=p[I];E in m&&(y[E]=m[E])}return y},u.pointGeometry=w,u.polygonIntersectsPolygon=Un,u.potpack=fK,u.readImageUsingVideoFrame=on,u.register=Cn,u.removeProtocol=function(m){delete Qn.REGISTERED_PROTOCOLS[m]},u.renderColorRamp=Y7,u.renderStyleImage=function(m){var p=m.userImage;return!!(p&&p.render&&p.render())&&(m.data.replace(new Uint8Array(p.data.buffer)),!0)},u.rotate=function(m,O,V){var E=O[0],I=O[1],R=O[2],L=(O=O[3],Math.sin(V));return V=Math.cos(V),m[0]=E*V+R*L,m[1]=I*V+O*L,m[2]=E*-L+R*V,m[3]=I*-L+O*V,m},u.rotateX=function(m,p,I){var E=Math.sin(I),R=(I=Math.cos(I),p[4]),O=p[5],L=p[6],V=p[7],q=p[8],$=p[9],Y=p[10],ae=p[11];return p!==m&&(m[0]=p[0],m[1]=p[1],m[2]=p[2],m[3]=p[3],m[12]=p[12],m[13]=p[13],m[14]=p[14],m[15]=p[15]),m[4]=R*I+q*E,m[5]=O*I+$*E,m[6]=L*I+Y*E,m[7]=V*I+ae*E,m[8]=q*I-R*E,m[9]=$*I-O*E,m[10]=Y*I-L*E,m[11]=ae*I-V*E,m},u.rotateZ=function(m,p,I){var E=Math.sin(I),R=(I=Math.cos(I),p[0]),O=p[1],L=p[2],V=p[3],q=p[4],$=p[5],Y=p[6],ae=p[7];return p!==m&&(m[8]=p[8],m[9]=p[9],m[10]=p[10],m[11]=p[11],m[12]=p[12],m[13]=p[13],m[14]=p[14],m[15]=p[15]),m[0]=R*I+q*E,m[1]=O*I+$*E,m[2]=L*I+Y*E,m[3]=V*I+ae*E,m[4]=q*I-R*E,m[5]=$*I-O*E,m[6]=Y*I-L*E,m[7]=ae*I-V*E,m},u.rtlWorkerPlugin=Lg,u.sameOrigin=Ht,u.scale=function(m,p,R){var E=R[0],I=R[1];return R=R[2],m[0]=p[0]*E,m[1]=p[1]*E,m[2]=p[2]*E,m[3]=p[3]*E,m[4]=p[4]*I,m[5]=p[5]*I,m[6]=p[6]*I,m[7]=p[7]*I,m[8]=p[8]*R,m[9]=p[9]*R,m[10]=p[10]*R,m[11]=p[11]*R,m[12]=p[12],m[13]=p[13],m[14]=p[14],m[15]=p[15],m},u.scale$1=function(m,p,y){return m[0]=p[0]*y,m[1]=p[1]*y,m[2]=p[2]*y,m},u.sphericalToCartesian=function([m,p,y]){return p=(p+=90)*(Math.PI/180),y*=Math.PI/180,{x:m*Math.cos(p)*Math.sin(y),y:m*Math.sin(p)*Math.sin(y),z:m*Math.cos(y)}},u.sqrLen=function Is(y){var p=y[0];return p*p+(y=y[1])*y},u.sub=function pa(m,p,y){return m[0]=p[0]-y[0],m[1]=p[1]-y[1],m[2]=p[2]-y[2],m},u.toEvaluationFeature=Fn,u.transformMat3=function(m,R,y){var E=R[0],I=R[1];return m[0]=E*y[0]+I*y[3]+(R=R[2])*y[6],m[1]=E*y[1]+I*y[4]+R*y[7],m[2]=E*y[2]+I*y[5]+R*y[8],m},u.transformMat4=Id,u.transformMat4$1=function(m,I,y){var E=I[0];return m[0]=y[0]*E+y[4]*(I=I[1])+y[12],m[1]=y[1]*E+y[5]*I+y[13],m},u.translate=function(m,p,_e){var E,I,R,O,L,V,q,$,Y,ae,pe,fe,ve=_e[0],ke=_e[1];return _e=_e[2],p===m?(m[12]=p[0]*ve+p[4]*ke+p[8]*_e+p[12],m[13]=p[1]*ve+p[5]*ke+p[9]*_e+p[13],m[14]=p[2]*ve+p[6]*ke+p[10]*_e+p[14],m[15]=p[3]*ve+p[7]*ke+p[11]*_e+p[15]):(I=p[1],R=p[2],O=p[3],L=p[4],V=p[5],q=p[6],$=p[7],Y=p[8],ae=p[9],pe=p[10],fe=p[11],m[0]=E=p[0],m[1]=I,m[2]=R,m[3]=O,m[4]=L,m[5]=V,m[6]=q,m[7]=$,m[8]=Y,m[9]=ae,m[10]=pe,m[11]=fe,m[12]=E*ve+L*ke+Y*_e+p[12],m[13]=I*ve+V*ke+ae*_e+p[13],m[14]=R*ve+q*ke+pe*_e+p[14],m[15]=O*ve+$*ke+fe*_e+p[15]),m},u.unicodeBlockLookup=_n,u.uniqueId=function(){return Le++},u.v8Spec=oe,u.validateCustomStyleLayer=function(m){var p=[],y=m.id;return void 0===y&&p.push({message:`layers.${y}: missing required property "id"`}),void 0===m.render&&p.push({message:`layers.${y}: missing required method "render"`}),m.renderingMode&&"2d"!==m.renderingMode&&"3d"!==m.renderingMode&&p.push({message:`layers.${y}: property "renderingMode" must be either "2d" or "3d"`}),p},u.validateLight=kg,u.validateStyle=Pp,u.vectorTile=G_,u.warnOnce=lt,u.wrap=St}),l("worker",0,function(u){class h{constructor(J){this.keyCache={},J&&this.replace(J)}replace(J){this._layerConfigs={},this._layers={},this.update(J,[])}update(J,se){for(const He of J){this._layerConfigs[He.id]=He;var le=this._layers[He.id]=u.createStyleLayer(He);le._featureFilter=u.createFilter(le.filter),this.keyCache[He.id]&&delete this.keyCache[He.id]}for(const He of se)delete this.keyCache[He],delete this._layerConfigs[He],delete this._layers[He];this.familiesBySource={};for(const He of u.groupByLayout(Object.values(this._layerConfigs),this.keyCache)){var Ce=He.map(Ve=>this._layers[Ve.id]),Ue=Ce[0];if("none"!==Ue.visibility){var Xe=Ue.source||"";let Ve=this.familiesBySource[Xe];Ve=Ve||(this.familiesBySource[Xe]={});let $e=Ve[Xe=Ue.sourceLayer||"_geojsonTileLayer"];($e=$e||(Ve[Xe]=[])).push(Ce)}}}}class g{constructor(J){var se={},le=[];for(const $n in J){var Ce=J[$n],Ue=se[$n]={};for(const lr in Ce){var Xe,He=Ce[+lr];He&&0!==He.bitmap.width&&0!==He.bitmap.height&&(le.push(Xe={x:0,y:0,w:He.bitmap.width+2,h:He.bitmap.height+2}),Ue[lr]={rect:Xe,metrics:He.metrics})}}var{w:Ve,h:$e}=u.potpack(le),Rt=new u.AlphaImage({width:Ve||1,height:$e||1});for(const $n in J){var Ot=J[$n];for(const lr in Ot){var cn,nr=Ot[+lr];nr&&0!==nr.bitmap.width&&0!==nr.bitmap.height&&u.AlphaImage.copy(nr.bitmap,Rt,{x:0,y:0},{x:(cn=se[$n][lr].rect).x+1,y:cn.y+1},nr.bitmap)}}this.image=Rt,this.positions=se}}u.register("GlyphAtlas",g);class w{constructor(J){this.tileID=new u.OverscaledTileID(J.tileID.overscaledZ,J.tileID.wrap,J.tileID.canonical.z,J.tileID.canonical.x,J.tileID.canonical.y),this.uid=J.uid,this.zoom=J.zoom,this.pixelRatio=J.pixelRatio,this.tileSize=J.tileSize,this.source=J.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=J.showCollisionBoxes,this.collectResourceTiming=!!J.collectResourceTiming,this.returnDependencies=!!J.returnDependencies,this.promoteId=J.promoteId,this.inFlightDependencies=[]}parse(J,se,le,Ce){return u.__awaiter(this,void 0,void 0,function*(){this.status="parsing",this.data=J,this.collisionBoxArray=new u.CollisionBoxArray;var Ue=new u.DictionaryCoder(Object.keys(J.layers).sort()),Xe=new u.FeatureIndex(this.tileID,this.promoteId),He=(Xe.bucketLayerIDs=[],{}),Ve={featureIndex:Xe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le},$e=se.familiesBySource[this.source];for(const Ua in $e){var Rt=J.layers[Ua];if(Rt){1===Rt.version&&u.warnOnce(`Vector tile source "${this.source}" layer "${Ua}" does not use vector tile spec v2 and therefore may have some rendering errors.`);var Ot=Ue.encode(Ua),cn=[];for(let Pc=0;Pc<Rt.length;Pc++){var nr=Rt.feature(Pc),$n=Xe.getId(nr,Ua);cn.push({feature:nr,id:$n,index:Pc,sourceLayerIndex:Ot})}for(const Pc of $e[Ua]){var lr=Pc[0];lr.source!==this.source&&u.warnOnce(`layer.source = ${lr.source} does not equal this.source = `+this.source),lr.minzoom&&this.zoom<Math.floor(lr.minzoom)||lr.maxzoom&&this.zoom>=lr.maxzoom||"none"!==lr.visibility&&(T(Pc,this.zoom,le),(He[lr.id]=lr.createBucket({index:Xe.bucketLayerIDs.length,layers:Pc,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ot,sourceID:this.source})).populate(cn,Ve,this.tileID.canonical),Xe.bucketLayerIDs.push(Pc.map(uD=>uD.id)))}}}var bi=u.mapObject(Ve.glyphDependencies,Ua=>Object.keys(Ua).map(Number));this.inFlightDependencies.forEach(Ua=>Ua?.abort()),this.inFlightDependencies=[];let ci=Promise.resolve({});Object.keys(bi).length&&(Yr=new AbortController,this.inFlightDependencies.push(Yr),ci=Ce.sendAsync({type:"GG",data:{stacks:bi,source:this.source,tileID:this.tileID,type:"glyphs"}},Yr)),bi=Object.keys(Ve.iconDependencies);let wi=Promise.resolve({});var Yr;bi.length&&(Yr=new AbortController,this.inFlightDependencies.push(Yr),wi=Ce.sendAsync({type:"GI",data:{icons:bi,source:this.source,tileID:this.tileID,type:"icons"}},Yr)),bi=Object.keys(Ve.patternDependencies);let ni=Promise.resolve({});bi.length&&(Yr=new AbortController,this.inFlightDependencies.push(Yr),ni=Ce.sendAsync({type:"GI",data:{icons:bi,source:this.source,tileID:this.tileID,type:"patterns"}},Yr));var[cr,rr,bi]=yield Promise.all([ci,wi,ni]),js=new g(cr),da=new u.ImageAtlas(rr,bi);for(const Ua in He){var Dc=He[Ua];Dc instanceof u.SymbolBucket?(T(Dc.layers,this.zoom,le),u.performSymbolLayout({bucket:Dc,glyphMap:cr,glyphPositions:js.positions,imageMap:rr,imagePositions:da.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Dc.hasPattern&&(Dc instanceof u.LineBucket||Dc instanceof u.FillBucket||Dc instanceof u.FillExtrusionBucket)&&(T(Dc.layers,this.zoom,le),Dc.addFeatures(Ve,this.tileID.canonical,da.patternPositions))}return this.status="done",{buckets:Object.values(He).filter(Ua=>!Ua.isEmpty()),featureIndex:Xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:js.image,imageAtlas:da,glyphMap:this.returnDependencies?cr:null,iconMap:this.returnDependencies?rr:null,glyphPositions:this.returnDependencies?js.positions:null}})}}function T(me,J,se){var le=new u.EvaluationParameters(J);for(const Ce of me)Ce.recalculate(le,se)}class D{constructor(J,se,le){this.actor=J,this.layerIndex=se,this.availableImages=le,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(J,se){return u.__awaiter(this,void 0,void 0,function*(){var le=yield u.getArrayBuffer(J.request,se);try{return{vectorTile:new u.vectorTile.VectorTile(new u.Protobuf(le.data)),rawData:le.data,cacheControl:le.cacheControl,expires:le.expires}}catch(Ce){le=new Uint8Array(le.data);let Ue=`Unable to parse the tile at ${J.request.url}, `;throw Ue+=(le=31===le[0]&&139===le[1])?"please make sure the data is not gzipped and that you have configured the relevant header in the server":"got error: "+Ce.messge,new Error(Ue)}})}loadTile(J){return u.__awaiter(this,void 0,void 0,function*(){var se=J.uid,le=!!(J&&J.request&&J.request.collectResourceTiming)&&new u.RequestPerformance(J.request),Ce=new w(J),Ue=(this.loading[se]=Ce,new AbortController);Ce.abort=Ue;try{var Xe=yield this.loadVectorTile(J,Ue);if(delete this.loading[se],!Xe)return null;var He,Ve=Xe.rawData,$e={},Rt=(Xe.expires&&($e.expires=Xe.expires),Xe.cacheControl&&($e.cacheControl=Xe.cacheControl),{}),Ot=(le&&(He=le.finish())&&(Rt.resourceTiming=JSON.parse(JSON.stringify(He))),Ce.vectorTile=Xe.vectorTile,Ce.parse(Xe.vectorTile,this.layerIndex,this.availableImages,this.actor));this.loaded[se]=Ce,this.fetching[se]={rawTileData:Ve,cacheControl:$e,resourceTiming:Rt};try{var cn=yield Ot;return u.extend({rawTileData:Ve.slice(0)},cn,$e,Rt)}finally{delete this.fetching[se]}}catch(nr){throw delete this.loading[se],Ce.status="done",this.loaded[se]=Ce,nr}})}reloadTile(J){return u.__awaiter(this,void 0,void 0,function*(){var se=J.uid;if(!this.loaded||!this.loaded[se])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");var le=this.loaded[se];if(le.showCollisionBoxes=J.showCollisionBoxes,"parsing"===le.status){var Ce,Ue,Xe,He=yield le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor);let Ve;return Ve=this.fetching[se]?(({rawTileData:Ce,cacheControl:Ue,resourceTiming:Xe}=this.fetching[se]),delete this.fetching[se],u.extend({rawTileData:Ce.slice(0)},He,Ue,Xe)):He}if("done"===le.status&&le.vectorTile)return le.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(J){return u.__awaiter(this,void 0,void 0,function*(){var se=this.loading,le=J.uid;se&&se[le]&&se[le].abort&&(se[le].abort.abort(),delete se[le])})}removeTile(J){return u.__awaiter(this,void 0,void 0,function*(){this.loaded&&this.loaded[J.uid]&&delete this.loaded[J.uid]})}}class P{constructor(){this.loaded={}}loadTile(J){return u.__awaiter(this,void 0,void 0,function*(){var{uid:se,encoding:le,rawImageData:Ce,redFactor:Ue,greenFactor:Xe,blueFactor:He,baseShift:Ve}=J,$e=Ce.width+2,Rt=Ce.height+2;return $e=u.isImageBitmap(Ce)?new u.RGBAImage({width:$e,height:Rt},yield u.getImageData(Ce,-1,-1,$e,Rt)):Ce,Rt=new u.DEMData(se,$e,le,Ue,Xe,He,Ve),this.loaded=this.loaded||{},this.loaded[se]=Rt})}removeTile(le){var se=this.loaded;le=le.uid,se&&se[le]&&delete se[le]}}function N(me,J){if(0!==me.length){z(me[0],J);for(var se=1;se<me.length;se++)z(me[se],!J)}}function z(me,J){for(var se=0,le=0,Ce=0,Ue=me.length,Xe=Ue-1;Ce<Ue;Xe=Ce++){var He=(me[Ce][0]-me[Xe][0])*(me[Xe][1]+me[Ce][1]),Ve=se+He;le+=Math.abs(se)>=Math.abs(He)?se-Ve+He:He-Ve+se,se=Ve}0<=se+le!=!!J&&me.reverse()}var W=u.getDefaultExportFromCjs(function me(J,se){var le,Ce=J&&J.type;if("FeatureCollection"===Ce)for(le=0;le<J.features.length;le++)me(J.features[le],se);else if("GeometryCollection"===Ce)for(le=0;le<J.geometries.length;le++)me(J.geometries[le],se);else if("Feature"===Ce)me(J.geometry,se);else if("Polygon"===Ce)N(J.coordinates,se);else if("MultiPolygon"===Ce)for(le=0;le<J.coordinates.length;le++)N(J.coordinates[le],se);return J});const ue=u.vectorTile.VectorTileFeature.prototype.toGeoJSON;var Re={exports:{}},et=u.pointGeometry,Mt=u.vectorTile.VectorTileFeature,St=Qt;function Qt(me,J){this.options=J||{},this.features=me,this.length=me.length}function Le(me,J){this.id="number"==typeof me.id?me.id:void 0,this.type=me.type,this.rawGeometry=1===me.type?[me.geometry]:me.geometry,this.properties=me.tags,this.extent=J||4096}Qt.prototype.feature=function(me){return new Le(this.features[me],this.options.extent)},Le.prototype.loadGeometry=function(){var me=this.rawGeometry;this.geometry=[];for(var J=0;J<me.length;J++){for(var se=me[J],le=[],Ce=0;Ce<se.length;Ce++)le.push(new et(se[Ce][0],se[Ce][1]));this.geometry.push(le)}return this.geometry},Le.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var me=this.geometry,J=1/0,se=-1/0,le=1/0,Ce=-1/0,Ue=0;Ue<me.length;Ue++)for(var Xe=me[Ue],He=0;He<Xe.length;He++){var Ve=Xe[He];J=Math.min(J,Ve.x),se=Math.max(se,Ve.x),le=Math.min(le,Ve.y),Ce=Math.max(Ce,Ve.y)}return[J,le,se,Ce]},Le.prototype.toGeoJSON=Mt.prototype.toGeoJSON;var Je=u.pbf,ot=St;function Et(me){var J,se=new Je,le=me,Ce=se;for(J in le.layers)Ce.writeMessage(3,Kt,le.layers[J]);return se.finish()}function Kt(me,J){J.writeVarintField(15,me.version||1),J.writeStringField(1,me.name||""),J.writeVarintField(5,me.extent||4096);for(var se={keys:[],values:[],keycache:{},valuecache:{}},le=0;le<me.length;le++)se.feature=me.feature(le),J.writeMessage(2,Ne,se);var Ce=se.keys;for(le=0;le<Ce.length;le++)J.writeStringField(3,Ce[le]);var Ue=se.values;for(le=0;le<Ue.length;le++)J.writeMessage(4,Sn,Ue[le])}function Ne(me,J){var se=me.feature;void 0!==se.id&&J.writeVarintField(1,se.id),J.writeMessage(2,lt,me),J.writeVarintField(3,se.type),J.writeMessage(4,ln,se)}function lt(me,J){var se,le=me.feature,Ce=me.keys,Ue=me.values,Xe=me.keycache,He=me.valuecache;for(se in le.properties){var Ve,$e=le.properties[se],Rt=Xe[se];null!==$e&&(void 0===Rt&&(Ce.push(se),Xe[se]=Rt=Ce.length-1),J.writeVarint(Rt),void 0===(Ve=He[Rt=(Rt=typeof $e)+":"+($e="string"!=Rt&&"boolean"!=Rt&&"number"!=Rt?JSON.stringify($e):$e)])&&(Ue.push($e),He[Rt]=Ve=Ue.length-1),J.writeVarint(Ve))}}function It(me,J){return(J<<3)+(7&me)}function xt(me){return me<<1^me>>31}function ln(me,J){for(var se=me.loadGeometry(),le=me.type,Ce=0,Ue=0,Xe=se.length,He=0;He<Xe;He++){for(var Ve=se[He],$e=1,Rt=(1===le&&($e=Ve.length),J.writeVarint(It(1,$e)),3===le?Ve.length-1:Ve.length),Ot=0;Ot<Rt;Ot++){1===Ot&&1!==le&&J.writeVarint(It(2,Rt-1));var cn=Ve[Ot].x-Ce,nr=Ve[Ot].y-Ue;J.writeVarint(xt(cn)),J.writeVarint(xt(nr)),Ce+=cn,Ue+=nr}3===le&&J.writeVarint(15)}}function Sn(me,J){var se=typeof me;"string"==se?J.writeStringField(1,me):"boolean"==se?J.writeBooleanField(7,me):"number"==se&&(me%1!=0?J.writeDoubleField(3,me):me<0?J.writeSVarintField(6,me):J.writeVarintField(5,me))}Re.exports=Et,Re.exports.fromVectorTileJs=Et,Re.exports.fromGeojsonVt=function(me,J){J=J||{};var se,le={};for(se in me)le[se]=new ot(me[se].features,J),le[se].name=se,le[se].version=J.version,le[se].extent=J.extent;return Et({layers:le})},Re.exports.GeoJSONWrapper=ot;var We,on=u.getDefaultExportFromCjs(Re.exports);const Rn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:me=>me},sr=Math.fround||(We=new Float32Array(1),me=>(We[0]=+me,We[0])),nn=3,dt=5,pi=6;class Qn{constructor(J){this.options=Object.assign(Object.create(Rn),J),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(J){var{log:se,minZoom:le,maxZoom:Ce}=this.options,Ue=(se&&console.time("total time"),`prepare ${J.length} points`),Xe=(se&&console.time(Ue),this.points=J,[]);for(let Ot=0;Ot<J.length;Ot++){var He,Ve=J[Ot];Ve.geometry&&([Ve,He]=Ve.geometry.coordinates,Ve=sr(zn(Ve)),He=sr(Fr(He)),Xe.push(Ve,He,1/0,Ot,-1,1),this.options.reduce)&&Xe.push(0)}let $e=this.trees[Ce+1]=this._createTree(Xe);se&&console.timeEnd(Ue);for(let Ot=Ce;Ot>=le;Ot--){var Rt=+Date.now();$e=this.trees[Ot]=this._createTree(this._cluster($e,Ot)),se&&console.log("z%d: %d clusters in %dms",Ot,$e.numItems,+Date.now()-Rt)}return se&&console.timeEnd("total time"),this}getClusters(He,se){let le=((He[0]+180)%360+360)%360-180;var Ce=Math.max(-90,Math.min(90,He[1]));let Ue=180===He[2]?180:((He[2]+180)%360+360)%360-180;var Xe=Math.max(-90,Math.min(90,He[3]));if(360<=He[2]-He[0])le=-180,Ue=180;else if(le>Ue)return He=this.getClusters([le,Ce,180,Xe],se),Ve=this.getClusters([-180,Ce,Ue,Xe],se),He.concat(Ve);var Ve=(He=this.trees[this._limitZoom(se)]).range(zn(le),Fr(Xe),zn(Ue),Fr(Ce)),$e=He.data,Rt=[];for(const cn of Ve){var Ot=this.stride*cn;Rt.push(1<$e[Ot+dt]?ar($e,Ot,this.clusterProps):this.points[$e[Ot+nn]])}return Rt}getChildren(J){var He=this._getOriginId(J),Ue=this._getOriginZoom(J),se="No cluster with the specified id.",le=this.trees[Ue];if(!le)throw new Error(se);var Ce=le.data;if(He*this.stride>=Ce.length)throw new Error(se);Ue=this.options.radius/(this.options.extent*Math.pow(2,Ue-1));var Xe=Ce[He*this.stride],Ve=(He=Ce[He*this.stride+1],[]);for(const Rt of le.within(Xe,He,Ue)){var $e=Rt*this.stride;Ce[4+$e]===J&&Ve.push(1<Ce[$e+dt]?ar(Ce,$e,this.clusterProps):this.points[Ce[$e+nn]])}if(0===Ve.length)throw new Error(se);return Ve}getLeaves(J,se,le){var Ce=[];return this._appendLeaves(Ce,J,se=se||10,le=le||0,0),Ce}getTile(Ue,se,le){var Xe,He,Ce=this.trees[this._limitZoom(Ue)],{extent:He,radius:Xe}=(Ue=Math.pow(2,Ue),this.options),Ve=(le+1+(Xe/=He))/Ue,$e={features:[]};return this._addTileFeatures(Ce.range((se-Xe)/Ue,He=(le-Xe)/Ue,(se+1+Xe)/Ue,Ve),Ce.data,se,le,Ue,$e),0===se&&this._addTileFeatures(Ce.range(1-Xe/Ue,He,1,Ve),Ce.data,Ue,le,Ue,$e),se===Ue-1&&this._addTileFeatures(Ce.range(0,He,Xe/Ue,Ve),Ce.data,-1,le,Ue,$e),$e.features.length?$e:null}getClusterExpansionZoom(J){let se=this._getOriginZoom(J)-1;for(;se<=this.options.maxZoom;){var le=this.getChildren(J);if(se++,1!==le.length)break;J=le[0].properties.cluster_id}return se}_appendLeaves(J,se,le,Ce,Ue){for(const He of this.getChildren(se)){var Xe=He.properties;if(Xe&&Xe.cluster?Ue+Xe.point_count<=Ce?Ue+=Xe.point_count:Ue=this._appendLeaves(J,Xe.cluster_id,le,Ce,Ue):Ue<Ce?Ue++:J.push(He),J.length===le)break}return Ue}_createTree(J){var se=new u.KDBush(J.length/this.stride|0,this.options.nodeSize,Float32Array);for(let le=0;le<J.length;le+=this.stride)se.add(J[le],J[le+1]);return se.finish(),se.data=J,se}_addTileFeatures(J,se,le,Ce,Ue,Xe){for(const Ot of J){var He,Ve=Ot*this.stride,$e=1<se[Ve+dt];let cn,nr,$n;$n=$e?(cn=Wr(se,Ve,this.clusterProps),nr=se[Ve],se[1+Ve]):(Rt=this.points[se[Ve+nn]],[Rt,He]=(cn=Rt.properties,Rt.geometry.coordinates),nr=zn(Rt),Fr(He));var Rt={type:1,geometry:[[Math.round(this.options.extent*(nr*Ue-le)),Math.round(this.options.extent*($n*Ue-Ce))]],tags:cn};let lr;void 0!==(lr=$e||this.options.generateId?se[Ve+nn]:this.points[se[Ve+nn]].id)&&(Rt.id=lr),Xe.features.push(Rt)}}_limitZoom(J){return Math.max(this.options.minZoom,Math.min(Math.floor(+J),this.options.maxZoom+1))}_cluster(J,se){var{radius:le,extent:Ce,reduce:Ue,minPoints:Xe}=this.options,He=le/(Ce*Math.pow(2,se)),Ve=J.data,$e=[],Rt=this.stride;for(let cr=0;cr<Ve.length;cr+=Rt)if(!(Ve[cr+2]<=se)){Ve[cr+2]=se;var Ot=Ve[cr],cn=Ve[cr+1],nr=J.within(Ve[cr],Ve[cr+1],He),$n=Ve[cr+dt];let rr=$n;for(const bi of nr){var lr=bi*Rt;Ve[2+lr]>se&&(rr+=Ve[lr+dt])}if(rr>$n&&rr>=Xe){let da,bi=Ot*$n,js=cn*$n,Dc=-1;var ci=((cr/Rt|0)<<5)+(se+1)+this.points.length;for(const Ua of nr){var wi,Yr=Ua*Rt;Ve[2+Yr]<=se||(Ve[2+Yr]=se,bi+=Ve[Yr]*(wi=Ve[Yr+dt]),js+=Ve[1+Yr]*wi,Ve[4+Yr]=ci,Ue&&(da||(da=this._map(Ve,cr,!0),Dc=this.clusterProps.length,this.clusterProps.push(da)),Ue(da,this._map(Ve,Yr))))}Ve[cr+4]=ci,$e.push(bi/rr,js/rr,1/0,ci,-1,rr),Ue&&$e.push(Dc)}else{for(let bi=0;bi<Rt;bi++)$e.push(Ve[cr+bi]);if(1<rr)for(const bi of nr){var ni=bi*Rt;if(!(Ve[2+ni]<=se)){Ve[2+ni]=se;for(let js=0;js<Rt;js++)$e.push(Ve[ni+js])}}}}return $e}_getOriginId(J){return J-this.points.length>>5}_getOriginZoom(J){return(J-this.points.length)%32}_map(J,se,le){var Ce;return 1<J[se+dt]?(Ce=this.clusterProps[J[se+pi]],le?Object.assign({},Ce):Ce):(J=this.options.map(Ce=this.points[J[se+nn]].properties),le&&J===Ce?Object.assign({},J):J)}}function ar(me,J,se){return{type:"Feature",id:me[J+nn],properties:Wr(me,J,se),geometry:{type:"Point",coordinates:[360*(me[J]-.5),(le=me[J+1],le=(180-360*le)*Math.PI/180,360*Math.atan(Math.exp(le))/Math.PI-90)]}};var le}function Wr(me,J,Xe){var le=me[J+dt],Ce=1e4<=le?Math.round(le/1e3)+"k":1e3<=le?Math.round(le/100)/10+"k":le,Ue=me[J+pi];return Xe=-1===Ue?{}:Object.assign({},Xe[Ue]),Object.assign(Xe,{cluster:!0,cluster_id:me[J+nn],point_count:le,point_count_abbreviated:Ce})}function zn(me){return me/360+.5}function Fr(me){return me=Math.sin(me*Math.PI/180),(me=.5-.25*Math.log((1+me)/(1-me))/Math.PI)<0?0:1<me?1:me}function So(me,J,se,le){for(var Ce,Ue=le,Xe=se-J>>1,He=se-J,Ve=me[J],$e=me[J+1],Rt=me[se],Ot=me[se+1],cn=J+3;cn<se;cn+=3){var nr=($n=me[cn],lr=me[cn+1],bi=void 0,cr=void 0,rr=void 0,rr=(ni=Ot)-(wi=$e),0==(cr=(Yr=Rt)-(ci=Ve))&&0==rr||(1<(bi=(($n-ci)*cr+(lr-wi)*rr)/(cr*cr+rr*rr))?(ci=Yr,wi=ni):0<bi&&(ci+=cr*bi,wi+=rr*bi)),(cr=$n-ci)*cr+(rr=lr-wi)*rr);Ue<nr?(Ce=cn,Ue=nr):nr===Ue&&(nr=Math.abs(cn-Xe))<He&&(Ce=cn,He=nr)}var $n,lr,ci,wi,Yr,ni,bi,cr,rr;le<Ue&&(3<Ce-J&&So(me,J,Ce,le),me[Ce+2]=Ue,3<se-Ce)&&So(me,Ce,se,le)}function Ao(Ce,He,se,le){var Ue=Ce={id:void 0===Ce?null:Ce,type:He,geometry:se,tags:le,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Xe=Ue.geometry;if("Point"===(He=Ue.type)||"MultiPoint"===He||"LineString"===He)Ht(Ue,Xe);else if("Polygon"===He||"MultiLineString"===He)for(var Ve=0;Ve<Xe.length;Ve++)Ht(Ue,Xe[Ve]);else if("MultiPolygon"===He)for(Ve=0;Ve<Xe.length;Ve++)for(var $e=0;$e<Xe[Ve].length;$e++)Ht(Ue,Xe[Ve][$e]);return Ce}function Ht(me,J){for(var se=0;se<J.length;se+=3)me.minX=Math.min(me.minX,J[se]),me.minY=Math.min(me.minY,J[se+1]),me.maxX=Math.max(me.maxX,J[se]),me.maxY=Math.max(me.maxY,J[se+1])}function yn(me,J,se,le){if(J.geometry){var Ce=J.geometry.coordinates,Ue=J.geometry.type,Xe=Math.pow(se.tolerance/((1<<se.maxZoom)*se.extent),2),He=[],Ve=J.id;if(se.promoteId?Ve=J.properties[se.promoteId]:se.generateId&&(Ve=le||0),"Point"===Ue)gr(Ce,He);else if("MultiPoint"===Ue)for(var $e=0;$e<Ce.length;$e++)gr(Ce[$e],He);else if("LineString"===Ue)st(Ce,He,Xe,!1);else if("MultiLineString"===Ue){if(se.lineMetrics){for($e=0;$e<Ce.length;$e++)st(Ce[$e],He=[],Xe,!1),me.push(Ao(Ve,"LineString",He,J.properties));return}Ut(Ce,He,Xe,!1)}else if("Polygon"===Ue)Ut(Ce,He,Xe,!0);else{if("MultiPolygon"!==Ue){if("GeometryCollection"!==Ue)throw new Error("Input data is not a valid GeoJSON object.");for($e=0;$e<J.geometry.geometries.length;$e++)yn(me,{id:Ve,geometry:J.geometry.geometries[$e],properties:J.properties},se,le);return}for($e=0;$e<Ce.length;$e++){var Rt=[];Ut(Ce[$e],Rt,Xe,!0),He.push(Rt)}}me.push(Ao(Ve,Ue,He,J.properties))}}function gr(me,J){J.push(Jt(me[0])),J.push(oe(me[1])),J.push(0)}function st(me,J,se,le){for(var Ce,Ue,Xe=0,He=0;He<me.length;He++){var Ve=Jt(me[He][0]),$e=oe(me[He][1]);J.push(Ve),J.push($e),J.push(0),0<He&&(Xe+=le?(Ce*$e-Ve*Ue)/2:Math.sqrt(Math.pow(Ve-Ce,2)+Math.pow($e-Ue,2))),Ce=Ve,Ue=$e}var Rt=J.length-3;J[2]=1,So(J,0,Rt,se),J[2+Rt]=1,J.size=Math.abs(Xe),J.start=0,J.end=J.size}function Ut(me,J,se,le){for(var Ce=0;Ce<me.length;Ce++){var Ue=[];st(me[Ce],Ue,se,le),J.push(Ue)}}function Jt(me){return me/360+.5}function oe(me){return me=Math.sin(me*Math.PI/180),(me=.5-.25*Math.log((1+me)/(1-me))/Math.PI)<0?0:1<me?1:me}function ne(me,J,se,le,Ce,Ue,Xe,He){if(le/=J,(se/=J)<=Ue&&Xe<le)return me;if(Xe<se||le<=Ue)return null;for(var Ve=[],$e=0;$e<me.length;$e++){var Rt=me[$e],Ot=Rt.geometry,cn=Rt.type,nr=0===Ce?Rt.minX:Rt.minY,$n=0===Ce?Rt.maxX:Rt.maxY;if(se<=nr&&$n<le)Ve.push(Rt);else if(!($n<se||le<=nr)){var lr=[];if("Point"===cn||"MultiPoint"===cn){bi=rr=wi=void 0;for(var ci=Ot,wi=lr,Yr=se,ni=le,cr=Ce,rr=0;rr<ci.length;rr+=3){var bi=ci[rr+cr];Yr<=bi&&bi<=ni&&(wi.push(ci[rr]),wi.push(ci[rr+1]),wi.push(ci[rr+2]))}}else if("LineString"===cn)X(Ot,lr,se,le,Ce,!1,He.lineMetrics);else if("MultiLineString"===cn)ye(Ot,lr,se,le,Ce,!1);else if("Polygon"===cn)ye(Ot,lr,se,le,Ce,!0);else if("MultiPolygon"===cn)for(var js=0;js<Ot.length;js++){var da=[];ye(Ot[js],da,se,le,Ce,!0),da.length&&lr.push(da)}if(lr.length)if(He.lineMetrics&&"LineString"===cn)for(js=0;js<lr.length;js++)Ve.push(Ao(Rt.id,cn,lr[js],Rt.tags));else"LineString"!==cn&&"MultiLineString"!==cn||(1===lr.length?(cn="LineString",lr=lr[0]):cn="MultiLineString"),"Point"!==cn&&"MultiPoint"!==cn||(cn=3===lr.length?"Point":"MultiPoint"),Ve.push(Ao(Rt.id,cn,lr,Rt.tags))}}return Ve.length?Ve:null}function X(me,J,se,le,Ce,Ue,Xe){for(var He,Ve,$e=ie(me),Rt=0===Ce?Ke:ct,Ot=me.start,cn=0;cn<me.length-3;cn+=3){var ni=me[cn],cr=me[cn+1],rr=me[cn+2],nr=me[cn+3],$n=me[cn+4],lr=0===Ce?ni:cr,ci=0===Ce?nr:$n,wi=!1;Xe&&(He=Math.sqrt(Math.pow(ni-nr,2)+Math.pow(cr-$n,2))),lr<se?se<ci&&(Ve=Rt($e,ni,cr,nr,$n,se),Xe)&&($e.start=Ot+He*Ve):le<lr?ci<le&&(Ve=Rt($e,ni,cr,nr,$n,le),Xe)&&($e.start=Ot+He*Ve):De($e,ni,cr,rr),ci<se&&se<=lr&&(Ve=Rt($e,ni,cr,nr,$n,se),wi=!0),le<ci&&lr<=le&&(Ve=Rt($e,ni,cr,nr,$n,le),wi=!0),!Ue&&wi&&(Xe&&($e.end=Ot+He*Ve),J.push($e),$e=ie(me)),Xe&&(Ot+=He)}var Yr=me.length-3;ni=me[Yr],cr=me[1+Yr],rr=me[2+Yr],se<=(lr=0===Ce?ni:cr)&&lr<=le&&De($e,ni,cr,rr),Yr=$e.length-3,Ue&&3<=Yr&&($e[Yr]!==$e[0]||$e[1+Yr]!==$e[1])&&De($e,$e[0],$e[1],$e[2]),$e.length&&J.push($e)}function ie(me){var J=[];return J.size=me.size,J.start=me.start,J.end=me.end,J}function ye(me,J,se,le,Ce,Ue){for(var Xe=0;Xe<me.length;Xe++)X(me[Xe],J,se,le,Ce,Ue,!1)}function De(me,J,se,le){me.push(J),me.push(se),me.push(le)}function Ke(me,J,se,le,Ce,Ue){return le=(Ue-J)/(le-J),me.push(Ue),me.push(se+(Ce-se)*le),me.push(1),le}function ct(me,J,se,le,Ce,Ue){return me.push(J+(le-J)*(Ce=(Ue-se)/(Ce-se))),me.push(Ue),me.push(1),Ce}function wt(me,J){for(var se=[],le=0;le<me.length;le++){var Ce=me[le],Ue=Ce.type;if("Point"===Ue||"MultiPoint"===Ue||"LineString"===Ue)Xe=Me(Ce.geometry,J);else if("MultiLineString"===Ue||"Polygon"===Ue)for(var Xe=[],He=0;He<Ce.geometry.length;He++)Xe.push(Me(Ce.geometry[He],J));else if("MultiPolygon"===Ue)for(Xe=[],He=0;He<Ce.geometry.length;He++){for(var Ve=[],$e=0;$e<Ce.geometry[He].length;$e++)Ve.push(Me(Ce.geometry[He][$e],J));Xe.push(Ve)}se.push(Ao(Ce.id,Ue,Xe,Ce.tags))}return se}function Me(me,J){var se=[];se.size=me.size,void 0!==me.start&&(se.start=me.start,se.end=me.end);for(var le=0;le<me.length;le+=3)se.push(me[le]+J,me[le+1],me[le+2]);return se}function Pe(me,J){if(!me.transformed){for(var se,le=1<<me.z,Ce=me.x,Ue=me.y,Xe=0;Xe<me.features.length;Xe++){var He=me.features[Xe],Ve=He.geometry,$e=He.type;if(He.geometry=[],1===$e)for(se=0;se<Ve.length;se+=2)He.geometry.push(Ft(Ve[se],Ve[se+1],J,le,Ce,Ue));else for(se=0;se<Ve.length;se++){for(var Rt=[],Ot=0;Ot<Ve[se].length;Ot+=2)Rt.push(Ft(Ve[se][Ot],Ve[se][Ot+1],J,le,Ce,Ue));He.geometry.push(Rt)}}me.transformed=!0}return me}function Ft(me,J,se,le,Ce,Ue){return[Math.round(se*(me*le-Ce)),Math.round(se*(J*le-Ue))]}function kt(me,J,se,le,Ce){for(var Ue=J===Ce.maxZoom?0:Ce.tolerance/((1<<J)*Ce.extent),Xe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:se,y:le,z:J,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},He=0;He<me.length;He++){Xe.numFeatures++,Yr=wi=ci=lr=$n=nr=ni=Ve=void 0;var Ve=Xe,$e=me[He],Rt=Ue,ni=Ce,Ot=$e.geometry,cn=$e.type,nr=[];if("Point"===cn||"MultiPoint"===cn)for(var $n=0;$n<Ot.length;$n+=3)nr.push(Ot[$n]),nr.push(Ot[$n+1]),Ve.numPoints++,Ve.numSimplified++;else if("LineString"===cn)en(nr,Ot,Ve,Rt,!1,!1);else if("MultiLineString"===cn||"Polygon"===cn)for($n=0;$n<Ot.length;$n++)en(nr,Ot[$n],Ve,Rt,"Polygon"===cn,0===$n);else if("MultiPolygon"===cn)for(var lr=0;lr<Ot.length;lr++){var ci=Ot[lr];for($n=0;$n<ci.length;$n++)en(nr,ci[$n],Ve,Rt,!0,0===$n)}if(nr.length){var wi=$e.tags||null;if("LineString"===cn&&ni.lineMetrics){for(var Yr in wi={},$e.tags)wi[Yr]=$e.tags[Yr];wi.mapbox_clip_start=Ot.start/Ot.size,wi.mapbox_clip_end=Ot.end/Ot.size}ni={geometry:nr,type:"Polygon"===cn||"MultiPolygon"===cn?3:"LineString"===cn||"MultiLineString"===cn?2:1,tags:wi},null!==$e.id&&(ni.id=$e.id),Ve.features.push(ni)}var cr=me[He].minY,rr=me[He].maxX,bi=me[He].maxY;(ni=me[He].minX)<Xe.minX&&(Xe.minX=ni),cr<Xe.minY&&(Xe.minY=cr),Xe.maxX<rr&&(Xe.maxX=rr),Xe.maxY<bi&&(Xe.maxY=bi)}return Xe}function en(me,J,se,le,Ce,Ue){var Xe=le*le;if(0<le&&J.size<(Ce?Xe:le))se.numPoints+=J.length/3;else{for(var He=[],Ve=0;Ve<J.length;Ve+=3)(0===le||J[Ve+2]>Xe)&&(se.numSimplified++,He.push(J[Ve]),He.push(J[Ve+1])),se.numPoints++;if(Ce){for(var $e=He,Rt=(Ce=Ue,0),Ot=0,cn=$e.length,nr=cn-2;Ot<cn;nr=Ot,Ot+=2)Rt+=($e[Ot]-$e[nr])*($e[Ot+1]+$e[nr+1]);if(0<Rt===Ce)for(Ot=0,cn=$e.length;Ot<cn/2;Ot+=2){var $n=$e[Ot],lr=$e[Ot+1];$e[Ot]=$e[cn-2-Ot],$e[Ot+1]=$e[cn-1-Ot],$e[cn-2-Ot]=$n,$e[cn-1-Ot]=lr}}me.push(He)}}function ut(Ve,J){var le,Ce,Ue,Xe,He,se=(J=this.options=function($e,Rt){for(var Ot in Rt)$e[Ot]=Rt[Ot];return $e}(Object.create(this.options),J)).debug;if(se&&console.time("preprocess data"),J.maxZoom<0||24<J.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");Ve=function($e,Rt){var Ot=[];if("FeatureCollection"===$e.type)for(var cn=0;cn<$e.features.length;cn++)yn(Ot,$e.features[cn],Rt,cn);else yn(Ot,"Feature"===$e.type?$e:{geometry:$e},Rt);return Ot}(Ve,J),this.tiles={},this.tileCoords=[],se&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Xe=ne(Ue=le=Ve,1,-1-(Ce=J.buffer/J.extent),Ce,0,-1,2,J),He=ne(le,1,1-Ce,2+Ce,0,-1,2,J),(Ve=Ue=(Xe||He)&&(Ue=ne(le,1,-Ce,1+Ce,0,-1,2,J)||[],Xe&&(Ue=wt(Xe,1).concat(Ue)),He)?Ue.concat(wt(He,-1)):Ue).length&&this.splitTile(Ve,0,0,0),se&&(Ve.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Dt(me,J,se){return 32*((1<<me)*se+J)+me}function qt(me,J){return J?me.properties[J]:me.id}function Tr(me,J){if(null==me)return 1;if("Feature"===me.type)return null!=qt(me,J);if("FeatureCollection"===me.type){var se=new Set;for(const Ce of me.features){var le=qt(Ce,J);if(null==le||se.has(le))return;se.add(le)}return 1}}function _i(me,J){var se=new Map;if(null!=me)if("Feature"===me.type)se.set(qt(me,J),me);else for(const le of me.features)se.set(qt(le,J),le);return se}ut.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ut.prototype.splitTile=function(me,J,se,le,Ce,Ue,Xe){for(var He=[me,J,se,le],Ve=this.options,$e=Ve.debug;He.length;){le=He.pop(),se=He.pop(),J=He.pop(),me=He.pop();var Rt,Ot,cn,nr,$n,lr,ci,wi,Yr,ni=1<<J,cr=Dt(J,se,le),rr=this.tiles[cr];if(rr||(1<$e&&console.time("creation"),rr=this.tiles[cr]=kt(me,J,se,le,Ve),this.tileCoords.push({z:J,x:se,y:le}),$e&&(1<$e&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,se,le,rr.numFeatures,rr.numPoints,rr.numSimplified),console.timeEnd("creation")),this.stats[cr="z"+J]=(this.stats[cr]||0)+1,this.total++)),rr.source=me,Ce){if(J===Ve.maxZoom||J===Ce)continue;if(cr=1<<Ce-J,se!==Math.floor(Ue/cr)||le!==Math.floor(Xe/cr))continue}else if(J===Ve.indexMaxZoom||rr.numPoints<=Ve.indexMaxPoints)continue;rr.source=null,0!==me.length&&(1<$e&&console.time("clipping"),Rt=.5-(cr=.5*Ve.buffer/Ve.extent),cn=1+cr,ci=nr=$n=lr=null,wi=ne(me,ni,se-cr,se+(Ot=.5+cr),0,rr.minX,rr.maxX,Ve),Yr=ne(me,ni,se+Rt,se+cn,0,rr.minX,rr.maxX,Ve),me=null,wi&&(ci=ne(wi,ni,le-cr,le+Ot,1,rr.minY,rr.maxY,Ve),nr=ne(wi,ni,le+Rt,le+cn,1,rr.minY,rr.maxY,Ve),wi=null),Yr&&($n=ne(Yr,ni,le-cr,le+Ot,1,rr.minY,rr.maxY,Ve),lr=ne(Yr,ni,le+Rt,le+cn,1,rr.minY,rr.maxY,Ve),Yr=null),1<$e&&console.timeEnd("clipping"),He.push(ci||[],J+1,2*se,2*le),He.push(nr||[],J+1,2*se,2*le+1),He.push($n||[],J+1,2*se+1,2*le),He.push(lr||[],J+1,2*se+1,2*le+1))}},ut.prototype.getTile=function(me,J,se){var le=(Ce=this.options).extent,Ce=Ce.debug;if(me<0||24<me)return null;var Ue=Dt(me,J=(J%(Ue=1<<me)+Ue)%Ue,se);if(this.tiles[Ue])return Pe(this.tiles[Ue],le);1<Ce&&console.log("drilling down to z%d-%d-%d",me,J,se);for(var Xe,He=me,Ve=J,$e=se;!Xe&&0<He;)He--,Ve=Math.floor(Ve/2),$e=Math.floor($e/2),Xe=this.tiles[Dt(He,Ve,$e)];return Xe&&Xe.source&&(1<Ce&&console.log("found parent tile z%d-%d-%d",He,Ve,$e),1<Ce&&console.time("drilling down"),this.splitTile(Xe.source,He,Ve,$e,me,J,se),1<Ce&&console.timeEnd("drilling down"),this.tiles[Ue])?Pe(this.tiles[Ue],le):null};class Li extends D{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(J,se){return u.__awaiter(this,void 0,void 0,function*(){var le=J.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");if(!(le=this._geoJSONIndex.getTile(le.z,le.x,le.y)))return null;le=new class{constructor(me){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.EXTENT,this.length=me.length,this._features=me}feature(me){return new class{constructor(me){this._feature=me,this.extent=u.EXTENT,this.type=me.type,this.properties=me.tags,"id"in me&&!isNaN(me.id)&&(this.id=parseInt(me.id,10))}loadGeometry(){if(1===this._feature.type){var me=[];for(const le of this._feature.geometry)me.push([new u.Point(le[0],le[1])]);return me}var J=[];for(const le of this._feature.geometry){var se=[];for(const Ce of le)se.push(new u.Point(Ce[0],Ce[1]));J.push(se)}return J}toGeoJSON(me,J,se){return ue.call(this,me,J,se)}}(this._features[me])}}(le.features);let Ce=on(le);return{vectorTile:le,rawData:(Ce=0===Ce.byteOffset&&Ce.byteLength===Ce.buffer.byteLength?Ce:new Uint8Array(Ce)).buffer}})}loadData(J){return u.__awaiter(this,void 0,void 0,function*(){null!=(se=this._pendingRequest)&&se.abort();var se=!!(J&&J.request&&J.request.collectResourceTiming)&&new u.RequestPerformance(J.request);this._pendingRequest=new AbortController;try{let Xe=yield this.loadGeoJSON(J,this._pendingRequest);if(delete this._pendingRequest,"object"!=typeof Xe)throw new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`);if(W(Xe,!0),J.filter){const He=u.createExpression(J.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===He.result)throw new Error(He.value.map(Ve=>Ve.key+": "+Ve.message).join(", "));var le=Xe.features.filter(Ve=>He.value.evaluate({zoom:0},Ve));Xe={type:"FeatureCollection",features:le}}this._geoJSONIndex=J.cluster?new Qn(function os({superclusterOptions:me,clusterProperties:J}){if(J&&me){const Ce={},Ue={},Xe={accumulated:null,zoom:0},He={properties:null},Ve=Object.keys(J);for(const $e of Ve){var[le,se]=J[$e],se=u.createExpression(se),le=u.createExpression("string"==typeof le?[le,["accumulated"],["get",$e]]:le);Ce[$e]=se.value,Ue[$e]=le.value}me.map=$e=>{He.properties=$e;var Rt={};for(const Ot of Ve)Rt[Ot]=Ce[Ot].evaluate(Xe,He);return Rt},me.reduce=($e,Rt)=>{He.properties=Rt;for(const Ot of Ve)Xe.accumulated=$e[Ot],$e[Ot]=Ue[Ot].evaluate(Xe,He)}}return me}(J)).load(Xe.features):function Yn(me,J){return new ut(me,J)}(Xe,J.geojsonVtOptions),this.loaded={};var Ce,Ue={};return se&&(Ce=se.finish())&&(Ue.resourceTiming={},Ue.resourceTiming[J.source]=JSON.parse(JSON.stringify(Ce))),Ue}catch(Xe){if(delete this._pendingRequest,u.isAbortError(Xe))return{abandoned:!0};throw Xe}})}reloadTile(J){var se=this.loaded;return se&&se[J.uid]?super.reloadTile(J):this.loadTile(J)}loadGeoJSON(J,se){return u.__awaiter(this,void 0,void 0,function*(){var le,Ce=J.promoteId;if(J.request)return le=yield u.getJSON(J.request,se),this._dataUpdateable=Tr(le.data,Ce)?_i(le.data,Ce):void 0,le.data;if("string"==typeof J.data)try{var Ue=JSON.parse(J.data);return this._dataUpdateable=Tr(Ue,Ce)?_i(Ue,Ce):void 0,Ue}catch{throw new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`)}if(!J.dataDiff)throw new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`);if(this._dataUpdateable)return function In(me,J,se){if(J.removeAll&&me.clear(),J.remove)for(const Ve of J.remove)me.delete(Ve);if(J.add)for(const Ve of J.add){var le=qt(Ve,se);null!=le&&me.set(le,Ve)}if(J.update)for(const Ve of J.update){let $e=me.get(Ve.id);if(null!=$e){var Ce=Ve.newGeometry||Ve.removeAllProperties,Ue=!Ve.removeAllProperties&&(0<(null==(Ue=Ve.removeProperties)?void 0:Ue.length)||0<(null==(Ue=Ve.addOrUpdateProperties)?void 0:Ue.length));if((Ce||Ue)&&($e=Object.assign({},$e),me.set(Ve.id,$e),Ue)&&($e.properties=Object.assign({},$e.properties)),Ve.newGeometry&&($e.geometry=Ve.newGeometry),Ve.removeAllProperties)$e.properties={};else if(0<(null==(Ce=Ve.removeProperties)?void 0:Ce.length))for(const Rt of Ve.removeProperties)Object.prototype.hasOwnProperty.call($e.properties,Rt)&&delete $e.properties[Rt];if(0<(null==(Ce=Ve.addOrUpdateProperties)?void 0:Ce.length))for(var{key:Xe,value:He}of Ve.addOrUpdateProperties)$e.properties[Xe]=He}}}(this._dataUpdateable,J.dataDiff,Ce),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())};throw new Error("Cannot update existing geojson data in "+J.source)})}removeSource(J){return u.__awaiter(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(J){return this._geoJSONIndex.getClusterExpansionZoom(J.clusterId)}getClusterChildren(J){return this._geoJSONIndex.getChildren(J.clusterId)}getClusterLeaves(J){return this._geoJSONIndex.getLeaves(J.clusterId,J.limit,J.offset)}}class vi{constructor(J){this.self=J,this.actor=new u.Actor(J),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(se,le)=>{if(this.externalWorkerSourceTypes[se])throw new Error(`Worker source with name "${se}" already registered.`);this.externalWorkerSourceTypes[se]=le},this.self.addProtocol=u.addProtocol,this.self.removeProtocol=u.removeProtocol,this.self.registerRTLTextPlugin=se=>{if(u.rtlWorkerPlugin.isParsed())throw new Error("RTL text plugin already registered.");u.rtlWorkerPlugin.setMethods(se)},this.actor.registerMessageHandler("LDT",(se,le)=>this._getDEMWorkerSource(se,le.source).loadTile(le)),this.actor.registerMessageHandler("RDT",(se,le)=>u.__awaiter(this,void 0,void 0,function*(){this._getDEMWorkerSource(se,le.source).removeTile(le)})),this.actor.registerMessageHandler("GCEZ",(se,le)=>u.__awaiter(this,void 0,void 0,function*(){return this._getWorkerSource(se,le.type,le.source).getClusterExpansionZoom(le)})),this.actor.registerMessageHandler("GCC",(se,le)=>u.__awaiter(this,void 0,void 0,function*(){return this._getWorkerSource(se,le.type,le.source).getClusterChildren(le)})),this.actor.registerMessageHandler("GCL",(se,le)=>u.__awaiter(this,void 0,void 0,function*(){return this._getWorkerSource(se,le.type,le.source).getClusterLeaves(le)})),this.actor.registerMessageHandler("LD",(se,le)=>this._getWorkerSource(se,le.type,le.source).loadData(le)),this.actor.registerMessageHandler("LT",(se,le)=>this._getWorkerSource(se,le.type,le.source).loadTile(le)),this.actor.registerMessageHandler("RT",(se,le)=>this._getWorkerSource(se,le.type,le.source).reloadTile(le)),this.actor.registerMessageHandler("AT",(se,le)=>this._getWorkerSource(se,le.type,le.source).abortTile(le)),this.actor.registerMessageHandler("RMT",(se,le)=>this._getWorkerSource(se,le.type,le.source).removeTile(le)),this.actor.registerMessageHandler("RS",(se,le)=>u.__awaiter(this,void 0,void 0,function*(){var Ce;this.workerSources[se]&&this.workerSources[se][le.type]&&this.workerSources[se][le.type][le.source]&&(Ce=this.workerSources[se][le.type][le.source],delete this.workerSources[se][le.type][le.source],void 0!==Ce.removeSource)&&Ce.removeSource(le)})),this.actor.registerMessageHandler("RM",se=>u.__awaiter(this,void 0,void 0,function*(){delete this.layerIndexes[se],delete this.availableImages[se],delete this.workerSources[se],delete this.demWorkerSources[se]})),this.actor.registerMessageHandler("SR",(se,le)=>u.__awaiter(this,void 0,void 0,function*(){this.referrer=le})),this.actor.registerMessageHandler("SRPS",(se,le)=>this._syncRTLPluginState(se,le)),this.actor.registerMessageHandler("IS",(se,le)=>u.__awaiter(this,void 0,void 0,function*(){this.self.importScripts(le)})),this.actor.registerMessageHandler("SI",(se,le)=>this._setImages(se,le)),this.actor.registerMessageHandler("UL",(se,le)=>u.__awaiter(this,void 0,void 0,function*(){this._getLayerIndex(se).update(le.layers,le.removedIds)})),this.actor.registerMessageHandler("SL",(se,le)=>u.__awaiter(this,void 0,void 0,function*(){this._getLayerIndex(se).replace(le)}))}_setImages(J,se){return u.__awaiter(this,void 0,void 0,function*(){this.availableImages[J]=se;for(const Ce in this.workerSources[J]){var le=this.workerSources[J][Ce];for(const Ue in le)le[Ue].availableImages=se}})}_syncRTLPluginState(J,se){return u.__awaiter(this,void 0,void 0,function*(){if(u.rtlWorkerPlugin.isParsed())return u.rtlWorkerPlugin.getState();if("loading"!==se.pluginStatus)return u.rtlWorkerPlugin.setState(se),se;var le=se.pluginURL,Ce=(this.self.importScripts(le),u.rtlWorkerPlugin.isParsed());if(Ce)return u.rtlWorkerPlugin.setState(Ce={pluginStatus:"loaded",pluginURL:le}),Ce;throw u.rtlWorkerPlugin.setState({pluginStatus:"error",pluginURL:""}),new Error("RTL Text Plugin failed to import scripts from "+le)})}_getAvailableImages(J){return this.availableImages[J]||[]}_getLayerIndex(J){return this.layerIndexes[J]||(this.layerIndexes[J]=new h)}_getWorkerSource(J,se,le){if(this.workerSources[J]||(this.workerSources[J]={}),this.workerSources[J][se]||(this.workerSources[J][se]={}),!this.workerSources[J][se][le]){var Ce={sendAsync:(Ue,Xe)=>(Ue.targetMapId=J,this.actor.sendAsync(Ue,Xe))};switch(se){case"vector":this.workerSources[J][se][le]=new D(Ce,this._getLayerIndex(J),this._getAvailableImages(J));break;case"geojson":this.workerSources[J][se][le]=new Li(Ce,this._getLayerIndex(J),this._getAvailableImages(J));break;default:this.workerSources[J][se][le]=new this.externalWorkerSourceTypes[se](Ce,this._getLayerIndex(J),this._getAvailableImages(J))}}return this.workerSources[J][se][le]}_getDEMWorkerSource(J,se){return this.demWorkerSources[J]||(this.demWorkerSources[J]={}),this.demWorkerSources[J][se]||(this.demWorkerSources[J][se]=new P),this.demWorkerSources[J][se]}}return u.isWorker(self)&&(self.worker=new vi(self)),vi}),l("index",0,function(u,h){var g,w="4.1.2";let T,D;const P={now:fi=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:A=>new Promise((d,_)=>{const x=requestAnimationFrame(d);A.signal.addEventListener("abort",()=>{cancelAnimationFrame(x),_(h.createAbortError())})}),getImageData(A,d=0){return this.getImageCanvasContext(A).getImageData(-d,-d,A.width+2*d,A.height+2*d)},getImageCanvasContext(A){var d=window.document.createElement("canvas"),_=d.getContext("2d",{willReadFrequently:!0});if(_)return d.width=A.width,d.height=A.height,_.drawImage(A,0,0,A.width,A.height),_;throw new Error("failed to create canvas 2d context")},resolveURL:A=>((T=T||document.createElement("a")).href=A,T.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(D=D??matchMedia("(prefers-reduced-motion: reduce)")).matches}};class N{static testProp(d){if(N.docStyle)for(let _=0;_<d.length;_++)if(d[_]in N.docStyle)return d[_];return d[0]}static create(d,_,x){return d=window.document.createElement(d),void 0!==_&&(d.className=_),x&&x.appendChild(d),d}static createNS(d,_){return window.document.createElementNS(d,_)}static disableDrag(){N.docStyle&&N.selectProp&&(N.userSelect=N.docStyle[N.selectProp],N.docStyle[N.selectProp]="none")}static enableDrag(){N.docStyle&&N.selectProp&&(N.docStyle[N.selectProp]=N.userSelect)}static setTransform(d,_){d.style[N.transformProp]=_}static addEventListener(d,_,x,C={}){d.addEventListener(_,x,"passive"in C?C:C.capture)}static removeEventListener(d,_,x,C={}){d.removeEventListener(_,x,"passive"in C?C:C.capture)}static suppressClickInternal(d){d.preventDefault(),d.stopPropagation(),window.removeEventListener("click",N.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",N.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",N.suppressClickInternal,!0)},0)}static getScale(d){var _=d.getBoundingClientRect();return{x:_.width/d.offsetWidth||1,y:_.height/d.offsetHeight||1,boundingClientRect:_}}static getPoint(d,_,x){var C=_.boundingClientRect;return new h.Point((x.clientX-C.left)/_.x-d.clientLeft,(x.clientY-C.top)/_.y-d.clientTop)}static mousePos(d,_){var x=N.getScale(d);return N.getPoint(d,x,_)}static touchPos(d,_){var x=[],C=N.getScale(d);for(let M=0;M<_.length;M++)x.push(N.getPoint(d,C,_[M]));return x}static mouseButton(d){return d.button}static remove(d){d.parentNode&&d.parentNode.removeChild(d)}}N.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,N.selectProp=N.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),N.transformProp=N.testProp(["transform","WebkitTransform"]);const z={supported:!1,testSupport:function(A){!ue&&ge&&(we?Re(A):W=A)}};let W,ge,ue=!1,we=!1;function Re(A){var d=A.createTexture();A.bindTexture(A.TEXTURE_2D,d);try{if(A.texImage2D(A.TEXTURE_2D,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,ge),A.isContextLost())return;z.supported=!0}catch{}A.deleteTexture(d),ue=!0}typeof document<"u"&&((ge=document.createElement("img")).onload=function(){W&&Re(W),W=null,we=!0},ge.onerror=function(){ue=!0,W=null},ge.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(A){let d,_,x,C;A.resetRequestQueue=()=>{d=[],_=0,x=0,C={}},A.addThrottleControl=re=>{var ce=x++;return C[ce]=re,ce},A.removeThrottleControl=re=>{delete C[re],U()},A.getImage=(re,ce,ee=!0)=>new Promise((he,Ee)=>{z.supported&&(re.headers||(re.headers={}),re.headers.accept="image/webp,*/*"),h.extend(re,{type:"image"}),d.push({abortController:ce,requestParameters:re,supportImageRefresh:ee,state:"queued",onError:Oe=>{Ee(Oe)},onSuccess:Oe=>{he(Oe)}}),U()});const M=re=>"function"==typeof createImageBitmap?h.arrayBufferToImageBitmap(re):h.arrayBufferToImage(re),B=re=>h.__awaiter(this,void 0,void 0,function*(){re.state="running";var{requestParameters:ce,supportImageRefresh:Se,onError:ee,onSuccess:he,abortController:Ee}=re,Se=(Se=!1===Se&&!h.isWorker(self)&&!h.getProtocol(ce.url)&&(!ce.headers||Object.keys(ce.headers).reduce((Ae,qe)=>Ae&&"accept"===qe,!0)),_++,Se?K(ce,Ee):h.makeRequest(ce,Ee));try{var Oe=yield Se;delete re.abortController,re.state="completed",Oe.data instanceof HTMLImageElement||h.isImageBitmap(Oe.data)?he(Oe):Oe.data&&he({data:yield M(Oe.data),cacheControl:Oe.cacheControl,expires:Oe.expires})}catch(Ae){delete re.abortController,ee(Ae)}finally{_--,U()}}),U=()=>{var re=(()=>{for(const ee of Object.keys(C))if(C[ee]())return!0;return!1})()?h.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:h.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let ee=_;ee<re&&0<d.length;ee++){var ce=d.shift();ce.abortController.signal.aborted?ee--:B(ce)}},K=(re,ce)=>new Promise((ee,he)=>{const Ee=new Image;var Se=re.url,Oe=re.credentials;Oe&&"include"===Oe?Ee.crossOrigin="use-credentials":(Oe&&"same-origin"===Oe||!h.sameOrigin(Se))&&(Ee.crossOrigin="anonymous"),ce.signal.addEventListener("abort",()=>{Ee.src="",he(h.createAbortError())}),Ee.fetchPriority="high",Ee.onload=()=>{Ee.onerror=Ee.onload=null,ee({data:Ee})},Ee.onerror=()=>{Ee.onerror=Ee.onload=null,ce.signal.aborted||he(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Ee.src=Se})}(g=g||{}),g.resetRequestQueue();class et{constructor(d){this._transformRequestFn=d}transformRequest(d,_){return this._transformRequestFn&&this._transformRequestFn(d,_)||{url:d}}normalizeSpriteURL(d,_,x){return(d=function St(A){var d=A.match(Mt);if(d)return{protocol:d[1],authority:d[2],path:d[3]||"/",params:d[4]?d[4].split("&"):[]};throw new Error(`Unable to parse URL "${A}"`)}(d)).path+=""+_+x,function Qt(A){var d=A.params.length?"?"+A.params.join("&"):"";return A.protocol+"://"+A.authority+A.path+d}(d)}setTransformRequest(d){this._transformRequestFn=d}}const Mt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Le(A){var d=[];if("string"==typeof A)d.push({id:"default",url:A});else if(A&&0<A.length){var _,x,C=[];for({id:_,url:x}of A){var M=""+_+x;-1===C.indexOf(M)&&(C.push(M),d.push({id:_,url:x}))}}return d}class ot{constructor(d,_,x,C){this.context=d,this.format=x,this.texture=d.gl.createTexture(),this.update(_,C)}update(d,_,x){var{width:C,height:M}=d,B=!(this.size&&this.size[0]===C&&this.size[1]===M||x),U=this.context,K=U.gl;this.useMipmap=!(!_||!_.useMipmap),K.bindTexture(K.TEXTURE_2D,this.texture),U.pixelStoreUnpackFlipY.set(!1),U.pixelStoreUnpack.set(1),U.pixelStoreUnpackPremultiplyAlpha.set(this.format===K.RGBA&&(!_||!1!==_.premultiply)),B?(this.size=[C,M],d instanceof HTMLImageElement||d instanceof HTMLCanvasElement||d instanceof HTMLVideoElement||d instanceof ImageData||h.isImageBitmap(d)?K.texImage2D(K.TEXTURE_2D,0,this.format,this.format,K.UNSIGNED_BYTE,d):K.texImage2D(K.TEXTURE_2D,0,this.format,C,M,0,this.format,K.UNSIGNED_BYTE,d.data)):(({x:U,y:_}=x||{x:0,y:0}),d instanceof HTMLImageElement||d instanceof HTMLCanvasElement||d instanceof HTMLVideoElement||d instanceof ImageData||h.isImageBitmap(d)?K.texSubImage2D(K.TEXTURE_2D,0,U,_,K.RGBA,K.UNSIGNED_BYTE,d):K.texSubImage2D(K.TEXTURE_2D,0,U,_,C,M,K.RGBA,K.UNSIGNED_BYTE,d.data)),this.useMipmap&&this.isSizePowerOfTwo()&&K.generateMipmap(K.TEXTURE_2D)}bind(d,_,x){var C;(C=(C=this.context).gl).bindTexture(C.TEXTURE_2D,this.texture),x!==C.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(x=C.LINEAR),d!==this.filter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,d),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,x||d),this.filter=d),_!==this.wrap&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,_),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,_),this.wrap=_)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){this.context.gl.deleteTexture(this.texture),this.texture=null}}class Et extends h.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(d){if(this.loaded!==d&&(this.loaded=d)){for(var{ids:_,promiseResolve:x}of this.requestors)x(this._getImagesForIds(_));this.requestors=[]}}getImage(x){var _;return(x=this.images[x])&&!x.data&&x.spriteData&&(x.data=new h.RGBAImage({width:(_=x.spriteData).width,height:_.height},_.context.getImageData(_.x,_.y,_.width,_.height).data),x.spriteData=null),x}addImage(d,_){if(this.images[d])throw new Error(`Image id ${d} already exist, use updateImage instead`);this._validate(d,_)&&(this.images[d]=_)}_validate(d,_){let x=!0;var C=_.data||_.spriteData;return this._validateStretch(_.stretchX,C&&C.width)||(this.fire(new h.ErrorEvent(new Error(`Image "${d}" has invalid "stretchX" value`))),x=!1),this._validateStretch(_.stretchY,C&&C.height)||(this.fire(new h.ErrorEvent(new Error(`Image "${d}" has invalid "stretchY" value`))),x=!1),this._validateContent(_.content,_)||(this.fire(new h.ErrorEvent(new Error(`Image "${d}" has invalid "content" value`))),x=!1),x}_validateStretch(d,_){if(d){let x=0;for(const C of d){if(C[0]<x||C[1]<C[0]||_<C[1])return!1;x=C[1]}}return!0}_validateContent(d,_){var x,C;return!d||4===d.length&&(x=(C=_.spriteData)&&C.width||_.data.width,C=C&&C.height||_.data.height,!(d[0]<0||x<d[0]||d[1]<0||C<d[1]||d[2]<0||x<d[2]||d[3]<0||C<d[3]||d[2]<d[0]||d[3]<d[1]))}updateImage(d,_,x=!0){var C=this.getImage(d);if(x&&(C.data.width!==_.data.width||C.data.height!==_.data.height))throw new Error(`size mismatch between old image (${C.data.width}x${C.data.height}) and new image (${_.data.width}x${_.data.height}).`);_.version=C.version+1,this.images[d]=_,this.updatedImages[d]=!0}removeImage(d){var _=this.images[d];delete this.images[d],delete this.patterns[d],_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(d){return new Promise((_,x)=>{let C=!0;if(!this.isLoaded())for(const M of d)this.images[M]||(C=!1);this.isLoaded()||C?_(this._getImagesForIds(d)):this.requestors.push({ids:d,promiseResolve:_})})}_getImagesForIds(d){var _={};for(const x of d){let C=this.getImage(x);C||(this.fire(new h.Event("styleimagemissing",{id:x})),C=this.getImage(x)),C?_[x]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,contentMatch:C.contentMatch,hasRenderCallback:!(!C.userImage||!C.userImage.render)}:h.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return _}getPixelSize(){var{width:d,height:_}=this.atlasImage;return{width:d,height:_}}getPattern(d){var _=this.patterns[d],x=this.getImage(d);return x?(_&&_.position.version===x.version?_:(_?_.position.version=x.version:(_={w:x.data.width+2,h:x.data.height+2,x:0,y:0},x=new h.ImagePosition(_,x),this.patterns[d]={bin:_,position:x}),this._updatePatternAtlas(),this.patterns[d])).position:null}bind(d){var _=d.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ot(d,this.atlasImage,_.RGBA),this.atlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE)}_updatePatternAtlas(){var d=[];for(const K in this.patterns)d.push(this.patterns[K].bin);const{w:_,h:x}=h.potpack(d);var C=this.atlasImage;C.resize({width:_||1,height:x||1});for(const K in this.patterns){var M=(B=this.patterns[K].bin).x+1,B=B.y+1,U=this.getImage(K).data;const re=U.width,ce=U.height;h.RGBAImage.copy(U,C,{x:0,y:0},{x:M,y:B},{width:re,height:ce}),h.RGBAImage.copy(U,C,{x:0,y:ce-1},{x:M,y:B-1},{width:re,height:1}),h.RGBAImage.copy(U,C,{x:0,y:0},{x:M,y:B+ce},{width:re,height:1}),h.RGBAImage.copy(U,C,{x:re-1,y:0},{x:M-1,y:B},{width:1,height:ce}),h.RGBAImage.copy(U,C,{x:0,y:0},{x:M+re,y:B},{width:1,height:ce})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(d){for(const x of d){var _;this.callbackDispatchedThisFrame[x]||(this.callbackDispatchedThisFrame[x]=!0,(_=this.getImage(x))||h.warnOnce(`Image with ID: "${x}" was not found`),h.renderStyleImage(_)&&this.updateImage(x,_))}}}const Kt=1e20;function Ne(A,d,_,x,C,M,B,U,K){for(let re=d;re<d+x;re++)lt(A,_*M+re,M,C,B,U,K);for(let re=_;re<_+C;re++)lt(A,re*M+d,1,x,B,U,K)}function lt(A,d,_,x,C,M,B){B[M[0]=0]=-Kt,B[1]=Kt,C[0]=A[d];for(let ee=1,he=0,Ee=0;ee<x;ee++){C[ee]=A[d+ee*_];var U=ee*ee;do{var K=M[he];Ee=(C[ee]-C[K]+U-K*K)/(ee-K)/2}while(Ee<=B[he]&&-1<--he);M[++he]=ee,B[he]=Ee,B[he+1]=Kt}for(let ee=0,he=0;ee<x;ee++){for(;B[he+1]<ee;)he++;var re=M[he],ce=ee-re;A[d+ee*_]=C[re]+ce*ce}}class It{constructor(d,_){this.requestManager=d,this.localIdeographFontFamily=_,this.entries={}}setURL(d){this.url=d}getGlyphs(d){return h.__awaiter(this,void 0,void 0,function*(){var _=[];for(const U in d)for(const K of d[U])_.push(this._getAndCacheGlyphsPromise(U,K));var x,C,M,B={};for({stack:x,id:C,glyph:M}of yield Promise.all(_))B[x]||(B[x]={}),B[x][C]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};return B})}_getAndCacheGlyphsPromise(d,_){return h.__awaiter(this,void 0,void 0,function*(){let x=this.entries[d];var C=(x=x||(this.entries[d]={glyphs:{},requests:{},ranges:{}})).glyphs[_];if(void 0!==C)return{stack:d,id:_,glyph:C};if(C=this._tinySDF(x,d,_))return x.glyphs[_]=C,{stack:d,id:_,glyph:C};var M=Math.floor(_/256);if(65535<256*M)throw new Error("glyphs > 65535 not supported");if(x.ranges[M])return{stack:d,id:_,glyph:C};if(!this.url)throw new Error("glyphsUrl is not set");x.requests[M]||(C=It.loadGlyphRange(d,M,this.url,this.requestManager),x.requests[M]=C);var B=yield x.requests[M];for(const U in B)this._doesCharSupportLocalGlyph(+U)||(x.glyphs[+U]=B[+U]);return x.ranges[M]=!0,{stack:d,id:_,glyph:B[_]||null}})}_doesCharSupportLocalGlyph(d){return!!this.localIdeographFontFamily&&(h.unicodeBlockLookup["CJK Unified Ideographs"](d)||h.unicodeBlockLookup["Hangul Syllables"](d)||h.unicodeBlockLookup.Hiragana(d)||h.unicodeBlockLookup.Katakana(d))}_tinySDF(d,_,x){var C=this.localIdeographFontFamily;if(C&&this._doesCharSupportLocalGlyph(x)){let M=d.tinySDF;if(!M){let B="400";/bold/i.test(_)?B="900":/medium/i.test(_)?B="500":/light/i.test(_)&&(B="200"),M=d.tinySDF=new It.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:C,fontWeight:B})}return _=M.draw(String.fromCharCode(x)),{id:x,bitmap:new h.AlphaImage({width:_.width||60,height:_.height||60},_.data),metrics:{width:_.glyphWidth/2||24,height:_.glyphHeight/2||24,left:_.glyphLeft/2+.5||0,top:_.glyphTop/2-27.5||-8,advance:_.glyphAdvance/2||24,isDoubleResolution:!0}}}}}It.loadGlyphRange=function(A,d,_,x){return h.__awaiter(this,void 0,void 0,function*(){var C=256*d,M=255+C,B=x.transformRequest(_.replace("{fontstack}",A).replace("{range}",C+"-"+M),"Glyphs");if(!(B=yield h.getArrayBuffer(B,new AbortController))||!B.data)throw new Error(`Could not load glyph range. range: ${d}, ${C}-`+M);var U={};for(const K of h.parseGlyphPbf(B.data))U[K.id]=K;return U})},It.TinySDF=class{constructor({fontSize:A=24,buffer:d=3,radius:_=8,cutoff:x=.25,fontFamily:C="sans-serif",fontWeight:M="normal",fontStyle:B="normal"}={}){this.buffer=d,this.cutoff=x,this.radius=_,x=this.size=A+4*d,_=this._createCanvas(x),(d=this.ctx=_.getContext("2d",{willReadFrequently:!0})).font=B+` ${M} ${A}px `+C,d.textBaseline="alphabetic",d.textAlign="left",d.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(A){var d=document.createElement("canvas");return d.width=d.height=A,d}draw(A){var{width:d,actualBoundingBoxAscent:x,actualBoundingBoxDescent:_,actualBoundingBoxLeft:ce,actualBoundingBoxRight:U}=this.ctx.measureText(A),x=Math.ceil(x),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(U-ce))),M=Math.min(this.size-this.buffer,x+Math.ceil(_)),B=C+2*this.buffer,U=M+2*this.buffer,K=Math.max(B*U,0),re=new Uint8ClampedArray(K),ce={data:re,width:B,height:U,glyphWidth:C,glyphHeight:M,glyphTop:x,glyphLeft:0,glyphAdvance:d};if(0!==C&&0!==M){var{ctx:_,buffer:ee,gridInner:he,gridOuter:Ee}=this,Se=(_.clearRect(ee,ee,C,M),_.fillText(A,ee,ee+x),_.getImageData(ee,ee,C,M));Ee.fill(Kt,0,K),he.fill(0,0,K);for(let Ye=0;Ye<M;Ye++)for(let _t=0;_t<C;_t++){var Oe,Ae=Se.data[4*(Ye*C+_t)+3]/255;0!=Ae&&(Oe=(Ye+ee)*B+_t+ee,1==Ae?(Ee[Oe]=0,he[Oe]=Kt):(Ee[Oe]=0<(Ae=.5-Ae)?Ae*Ae:0,he[Oe]=Ae<0?Ae*Ae:0))}Ne(Ee,0,0,B,U,B,this.f,this.v,this.z),Ne(he,ee,ee,C,M,B,this.f,this.v,this.z);for(let Ye=0;Ye<K;Ye++){var qe=Math.sqrt(Ee[Ye])-Math.sqrt(he[Ye]);re[Ye]=Math.round(255-255*(qe/this.radius+this.cutoff))}}return ce}};class xt{constructor(){this.specification=h.v8Spec.light.position}possiblyEvaluate(d,_){return h.sphericalToCartesian(d.expression.evaluate(_))}interpolate(d,_,x){return{x:h.interpolate.number(d.x,_.x,x),y:h.interpolate.number(d.y,_.y,x),z:h.interpolate.number(d.z,_.z,x)}}}let Sn;class We extends h.Evented{constructor(d){super(),Sn=Sn||new h.Properties({anchor:new h.DataConstantProperty(h.v8Spec.light.anchor),position:new xt,color:new h.DataConstantProperty(h.v8Spec.light.color),intensity:new h.DataConstantProperty(h.v8Spec.light.intensity)}),this._transitionable=new h.Transitionable(Sn),this.setLight(d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(d,_={}){if(!this._validate(h.validateLight,d,_))for(const C in d){var x=d[C];C.endsWith("-transition")?this._transitionable.setTransition(C.slice(0,-11),x):this._transitionable.setValue(C,x)}}updateTransitions(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(d){this.properties=this._transitioning.possiblyEvaluate(d)}_validate(d,_,x){return(!x||!1!==x.validate)&&h.emitValidationErrors(this,d.call(h.validateStyle,{value:_,style:{glyphs:!0,sprite:!0},styleSpec:h.v8Spec}))}}class on{constructor(d,_){this.width=d,this.height=_,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(d,_){var x=d.join(",")+String(_);return this.dashEntry[x]||(this.dashEntry[x]=this.addDash(d,_)),this.dashEntry[x]}getDashRanges(d,_,x){var C=[];let U=!0,K=(C.push({left:M=d.length%2==1?-d[d.length-1]*x:0,right:B=d[0]*x,isDash:U,zeroLength:0===d[0]}),d[0]);for(let ce=1;ce<d.length;ce++){U=!U;var re=d[ce],M=K*x,B=(K+=re)*x;C.push({left:M,right:B,isDash:U,zeroLength:0===re})}return C}addRoundDash(d,_,x){var C=_/2;for(let ce=-x;ce<=x;ce++){var B=this.width*(this.nextRow+x+ce);let ee=0,he=d[ee];for(let Ee=0;Ee<this.width;Ee++){1<Ee/he.right&&(he=d[++ee]);var U=Math.abs(Ee-he.left),re=Math.abs(Ee-he.right);let Se;var K;U=Math.min(U,re),re=ce/x*(1+C),Se=he.isDash?(K=C-Math.abs(re),Math.sqrt(U*U+K*K)):C-Math.sqrt(U*U+re*re),this.data[B+Ee]=Math.max(0,Math.min(255,Se+128))}}}addRegularDash(d){for(let ee=d.length-1;0<=ee;--ee){var _=d[ee],x=d[ee+1];_.zeroLength?d.splice(ee,1):x&&x.isDash===_.isDash&&(x.left=_.left,d.splice(ee,1))}var C=d[0],M=d[d.length-1],B=(C.isDash===M.isDash&&(C.left=M.left-this.width,M.right=C.right+this.width),this.width*this.nextRow);let U=0,K=d[U];for(let ee=0;ee<this.width;ee++){1<ee/K.right&&(K=d[++U]);var re=Math.abs(ee-K.left),ce=Math.abs(ee-K.right);re=Math.min(re,ce),ce=K.isDash?re:-re,this.data[B+ee]=Math.max(0,Math.min(255,ce+128))}}addDash(d,_){var x,C,M=_?7:0,B=2*M+1;if(this.nextRow+B>this.height)return h.warnOnce("LineAtlas out of space"),null;let U=0;for(let K=0;K<d.length;K++)U+=d[K];return 0!==U&&(C=this.getDashRanges(d,this.width,x=this.width/U),_?this.addRoundDash(C,x,M):this.addRegularDash(C)),_={y:(this.nextRow+M+.5)/this.height,height:2*M/this.height,width:U},this.nextRow+=B,this.dirty=!0,_}bind(d){d=d.gl,this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}const sr="maplibre_preloaded_worker_pool";class nn{constructor(){this.active={}}acquire(d){if(!this.workers)for(this.workers=[];this.workers.length<nn.workerCount;)this.workers.push(new Worker(h.config.WORKER_URL));return this.active[d]=!0,this.workers.slice()}release(d){delete this.active[d],0===this.numActive()&&(this.workers.forEach(_=>{_.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[sr]}numActive(){return Object.keys(this.active).length}}let dt,ar;function pi(){return dt=dt||new nn}fi=Math.floor(P.hardwareConcurrency/2),nn.workerCount=h.isSafari(globalThis)?Math.max(Math.min(fi,3),1):1;class Qn{constructor(d,_){this.workerPool=d,this.actors=[],this.currentActor=0,this.id=_;var x=this.workerPool.acquire(_);for(let M=0;M<x.length;M++){var C;(C=new h.Actor(C=x[M],_)).name="Worker "+M,this.actors.push(C)}if(!this.actors.length)throw new Error("No actors found")}broadcast(d,_){var x=[];for(const C of this.actors)x.push(C.sendAsync({type:d,data:_}));return Promise.all(x)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(d=!0){this.actors.forEach(_=>{_.remove()}),this.actors=[],d&&this.workerPool.release(this.id)}registerMessageHandler(d,_){for(const x of this.actors)x.registerMessageHandler(d,_)}}function Wr(){return ar||(ar=new Qn(pi(),h.GLOBAL_DISPATCHER_ID)).registerMessageHandler("GR",(A,d,_)=>h.makeRequest(d,_)),ar}function zn(A,d,_,ee,C,M){var B,U,K,re=function(Se,Oe,Ae){if(Se)for(const Ye of Se){var qe=Oe[Ye];if(qe&&qe.source===Ae&&"fill-extrusion"===qe.type)return!0}else for(const Ye in Oe){var Ge=Oe[Ye];if(Ge.source===Ae&&"fill-extrusion"===Ge.type)return!0}return!1}(C&&C.layers,d,A.id),ce=M.maxPitchScaleFactor(),he=((ee=A.tilesIn(ee,ce,re)).sort(Ao),[]);for(const Se of ee)he.push({wrappedTileID:Se.tileID.wrapped().key,queryResults:Se.tile.queryRenderedFeatures(d,_,A._state,Se.queryGeometry,Se.cameraQueryGeometry,Se.scale,C,M,ce,(B=A.transform,U=Se.tileID,K=h.create(),h.translate(K,K,[1,1,0]),h.scale(K,K,[.5*B.width,.5*B.height,1]),h.multiply(K,K,B.calculatePosMatrix(U.toUnwrapped()))))});var Ee=function(Se){var Oe={},Ae={};for(const Nt of Se){var qe=Nt.queryResults,Ge=Nt.wrappedTileID,Ye=Ae[Ge]=Ae[Ge]||{};for(const At in qe){var _t=qe[At],bt=Ye[At]=Ye[At]||{},yt=Oe[At]=Oe[At]||[];for(const rn of _t)bt[rn.featureIndex]||(bt[rn.featureIndex]=!0,yt.push(rn))}}return Oe}(he);for(const Se in Ee)Ee[Se].forEach(Ae=>{var qe=A.getFeatureState((Ae=Ae.feature).layer["source-layer"],Ae.id);Ae.source=Ae.layer.source,Ae.layer["source-layer"]&&(Ae.sourceLayer=Ae.layer["source-layer"]),Ae.state=qe});return Ee}function Ao(A,d){return(A=A.tileID).overscaledZ-(d=d.tileID).overscaledZ||A.canonical.y-d.canonical.y||A.wrap-d.wrap||A.canonical.x-d.canonical.x}function Ht(A,d,_){return h.__awaiter(this,void 0,void 0,function*(){let x=A;var C;return A.url?x=(C=yield h.getJSON(d.transformRequest(A.url,"Source"),_)).data:yield P.frameAsync(_),x?(C=h.pick(h.extend(x,A),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]),"vector_layers"in x&&x.vector_layers&&(C.vectorLayerIds=x.vector_layers.map(M=>M.id)),C):null})}class yn{constructor(d,_){d&&(_?this.setSouthWest(d).setNorthEast(_):Array.isArray(d)&&(4===d.length?this.setSouthWest([d[0],d[1]]).setNorthEast([d[2],d[3]]):this.setSouthWest(d[0]).setNorthEast(d[1])))}setNorthEast(d){return this._ne=d instanceof h.LngLat?new h.LngLat(d.lng,d.lat):h.LngLat.convert(d),this}setSouthWest(d){return this._sw=d instanceof h.LngLat?new h.LngLat(d.lng,d.lat):h.LngLat.convert(d),this}extend(d){var x=this._sw,C=this._ne;let M,B;if(d instanceof h.LngLat)M=d,B=d;else{if(!(d instanceof yn))return Array.isArray(d)?4===d.length||d.every(Array.isArray)?this.extend(yn.convert(d)):this.extend(h.LngLat.convert(d)):d&&("lng"in d||"lon"in d)&&"lat"in d?this.extend(h.LngLat.convert(d)):this;if(M=d._sw,B=d._ne,!M||!B)return this}return x||C?(x.lng=Math.min(M.lng,x.lng),x.lat=Math.min(M.lat,x.lat),C.lng=Math.max(B.lng,C.lng),C.lat=Math.max(B.lat,C.lat)):(this._sw=new h.LngLat(M.lng,M.lat),this._ne=new h.LngLat(B.lng,B.lat)),this}getCenter(){return new h.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new h.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new h.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(_){var x,{lng:_,lat:x}=h.LngLat.convert(_);let C=this._sw.lng<=_&&_<=this._ne.lng;return this._sw.lng>this._ne.lng&&(C=this._sw.lng>=_&&_>=this._ne.lng),(x=this._sw.lat<=x&&x<=this._ne.lat)&&C}static convert(d){return d instanceof yn?d:d&&new yn(d)}static fromLngLat(d,x=0){var C=(x=360*x/40075017)/Math.cos(Math.PI/180*d.lat);return new yn(new h.LngLat(d.lng-C,d.lat-x),new h.LngLat(d.lng+C,d.lat+x))}}class gr{constructor(d,_,x){this.bounds=yn.convert(this.validateBounds(d)),this.minzoom=_||0,this.maxzoom=x||24}validateBounds(d){return Array.isArray(d)&&4===d.length?[Math.max(-180,d[0]),Math.max(-90,d[1]),Math.min(180,d[2]),Math.min(90,d[3])]:[-180,-90,180,90]}contains(d){var _=Math.pow(2,d.z);const x=Math.floor(h.mercatorXfromLng(this.bounds.getWest())*_),C=Math.floor(h.mercatorYfromLat(this.bounds.getNorth())*_),M=Math.ceil(h.mercatorXfromLng(this.bounds.getEast())*_),B=Math.ceil(h.mercatorYfromLat(this.bounds.getSouth())*_);return d.x>=x&&d.x<M&&d.y>=C&&d.y<B}}class st extends h.Evented{constructor(d,_,x,C){if(super(),this.id=d,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.extend(this,h.pick(_,["url","scheme","tileSize","promoteId"])),this._options=h.extend({type:"vector"},_),this._collectResourceTiming=_.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}load(){return h.__awaiter(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{var d=yield Ht(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),d&&(h.extend(this,d),d.bounds&&(this.tileBounds=new gr(d.bounds,this.minzoom,this.maxzoom)),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))}catch(_){this._tileJSONRequest=null,this.fire(new h.ErrorEvent(_))}})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}setSourceProperty(d){this._tileJSONRequest&&this._tileJSONRequest.abort(),d(),this.load()}setTiles(d){return this.setSourceProperty(()=>{this._options.tiles=d}),this}setUrl(d){return this.setSourceProperty(()=>{this.url=d,this._options.url=d}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return h.extend({},this._options)}loadTile(d){return h.__awaiter(this,void 0,void 0,function*(){var _=d.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);(_={request:this.map._requestManager.transformRequest(_,"Tile"),uid:d.uid,tileID:d.tileID,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId}).request.collectResourceTiming=this._collectResourceTiming;let x="RT";if(d.actor&&"expired"!==d.state){if("loading"===d.state)return new Promise((M,B)=>{d.reloadPromise={resolve:M,reject:B}})}else d.actor=this.dispatcher.getActor(),x="LT";d.abortController=new AbortController;try{var C=yield d.actor.sendAsync({type:x,data:_},d.abortController);delete d.abortController,d.aborted||this._afterTileLoadWorkerResponse(d,C)}catch(M){if(delete d.abortController,!d.aborted){if(M&&404!==M.status)throw M;this._afterTileLoadWorkerResponse(d,null)}}})}_afterTileLoadWorkerResponse(d,_){_&&_.resourceTiming&&(d.resourceTiming=_.resourceTiming),_&&this.map._refreshExpiredTiles&&d.setExpiryData(_),d.loadVectorData(_,this.map.painter),d.reloadPromise&&(_=d.reloadPromise,d.reloadPromise=null,this.loadTile(d).then(_.resolve).catch(_.reject))}abortTile(d){return h.__awaiter(this,void 0,void 0,function*(){d.abortController&&(d.abortController.abort(),delete d.abortController),d.actor&&(yield d.actor.sendAsync({type:"AT",data:{uid:d.uid,type:this.type,source:this.id}}))})}unloadTile(d){return h.__awaiter(this,void 0,void 0,function*(){d.unloadVectorData(),d.actor&&(yield d.actor.sendAsync({type:"RMT",data:{uid:d.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ut extends h.Evented{constructor(d,_,x,C){super(),this.id=d,this.dispatcher=x,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.extend({type:"raster"},_),h.extend(this,h.pick(_,["url","scheme","tileSize"]))}load(){return h.__awaiter(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{var d=yield Ht(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,d&&(h.extend(this,d),d.bounds&&(this.tileBounds=new gr(d.bounds,this.minzoom,this.maxzoom)),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))}catch(_){this._tileJSONRequest=null,this.fire(new h.ErrorEvent(_))}})}loaded(){return this._loaded}onAdd(d){this.map=d,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(d){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),d(),this.load()}setTiles(d){return this.setSourceProperty(()=>{this._options.tiles=d}),this}setUrl(d){return this.setSourceProperty(()=>{this.url=d,this._options.url=d}),this}serialize(){return h.extend({},this._options)}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d){return h.__awaiter(this,void 0,void 0,function*(){var _=d.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);d.abortController=new AbortController;try{var x,C,M,B=yield g.getImage(this.map._requestManager.transformRequest(_,"Tile"),d.abortController,this.map._refreshExpiredTiles);delete d.abortController,d.aborted?d.state="unloaded":B&&B.data&&(this.map._refreshExpiredTiles&&B.cacheControl&&B.expires&&d.setExpiryData({cacheControl:B.cacheControl,expires:B.expires}),C=(x=this.map.painter.context).gl,d.texture=this.map.painter.getTileTexture((M=B.data).width),d.texture?d.texture.update(M,{useMipmap:!0}):(d.texture=new ot(x,M,C.RGBA,{useMipmap:!0}),d.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),x.extTextureFilterAnisotropic&&C.texParameterf(C.TEXTURE_2D,x.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,x.extTextureFilterAnisotropicMax)),d.state="loaded")}catch(U){if(delete d.abortController,d.aborted)d.state="unloaded";else if(U)throw d.state="errored",U}})}abortTile(d){return h.__awaiter(this,void 0,void 0,function*(){d.abortController&&(d.abortController.abort(),delete d.abortController)})}unloadTile(d){return h.__awaiter(this,void 0,void 0,function*(){d.texture&&this.map.painter.saveTileTexture(d.texture)})}hasTransition(){return!1}}class Jt extends Ut{constructor(d,_,x,C){super(d,_,x,C),this.type="raster-dem",this.maxzoom=22,this._options=h.extend({type:"raster-dem"},_),this.encoding=_.encoding||"mapbox",this.redFactor=_.redFactor,this.greenFactor=_.greenFactor,this.blueFactor=_.blueFactor,this.baseShift=_.baseShift}loadTile(d){return h.__awaiter(this,void 0,void 0,function*(){var _=d.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);_=this.map._requestManager.transformRequest(_,"Tile"),d.neighboringTiles=this._getNeighboringTiles(d.tileID),d.abortController=new AbortController;try{var x,C,M,B,U=yield g.getImage(_,d.abortController,this.map._refreshExpiredTiles);delete d.abortController,d.aborted?d.state="unloaded":U&&U.data&&(x=U.data,this.map._refreshExpiredTiles&&U.cacheControl&&U.expires&&d.setExpiryData({cacheControl:U.cacheControl,expires:U.expires}),C=h.isImageBitmap(x)&&h.offscreenCanvasSupported()?x:yield this.readImageNow(x),M={type:this.type,uid:d.uid,source:this.id,rawImageData:C,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift},d.actor&&"expired"!==d.state||(d.actor=this.dispatcher.getActor(),B=yield d.actor.sendAsync({type:"LDT",data:M}),d.dem=B,d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0,d.state="loaded"))}catch(K){if(delete d.abortController,d.aborted)d.state="unloaded";else if(K)throw d.state="errored",K}})}readImageNow(d){return h.__awaiter(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&h.isOffscreenCanvasDistorted()){var _=d.width+2,x=d.height+2;try{return new h.RGBAImage({width:_,height:x},yield h.readImageUsingVideoFrame(d,-1,-1,_,x))}catch{}}return P.getImageData(d,1)})}_getNeighboringTiles(d){var _=d.canonical,x=Math.pow(2,_.z),C=(_.x-1+x)%x,M=0===_.x?d.wrap-1:d.wrap,B=(_.x+1+x)%x,U=_.x+1===x?d.wrap+1:d.wrap,K={};return K[new h.OverscaledTileID(d.overscaledZ,M,_.z,C,_.y).key]={backfilled:!1},K[new h.OverscaledTileID(d.overscaledZ,U,_.z,B,_.y).key]={backfilled:!1},0<_.y&&(K[new h.OverscaledTileID(d.overscaledZ,M,_.z,C,_.y-1).key]={backfilled:!1},K[new h.OverscaledTileID(d.overscaledZ,d.wrap,_.z,_.x,_.y-1).key]={backfilled:!1},K[new h.OverscaledTileID(d.overscaledZ,U,_.z,B,_.y-1).key]={backfilled:!1}),_.y+1<x&&(K[new h.OverscaledTileID(d.overscaledZ,M,_.z,C,_.y+1).key]={backfilled:!1},K[new h.OverscaledTileID(d.overscaledZ,d.wrap,_.z,_.x,_.y+1).key]={backfilled:!1},K[new h.OverscaledTileID(d.overscaledZ,U,_.z,B,_.y+1).key]={backfilled:!1}),K}unloadTile(d){return h.__awaiter(this,void 0,void 0,function*(){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded",d.actor&&(yield d.actor.sendAsync({type:"RDT",data:{type:this.type,uid:d.uid,source:this.id}}))})}}class oe extends h.Evented{constructor(d,_,x,C){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=x.getActor(),this.setEventedParent(C),this._data=_.data,this._options=h.extend({},_),this._collectResourceTiming=_.collectResourceTiming,void 0!==_.maxzoom&&(this.maxzoom=_.maxzoom),_.type&&(this.type=_.type),_.attribution&&(this.attribution=_.attribution),this.promoteId=_.promoteId,this.workerOptions=h.extend({source:this.id,cluster:_.cluster||!1,geojsonVtOptions:{buffer:(void 0!==_.buffer?_.buffer:128)*(d=h.EXTENT/this.tileSize),tolerance:(void 0!==_.tolerance?_.tolerance:.375)*d,extent:h.EXTENT,maxZoom:this.maxzoom,lineMetrics:_.lineMetrics||!1,generateId:_.generateId||!1},superclusterOptions:{maxZoom:void 0!==_.clusterMaxZoom?_.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,_.clusterMinPoints||2),extent:h.EXTENT,radius:(_.clusterRadius||50)*d,log:!1,generateId:_.generateId||!1},clusterProperties:_.clusterProperties,filter:_.filter},_.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){return h.__awaiter(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(d){this.map=d,this.load()}setData(d){return this._data=d,this._updateWorkerData(),this}updateData(d){return this._updateWorkerData(d),this}setClusterOptions(d){return this.workerOptions.cluster=d.cluster,d&&(void 0!==d.clusterRadius&&(this.workerOptions.superclusterOptions.radius=d.clusterRadius),void 0!==d.clusterMaxZoom)&&(this.workerOptions.superclusterOptions.maxZoom=d.clusterMaxZoom),this._updateWorkerData(),this}getClusterExpansionZoom(d){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:d,source:this.id}})}getClusterChildren(d){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:d,source:this.id}})}getClusterLeaves(d,_,x){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:d,limit:_,offset:x}})}_updateWorkerData(d){return h.__awaiter(this,void 0,void 0,function*(){var _=h.extend({type:this.type},this.workerOptions);d?_.dataDiff=d:"string"==typeof this._data?(_.request=this.map._requestManager.transformRequest(P.resolveURL(this._data),"Source"),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new h.Event("dataloading",{dataType:"source"}));try{var x=yield this.actor.sendAsync({type:"LD",data:_});if(this._pendingLoads--,this._removed||x.abandoned)this.fire(new h.Event("dataabort",{dataType:"source"}));else{let M=null;x.resourceTiming&&x.resourceTiming[this.id]&&(M=x.resourceTiming[this.id].slice(0));var C={dataType:"source"};this._collectResourceTiming&&M&&0<M.length&&h.extend(C,{resourceTiming:M}),this.fire(new h.Event("data",Object.assign(Object.assign({},C),{sourceDataType:"metadata"}))),this.fire(new h.Event("data",Object.assign(Object.assign({},C),{sourceDataType:"content"})))}}catch(M){this._pendingLoads--,this.fire(this._removed?new h.Event("dataabort",{dataType:"source"}):new h.ErrorEvent(M))}})}loaded(){return 0===this._pendingLoads}loadTile(d){return h.__awaiter(this,void 0,void 0,function*(){var _=d.actor?"RT":"LT",x=(d.actor=this.actor,{type:this.type,uid:d.uid,tileID:d.tileID,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId});d.abortController=new AbortController,x=yield this.actor.sendAsync({type:_,data:x},d.abortController),delete d.abortController,d.unloadVectorData(),d.aborted||d.loadVectorData(x,this.map.painter,"RT"==_)})}abortTile(d){return h.__awaiter(this,void 0,void 0,function*(){d.abortController&&(d.abortController.abort(),delete d.abortController),d.aborted=!0})}unloadTile(d){return h.__awaiter(this,void 0,void 0,function*(){d.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:d.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return h.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var ne=h.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class X extends h.Evented{constructor(d,_,x,C){super(),this.id=d,this.dispatcher=x,this.coordinates=_.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=_}load(d){return h.__awaiter(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{var _=yield g.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,_&&_.data&&(this.image=_.data,d&&(this.coordinates=d),this._finishLoading())}catch(x){this._request=null,this.fire(new h.ErrorEvent(x))}})}loaded(){return this._loaded}updateImage(d){return d.url&&(this._request&&(this._request.abort(),this._request=null),this.options.url=d.url,this.load(d.coordinates).finally(()=>{this.texture=null})),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(d){this.map=d,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(d){return d=(this.coordinates=d).map(h.MercatorCoordinate.fromLngLat),this.tileID=function ie(B){let d=1/0,_=1/0,x=-1/0,C=-1/0;for(const U of B)d=Math.min(d,U.x),_=Math.min(_,U.y),x=Math.max(x,U.x),C=Math.max(C,U.y);B=x-d;var M=C-_;return B=Math.max(B,M),M=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),B=Math.pow(2,M),new h.CanonicalTileID(M,Math.floor((d+x)/2*B),Math.floor((_+C)/2*B))}(d),this.minzoom=this.maxzoom=this.tileID.z,d=d.map(_=>this.tileID.getTilePoint(_)._round()),this._boundsArray=new h.RasterBoundsArray,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,h.EXTENT,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,h.EXTENT),this._boundsArray.emplaceBack(d[2].x,d[2].y,h.EXTENT,h.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0!==Object.keys(this.tiles).length&&this.image){var d=this.map.painter.context,_=d.gl;this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,ne.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ot(d,this.image,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));let C=!1;for(const M in this.tiles){var x=this.tiles[M];"loaded"!==x.state&&(x.state="loaded",x.texture=this.texture,C=!0)}C&&this.fire(new h.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}}loadTile(d){return h.__awaiter(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(d.tileID.canonical)?(this.tiles[String(d.tileID.wrap)]=d).buckets={}:d.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ye extends X{constructor(d,_,x,C){super(d,_,x,C),this.roundZoom=!0,this.type="video",this.options=_}load(){return h.__awaiter(this,void 0,void 0,function*(){this._loaded=!1;var d=this.options;this.urls=[];for(const x of d.urls)this.urls.push(this.map._requestManager.transformRequest(x,"Source").url);try{var _=yield h.getVideo(this.urls);this._loaded=!0,_&&(this.video=_,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())}catch(x){this.fire(new h.ErrorEvent(x))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){var _;this.video&&(d<(_=this.video.seekable).start(0)||d>_.end(0)?this.fire(new h.ErrorEvent(new h.ValidationError("sources."+this.id,null,`Playback for this video can be set only between the ${_.start(0)} and ${_.end(0)}-second mark.`))):this.video.currentTime=d)}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var d=this.map.painter.context,_=d.gl;this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,ne.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE),_.texSubImage2D(_.TEXTURE_2D,0,0,0,_.RGBA,_.UNSIGNED_BYTE,this.video)):(this.texture=new ot(d,this.video,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));let C=!1;for(const M in this.tiles){var x=this.tiles[M];"loaded"!==x.state&&(x.state="loaded",x.texture=this.texture,C=!0)}C&&this.fire(new h.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class De extends X{constructor(d,_,x,C){super(d,_,x,C),_.coordinates?Array.isArray(_.coordinates)&&4===_.coordinates.length&&!_.coordinates.some(M=>!Array.isArray(M)||2!==M.length||M.some(B=>"number"!=typeof B))||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+d,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+d,null,'missing required property "coordinates"'))),_.animate&&"boolean"!=typeof _.animate&&this.fire(new h.ErrorEvent(new h.ValidationError("sources."+d,null,'optional "animate" property must be a boolean value'))),_.canvas?"string"==typeof _.canvas||_.canvas instanceof HTMLCanvasElement||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+d,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+d,null,'missing required property "canvas"'))),this.options=_,this.animate=void 0===_.animate||_.animate}load(){return h.__awaiter(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var _=this.map.painter.context,x=_.gl;this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,ne.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ot(_,this.canvas,x.RGBA,{premultiply:!0});let M=!1;for(const B in this.tiles){var C=this.tiles[B];"loaded"!==C.state&&(C.state="loaded",C.texture=this.texture,M=!0)}M&&this.fire(new h.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}}const Ke={},wt=A=>{switch(A){case"geojson":return oe;case"image":return X;case"raster":return Ut;case"raster-dem":return Jt;case"vector":return st;case"video":return ye;case"canvas":return De}return Ke[A]},Pe="RTLPluginLoaded";class Ft extends h.Evented{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Wr()}_syncState(d){return this.status=d,this.dispatcher.broadcast("SRPS",{pluginStatus:d,pluginURL:this.url}).catch(_=>{throw this.status="error",_})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(d){return h.__awaiter(this,arguments,void 0,function*(_,x=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=P.resolveURL(_),!this.url)throw new Error(`requested url ${_} is invalid`);if("unavailable"===this.status){if(!x)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if("requested"===this.status)return this._requestImport()})}_requestImport(){return h.__awaiter(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new h.Event(Pe))})}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let kt=null;function en(){return kt=kt||new Ft}class Yn{constructor(d,_){this.timeAdded=0,this.fadeEndTime=0,this.tileID=d,this.uid=h.uniqueId(),this.uses=0,this.tileSize=_,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(d){(d+=this.timeAdded)<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(d){this.demTexture&&d.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(d,_,x){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",d){d.featureIndex&&(this.latestFeatureIndex=d.featureIndex,d.rawTileData?(this.latestRawTileData=d.rawTileData,this.latestFeatureIndex.rawTileData=d.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=d.collisionBoxArray,this.buckets=function Me(A,d){var _={};if(d)for(const x of A){const C=x.layerIds.map(M=>d.getLayer(M)).filter(Boolean);if(0!==C.length){x.layers=C,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(M=>C.filter(B=>B.id===M)[0]));for(const M of C)_[M.id]=x}}return _}(d.buckets,_.style),this.hasSymbolBuckets=!1;for(const U in this.buckets){var C=this.buckets[U];if(C instanceof h.SymbolBucket){if(this.hasSymbolBuckets=!0,!x)break;C.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const U in this.buckets){var M=this.buckets[U];if(M instanceof h.SymbolBucket&&M.hasRTLText){this.hasRTLText=!0,en().lazyLoad();break}}this.queryPadding=0;for(const U in this.buckets){var B=this.buckets[U];this.queryPadding=Math.max(this.queryPadding,_.style.getLayer(U).queryRadius(B))}d.imageAtlas&&(this.imageAtlas=d.imageAtlas),d.glyphAtlasImage&&(this.glyphAtlasImage=d.glyphAtlasImage)}else this.collisionBoxArray=new h.CollisionBoxArray}unloadVectorData(){for(const d in this.buckets)this.buckets[d].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(d){return this.buckets[d.id]}upload(d){for(const C in this.buckets){var _=this.buckets[C];_.uploadPending()&&_.upload(d)}var x=d.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ot(d,this.imageAtlas.image,x.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ot(d,this.glyphAtlasImage,x.ALPHA),this.glyphAtlasImage=null)}prepare(d){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(d,this.imageAtlasTexture)}queryRenderedFeatures(d,_,x,C,M,B,U,K,re,ce){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:C,cameraQueryGeometry:M,scale:B,tileSize:this.tileSize,pixelPosMatrix:ce,transform:K,params:U,queryPadding:this.queryPadding*re},d,_,x):{}}querySourceFeatures(d,_){var x=this.latestFeatureIndex;if(x&&x.rawTileData){var C=x.loadVTLayers(),M=_&&_.sourceLayer?_.sourceLayer:"",B=C._geojsonTileLayer||C[M];if(B){var U=h.createFilter(_&&_.filter),{z:K,x:re,y:ce}=this.tileID.canonical,ee={z:K,x:re,y:ce};for(let Se=0;Se<B.length;Se++){var he=B.feature(Se);if(U.needGeometry){var Ee=h.toEvaluationFeature(he,!0);if(!U.filter(new h.EvaluationParameters(this.tileID.overscaledZ),Ee,this.tileID.canonical))continue}else if(!U.filter(new h.EvaluationParameters(this.tileID.overscaledZ),he))continue;Ee=x.getId(he,M),(he=new h.GeoJSONFeature(he,K,re,ce,Ee)).tile=ee,d.push(he)}}}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(d){var _=this.expirationTime;if(d.cacheControl?(x=h.parseCacheControl(d.cacheControl))["max-age"]&&(this.expirationTime=Date.now()+1e3*x["max-age"]):d.expires&&(this.expirationTime=new Date(d.expires).getTime()),this.expirationTime){var x=Date.now();let C=!1;this.expirationTime>x?C=!1:!_||this.expirationTime<_||!(d=this.expirationTime-_)?C=!0:this.expirationTime=x+Math.max(d,3e4),C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(d,_){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(d).length){var x,C,M,B=this.latestFeatureIndex.loadVTLayers();for(const U in this.buckets)_.style.hasLayer(U)&&(C=B[M=(x=this.buckets[U]).layers[0].sourceLayer||"_geojsonTileLayer"],M=d[M],C)&&M&&0!==Object.keys(M).length&&(x.update(M,C,this.imageAtlas&&this.imageAtlas.patternPositions||{}),M=_&&_.style&&_.style.getLayer(U))&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(x)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<P.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(d){this.symbolFadeHoldUntil=P.now()+d}setDependencies(d,_){var x={};for(const C of _)x[C]=!0;this.dependencies[d]=x}hasDependency(d,_){for(const C of d){var x=this.dependencies[C];if(x)for(const M of _)if(x[M])return!0}return!1}}class ut{constructor(d,_){this.max=d,this.onRemove=_,this.reset()}reset(){for(const d in this.data)for(const _ of this.data[d])_.timeout&&clearTimeout(_.timeout),this.onRemove(_.value);return this.data={},this.order=[],this}add(d,_,x){var C=d.wrapped().key;void 0===this.data[C]&&(this.data[C]=[]);const M={value:_,timeout:void 0};return void 0!==x&&(M.timeout=setTimeout(()=>{this.remove(d,M)},x)),this.data[C].push(M),this.order.push(C),this.order.length>this.max&&(_=this._getAndRemoveByKey(this.order[0]))&&this.onRemove(_),this}has(d){return d.wrapped().key in this.data}getAndRemove(d){return this.has(d)?this._getAndRemoveByKey(d.wrapped().key):null}_getAndRemoveByKey(d){var _=this.data[d].shift();return _.timeout&&clearTimeout(_.timeout),0===this.data[d].length&&delete this.data[d],this.order.splice(this.order.indexOf(d),1),_.value}getByKey(d){return(d=this.data[d])?d[0].value:null}get(d){return this.has(d)?this.data[d.wrapped().key][0].value:null}remove(d,_){var x;return this.has(d)&&(d=d.wrapped().key,_=void 0===_?0:this.data[d].indexOf(_),x=this.data[d][_],this.data[d].splice(_,1),x.timeout&&clearTimeout(x.timeout),0===this.data[d].length&&delete this.data[d],this.onRemove(x.value),this.order.splice(this.order.indexOf(d),1)),this}setMaxSize(d){for(this.max=d;this.order.length>this.max;){var _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}filter(d){var _=[];for(const x in this.data)for(const C of this.data[x])d(C.value)||_.push(C);for(const x of _)this.remove(x.value.tileID,x)}}class Dt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(d,_,x){var C=String(_);if(this.stateChanges[d]=this.stateChanges[d]||{},this.stateChanges[d][C]=this.stateChanges[d][C]||{},h.extend(this.stateChanges[d][C],x),null===this.deletedStates[d]){this.deletedStates[d]={};for(const M in this.state[d])M!==C&&(this.deletedStates[d][M]=null)}else if(this.deletedStates[d]&&null===this.deletedStates[d][C]){this.deletedStates[d][C]={};for(const M in this.state[d][C])x[M]||(this.deletedStates[d][C][M]=null)}else for(const M in x)this.deletedStates[d]&&this.deletedStates[d][C]&&null===this.deletedStates[d][C][M]&&delete this.deletedStates[d][C][M]}removeFeatureState(d,_,x){if(null!==this.deletedStates[d]){var M=String(_);if(this.deletedStates[d]=this.deletedStates[d]||{},x&&void 0!==_)null!==this.deletedStates[d][M]&&(this.deletedStates[d][M]=this.deletedStates[d][M]||{},this.deletedStates[d][M][x]=null);else if(void 0!==_)if(this.stateChanges[d]&&this.stateChanges[d][M])for(x in this.deletedStates[d][M]={},this.stateChanges[d][M])this.deletedStates[d][M][x]=null;else this.deletedStates[d][M]=null;else this.deletedStates[d]=null}}getState(d,_){var x=String(_),C=this.state[d]||{},B=h.extend({},C[x],(this.stateChanges[d]||{})[x]);if(null===this.deletedStates[d])return{};if(this.deletedStates[d]){if(null===(C=this.deletedStates[d][_]))return{};for(const U in C)delete B[U]}return B}initializeTileState(d,_){d.setFeatureState(this.state,_)}coalesceChanges(d,_){var x={};for(const B in this.stateChanges){this.state[B]=this.state[B]||{};var C={};for(const U in this.stateChanges[B])this.state[B][U]||(this.state[B][U]={}),h.extend(this.state[B][U],this.stateChanges[B][U]),C[U]=this.state[B][U];x[B]=C}for(const B in this.deletedStates){this.state[B]=this.state[B]||{};var M={};if(null===this.deletedStates[B])for(const U in this.state[B])M[U]={},this.state[B][U]={};else for(const U in this.deletedStates[B]){if(null===this.deletedStates[B][U])this.state[B][U]={};else for(const K of Object.keys(this.deletedStates[B][U]))delete this.state[B][U][K];M[U]=this.state[B][U]}x[B]=x[B]||{},h.extend(x[B],M)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(x).length)for(const B in d)d[B].setFeatureState(x,_)}}class qt extends h.Evented{constructor(d,_,x){super(),this.id=d,this.dispatcher=x,this.on("data",C=>{"source"===C.dataType&&"metadata"===C.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===C.dataType&&"content"===C.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((A,d,_,x)=>{if((d=new(wt(d.type))(A,d,_,x)).id!==A)throw new Error(`Expected Source id to be ${A} instead of `+d.id);return d})(d,_,x,this),this._tiles={},this._cache=new ut(0,C=>this._unloadTile(C)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Dt,this._didEmitContent=!1,this._updated=!1}onAdd(d){this.map=d,this._maxTileCacheSize=d?d._maxTileCacheSize:null,this._maxTileCacheZoomLevels=d?d._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(d)}onRemove(d){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(d)}loaded(){if(!this._sourceErrored){if(!this._sourceLoaded||!this._source.loaded())return!1;if(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain){if(!this._updated)return!1;for(const _ in this._tiles){var d=this._tiles[_];if("loaded"!==d.state&&"errored"!==d.state)return!1}}}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){var d;this._paused&&(d=this._shouldReloadOnResume,this._paused=!1,this._shouldReloadOnResume=!1,d&&this.reload(),this.transform)&&this.update(this.transform,this.terrain)}_loadTile(d,_,x){return h.__awaiter(this,void 0,void 0,function*(){try{yield this._source.loadTile(d),this._tileLoaded(d,_,x)}catch(C){d.state="errored",404!==C.status?this._source.fire(new h.ErrorEvent(C,{tile:d})):this.update(this.transform,this.terrain)}})}_unloadTile(d){this._source.unloadTile&&this._source.unloadTile(d)}_abortTile(d){this._source.abortTile&&this._source.abortTile(d),this._source.fire(new h.Event("dataabort",{tile:d,coord:d.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(d){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const x in this._tiles){var _=this._tiles[x];_.upload(d),_.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(d=>d.tileID).sort(Tr).map(d=>d.key)}getRenderableIds(d){var _=[];for(const x in this._tiles)this._isIdRenderable(x,d)&&_.push(this._tiles[x]);return d?_.sort((M,B)=>{B=B.tileID;var U=new h.Point((M=M.tileID).canonical.x,M.canonical.y)._rotate(this.transform.angle),K=new h.Point(B.canonical.x,B.canonical.y)._rotate(this.transform.angle);return M.overscaledZ-B.overscaledZ||K.y-U.y||K.x-U.x}).map(x=>x.tileID.key):_.map(x=>x.tileID).sort(Tr).map(x=>x.key)}hasRenderableParent(d){return!!(d=this.findLoadedParent(d,0))&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(d,_){return this._tiles[d]&&this._tiles[d].hasData()&&!this._coveredTiles[d]&&(_||!this._tiles[d].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const d in this._tiles)"errored"!==this._tiles[d].state&&this._reloadTile(d,"reloading")}}_reloadTile(d,_){return h.__awaiter(this,void 0,void 0,function*(){var x=this._tiles[d];x&&("loading"!==x.state&&(x.state=_),yield this._loadTile(x,d,_))})}_tileLoaded(d,_,x){d.timeAdded=P.now(),"expired"===x&&(d.refreshedUponExpiration=!0),this._setTileReloadTimer(_,d),"raster-dem"===this.getSource().type&&d.dem&&this._backfillDEM(d),this._state.initializeTileState(d,this.map?this.map.painter:null),d.aborted||this._source.fire(new h.Event("data",{dataType:"source",tile:d,coord:d.tileID}))}_backfillDEM(d){var _=this.getRenderableIds();for(let M=0;M<_.length;M++){var x=_[M];d.neighboringTiles&&d.neighboringTiles[x]&&(C(d,x=this.getTileByID(x)),C(x,d))}function C(M,B){M.needsHillshadePrepare=!0,M.needsTerrainPrepare=!0;let U=B.tileID.canonical.x-M.tileID.canonical.x;var K=B.tileID.canonical.y-M.tileID.canonical.y,re=Math.pow(2,M.tileID.canonical.z),ce=B.tileID.key;0===U&&0==K||1<Math.abs(K)||(1<Math.abs(U)&&(1===Math.abs(U+re)?U+=re:1===Math.abs(U-re)&&(U-=re)),B.dem&&M.dem&&(M.dem.backfillBorder(B.dem,U,K),M.neighboringTiles)&&M.neighboringTiles[ce]&&(M.neighboringTiles[ce].backfilled=!0))}}getTile(d){return this.getTileByID(d.key)}getTileByID(d){return this._tiles[d]}_retainLoadedChildren(d,_,x,C){for(const B in this._tiles){let U=this._tiles[B];if(!(C[B]||!U.hasData()||U.tileID.overscaledZ<=_||U.tileID.overscaledZ>x)){let K=U.tileID;for(;U&&U.tileID.overscaledZ>_+1;){var M=U.tileID.scaledTo(U.tileID.overscaledZ-1);(U=this._tiles[M.key])&&U.hasData()&&(K=M)}let re=K;for(;re.overscaledZ>_;)if(d[(re=re.scaledTo(re.overscaledZ-1)).key]){C[K.key]=K;break}}}}findLoadedParent(d,_){var x;if(d.key in this._loadedParentTiles)return(x=this._loadedParentTiles[d.key])&&x.tileID.overscaledZ>=_?x:null;for(let M=d.overscaledZ-1;M>=_;M--){var C=d.scaledTo(M);if(C=this._getLoadedTile(C))return C}}_getLoadedTile(d){var _=this._tiles[d.key];return _&&_.hasData()?_:this._cache.getByKey(d.wrapped().key)}updateCacheSize(C){var x=Math.ceil(C.width/this._source.tileSize)+1;C=Math.ceil(C.height/this._source.tileSize)+1,x=Math.floor(x*C*(null===this._maxTileCacheZoomLevels?h.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),C="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,x):x,this._cache.setMaxSize(C)}handleWrapJump(d){var x=Math.round((d-(void 0===this._prevLng?d:this._prevLng))/360);if(this._prevLng=d,x){var C={};for(const U in this._tiles){var M=this._tiles[U];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+x),C[M.tileID.key]=M}this._tiles=C;for(const U in this._timers)clearTimeout(this._timers[U]),delete this._timers[U];for(const U in this._tiles)this._setTileReloadTimer(U,this._tiles[U])}}update(d,_){if(this.transform=d,this.terrain=_,this._sourceLoaded&&!this._paused){let Ye;this.updateCacheSize(d),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?Ye=d.getVisibleUnwrappedCoordinates(this._source.tileID).map(bt=>new h.OverscaledTileID(bt.canonical.z,bt.wrap,bt.canonical.z,bt.canonical.x,bt.canonical.y)):(Ye=d.coveringTiles({tileSize:(this.usedForTerrain?this:this._source).tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:_}),this._source.hasTile&&(Ye=Ye.filter(bt=>this._source.hasTile(bt)))):Ye=[],d=d.coveringZoomLevel(this._source);var x=Math.max(d-qt.maxOverzooming,this._source.minzoom),C=Math.max(d+qt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){var M,B={};for(const bt of Ye)bt.canonical.z>this._source.minzoom&&(B[(M=bt.scaledTo(bt.canonical.z-1)).key]=M,B[(M=bt.scaledTo(Math.max(this._source.minzoom,Math.min(bt.canonical.z,5)))).key]=M);Ye=Ye.concat(Object.values(B))}var U=0===Ye.length&&!this._updated&&this._didEmitContent,K=(this._updated=!0,U&&this.fire(new h.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id})),this._updateRetainedTiles(Ye,d));if(_i(this._source.type)){var re={},ce={},ee=(U=Object.keys(K),P.now());for(const yt of U){var he=K[yt],Ee=this._tiles[yt];!Ee||0!==Ee.fadeEndTime&&Ee.fadeEndTime<=ee||((Ee=this.findLoadedParent(he,x))&&(this._addTile(Ee.tileID),re[Ee.tileID.key]=Ee.tileID),ce[yt]=he)}this._retainLoadedChildren(ce,d,C,K);for(const yt in re)K[yt]||(this._coveredTiles[yt]=!0,K[yt]=re[yt]);if(_){var Se={},Oe={};for(const yt of Ye)this._tiles[yt.key].hasData()?Se[yt.key]=yt:Oe[yt.key]=yt;for(const yt in Oe){var Ae=Oe[yt].children(this._source.maxzoom);this._tiles[Ae[0].key]&&this._tiles[Ae[1].key]&&this._tiles[Ae[2].key]&&this._tiles[Ae[3].key]&&(Se[Ae[0].key]=K[Ae[0].key]=Ae[0],Se[Ae[1].key]=K[Ae[1].key]=Ae[1],Se[Ae[2].key]=K[Ae[2].key]=Ae[2],Se[Ae[3].key]=K[Ae[3].key]=Ae[3],delete Oe[yt])}for(const yt in Oe){var qe=this.findLoadedParent(Oe[yt],this._source.minzoom);if(qe){Se[qe.tileID.key]=K[qe.tileID.key]=qe.tileID;for(const Nt in Se)Se[Nt].isChildOf(qe.tileID)&&delete Se[Nt]}}for(const yt in this._tiles)Se[yt]||(this._coveredTiles[yt]=!0)}}for(const bt in K)this._tiles[bt].clearFadeHold();for(const bt of h.keysDifference(this._tiles,K)){var Ge=this._tiles[bt];Ge.hasSymbolBuckets&&!Ge.holdingForFade()?Ge.setHoldDuration(this.map._fadeDuration):Ge.hasSymbolBuckets&&!Ge.symbolFadeFinished()||this._removeTile(bt)}this._updateLoadedParentTileCache()}}releaseSymbolFadeTiles(){for(const d in this._tiles)this._tiles[d].holdingForFade()&&this._removeTile(d)}_updateRetainedTiles(d,_){var x={},C={},M=Math.max(_-qt.maxOverzooming,this._source.minzoom),B=Math.max(_+qt.maxUnderzooming,this._source.minzoom),U={};for(const Ee of d){var K=this._addTile(Ee);x[Ee.key]=Ee,K.hasData()||_<this._source.maxzoom&&(U[Ee.key]=Ee)}this._retainLoadedChildren(U,_,B,x);for(const Ee of d){let Se=this._tiles[Ee.key];if(!Se.hasData()){if(_+1>this._source.maxzoom){var re=Ee.children(this._source.maxzoom)[0],ce=this.getTile(re);if(ce&&ce.hasData()){x[re.key]=re;continue}}else if(x[(ce=Ee.children(this._source.maxzoom))[0].key]&&x[ce[1].key]&&x[ce[2].key]&&x[ce[3].key])continue;let Oe=Se.wasRequested();for(let Ae=Ee.overscaledZ-1;Ae>=M;--Ae){var ee=Ee.scaledTo(Ae);if(C[ee.key])break;if(C[ee.key]=!0,Se=!(Se=this.getTile(ee))&&Oe?this._addTile(ee):Se){var he=Se.hasData();if((Oe||he)&&(x[ee.key]=ee),Oe=Se.wasRequested(),he)break}}}}return x}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const x in this._tiles){var d=[];let C,M=this._tiles[x].tileID;for(;0<M.overscaledZ;){if(M.key in this._loadedParentTiles){C=this._loadedParentTiles[M.key];break}d.push(M.key);var _=M.scaledTo(M.overscaledZ-1);if(C=this._getLoadedTile(_))break;M=_}for(const B of d)this._loadedParentTiles[B]=C}}_addTile(d){let _=this._tiles[d.key];var x;return _||((_=this._cache.getAndRemove(d))&&(this._setTileReloadTimer(d.key,_),_.tileID=d,this._state.initializeTileState(_,this.map?this.map.painter:null),this._cacheTimers[d.key])&&(clearTimeout(this._cacheTimers[d.key]),delete this._cacheTimers[d.key],this._setTileReloadTimer(d.key,_)),(x=_)||(_=new Yn(d,this._source.tileSize*d.overscaleFactor()),this._loadTile(_,d.key,_.state)),_.uses++,this._tiles[d.key]=_,x)||this._source.fire(new h.Event("dataloading",{tile:_,coord:_.tileID,dataType:"source"})),_}_setTileReloadTimer(d,_){d in this._timers&&(clearTimeout(this._timers[d]),delete this._timers[d]),(_=_.getExpiryTimeout())&&(this._timers[d]=setTimeout(()=>{this._reloadTile(d,"expired"),delete this._timers[d]},_))}_removeTile(d){var _=this._tiles[d];_&&(_.uses--,delete this._tiles[d],this._timers[d]&&(clearTimeout(this._timers[d]),delete this._timers[d]),0<_.uses||(_.hasData()&&"reloading"!==_.state?this._cache.add(_.tileID,_,_.getExpiryTimeout()):(_.aborted=!0,this._abortTile(_),this._unloadTile(_))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const d in this._tiles)this._removeTile(d);this._cache.reset()}tilesIn(d,_,x){var C=[];const M=this.transform;if(M){x=x?M.getCameraQueryGeometry(d):d;var B=d.map(Ge=>M.pointCoordinate(Ge,this.terrain)),U=x.map(Ge=>M.pointCoordinate(Ge,this.terrain)),K=this.getIds();let Se=1/0,Oe=1/0,Ae=-1/0,qe=-1/0;for(const Ge of U)Se=Math.min(Se,Ge.x),Oe=Math.min(Oe,Ge.y),Ae=Math.max(Ae,Ge.x),qe=Math.max(qe,Ge.y);for(let Ge=0;Ge<K.length;Ge++){var re=this._tiles[K[Ge]];if(!re.holdingForFade()){const Ye=re.tileID;var ce=Math.pow(2,M.zoom-re.tileID.overscaledZ),ee=_*re.queryPadding*h.EXTENT/re.tileSize/ce,he=[Ye.getTilePoint(new h.MercatorCoordinate(Se,Oe)),Ye.getTilePoint(new h.MercatorCoordinate(Ae,qe))];he[0].x-ee<h.EXTENT&&he[0].y-ee<h.EXTENT&&0<=he[1].x+ee&&0<=he[1].y+ee&&(he=B.map(_t=>Ye.getTilePoint(_t)),ee=U.map(_t=>Ye.getTilePoint(_t)),C.push({tile:re,tileID:Ye,queryGeometry:he,cameraQueryGeometry:ee,scale:ce}))}}}return C}getVisibleCoordinates(d){d=this.getRenderableIds(d).map(_=>this._tiles[_].tileID);for(const _ of d)_.posMatrix=this.transform.calculatePosMatrix(_.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(_i(this._source.type)){var d=P.now();for(const _ in this._tiles)if(this._tiles[_].fadeEndTime>=d)return!0}return!1}setFeatureState(d,_,x){this._state.updateState(d=d||"_geojsonTileLayer",_,x)}removeFeatureState(d,_,x){this._state.removeFeatureState(d=d||"_geojsonTileLayer",_,x)}getFeatureState(d,_){return this._state.getState(d=d||"_geojsonTileLayer",_)}setDependencies(d,_,x){(d=this._tiles[d])&&d.setDependencies(_,x)}reloadTilesForDependencies(d,_){for(const x in this._tiles)this._tiles[x].hasDependency(d,_)&&this._reloadTile(x,"reloading");this._cache.filter(x=>!x.hasDependency(d,_))}}function Tr(A,d){var _=Math.abs(2*A.wrap)-(A.wrap<0),x=Math.abs(2*d.wrap)-(d.wrap<0);return A.overscaledZ-d.overscaledZ||x-_||d.canonical.y-A.canonical.y||d.canonical.x-A.canonical.x}function _i(A){return"raster"===A||"image"===A||"video"===A}qt.maxOverzooming=10,qt.maxUnderzooming=3;class In{constructor(d,_){this.reset(d,_)}reset(d,_){this.points=d||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(_||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(M){if(1===this.points.length)return this.points[0];M=h.clamp(M,0,1);let _=1,x=this._distances[_];for(var C=M*this.paddedLength+this.padding;x<C&&_<this._distances.length;)x=this._distances[++_];var U,B=x-(U=this._distances[M=_-1]);return this.points[M].mult(1-(U=0<B?(C-U)/B:0)).add(this.points[_].mult(U))}}function Li(A,d){return"always"===A||"never"!==A&&"never"!==d}class os{constructor(d,_,x){var C=this.boxCells=[],M=this.circleCells=[];this.xCellCount=Math.ceil(d/x),this.yCellCount=Math.ceil(_/x);for(let B=0;B<this.xCellCount*this.yCellCount;B++)C.push([]),M.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=d,this.height=_,this.xScale=this.xCellCount/d,this.yScale=this.yCellCount/_,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(d,_,x,C,M){this._forEachCell(_,x,C,M,this._insertBoxCell,this.boxUid++),this.boxKeys.push(d),this.bboxes.push(_),this.bboxes.push(x),this.bboxes.push(C),this.bboxes.push(M)}insertCircle(d,_,x,C){this._forEachCell(_-C,x-C,_+C,x+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(d),this.circles.push(_),this.circles.push(x),this.circles.push(C)}_insertBoxCell(d,_,x,C,M,B){this.boxCells[M].push(B)}_insertCircleCell(d,_,x,C,M,B){this.circleCells[M].push(B)}_query(d,_,x,C,M,B,U){if(x<0||d>this.width||C<0||_>this.height)return[];var K=[];if(d<=0&&_<=0&&this.width<=x&&this.height<=C){if(M)return[{key:null,x1:d,y1:_,x2:x,y2:C}];for(let he=0;he<this.boxKeys.length;he++)K.push({key:this.boxKeys[he],x1:this.bboxes[4*he],y1:this.bboxes[4*he+1],x2:this.bboxes[4*he+2],y2:this.bboxes[4*he+3]});for(let he=0;he<this.circleKeys.length;he++){var re=this.circles[3*he],ce=this.circles[3*he+1],ee=this.circles[3*he+2];K.push({key:this.circleKeys[he],x1:re-ee,y1:ce-ee,x2:re+ee,y2:ce+ee})}}else this._forEachCell(d,_,x,C,this._queryCell,K,{hitTest:M,overlapMode:B,seenUids:{box:{},circle:{}}},U);return K}query(d,_,x,C){return this._query(d,_,x,C,!1,null)}hitTest(d,_,x,C,M,B){return 0<this._query(d,_,x,C,!0,M,B).length}hitTestCircle(d,_,x,C,M){var B=d-x,U=d+x,K=_-x,re=_+x;return!(U<0||B>this.width||re<0||K>this.height)&&(this._forEachCell(B,K,U,re,this._queryCellCircle,B=[],{hitTest:!0,overlapMode:C,circle:{x:d,y:_,radius:x},seenUids:{box:{},circle:{}}},M),0<B.length)}_queryCell(d,_,x,C,M,B,he,K){var{seenUids:re,hitTest:ce,overlapMode:ee}=he;if(null!==(he=this.boxCells[M])){var Ee=this.bboxes;for(const bt of he)if(!re.box[bt]){re.box[bt]=!0;var Se=4*bt,Oe=this.boxKeys[bt];if(d<=Ee[2+Se]&&_<=Ee[3+Se]&&x>=Ee[0+Se]&&C>=Ee[1+Se]&&(!K||K(Oe))&&(!ce||!Li(ee,Oe.overlapMode))&&(B.push({key:Oe,x1:Ee[Se],y1:Ee[1+Se],x2:Ee[2+Se],y2:Ee[3+Se]}),ce))return!0}}if(null!==(he=this.circleCells[M])){var Ae=this.circles;for(const bt of he)if(!re.circle[bt]){re.circle[bt]=!0;var Ge=this.circleKeys[bt];if(this._circleAndRectCollide(Ae[qe=3*bt],Ae[1+qe],Ae[2+qe],d,_,x,C)&&(!K||K(Ge))&&(!ce||!Li(ee,Ge.overlapMode))){var qe,Ye=Ae[qe],_t=Ae[1+qe];if(B.push({key:Ge,x1:Ye-(qe=Ae[2+qe]),y1:_t-qe,x2:Ye+qe,y2:_t+qe}),ce)return!0}}}return!1}_queryCellCircle(d,_,x,C,M,B,he,K){var{circle:re,seenUids:ce,overlapMode:ee}=he;if(null!==(he=this.boxCells[M])){var Ee=this.bboxes;for(const Ye of he)if(!ce.box[Ye]){ce.box[Ye]=!0;var Se=4*Ye,Oe=this.boxKeys[Ye];if(this._circleAndRectCollide(re.x,re.y,re.radius,Ee[0+Se],Ee[1+Se],Ee[2+Se],Ee[3+Se])&&(!K||K(Oe))&&!Li(ee,Oe.overlapMode))return B.push(!0),!0}}if(null!==(he=this.circleCells[M])){var Ae=this.circles;for(const Ye of he)if(!ce.circle[Ye]){ce.circle[Ye]=!0;var qe=3*Ye,Ge=this.circleKeys[Ye];if(this._circlesCollide(Ae[qe],Ae[1+qe],Ae[2+qe],re.x,re.y,re.radius)&&(!K||K(Ge))&&!Li(ee,Ge.overlapMode))return B.push(!0),!0}}}_forEachCell(d,_,x,C,M,B,U,K){var re=this._convertToXCellCoord(d),ce=this._convertToYCellCoord(_),ee=this._convertToXCellCoord(x),he=this._convertToYCellCoord(C);for(let Se=re;Se<=ee;Se++)for(let Oe=ce;Oe<=he;Oe++)if(M.call(this,d,_,x,C,this.xCellCount*Oe+Se,B,U,K))return}_convertToXCellCoord(d){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(d*this.xScale)))}_convertToYCellCoord(d){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(d*this.yScale)))}_circlesCollide(d,_,x,C,M,B){return(C-=d)*C+(d=M-_)*d<(M=x+B)*M}_circleAndRectCollide(d,_,x,C,M,B,U){return!((B=(B-C)/2)+x<(d=Math.abs(d-(C+B)))||(C=(U-M)/2)+x<(U=Math.abs(_-(M+C)))||!(d<=B||U<=C||(_=d-B)*_+(M=U-C)*M<=x*x))}}function vi(A,d,_,x,C){var M=h.create();return d?(h.scale(M,M,[1/C,1/C,1]),_||h.rotateZ(M,M,x.angle)):h.multiply(M,x.labelPlaneMatrix,A),M}function me(A,d,_,x,C){return d?(d=h.clone(A),h.scale(d,d,[C,C,1]),_||h.rotateZ(d,d,-x.angle),d):x.glCoordMatrix}function J(A,d,_){let x;return _?(x=[A.x,A.y,_(A.x,A.y),1],h.transformMat4(x,x,d)):cn(x=[A.x,A.y,0,1],x,d),{point:new h.Point(x[0]/(_=x[3]),x[1]/_),signedDistanceFromCamera:_}}function se(A,d){return.5+A/d*.5}function le(A,Ae,_,x,C,M,B,U,K,re,ce,ee,he){var qe=U.glyphStartIndex+U.numGlyphs,Ee=U.lineStartIndex,Se=U.lineStartIndex+U.lineLength,Oe=Ae.getoffsetX(U.glyphStartIndex);return Ae=Ae.getoffsetX(qe-1),(qe=$e(A*Oe,_,x,C,M,B,U.segment,Ee,Se,K,re,ce,ee,he))&&(Oe=$e(A*Ae,_,x,C,M,B,U.segment,Ee,Se,K,re,ce,ee,he))?{first:qe,last:Oe}:null}function Ce(A,d,_,x){if(A===h.WritingMode.horizontal){var C=Math.abs(_.y-d.y);if(Math.abs(_.x-d.x)*x<C)return{useVertical:!0}}return(A===h.WritingMode.vertical?d.y<_.y:d.x>_.x)?{needsFlipping:!0}:null}function Ue(A,d,_,x,C,M,B,U,K,re,ce,ee,he,Ee,Se,Oe){var Ae=d/24,qe=A.lineOffsetX*Ae,Ge=A.lineOffsetY*Ae;let Ye;if(1<A.numGlyphs){var _t=A.glyphStartIndex+A.numGlyphs,bt=A.lineStartIndex,yt=A.lineStartIndex+A.lineLength;if(!(d=le(Ae,U,qe,Ge,_,ce,ee,A,K,M,he,Se,Oe)))return{notEnoughRoom:!0};var Nt=J(d.first.point,B,Oe).point;if(B=J(d.last.point,B,Oe).point,x&&!_&&(Nt=Ce(A.writingMode,Nt,B,Ee)))return Nt;Ye=[d.first];for(let mn=A.glyphStartIndex+1;mn<_t-1;mn++)Ye.push($e(Ae*U.getoffsetX(mn),qe,Ge,_,ce,ee,A.segment,bt,yt,K,M,he,Se,Oe));Ye.push(d.last)}else{if(x&&!_&&(B=J(ee,C,Oe).point,Nt=0<(x=J(d=new h.Point(K.getx(Nt=A.lineStartIndex+A.segment+1),K.gety(Nt)),C,Oe)).signedDistanceFromCamera?x.point:Xe(ee,d,B,1,C,Oe),x=Ce(A.writingMode,B,Nt,Ee)))return x;if(!(d=$e(Ae*U.getoffsetX(A.glyphStartIndex),qe,Ge,_,ce,ee,A.segment,A.lineStartIndex,A.lineStartIndex+A.lineLength,K,M,he,Se,Oe)))return{notEnoughRoom:!0};Ye=[d]}for(const At of Ye)h.addDynamicAttributes(re,At.point,At.angle);return{}}function Xe(A,d,_,x,C,M){return A=J(A.add(A.sub(d)._unit()),C,M).point,d=_.sub(A),_.add(d._mult(x/d.mag()))}function He(A,C){var _,x,{projectionCache:C,lineVertexArray:M,labelPlaneMatrix:B,tileAnchorPoint:U,distanceFromAnchor:K,getElevation:re,previousVertex:ce,direction:ee,absOffsetX:he}=C;return C.projections[A]||(0<(x=J(_=new h.Point(M.getx(A),M.gety(A)),B,re)).signedDistanceFromCamera?(C.projections[A]=x.point,x.point):(C=A-ee,Xe(0===K?U:new h.Point(M.getx(C),M.gety(C)),_,ce,he-K+1,B,re)))}function Ve(A,d,_){return A._unit()._perp()._mult(d*_)}function $e(A,d,_,x,C,M,B,U,K,re,ce,ee,he,Ee){let Ye,_t,Se=0<(A=x?A-d:A+d)?1:-1,Oe=0,Ae=(x&&(Se*=-1,Oe=Math.PI),Se<0&&(Oe+=Math.PI),0<Se?U+B:U+B+1),qe=C,Ge=C,bt=0,yt=0;var Nt=Math.abs(A),At=[];let rn;for(;bt+yt<=Nt;){if((Ae+=Se)<U||Ae>=K)return null;bt+=yt,Ge=qe,_t=Ye;var mn={projectionCache:ee,lineVertexArray:re,labelPlaneMatrix:ce,tileAnchorPoint:M,distanceFromAnchor:bt,getElevation:Ee,previousVertex:Ge,direction:Se,absOffsetX:Nt};if(qe=He(Ae,mn),0===_)At.push(Ge),rn=qe.sub(Ge);else{let er;var Fn=qe.sub(Ge);er=0===Fn.mag()?Ve(He(Ae+Se,mn).sub(qe),_,Se):Ve(Fn,_,Se),_t=_t||Ge.add(er),Ye=function(ur,Un,sn,qn,Dr,An,xi,ho){var{projectionCache:ui,direction:Ti}=ho;if(!ui.offsets[ur]){if(Un=sn.add(Un),ur+Ti<qn||Dr<=ur+Ti)return ui.offsets[ur]=Un;Dr=Ve((qn=He(ur+Ti,ho)).sub(sn),xi,Ti),ho=sn.add(Dr),xi=qn.add(Dr),ui.offsets[ur]=h.findLineIntersection(An,Un,ho,xi)||Un}return ui.offsets[ur]}(Ae,er,qe,U,K,_t,_,mn),At.push(_t),rn=Ye.sub(_t)}yt=rn.mag()}return x=rn._mult(d=(Nt-bt)/yt)._add(_t||Ge),B=Oe+Math.atan2(qe.y-Ge.y,qe.x-Ge.x),At.push(x),{point:x,angle:he?B:0,path:At}}const Rt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ot(A,d){for(let x=0;x<A;x++){var _=d.length;d.resize(_+4),d.float32.set(Rt,3*_)}}function cn(A,C,_){var x=C[0];A[0]=_[0]*x+_[4]*(C=C[1])+_[12],A[1]=_[1]*x+_[5]*C+_[13],A[3]=_[3]*x+_[7]*C+_[15]}class nr{constructor(d,_=new os(d.width+200,d.height+200,25),x=new os(d.width+200,d.height+200,25)){this.transform=d,this.grid=_,this.ignoredGrid=x,this.pitchfactor=Math.cos(d._pitch)*d.cameraToCenterDistance,this.screenRightBoundary=d.width+100,this.screenBottomBoundary=d.height+100,this.gridRightBoundary=d.width+200,this.gridBottomBoundary=d.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(he,_,re,U,M,K){U=this.projectAndGetPerspectiveRatio(U,he.anchorPointX,he.anchorPointY,K);var ce=he.y1*(K=re*U.perspectiveRatio)+U.point.y,ee=he.x2*K+U.point.x;return!this.isInsideGrid(re=he.x1*K+U.point.x,ce,ee,he=he.y2*K+U.point.y)||"always"!==_&&this.grid.hitTest(re,ce,ee,he,_,M)||U.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[re,ce,ee,he],offscreen:this.isOffscreen(re,ce,ee,he)}}placeCollisionCircles(d,_,x,_t,Ye,qe,U,K,re,Ge,ee,he,Ee,Se){var Oe=[],Ae=new h.Point(_.anchorX,_.anchorY);qe=J(Ae,qe,Se),qe=se(this.transform.cameraToCenterDistance,qe.signedDistanceFromCamera),Ge=(Ge?Ye/qe:Ye*qe)/h.ONE_EM,Ye=J(Ae,U,Se).point;let bt=!1,yt=!1,Nt=!0;if(_t=le(Ge,_t,_.lineOffsetX*Ge,_.lineOffsetY*Ge,!1,Ye,Ae,_,x,U,{projections:{},offsets:{}},!1,Se)){var At=.5*he*qe+Ee,rn=(Ge=new h.Point(-100,-100),Ye=new h.Point(this.screenRightBoundary,this.screenBottomBoundary),new In),mn=_t.first,Fn=_t.last;let Br=[];for(let Ri=mn.path.length-1;1<=Ri;Ri--)Br.push(mn.path[Ri]);for(let Ri=1;Ri<Fn.path.length;Ri++)Br.push(Fn.path[Ri]);var er=2.5*At;K&&(Ae=Br.map(Ri=>J(Ri,K,Se)),Br=Ae.some(Ri=>Ri.signedDistanceFromCamera<=0)?[]:Ae.map(Ri=>Ri.point));let bo=[];if(0<Br.length){var ur=Br[0].clone(),Un=Br[0].clone();for(let Ri=1;Ri<Br.length;Ri++)ur.x=Math.min(ur.x,Br[Ri].x),ur.y=Math.min(ur.y,Br[Ri].y),Un.x=Math.max(Un.x,Br[Ri].x),Un.y=Math.max(Un.y,Br[Ri].y);bo=ur.x>=Ge.x&&Un.x<=Ye.x&&ur.y>=Ge.y&&Un.y<=Ye.y?[Br]:Un.x<Ge.x||ur.x>Ye.x||Un.y<Ge.y||ur.y>Ye.y?[]:h.clipLine([Br],Ge.x,Ge.y,Ye.x,Ye.y)}for(const Ri of bo){rn.reset(Ri,.25*At);let no=0;no=rn.length<=.5*At?1:Math.ceil(rn.paddedLength/er)+1;for(let Al=0;Al<no;Al++){var qn=Al/Math.max(no-1,1),sn=(qn=rn.lerp(qn)).x+100,Dr=(Oe.push(sn,qn=qn.y+100,At,0),sn-At),An=qn-At,xi=sn+At,ho=qn+At;if(Nt=Nt&&this.isOffscreen(Dr,An,xi,ho),yt=yt||this.isInsideGrid(Dr,An,xi,ho),"always"!==d&&this.grid.hitTestCircle(sn,qn,At,d,ee)&&(bt=!0,!re))return{circles:[],offscreen:!1,collisionDetected:bt}}}}return{circles:!re&&bt||!yt||qe<this.perspectiveRatioCutoff?[]:Oe,offscreen:Nt,collisionDetected:bt}}queryRenderedSymbols(d){if(0===d.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};var _=[];let x=1/0,C=1/0,M=-1/0,B=-1/0;for(const he of d){var U=new h.Point(he.x+100,he.y+100);x=Math.min(x,U.x),C=Math.min(C,U.y),M=Math.max(M,U.x),B=Math.max(B,U.y),_.push(U)}var K={},re={};for(const he of this.grid.query(x,C,M,B).concat(this.ignoredGrid.query(x,C,M,B))){var ce,ee=he.key;void 0===K[ee.bucketInstanceId]&&(K[ee.bucketInstanceId]={}),K[ee.bucketInstanceId][ee.featureIndex]||(ce=[new h.Point(he.x1,he.y1),new h.Point(he.x2,he.y1),new h.Point(he.x2,he.y2),new h.Point(he.x1,he.y2)],h.polygonIntersectsPolygon(_,ce)&&(K[ee.bucketInstanceId][ee.featureIndex]=!0,void 0===re[ee.bucketInstanceId]&&(re[ee.bucketInstanceId]=[]),re[ee.bucketInstanceId].push(ee.featureIndex)))}return re}insertCollisionBox(d,_,x,C,M,B){(x?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:M,collisionGroupID:B,overlapMode:_},d[0],d[1],d[2],d[3])}insertCollisionCircles(d,_,x,C,M,B){var U=x?this.ignoredGrid:this.grid,K={bucketInstanceId:C,featureIndex:M,collisionGroupID:B,overlapMode:_};for(let re=0;re<d.length;re+=4)U.insertCircle(K,d[re],d[re+1],d[re+2])}projectAndGetPerspectiveRatio(d,_,x,C){let M;return C?(M=[_,x,C(_,x),1],h.transformMat4(M,M,d)):cn(M=[_,x,0,1],M,d),{point:new h.Point((M[0]/M[3]+1)/2*this.transform.width+100,(-M[1]/M[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/M[3]*.5}}isOffscreen(d,_,x,C){return x<100||d>=this.screenRightBoundary||C<100||_>this.screenBottomBoundary}isInsideGrid(d,_,x,C){return 0<=x&&d<this.gridRightBoundary&&0<=C&&_<this.gridBottomBoundary}getViewportMatrix(){var d=h.identity([]);return h.translate(d,d,[-100,-100,0]),d}}function $n(A,d,_){return d*(h.EXTENT/(A.tileSize*Math.pow(2,_-A.tileID.overscaledZ)))}class lr{constructor(d,_,x,C){this.opacity=d?Math.max(0,Math.min(1,d.opacity+(d.placed?_:-_))):C&&x?1:0,this.placed=x}isHidden(){return 0===this.opacity&&!this.placed}}class ci{constructor(d,_,x,C,M){this.text=new lr(d?d.text:null,_,x,M),this.icon=new lr(d?d.icon:null,_,C,M)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class wi{constructor(d,_,x){this.text=d,this.icon=_,this.skipFade=x}}class Yr{constructor(){this.invProjMatrix=h.create(),this.viewportMatrix=h.create(),this.circles=[]}}class ni{constructor(d,_,x,C,M){this.bucketInstanceId=d,this.featureIndex=_,this.sourceLayerIndex=x,this.bucketIndex=C,this.tileID=M}}class cr{constructor(d){this.crossSourceCollisions=d,this.maxGroupID=0,this.collisionGroups={}}get(d){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[d]){const _=++this.maxGroupID;this.collisionGroups[d]={ID:_,predicate:x=>x.collisionGroupID===_}}return this.collisionGroups[d]}}function rr(M,d,_,x,C){var{horizontalAlign:M,verticalAlign:B}=h.getAnchorAlignment(M);return new h.Point(-(M-.5)*d+x[0]*C,-(B-.5)*_+x[1]*C)}function bi(B,he,_,x,C,M){var{x1:B,x2:U,y1:K,y2:re,anchorPointX:ce,anchorPointY:ee}=B;return he=new h.Point(he,_),x&&he._rotate(C?M:-M),{x1:B+he.x,y1:K+he.y,x2:U+he.x,y2:re+he.y,anchorPointX:ce,anchorPointY:ee}}class js{constructor(d,_,x,C,M){this.transform=d.clone(),this.terrain=_,this.collisionIndex=new nr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=x,this.retainedQueryData={},this.collisionGroups=new cr(C),this.collisionCircleArrays={},(this.prevPlacement=M)&&(M.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(d,_,x,C){var M=x.getBucket(_),B=x.latestFeatureIndex;if(M&&B&&_.id===M.layerIds[0]){_=x.collisionBoxArray;var U=M.layers[0].layout,K=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),re=x.tileSize/h.EXTENT,ce=this.transform.calculatePosMatrix(x.tileID.toUnwrapped()),ee="map"===U.get("text-pitch-alignment"),he="map"===U.get("text-rotation-alignment"),Ee=$n(x,1,this.transform.zoom),Se=vi(ce,ee,he,this.transform,Ee);let _t=null;ee&&(ee=me(ce,ee,he,this.transform,Ee),_t=h.multiply([],this.transform.labelPlaneMatrix,ee)),this.retainedQueryData[M.bucketInstanceId]=new ni(M.bucketInstanceId,B,M.sourceLayerIndex,M.index,x.tileID);var Oe={bucket:M,layout:U,posMatrix:ce,textLabelPlaneMatrix:Se,labelToScreenMatrix:_t,scale:K,textPixelRatio:re,holdingForFade:x.holdingForFade(),collisionBoxArray:_,partiallyEvaluatedTextSize:h.evaluateSizeForZoom(M.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(M.sourceID)};if(C)for(const bt of M.sortKeyRanges){var{sortKey:Ae,symbolInstanceStart:qe,symbolInstanceEnd:Ge}=bt;d.push({sortKey:Ae,symbolInstanceStart:qe,symbolInstanceEnd:Ge,parameters:Oe})}else d.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:Oe})}}attemptAnchorPlacement(Ge,_t,x,C,M,B,U,K,re,ce,ee,he,Ee,Se,Oe,Ae){var qe=h.TextAnchorEnum[Ge.textAnchor],Ye=rr(qe,x,C,Ge=[Ge.textOffset0,Ge.textOffset1],M);if(_t=this.collisionIndex.placeCollisionBox(bi(_t,Ye.x,Ye.y,B,U,this.transform.angle),ee,K,re,ce.predicate,Ae),(!Oe||0!==this.collisionIndex.placeCollisionBox(bi(Oe,Ye.x,Ye.y,B,U,this.transform.angle),ee,K,re,ce.predicate,Ae).box.length)&&0<_t.box.length){let bt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[he.crossTileID]&&this.prevPlacement.placements[he.crossTileID]&&this.prevPlacement.placements[he.crossTileID].text&&(bt=this.prevPlacement.variableOffsets[he.crossTileID].anchor),0===he.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[he.crossTileID]={textOffset:Ge,width:x,height:C,anchor:qe,textBoxScale:M,prevAnchor:bt},this.markUsedJustification(Ee,qe,he,Se),Ee.allowVerticalPlacement&&(this.markUsedOrientation(Ee,Se,he),this.placedOrientations[he.crossTileID]=Se),{shift:Ye,placedGlyphBoxes:_t}}}placeLayerBucketPart(d,_,x){const{bucket:C,layout:M,posMatrix:B,textLabelPlaneMatrix:U,labelToScreenMatrix:K,textPixelRatio:re,holdingForFade:ce,collisionBoxArray:ee,partiallyEvaluatedTextSize:he,collisionGroup:Ee}=d.parameters,Se=M.get("text-optional"),Oe=M.get("icon-optional"),Ae=h.getOverlapMode(M,"text-overlap","text-allow-overlap"),qe="always"===Ae,Ge=h.getOverlapMode(M,"icon-overlap","icon-allow-overlap");var Ye="always"===Ge;const _t="map"===M.get("text-rotation-alignment"),bt="map"===M.get("text-pitch-alignment"),yt="none"!==M.get("icon-text-fit");var Nt="viewport-y"===M.get("symbol-z-order");const At=qe&&(Ye||!C.hasIconData()||Oe),rn=Ye&&(qe||!C.hasTextData()||Se),mn=(!C.collisionArrays&&ee&&C.deserializeCollisionBoxes(ee),this.retainedQueryData[C.bucketInstanceId].tileID),Fn=this.terrain?(sn,qn)=>this.terrain.getElevation(mn,sn,qn):null;var er=(sn,qn)=>{if(!_[sn.crossTileID])if(ce)this.placements[sn.crossTileID]=new wi(!1,!1,!1);else{let Ti=!1,Br=!1,bo=!0,Ri=null,no={box:null,offscreen:null},Al={box:null,offscreen:null},na=null,Mh=null,ll=0,Cs=0,Ls=0;qn.textFeatureIndex?ll=qn.textFeatureIndex:sn.useRuntimeCollisionCircles&&(ll=sn.featureIndex),qn.verticalTextFeatureIndex&&(Cs=qn.verticalTextFeatureIndex);const Vp=qn.textBox;if(Vp){var Dr=Lo=>{let Eo=h.WritingMode.horizontal;return C.allowVerticalPlacement&&!Lo&&this.prevPlacement&&(Lo=this.prevPlacement.placedOrientations[sn.crossTileID])&&(this.placedOrientations[sn.crossTileID]=Lo,Eo=Lo,this.markUsedOrientation(C,Eo,sn)),Eo},An=(Lo,Eo)=>{if(C.allowVerticalPlacement&&0<sn.numVerticalGlyphVertices&&qn.verticalTextBox){for(const Hs of C.writingModes)if(Hs===h.WritingMode.vertical?(no=Eo(),Al=no):no=Lo(),no&&no.box&&no.box.length)break}else no=Lo()};const Po=sn.textAnchorOffsetStartIndex,Dl=sn.textAnchorOffsetEndIndex;if(Dl===Po){const Lo=(Eo,Hs)=>((Eo=this.collisionIndex.placeCollisionBox(Eo,Ae,re,B,Ee.predicate,Fn))&&Eo.box&&Eo.box.length&&(this.markUsedOrientation(C,Hs,sn),this.placedOrientations[sn.crossTileID]=Hs),Eo);An(()=>Lo(Vp,h.WritingMode.horizontal),()=>{var Eo=qn.verticalTextBox;return C.allowVerticalPlacement&&0<sn.numVerticalGlyphVertices&&Eo?Lo(Eo,h.WritingMode.vertical):{box:null,offscreen:null}}),Dr(no&&no.box&&no.box.length)}else{let Lo=h.TextAnchorEnum[null==(xi=null==(xi=this.prevPlacement)?void 0:xi.variableOffsets[sn.crossTileID])?void 0:xi.anchor];const Eo=(Wo,za,em)=>{var Cd=Wo.x2-Wo.x1,pa=Wo.y2-Wo.y1,Id=sn.textBoxScale,tm=yt&&"never"===Ge?za:null;let Ro={box:[],offscreen:!1},Is="never"===Ae?1:2,Bp="never";Lo&&Is++;for(let zg=0;zg<Is;zg++){for(let nm=Po;nm<Dl;nm++){var hu=C.textAnchorOffsets.get(nm);if((!Lo||hu.textAnchor===Lo)&&(hu=this.attemptAnchorPlacement(hu,Wo,Cd,pa,Id,_t,bt,re,B,Ee,Bp,sn,C,em,tm,Fn))&&(Ro=hu.placedGlyphBoxes)&&Ro.box&&Ro.box.length)return Ti=!0,Ri=hu.shift,Ro}Lo?Lo=null:Bp=Ae}return Ro};An(()=>Eo(Vp,qn.iconBox,h.WritingMode.horizontal),()=>{var Wo=qn.verticalTextBox;return C.allowVerticalPlacement&&!(no&&no.box&&no.box.length)&&0<sn.numVerticalGlyphVertices&&Wo?Eo(Wo,qn.verticalIconBox,h.WritingMode.vertical):{box:null,offscreen:null}}),no&&(Ti=no.box,bo=no.offscreen);var xi=Dr(no&&no.box);!Ti&&this.prevPlacement&&(An=this.prevPlacement.variableOffsets[sn.crossTileID])&&(this.variableOffsets[sn.crossTileID]=An,this.markUsedJustification(C,An.anchor,sn,xi))}}Ti=(Dr=no)&&Dr.box&&0<Dr.box.length,bo=Dr&&Dr.offscreen,sn.useRuntimeCollisionCircles&&(An=C.text.placedSymbolArray.get(sn.centerJustifiedTextSymbolIndex),xi=h.evaluateSizeForFeature(C.textSizeData,he,An),ui=M.get("text-padding"),(na=this.collisionIndex.placeCollisionCircles(Ae,An,C.lineVertexArray,C.glyphOffsetArray,xi,B,U,K,x,bt,Ee.predicate,ho=sn.collisionCircleDiameter,ui,Fn)).circles.length&&na.collisionDetected&&!x&&h.warnOnce("Collisions detected, but collision boxes are not shown"),Ti=qe||0<na.circles.length&&!na.collisionDetected,bo=bo&&na.offscreen),qn.iconFeatureIndex&&(Ls=qn.iconFeatureIndex),qn.iconBox&&(Br=0<(Mh=(An=Po=>(Po=yt&&Ri?bi(Po,Ri.x,Ri.y,_t,bt,this.transform.angle):Po,this.collisionIndex.placeCollisionBox(Po,Ge,re,B,Ee.predicate,Fn)))(Al&&Al.box&&Al.box.length&&qn.verticalIconBox?qn.verticalIconBox:qn.iconBox)).box.length,bo=bo&&Mh.offscreen);var ho=Oe||0===sn.numIconVertices;if((xi=Se||0===sn.numHorizontalGlyphVertices&&0===sn.numVerticalGlyphVertices)||ho?ho?xi||(Br=Br&&Ti):Ti=Br&&Ti:Br=Ti=Br&&Ti,Ti&&Dr&&Dr.box&&this.collisionIndex.insertCollisionBox(Dr.box,Ae,M.get("text-ignore-placement"),C.bucketInstanceId,Al&&Al.box&&Cs?Cs:ll,Ee.ID),Br&&Mh&&this.collisionIndex.insertCollisionBox(Mh.box,Ge,M.get("icon-ignore-placement"),C.bucketInstanceId,Ls,Ee.ID),na&&(Ti&&this.collisionIndex.insertCollisionCircles(na.circles,Ae,M.get("text-ignore-placement"),C.bucketInstanceId,ll,Ee.ID),x)){var ui=C.bucketInstanceId;let Po=this.collisionCircleArrays[ui];void 0===Po&&(Po=this.collisionCircleArrays[ui]=new Yr);for(let Dl=0;Dl<na.circles.length;Dl+=4)Po.circles.push(na.circles[Dl+0]),Po.circles.push(na.circles[Dl+1]),Po.circles.push(na.circles[Dl+2]),Po.circles.push(na.collisionDetected?1:0)}if(0===sn.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===C.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[sn.crossTileID]=new wi(Ti||At,Br||rn,bo||C.justReloaded),_[sn.crossTileID]=!0}};if(Nt){if(0!==d.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");var ur=C.getSortedSymbolIndexes(this.transform.angle);for(let sn=ur.length-1;0<=sn;--sn){var Un=ur[sn];er(C.symbolInstances.get(Un),C.collisionArrays[Un])}}else for(let sn=d.symbolInstanceStart;sn<d.symbolInstanceEnd;sn++)er(C.symbolInstances.get(sn),C.collisionArrays[sn]);x&&C.bucketInstanceId in this.collisionCircleArrays&&(h.invert((Ye=this.collisionCircleArrays[C.bucketInstanceId]).invProjMatrix,B),Ye.viewportMatrix=this.collisionIndex.getViewportMatrix()),C.justReloaded=!1}markUsedJustification(d,_,x,C){let B;B=C===h.WritingMode.vertical?x.verticalPlacedTextSymbolIndex:{left:x.leftJustifiedTextSymbolIndex,center:x.centerJustifiedTextSymbolIndex,right:x.rightJustifiedTextSymbolIndex}[h.getAnchorJustification(_)];for(const U of[x.leftJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.rightJustifiedTextSymbolIndex,x.verticalPlacedTextSymbolIndex])0<=U&&(d.text.placedSymbolArray.get(U).crossTileID=0<=B&&U!==B?0:x.crossTileID)}markUsedOrientation(d,M,x){var C=M===h.WritingMode.horizontal||M===h.WritingMode.horizontalOnly?M:0;M=M===h.WritingMode.vertical?M:0;for(const B of[x.leftJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.rightJustifiedTextSymbolIndex])d.text.placedSymbolArray.get(B).placedOrientation=C;x.verticalPlacedTextSymbolIndex&&(d.text.placedSymbolArray.get(x.verticalPlacedTextSymbolIndex).placedOrientation=M)}commit(d){this.commitTime=d,this.zoomAtLastRecencyCheck=this.transform.zoom;var _=this.prevPlacement;let x=!1;this.prevZoomAdjustment=_?_.zoomAdjustment(this.transform.zoom):0;var C=_?_.symbolFadeChange(d):1,M=_?_.opacities:{},B=_?_.variableOffsets:{},U=_?_.placedOrientations:{};for(const he in this.placements){var K=this.placements[he],re=M[he];x=re?(this.opacities[he]=new ci(re,C,K.text,K.icon),x||K.text!==re.text.placed||K.icon!==re.icon.placed):(this.opacities[he]=new ci(null,C,K.text,K.icon,K.skipFade),x||K.text||K.icon)}for(const he in M){var ce,ee=M[he];this.opacities[he]||(ce=new ci(ee,C,!1,!1)).isHidden()||(this.opacities[he]=ce,x=x||ee.text.placed||ee.icon.placed)}for(const he in B)this.variableOffsets[he]||!this.opacities[he]||this.opacities[he].isHidden()||(this.variableOffsets[he]=B[he]);for(const he in U)this.placedOrientations[he]||!this.opacities[he]||this.opacities[he].isHidden()||(this.placedOrientations[he]=U[he]);if(_&&void 0===_.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");x?this.lastPlacementChangeTime=d:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=_?_.lastPlacementChangeTime:d)}updateLayerOpacities(d,_){var x={};for(const M of _){var C=M.getBucket(d);C&&M.latestFeatureIndex&&d.id===C.layerIds[0]&&this.updateBucketOpacities(C,x,M.collisionBoxArray)}}updateBucketOpacities(d,_,x){d.hasTextData()&&(d.text.opacityVertexArray.clear(),d.text.hasVisibleVertices=!1),d.hasIconData()&&(d.icon.opacityVertexArray.clear(),d.icon.hasVisibleVertices=!1),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexArray.clear(),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexArray.clear();var C=d.layers[0],M=C.layout,B=new ci(null,0,!1,!1,!0),U=M.get("text-allow-overlap"),K=M.get("icon-allow-overlap"),re=C._unevaluatedLayout.hasValue("text-variable-anchor")||C._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ce="map"===M.get("text-rotation-alignment"),ee="map"===M.get("text-pitch-alignment"),he="none"!==M.get("icon-text-fit"),Ee=new ci(null,0,U&&(K||!d.hasIconData()||M.get("icon-optional")),K&&(U||!d.hasTextData()||M.get("text-optional")),!0),Se=(!d.collisionArrays&&x&&(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&d.deserializeCollisionBoxes(x),(At,rn,mn)=>{for(let Fn=0;Fn<rn/4;Fn++)At.opacityVertexArray.emplaceBack(mn);At.hasVisibleVertices=At.hasVisibleVertices||mn!==w_});for(let At=0;At<d.symbolInstances.length;At++){var Oe=d.symbolInstances.get(At),{numHorizontalGlyphVertices:Ae,numVerticalGlyphVertices:qe,crossTileID:Ge}=Oe;let rn=this.opacities[Ge];(Ye=_[Ge])?rn=B:rn||(rn=Ee,this.opacities[Ge]=rn),_[Ge]=!0;var Ye=0<Oe.numIconVertices,_t=this.placedOrientations[Oe.crossTileID];const mn=_t===h.WritingMode.vertical;var bt=_t===h.WritingMode.horizontal||_t===h.WritingMode.horizontalOnly;if(0<Ae||0<qe){var Nt=wo(rn.text),Ae=(Se(d.text,Ae,yt=mn?w_:Nt),bt?w_:Nt);Se(d.text,qe,Ae);const er=rn.text.isHidden();var yt;[Oe.rightJustifiedTextSymbolIndex,Oe.centerJustifiedTextSymbolIndex,Oe.leftJustifiedTextSymbolIndex].forEach(ur=>{0<=ur&&(d.text.placedSymbolArray.get(ur).hidden=er||mn?1:0)}),0<=Oe.verticalPlacedTextSymbolIndex&&(d.text.placedSymbolArray.get(Oe.verticalPlacedTextSymbolIndex).hidden=er||bt?1:0),(yt=this.variableOffsets[Oe.crossTileID])&&this.markUsedJustification(d,yt.anchor,Oe,_t),(Nt=this.placedOrientations[Oe.crossTileID])&&(this.markUsedJustification(d,"left",Oe,Nt),this.markUsedOrientation(d,Nt,Oe))}if(Ye&&(qe=wo(rn.icon),Ae=!(he&&Oe.verticalPlacedIconSymbolIndex&&mn),0<=Oe.placedIconSymbolIndex&&(Se(d.icon,Oe.numIconVertices,yt=Ae?qe:w_),d.icon.placedSymbolArray.get(Oe.placedIconSymbolIndex).hidden=rn.icon.isHidden()),0<=Oe.verticalPlacedIconSymbolIndex)&&(Se(d.icon,Oe.numVerticalIconVertices,_t=Ae?w_:qe),d.icon.placedSymbolArray.get(Oe.verticalPlacedIconSymbolIndex).hidden=rn.icon.isHidden()),(d.hasIconCollisionBoxData()||d.hasTextCollisionBoxData())&&(Nt=d.collisionArrays[At])){let Fn=new h.Point(0,0);if(Nt.textBox||Nt.verticalTextBox){let er=!0;re&&((Ye=this.variableOffsets[Ge])?(Fn=rr(Ye.anchor,Ye.width,Ye.height,Ye.textOffset,Ye.textBoxScale),ce&&Fn._rotate(ee?this.transform.angle:-this.transform.angle)):er=!1),Nt.textBox&&da(d.textCollisionBox.collisionVertexArray,rn.text.placed,!er||mn,Fn.x,Fn.y),Nt.verticalTextBox&&da(d.textCollisionBox.collisionVertexArray,rn.text.placed,!er||bt,Fn.x,Fn.y)}Ae=!(bt||!Nt.verticalIconBox),Nt.iconBox&&da(d.iconCollisionBox.collisionVertexArray,rn.icon.placed,Ae,he?Fn.x:0,he?Fn.y:0),Nt.verticalIconBox&&da(d.iconCollisionBox.collisionVertexArray,rn.icon.placed,!Ae,he?Fn.x:0,he?Fn.y:0)}}if(d.sortFeatures(this.transform.angle),this.retainedQueryData[d.bucketInstanceId]&&(this.retainedQueryData[d.bucketInstanceId].featureSortOrder=d.featureSortOrder),d.hasTextData()&&d.text.opacityVertexBuffer&&d.text.opacityVertexBuffer.updateData(d.text.opacityVertexArray),d.hasIconData()&&d.icon.opacityVertexBuffer&&d.icon.opacityVertexBuffer.updateData(d.icon.opacityVertexArray),d.hasIconCollisionBoxData()&&d.iconCollisionBox.collisionVertexBuffer&&d.iconCollisionBox.collisionVertexBuffer.updateData(d.iconCollisionBox.collisionVertexArray),d.hasTextCollisionBoxData()&&d.textCollisionBox.collisionVertexBuffer&&d.textCollisionBox.collisionVertexBuffer.updateData(d.textCollisionBox.collisionVertexArray),d.text.opacityVertexArray.length!==d.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${d.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${d.text.layoutVertexArray.length}) / 4`);if(d.icon.opacityVertexArray.length!==d.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${d.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${d.icon.layoutVertexArray.length}) / 4`);d.bucketInstanceId in this.collisionCircleArrays&&(d.placementInvProjMatrix=(C=this.collisionCircleArrays[d.bucketInstanceId]).invProjMatrix,d.placementViewportMatrix=C.viewportMatrix,d.collisionCircleArray=C.circles,delete this.collisionCircleArrays[d.bucketInstanceId])}symbolFadeChange(d){return 0===this.fadeDuration?1:(d-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(d){return Math.max(0,(this.transform.zoom-d)/1.5)}hasTransitions(d){return this.stale||d-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(d,_){var x=this.zoomAtLastRecencyCheck===_?1-this.zoomAdjustment(_):1;return this.zoomAtLastRecencyCheck=_,this.commitTime+this.fadeDuration*x>d}setStale(){this.stale=!0}}function da(A,d,_,x,C){A.emplaceBack(d?1:0,_?1:0,x||0,C||0),A.emplaceBack(d?1:0,_?1:0,x||0,C||0),A.emplaceBack(d?1:0,_?1:0,x||0,C||0),A.emplaceBack(d?1:0,_?1:0,x||0,C||0)}const Dc=Math.pow(2,25),Ua=Math.pow(2,24),Pc=Math.pow(2,17),uD=Math.pow(2,16),pw=Math.pow(2,9),g5=Math.pow(2,8),G7=Math.pow(2,1);function wo(A){var d;return 0!==A.opacity||A.placed?1===A.opacity&&A.placed?4294967295:(d=A.placed?1:0,(A=Math.floor(127*A.opacity))*Dc+d*Ua+A*Pc+d*uD+A*pw+d*g5+A*G7+d):0}const w_=0;class nT{constructor(d){this._sortAcrossTiles="viewport-y"!==d.layout.get("symbol-z-order")&&!d.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(d,_,x,C,M){for(var B=this._bucketParts;this._currentTileIndex<d.length;)if(_.getBucketParts(B,C,d[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,M())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,B.sort((re,ce)=>re.sortKey-ce.sortKey));this._currentPartIndex<B.length;)if(_.placeLayerBucketPart(B[this._currentPartIndex],this._seenCrossTileIDs,x),this._currentPartIndex++,M())return!0;return!1}}class Ku{constructor(d,_,x,C,M,B,U,K){this.placement=new js(d,_,B,U,K),this._currentPlacementIndex=x.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=M,this._done=!1}isDone(){return this._done}continuePlacement(d,_,x){const C=P.now();for(var M=()=>!this._forceFullPlacement&&2<P.now()-C;0<=this._currentPlacementIndex;){var B=_[d[this._currentPlacementIndex]],U=this.placement.collisionIndex.transform.zoom;if("symbol"===B.type&&(!B.minzoom||B.minzoom<=U)&&(!B.maxzoom||B.maxzoom>U)){if(this._inProgressLayer||(this._inProgressLayer=new nT(B)),this._inProgressLayer.continuePlacement(x[B.source],this.placement,this._showCollisionBoxes,B,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(d){return this.placement.commit(d),this.placement}}const sl=512/h.EXTENT/2;class FN{constructor(d,_,x){this.tileID=d,this.bucketInstanceId=x,this._symbolsByKey={};var C,M,B=new Map;for(let Se=0;Se<_.length;Se++){var U=_.get(Se),K=U.key,re=B.get(K);re?re.push(U):B.set(K,[U])}for([C,M]of B){var ce={positions:M.map(Se=>({x:Math.floor(Se.anchorX*sl),y:Math.floor(Se.anchorY*sl)})),crossTileIDs:M.map(Se=>Se.crossTileID)};if(128<ce.positions.length){var ee,he,Ee=new h.KDBush(ce.positions.length,16,Uint16Array);for({x:ee,y:he}of ce.positions)Ee.add(ee,he);Ee.finish(),delete ce.positions,ce.index=Ee}this._symbolsByKey[C]=ce}}getScaledCoordinates(re,U){var{x,y:C,z:M}=this.tileID.canonical,{x:U,y:K,z:B}=U.canonical,M=(B-=M,sl/Math.pow(2,B)),B=(U*h.EXTENT+re.anchorX)*M,K=(U=(K*h.EXTENT+re.anchorY)*M,x*h.EXTENT*sl);return re=C*h.EXTENT*sl,{x:Math.floor(B-K),y:Math.floor(U-re)}}findMatches(d,_,x){var C=this.tileID.canonical.z<_.canonical.z?1:Math.pow(2,this.tileID.canonical.z-_.canonical.z);for(let ee=0;ee<d.length;ee++){var M=d.get(ee);if(!M.crossTileID){var B=this._symbolsByKey[M.key];if(B){var U=this.getScaledCoordinates(M,_);if(B.index)for(const he of B.index.range(U.x-C,U.y-C,U.x+C,U.y+C).sort()){var K=B.crossTileIDs[he];if(!x[K]){x[K]=!0,M.crossTileID=K;break}}else if(B.positions)for(let he=0;he<B.positions.length;he++){var re=B.positions[he],ce=B.crossTileIDs[he];if(Math.abs(re.x-U.x)<=C&&Math.abs(re.y-U.y)<=C&&!x[ce]){x[ce]=!0,M.crossTileID=ce;break}}}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:d})=>d)}}class Ph{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class lc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(d){var _=Math.round((d-this.lng)/360);if(0!==_)for(const B in this.indexes){var x=this.indexes[B],C={};for(const U in x){var M=x[U];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+_),C[M.tileID.key]=M}this.indexes[B]=C}this.lng=d}addBucket(d,_,x){if(this.indexes[d.overscaledZ]&&this.indexes[d.overscaledZ][d.key]){if(this.indexes[d.overscaledZ][d.key].bucketInstanceId===_.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(d.overscaledZ,this.indexes[d.overscaledZ][d.key])}for(let re=0;re<_.symbolInstances.length;re++)_.symbolInstances.get(re).crossTileID=0;this.usedCrossTileIDs[d.overscaledZ]||(this.usedCrossTileIDs[d.overscaledZ]={});var C=this.usedCrossTileIDs[d.overscaledZ];for(const re in this.indexes){var M=this.indexes[re];if(Number(re)>d.overscaledZ)for(const ce in M){var B=M[ce];B.tileID.isChildOf(d)&&B.findMatches(_.symbolInstances,d,C)}else{var U=M[d.scaledTo(Number(re)).key];U&&U.findMatches(_.symbolInstances,d,C)}}for(let re=0;re<_.symbolInstances.length;re++){var K=_.symbolInstances.get(re);K.crossTileID||(K.crossTileID=x.generate(),C[K.crossTileID]=!0)}return void 0===this.indexes[d.overscaledZ]&&(this.indexes[d.overscaledZ]={}),this.indexes[d.overscaledZ][d.key]=new FN(d,_.symbolInstances,_.bucketInstanceId),!0}removeBucketCrossTileIDs(d,_){for(const x of _.getCrossTileIDsLists())for(const C of x)delete this.usedCrossTileIDs[d][C]}removeStaleBuckets(d){let _=!1;for(const C in this.indexes){var x=this.indexes[C];for(const M in x)d[x[M].bucketInstanceId]||(this.removeBucketCrossTileIDs(C,x[M]),delete x[M],_=!0)}return _}}class hD{constructor(){this.layerIndexes={},this.crossTileIDs=new Ph,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(d,_,x){let C=this.layerIndexes[d.id],M=!1;var B={};(C=void 0===C?this.layerIndexes[d.id]=new lc:C).handleWrapJump(x);for(const K of _){var U=K.getBucket(d);U&&d.id===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(K.tileID,U,this.crossTileIDs)&&(M=!0),B[U.bucketInstanceId]=!0)}return!!C.removeStaleBuckets(B)||M}pruneUnusedLayers(d){const _={};d.forEach(x=>{_[x]=!0});for(const x in this.layerIndexes)_[x]||delete this.layerIndexes[x]}}const vd=(A,d)=>h.emitValidationErrors(A,d&&d.filter(_=>"source.canvas"!==_.identifier)),Zi=h.emptyStyle();class Ia extends h.Evented{constructor(d,_={}){super(),this._rtlPluginLoaded=()=>{for(const C in this.sourceCaches){var x=this.sourceCaches[C].getSource().type;"vector"!==x&&"geojson"!==x||this.sourceCaches[C].reload()}},this.map=d,this.dispatcher=new Qn(pi(),d._getMapId()),this.dispatcher.registerMessageHandler("GG",(x,C)=>this.getGlyphs(x,C)),this.dispatcher.registerMessageHandler("GI",(x,C)=>this.getImages(x,C)),this.imageManager=new Et,this.imageManager.setEventedParent(this),this.glyphManager=new It(d._requestManager,_.localIdeographFontFamily),this.lineAtlas=new on(256,512),this.crossTileSymbolIndex=new hD,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",h.getReferrer()),en().on(Pe,this._rtlPluginLoaded),this.on("data",x=>{if("source"===x.dataType&&"metadata"===x.sourceDataType&&(x=this.sourceCaches[x.sourceId])){var C=x.getSource();if(C&&C.vectorLayerIds)for(const B in this._layers){var M=this._layers[B];M.source===C.id&&this._validateLayer(M)}}})}loadURL(d,_={},x){this.fire(new h.Event("dataloading",{dataType:"style"})),_.validate="boolean"!=typeof _.validate||_.validate,d=this.map._requestManager.transformRequest(d,"Style"),this._loadStyleRequest=new AbortController,h.getJSON(d,this._loadStyleRequest).then(C=>{this._loadStyleRequest=null,this._load(C.data,_,x)}).catch(C=>{this._loadStyleRequest=null,C&&this.fire(new h.ErrorEvent(C))})}loadJSON(d,_={},x){this.fire(new h.Event("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,P.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,_.validate=!1!==_.validate,this._load(d,_,x)}).catch(()=>{})}loadEmpty(){this.fire(new h.Event("dataloading",{dataType:"style"})),this._load(Zi,{validate:!1})}_load(d,_,x){var C=_.transformStyle?_.transformStyle(x,d):d;if(!_.validate||!vd(this,h.validateStyle(C))){this._loaded=!0;for(const M in(this.stylesheet=C).sources)this.addSource(M,C.sources[M],{validate:!1});C.sprite?this._loadSprite(C.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(C.glyphs),this._createLayers(),this.light=new We(this.stylesheet.light),this.map.setTerrain(null!=(x=this.stylesheet.terrain)?x:null),this.fire(new h.Event("data",{dataType:"style"})),this.fire(new h.Event("style.load"))}}_createLayers(){var d=h.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("SL",d),this._order=d.map(x=>x.id),this._layers={},this._serializedLayers=null;for(const x of d){var _=h.createStyleLayer(x);_.setEventedParent(this,{layer:{id:x.id}}),this._layers[x.id]=_}}_loadSprite(d,_=!1,x=void 0){let C;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function Je(A,d,_,x){return h.__awaiter(this,void 0,void 0,function*(){var C,M,B=Le(A),U=1<_?"@2x":"",K={},re={};for({id:C,url:M}of B){var ce=d.transformRequest(d.normalizeSpriteURL(M,U,".json"),"SpriteJSON");K[C]=h.getJSON(ce,x),ce=d.transformRequest(d.normalizeSpriteURL(M,U,".png"),"SpriteImage"),re[C]=g.getImage(ce,x)}return yield Promise.all([...Object.values(K),...Object.values(re)]),function(ee,he){return h.__awaiter(this,void 0,void 0,function*(){var Ee={};for(const mn in ee){Ee[mn]={};var Se=P.getImageCanvasContext((yield he[mn]).data),Oe=(yield ee[mn]).data;for(const Fn in Oe){var{width:Ae,height:qe,x:Ge,y:Ye,sdf:_t,pixelRatio:bt,stretchX:yt,stretchY:Nt,content:At,contentMatch:rn}=Oe[Fn];Ee[mn][Fn]={data:null,pixelRatio:bt,sdf:_t,stretchX:yt,stretchY:Nt,content:At,spriteData:{width:Ae,height:qe,x:Ge,y:Ye,context:Se},contentMatch:rn}}}return Ee})}(K,re)})}(d,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(M=>{if(this._spriteRequest=null,M)for(const U in M){this._spritesImagesIds[U]=[];for(const K of this._spritesImagesIds[U]?this._spritesImagesIds[U].filter(re=>!(re in M)):[])this.imageManager.removeImage(K),this._changedImages[K]=!0;for(const K in M[U]){var B="default"===U?K:U+":"+K;this._spritesImagesIds[U].push(B),B in this.imageManager.images?this.imageManager.updateImage(B,M[U][K],!1):this.imageManager.addImage(B,M[U][K]),_&&(this._changedImages[B]=!0)}}}).catch(M=>{this._spriteRequest=null,C=M,this.fire(new h.ErrorEvent(C))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),_&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.Event("data",{dataType:"style"})),x&&x(C)})}_unloadSprite(){for(const d of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(d),this._changedImages[d]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))}_validateLayer(d){var _,x=this.sourceCaches[d.source];x&&(_=d.sourceLayer)&&("geojson"===(x=x.getSource()).type||x.vectorLayerIds&&-1===x.vectorLayerIds.indexOf(_))&&this.fire(new h.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${x.id}" as specified by style layer "${d.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const d in this.sourceCaches)if(!this.sourceCaches[d].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(d){var _=this._serializedAllLayers();if(!d||0===d.length)return Object.values(_);var x=[];for(const C of d)_[C]&&x.push(_[C]);return x}_serializedAllLayers(){var d=this._serializedLayers;if(!d){d=this._serializedLayers={};for(const x of Object.keys(this._layers)){var _=this._layers[x];"custom"!==_.type&&(d[x]=_.serialize())}}return d}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const d in this.sourceCaches)if(this.sourceCaches[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(d){if(this._loaded){var _=this._changed;if(this._changed){var x=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);(x.length||C.length)&&this._updateWorkerLayers(x,C);for(const ce in this._updatedSources){var M=this._updatedSources[ce];if("reload"===M)this._reloadSource(ce);else{if("clear"!==M)throw new Error("Invalid action "+M);this._clearSource(ce)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const ce in this._updatedPaintProps)this._layers[ce].updateTransitions(d);this.light.updateTransitions(d),this._resetUpdates()}var B={};for(const ce in this.sourceCaches){var U=this.sourceCaches[ce];B[ce]=U.used,U.used=!1}for(const ce of this._order){var K=this._layers[ce];K.recalculate(d,this._availableImages),!K.isHidden(d.zoom)&&K.source&&(this.sourceCaches[K.source].used=!0)}for(const ce in B){var re=this.sourceCaches[ce];B[ce]!==re.used&&re.fire(new h.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ce}))}this.light.recalculate(d),this.z=d.zoom,_&&this.fire(new h.Event("data",{dataType:"style"}))}}_updateTilesForChangedImages(){var d=Object.keys(this._changedImages);if(d.length){for(const _ in this.sourceCaches)this.sourceCaches[_].reloadTilesForDependencies(["icons","patterns"],d);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(d,_){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(d),removedIds:_})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(d,C={}){this._checkLoaded();var x=this.serialize();if(d=C.transformStyle?C.transformStyle(x,d):d,(C=null==(C=C.validate)||C)&&vd(this,h.validateStyle(d)))return!1;if((d=h.clone$1(d)).layers=h.derefLayers(d.layers),C=h.diffStyles(x,d),0<(x=this._getOperationsToPerform(C)).unimplemented.length)throw new Error(`Unimplemented: ${x.unimplemented.join(", ")}.`);if(0===x.operations.length)return!1;for(const M of x.operations)M();return this.stylesheet=d,!(this._serializedLayers=null)}_getOperationsToPerform(d){var _=[],x=[];for(const C of d)switch(C.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":_.push(()=>this.addLayer.apply(this,C.args));break;case"removeLayer":_.push(()=>this.removeLayer.apply(this,C.args));break;case"setPaintProperty":_.push(()=>this.setPaintProperty.apply(this,C.args));break;case"setLayoutProperty":_.push(()=>this.setLayoutProperty.apply(this,C.args));break;case"setFilter":_.push(()=>this.setFilter.apply(this,C.args));break;case"addSource":_.push(()=>this.addSource.apply(this,C.args));break;case"removeSource":_.push(()=>this.removeSource.apply(this,C.args));break;case"setLayerZoomRange":_.push(()=>this.setLayerZoomRange.apply(this,C.args));break;case"setLight":_.push(()=>this.setLight.apply(this,C.args));break;case"setGeoJSONSourceData":_.push(()=>this.setGeoJSONSourceData.apply(this,C.args));break;case"setGlyphs":_.push(()=>this.setGlyphs.apply(this,C.args));break;case"setSprite":_.push(()=>this.setSprite.apply(this,C.args));break;case"setTerrain":_.push(()=>this.map.setTerrain.apply(this,C.args));break;case"setTransition":_.push(()=>{});break;default:x.push(C.command)}return{operations:_,unimplemented:x}}addImage(d,_){if(this.getImage(d))return this.fire(new h.ErrorEvent(new Error(`An image named "${d}" already exists.`)));this.imageManager.addImage(d,_),this._afterImageUpdated(d)}updateImage(d,_){this.imageManager.updateImage(d,_)}getImage(d){return this.imageManager.getImage(d)}removeImage(d){if(!this.getImage(d))return this.fire(new h.ErrorEvent(new Error(`An image named "${d}" does not exist.`)));this.imageManager.removeImage(d),this._afterImageUpdated(d)}_afterImageUpdated(d){this._availableImages=this.imageManager.listImages(),this._changedImages[d]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(d,_,x={}){if(this._checkLoaded(),void 0!==this.sourceCaches[d])throw new Error(`Source "${d}" already exists.`);if(!_.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(_).join(", ")}.`);if(!(0<=["vector","raster","geojson","video","image"].indexOf(_.type)&&this._validate(h.validateStyle.source,"sources."+d,_,null,x))){this.map&&this.map._collectResourceTiming&&(_.collectResourceTiming=!0);const M=this.sourceCaches[d]=new qt(d,_,this.dispatcher);M.style=this,M.setEventedParent(this,()=>({isSourceLoaded:M.loaded(),source:M.serialize(),sourceId:d})),M.onAdd(this.map),this._changed=!0}}removeSource(d){if(this._checkLoaded(),void 0===this.sourceCaches[d])throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===d)return this.fire(new h.ErrorEvent(new Error(`Source "${d}" cannot be removed while layer "${x}" is using it.`)));var _=this.sourceCaches[d];delete this.sourceCaches[d],delete this._updatedSources[d],_.fire(new h.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:d})),_.setEventedParent(null),_.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(d,_){if(this._checkLoaded(),void 0===this.sourceCaches[d])throw new Error("There is no source with this ID="+d);if("geojson"!==(d=this.sourceCaches[d].getSource()).type)throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(_),this._changed=!0}getSource(d){return this.sourceCaches[d]&&this.sourceCaches[d].getSource()}addLayer(d,_,x={}){this._checkLoaded();var C=d.id;if(this.getLayer(C))this.fire(new h.ErrorEvent(new Error(`Layer "${C}" already exists on this map.`)));else{let M;if("custom"===d.type){if(vd(this,h.validateCustomStyleLayer(d)))return;M=h.createStyleLayer(d)}else{if("source"in d&&"object"==typeof d.source&&(this.addSource(C,d.source),d=h.clone$1(d),d=h.extend(d,{source:C})),this._validate(h.validateStyle.layer,"layers."+C,d,{arrayIndex:-1},x))return;M=h.createStyleLayer(d),this._validateLayer(M),M.setEventedParent(this,{layer:{id:C}})}x=_?this._order.indexOf(_):this._order.length,_&&-1===x?this.fire(new h.ErrorEvent(new Error(`Cannot add layer "${C}" before non-existing layer "${_}".`))):(this._order.splice(x,0,C),this._layerOrderChanged=!0,this._layers[C]=M,this._removedLayers[C]&&M.source&&"custom"!==M.type&&(d=this._removedLayers[C],delete this._removedLayers[C],d.type!==M.type?this._updatedSources[M.source]="clear":(this._updatedSources[M.source]="reload",this.sourceCaches[M.source].pause())),this._updateLayer(M),M.onAdd&&M.onAdd(this.map))}}moveLayer(d,_){var x;this._checkLoaded(),this._changed=!0,this._layers[d]?d!==_&&(x=this._order.indexOf(d),this._order.splice(x,1),x=_?this._order.indexOf(_):this._order.length,_&&-1===x?this.fire(new h.ErrorEvent(new Error(`Cannot move layer "${d}" before non-existing layer "${_}".`))):(this._order.splice(x,0,d),this._layerOrderChanged=!0)):this.fire(new h.ErrorEvent(new Error(`The layer '${d}' does not exist in the map's style and cannot be moved.`)))}removeLayer(d){this._checkLoaded();var _,x=this._layers[d];x?(x.setEventedParent(null),_=this._order.indexOf(d),this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[d]=x,delete this._layers[d],this._serializedLayers&&delete this._serializedLayers[d],delete this._updatedLayers[d],delete this._updatedPaintProps[d],x.onRemove&&x.onRemove(this.map)):this.fire(new h.ErrorEvent(new Error(`Cannot remove non-existing layer "${d}".`)))}getLayer(d){return this._layers[d]}getLayersOrder(){return[...this._order]}hasLayer(d){return d in this._layers}setLayerZoomRange(d,_,x){this._checkLoaded();var C=this.getLayer(d);C?C.minzoom===_&&C.maxzoom===x||(null!=_&&(C.minzoom=_),null!=x&&(C.maxzoom=x),this._updateLayer(C)):this.fire(new h.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${d}".`)))}setFilter(d,_,x={}){this._checkLoaded();var C=this.getLayer(d);C?h.deepEqual(C.filter,_)||(null==_?(C.filter=void 0,this._updateLayer(C)):this._validate(h.validateStyle.filter,`layers.${C.id}.filter`,_,null,x)||(C.filter=h.clone$1(_),this._updateLayer(C))):this.fire(new h.ErrorEvent(new Error(`Cannot filter non-existing layer "${d}".`)))}getFilter(d){return h.clone$1(this.getLayer(d).filter)}setLayoutProperty(d,_,x,C={}){this._checkLoaded();var M=this.getLayer(d);M?h.deepEqual(M.getLayoutProperty(_),x)||(M.setLayoutProperty(_,x,C),this._updateLayer(M)):this.fire(new h.ErrorEvent(new Error(`Cannot style non-existing layer "${d}".`)))}getLayoutProperty(d,_){var x=this.getLayer(d);if(x)return x.getLayoutProperty(_);this.fire(new h.ErrorEvent(new Error(`Cannot get style of non-existing layer "${d}".`)))}setPaintProperty(d,_,x,C={}){this._checkLoaded();var M=this.getLayer(d);M?h.deepEqual(M.getPaintProperty(_),x)||(M.setPaintProperty(_,x,C)&&this._updateLayer(M),this._changed=!0,this._updatedPaintProps[d]=!0):this.fire(new h.ErrorEvent(new Error(`Cannot style non-existing layer "${d}".`)))}getPaintProperty(d,_){return this.getLayer(d).getPaintProperty(_)}setFeatureState(d,_){this._checkLoaded();var x=d.source,C=d.sourceLayer,M=this.sourceCaches[x];void 0===M?this.fire(new h.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`))):"geojson"===(x=M.getSource().type)&&C?this.fire(new h.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==x||C?(void 0===d.id&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),M.setFeatureState(C,d.id,_)):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(d,_){this._checkLoaded();var x,C=d.source,M=this.sourceCaches[C];void 0===M?this.fire(new h.ErrorEvent(new Error(`The source '${C}' does not exist in the map's style.`))):(x="vector"===(C=M.getSource().type)?d.sourceLayer:void 0,"vector"!==C||x?_&&"string"!=typeof d.id&&"number"!=typeof d.id?this.fire(new h.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):M.removeFeatureState(x,d.id,_):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types."))))}getFeatureState(d){this._checkLoaded();var _=d.source,x=d.sourceLayer,C=this.sourceCaches[_];if(void 0===C)this.fire(new h.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));else{if("vector"!==C.getSource().type||x)return void 0===d.id&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),C.getFeatureState(x,d.id);this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}}getTransition(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){var d,_,x,C;if(this._loaded)return d=h.mapObject(this.sourceCaches,M=>M.serialize()),_=this._serializeByIds(this._order),x=this.map.getTerrain()||void 0,h.filterObject({version:(C=this.stylesheet).version,name:C.name,metadata:C.metadata,light:C.light,center:C.center,zoom:C.zoom,bearing:C.bearing,pitch:C.pitch,sprite:C.sprite,glyphs:C.glyphs,transition:C.transition,sources:d,layers:_,terrain:x},M=>void 0!==M)}_updateLayer(d){this._updatedLayers[d.id]=!0,d.source&&!this._updatedSources[d.source]&&"raster"!==this.sourceCaches[d.source].getSource().type&&(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(d){var _=ee=>"fill-extrusion"===this._layers[ee].type,x={},C=[];for(let ee=this._order.length-1;0<=ee;ee--){var M=this._order[ee];if(_(M)){x[M]=ee;for(const he of d){var B=he[M];if(B)for(const Ee of B)C.push(Ee)}}}C.sort((ee,he)=>he.intersectionZ-ee.intersectionZ);var U=[];for(let ee=this._order.length-1;0<=ee;ee--){var K=this._order[ee];if(_(K))for(let he=C.length-1;0<=he;he--){var re=C[he].feature;if(x[re.layer.id]<ee)break;U.push(re),C.pop()}else for(const he of d){var ce=he[K];if(ce)for(const Ee of ce)U.push(Ee.feature)}}return U}queryRenderedFeatures(d,_,x){_&&_.filter&&this._validate(h.validateStyle.filter,"queryRenderedFeatures.filter",_.filter,null,_);var C={};if(_&&_.layers){if(!Array.isArray(_.layers))return this.fire(new h.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const K of _.layers){var M=this._layers[K];if(!M)return this.fire(new h.ErrorEvent(new Error(`The layer '${K}' does not exist in the map's style and cannot be queried for features.`))),[];C[M.source]=!0}}var B=[],U=(_.availableImages=this._availableImages,this._serializedAllLayers());for(const K in this.sourceCaches)_.layers&&!C[K]||B.push(zn(this.sourceCaches[K],this._layers,U,d,_,x));return this.placement&&B.push(function Fr(A,d,_,x,C,M,B){var U={},K=M.queryRenderedSymbols(x),re=[];for(const Ee of Object.keys(K).map(Number))re.push(B[Ee]);re.sort(Ao);for(const Ee of re){var ce=Ee.featureIndex.lookupSymbolFeatures(K[Ee.bucketInstanceId],d,Ee.bucketIndex,Ee.sourceLayerIndex,C.filter,C.layers,C.availableImages,A);for(const Se in ce){var ee=U[Se]=U[Se]||[],he=ce[Se];he.sort((Oe,Ae)=>{var qe,Ge=Ee.featureSortOrder;return Ge?(qe=Ge.indexOf(Oe.featureIndex),Ge.indexOf(Ae.featureIndex)-qe):Ae.featureIndex-Oe.featureIndex});for(const Oe of he)ee.push(Oe)}}for(const Ee in U)U[Ee].forEach(Oe=>{var Ae=_[(Ae=A[Ee]).source].getFeatureState((Oe=Oe.feature).layer["source-layer"],Oe.id);Oe.source=Oe.layer.source,Oe.layer["source-layer"]&&(Oe.sourceLayer=Oe.layer["source-layer"]),Oe.state=Ae});return U}(this._layers,U,this.sourceCaches,d,_,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(B)}querySourceFeatures(d,_){return _&&_.filter&&this._validate(h.validateStyle.filter,"querySourceFeatures.filter",_.filter,null,_),(d=this.sourceCaches[d])?function So(A,d){var _=A.getRenderableIds().map(U=>A.getTileByID(U)),x=[],C={};for(let U=0;U<_.length;U++){var M=_[U],B=M.tileID.canonical.key;C[B]||(C[B]=!0,M.querySourceFeatures(x,d))}return x}(d,_):[]}getLight(){return this.light.getLight()}setLight(d,_={}){this._checkLoaded();var x,C=this.light.getLight();let M=!1;for(const B in d)if(!h.deepEqual(d[B],C[B])){M=!0;break}M&&(x={now:P.now(),transition:h.extend({duration:300,delay:0},this.stylesheet.transition)},this.light.setLight(d,_),this.light.updateTransitions(x))}_validate(d,_,x,C,M={}){return(!M||!1!==M.validate)&&vd(this,d.call(h.validateStyle,h.extend({key:_,style:this.serialize(),value:x,styleSpec:h.v8Spec},C)))}_remove(d=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),en().off(Pe,this._rtlPluginLoaded);for(const x in this._layers)this._layers[x].setEventedParent(null);for(const x in this.sourceCaches){var _=this.sourceCaches[x];_.setEventedParent(null),_.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),d&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(d)}_clearSource(d){this.sourceCaches[d].clearTiles()}_reloadSource(d){this.sourceCaches[d].resume(),this.sourceCaches[d].reload()}_updateSources(d){for(const _ in this.sourceCaches)this.sourceCaches[_].update(d,this.map.terrain)}_generateCollisionBoxes(){for(const d in this.sourceCaches)this._reloadSource(d)}_updatePlacement(d,_,x,C,M=!1){let B=!1,U=!1;var K={};for(const ee of this._order){var re=this._layers[ee];if("symbol"===re.type){if(!K[re.source]){const he=this.sourceCaches[re.source];K[re.source]=he.getRenderableIds(!0).map(Ee=>he.getTileByID(Ee)).sort((Ee,Se)=>Se.tileID.overscaledZ-Ee.tileID.overscaledZ||(Ee.tileID.isLessThan(Se.tileID)?-1:1))}re=this.crossTileSymbolIndex.addLayer(re,K[re.source],d.center.lng),B=B||re}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((M=M||this._layerOrderChanged||0===x)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(P.now(),d.zoom))&&(this.pauseablePlacement=new Ku(d,this.map.terrain,this._order,M,_,x,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,K),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(P.now()),U=!0),B&&this.pauseablePlacement.placement.setStale()),U||B)for(const ee of this._order){var ce=this._layers[ee];"symbol"===ce.type&&this.placement.updateLayerOpacities(ce,K[ce.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(P.now())}_releaseSymbolFadeTiles(){for(const d in this.sourceCaches)this.sourceCaches[d].releaseSymbolFadeTiles()}getImages(d,_){return h.__awaiter(this,void 0,void 0,function*(){var x=yield this.imageManager.getImages(_.icons),C=(this._updateTilesForChangedImages(),this.sourceCaches[_.source]);return C&&C.setDependencies(_.tileID.key,_.type,_.icons),x})}getGlyphs(d,_){return h.__awaiter(this,void 0,void 0,function*(){var x=yield this.glyphManager.getGlyphs(_.stacks),C=this.sourceCaches[_.source];return C&&C.setDependencies(_.tileID.key,_.type,[""]),x})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(d,_={}){this._checkLoaded(),d&&this._validate(h.validateStyle.glyphs,"glyphs",d,null,_)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=d,this.glyphManager.entries={},this.glyphManager.setURL(d))}addSprite(d,_,x={},C){this._checkLoaded(),d=[{id:d,url:_}],_=[...Le(this.stylesheet.sprite),...d],this._validate(h.validateStyle.sprite,"sprite",_,null,x)||(this.stylesheet.sprite=_,this._loadSprite(d,!0,C))}removeSprite(d){this._checkLoaded();var _=Le(this.stylesheet.sprite);if(_.find(x=>x.id===d)){if(this._spritesImagesIds[d])for(const x of this._spritesImagesIds[d])this.imageManager.removeImage(x),this._changedImages[x]=!0;_.splice(_.findIndex(x=>x.id===d),1),this.stylesheet.sprite=0<_.length?_:void 0,delete this._spritesImagesIds[d],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))}else this.fire(new h.ErrorEvent(new Error(`Sprite "${d}" doesn't exists on this map.`)))}getSprite(){return Le(this.stylesheet.sprite)}setSprite(d,_={},x){this._checkLoaded(),d&&this._validate(h.validateStyle.sprite,"sprite",d,null,_)||((this.stylesheet.sprite=d)?this._loadSprite(d,!0,x):(this._unloadSprite(),x&&x(null)))}}var wd=h.createLayout([{name:"a_pos",type:"Int16",components:2}]),fi="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const bd={prelude:Pt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:Pt("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Pt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Pt("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:Pt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Pt("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:Pt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Pt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Pt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Pt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Pt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:Pt("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:Pt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:Pt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:Pt("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:Pt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:Pt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Pt("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Pt("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:Pt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:Pt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:Pt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:Pt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Pt("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:Pt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Pt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:Pt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",fi),terrainDepth:Pt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",fi),terrainCoords:Pt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",fi)};function Pt(A,d){var _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=d.match(/attribute ([\w]+) ([\w]+)/g),C=A.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=(M=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g))?M.concat(C):C;const B={};return{fragmentSource:A=A.replace(_,(U,K,re,ce,ee)=>(B[ee]=!0,"define"===K?`\n#ifndef HAS_UNIFORM_u_${ee}\nvarying ${re} ${ce} ${ee};\n#else\nuniform ${re} ${ce} u_${ee};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${ee}\n    ${re} ${ce} ${ee} = u_${ee};\n#endif\n`)),vertexSource:d=d.replace(_,(U,K,re,ce,ee)=>{var he="float"===ce?"vec2":"vec4",Ee=ee.match(/color/)?"color":he;return B[ee]?"define"===K?`\n#ifndef HAS_UNIFORM_u_${ee}\nuniform lowp float u_${ee}_t;\nattribute ${re} ${he} a_${ee};\nvarying ${re} ${ce} ${ee};\n#else\nuniform ${re} ${ce} u_${ee};\n#endif\n`:"vec4"==Ee?`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${ee} = a_${ee};\n#else\n    ${re} ${ce} ${ee} = u_${ee};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${ee} = unpack_mix_${Ee}(a_${ee}, u_${ee}_t);\n#else\n    ${re} ${ce} ${ee} = u_${ee};\n#endif\n`:"define"===K?`\n#ifndef HAS_UNIFORM_u_${ee}\nuniform lowp float u_${ee}_t;\nattribute ${re} ${he} a_${ee};\n#else\nuniform ${re} ${ce} u_${ee};\n#endif\n`:"vec4"==Ee?`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${re} ${ce} ${ee} = a_${ee};\n#else\n    ${re} ${ce} ${ee} = u_${ee};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${ee}\n    ${re} ${ce} ${ee} = unpack_mix_${Ee}(a_${ee}, u_${ee}_t);\n#else\n    ${re} ${ce} ${ee} = u_${ee};\n#endif\n`}),staticAttributes:x,staticUniforms:M}}class Rh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(d,_,x,C,M,B,U,K,re){this.context=d;let ce=this.boundPaintVertexBuffers.length!==C.length;for(let ee=0;!ce&&ee<C.length;ee++)this.boundPaintVertexBuffers[ee]!==C[ee]&&(ce=!0);!this.vao||this.boundProgram!==_||this.boundLayoutVertexBuffer!==x||ce||this.boundIndexBuffer!==M||this.boundVertexOffset!==B||this.boundDynamicVertexBuffer!==U||this.boundDynamicVertexBuffer2!==K||this.boundDynamicVertexBuffer3!==re?this.freshBind(_,x,C,M,B,U,K,re):(d.bindVertexArray.set(this.vao),U&&U.bind(),M&&M.dynamicDraw&&M.bind(),K&&K.bind(),re&&re.bind())}freshBind(d,_,x,C,M,B,U,K){var re=d.numAttributes,ce=this.context,ee=ce.gl;this.vao&&this.destroy(),this.vao=ce.createVertexArray(),ce.bindVertexArray.set(this.vao),this.boundProgram=d,this.boundLayoutVertexBuffer=_,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=C,this.boundVertexOffset=M,this.boundDynamicVertexBuffer=B,this.boundDynamicVertexBuffer2=U,this.boundDynamicVertexBuffer3=K,_.enableAttributes(ee,d);for(const he of x)he.enableAttributes(ee,d);B&&B.enableAttributes(ee,d),U&&U.enableAttributes(ee,d),K&&K.enableAttributes(ee,d),_.bind(),_.setVertexAttribPointers(ee,d,M);for(const he of x)he.bind(),he.setVertexAttribPointers(ee,d,M);B&&(B.bind(),B.setVertexAttribPointers(ee,d,M)),C&&C.bind(),U&&(U.bind(),U.setVertexAttribPointers(ee,d,M)),K&&(K.bind(),K.setVertexAttribPointers(ee,d,M)),ce.currentNumAttributes=re}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Ig(A){var d,_=[];for(let x=0;x<A.length;x++)null!==A[x]&&(d=A[x].split(" "),_.push(d.pop()));return _}class rT{constructor(d,_,x,C,M,B){var U=d.gl,re=(this.program=U.createProgram(),Ig(_.staticAttributes)),ce=x?x.getBinderAttributes():[],K=re.concat(ce),ee=(re=bd.prelude.staticUniforms?Ig(bd.prelude.staticUniforms):[],ce=_.staticUniforms?Ig(_.staticUniforms):[],x?x.getBinderUniforms():[]),he=[];for(const Ae of re.concat(ce).concat(ee))he.indexOf(Ae)<0&&he.push(Ae);if(re=x?x.defines():[],M&&re.push("#define OVERDRAW_INSPECTOR;"),B&&re.push("#define TERRAIN3D;"),ce=re.concat(bd.prelude.fragmentSource,_.fragmentSource).join("\n"),ee=re.concat(bd.prelude.vertexSource,_.vertexSource).join("\n"),M=U.createShader(U.FRAGMENT_SHADER),U.isContextLost())this.failedToCreate=!0;else{if(U.shaderSource(M,ce),U.compileShader(M),!U.getShaderParameter(M,U.COMPILE_STATUS))throw new Error("Could not compile fragment shader: "+U.getShaderInfoLog(M));if(U.attachShader(this.program,M),B=U.createShader(U.VERTEX_SHADER),U.isContextLost())this.failedToCreate=!0;else{if(U.shaderSource(B,ee),U.compileShader(B),!U.getShaderParameter(B,U.COMPILE_STATUS))throw new Error("Could not compile vertex shader: "+U.getShaderInfoLog(B));U.attachShader(this.program,B),this.attributes={};var Ee={};this.numAttributes=K.length;for(let Ae=0;Ae<this.numAttributes;Ae++)K[Ae]&&(U.bindAttribLocation(this.program,Ae,K[Ae]),this.attributes[K[Ae]]=Ae);if(U.linkProgram(this.program),!U.getProgramParameter(this.program,U.LINK_STATUS))throw new Error("Program failed to link: "+U.getProgramInfoLog(this.program));U.deleteShader(B),U.deleteShader(M);for(let Ae=0;Ae<he.length;Ae++){var Se,Oe=he[Ae];Oe&&!Ee[Oe]&&(Se=U.getUniformLocation(this.program,Oe))&&(Ee[Oe]=Se)}this.fixedUniforms=C(d,Ee),this.terrainUniforms=((A,d)=>({u_depth:new h.Uniform1i(A,d.u_depth),u_terrain:new h.Uniform1i(A,d.u_terrain),u_terrain_dim:new h.Uniform1f(A,d.u_terrain_dim),u_terrain_matrix:new h.UniformMatrix4f(A,d.u_terrain_matrix),u_terrain_unpack:new h.Uniform4f(A,d.u_terrain_unpack),u_terrain_exaggeration:new h.Uniform1f(A,d.u_terrain_exaggeration)}))(d,Ee),this.binderUniforms=x?x.getUniforms(d,Ee):[]}}}draw(d,_,x,C,M,B,U,K,re,ce,ee,he,Ee,Se,Oe,Ae,qe,Ge){var Ye=d.gl;if(!this.failedToCreate){if(d.program.set(this.program),d.setDepthMode(x),d.setStencilMode(C),d.setColorMode(M),d.setCullFace(B),K){d.activeTexture.set(Ye.TEXTURE2),Ye.bindTexture(Ye.TEXTURE_2D,K.depthTexture),d.activeTexture.set(Ye.TEXTURE3),Ye.bindTexture(Ye.TEXTURE_2D,K.texture);for(const yt in this.terrainUniforms)this.terrainUniforms[yt].set(K[yt])}for(const yt in this.fixedUniforms)this.fixedUniforms[yt].set(U[yt]);Oe&&Oe.setUniforms(d,this.binderUniforms,Ee,{zoom:Se});let bt=0;switch(_){case Ye.LINES:bt=2;break;case Ye.TRIANGLES:bt=3;break;case Ye.LINE_STRIP:bt=1}for(const yt of he.get()){var _t=yt.vaos||(yt.vaos={});(_t[re]||(_t[re]=new Rh)).bind(d,this,ce,Oe?Oe.getPaintVertexBuffers():[],ee,yt.vertexOffset,Ae,qe,Ge),Ye.drawElements(_,yt.primitiveLength*bt,Ye.UNSIGNED_SHORT,yt.primitiveOffset*bt*2)}}}}function b_(A,M,_){var x=1/$n(_,1,M.transform.tileZoom),C=Math.pow(2,_.tileID.overscaledZ);return M=_.tileSize*Math.pow(2,M.transform.tileZoom)/C,{u_image:0,u_texsize:_.imageAtlasTexture.size,u_scale:[x,A.fromScale,A.toScale],u_fade:A.t,u_pixel_coord_upper:[(C=M*(_.tileID.canonical.x+_.tileID.wrap*C))>>16,(M*=_.tileID.canonical.y)>>16],u_pixel_coord_lower:[65535&C,65535&M]}}const fw=(A,U,_,x)=>{var C=U.style.light,M=[(M=C.properties.get("position")).x,M.y,M.z],B=h.create$1();return"viewport"===C.properties.get("anchor")&&h.fromRotation(B,-U.transform.angle),h.transformMat3(M,M,B),U=C.properties.get("color"),{u_matrix:A,u_lightpos:M,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[U.r,U.g,U.b],u_vertical_gradient:+_,u_opacity:x}},qf=(A,d,_,x,C,M,B)=>h.extend(fw(A,d,_,x),b_(M,d,B),{u_height_factor:-Math.pow(2,C.overscaledZ)/B.tileSize/8}),Gf=A=>({u_matrix:A}),Sg=(A,d,_,x)=>h.extend(Gf(A),b_(_,d,x)),VN=(A,d)=>({u_matrix:A,u_world:d}),dD=(A,d,_,x,C)=>h.extend(Sg(A,d,_,x),{u_world:C}),BN=(A,d,M)=>{var x=$n(M,1,d.zoom),C=Math.pow(2,d.zoom-M.tileID.overscaledZ);return M=M.tileID.overscaleFactor(),{u_matrix:A,u_camera_to_center_distance:d.cameraToCenterDistance,u_pixels_to_tile_units:x,u_extrude_scale:[d.pixelsToGLUnits[0]/(x*C),d.pixelsToGLUnits[1]/(x*C)],u_overscale_factor:M}},fs=(A,d,_)=>({u_matrix:A,u_inv_matrix:d,u_camera_to_center_distance:_.cameraToCenterDistance,u_viewport_size:[_.width,_.height]}),Go=(A,d,_=1)=>({u_matrix:A,u_color:d,u_overlay:0,u_overlay_scale:_}),E_=A=>({u_matrix:A}),iT=(A,d,_,x)=>{var C=_.paint.get("hillshade-shadow-color"),M=_.paint.get("hillshade-highlight-color"),B=_.paint.get("hillshade-accent-color");let U=_.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===_.paint.get("hillshade-illumination-anchor")&&(U-=A.transform.angle);var K=!A.options.moving;return{u_matrix:x?x.posMatrix:A.transform.calculatePosMatrix(d.tileID.toUnwrapped(),K),u_image:0,u_latrange:(x=d.tileID,A=Math.pow(2,x.canonical.z),x=x.canonical.y,[new h.MercatorCoordinate(0,x/A).toLngLat().lat,new h.MercatorCoordinate(0,(x+1)/A).toLngLat().lat]),u_light:[_.paint.get("hillshade-exaggeration"),U],u_shadow:C,u_highlight:M,u_accent:B}},Ed=(A,d)=>{var _=d.stride,x=h.create();return h.ortho(x,0,h.EXTENT,-h.EXTENT,0,0,1),h.translate(x,x,[0,-h.EXTENT,0]),{u_matrix:x,u_image:1,u_dimension:[_,_],u_zoom:A.overscaledZ,u_unpack:d.getUnpackVector()}},x_=(A,d,_,x)=>{var C=A.transform;return{u_matrix:UN(A,d,_,x),u_ratio:1/$n(d,1,C.zoom),u_device_pixel_ratio:A.pixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}};function fD(A,d){return 1/$n(A,1,d.tileZoom)}function UN(A,d,_,x){return A.translatePosMatrix((x||d.tileID).posMatrix,d,_.paint.get("line-translate"),_.paint.get("line-translate-anchor"))}const Ag=(A,d,_,x,C)=>({u_matrix:A,u_tl_parent:d,u_scale_parent:_,u_buffer_scale:1,u_fade_t:x.mix,u_opacity:x.opacity*C.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:C.paint.get("raster-brightness-min"),u_brightness_high:C.paint.get("raster-brightness-max"),u_saturation_factor:0<(A=C.paint.get("raster-saturation"))?1-1/(1.001-A):-A,u_contrast_factor:0<(d=C.paint.get("raster-contrast"))?1/(1-d):1+d,u_spin_weights:(_=C.paint.get("raster-hue-rotate"),_*=Math.PI/180,x=Math.sin(_),[(2*(_=Math.cos(_))+1)/3,(-Math.sqrt(3)*x-_+1)/3,(Math.sqrt(3)*x-_+1)/3])}),Cp=(A,d,_,x,C,M,B,U,K,re)=>{var ce=C.transform;return{u_is_size_zoom_constant:+("constant"===A||"source"===A),u_is_size_feature_constant:+("constant"===A||"camera"===A),u_size_t:d?d.uSizeT:0,u_size:d?d.uSize:0,u_camera_to_center_distance:ce.cameraToCenterDistance,u_pitch:ce.pitch/360*2*Math.PI,u_rotate_symbol:+_,u_aspect_ratio:ce.width/ce.height,u_fade_change:C.options.fadeDuration?C.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:B,u_coord_matrix:U,u_is_text:+K,u_pitch_with_map:+x,u_texsize:re,u_texture:0}},Rc=(A,d,_,x,C,M,B,U,K,re,ce)=>{var ee=C.transform;return h.extend(Cp(A,d,_,x,C,M,B,U,K,re),{u_gamma_scale:x?Math.cos(ee._pitch)*ee.cameraToCenterDistance:1,u_device_pixel_ratio:C.pixelRatio,u_is_halo:+ce})},zN=(A,d,_,x,C,M,B,U,K,re)=>h.extend(Rc(A,d,_,x,C,M,B,U,!0,K,!0),{u_texsize_icon:re,u_texture_icon:1}),mw=(A,d,_,x,C,M)=>h.extend(function(ee,U,K,re){var ce=K.imageManager.getPattern(ee.from.toString()),{width:he,height:Ee}=(ee=K.imageManager.getPattern(ee.to.toString()),K.imageManager.getPixelSize()),Se=Math.pow(2,re.tileID.overscaledZ),Oe=(Se=(Oe=re.tileSize*Math.pow(2,K.transform.tileZoom)/Se)*(re.tileID.canonical.x+re.tileID.wrap*Se),Oe*re.tileID.canonical.y);return{u_image:0,u_pattern_tl_a:ce.tl,u_pattern_br_a:ce.br,u_pattern_tl_b:ee.tl,u_pattern_br_b:ee.br,u_texsize:[he,Ee],u_mix:U.t,u_pattern_size_a:ce.displaySize,u_pattern_size_b:ee.displaySize,u_scale_a:U.fromScale,u_scale_b:U.toScale,u_tile_units_to_pixels:1/$n(re,1,K.transform.tileZoom),u_pixel_coord_upper:[Se>>16,Oe>>16],u_pixel_coord_lower:[65535&Se,65535&Oe]}}(x,M,_,C),{u_matrix:A,u_opacity:d}),oT={fillExtrusion:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_lightpos:new h.Uniform3f(A,d.u_lightpos),u_lightintensity:new h.Uniform1f(A,d.u_lightintensity),u_lightcolor:new h.Uniform3f(A,d.u_lightcolor),u_vertical_gradient:new h.Uniform1f(A,d.u_vertical_gradient),u_opacity:new h.Uniform1f(A,d.u_opacity)}),fillExtrusionPattern:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_lightpos:new h.Uniform3f(A,d.u_lightpos),u_lightintensity:new h.Uniform1f(A,d.u_lightintensity),u_lightcolor:new h.Uniform3f(A,d.u_lightcolor),u_vertical_gradient:new h.Uniform1f(A,d.u_vertical_gradient),u_height_factor:new h.Uniform1f(A,d.u_height_factor),u_image:new h.Uniform1i(A,d.u_image),u_texsize:new h.Uniform2f(A,d.u_texsize),u_pixel_coord_upper:new h.Uniform2f(A,d.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(A,d.u_pixel_coord_lower),u_scale:new h.Uniform3f(A,d.u_scale),u_fade:new h.Uniform1f(A,d.u_fade),u_opacity:new h.Uniform1f(A,d.u_opacity)}),fill:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix)}),fillPattern:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_image:new h.Uniform1i(A,d.u_image),u_texsize:new h.Uniform2f(A,d.u_texsize),u_pixel_coord_upper:new h.Uniform2f(A,d.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(A,d.u_pixel_coord_lower),u_scale:new h.Uniform3f(A,d.u_scale),u_fade:new h.Uniform1f(A,d.u_fade)}),fillOutline:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_world:new h.Uniform2f(A,d.u_world)}),fillOutlinePattern:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_world:new h.Uniform2f(A,d.u_world),u_image:new h.Uniform1i(A,d.u_image),u_texsize:new h.Uniform2f(A,d.u_texsize),u_pixel_coord_upper:new h.Uniform2f(A,d.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(A,d.u_pixel_coord_lower),u_scale:new h.Uniform3f(A,d.u_scale),u_fade:new h.Uniform1f(A,d.u_fade)}),circle:(A,d)=>({u_camera_to_center_distance:new h.Uniform1f(A,d.u_camera_to_center_distance),u_scale_with_map:new h.Uniform1i(A,d.u_scale_with_map),u_pitch_with_map:new h.Uniform1i(A,d.u_pitch_with_map),u_extrude_scale:new h.Uniform2f(A,d.u_extrude_scale),u_device_pixel_ratio:new h.Uniform1f(A,d.u_device_pixel_ratio),u_matrix:new h.UniformMatrix4f(A,d.u_matrix)}),collisionBox:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_camera_to_center_distance:new h.Uniform1f(A,d.u_camera_to_center_distance),u_pixels_to_tile_units:new h.Uniform1f(A,d.u_pixels_to_tile_units),u_extrude_scale:new h.Uniform2f(A,d.u_extrude_scale),u_overscale_factor:new h.Uniform1f(A,d.u_overscale_factor)}),collisionCircle:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_inv_matrix:new h.UniformMatrix4f(A,d.u_inv_matrix),u_camera_to_center_distance:new h.Uniform1f(A,d.u_camera_to_center_distance),u_viewport_size:new h.Uniform2f(A,d.u_viewport_size)}),debug:(A,d)=>({u_color:new h.UniformColor(A,d.u_color),u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_overlay:new h.Uniform1i(A,d.u_overlay),u_overlay_scale:new h.Uniform1f(A,d.u_overlay_scale)}),clippingMask:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix)}),heatmap:(A,d)=>({u_extrude_scale:new h.Uniform1f(A,d.u_extrude_scale),u_intensity:new h.Uniform1f(A,d.u_intensity),u_matrix:new h.UniformMatrix4f(A,d.u_matrix)}),heatmapTexture:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_world:new h.Uniform2f(A,d.u_world),u_image:new h.Uniform1i(A,d.u_image),u_color_ramp:new h.Uniform1i(A,d.u_color_ramp),u_opacity:new h.Uniform1f(A,d.u_opacity)}),hillshade:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_image:new h.Uniform1i(A,d.u_image),u_latrange:new h.Uniform2f(A,d.u_latrange),u_light:new h.Uniform2f(A,d.u_light),u_shadow:new h.UniformColor(A,d.u_shadow),u_highlight:new h.UniformColor(A,d.u_highlight),u_accent:new h.UniformColor(A,d.u_accent)}),hillshadePrepare:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_image:new h.Uniform1i(A,d.u_image),u_dimension:new h.Uniform2f(A,d.u_dimension),u_zoom:new h.Uniform1f(A,d.u_zoom),u_unpack:new h.Uniform4f(A,d.u_unpack)}),line:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_ratio:new h.Uniform1f(A,d.u_ratio),u_device_pixel_ratio:new h.Uniform1f(A,d.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(A,d.u_units_to_pixels)}),lineGradient:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_ratio:new h.Uniform1f(A,d.u_ratio),u_device_pixel_ratio:new h.Uniform1f(A,d.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(A,d.u_units_to_pixels),u_image:new h.Uniform1i(A,d.u_image),u_image_height:new h.Uniform1f(A,d.u_image_height)}),linePattern:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_texsize:new h.Uniform2f(A,d.u_texsize),u_ratio:new h.Uniform1f(A,d.u_ratio),u_device_pixel_ratio:new h.Uniform1f(A,d.u_device_pixel_ratio),u_image:new h.Uniform1i(A,d.u_image),u_units_to_pixels:new h.Uniform2f(A,d.u_units_to_pixels),u_scale:new h.Uniform3f(A,d.u_scale),u_fade:new h.Uniform1f(A,d.u_fade)}),lineSDF:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_ratio:new h.Uniform1f(A,d.u_ratio),u_device_pixel_ratio:new h.Uniform1f(A,d.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(A,d.u_units_to_pixels),u_patternscale_a:new h.Uniform2f(A,d.u_patternscale_a),u_patternscale_b:new h.Uniform2f(A,d.u_patternscale_b),u_sdfgamma:new h.Uniform1f(A,d.u_sdfgamma),u_image:new h.Uniform1i(A,d.u_image),u_tex_y_a:new h.Uniform1f(A,d.u_tex_y_a),u_tex_y_b:new h.Uniform1f(A,d.u_tex_y_b),u_mix:new h.Uniform1f(A,d.u_mix)}),raster:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_tl_parent:new h.Uniform2f(A,d.u_tl_parent),u_scale_parent:new h.Uniform1f(A,d.u_scale_parent),u_buffer_scale:new h.Uniform1f(A,d.u_buffer_scale),u_fade_t:new h.Uniform1f(A,d.u_fade_t),u_opacity:new h.Uniform1f(A,d.u_opacity),u_image0:new h.Uniform1i(A,d.u_image0),u_image1:new h.Uniform1i(A,d.u_image1),u_brightness_low:new h.Uniform1f(A,d.u_brightness_low),u_brightness_high:new h.Uniform1f(A,d.u_brightness_high),u_saturation_factor:new h.Uniform1f(A,d.u_saturation_factor),u_contrast_factor:new h.Uniform1f(A,d.u_contrast_factor),u_spin_weights:new h.Uniform3f(A,d.u_spin_weights)}),symbolIcon:(A,d)=>({u_is_size_zoom_constant:new h.Uniform1i(A,d.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(A,d.u_is_size_feature_constant),u_size_t:new h.Uniform1f(A,d.u_size_t),u_size:new h.Uniform1f(A,d.u_size),u_camera_to_center_distance:new h.Uniform1f(A,d.u_camera_to_center_distance),u_pitch:new h.Uniform1f(A,d.u_pitch),u_rotate_symbol:new h.Uniform1i(A,d.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(A,d.u_aspect_ratio),u_fade_change:new h.Uniform1f(A,d.u_fade_change),u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(A,d.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(A,d.u_coord_matrix),u_is_text:new h.Uniform1i(A,d.u_is_text),u_pitch_with_map:new h.Uniform1i(A,d.u_pitch_with_map),u_texsize:new h.Uniform2f(A,d.u_texsize),u_texture:new h.Uniform1i(A,d.u_texture)}),symbolSDF:(A,d)=>({u_is_size_zoom_constant:new h.Uniform1i(A,d.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(A,d.u_is_size_feature_constant),u_size_t:new h.Uniform1f(A,d.u_size_t),u_size:new h.Uniform1f(A,d.u_size),u_camera_to_center_distance:new h.Uniform1f(A,d.u_camera_to_center_distance),u_pitch:new h.Uniform1f(A,d.u_pitch),u_rotate_symbol:new h.Uniform1i(A,d.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(A,d.u_aspect_ratio),u_fade_change:new h.Uniform1f(A,d.u_fade_change),u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(A,d.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(A,d.u_coord_matrix),u_is_text:new h.Uniform1i(A,d.u_is_text),u_pitch_with_map:new h.Uniform1i(A,d.u_pitch_with_map),u_texsize:new h.Uniform2f(A,d.u_texsize),u_texture:new h.Uniform1i(A,d.u_texture),u_gamma_scale:new h.Uniform1f(A,d.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(A,d.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(A,d.u_is_halo)}),symbolTextAndIcon:(A,d)=>({u_is_size_zoom_constant:new h.Uniform1i(A,d.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(A,d.u_is_size_feature_constant),u_size_t:new h.Uniform1f(A,d.u_size_t),u_size:new h.Uniform1f(A,d.u_size),u_camera_to_center_distance:new h.Uniform1f(A,d.u_camera_to_center_distance),u_pitch:new h.Uniform1f(A,d.u_pitch),u_rotate_symbol:new h.Uniform1i(A,d.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(A,d.u_aspect_ratio),u_fade_change:new h.Uniform1f(A,d.u_fade_change),u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(A,d.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(A,d.u_coord_matrix),u_is_text:new h.Uniform1i(A,d.u_is_text),u_pitch_with_map:new h.Uniform1i(A,d.u_pitch_with_map),u_texsize:new h.Uniform2f(A,d.u_texsize),u_texsize_icon:new h.Uniform2f(A,d.u_texsize_icon),u_texture:new h.Uniform1i(A,d.u_texture),u_texture_icon:new h.Uniform1i(A,d.u_texture_icon),u_gamma_scale:new h.Uniform1f(A,d.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(A,d.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(A,d.u_is_halo)}),background:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_opacity:new h.Uniform1f(A,d.u_opacity),u_color:new h.UniformColor(A,d.u_color)}),backgroundPattern:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_opacity:new h.Uniform1f(A,d.u_opacity),u_image:new h.Uniform1i(A,d.u_image),u_pattern_tl_a:new h.Uniform2f(A,d.u_pattern_tl_a),u_pattern_br_a:new h.Uniform2f(A,d.u_pattern_br_a),u_pattern_tl_b:new h.Uniform2f(A,d.u_pattern_tl_b),u_pattern_br_b:new h.Uniform2f(A,d.u_pattern_br_b),u_texsize:new h.Uniform2f(A,d.u_texsize),u_mix:new h.Uniform1f(A,d.u_mix),u_pattern_size_a:new h.Uniform2f(A,d.u_pattern_size_a),u_pattern_size_b:new h.Uniform2f(A,d.u_pattern_size_b),u_scale_a:new h.Uniform1f(A,d.u_scale_a),u_scale_b:new h.Uniform1f(A,d.u_scale_b),u_pixel_coord_upper:new h.Uniform2f(A,d.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(A,d.u_pixel_coord_lower),u_tile_units_to_pixels:new h.Uniform1f(A,d.u_tile_units_to_pixels)}),terrain:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_texture:new h.Uniform1i(A,d.u_texture),u_ele_delta:new h.Uniform1f(A,d.u_ele_delta)}),terrainDepth:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_ele_delta:new h.Uniform1f(A,d.u_ele_delta)}),terrainCoords:(A,d)=>({u_matrix:new h.UniformMatrix4f(A,d.u_matrix),u_texture:new h.Uniform1i(A,d.u_texture),u_terrain_coords_id:new h.Uniform1f(A,d.u_terrain_coords_id),u_ele_delta:new h.Uniform1f(A,d.u_ele_delta)})};class Dg{constructor(d,_,x){var C=(this.context=d).gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),d.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(d){var _=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),_.bufferSubData(_.ELEMENT_ARRAY_BUFFER,0,d.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const gw={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class T_{constructor(d,_,x,C){this.length=_.length,this.attributes=x,this.itemSize=_.bytesPerElement,this.dynamicDraw=C,x=(this.context=d).gl,this.buffer=x.createBuffer(),d.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(d){if(d.length!==this.length)throw new Error(`Length of new data is ${d.length}, which doesn't match current length of `+this.length);var _=this.context.gl;this.bind(),_.bufferSubData(_.ARRAY_BUFFER,0,d.arrayBuffer)}enableAttributes(d,_){for(let C=0;C<this.attributes.length;C++){var x;void 0!==(x=_.attributes[(x=this.attributes[C]).name])&&d.enableVertexAttribArray(x)}}setVertexAttribPointers(d,_,x){for(let B=0;B<this.attributes.length;B++){var C=this.attributes[B],M=_.attributes[C.name];void 0!==M&&d.vertexAttribPointer(M,C.components,d[gw[C.type]],!1,this.itemSize,C.offset+this.itemSize*(x||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Pg=new WeakMap;function C_(A){var d;return Pg.has(A)?Pg.get(A):(d=null==(d=A.getParameter(A.VERSION))?void 0:d.startsWith("WebGL 2.0"),Pg.set(A,d),d)}class Qi{constructor(d){this.gl=d.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(d){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class mD extends Qi{getDefault(){return h.Color.transparent}set(d){var _=this.current;d.r===_.r&&d.g===_.g&&d.b===_.b&&d.a===_.a&&!this.dirty||(this.gl.clearColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class Rg extends Qi{getDefault(){return 1}set(d){d===this.current&&!this.dirty||(this.gl.clearDepth(d),this.current=d,this.dirty=!1)}}class I_ extends Qi{getDefault(){return 0}set(d){d===this.current&&!this.dirty||(this.gl.clearStencil(d),this.current=d,this.dirty=!1)}}class al extends Qi{getDefault(){return[!0,!0,!0,!0]}set(d){var _=this.current;d[0]===_[0]&&d[1]===_[1]&&d[2]===_[2]&&d[3]===_[3]&&!this.dirty||(this.gl.colorMask(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class Wu extends Qi{getDefault(){return!0}set(d){d===this.current&&!this.dirty||(this.gl.depthMask(d),this.current=d,this.dirty=!1)}}class gD extends Qi{getDefault(){return 255}set(d){d===this.current&&!this.dirty||(this.gl.stencilMask(d),this.current=d,this.dirty=!1)}}class Mg extends Qi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(d){var _=this.current;d.func===_.func&&d.ref===_.ref&&d.mask===_.mask&&!this.dirty||(this.gl.stencilFunc(d.func,d.ref,d.mask),this.current=d,this.dirty=!1)}}class S_ extends Qi{getDefault(){var d=this.gl;return[d.KEEP,d.KEEP,d.KEEP]}set(d){var _=this.current;d[0]===_[0]&&d[1]===_[1]&&d[2]===_[2]&&!this.dirty||(this.gl.stencilOp(d[0],d[1],d[2]),this.current=d,this.dirty=!1)}}class yw extends Qi{getDefault(){return!1}set(d){var _;d===this.current&&!this.dirty||(_=this.gl,d?_.enable(_.STENCIL_TEST):_.disable(_.STENCIL_TEST),this.current=d,this.dirty=!1)}}class jN extends Qi{getDefault(){return[0,1]}set(d){var _=this.current;d[0]===_[0]&&d[1]===_[1]&&!this.dirty||(this.gl.depthRange(d[0],d[1]),this.current=d,this.dirty=!1)}}class Mc extends Qi{getDefault(){return!1}set(d){var _;d===this.current&&!this.dirty||(_=this.gl,d?_.enable(_.DEPTH_TEST):_.disable(_.DEPTH_TEST),this.current=d,this.dirty=!1)}}class kg extends Qi{getDefault(){return this.gl.LESS}set(d){d===this.current&&!this.dirty||(this.gl.depthFunc(d),this.current=d,this.dirty=!1)}}class _w extends Qi{getDefault(){return!1}set(d){var _;d===this.current&&!this.dirty||(_=this.gl,d?_.enable(_.BLEND):_.disable(_.BLEND),this.current=d,this.dirty=!1)}}class Ip extends Qi{getDefault(){var d=this.gl;return[d.ONE,d.ZERO]}set(d){var _=this.current;d[0]===_[0]&&d[1]===_[1]&&!this.dirty||(this.gl.blendFunc(d[0],d[1]),this.current=d,this.dirty=!1)}}class vw extends Qi{getDefault(){return h.Color.transparent}set(d){var _=this.current;d.r===_.r&&d.g===_.g&&d.b===_.b&&d.a===_.a&&!this.dirty||(this.gl.blendColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)}}class xd extends Qi{getDefault(){return this.gl.FUNC_ADD}set(d){d===this.current&&!this.dirty||(this.gl.blendEquation(d),this.current=d,this.dirty=!1)}}class sT extends Qi{getDefault(){return!1}set(d){var _;d===this.current&&!this.dirty||(_=this.gl,d?_.enable(_.CULL_FACE):_.disable(_.CULL_FACE),this.current=d,this.dirty=!1)}}class yD extends Qi{getDefault(){return this.gl.BACK}set(d){d===this.current&&!this.dirty||(this.gl.cullFace(d),this.current=d,this.dirty=!1)}}class Sp extends Qi{getDefault(){return this.gl.CCW}set(d){d===this.current&&!this.dirty||(this.gl.frontFace(d),this.current=d,this.dirty=!1)}}class _D extends Qi{getDefault(){return null}set(d){d===this.current&&!this.dirty||(this.gl.useProgram(d),this.current=d,this.dirty=!1)}}class A_ extends Qi{getDefault(){return this.gl.TEXTURE0}set(d){d===this.current&&!this.dirty||(this.gl.activeTexture(d),this.current=d,this.dirty=!1)}}class D_ extends Qi{getDefault(){var d=this.gl;return[0,0,d.drawingBufferWidth,d.drawingBufferHeight]}set(d){var _=this.current;d[0]===_[0]&&d[1]===_[1]&&d[2]===_[2]&&d[3]===_[3]&&!this.dirty||(this.gl.viewport(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)}}class aT extends Qi{getDefault(){return null}set(d){var _;d===this.current&&!this.dirty||((_=this.gl).bindFramebuffer(_.FRAMEBUFFER,d),this.current=d,this.dirty=!1)}}class vD extends Qi{getDefault(){return null}set(d){var _;d===this.current&&!this.dirty||((_=this.gl).bindRenderbuffer(_.RENDERBUFFER,d),this.current=d,this.dirty=!1)}}class Fi extends Qi{getDefault(){return null}set(d){var _;d===this.current&&!this.dirty||((_=this.gl).bindTexture(_.TEXTURE_2D,d),this.current=d,this.dirty=!1)}}class Kf extends Qi{getDefault(){return null}set(d){var _;d===this.current&&!this.dirty||((_=this.gl).bindBuffer(_.ARRAY_BUFFER,d),this.current=d,this.dirty=!1)}}class Wf extends Qi{getDefault(){return null}set(d){var _=this.gl;_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,d),this.current=d,this.dirty=!1}}class Yf extends Qi{getDefault(){return null}set(d){var _;d===this.current&&!this.dirty||(C_(_=this.gl)?_.bindVertexArray(d):null!=(_=_.getExtension("OES_vertex_array_object"))&&_.bindVertexArrayOES(d),this.current=d,this.dirty=!1)}}class P_ extends Qi{getDefault(){return 4}set(d){var _;d===this.current&&!this.dirty||((_=this.gl).pixelStorei(_.UNPACK_ALIGNMENT,d),this.current=d,this.dirty=!1)}}class Ap extends Qi{getDefault(){return!1}set(d){var _;d===this.current&&!this.dirty||((_=this.gl).pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),this.current=d,this.dirty=!1)}}class K7 extends Qi{getDefault(){return!1}set(d){var _;d===this.current&&!this.dirty||((_=this.gl).pixelStorei(_.UNPACK_FLIP_Y_WEBGL,d),this.current=d,this.dirty=!1)}}class ww extends Qi{constructor(d,_){super(d),this.context=d,this.parent=_}getDefault(){return null}}class lT extends ww{setDirty(){this.dirty=!0}set(d){var _;d===this.current&&!this.dirty||(this.context.bindFramebuffer.set(this.parent),(_=this.gl).framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,d,0),this.current=d,this.dirty=!1)}}class Zf extends ww{set(d){var _;d===this.current&&!this.dirty||(this.context.bindFramebuffer.set(this.parent),(_=this.gl).framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.RENDERBUFFER,d),this.current=d,this.dirty=!1)}}class bw extends ww{set(d){var _;d===this.current&&!this.dirty||(this.context.bindFramebuffer.set(this.parent),(_=this.gl).framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_STENCIL_ATTACHMENT,_.RENDERBUFFER,d),this.current=d,this.dirty=!1)}}class Ew{constructor(d,_,x,C,M){if(this.context=d,this.width=_,this.height=x,x=this.framebuffer=(_=d.gl).createFramebuffer(),this.colorAttachment=new lT(d,x),C)this.depthAttachment=new(M?bw:Zf)(d,x);else if(M)throw new Error("Stencil cannot be set without depth");if(_.checkFramebufferStatus(_.FRAMEBUFFER)!==_.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){var d=this.context.gl,_=this.colorAttachment.get();_&&d.deleteTexture(_),this.depthAttachment&&(_=this.depthAttachment.get())&&d.deleteRenderbuffer(_),d.deleteFramebuffer(this.framebuffer)}}class ss{constructor(d,_,x){this.blendFunction=d,this.blendColor=_,this.mask=x}}ss.Replace=[1,0],ss.disabled=new ss(ss.Replace,h.Color.transparent,[!1,!1,!1,!1]),ss.unblended=new ss(ss.Replace,h.Color.transparent,[!0,!0,!0,!0]),ss.alphaBlended=new ss([1,771],h.Color.transparent,[!0,!0,!0,!0]);class xw{constructor(d){var _,x;this.gl=d,this.clearColor=new mD(this),this.clearDepth=new Rg(this),this.clearStencil=new I_(this),this.colorMask=new al(this),this.depthMask=new Wu(this),this.stencilMask=new gD(this),this.stencilFunc=new Mg(this),this.stencilOp=new S_(this),this.stencilTest=new yw(this),this.depthRange=new jN(this),this.depthTest=new Mc(this),this.depthFunc=new kg(this),this.blend=new _w(this),this.blendFunc=new Ip(this),this.blendColor=new vw(this),this.blendEquation=new xd(this),this.cullFace=new sT(this),this.cullFaceSide=new yD(this),this.frontFace=new Sp(this),this.program=new _D(this),this.activeTexture=new A_(this),this.viewport=new D_(this),this.bindFramebuffer=new aT(this),this.bindRenderbuffer=new vD(this),this.bindTexture=new Fi(this),this.bindVertexBuffer=new Kf(this),this.bindElementBuffer=new Wf(this),this.bindVertexArray=new Yf(this),this.pixelStoreUnpack=new P_(this),this.pixelStoreUnpackPremultiplyAlpha=new Ap(this),this.pixelStoreUnpackFlipY=new K7(this),this.extTextureFilterAnisotropic=d.getExtension("EXT_texture_filter_anisotropic")||d.getExtension("MOZ_EXT_texture_filter_anisotropic")||d.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=d.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE),C_(d)?(this.HALF_FLOAT=d.HALF_FLOAT,_=d.getExtension("EXT_color_buffer_half_float"),this.RGBA16F=null!=(x=d.RGBA16F)?x:_?.RGBA16F_EXT,this.RGB16F=null!=(x=d.RGB16F)?x:_?.RGB16F_EXT,d.getExtension("EXT_color_buffer_float")):(d.getExtension("EXT_color_buffer_half_float"),d.getExtension("OES_texture_half_float_linear"),x=d.getExtension("OES_texture_half_float"),this.HALF_FLOAT=x?.HALF_FLOAT_OES)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(d,_){return new Dg(this,d,_)}createVertexBuffer(d,_,x){return new T_(this,d,_,x)}createRenderbuffer(d,_,x){var C=this.gl,M=C.createRenderbuffer();return this.bindRenderbuffer.set(M),C.renderbufferStorage(C.RENDERBUFFER,d,_,x),this.bindRenderbuffer.set(null),M}createFramebuffer(d,_,x,C){return new Ew(this,d,_,x,C)}clear({color:d,depth:_,stencil:x}){var C=this.gl;let M=0;d&&(M|=C.COLOR_BUFFER_BIT,this.clearColor.set(d),this.colorMask.set([!0,!0,!0,!0])),void 0!==_&&(M|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(_),this.depthMask.set(!0)),void 0!==x&&(M|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),C.clear(M)}setCullFace(d){!1===d.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(d.mode),this.frontFace.set(d.frontFace))}setDepthMode(d){d.func!==this.gl.ALWAYS||d.mask?(this.depthTest.set(!0),this.depthFunc.set(d.func),this.depthMask.set(d.mask),this.depthRange.set(d.range)):this.depthTest.set(!1)}setStencilMode(d){d.test.func!==this.gl.ALWAYS||d.mask?(this.stencilTest.set(!0),this.stencilMask.set(d.mask),this.stencilOp.set([d.fail,d.depthFail,d.pass]),this.stencilFunc.set({func:d.test.func,ref:d.ref,mask:d.test.mask})):this.stencilTest.set(!1)}setColorMode(d){h.deepEqual(d.blendFunction,ss.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(d.blendFunction),this.blendColor.set(d.blendColor)),this.colorMask.set(d.mask)}createVertexArray(){var d;return C_(this.gl)?this.gl.createVertexArray():null==(d=this.gl.getExtension("OES_vertex_array_object"))?void 0:d.createVertexArrayOES()}deleteVertexArray(d){var _;return C_(this.gl)?this.gl.deleteVertexArray(d):null==(_=this.gl.getExtension("OES_vertex_array_object"))?void 0:_.deleteVertexArrayOES(d)}unbindVAO(){this.bindVertexArray.set(null)}}class Ei{constructor(d,_,x){this.func=d,this.mask=_,this.range=x}}Ei.ReadOnly=!1,Ei.ReadWrite=!0,Ei.disabled=new Ei(519,Ei.ReadOnly,[0,1]);class as{constructor(d,_,x,C,M,B){this.test=d,this.ref=_,this.mask=x,this.fail=C,this.depthFail=M,this.pass=B}}as.disabled=new as({func:519,mask:0},0,0,7680,7680,7680);class Do{constructor(d,_,x){this.enable=d,this.mode=_,this.frontFace=x}}let Tw;function Cw(A,d,_,x,C,M,B){var U=A.context,K=U.gl,re=A.useProgram("collisionBox"),ce=[];let ee=0,he=0;for(let ur=0;ur<x.length;ur++){var Ee=x[ur],Se=d.getTile(Ee),Oe=Se.getBucket(_);if(Oe){let Un=Ee.posMatrix;0===C[0]&&0===C[1]||(Un=A.translatePosMatrix(Ee.posMatrix,Se,C,M));var Ae,qe,Ge=B?Oe.textCollisionBox:Oe.iconCollisionBox,Ye=Oe.collisionCircleArray;0<Ye.length&&(Ae=h.create(),qe=Un,h.mul(Ae,Oe.placementInvProjMatrix,A.transform.glCoordMatrix),h.mul(Ae,Ae,Oe.placementViewportMatrix),ce.push({circleArray:Ye,circleOffset:he,transform:qe,invTransform:Ae,coord:Ee}),ee+=Ye.length/4,he=ee),Ge&&re.draw(U,K.LINES,Ei.disabled,as.disabled,A.colorModeForRenderPass(),Do.disabled,BN(Un,A.transform,Se),A.style.map.terrain&&A.style.map.terrain.getTerrainData(Ee),_.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,null,A.transform.zoom,null,null,Ge.collisionVertexBuffer)}}if(B&&ce.length){var _t=A.useProgram("collisionCircle"),bt=new h.CollisionCircleLayoutArray;bt.resize(4*ee),bt._trim();let ur=0;for(const Un of ce)for(let sn=0;sn<Un.circleArray.length/4;sn++){var rn,yt=Un.circleArray[0+(rn=4*sn)],Nt=Un.circleArray[1+rn],At=Un.circleArray[2+rn];bt.emplace(ur++,yt,Nt,At,rn=Un.circleArray[3+rn],0),bt.emplace(ur++,yt,Nt,At,rn,1),bt.emplace(ur++,yt,Nt,At,rn,2),bt.emplace(ur++,yt,Nt,At,rn,3)}(!Tw||Tw.length<2*ee)&&(Tw=function(Un){var sn=2*Un,qn=new h.QuadTriangleArray;qn.resize(sn),qn._trim();for(let An=0;An<sn;An++){var Dr=6*An;qn.uint16[0+Dr]=4*An+0,qn.uint16[1+Dr]=4*An+1,qn.uint16[2+Dr]=4*An+2,qn.uint16[3+Dr]=4*An+2,qn.uint16[4+Dr]=4*An+3,qn.uint16[5+Dr]=4*An+0}return qn}(ee));var mn=U.createIndexBuffer(Tw,!0),Fn=U.createVertexBuffer(bt,h.collisionCircleLayout.members,!0);for(const Un of ce){var er=fs(Un.transform,Un.invTransform,A.transform);_t.draw(U,K.TRIANGLES,Ei.disabled,as.disabled,A.colorModeForRenderPass(),Do.disabled,er,A.style.map.terrain&&A.style.map.terrain.getTerrainData(Un.coord),_.id,Fn,mn,h.SegmentVector.simpleSegment(0,2*Un.circleOffset,Un.circleArray.length,Un.circleArray.length/2),null,A.transform.zoom,null,null,null)}Fn.destroy(),mn.destroy()}}Do.disabled=new Do(!1,1029,2305),Do.backCCW=new Do(!0,1029,2305);const HN=h.identity(new Float32Array(16));function cT(A,d,_,x,C,M,B,U,K,re,ce,ee){var he=A.context,Ee=he.gl,Se=A.transform,Oe="map"===U,Ae="map"===K,qe="viewport"!==U&&"point"!==_.layout.get("symbol-placement"),Ge=Oe&&!Ae&&!qe,Ye=!_.layout.get("symbol-sort-key").isConstant();let _t=!1;var bt=A.depthModeForSublayer(0,Ei.ReadOnly),yt=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Nt=[];for(const Is of x){var At=d.getTile(Is),rn=At.getBucket(_);if(rn){var mn=C?rn.text:rn.icon;if(mn&&mn.segments.get().length&&mn.hasVisibleVertices){var Dr=mn.programConfigurations.get(_.id),Fn=C||rn.sdfIcons,er=C?rn.textSizeData:rn.iconSizeData,qn=Ae||0!==Se.pitch,ur=A.useProgram((Un=Fn,ur=C,rn.iconsInText&&ur?"symbolTextAndIcon":Un?"symbolSDF":"symbolIcon"),Dr),Un=h.evaluateSizeForZoom(er,Se.zoom),sn=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Is);let Bp,zg,nm,XN,hu=[0,0],VD=null;C?(zg=At.glyphAtlasTexture,nm=Ee.LINEAR,Bp=At.glyphAtlasTexture.size,rn.iconsInText&&(hu=At.imageAtlasTexture.size,VD=At.imageAtlasTexture,Dr="composite"===er.kind||"camera"===er.kind,XN=qn||A.options.rotating||A.options.zooming||Dr?Ee.LINEAR:Ee.NEAREST)):(Dr=1!==_.layout.get("icon-size").constantOr(0)||rn.iconsNeedLinear,zg=At.imageAtlasTexture,nm=Fn||A.options.rotating||A.options.zooming||Dr||qn?Ee.LINEAR:Ee.NEAREST,Bp=At.imageAtlasTexture.size),Dr=$n(At,1,A.transform.zoom),qn=vi(Is.posMatrix,Ae,Oe,A.transform,Dr),Dr=me(Is.posMatrix,Ae,Oe,A.transform,Dr);var An=yt&&rn.hasTextData();if(An="none"!==_.layout.get("icon-text-fit")&&An&&rn.hasIconData(),qe){var xi=A.style.map.terrain?(Sd,$_)=>A.style.map.terrain.getElevation(Is,Sd,$_):null,ho="map"===_.layout.get("text-rotation-alignment");{bo=void 0,ll=void 0,Po=void 0,Lo=void 0,pa=void 0,Wo=void 0,za=void 0,Hs=void 0,em=void 0,Cd=void 0;var ui=rn,Ti=Is.posMatrix,Br=A,bo=C,Ri=qn,no=Dr,Al=Ae,na=re,Mh=ho,ll=xi,Cs=bo?ui.textSizeData:ui.iconSizeData,Ls=h.evaluateSizeForZoom(Cs,Br.transform.zoom),Vp=[256/Br.width*2+1,256/Br.height*2+1],Po=(bo?ui.text:ui.icon).dynamicLayoutVertexArray,Dl=(Po.clear(),ui.lineVertexArray),Lo=(bo?ui.text:ui.icon).placedSymbolArray,Eo=Br.transform.width/Br.transform.height;let Sd=!1;for(let $_=0;$_<Lo.length;$_++){var Hs,Wo,za,em,Cd,pa=Lo.get($_);if(pa.hidden||pa.writingMode===h.WritingMode.vertical&&!Sd)Ot(pa.numGlyphs,Po);else{let Qu;Sd=!1,ll?(Qu=[pa.anchorX,pa.anchorY,ll(pa.anchorX,pa.anchorY),1],h.transformMat4(Qu,Qu,Ti)):cn(Qu=[pa.anchorX,pa.anchorY,0,1],Qu,Ti),Hs=void 0,Hs=(za=Qu)[0]/za[3],za=za[1]/za[3],(!(Hs>=-(Wo=Vp)[0]&&Hs<=Wo[0]&&za>=-Wo[1]&&za<=Wo[1])||(za=se(Br.transform.cameraToCenterDistance,Hs=Qu[3]),Wo=h.evaluateSizeForFeature(Cs,Ls,pa),Hs=Al?Wo/za:Wo*za,za=J(Wo=new h.Point(pa.anchorX,pa.anchorY),Ri,ll).point,Sd=(Cd=Ue(pa,Hs,!(em={projections:{},offsets:{}}),na,Ti,Ri,no,ui.glyphOffsetArray,Dl,Po,za,Wo,em,Eo,Mh,ll)).useVertical,Cd.notEnoughRoom)||Sd||Cd.needsFlipping&&Ue(pa,Hs,!0,na,Ti,Ri,no,ui.glyphOffsetArray,Dl,Po,za,Wo,em,Eo,Mh,ll).notEnoughRoom)&&Ot(pa.numGlyphs,Po)}}(bo?ui.text:ui.icon).dynamicLayoutVertexBuffer.updateData(Po)}}let JN;ho=A.translatePosMatrix(Is.posMatrix,At,M,B),xi=qe||C&&yt||An?HN:qn,bo=A.translatePosMatrix(Dr,At,M,B,!0),An=Fn&&0!==_.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1);var Id={program:ur,buffers:mn,uniformValues:JN=Fn?rn.iconsInText?zN(er.kind,Un,Ge,Ae,A,ho,xi,bo,Bp,hu):Rc(er.kind,Un,Ge,Ae,A,ho,xi,bo,C,Bp,!0):Cp(er.kind,Un,Ge,Ae,A,ho,xi,bo,C,Bp),atlasTexture:zg,atlasTextureIcon:VD,atlasInterpolation:nm,atlasInterpolationIcon:XN,isSDF:Fn,hasHalo:An};if(Ye&&rn.canOverlap){_t=!0;for(const Sd of mn.segments.get())Nt.push({segments:new h.SegmentVector([Sd]),sortKey:Sd.sortKey,state:Id,terrainData:sn})}else Nt.push({segments:mn.segments,sortKey:0,state:Id,terrainData:sn})}}}_t&&Nt.sort((Is,Bp)=>Is.sortKey-Bp.sortKey);for(const Is of Nt){var tm,Ro=Is.state;he.activeTexture.set(Ee.TEXTURE0),Ro.atlasTexture.bind(Ro.atlasInterpolation,Ee.CLAMP_TO_EDGE),Ro.atlasTextureIcon&&(he.activeTexture.set(Ee.TEXTURE1),Ro.atlasTextureIcon)&&Ro.atlasTextureIcon.bind(Ro.atlasInterpolationIcon,Ee.CLAMP_TO_EDGE),Ro.isSDF&&(tm=Ro.uniformValues,Ro.hasHalo&&(tm.u_is_halo=1,wD(Ro.buffers,Is.segments,_,A,Ro.program,bt,ce,ee,tm,Is.terrainData)),tm.u_is_halo=0),wD(Ro.buffers,Is.segments,_,A,Ro.program,bt,ce,ee,Ro.uniformValues,Is.terrainData)}}function wD(A,d,_,x,C,M,B,U,K,re){var ce=x.context;C.draw(ce,ce.gl.TRIANGLES,M,B,U,Do.disabled,K,re,_.id,A.layoutVertexBuffer,A.indexBuffer,d,_.paint,x.transform.zoom,A.programConfigurations.get(_.id),A.dynamicLayoutVertexBuffer,A.opacityVertexBuffer)}function bD(A,d,_,x,C){if(_&&x&&x.imageAtlas){let M=(x=x.imageAtlas.patternPositions)[_.to.toString()],B=x[_.from.toString()];!M&&B&&(M=B),!B&&M&&(B=M),M&&B||(M=x[_=C.getPaintProperty(d)],B=x[_]),M&&B&&A.setConstantPatternPositions(M,B)}}function qN(A,d,_,x,C,M,B){var U=A.context.gl,K="fill-pattern",re=_.paint.get(K),ce=re&&re.constantOr(1),ee=_.getCrossfadeParameters();let he,Ee,Se,Oe,Ae;he=B?(Ee=ce&&!_.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",U.LINES):(Ee=ce?"fillPattern":"fill",U.TRIANGLES);var qe=re.constantOr(null);for(const rn of x){var Ge,Ye,_t,bt,yt,Nt,At=d.getTile(rn);ce&&!At.patternsLoaded()||(Ge=At.getBucket(_))&&(Ye=Ge.programConfigurations.get(_.id),_t=A.useProgram(Ee,Ye),bt=A.style.map.terrain&&A.style.map.terrain.getTerrainData(rn),ce&&(A.context.activeTexture.set(U.TEXTURE0),At.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Ye.updatePaintBuffers(ee)),bD(Ye,K,qe,At,_),yt=((bt?rn:null)||rn).posMatrix,yt=A.translatePosMatrix(yt,At,_.paint.get("fill-translate"),_.paint.get("fill-translate-anchor")),Se=B?(Oe=Ge.indexBuffer2,Ae=Ge.segments2,Nt=[U.drawingBufferWidth,U.drawingBufferHeight],"fillOutlinePattern"===Ee&&ce?dD(yt,A,ee,At,Nt):VN(yt,Nt)):(Oe=Ge.indexBuffer,Ae=Ge.segments,ce?Sg(yt,A,ee,At):Gf(yt)),_t.draw(A.context,he,C,A.stencilModeForClipping(rn),M,Do.disabled,Se,bt,_.id,Ge.layoutVertexBuffer,Oe,Ae,_.paint,A.transform.zoom,Ye))}}function Ts(A,d,_,x,C,M,B){var U=A.context,K=U.gl,re="fill-extrusion-pattern",ce=_.paint.get(re),ee=ce.constantOr(1),he=_.getCrossfadeParameters(),Ee=_.paint.get("fill-extrusion-opacity"),Se=ce.constantOr(null);for(const yt of x){var Oe,Ae,qe,Ge,Ye,_t=d.getTile(yt),bt=_t.getBucket(_);bt&&(Oe=A.style.map.terrain&&A.style.map.terrain.getTerrainData(yt),Ae=bt.programConfigurations.get(_.id),qe=A.useProgram(ee?"fillExtrusionPattern":"fillExtrusion",Ae),ee&&(A.context.activeTexture.set(K.TEXTURE0),_t.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Ae.updatePaintBuffers(he)),bD(Ae,re,Se,_t,_),Ge=A.translatePosMatrix(yt.posMatrix,_t,_.paint.get("fill-extrusion-translate"),_.paint.get("fill-extrusion-translate-anchor")),Ye=_.paint.get("fill-extrusion-vertical-gradient"),_t=ee?qf(Ge,A,Ye,Ee,yt,he,_t):fw(Ge,A,Ye,Ee),qe.draw(U,U.gl.TRIANGLES,C,M,B,Do.backCCW,_t,Oe,_.id,bt.layoutVertexBuffer,bt.indexBuffer,bt.segments,_.paint,A.transform.zoom,Ae,A.style.map.terrain&&bt.centroidVertexBuffer))}}const ED=new h.Color(1,0,0,1),dT=new h.Color(0,1,0,1),M_=new h.Color(0,0,1,1),Iw=new h.Color(1,0,1,1),xD=new h.Color(0,1,1,1);function CD(A,d,_,x){k_(A,0,d+_/2,A.transform.width,_,x)}function ID(A,d,_,x){k_(A,d-_/2,0,_,A.transform.height,x)}function k_(A,d,_,x,C,M){var B=A.context,U=B.gl;U.enable(U.SCISSOR_TEST),U.scissor(d*A.pixelRatio,_*A.pixelRatio,x*A.pixelRatio,C*A.pixelRatio),B.clear({color:M}),U.disable(U.SCISSOR_TEST)}function Sw(A,d,_){var x=A.context,C=x.gl,M=A.colorModeForRenderPass(),B=new Ei(C.LEQUAL,Ei.ReadWrite,A.depthRangeFor3D),U=A.useProgram("terrain"),K=d.getTerrainMesh();x.bindFramebuffer.set(null),x.viewport.set([0,0,A.width,A.height]);for(const ee of _){var ce=A.renderToTexture.getTexture(ee),re=d.getTerrainData(ee.tileID);ce={u_matrix:(x.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,ce.texture),ce=A.transform.calculatePosMatrix(ee.tileID.toUnwrapped())),u_texture:0,u_ele_delta:d.getMeshFrameDelta(A.transform.zoom)},U.draw(x,C.TRIANGLES,B,as.disabled,M,Do.backCCW,ce,re,"terrain",K.vertexBuffer,K.indexBuffer,K.segments)}}class WN{constructor(d,_){this.context=new xw(d),this.transform=_,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:h.identity(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=qt.maxUnderzooming+qt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new hD}resize(d,_,x){if(this.width=Math.floor(d*x),this.height=Math.floor(_*x),this.pixelRatio=x,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style._order)this.style._layers[C].resize()}setup(){var d,_=this.context;((((((d=new h.PosArray).emplaceBack(0,0),d.emplaceBack(h.EXTENT,0),d.emplaceBack(0,h.EXTENT),d.emplaceBack(h.EXTENT,h.EXTENT),this.tileExtentBuffer=_.createVertexBuffer(d,wd.members),this.tileExtentSegments=h.SegmentVector.simpleSegment(0,0,4,2),d=new h.PosArray).emplaceBack(0,0),d.emplaceBack(h.EXTENT,0),d.emplaceBack(0,h.EXTENT),d.emplaceBack(h.EXTENT,h.EXTENT),this.debugBuffer=_.createVertexBuffer(d,wd.members),this.debugSegments=h.SegmentVector.simpleSegment(0,0,4,5),d=new h.RasterBoundsArray).emplaceBack(0,0,0,0),d.emplaceBack(h.EXTENT,0,h.EXTENT,0),d.emplaceBack(0,h.EXTENT,0,h.EXTENT),d.emplaceBack(h.EXTENT,h.EXTENT,h.EXTENT,h.EXTENT),this.rasterBoundsBuffer=_.createVertexBuffer(d,ne.members),this.rasterBoundsSegments=h.SegmentVector.simpleSegment(0,0,4,2),d=new h.PosArray).emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=_.createVertexBuffer(d,wd.members),this.viewportSegments=h.SegmentVector.simpleSegment(0,0,4,2),d=new h.LineStripIndexArray).emplaceBack(0),d.emplaceBack(1),d.emplaceBack(3),d.emplaceBack(2),d.emplaceBack(0),this.tileBorderIndexBuffer=_.createIndexBuffer(d),d=new h.TriangleIndexArray).emplaceBack(0,1,2),d.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=_.createIndexBuffer(d),this.stencilClearMode=new as({func:(_=this.context.gl).ALWAYS,mask:0},0,255,_.ZERO,_.ZERO,_.ZERO)}clearStencil(){var d=this.context,_=d.gl,x=(this.nextStencilID=1,this.currentStencilSource=void 0,h.create());h.ortho(x,0,this.width,this.height,0,0,1),h.scale(x,x,[_.drawingBufferWidth,_.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(d,_.TRIANGLES,Ei.disabled,this.stencilClearMode,ss.disabled,Do.disabled,E_(x),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(d,_){if(this.currentStencilSource!==d.source&&d.isTileClipped()&&_&&_.length){this.currentStencilSource=d.source;var x=this.context,C=x.gl,M=(256<this.nextStencilID+_.length&&this.clearStencil(),x.setColorMode(ss.disabled),x.setDepthMode(Ei.disabled),this.useProgram("clippingMask"));this._tileClippingMaskIDs={};for(const K of _){var B=this._tileClippingMaskIDs[K.key]=this.nextStencilID++,U=this.style.map.terrain&&this.style.map.terrain.getTerrainData(K);M.draw(x,C.TRIANGLES,Ei.disabled,new as({func:C.ALWAYS,mask:0},B,255,C.KEEP,C.KEEP,C.REPLACE),ss.disabled,Do.disabled,E_(K.posMatrix),U,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}}stencilModeFor3D(){this.currentStencilSource=void 0,256<this.nextStencilID+1&&this.clearStencil();var d=this.nextStencilID++,_=this.context.gl;return new as({func:_.NOTEQUAL,mask:255},d,255,_.KEEP,_.KEEP,_.REPLACE)}stencilModeForClipping(d){var _=this.context.gl;return new as({func:_.EQUAL,mask:255},this._tileClippingMaskIDs[d.key],0,_.KEEP,_.KEEP,_.REPLACE)}stencilConfigForOverlap(x){var _=this.context.gl,C=(x=x.sort((U,K)=>K.overscaledZ-U.overscaledZ))[x.length-1].overscaledZ,M=x[0].overscaledZ-C+1;if(1<M){this.currentStencilSource=void 0,256<this.nextStencilID+M&&this.clearStencil();var B={};for(let U=0;U<M;U++)B[U+C]=new as({func:_.GEQUAL,mask:255},U+this.nextStencilID,255,_.KEEP,_.KEEP,_.REPLACE);return this.nextStencilID+=M,[B,x]}return[{[C]:as.disabled},x]}colorModeForRenderPass(){var d=this.context.gl;return this._showOverdrawInspector?new ss([d.CONSTANT_COLOR,d.ONE],new h.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ss.unblended:ss.alphaBlended}depthModeForSublayer(d,_,x){return this.opaquePassEnabledForLayer()?new Ei(x||this.context.gl.LEQUAL,_,[d=1-((1+this.currentLayer)*this.numSublayers+d)*this.depthEpsilon,d]):Ei.disabled}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(d,_){this.style=d,this.options=_,this.lineAtlas=d.lineAtlas,this.imageManager=d.imageManager,this.glyphManager=d.glyphManager,this.symbolFadeChange=d.placement.symbolFadeChange(P.now()),this.imageManager.beginFrame();var x=this.style._order,C=this.style.sourceCaches,M={},B={},U={};for(const Ge in C){var K=C[Ge];K.used&&K.prepare(this.context),M[Ge]=K.getVisibleCoordinates(),B[Ge]=M[Ge].slice().reverse(),U[Ge]=K.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Ge=0;Ge<x.length;Ge++)if(this.style._layers[x[Ge]].is3D()){this.opaquePassCutoff=Ge;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Ge of x){var ce,ee=this.style._layers[Ge];ee.hasOffscreenPass()&&!ee.isHidden(this.transform.zoom)&&(ce=B[ee.source],"custom"===ee.type||ce.length)&&this.renderLayer(this,C[ee.source],ee,ce)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:_.showOverdrawInspector?h.Color.black:h.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=_.showOverdrawInspector,this.depthRangeFor3D=[0,1-(d._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=x.length-1;0<=this.currentLayer;this.currentLayer--){var he=this.style._layers[x[this.currentLayer]],Ee=C[he.source],Se=M[he.source];this._renderTileClippingMasks(he,Se),this.renderLayer(this,Ee,he,Se)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){var Oe,Ae=this.style._layers[x[this.currentLayer]],qe=C[Ae.source];this.renderToTexture&&this.renderToTexture.renderLayer(Ae)||(Oe=("symbol"===Ae.type?U:B)[Ae.source],this._renderTileClippingMasks(Ae,M[Ae.source]),this.renderLayer(this,qe,Ae,Oe))}this.options.showTileBoundaries&&(_=function pT(A,d){let _=null;var x=(C=Object.values(A._layers).flatMap(B=>B.source&&!B.isHidden(d)?[A.sourceCaches[B.source]]:[])).filter(B=>"vector"===B.getSource().type),C=C.filter(B=>"vector"!==B.getSource().type);const M=B=>{(!_||_.getSource().maxzoom<B.getSource().maxzoom)&&(_=B)};return x.forEach(B=>M(B)),_||C.forEach(B=>M(B)),_}(this.style,this.transform.zoom))&&function Qf(A,d,_){for(let Oe=0;Oe<_.length;Oe++){x=void 0,Se=void 0,C=void 0,M=void 0,K=void 0,Ee=void 0;var x=A,Se=d,C=_[Oe],M=x.context,B=M.gl,U=C.posMatrix,K=x.useProgram("debug"),re=Ei.disabled,ce=as.disabled,ee=x.colorModeForRenderPass(),he=x.style.map.terrain&&x.style.map.terrain.getTerrainData(C),Ee=(M.activeTexture.set(B.TEXTURE0),(Ee=Se.getTileByID(C.key).latestRawTileData)&&Ee.byteLength||0);Ee=Math.floor(Ee/1024),Se=Se.getTile(C).tileSize,Se=512/Math.min(Se,512)*(C.overscaledZ/x.transform.zoom)*.5;let Ae=C.canonical.toString();C.overscaledZ!==C.canonical.z&&(Ae+=" => "+C.overscaledZ),function(qe,Ge){qe.initDebugOverlayCanvas();var Ye=qe.debugOverlayCanvas,_t=qe.context.gl,bt=qe.debugOverlayCanvas.getContext("2d");bt.clearRect(0,0,Ye.width,Ye.height),bt.shadowColor="white",bt.shadowBlur=2,bt.lineWidth=1.5,bt.strokeStyle="white",bt.textBaseline="top",bt.font="bold 36px Open Sans, sans-serif",bt.fillText(Ge,5,5),bt.strokeText(Ge,5,5),qe.debugOverlayTexture.update(Ye),qe.debugOverlayTexture.bind(_t.LINEAR,_t.CLAMP_TO_EDGE)}(x,C=Ae+` ${Ee}kB`),K.draw(M,B.TRIANGLES,re,ce,ss.alphaBlended,Do.disabled,Go(U,h.Color.transparent,Se),null,"$debug",x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments),K.draw(M,B.LINE_STRIP,re,ce,ee,Do.disabled,Go(U,h.Color.red),he,"$debug",x.debugBuffer,x.tileBorderIndexBuffer,x.debugSegments)}}(this,_,_.getVisibleCoordinates()),this.options.showPadding&&function TD(A){var d,_,x;k_(d=A,(_=(CD(A,A.transform.height-((x=A.transform.padding).top||0),3,ED),CD(A,x.bottom||0,3,dT),ID(A,x.left||0,3,M_),ID(A,A.transform.width-(x.right||0),3,Iw),x=A.transform.centerPoint).x)-1,(A=A.transform.height-x.y)-10,2,20,x=xD),k_(d,_-10,A-1,20,2,x)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(d){if(this.style&&this.style.map&&this.style.map.terrain){var _=this.terrainFacilitator.matrix,x=this.transform.projMatrix;let C=this.terrainFacilitator.dirty;(C=(C=C||(d?!h.exactEquals(_,x):!h.equals(_,x)))||0<this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length)&&(h.copy(_,x),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function fT(A,d){var _=A.context,x=_.gl,C=ss.unblended,M=new Ei(x.LEQUAL,Ei.ReadWrite,[0,1]),B=d.getTerrainMesh(),U=d.sourceCache.getRenderableTiles(),K=A.useProgram("terrainDepth");_.bindFramebuffer.set(d.getFramebuffer("depth").framebuffer),_.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),_.clear({color:h.Color.transparent,depth:1});for(const ee of U){var re=d.getTerrainData(ee.tileID),ce={u_matrix:A.transform.calculatePosMatrix(ee.tileID.toUnwrapped()),u_ele_delta:d.getMeshFrameDelta(A.transform.zoom)};K.draw(_,x.TRIANGLES,M,as.disabled,C,Do.backCCW,ce,re,"terrain",B.vertexBuffer,B.indexBuffer,B.segments)}_.bindFramebuffer.set(null),_.viewport.set([0,0,A.width,A.height])}(this,this.style.map.terrain),function KN(A,d){var _=A.context,x=_.gl,C=ss.unblended,M=new Ei(x.LEQUAL,Ei.ReadWrite,[0,1]),B=d.getTerrainMesh(),U=d.getCoordsTexture(),K=d.sourceCache.getRenderableTiles(),re=A.useProgram("terrainCoords");_.bindFramebuffer.set(d.getFramebuffer("coords").framebuffer),_.viewport.set([0,0,A.width/devicePixelRatio,A.height/devicePixelRatio]),_.clear({color:h.Color.transparent,depth:1}),d.coordsIndex=[];for(const he of K){var ce=d.getTerrainData(he.tileID),ee={u_matrix:(_.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,U.texture),ee=A.transform.calculatePosMatrix(he.tileID.toUnwrapped())),u_terrain_coords_id:(255-d.coordsIndex.length)/255,u_texture:0,u_ele_delta:d.getMeshFrameDelta(A.transform.zoom)};re.draw(_,x.TRIANGLES,M,as.disabled,C,Do.backCCW,ee,ce,"terrain",B.vertexBuffer,B.indexBuffer,B.segments),d.coordsIndex.push(he.tileID.key)}_.bindFramebuffer.set(null),_.viewport.set([0,0,A.width,A.height])}(this,this.style.map.terrain))}}renderLayer(d,_,x,C){if(!x.isHidden(this.transform.zoom)&&("background"===x.type||"custom"===x.type||(C||[]).length))switch(this.id=x.id,x.type){case"symbol":!function y5(A,d,_,x,C){if("translucent"===A.renderPass){var M=as.disabled,B=A.colorModeForRenderPass();if(_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset")){var U=x,K=A,re=_,ce=d,ee=_.layout.get("text-rotation-alignment"),he=_.layout.get("text-pitch-alignment"),Ee=C,Se=K.transform,Oe="map"===ee,Ae="map"===he;for(const Nt of U){var qe,Ge,Ye,bt=ce.getTile(Nt),yt=bt.getBucket(re);yt&&yt.text&&yt.text.segments.get().length&&(qe=h.evaluateSizeForZoom(qe=yt.textSizeData,Se.zoom),Ge=$n(bt,1,K.transform.zoom),Ge=vi(Nt.posMatrix,Ae,Oe,K.transform,Ge),Ye="none"!==re.layout.get("icon-text-fit")&&yt.hasIconData(),qe)&&(bt=Math.pow(2,Se.zoom-bt.tileID.overscaledZ),function(At,rn,mn,Fn,er,ur,Un,sn,qn,Dr,An){var xi=At.text.placedSymbolArray,ho=At.text.dynamicLayoutVertexArray,ui=At.icon.dynamicLayoutVertexArray,Ti={};ho.clear();for(let Lo=0;Lo<xi.length;Lo++){var Br=xi.get(Lo),bo=At.allowVerticalPlacement&&!Br.placedOrientation;if(bo=Br.hidden||!Br.crossTileID||bo?null:Fn[Br.crossTileID]){var Ri=new h.Point(Br.anchorX,Br.anchorY),no=J(Ri,mn?Un:ur,An),Al=se(er.cameraToCenterDistance,no.signedDistanceFromCamera);let Eo=h.evaluateSizeForFeature(At.textSizeData,qn,Br)*Al/h.ONE_EM;mn&&(Eo*=At.tilePixelRatio/sn);var{width:Al,height:bo,anchor:ll,textOffset:na,textBoxScale:Mh}=bo,ll=function(Ro,Is,em,Cd,pa,Id){var{horizontalAlign:Ro,verticalAlign:tm}=h.getAnchorAlignment(Ro);return new h.Point(((Ro=-(Ro-.5)*Is)/pa+Cd[0])*Id,((Is=-(tm-.5)*em)/pa+Cd[1])*Id)}(ll,Al,bo,na,Mh,Eo),Cs=mn?J(Ri.add(ll),ur,An).point:no.point.add(rn?ll.rotate(-er.angle):ll),Ls=At.allowVerticalPlacement&&Br.placedOrientation===h.WritingMode.vertical?Math.PI/2:0;for(let Wo=0;Wo<Br.numGlyphs;Wo++)h.addDynamicAttributes(ho,Cs,Ls);Dr&&0<=Br.associatedIconIndex&&(Ti[Br.associatedIconIndex]={shiftedAnchor:Cs,angle:Ls})}else Ot(Br.numGlyphs,ho)}if(Dr){ui.clear();var Vp=At.icon.placedSymbolArray;for(let Lo=0;Lo<Vp.length;Lo++){var Po=Vp.get(Lo);if(Po.hidden)Ot(Po.numGlyphs,ui);else{var Dl=Ti[Lo];if(Dl)for(let Eo=0;Eo<Po.numGlyphs;Eo++)h.addDynamicAttributes(ui,Dl.shiftedAnchor,Dl.angle);else Ot(Po.numGlyphs,ui)}}At.icon.dynamicLayoutVertexBuffer.updateData(ui)}At.text.dynamicLayoutVertexBuffer.updateData(ho)}(yt,Oe,Ae,Ee,Se,Ge,Nt.posMatrix,bt,qe,Ye,K.style.map.terrain?(At,rn)=>K.style.map.terrain.getElevation(Nt,At,rn):null))}}0!==_.paint.get("icon-opacity").constantOr(1)&&cT(A,d,_,x,!1,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),_.layout.get("icon-rotation-alignment"),_.layout.get("icon-pitch-alignment"),_.layout.get("icon-keep-upright"),M,B),0!==_.paint.get("text-opacity").constantOr(1)&&cT(A,d,_,x,!0,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),_.layout.get("text-keep-upright"),M,B),d.map.showCollisionBoxes&&(Cw(A,d,_,x,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),!0),Cw(A,d,_,x,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),!1))}}(d,_,x,C,this.style.placement.variableOffsets);break;case"circle":!function uT(A,d,_,x){if("translucent"===A.renderPass){var C=_.paint.get("circle-opacity"),M=_.paint.get("circle-stroke-width"),B=_.paint.get("circle-stroke-opacity"),U=!_.layout.get("circle-sort-key").isConstant();if(0!==C.constantOr(1)||0!==M.constantOr(1)&&0!==B.constantOr(1)){var K=A.context,re=K.gl,ce=A.depthModeForSublayer(0,Ei.ReadOnly),ee=as.disabled,he=A.colorModeForRenderPass(),Ee=[];for(let Un=0;Un<x.length;Un++){var Se=x[Un],Oe=d.getTile(Se),Ae=Oe.getBucket(_);if(Ae){var qe=Ae.programConfigurations.get(_.id),Ge=A.useProgram("circle",qe),Ye=Ae.layoutVertexBuffer,_t=Ae.indexBuffer,bt=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Se),yt={programConfiguration:qe,program:Ge,layoutVertexBuffer:Ye,indexBuffer:_t,uniformValues:((sn,qn,Dr,An)=>{var xi,ho=sn.transform;let ui,Ti;return Ti="map"===An.paint.get("circle-pitch-alignment")?(ui=!0,[xi=$n(Dr,1,ho.zoom),xi]):(ui=!1,ho.pixelsToGLUnits),{u_camera_to_center_distance:ho.cameraToCenterDistance,u_scale_with_map:+("map"===An.paint.get("circle-pitch-scale")),u_matrix:sn.translatePosMatrix(qn.posMatrix,Dr,An.paint.get("circle-translate"),An.paint.get("circle-translate-anchor")),u_pitch_with_map:+ui,u_device_pixel_ratio:sn.pixelRatio,u_extrude_scale:Ti}})(A,Se,Oe,_),terrainData:bt};if(U)for(const sn of Ae.segments.get())Ee.push({segments:new h.SegmentVector([sn]),sortKey:sn.sortKey,state:yt});else Ee.push({segments:Ae.segments,sortKey:0,state:yt})}}U&&Ee.sort((Un,sn)=>Un.sortKey-sn.sortKey);for(const Un of Ee){var{programConfiguration:Nt,program:At,layoutVertexBuffer:rn,indexBuffer:mn,uniformValues:Fn,terrainData:er}=Un.state;At.draw(K,re.TRIANGLES,ce,ee,he,Do.disabled,Fn,er,_.id,rn,mn,Un.segments,_.paint,A.transform.zoom,Nt)}}}}(d,_,x,C);break;case"heatmap":!function hT(A,d,_,x){if(0!==_.paint.get("heatmap-opacity"))if("offscreen"===A.renderPass){var C=A.context,M=C.gl,B=as.disabled,U=new ss([M.ONE,M.ONE],h.Color.transparent,[!0,!0,!0,!0]);{var re=A,ce=_;(K=C).activeTexture.set((ee=K.gl).TEXTURE1),K.viewport.set([0,0,re.width/4,re.height/4]);let Ye=ce.heatmapFbo;Ye?(ee.bindTexture(ee.TEXTURE_2D,Ye.colorAttachment.get()),K.bindFramebuffer.set(Ye.framebuffer)):(Ge=ee.createTexture(),ee.bindTexture(ee.TEXTURE_2D,Ge),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MAG_FILTER,ee.LINEAR),Ye=ce.heatmapFbo=K.createFramebuffer(re.width/4,re.height/4,!1,!1),yt=Ge,Nt=Ye,At=(mn=K).gl,rn=null!=(rn=mn.HALF_FLOAT)?rn:At.UNSIGNED_BYTE,mn=null!=(mn=mn.RGBA16F)?mn:At.RGBA,At.texImage2D(At.TEXTURE_2D,0,mn,(bt=re).width/4,bt.height/4,0,At.RGBA,rn,null),Nt.colorAttachment.set(yt))}C.clear({color:h.Color.transparent});for(let Ye=0;Ye<x.length;Ye++){var he,Ee,Se,Oe,Ae,qe=x[Ye];d.hasRenderableParent(qe)||(Ee=(he=d.getTile(qe)).getBucket(_))&&(Se=Ee.programConfigurations.get(_.id),(Oe=A.useProgram("heatmap",Se)).draw(C,M.TRIANGLES,Ei.disabled,B,U,Do.disabled,(Oe=qe.posMatrix,qe=he,he=A.transform.zoom,Ae=_.paint.get("heatmap-intensity"),{u_matrix:Oe,u_extrude_scale:$n(qe,1,he),u_intensity:Ae}),null,_.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,_.paint,A.transform.zoom,Se))}C.viewport.set([0,0,A.width,A.height])}else if("translucent"===A.renderPass){A.context.setColorMode(A.colorModeForRenderPass()),re=(K=(ee=A).context).gl;var ee,K,Ge=(ce=_).heatmapFbo;if(Ge){K.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_2D,Ge.colorAttachment.get()),K.activeTexture.set(re.TEXTURE1);let Nt=ce.colorRampTexture;(Nt=Nt||(ce.colorRampTexture=new ot(K,ce.colorRamp,re.RGBA))).bind(re.LINEAR,re.CLAMP_TO_EDGE),ee.useProgram("heatmapTexture").draw(K,re.TRIANGLES,Ei.disabled,as.disabled,ee.colorModeForRenderPass(),Do.disabled,((M,d,_,x)=>{var C=h.create();return{u_matrix:C,u_world:[(h.ortho(C,0,M.width,M.height,0,0,1),M=M.context.gl).drawingBufferWidth,M.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:d.paint.get("heatmap-opacity")}})(ee,ce),null,ce.id,ee.viewportBuffer,ee.quadTriangleIndexBuffer,ee.viewportSegments,ce.paint,ee.transform.zoom)}}var mn,bt,yt,Nt,At,rn}(d,_,x,C);break;case"line":!function $N(A,d,_,x){if("translucent"===A.renderPass){var C=_.paint.get("line-opacity"),M=_.paint.get("line-width");if(0!==C.constantOr(1)&&0!==M.constantOr(1)){var B,U,K,re,ce,ee,he,Ee,Se,Oe,Ae=A.depthModeForSublayer(0,Ei.ReadOnly),qe=A.colorModeForRenderPass(),Ge=_.paint.get("line-dasharray"),Ye=_.paint.get("line-pattern"),_t=Ye.constantOr(1),bt=_.paint.get("line-gradient"),yt=_.getCrossfadeParameters(),Nt=_t?"linePattern":Ge?"lineSDF":bt?"lineGradient":"line",At=A.context,rn=At.gl;let ho=!0;for(const ui of x){var mn=d.getTile(ui);if(!_t||mn.patternsLoaded()){var Fn=mn.getBucket(_);if(Fn){var er,ur,Un=Fn.programConfigurations.get(_.id),qn=A.context.program.get(),sn=A.useProgram(Nt,Un),Dr=(qn=ho||sn.program!==qn,A.style.map.terrain&&A.style.map.terrain.getTerrainData(ui)),An=((An=Ye.constantOr(null))&&mn.imageAtlas&&(er=(ur=mn.imageAtlas).patternPositions[An.to.toString()],ur=ur.patternPositions[An.from.toString()],er)&&ur&&Un.setConstantPatternPositions(er,ur),Dr?ui:null),xi=_t?(ur=_,he=yt,Ee=An,Oe=Se=void 0,Oe=fD(er=mn,Se=(ee=A).transform),{u_matrix:UN(ee,er,ur,Ee),u_texsize:er.imageAtlasTexture.size,u_ratio:1/$n(er,1,Se.zoom),u_device_pixel_ratio:ee.pixelRatio,u_image:0,u_scale:[Oe,he.fromScale,he.toScale],u_fade:he.t,u_units_to_pixels:[1/Se.pixelsToGLUnits[0],1/Se.pixelsToGLUnits[1]]}):Ge?(ee=_,Oe=Ge,he=yt,Se=An,ce=re=xi=re=U=K=U=void 0,U=(B=A).transform,K=B.lineAtlas,U=fD(Ee=mn,U),re="round"===ee.layout.get("line-cap"),xi=K.getDash(Oe.from,re),Oe=K.getDash(Oe.to,re),re=xi.width*he.fromScale,ce=Oe.width*he.toScale,h.extend(x_(B,Ee,ee,Se),{u_patternscale_a:[U/re,-xi.height/2],u_patternscale_b:[U/ce,-Oe.height/2],u_sdfgamma:K.width/(256*Math.min(re,ce)*B.pixelRatio)/2,u_image:0,u_tex_y_a:xi.y,u_tex_y_b:Oe.y,u_mix:he.t})):bt?(ce=Fn.lineClipsArray.length,h.extend(x_(U=A,K=mn,re=_,B=An),{u_image:0,u_image_height:ce})):x_(A,mn,_,An);if(_t)At.activeTexture.set(rn.TEXTURE0),mn.imageAtlasTexture.bind(rn.LINEAR,rn.CLAMP_TO_EDGE),Un.updatePaintBuffers(yt);else if(Ge&&(qn||A.lineAtlas.dirty))At.activeTexture.set(rn.TEXTURE0),A.lineAtlas.bind(At);else if(bt){let Ti=(An=Fn.gradients[_.id]).texture;if(_.gradientVersion!==An.version){let Br=256;_.stepInterpolant&&(mn=d.getSource().maxzoom,qn=ui.canonical.z===mn?Math.ceil(1<<A.transform.maxZoom-ui.canonical.z):1,Br=h.clamp(h.nextPowerOfTwo(1024*(mn=Fn.maxLineLength/h.EXTENT)*qn),256,At.maxTextureSize)),An.gradient=h.renderColorRamp({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:Br,image:An.gradient||void 0,clips:Fn.lineClipsArray}),An.texture?An.texture.update(An.gradient):An.texture=new ot(At,An.gradient,rn.RGBA),An.version=_.gradientVersion,Ti=An.texture}At.activeTexture.set(rn.TEXTURE0),Ti.bind(_.stepInterpolant?rn.NEAREST:rn.LINEAR,rn.CLAMP_TO_EDGE)}sn.draw(At,rn.TRIANGLES,Ae,A.stencilModeForClipping(ui),qe,Do.disabled,xi,Dr,_.id,Fn.layoutVertexBuffer,Fn.indexBuffer,Fn.segments,_.paint,A.transform.zoom,Un,Fn.layoutVertexBuffer2),ho=!1}}}}}}(d,_,x,C);break;case"fill":!function R_(A,d,_,x){var C,M,B=_.paint.get("fill-color"),U=_.paint.get("fill-opacity");0!==U.constantOr(1)&&(C=A.colorModeForRenderPass(),M=_.paint.get("fill-pattern"),M=A.opaquePassEnabledForLayer()&&!M.constantOr(1)&&1===B.constantOr(h.Color.transparent).a&&1===U.constantOr(0)?"opaque":"translucent",A.renderPass===M&&(B=A.depthModeForSublayer(1,"opaque"===A.renderPass?Ei.ReadWrite:Ei.ReadOnly),qN(A,d,_,x,B,C,!1)),"translucent"===A.renderPass)&&_.paint.get("fill-antialias")&&(U=A.depthModeForSublayer(_.getPaintProperty("fill-outline-color")?2:0,Ei.ReadOnly),qN(A,d,_,x,U,C,!0))}(d,_,x,C);break;case"fill-extrusion":!function GN(A,d,_,x){var C,M=_.paint.get("fill-extrusion-opacity");0!==M&&"translucent"===A.renderPass&&(C=new Ei(A.context.gl.LEQUAL,Ei.ReadWrite,A.depthRangeFor3D),1!==M||_.paint.get("fill-extrusion-pattern").constantOr(1)?(Ts(A,d,_,x,C,as.disabled,ss.disabled),Ts(A,d,_,x,C,A.stencilModeFor3D(),A.colorModeForRenderPass())):(M=A.colorModeForRenderPass(),Ts(A,d,_,x,C,as.disabled,M)))}(d,_,x,C);break;case"hillshade":!function Ko(A,d,_,x){if("offscreen"===A.renderPass||"translucent"===A.renderPass){var C=A.context,M=A.depthModeForSublayer(0,Ei.ReadOnly),B=A.colorModeForRenderPass(),[U,x]="translucent"===A.renderPass?A.stencilConfigForOverlap(x):[{},x];for(const yt of x){var K=d.getTile(yt);if(void 0!==K.needsHillshadePrepare&&K.needsHillshadePrepare&&"offscreen"===A.renderPass){_t=Ye=Ge=qe=Ae=Oe=Se=Ee=he=ee=ce=re=void 0;var re=A,ce=K,ee=_,he=M,Ee=as.disabled,Se=B,Oe=re.context,Ae=Oe.gl,qe=ce.dem;if(qe&&qe.data){var Ge=qe.dim,Ye=qe.stride,_t=qe.getPixels();Oe.activeTexture.set(Ae.TEXTURE1),Oe.pixelStoreUnpackPremultiplyAlpha.set(!1),ce.demTexture=ce.demTexture||re.getTileTexture(Ye),(ce.demTexture?((Ye=ce.demTexture).update(_t,{premultiply:!1}),Ye):(ce.demTexture=new ot(Oe,_t,Ae.RGBA,{premultiply:!1}),ce.demTexture)).bind(Ae.NEAREST,Ae.CLAMP_TO_EDGE),Oe.activeTexture.set(Ae.TEXTURE0);let Nt=ce.fbo;Nt||((Ye=new ot(Oe,{width:Ge,height:Ge,data:null},Ae.RGBA)).bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),(Nt=ce.fbo=Oe.createFramebuffer(Ge,Ge,!0,!1)).colorAttachment.set(Ye.texture)),Oe.bindFramebuffer.set(Nt.framebuffer),Oe.viewport.set([0,0,Ge,Ge]),re.useProgram("hillshadePrepare").draw(Oe,Ae.TRIANGLES,he,Ee,Se,Do.disabled,Ed(ce.tileID,qe),null,ee.id,re.rasterBoundsBuffer,re.quadTriangleIndexBuffer,re.rasterBoundsSegments),ce.needsHillshadePrepare=!1}}else"translucent"===A.renderPass&&(Ye=yt,Oe=_,Ae=M,he=U[yt.overscaledZ],Ee=B,ce=re=ee=qe=Se=void 0,qe=(Se=(_t=A).context).gl,ee=(Ge=K).fbo)&&(re=_t.useProgram("hillshade"),ce=_t.style.map.terrain&&_t.style.map.terrain.getTerrainData(Ye),Se.activeTexture.set(qe.TEXTURE0),qe.bindTexture(qe.TEXTURE_2D,ee.colorAttachment.get()),re.draw(Se,qe.TRIANGLES,Ae,he,Ee,Do.disabled,iT(_t,Ge,Oe,ee=ce?Ye:null),ce,Oe.id,_t.rasterBoundsBuffer,_t.quadTriangleIndexBuffer,_t.rasterBoundsSegments))}C.viewport.set([0,0,A.width,A.height])}}(d,_,x,C);break;case"raster":!function lu(A,d,_,x){if("translucent"===A.renderPass&&0!==_.paint.get("raster-opacity")&&x.length){var C=A.context,M=C.gl,B=d.getSource(),U=A.useProgram("raster"),K=A.colorModeForRenderPass(),[re,x]=B instanceof X?[{},x]:A.stencilConfigForOverlap(x),ce=x[x.length-1].overscaledZ,ee=!A.options.moving;for(const Ge of x){var he=A.depthModeForSublayer(Ge.overscaledZ-ce,1===_.paint.get("raster-opacity")?Ei.ReadWrite:Ei.ReadOnly,M.LESS),Se=((Ae=d.getTile(Ge)).registerFadeDuration(_.paint.get("raster-fade-duration")),d.findLoadedParent(Ge,0)),Ee=(bt=Ae,yt=Se,Nt=d,rn=A.transform,mn=A.style.map.terrain,Fn=void 0,At=(At=_).paint.get("raster-fade-duration"),!mn&&0<At?(Fn=((mn=P.now())-bt.timeAdded)/At,mn=yt?(mn-yt.timeAdded)/At:-1,At=Nt.getSource(),Nt=rn.coveringZoomLevel({tileSize:At.tileSize,roundZoom:At.roundZoom}),At=(rn=!yt||Math.abs(yt.tileID.overscaledZ-Nt)>Math.abs(bt.tileID.overscaledZ-Nt))&&bt.refreshedUponExpiration?1:h.clamp(rn?Fn:1-mn,0,1),bt.refreshedUponExpiration&&1<=Fn&&(bt.refreshedUponExpiration=!1),yt?{opacity:1,mix:1-At}:{opacity:At,mix:0}):{opacity:1,mix:0});let Ye,_t;var Oe="nearest"===_.paint.get("raster-resampling")?M.NEAREST:M.LINEAR,Ae=(C.activeTexture.set(M.TEXTURE0),Ae.texture.bind(Oe,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),C.activeTexture.set(M.TEXTURE1),Se?(Se.texture.bind(Oe,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),Ye=Math.pow(2,Se.tileID.overscaledZ-Ae.tileID.overscaledZ),_t=[Ae.tileID.canonical.x*Ye%1,Ae.tileID.canonical.y*Ye%1]):Ae.texture.bind(Oe,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),Oe=(Ae=(Se=A.style.map.terrain&&A.style.map.terrain.getTerrainData(Ge))?Ge:null)?Ae.posMatrix:A.transform.calculatePosMatrix(Ge.toUnwrapped(),ee),Ag(Oe,_t||[0,0],Ye||1,Ee,_));B instanceof X?U.draw(C,M.TRIANGLES,he,as.disabled,K,Do.disabled,Ae,Se,_.id,B.boundsBuffer,A.quadTriangleIndexBuffer,B.boundsSegments):U.draw(C,M.TRIANGLES,he,re[Ge.overscaledZ],K,Do.disabled,Ae,Se,_.id,A.rasterBoundsBuffer,A.quadTriangleIndexBuffer,A.rasterBoundsSegments)}}var bt,yt,Nt,At,rn,mn,Fn}(d,_,x,C);break;case"background":!function Og(A,d,_,x){var C=_.paint.get("background-color"),M=_.paint.get("background-opacity");if(0!==M){var B=A.context,U=B.gl,K=A.transform,re=K.tileSize,ce=_.paint.get("background-pattern");if(!A.isPatternMissing(ce)){var ee=!ce&&1===C.a&&1===M&&A.opaquePassEnabledForLayer()?"opaque":"translucent";if(A.renderPass===ee){var he=as.disabled,Ee=A.depthModeForSublayer(0,"opaque"==ee?Ei.ReadWrite:Ei.ReadOnly),Se=A.colorModeForRenderPass(),Oe=A.useProgram(ce?"backgroundPattern":"background"),Ae=(ee=x||K.coveringTiles({tileSize:re,terrain:A.style.map.terrain}),ce&&(B.activeTexture.set(U.TEXTURE0),A.imageManager.bind(A.context)),_.getCrossfadeParameters());for(const _t of ee){var qe=x?_t.posMatrix:A.transform.calculatePosMatrix(_t.toUnwrapped()),Ge=(qe=ce?mw(qe,M,A,ce,{tileID:_t,tileSize:re},Ae):{u_matrix:qe,u_opacity:M,u_color:C},A.style.map.terrain&&A.style.map.terrain.getTerrainData(_t));Oe.draw(B,U.TRIANGLES,Ee,he,Se,Do.disabled,qe,Ge,_.id,A.tileExtentBuffer,A.quadTriangleIndexBuffer,A.tileExtentSegments)}}}}}(d,0,x,C);break;case"custom":!function O_(A,d,M){var x,C=A.context;M=M.implementation,"offscreen"===A.renderPass?(x=M.prerender)&&(A.setCustomLayerDefaults(),C.setColorMode(A.colorModeForRenderPass()),x.call(M,C.gl,A.transform.customLayerMatrix()),C.setDirty(),A.setBaseState()):"translucent"===A.renderPass&&(A.setCustomLayerDefaults(),C.setColorMode(A.colorModeForRenderPass()),C.setStencilMode(as.disabled),x="3d"===M.renderingMode?new Ei(A.context.gl.LEQUAL,Ei.ReadWrite,A.depthRangeFor3D):A.depthModeForSublayer(0,Ei.ReadOnly),C.setDepthMode(x),M.render(C.gl,A.transform.customLayerMatrix()),C.setDirty(),A.setBaseState(),C.bindFramebuffer.set(null))}(d,0,x)}}translatePosMatrix(d,_,x,C,M){var B;return x[0]||x[1]?((C=M?"map"===C?this.transform.angle:0:"viewport"===C?-this.transform.angle:0)&&(B=Math.sin(C),C=Math.cos(C),x=[x[0]*C-x[1]*B,x[0]*B+x[1]*C]),B=[M?x[0]:$n(_,x[0],this.transform.zoom),M?x[1]:$n(_,x[1],this.transform.zoom),0],C=new Float32Array(16),h.translate(C,d,B),C):d}saveTileTexture(d){var _=this._tileTextures[d.size[0]];_?_.push(d):this._tileTextures[d.size[0]]=[d]}getTileTexture(d){return(d=this._tileTextures[d])&&0<d.length?d.pop():null}isPatternMissing(d){var _;return!(!d||d.from&&d.to&&(_=this.imageManager.getPattern(d.from.toString()),d=this.imageManager.getPattern(d.to.toString()),_)&&d)}useProgram(d,_){this.cache=this.cache||{};var x=d+(_?_.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[x]||(this.cache[x]=new rT(this.context,bd[d],_,oT[d],this._showOverdrawInspector,this.style.map.terrain)),this.cache[x]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){var d=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(d.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ot(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){var{drawingBufferWidth:d,drawingBufferHeight:_}=this.context.gl;return this.width!==d||this.height!==_}}class mT{constructor(d,_){this.points=d,this.planes=_}static fromInvProjectionMatrix(d,_,x){const C=Math.pow(2,x),M=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(B=>{var U=1/(B=h.transformMat4([],B,d))[3]/_*C;return h.mul$1(B,B,[U,U,1/B[3],U])});return x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(B=>{var U=h.sub([],M[B[0]],M[B[1]]),K=h.sub([],M[B[2]],M[B[1]]);return U=h.normalize([],h.cross([],U,K)),K=-h.dot(U,M[B[1]]),U.concat(K)}),new mT(M,x)}}class Dp{constructor(d,_){this.min=d,this.max=_,this.center=h.scale$1([],h.add([],this.min,this.max),.5)}quadrant(d){var _=[d%2==0,d<2],x=h.clone$2(this.min),C=h.clone$2(this.max);for(let M=0;M<_.length;M++)x[M]=(_[M]?this.min:this.center)[M],C[M]=(_[M]?this.center:this.max)[M];return C[2]=this.max[2],new Dp(x,C)}distanceX(d){return Math.max(Math.min(this.max[0],d[0]),this.min[0])-d[0]}distanceY(d){return Math.max(Math.min(this.max[1],d[1]),this.min[1])-d[1]}intersects(d){var _=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let x=!0;for(let B=0;B<d.planes.length;B++){var C=d.planes[B];let U=0;for(let K=0;K<_.length;K++)0<=h.dot$1(C,_[K])&&U++;if(0===U)return 0;U!==_.length&&(x=!1)}if(x)return 2;for(let B=0;B<3;B++){let U=Number.MAX_VALUE,K=-Number.MAX_VALUE;for(let re=0;re<d.points.length;re++){var M=d.points[re][B]-this.min[B];U=Math.min(U,M),K=Math.max(K,M)}if(K<0||U>this.max[B]-this.min[B])return 0}return 1}}class N_{constructor(d=0,_=0,x=0,C=0){if(isNaN(d)||d<0||isNaN(_)||_<0||isNaN(x)||x<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=d,this.bottom=_,this.left=x,this.right=C}interpolate(d,_,x){return null!=_.top&&null!=d.top&&(this.top=h.interpolate.number(d.top,_.top,x)),null!=_.bottom&&null!=d.bottom&&(this.bottom=h.interpolate.number(d.bottom,_.bottom,x)),null!=_.left&&null!=d.left&&(this.left=h.interpolate.number(d.left,_.left,x)),null!=_.right&&null!=d.right&&(this.right=h.interpolate.number(d.right,_.right,x)),this}getCenter(d,_){return d=h.clamp((this.left+d-this.right)/2,0,d),_=h.clamp((this.top+_-this.bottom)/2,0,_),new h.Point(d,_)}equals(d){return this.top===d.top&&this.bottom===d.bottom&&this.left===d.left&&this.right===d.right}clone(){return new N_(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const kc=85.051129;class cu{constructor(d,_,x,C,M){this.tileSize=512,this._renderWorldCopies=void 0===M||!!M,this._minZoom=d||0,this._maxZoom=_||22,this._minPitch=x??0,this._maxPitch=C??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new h.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new N_,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){var d=new cu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return d.apply(this),d}apply(d){this.tileSize=d.tileSize,this.latRange=d.latRange,this.width=d.width,this.height=d.height,this._center=d._center,this._elevation=d._elevation,this.minElevationForCurrentTile=d.minElevationForCurrentTile,this.zoom=d.zoom,this.angle=d.angle,this._fov=d._fov,this._pitch=d._pitch,this._unmodified=d._unmodified,this._edgeInsets=d._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(d){this._minZoom!==d&&(this._minZoom=d,this.zoom=Math.max(this.zoom,d))}get maxZoom(){return this._maxZoom}set maxZoom(d){this._maxZoom!==d&&(this._maxZoom=d,this.zoom=Math.min(this.zoom,d))}get minPitch(){return this._minPitch}set minPitch(d){this._minPitch!==d&&(this._minPitch=d,this.pitch=Math.max(this.pitch,d))}get maxPitch(){return this._maxPitch}set maxPitch(d){this._maxPitch!==d&&(this._maxPitch=d,this.pitch=Math.min(this.pitch,d))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(d){void 0===d?d=!0:null===d&&(d=!1),this._renderWorldCopies=d}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(d){d=-h.wrap(d,-180,180)*Math.PI/180,this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=h.create$2(),h.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(d){d=h.clamp(d,this.minPitch,this.maxPitch)/180*Math.PI,this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(d){d=Math.max(.01,Math.min(60,d)),this._fov!==d&&(this._unmodified=!1,this._fov=d/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(d){d=Math.min(Math.max(d,this.minZoom),this.maxZoom),this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(d){d.lat===this._center.lat&&d.lng===this._center.lng||(this._unmodified=!1,this._center=d,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(d){d!==this._elevation&&(this._elevation=d,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(d){this._edgeInsets.equals(d)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,d,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(d){return this._edgeInsets.equals(d)}interpolatePadding(d,_,x){this._unmodified=!1,this._edgeInsets.interpolate(d,_,x),this._constrain(),this._calcMatrices()}coveringZoomLevel(d){return d=(d.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/d.tileSize)),Math.max(0,d)}getVisibleUnwrappedCoordinates(d){var _=[new h.UnwrappedTileID(0,d)];if(this._renderWorldCopies){var x=this.pointCoordinate(new h.Point(0,0)),C=this.pointCoordinate(new h.Point(this.width,0)),M=this.pointCoordinate(new h.Point(this.width,this.height)),B=this.pointCoordinate(new h.Point(0,this.height)),U=Math.floor(Math.min(x.x,C.x,M.x,B.x)),K=Math.floor(Math.max(x.x,C.x,M.x,B.x));for(let re=U-1;re<=K+1;re++)0!==re&&_.push(new h.UnwrappedTileID(re,d))}return _}coveringTiles(d){let _=this.coveringZoomLevel(d);var x=_;if(void 0!==d.minzoom&&_<d.minzoom)return[];void 0!==d.maxzoom&&_>d.maxzoom&&(_=d.maxzoom);var C=this.pointCoordinate(this.getCameraPoint()),M=h.MercatorCoordinate.fromLngLat(this.center);const B=Math.pow(2,_);var U=[B*C.x,B*C.y,0],K=[B*M.x,B*M.y,0],re=mT.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_);let ce=d.minzoom||0;!d.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ce=_);var ee=d.terrain?2/Math.min(this.tileSize,d.tileSize)*this.tileSize:3,he=er=>({aabb:new Dp([er*B,0,0],[(er+1)*B,B,0]),zoom:0,x:0,y:0,wrap:er,fullyVisible:!1}),Ee=[],Se=[],Oe=_,Ae=d.reparseOverscaled?x:_;if(this._renderWorldCopies)for(let er=1;er<=3;er++)Ee.push(he(-er)),Ee.push(he(er));for(Ee.push(he(0));0<Ee.length;){var qe=Ee.pop(),Ge=qe.x,Ye=qe.y;let er=qe.fullyVisible;if(!er){if(0===(_t=qe.aabb.intersects(re)))continue;er=2===_t}var _t,bt=qe.aabb.distanceX(_t=d.terrain?U:K),yt=qe.aabb.distanceY(_t);if(bt=Math.max(Math.abs(bt),Math.abs(yt)),yt=ee+(1<<Oe-qe.zoom)-2,qe.zoom===Oe||yt<bt&&qe.zoom>=ce)bt=U[0]-.5-(Ge<<(yt=Oe-qe.zoom)),yt=U[1]-.5-(Ye<<yt),Se.push({tileID:new h.OverscaledTileID(qe.zoom===Oe?Ae:qe.zoom,qe.wrap,qe.zoom,Ge,Ye),distanceSq:h.sqrLen([K[0]-.5-Ge,K[1]-.5-Ye]),tileDistanceToCamera:Math.sqrt(bt*bt+yt*yt)});else for(let ur=0;ur<4;ur++){var Nt,At,rn=(Ge<<1)+ur%2,mn=(Ye<<1)+(ur>>1),Fn=qe.zoom+1;let Un=qe.aabb.quadrant(ur);d.terrain&&(At=new h.OverscaledTileID(Fn,qe.wrap,Fn,rn,mn),Nt=null!=(Nt=(At=d.terrain.getMinMaxElevation(At)).minElevation)?Nt:this.elevation,At=null!=(At=At.maxElevation)?At:this.elevation,Un=new Dp([Un.min[0],Un.min[1],Nt],[Un.max[0],Un.max[1],At])),Ee.push({aabb:Un,zoom:Fn,x:rn,y:mn,wrap:qe.wrap,fullyVisible:er})}}return Se.sort((er,ur)=>er.distanceSq-ur.distanceSq).map(er=>er.tileID)}resize(d,_){this.width=d,this.height=_,this.pixelsToGLUnits=[2/d,-2/_],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(d){return Math.pow(2,d)}scaleZoom(d){return Math.log(d)/Math.LN2}project(d){var _=h.clamp(d.lat,-kc,kc);return new h.Point(h.mercatorXfromLng(d.lng)*this.worldSize,h.mercatorYfromLat(_)*this.worldSize)}unproject(d){return new h.MercatorCoordinate(d.x/this.worldSize,d.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(M){var _=this.elevation,x=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,C=this.pointLocation(this.centerPoint,M);M=M.getElevationForLngLatZoom(C,this.tileZoom),this.elevation-M&&(x=x+_-M,_=Math.cos(this._pitch)*this.cameraToCenterDistance/x/h.mercatorZfromAltitude(1,C.lat)/this.tileSize,x=this.scaleZoom(_),this._elevation=M,this._center=C,this.zoom=x)}setLocationAtPoint(M,x){x=this.pointCoordinate(x);var C=this.pointCoordinate(this.centerPoint);M=this.locationCoordinate(M),M=new h.MercatorCoordinate(M.x-(x.x-C.x),M.y-(x.y-C.y)),this.center=this.coordinateLocation(M),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(d,_){return _?this.coordinatePoint(this.locationCoordinate(d),_.getElevationForLngLatZoom(d,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(d))}pointLocation(d,_){return this.coordinateLocation(this.pointCoordinate(d,_))}locationCoordinate(d){return h.MercatorCoordinate.fromLngLat(d)}coordinateLocation(d){return d&&d.toLngLat()}pointCoordinate(C,x){if(x&&null!=(x=x.pointCoordinate(C)))return x;x=[C.x,C.y,0,1],C=[C.x,C.y,1,1];var ce,M=(h.transformMat4(x,x,this.pixelMatrixInverse),h.transformMat4(C,C,this.pixelMatrixInverse),x[3]),B=C[3],U=x[1]/M,K=C[1]/B,re=x[2]/M;return new h.MercatorCoordinate(h.interpolate.number(x[0]/M,C[0]/B,ce=re==(ce=C[2]/B)?0:(0-re)/(ce-re))/this.worldSize,h.interpolate.number(U,K,ce)/this.worldSize)}coordinatePoint(d,_=0,x=this.pixelMatrix){return h.transformMat4(d=[d.x*this.worldSize,d.y*this.worldSize,_,1],d,x),new h.Point(d[0]/d[3],d[1]/d[3])}getBounds(){var d=Math.max(0,this.height/2-this.getHorizon());return(new yn).extend(this.pointLocation(new h.Point(0,d))).extend(this.pointLocation(new h.Point(this.width,d))).extend(this.pointLocation(new h.Point(this.width,this.height))).extend(this.pointLocation(new h.Point(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new yn([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(d){d?(this.lngRange=[d.getWest(),d.getEast()],this.latRange=[d.getSouth(),d.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-kc,kc])}calculatePosMatrix(d,_=!1){var x,C,M,B=d.key,U=_?this._alignedPosMatrixCache:this._posMatrixCache;return U[B]||(C=this.worldSize/this.zoomScale((x=d.canonical).z),d=x.x+Math.pow(2,x.z)*d.wrap,M=h.identity(new Float64Array(16)),h.translate(M,M,[d*C,x.y*C,0]),h.scale(M,M,[C/h.EXTENT,C/h.EXTENT,1]),h.multiply(M,_?this.alignedProjMatrix:this.projMatrix,M),U[B]=new Float32Array(M)),U[B]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(Se,_){_=h.clamp(+_,this.minZoom,this.maxZoom),_={center:new h.LngLat(Se.lng,Se.lat),zoom:_};let x=this.lngRange;this._renderWorldCopies||null!==x||(x=[-(180-1e-10),180-1e-10]);var C=this.tileSize*this.zoomScale(_.zoom);let M=0,B=C,U=0,K=C,re=0,ce=0;var{x:ee,y:he}=this.size,{x:Ee,y:Se}=(this.latRange&&(M=h.mercatorYfromLat((Ee=this.latRange)[1])*C,(B=h.mercatorYfromLat(Ee[0])*C)-M<he)&&(re=he/(B-M)),x&&(U=h.wrap(h.mercatorXfromLng(x[0])*C,0,C),(K=h.wrap(h.mercatorXfromLng(x[1])*C,0,C))<U&&(K+=C),K-U<ee)&&(ce=ee/(K-U)),this.project.call({worldSize:C},Se));let Oe,Ae;var qe,Ge=Math.max(ce||0,re||0);if(Ge)qe=new h.Point(ce?(K+U)/2:Ee,re?(B+M)/2:Se),_.center=this.unproject.call({worldSize:C},qe).wrap(),_.zoom+=this.scaleZoom(Ge);else{if(this.latRange&&(Se-(qe=he/2)<M&&(Ae=M+qe),Se+qe>B)&&(Ae=B-qe),x){Ge=(U+K)/2;let Ye=Ee;he=ee/2,(Ye=this._renderWorldCopies?h.wrap(Ee,Ge-C/2,Ge+C/2):Ye)-he<U&&(Oe=U+he),Ye+he>K&&(Oe=K-he)}void 0===Oe&&void 0===Ae||(qe=new h.Point(Oe??Ee,Ae??Se),_.center=this.unproject.call({worldSize:C},qe).wrap())}return _}_constrain(){var d,_,x;this.center&&this.width&&this.height&&!this._constraining&&(this._constraining=!0,d=this._unmodified,({center:_,zoom:x}=this.getConstrained(this.center,this.zoom)),this.center=_,this.zoom=x,this._unmodified=d,this._constraining=!1)}_calcMatrices(){if(this.height){var C=this._fov/2,M=this.centerOffset,B=this.point.x,U=this.point.y;this.cameraToCenterDistance=.5/Math.tan(C)*this.height,this._pixelPerMeter=h.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let K=h.identity(new Float64Array(16));h.scale(K,K,[this.width/2,-this.height/2,1]),h.translate(K,K,[1,-1,0]),this.labelPlaneMatrix=K,K=h.identity(new Float64Array(16)),h.scale(K,K,[1,-1,1]),h.translate(K,K,[-1,-1,0]),h.scale(K,K,[2/this.width,2/this.height,1]),this.glCoordMatrix=K;var x=(C=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch))-(_=Math.min(this.elevation,this.minElevationForCurrentTile))*this._pixelPerMeter/Math.cos(this._pitch),_=_<0?x:C,d=(x=Math.PI/2+this._pitch,C=this._fov*(.5+M.y/this.height),C=Math.sin(C)*_/Math.sin(h.clamp(Math.PI-x-C,.01,Math.PI-.01)),this.getHorizon());if(d=2*Math.atan(d/this.cameraToCenterDistance)*(.5+M.y/(2*d)),x=Math.sin(d)*_/Math.sin(h.clamp(Math.PI-x-d,.01,Math.PI-.01)),d=Math.min(C,x),C=1.01*(Math.cos(Math.PI/2-this._pitch)*d+_),x=this.height/50,K=new Float64Array(16),h.perspective(K,this._fov,this.width/this.height,x,C),K[8]=2*-M.x/this.width,K[9]=2*M.y/this.height,h.scale(K,K,[1,-1,1]),h.translate(K,K,[0,0,-this.cameraToCenterDistance]),h.rotateX(K,K,this._pitch),h.rotateZ(K,K,this.angle),h.translate(K,K,[-B,-U,0]),this.mercatorMatrix=h.scale([],K,[this.worldSize,this.worldSize,this.worldSize]),h.scale(K,K,[1,1,this._pixelPerMeter]),this.pixelMatrix=h.multiply(new Float64Array(16),this.labelPlaneMatrix,K),h.translate(K,K,[0,0,-this.elevation]),this.projMatrix=K,this.invProjMatrix=h.invert([],K),this.pixelMatrix3D=h.multiply(new Float64Array(16),this.labelPlaneMatrix,K),d=this.width%2/2,_=this.height%2/2,x=Math.cos(this.angle),C=Math.sin(this.angle),M=B-Math.round(B)+x*d+C*_,B=U-Math.round(U)+x*_+C*d,U=new Float64Array(K),h.translate(U,U,[.5<M?M-1:M,.5<B?B-1:B,0]),this.alignedProjMatrix=U,!(K=h.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=K,this._posMatrixCache={},this._alignedPosMatrixCache={}}}maxPitchScaleFactor(){var d;return this.pixelMatrixInverse?(d=[(d=this.pointCoordinate(new h.Point(0,0))).x*this.worldSize,d.y*this.worldSize,0,1],h.transformMat4(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance):1}getCameraPoint(){var d=this._pitch;return d=Math.tan(d)*(this.cameraToCenterDistance||1),this.centerPoint.add(new h.Point(0,d))}getCameraQueryGeometry(d){var _=this.getCameraPoint();if(1===d.length)return[d[0],_];{let x=_.x,C=_.y,M=_.x,B=_.y;for(const U of d)x=Math.min(x,U.x),C=Math.min(C,U.y),M=Math.max(M,U.x),B=Math.max(B,U.y);return[new h.Point(x,C),new h.Point(M,C),new h.Point(M,B),new h.Point(x,B),new h.Point(x,C)]}}lngLatToCameraDepth(d,_){return d=this.locationCoordinate(d),h.transformMat4(d=[d.x*this.worldSize,d.y*this.worldSize,_,1],d,this.projMatrix),d[2]/d[3]}}function SD(A,d){let C,M,_=!1,x=null;const B=()=>{x=null,_&&(A.apply(C,M),x=setTimeout(B,d),_=!1)};return(...U)=>(_=!0,C=this,M=U,x||B(),x)}class Yu{constructor(d){this._getCurrentHash=()=>{var _=window.location.hash.replace("#","");if(this._hashName){let x;return _.split("&").map(C=>C.split("=")).forEach(C=>{C[0]===this._hashName&&(x=C)}),(x&&x[1]||"").split("/")}return _.split("/")},this._onHashChange=()=>{var _,x=this._getCurrentHash();return 3<=x.length&&!x.some(C=>isNaN(C))&&(_=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(x[3]||0):this._map.getBearing(),this._map.jumpTo({center:[+x[2],+x[1]],zoom:+x[0],bearing:_,pitch:+(x[4]||0)}),!0)},this._updateHashUnthrottled=()=>{var _=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,_)}catch{}},this._updateHash=SD(this._updateHashUnthrottled,300),this._hashName=d&&encodeURIComponent(d)}addTo(d){return this._map=d,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(d){var C=this._map.getCenter(),_=Math.round(100*this._map.getZoom())/100,M=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=(M=Math.pow(10,M),Math.round(C.lng*M)/M),B=(C=Math.round(C.lat*M)/M,M=this._map.getBearing(),this._map.getPitch());let U="";if(U+=d?`/${x}/${C}/`+_:_+`/${C}/`+x,(M||B)&&(U+="/"+Math.round(10*M)/10),B&&(U+="/"+Math.round(B)),this._hashName){const K=this._hashName;let re=!1;return d=window.location.hash.slice(1).split("&").map(ce=>{var ee=ce.split("=")[0];return ee===K?(re=!0,ee+"="+U):ce}).filter(ce=>ce),re||d.push(K+"="+U),"#"+d.join("&")}return"#"+U}}fi={linearity:.3,easing:h.bezier(0,0,.3,1)};const Pp=h.extend({deceleration:2500,maxSpeed:1400},fi),AD=h.extend({deceleration:20,maxSpeed:1400},fi),_5=h.extend({deceleration:1e3,maxSpeed:360},fi),gT=h.extend({deceleration:1e3,maxSpeed:90},fi);class Aw{constructor(d){this._map=d,this.clear()}clear(){this._inertiaBuffer=[]}record(d){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:P.now(),settings:d})}_drainInertiaBuffer(){for(var d=this._inertiaBuffer,_=P.now();0<d.length&&160<_-d[0].time;)d.shift()}_onMoveEnd(d){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){var _,x={zoom:0,bearing:0,pitch:0,pan:new h.Point(0,0),pinchAround:void 0,around:void 0};for({settings:_}of this._inertiaBuffer)x.zoom+=_.zoomDelta||0,x.bearing+=_.bearingDelta||0,x.pitch+=_.pitchDelta||0,_.panDelta&&x.pan._add(_.panDelta),_.around&&(x.around=_.around),_.pinchAround&&(x.pinchAround=_.pinchAround);var C=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,M={};return x.pan.mag()&&(d=Cn(x.pan.mag(),C,h.extend({},Pp,d||{})),M.offset=x.pan.mult(d.amount/x.pan.mag()),M.center=this._map.transform.center,uu(M,d)),x.zoom&&(d=Cn(x.zoom,C,AD),M.zoom=this._map.transform.zoom+d.amount,uu(M,d)),x.bearing&&(d=Cn(x.bearing,C,_5),M.bearing=this._map.transform.bearing+h.clamp(d.amount,-179,179),uu(M,d)),x.pitch&&(d=Cn(x.pitch,C,gT),M.pitch=this._map.transform.pitch+d.amount,uu(M,d)),(M.zoom||M.bearing)&&(M.around=(C=void 0===x.pinchAround?x.around:x.pinchAround)?this._map.unproject(C):this._map.getCenter()),this.clear(),h.extend(M,{noMoveStart:!0})}}}function uu(A,d){(!A.duration||A.duration<d.duration)&&(A.duration=d.duration,A.easing=d.easing)}function Cn(B,U,_){var{maxSpeed:x,linearity:C,deceleration:M}=_;return B=h.clamp(B*C/(U/1e3),-x,x),U=Math.abs(B)/(M*C),{easing:_.easing,duration:1e3*U,amount:B*(U/2)}}class Sl extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,_,x,C={}){var M=N.mousePos(_.getCanvas(),x),B=_.unproject(M);super(d,h.extend({point:M,lngLat:B,originalEvent:x},C)),this._defaultPrevented=!1,this.target=_}}class Rp extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,_,x){var C="touchend"===d?x.changedTouches:x.touches,M=(C=N.touchPos(_.getCanvasContainer(),C)).map(U=>_.unproject(U)),B=C.reduce((U,K,re,ce)=>U.add(K.div(ce.length)),new h.Point(0,0));super(d,{points:C,point:B,lngLats:M,lngLat:_.unproject(B),originalEvent:x}),this._defaultPrevented=!1}}class Xf extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(d,_,x){super(d,{originalEvent:x}),this._defaultPrevented=!1}}class Dw{constructor(d,_){this._map=d,this._clickTolerance=_.clickTolerance}reset(){delete this._mousedownPos}wheel(d){return this._firePreventable(new Xf(d.type,this._map,d))}mousedown(d,_){return this._mousedownPos=_,this._firePreventable(new Sl(d.type,this._map,d))}mouseup(d){this._map.fire(new Sl(d.type,this._map,d))}click(d,_){this._mousedownPos&&this._mousedownPos.dist(_)>=this._clickTolerance||this._map.fire(new Sl(d.type,this._map,d))}dblclick(d){return this._firePreventable(new Sl(d.type,this._map,d))}mouseover(d){this._map.fire(new Sl(d.type,this._map,d))}mouseout(d){this._map.fire(new Sl(d.type,this._map,d))}touchstart(d){return this._firePreventable(new Rp(d.type,this._map,d))}touchmove(d){this._map.fire(new Rp(d.type,this._map,d))}touchend(d){this._map.fire(new Rp(d.type,this._map,d))}touchcancel(d){this._map.fire(new Rp(d.type,this._map,d))}_firePreventable(d){if(this._map.fire(d),d.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _n{constructor(d){this._map=d}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(d){this._map.fire(new Sl(d.type,this._map,d))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Sl("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(d){this._delayContextMenu?this._contextMenuEvent=d:this._ignoreContextMenu||this._map.fire(new Sl(d.type,this._map,d)),this._map.listens("contextmenu")&&d.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ng{constructor(d){this._map=d}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(d){return this.transform.pointLocation(h.Point.convert(d),this._map.terrain)}}class yT{constructor(d,_){this._map=d,this._tr=new Ng(d),this._el=d.getCanvasContainer(),this._container=d.getContainer(),this._clickTolerance=_.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(d,_){this.isEnabled()&&d.shiftKey&&0===d.button&&(N.disableDrag(),this._startPos=this._lastPos=_,this._active=!0)}mousemoveWindow(d,_){var x,C,M;!this._active||this._lastPos.equals(_)||!this._box&&_.dist(this._startPos)<this._clickTolerance||(M=this._startPos,this._lastPos=_,this._box||(this._box=N.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",d)),d=Math.min(M.x,_.x),x=Math.max(M.x,_.x),C=Math.min(M.y,_.y),M=Math.max(M.y,_.y),N.setTransform(this._box,`translate(${d}px,${C}px)`),this._box.style.width=x-d+"px",this._box.style.height=M-C+"px")}mouseupWindow(d,_){if(this._active&&0===d.button){const x=this._startPos,C=_;if(this.reset(),N.suppressClick(),x.x!==C.x||x.y!==C.y)return this._map.fire(new h.Event("boxzoomend",{originalEvent:d})),{cameraAnimation:M=>M.fitScreenCoordinates(x,C,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",d)}}keydown(d){this._active&&27===d.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",d))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(N.remove(this._box),this._box=null),N.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(d,_){return this._map.fire(new h.Event(d,{originalEvent:_}))}}function Pw(A,d){if(A.length!==d.length)throw new Error(`The number of touches and points are not equal - touches ${A.length}, points `+d.length);var _={};for(let x=0;x<A.length;x++)_[A[x].identifier]=d[x];return _}class YN{constructor(d){this.reset(),this.numTouches=d.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(d,_,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=d.timeStamp),x.length===this.numTouches&&(this.centroid=function _T(A){var d=new h.Point(0,0);for(const _ of A)d._add(_);return d.div(A.length)}(_),this.touches=Pw(x,_)))}touchmove(d,_,x){if(!this.aborted&&this.centroid){var C=Pw(x,_);for(const U in this.touches){var B=C[U];(!B||30<B.dist(this.touches[U]))&&(this.aborted=!0)}}}touchend(d,_,x){if((!this.centroid||500<d.timeStamp-this.startTime)&&(this.aborted=!0),0===x.length&&(d=!this.aborted&&this.centroid,this.reset(),d))return d}}class Rw{constructor(d){this.singleTap=new YN(d),this.numTaps=d.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(d,_,x){this.singleTap.touchstart(d,_,x)}touchmove(d,_,x){this.singleTap.touchmove(d,_,x)}touchend(d,_,x){if(_=this.singleTap.touchend(d,_,x)){x=d.timeStamp-this.lastTime<500;var C=!this.lastTap||this.lastTap.dist(_)<30;if(x&&C||this.reset(),this.count++,this.lastTime=d.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class Lg{constructor(d){this._tr=new Ng(d),this._zoomIn=new Rw({numTouches:1,numTaps:2}),this._zoomOut=new Rw({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(d,_,x){this._zoomIn.touchstart(d,_,x),this._zoomOut.touchstart(d,_,x)}touchmove(d,_,x){this._zoomIn.touchmove(d,_,x),this._zoomOut.touchmove(d,_,x)}touchend(d,_,x){const C=this._zoomIn.touchend(d,_,x),M=this._zoomOut.touchend(d,_,x),B=this._tr;return C?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:U=>U.easeTo({duration:300,zoom:B.zoom+1,around:B.unproject(C)},{originalEvent:d})}):M?(this._active=!0,d.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:U=>U.easeTo({duration:300,zoom:B.zoom-1,around:B.unproject(M)},{originalEvent:d})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class uo{constructor(d){this._enabled=!!d.enable,this._moveStateManager=d.moveStateManager,this._clickTolerance=d.clickTolerance||1,this._moveFunction=d.move,this._activateOnStart=!!d.activateOnStart,d.assignEvents(this),this.reset()}reset(d){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(d)}_move(...d){if((d=this._moveFunction(...d)).bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(d,_){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(d)&&(this._moveStateManager.startMove(d),this._lastPoint=_.length?_[0]:_,this._activateOnStart)&&this._lastPoint&&(this._active=!0)}dragMove(d,_){if(this.isEnabled()){var x=this._lastPoint;if(x)if(d.preventDefault(),this._moveStateManager.isValidMoveEvent(d)){if(_=_.length?_[0]:_,this._moved||!(_.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=_,this._move(x,_)}else this.reset(d)}}dragEnd(d){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(d)&&(this._moved&&N.suppressClick(),this.reset(d))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const vT={0:1,2:2};class wT{constructor(d){this._correctEvent=d.checkCorrectEvent}startMove(d){d=N.mouseButton(d),this._eventButton=d}endMove(d){delete this._eventButton}isValidStartEvent(d){return this._correctEvent(d)}isValidMoveEvent(d){return!function Mw(A,d){return d=vT[d],void 0===A.buttons||(A.buttons&d)!==d}(d,this._eventButton)}isValidEndEvent(d){return N.mouseButton(d)===this._eventButton}}class kw{constructor(){this._firstTouch=void 0}_isOneFingerTouch(d){return 1===d.targetTouches.length}_isSameTouchEvent(d){return d.targetTouches[0].identifier===this._firstTouch}startMove(d){this._firstTouch=d=d.targetTouches[0].identifier}endMove(d){delete this._firstTouch}isValidStartEvent(d){return this._isOneFingerTouch(d)}isValidMoveEvent(d){return this._isOneFingerTouch(d)&&this._isSameTouchEvent(d)}isValidEndEvent(d){return this._isOneFingerTouch(d)&&this._isSameTouchEvent(d)}}const L_=A=>{A.mousedown=A.dragStart,A.mousemoveWindow=A.dragMove,A.mouseup=A.dragEnd,A.contextmenu=function(d){d.preventDefault()}},Oc=({enable:A,clickTolerance:d,bearingDegreesPerPixelMoved:_=.8})=>{var x=new wT({checkCorrectEvent:C=>0===N.mouseButton(C)&&C.ctrlKey||2===N.mouseButton(C)});return new uo({clickTolerance:d,move:(C,M)=>({bearingDelta:(M.x-C.x)*_}),moveStateManager:x,enable:A,assignEvents:L_})},Ow=({enable:A,clickTolerance:d,pitchDegreesPerPixelMoved:_=-.5})=>{var x=new wT({checkCorrectEvent:C=>0===N.mouseButton(C)&&C.ctrlKey||2===N.mouseButton(C)});return new uo({clickTolerance:d,move:(C,M)=>({pitchDelta:(M.y-C.y)*_}),moveStateManager:x,enable:A,assignEvents:L_})};class Bn{constructor(d,_){this._clickTolerance=d.clickTolerance||1,this._map=_,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new h.Point(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(d,_,x){return this._calculateTransform(d,_,x)}touchmove(d,_,x){if(this._active&&!(x.length<this.minTouchs()))return d.preventDefault(),this._calculateTransform(d,_,x)}touchend(d,_,x){this._calculateTransform(d,_,x),this._active&&x.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(d,_,x){0<x.length&&(this._active=!0);var C=Pw(x,_),M=new h.Point(0,0),B=new h.Point(0,0);let U=0;for(const ce in C){var K=C[ce],re=this._touches[ce];re&&(M._add(K),B._add(K.sub(re)),U++,C[ce]=K)}if(this._touches=C,!(U<this.minTouchs())&&B.mag()&&(x=B.div(U),this._sum._add(x),!(this._sum.mag()<this._clickTolerance)))return{around:M.div(U),panDelta:x}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pr{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(d,_,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([_[0],_[1]]))}touchmove(d,_,x){if(this._firstTwoTouches){d.preventDefault();var[M,C]=this._firstTwoTouches,M=kp(x,_,M);if(x=kp(x,_,C),M&&x)return _=this._aroundCenter?null:M.add(x).div(2),this._move([M,x],_,d)}}touchend(d,_,x){var C,M;this._firstTwoTouches&&([M,C]=this._firstTwoTouches,M=kp(x,_,M),x=kp(x,_,C),M&&x||(this._active&&N.suppressClick(),this.reset()))}touchcancel(){this.reset()}enable(d){this._enabled=!0,this._aroundCenter=!!d&&"center"===d.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function kp(A,d,_){for(let x=0;x<A.length;x++)if(A[x].identifier===_)return d[x]}function bT(A,d){return Math.log(A/d)/Math.LN2}class F_ extends pr{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(d){this._startDistance=this._distance=d[0].dist(d[1])}_move(d,_){var x=this._distance;if(this._distance=d[0].dist(d[1]),this._active||!(Math.abs(bT(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:bT(this._distance,x),pinchAround:_}}}function cc(A,d){return 180*A.angleWith(d)/Math.PI}class Fg extends pr{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(d){this._startVector=this._vector=d[0].sub(d[1]),this._minDiameter=d[0].dist(d[1])}_move(d,_,x){var C=this._vector;if(this._vector=d[0].sub(d[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:cc(this._vector,C),pinchAround:_}}_isBelowThreshold(x){this._minDiameter=Math.min(this._minDiameter,x.mag());var _=25/(Math.PI*this._minDiameter)*360;return x=cc(x,this._startVector),Math.abs(x)<_}}function Zu(A){return Math.abs(A.y)>Math.abs(A.x)}class ZN extends pr{constructor(d){super(),this._currentTouchCount=0,this._map=d}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(d,_,x){super.touchstart(d,_,x),this._currentTouchCount=x.length}_start(d){Zu((this._lastPoints=d)[0].sub(d[1]))&&(this._valid=!1)}_move(d,_,x){if(!(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)){var C=d[0].sub(this._lastPoints[0]),M=d[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(C,M,x.timeStamp),this._valid)return this._lastPoints=d,this._active=!0,{pitchDelta:(C.y+M.y)/2*-.5}}}gestureBeginsVertically(d,_,x){var C,M;return void 0!==this._valid?this._valid:(M=2<=d.mag(),C=2<=_.mag(),M||C?M&&C?(M=0<d.y==0<_.y,Zu(d)&&Zu(_)&&M):(void 0===this._firstMove&&(this._firstMove=x),x-this._firstMove<100&&void 0):void 0)}}const Vg={panStep:100,bearingStep:15,pitchStep:10};class No{constructor(d){this._tr=new Ng(d),this._panStep=(d=Vg).panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(d){if(!(d.altKey||d.ctrlKey||d.metaKey)){let _=0,x=0,C=0,M=0,B=0;switch(d.keyCode){case 61:case 107:case 171:case 187:_=1;break;case 189:case 109:case 173:_=-1;break;case 37:d.shiftKey?x=-1:(d.preventDefault(),M=-1);break;case 39:d.shiftKey?x=1:(d.preventDefault(),M=1);break;case 38:d.shiftKey?C=1:(d.preventDefault(),B=-1);break;case 40:d.shiftKey?C=-1:(d.preventDefault(),B=1);break;default:return}return this._rotationDisabled&&(x=0,C=0),{cameraAnimation:U=>{var K=this._tr;U.easeTo({duration:300,easeId:"keyboardHandler",easing:ta,zoom:_?Math.round(K.zoom)+_*(d.shiftKey?2:1):K.zoom,bearing:K.bearing+x*this._bearingStep,pitch:K.pitch+C*this._pitchStep,offset:[-M*this._panStep,-B*this._panStep],center:K.center},{originalEvent:d})}}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ta(A){return A*(2-A)}const DD=4.000244140625;class Op{constructor(d,_){this._onTimeout=x=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(x)},this._map=d,this._tr=new Ng(d),this._triggerRenderFrame=_,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450}setZoomRate(d){this._defaultZoomRate=d}setWheelZoomRate(d){this._wheelZoomRate=d}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(d){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!d&&"center"===d.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(d){if(this.isEnabled()&&(!this._map.cooperativeGestures.isEnabled()||d[this._map.cooperativeGestures._bypassKey])){let C=d.deltaMode===WheelEvent.DOM_DELTA_LINE?40*d.deltaY:d.deltaY;var _=P.now(),x=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,0!==C&&C%DD==0?this._type="wheel":0!==C&&Math.abs(C)<4?this._type="trackpad":400<x?(this._type=null,this._lastValue=C,this._timeout=setTimeout(this._onTimeout,40,d)):this._type||(this._type=Math.abs(x*C)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,C+=this._lastValue)),d.shiftKey&&C&&(C/=4),this._type&&(this._lastWheelEvent=d,this._delta-=C,this._active||this._start(d)),d.preventDefault()}}_start(d){var _;this._delta&&(this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout),d=N.mousePos(this._map.getCanvas(),d),this._around=d.y>(_=this._tr).transform.height/2-_.transform.getHorizon()?h.LngLat.convert(this._aroundCenter?_.center:_.unproject(d)):h.LngLat.convert(_.center),this._aroundPoint=_.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame()))}renderFrame(){if(this._frameId&&(this._frameId=null,this.isActive())){var d=this._tr.transform;if(0!==this._delta){var x="wheel"===this._type&&Math.abs(this._delta)>DD?this._wheelZoomRate:this._defaultZoomRate;let re=2/(1+Math.exp(-Math.abs(this._delta*x)));this._delta<0&&0!==re&&(re=1/re),x="number"==typeof this._targetZoom?d.zoomScale(this._targetZoom):d.scale,this._targetZoom=Math.min(d.maxZoom,Math.max(d.minZoom,d.scaleZoom(x*re))),"wheel"===this._type&&(this._startZoom=d.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}x="number"==typeof this._targetZoom?this._targetZoom:d.zoom;var _,C=this._startZoom,M=this._easing;let U,B=!1;return"wheel"===this._type&&C&&M?(_=M(M=Math.min((P.now()-this._lastWheelEventTime)/200,1)),U=h.interpolate.number(C,x,_),M<1?this._frameId||(this._frameId=!0):B=!0):(U=x,B=!0),this._active=!0,B&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!B,zoomDelta:U-d.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}}_smoothOutEasing(d){let _=h.defaultEasing;var x,C;return this._prevEase&&(C=this._prevEase,x=(P.now()-C.start)/C.duration,C=C.easing(.01+x)-C.easing(x),x=.27/Math.sqrt(C*C+1e-4)*.01,C=Math.sqrt(.0729-x*x),_=h.bezier(x,C,.25,1)),this._prevEase={start:P.now(),duration:d,easing:_},_}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class ET{constructor(d,_){this._clickZoom=d,this._tapZoom=_}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class xT{constructor(d){this._tr=new Ng(d),this.reset()}reset(){this._active=!1}dblclick(d,_){return d.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:this._tr.zoom+(d.shiftKey?-1:1),around:this._tr.unproject(_)},{originalEvent:d})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Td{constructor(){this._tap=new Rw({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(d,_,x){var C,M,B;this._swipePoint||(this._tapTime?(M=d.timeStamp-this._tapTime<500,B=this._tapPoint.dist(C=_[0])<30,M&&B?0<x.length&&(this._swipePoint=C,this._swipeTouch=x[0].identifier):this.reset()):this._tap.touchstart(d,_,x))}touchmove(d,_,x){var C,M;if(this._tapTime){if(this._swipePoint&&x[0].identifier===this._swipeTouch)return M=(C=_[0]).y-this._swipePoint.y,this._swipePoint=C,d.preventDefault(),this._active=!0,{zoomDelta:M/128}}else this._tap.touchmove(d,_,x)}touchend(d,_,x){this._tapTime?this._swipePoint&&0===x.length&&this.reset():(_=this._tap.touchend(d,_,x))&&(this._tapTime=d.timeStamp,this._tapPoint=_)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nw{constructor(d,_,x){this._el=d,this._mousePan=_,this._touchPan=x}enable(d){this._inertiaOptions=d||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Np{constructor(d,_,x){this._pitchWithRotate=d.pitchWithRotate,this._mouseRotate=_,this._mousePitch=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class PD{constructor(d,_,x,C){this._el=d,this._touchZoom=_,this._touchRotate=x,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(d){this._touchZoom.enable(d),this._rotationDisabled||this._touchRotate.enable(d),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class TT{constructor(d,_){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=d,this._options=_,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(!this._container){(d=this._map.getCanvasContainer()).classList.add("maplibregl-cooperative-gestures"),this._container=N.create("div","maplibregl-cooperative-gesture-screen",d);let x=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(x=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));var _,d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText");((_=document.createElement("div")).className="maplibregl-desktop-message",_.textContent=x,this._container.appendChild(_),_=document.createElement("div")).className="maplibregl-mobile-message",_.textContent=d,this._container.appendChild(_),this._container.setAttribute("aria-hidden","true")}}_destoryUI(){this._container&&(N.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(d){this._onCooperativeGesture(1===d.touches.length)}wheel(d){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!d[this._bypassKey])}_onCooperativeGesture(d){this._enabled&&d&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Lw=A=>A.zoom||A.drag||A.pitch||A.rotate;class RD extends h.Event{}function Lp(A){return A.panDelta&&A.panDelta.mag()||A.zoomDelta||A.bearingDelta||A.pitchDelta}class MD{constructor(B,_){var x,C,M;for([x,C,M]of(this.handleWindowEvent=U=>{this.handleEvent(U,U.type+"Window")},this.handleEvent=(U,K)=>{if("blur"===U.type)this.stop(!0);else{this._updatingCamera=!0;var re,ce,ee,he="renderFrame"===U.type?void 0:U,Ee={needsRenderFrame:!1},Se={},Oe={},Ae=U.touches,qe=Ae?this._getMapTouches(Ae):void 0,Ge=qe?N.touchPos(this._map.getCanvas(),qe):N.mousePos(this._map.getCanvas(),U);for({handlerName:re,handler:ce,allowed:ee}of this._handlers)if(ce.isEnabled()){let _t;this._blockedByActive(Oe,ee,re)?ce.reset():ce[K||U.type]&&(_t=ce[K||U.type](U,Ge,qe),this.mergeHandlerResult(Ee,Se,_t,re,he),_t)&&_t.needsRenderFrame&&this._triggerRenderFrame(),(_t||ce.isActive())&&(Oe[re]=ce)}var Ye={};for(const _t in this._previousActiveHandlers)Oe[_t]||(Ye[_t]=he);this._previousActiveHandlers=Oe,(Object.keys(Ye).length||Lp(Ee))&&(this._changes.push([Ee,Se,Ye]),this._triggerRenderFrame()),(Object.keys(Oe).length||Lp(Ee))&&this._map._stop(!0),this._updatingCamera=!1,(Ae=Ee.cameraAnimation)&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ae(this._map))}},this._map=B,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Aw(B),this._bearingSnap=_.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(_),this._listeners=[[B=this._el,"touchstart",{passive:!0}],[B,"touchmove",{passive:!1}],[B,"touchend",void 0],[B,"touchcancel",void 0],[B,"mousedown",void 0],[B,"mousemove",void 0],[B,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[B,"mouseover",void 0],[B,"mouseout",void 0],[B,"dblclick",void 0],[B,"click",void 0],[B,"keydown",{capture:!1}],[B,"keyup",void 0],[B,"wheel",{passive:!1}],[B,"contextmenu",void 0],[window,"blur",void 0]],this._listeners))N.addEventListener(x,C,x===document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(var[d,_,x]of this._listeners)N.removeEventListener(d,_,d===document?this.handleWindowEvent:this.handleEvent,x)}_addDefaultHandlers(d){var _=this._map,M=_.getCanvasContainer(),B=(this._add("mapEvent",new Dw(_,d)),_.boxZoom=new yT(_,d)),x=(this._add("boxZoom",B),d.interactive&&d.boxZoom&&B.enable(),B=_.cooperativeGestures=new TT(_,d.cooperativeGestures),this._add("cooperativeGestures",B),d.cooperativeGestures&&B.enable(),B=new Lg(_),new xT(_)),C=(_.doubleClickZoom=new ET(x,B),this._add("tapZoom",B),this._add("clickZoom",x),d.interactive&&d.doubleClickZoom&&_.doubleClickZoom.enable(),B=new Td,this._add("tapDragZoom",B),x=_.touchPitch=new ZN(_),this._add("touchPitch",x),d.interactive&&d.touchPitch&&_.touchPitch.enable(d.touchPitch),x=Oc(d),Ow(d));_.dragRotate=new Np(d,x,C),this._add("mouseRotate",x,["mousePitch"]),this._add("mousePitch",C,["mouseRotate"]),d.interactive&&d.dragRotate&&_.dragRotate.enable(),x=(({enable:A,clickTolerance:d})=>{var _=new wT({checkCorrectEvent:x=>0===N.mouseButton(x)&&!x.ctrlKey});return new uo({clickTolerance:d,move:(x,C)=>({around:C,panDelta:C.sub(x)}),activateOnStart:!0,moveStateManager:_,enable:A,assignEvents:L_})})(d),C=new Bn(d,_),_.dragPan=new Nw(M,x,C),this._add("mousePan",x),this._add("touchPan",C,["touchZoom","touchRotate"]),d.interactive&&d.dragPan&&_.dragPan.enable(d.dragPan),x=new Fg,C=new F_,_.touchZoomRotate=new PD(M,C,x,B),this._add("touchRotate",x,["touchPan","touchZoom"]),this._add("touchZoom",C,["touchPan","touchRotate"]),d.interactive&&d.touchZoomRotate&&_.touchZoomRotate.enable(d.touchZoomRotate),M=_.scrollZoom=new Op(_,()=>this._triggerRenderFrame()),this._add("scrollZoom",M,["mousePan"]),d.interactive&&d.scrollZoom&&_.scrollZoom.enable(d.scrollZoom),B=_.keyboard=new No(_),this._add("keyboard",B),d.interactive&&d.keyboard&&_.keyboard.enable(),this._add("blockableMapEvent",new _n(_))}_add(d,_,x){this._handlers.push({handlerName:d,handler:_,allowed:x}),this._handlersById[d]=_}stop(d){if(!this._updatingCamera){for(var{handler:_}of this._handlers)_.reset();this._inertia.clear(),this._fireEvents({},{},d),this._changes=[]}}isActive(){for(var{handler:d}of this._handlers)if(d.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Lw(this._eventsInProgress)||this.isZooming()}_blockedByActive(d,_,x){for(const C in d)if(C!==x&&(!_||_.indexOf(C)<0))return!0;return!1}_getMapTouches(d){var _=[];for(const C of d)this._el.contains(C.target)&&_.push(C);return _}mergeHandlerResult(d,_,x,C,M){x&&(h.extend(d,x),d={handlerName:C,originalEvent:x.originalEvent||M},void 0!==x.zoomDelta&&(_.zoom=d),void 0!==x.panDelta&&(_.drag=d),void 0!==x.pitchDelta&&(_.pitch=d),void 0!==x.bearingDelta)&&(_.rotate=d)}_applyChanges(){var d,_,x,C={},M={},B={};for([d,_,x]of this._changes)d.panDelta&&(C.panDelta=(C.panDelta||new h.Point(0,0))._add(d.panDelta)),d.zoomDelta&&(C.zoomDelta=(C.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(C.bearingDelta=(C.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(C.pitchDelta=(C.pitchDelta||0)+d.pitchDelta),void 0!==d.around&&(C.around=d.around),void 0!==d.pinchAround&&(C.pinchAround=d.pinchAround),d.noInertia&&(C.noInertia=d.noInertia),h.extend(M,_),h.extend(B,x);this._updateMapTransform(C,M,B),this._changes=[]}_updateMapTransform(d,_,x){const C=this._map,M=C._getTransformForUpdate();var B=C.terrain;if(!(Lp(d)||B&&this._terrainMovement))return this._fireEvents(_,x,!0);let{panDelta:U,zoomDelta:K,bearingDelta:re,pitchDelta:ce,around:ee,pinchAround:he}=d;void 0!==he&&(ee=he),C._stop(!0),ee=ee||C.transform.centerPoint;var Ee=M.pointLocation(U?ee.sub(U):ee);re&&(M.bearing+=re),ce&&(M.pitch+=ce),K&&(M.zoom+=K),B?this._terrainMovement||!_.drag&&!_.zoom?_.drag&&this._terrainMovement?M.center=M.pointLocation(M.centerPoint.sub(U)):M.setLocationAtPoint(Ee,ee):(this._terrainMovement=!0,this._map._elevationFreeze=!0,M.setLocationAtPoint(Ee,ee),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,M.recalculateZoom(C.terrain)})):M.setLocationAtPoint(Ee,ee),C._applyUpdatedTransform(M),this._map._update(),d.noInertia||this._inertia.record(d),this._fireEvents(_,x,!0)}_fireEvents(d,_,x){var C=Lw(this._eventsInProgress),M=Lw(d),B={};for(const Se in d)this._eventsInProgress[Se]||(B[Se+"start"]=d[Se].originalEvent),this._eventsInProgress[Se]=d[Se];!C&&M&&this._fireEvent("movestart",M.originalEvent);for(const Se in B)this._fireEvent(Se,B[Se]);M&&this._fireEvent("move",M.originalEvent);for(const Se in d)this._fireEvent(Se,d[Se].originalEvent);var re={};let ce;for(const Se in this._eventsInProgress){var{handlerName:ee,originalEvent:he}=this._eventsInProgress[Se];this._handlersById[ee].isActive()||(delete this._eventsInProgress[Se],ce=_[ee]||he,re[Se+"end"]=ce)}for(const Se in re)this._fireEvent(Se,re[Se]);var Ee=Lw(this._eventsInProgress);x&&(C||M)&&!Ee&&(this._updatingCamera=!0,x=Se=>0!==Se&&-this._bearingSnap<Se&&Se<this._bearingSnap,!(C=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions))||!C.essential&&P.prefersReducedMotion?(this._map.fire(new h.Event("moveend",{originalEvent:ce})),x(this._map.getBearing())&&this._map.resetNorth()):(x(C.bearing||this._map.getBearing())&&(C.bearing=0),C.freezeElevation=!0,this._map.easeTo(C,{originalEvent:ce})),this._updatingCamera=!1)}_fireEvent(d,_){this._map.fire(new h.Event(d,_?{originalEvent:_}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(d=>{delete this._frameId,this.handleEvent(new RD("renderFrame",{timeStamp:d})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Fw extends h.Evented{constructor(d,_){super(),this._renderFrameCallback=()=>{var x=Math.min((P.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(x)),x<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=d,this._bearingSnap=_.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new h.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(d,_){return this.jumpTo({center:d},_)}panBy(d,_,x){return d=h.Point.convert(d).mult(-1),this.panTo(this.transform.center,h.extend({offset:d},_),x)}panTo(d,_,x){return this.easeTo(h.extend({center:d},_),x)}getZoom(){return this.transform.zoom}setZoom(d,_){return this.jumpTo({zoom:d},_),this}zoomTo(d,_,x){return this.easeTo(h.extend({zoom:d},_),x)}zoomIn(d,_){return this.zoomTo(this.getZoom()+1,d,_),this}zoomOut(d,_){return this.zoomTo(this.getZoom()-1,d,_),this}getBearing(){return this.transform.bearing}setBearing(d,_){return this.jumpTo({bearing:d},_),this}getPadding(){return this.transform.padding}setPadding(d,_){return this.jumpTo({padding:d},_),this}rotateTo(d,_,x){return this.easeTo(h.extend({bearing:d},_),x)}resetNorth(d,_){return this.rotateTo(0,h.extend({duration:1e3},d),_),this}resetNorthPitch(d,_){return this.easeTo(h.extend({bearing:0,pitch:0,duration:1e3},d),_),this}snapToNorth(d,_){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(d,_):this}getPitch(){return this.transform.pitch}setPitch(d,_){return this.jumpTo({pitch:d},_),this}cameraForBounds(d,_){d=yn.convert(d);var x=_&&_.bearing||0;return this._cameraForBoxAndBearing(d.getNorthWest(),d.getSouthEast(),x,_)}_cameraForBoxAndBearing(he,U,x,C){var M=("number"==typeof(C=h.extend({padding:B={top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding&&(C.padding={top:M=C.padding,bottom:M,right:M,left:M}),C.padding=h.extend(B,C.padding),this.transform),B=M.padding,ee=(he=new yn(he,U),U=M.project(he.getNorthWest()),M.project(he.getNorthEast())),K=M.project(he.getSouthEast()),re=(he=M.project(he.getSouthWest()),h.degreesToRadians(-x)),ce=U.rotate(re),Ee=(ee=ee.rotate(re),K.rotate(re));if(he=he.rotate(re),re=new h.Point(Math.max(ce.x,ee.x,he.x,Ee.x),Math.max(ce.y,ee.y,he.y,Ee.y)),ce=new h.Point(Math.min(ce.x,ee.x,he.x,Ee.x),Math.min(ce.y,ee.y,he.y,Ee.y)),ee=re.sub(ce),he=(M.width-(B.left+B.right+C.padding.left+C.padding.right))/ee.x,!((Ee=(M.height-(B.top+B.bottom+C.padding.top+C.padding.bottom))/ee.y)<0||he<0))return re=Math.min(M.scaleZoom(M.scale*Math.min(he,Ee)),C.maxZoom),ce=h.Point.convert(C.offset),he=new h.Point(B=(C.padding.left-C.padding.right)/2,ee=(C.padding.top-C.padding.bottom)/2).rotate(h.degreesToRadians(x)),Ee=ce.add(he).mult(M.scale/M.zoomScale(re)),{center:M.unproject(U.add(K).div(2).sub(Ee)),zoom:re,bearing:x};h.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}fitBounds(d,_,x){return this._fitInternal(this.cameraForBounds(d,_),_,x)}fitScreenCoordinates(d,_,x,C,M){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(h.Point.convert(d)),this.transform.pointLocation(h.Point.convert(_)),x,C),C,M)}_fitInternal(d,_,x){return d?(delete(_=h.extend(d,_)).padding,_.linear?this.easeTo(_,x):this.flyTo(_,x)):this}jumpTo(d,_){this.stop();var x=this._getTransformForUpdate();let C=!1,M=!1,B=!1;return"zoom"in d&&x.zoom!==+d.zoom&&(C=!0,x.zoom=+d.zoom),void 0!==d.center&&(x.center=h.LngLat.convert(d.center)),"bearing"in d&&x.bearing!==+d.bearing&&(M=!0,x.bearing=+d.bearing),"pitch"in d&&x.pitch!==+d.pitch&&(B=!0,x.pitch=+d.pitch),null==d.padding||x.isPaddingEqual(d.padding)||(x.padding=d.padding),this._applyUpdatedTransform(x),this.fire(new h.Event("movestart",_)).fire(new h.Event("move",_)),C&&this.fire(new h.Event("zoomstart",_)).fire(new h.Event("zoom",_)).fire(new h.Event("zoomend",_)),M&&this.fire(new h.Event("rotatestart",_)).fire(new h.Event("rotate",_)).fire(new h.Event("rotateend",_)),B&&this.fire(new h.Event("pitchstart",_)).fire(new h.Event("pitch",_)).fire(new h.Event("pitchend",_)),this.fire(new h.Event("moveend",_))}calculateCameraOptionsFromTo(B,M,ce,ee=0){B=h.MercatorCoordinate.fromLngLat(B,M),ce=(M=h.MercatorCoordinate.fromLngLat(ce,ee)).x-B.x,ee=M.y-B.y,B=M.z-B.z;var U=Math.hypot(ce,ee,B);if(0===U)throw new Error("Can't calculate camera options with same From and To");var K=Math.hypot(ce,ee),re=this.transform.scaleZoom(this.transform.cameraToCenterDistance/U/this.transform.tileSize);return ce=180*Math.atan2(ce,-ee)/Math.PI,ee=180*Math.acos(K/U)/Math.PI,ee=B<0?90-ee:90+ee,{center:M.toLngLat(),zoom:re,pitch:ee,bearing:ce}}easeTo(d,_){this._stop(!1,d.easeId),(!1===(d=h.extend({offset:[0,0],duration:500,easing:h.defaultEasing},d)).animate||!d.essential&&P.prefersReducedMotion)&&(d.duration=0);const x=this._getTransformForUpdate(),C=this.getZoom(),M=this.getBearing(),B=this.getPitch(),U=this.getPadding(),K="bearing"in d?this._normalizeBearing(d.bearing,M):M,re="pitch"in d?+d.pitch:B,ce=("padding"in d?d:x).padding,ee=h.Point.convert(d.offset);let he=x.centerPoint.add(ee);var Ee=x.pointLocation(he);const{center:Se,zoom:Oe}=x.getConstrained(h.LngLat.convert(d.center||Ee),null!=(bt=d.zoom)?bt:C),Ae=(this._normalizeCenter(Se),x.project(Ee)),qe=x.project(Se).sub(Ae),Ge=x.zoomScale(Oe-C);let Ye,_t;d.around&&(Ye=h.LngLat.convert(d.around),_t=x.locationPoint(Ye));var bt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Oe!==C,this._rotating=this._rotating||M!==K,this._pitching=this._pitching||re!==B,this._padding=!x.isPaddingEqual(ce),this._easeId=d.easeId,this._prepareEase(_,d.noMoveStart,bt),this.terrain&&this._prepareElevation(Se),this._ease(yt=>{var Nt,At;this._zooming&&(x.zoom=h.interpolate.number(C,Oe,yt)),this._rotating&&(x.bearing=h.interpolate.number(M,K,yt)),this._pitching&&(x.pitch=h.interpolate.number(B,re,yt)),this._padding&&(x.interpolatePadding(U,ce,yt),he=x.centerPoint.add(ee)),this.terrain&&!d.freezeElevation&&this._updateElevation(yt),Ye?x.setLocationAtPoint(Ye,_t):(Nt=x.zoomScale(x.zoom-C),At=Oe>C?Math.min(2,Ge):Math.max(.5,Ge),At=Math.pow(At,1-yt),yt=x.unproject(Ae.add(qe.mult(yt*At)).mult(Nt)),x.setLocationAtPoint(x.renderWorldCopies?yt.wrap():yt,he)),this._applyUpdatedTransform(x),this._fireMoveEvents(_)},yt=>{this.terrain&&this._finalizeElevation(),this._afterEase(_,yt)},d),this}_prepareEase(d,_,x={}){this._moving=!0,_||x.moving||this.fire(new h.Event("movestart",d)),this._zooming&&!x.zooming&&this.fire(new h.Event("zoomstart",d)),this._rotating&&!x.rotating&&this.fire(new h.Event("rotatestart",d)),this._pitching&&!x.pitching&&this.fire(new h.Event("pitchstart",d))}_prepareElevation(d){this._elevationCenter=d,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(d){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);var _,x,C=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);d<1&&C!==this._elevationTarget&&(x=(C-((_=this._elevationTarget-this._elevationStart)*d+this._elevationStart))/(1-d),this._elevationStart+=d*(_-x),this._elevationTarget=C),this.transform.elevation=h.interpolate.number(this._elevationStart,this._elevationTarget,d)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(d){var _,x,C,M,B;this.transformCameraUpdate&&(d=d.clone(),({center:_,zoom:x,pitch:C,bearing:M,elevation:B}=this.transformCameraUpdate(d)),_&&(d.center=_),void 0!==x&&(d.zoom=x),void 0!==C&&(d.pitch=C),void 0!==M&&(d.bearing=M),void 0!==B&&(d.elevation=B),this.transform.apply(d))}_fireMoveEvents(d){this.fire(new h.Event("move",d)),this._zooming&&this.fire(new h.Event("zoom",d)),this._rotating&&this.fire(new h.Event("rotate",d)),this._pitching&&this.fire(new h.Event("pitch",d))}_afterEase(d,_){var x,C;this._easeId&&_&&this._easeId===_||(delete this._easeId,this.fire(new h.Event("freezeElevation",{freeze:!1})),_=this._zooming,x=this._rotating,C=this._pitching,this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new h.Event("zoomend",d)),x&&this.fire(new h.Event("rotateend",d)),C&&this.fire(new h.Event("pitchend",d)),this.fire(new h.Event("moveend",d)))}flyTo(d,_){if(!d.essential&&P.prefersReducedMotion)return Ee=h.pick(d,["center","zoom","bearing","pitch","around"]),this.jumpTo(Ee,_);this.stop(),d=h.extend({offset:[0,0],speed:1.2,curve:1.42,easing:h.defaultEasing},d);const x=this._getTransformForUpdate(),C=this.getZoom(),M=this.getBearing(),B=this.getPitch(),U=this.getPadding(),K="bearing"in d?this._normalizeBearing(d.bearing,M):M,re="pitch"in d?+d.pitch:B,ce=("padding"in d?d:x).padding,ee=h.Point.convert(d.offset);let he=x.centerPoint.add(ee);var Ee=x.pointLocation(he);const{center:Se,zoom:Oe}=x.getConstrained(h.LngLat.convert(d.center||Ee),null!=(Ae=d.zoom)?Ae:C);this._normalizeCenter(Se);var Ae=x.zoomScale(Oe-C);const qe=x.project(Ee),Ge=x.project(Se).sub(qe);let Ye=d.curve;const _t=Math.max(x.width,x.height),bt=_t/Ae,yt=Ge.mag(),Nt=("minZoom"in d&&(Ee=h.clamp(Math.min(d.minZoom,C,Oe),x.minZoom,x.maxZoom),Ae=_t/x.zoomScale(Ee-C),Ye=Math.sqrt(Ae/yt*2)),Ye*Ye);function At(sn){return sn=(bt*bt-_t*_t+(sn?-1:1)*Nt*Nt*yt*yt)/(2*(sn?bt:_t)*Nt*yt),Math.log(Math.sqrt(sn*sn+1)-sn)}function rn(sn){return(Math.exp(sn)-Math.exp(-sn))/2}function mn(sn){return(Math.exp(sn)+Math.exp(-sn))/2}const Fn=At(!1);let er=function(sn){return mn(Fn)/mn(Fn+Ye*sn)},ur=function(sn){return _t*((mn(Fn)*(rn(sn=Fn+Ye*sn)/mn(sn))-rn(Fn))/Nt)/yt},Un=(At(!0)-Fn)/Ye;if(Math.abs(yt)<1e-6||!isFinite(Un)){if(Math.abs(_t-bt)<1e-6)return this.easeTo(d,_);const sn=bt<_t?-1:1;Un=Math.abs(Math.log(bt/_t))/Ye,ur=function(){return 0},er=function(qn){return Math.exp(sn*Ye*qn)}}return d.duration="duration"in d?+d.duration:1e3*Un/(Ee="screenSpeed"in d?+d.screenSpeed/Ye:+d.speed),d.maxDuration&&d.duration>d.maxDuration&&(d.duration=0),this._zooming=!0,this._rotating=M!==K,this._pitching=re!==B,this._padding=!x.isPaddingEqual(ce),this._prepareEase(_,!1),this.terrain&&this._prepareElevation(Se),this._ease(An=>{var qn=An*Un,Dr=1/er(qn);x.zoom=1===An?Oe:C+x.scaleZoom(Dr),this._rotating&&(x.bearing=h.interpolate.number(M,K,An)),this._pitching&&(x.pitch=h.interpolate.number(B,re,An)),this._padding&&(x.interpolatePadding(U,ce,An),he=x.centerPoint.add(ee)),this.terrain&&!d.freezeElevation&&this._updateElevation(An),An=1===An?Se:x.unproject(qe.add(Ge.mult(ur(qn))).mult(Dr)),x.setLocationAtPoint(x.renderWorldCopies?An.wrap():An,he),this._applyUpdatedTransform(x),this._fireMoveEvents(_)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(_)},d),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(d,_){var x;return this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd&&(x=this._onEaseEnd,delete this._onEaseEnd,x.call(this,_)),d||(x=this.handlers)&&x.stop(!1),this}_ease(d,_,x){!1===x.animate||0===x.duration?(d(1),_()):(this._easeStart=P.now(),this._easeOptions=x,this._onEaseFrame=d,this._onEaseEnd=_,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(d,_){d=h.wrap(d,-180,180);var x=Math.abs(d-_);return Math.abs(d-360-_)<x&&(d-=360),Math.abs(d+360-_)<x&&(d+=360),d}_normalizeCenter(d){var _=this.transform;_.renderWorldCopies&&!_.lngRange&&(d.lng+=180<(_=d.lng-_.center.lng)?-360:_<-180?360:0)}queryTerrainElevation(d){return this.terrain?this.terrain.getElevationForLngLatZoom(h.LngLat.convert(d),this.transform.tileZoom)-this.transform.elevation:null}}const kD={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class V_{constructor(d=kD){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=_=>{!_||"metadata"!==_.sourceDataType&&"visibility"!==_.sourceDataType&&"style"!==_.dataType&&"terrain"!==_.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=d}getDefaultPosition(){return"bottom-right"}onAdd(d){return this._map=d,this._compact=this.options.compact,this._container=N.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=N.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=N.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){N.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(d,_){_=this._map._getUIString("AttributionControl."+_),d.title=_,d.setAttribute("aria-label",_)}_updateAttributions(){if(this._map.style){let C=[];this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?C=C.concat(this.options.customAttribution.map(M=>"string"!=typeof M?"":M)):"string"==typeof this.options.customAttribution&&C.push(this.options.customAttribution)),this._map.style.stylesheet&&(this.styleOwner=(x=this._map.style.stylesheet).owner,this.styleId=x.id);var d=this._map.style.sourceCaches;for(const M in d){var _=d[M];(_.used||_.usedForTerrain)&&(_=_.getSource()).attribution&&C.indexOf(_.attribution)<0&&C.push(_.attribution)}(C=C.filter(M=>String(M).trim())).sort((M,B)=>M.length-B.length);var x=(C=C.filter((M,B)=>{for(let U=B+1;U<C.length;U++)if(0<=C[U].indexOf(M))return!1;return!0})).join(" | ");x!==this._attribHTML&&(this._attribHTML=x,C.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}}class B_{constructor(d={}){this._updateCompact=()=>{var _=this._container.children;_.length&&(_=_[0],this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&_.classList.add("maplibregl-compact"):_.classList.remove("maplibregl-compact"))},this.options=d}getDefaultPosition(){return"bottom-left"}onAdd(d){return this._map=d,this._compact=this.options&&this.options.compact,this._container=N.create("div","maplibregl-ctrl"),(d=N.create("a","maplibregl-ctrl-logo")).target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){N.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Nc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(d){var _=++this._id;return this._queue.push({callback:d,id:_,cancelled:!1}),_}remove(d){var _=this._currentlyRunning;for(const x of _?this._queue.concat(_):this._queue)if(x.id===d)return void(x.cancelled=!0)}run(d=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");var _=this._currentlyRunning=this._queue;this._queue=[];for(const x of _)if(!x.cancelled&&(x.callback(d),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Vw=h.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class QN extends h.Evented{constructor(d){super(),this.sourceCache=d,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,d.usedForTerrain=!0,d.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(d,_){this.sourceCache.update(d,_),this._renderableTilesKeys=[];var x={};for(const C of d.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:_}))x[C.key]=!0,this._renderableTilesKeys.push(C.key),this._tiles[C.key]||(C.posMatrix=new Float64Array(16),h.ortho(C.posMatrix,0,h.EXTENT,0,h.EXTENT,0,1),this._tiles[C.key]=new Yn(C,this.tileSize));for(const C in this._tiles)x[C]||delete this._tiles[C]}freeRtt(d){for(const x in this._tiles){var _=this._tiles[x];(!d||_.tileID.equals(d)||_.tileID.isChildOf(d)||d.isChildOf(_.tileID))&&(_.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(d=>this.getTileByID(d))}getTileByID(d){return this._tiles[d]}getTerrainCoords(d){var _={};for(const re of this._renderableTilesKeys){var x,C,M,B,U,K=this._tiles[re].tileID;K.canonical.equals(d.canonical)?((x=d.clone()).posMatrix=new Float64Array(16),h.ortho(x.posMatrix,0,h.EXTENT,0,h.EXTENT,0,1),_[re]=x):K.canonical.isChildOf(d.canonical)?((x=d.clone()).posMatrix=new Float64Array(16),C=K.canonical.x-(K.canonical.x>>(B=K.canonical.z-d.canonical.z)<<B),M=K.canonical.y-(K.canonical.y>>B<<B),h.ortho(x.posMatrix,0,B=h.EXTENT>>B,0,B,0,1),h.translate(x.posMatrix,x.posMatrix,[-C*B,-M*B,0]),_[re]=x):d.canonical.isChildOf(K.canonical)&&((C=d.clone()).posMatrix=new Float64Array(16),B=d.canonical.x-(d.canonical.x>>(M=d.canonical.z-K.canonical.z)<<M),K=d.canonical.y-(d.canonical.y>>M<<M),U=h.EXTENT>>M,h.ortho(C.posMatrix,0,h.EXTENT,0,h.EXTENT,0,1),h.translate(C.posMatrix,C.posMatrix,[B*U,K*U,0]),h.scale(C.posMatrix,C.posMatrix,[1/2**M,1/2**M,0]),_[re]=C)}return _}getSourceTile(d,_){var x=this.sourceCache._source;let C=d.overscaledZ-this.deltaZoom;if((C=C>x.maxzoom?x.maxzoom:C)<x.minzoom)return null;this._sourceTileCache[d.key]||(this._sourceTileCache[d.key]=d.scaledTo(C).key);let M=this.sourceCache.getTileByID(this._sourceTileCache[d.key]);if((!M||!M.dem)&&_)for(;C>=x.minzoom&&(!M||!M.dem);)M=this.sourceCache.getTileByID(d.scaledTo(C--).key);return M}tilesAfterTime(d=Date.now()){return Object.values(this._tiles).filter(_=>_.timeAdded>=d)}}class Bw{constructor(d,_,x){this.painter=d,this.sourceCache=new QN(_),this.options=x,this.exaggeration="number"==typeof x.exaggeration?x.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(d,_,x,C=h.EXTENT){var M;return 0<=_&&_<C&&0<=x&&x<C&&(M=null==(M=(d=this.getTerrainData(d)).tile)?void 0:M.dem)?(x=[(_=h.transformMat4$1([],[_/C*h.EXTENT,x/C*h.EXTENT],d.u_terrain_matrix))[0]*M.dim,_[1]*M.dim],C=Math.floor(x[0]),d=Math.floor(x[1]),_=x[0]-C,x=x[1]-d,M.get(C,d)*(1-_)*(1-x)+M.get(C+1,d)*_*(1-x)+M.get(C,d+1)*(1-_)*x+M.get(C+1,d+1)*_*x):0}getElevationForLngLatZoom(x,C){var{tileID:x,mercatorX:C,mercatorY:M}=this._getOverscaledTileIDFromLngLatZoom(x,C);return this.getElevation(x,C%h.EXTENT,M%h.EXTENT,h.EXTENT)}getElevation(d,_,x,C=h.EXTENT){return this.getDEMElevation(d,_,x,C)*this.exaggeration}getTerrainData(d){this._emptyDemTexture||(x=this.painter.context,_=new h.RGBAImage({width:1,height:1},new Uint8Array(4)),this._emptyDepthTexture=new ot(x,_,x.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ot(x,new h.RGBAImage({width:1,height:1}),x.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=h.identity([]));var _=this.sourceCache.getSourceTile(d,!0),x=(_&&_.dem&&(!_.demTexture||_.needsTerrainPrepare)&&(x=this.painter.context,_.demTexture=this.painter.getTileTexture(_.dem.stride),_.demTexture?_.demTexture.update(_.dem.getPixels(),{premultiply:!1}):_.demTexture=new ot(x,_.dem.getPixels(),x.gl.RGBA,{premultiply:!1}),_.demTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),_.needsTerrainPrepare=!1),_&&_+_.tileID.key+d.key);if(x&&!this._demMatrixCache[x]){var C=this.sourceCache.sourceCache._source.maxzoom;let U=d.canonical.z-_.tileID.canonical.z;d.overscaledZ>d.canonical.z&&(d.canonical.z>=C?U=d.canonical.z-C:h.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom")),C=d.canonical.x-(d.canonical.x>>U<<U);var M=d.canonical.y-(d.canonical.y>>U<<U),B=h.fromScaling(new Float64Array(16),[1/(h.EXTENT<<U),1/(h.EXTENT<<U),0]);h.translate(B,B,[C*h.EXTENT,M*h.EXTENT,0]),this._demMatrixCache[d.key]={matrix:B,coord:d}}return{u_depth:2,u_terrain:3,u_terrain_dim:_&&_.dem&&_.dem.dim||1,u_terrain_matrix:x?this._demMatrixCache[d.key].matrix:this._emptyDemMatrix,u_terrain_unpack:_&&_.dem&&_.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(_&&_.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:_}}getFramebuffer(d){var _=this.painter,x=_.width/devicePixelRatio,C=_.height/devicePixelRatio;return!this._fbo||this._fbo.width===x&&this._fbo.height===C||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ot(_.context,{width:x,height:C,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ot(_.context,{width:x,height:C,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=_.context.createFramebuffer(x,C,!0,!1),this._fbo.depthAttachment.set(_.context.createRenderbuffer(_.context.gl.DEPTH_COMPONENT16,x,C))),this._fbo.colorAttachment.set(("coords"===d?this._fboCoordsTexture:this._fboDepthTexture).texture),this._fbo}getCoordsTexture(){var d=this.painter.context;if(this._coordsTexture)return this._coordsTexture;var _=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let C=0,M=0;C<this._coordsTextureSize;C++)for(let B=0;B<this._coordsTextureSize;B++,M+=4)_[M+0]=255&B,_[M+1]=255&C,_[M+2]=B>>8<<4|C>>8,_[M+3]=0;var x=new h.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(_.buffer));return(x=new ot(d,x,d.gl.RGBA,{premultiply:!1})).bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._coordsTexture=x}pointCoordinate(B){this.painter.maybeDrawDepthAndCoords(!0);var _=new Uint8Array(4),x=this.painter.context,U=x.gl,C=Math.round(B.x*this.painter.pixelRatio/devicePixelRatio),M=(B=Math.round(B.y*this.painter.pixelRatio/devicePixelRatio),Math.round(this.painter.height/devicePixelRatio));return x.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),U.readPixels(C,M-B-1,1,1,U.RGBA,U.UNSIGNED_BYTE,_),x.bindFramebuffer.set(null),C=_[0]+(_[2]>>4<<8),M=_[1]+((15&_[2])<<8),(U=(B=this.coordsIndex[255-_[3]])&&this.sourceCache.getTileByID(B))?new h.MercatorCoordinate((U.tileID.canonical.x*(x=this._coordsTextureSize)+C)/(_=(1<<U.tileID.canonical.z)*x)+U.tileID.wrap,(U.tileID.canonical.y*x+M)/_,this.getElevation(U.tileID,C,M,x)):null}depthAtPoint(M){var _=new Uint8Array(4),x=this.painter.context,C=x.gl;return x.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),C.readPixels(M.x,this.painter.height/devicePixelRatio-M.y-1,1,1,C.RGBA,C.UNSIGNED_BYTE,_),x.bindFramebuffer.set(null),(_[0]/16777216+_[1]/65536+_[2]/256+_[3])/256}getTerrainMesh(){if(!this._mesh){var d=this.painter.context,_=new h.Pos3dArray,x=new h.TriangleIndexArray,C=this.meshSize,M=h.EXTENT/C,B=C*C;for(let ee=0;ee<=C;ee++)for(let he=0;he<=C;he++)_.emplaceBack(he*M,ee*M,0);for(let ee=0;ee<B;ee+=C+1)for(let he=0;he<C;he++)x.emplaceBack(he+ee,C+he+ee+1,C+he+ee+2),x.emplaceBack(he+ee,C+he+ee+2,he+ee+1);var U=_.length,K=U+2*(C+1);for(const ee of[0,1])for(let he=0;he<=C;he++)for(const Ee of[0,1])_.emplaceBack(he*M,ee*h.EXTENT,Ee);for(let ee=0;ee<2*C;ee+=2)x.emplaceBack(K+ee,K+ee+1,K+ee+3),x.emplaceBack(K+ee,K+ee+3,K+ee+2),x.emplaceBack(U+ee,U+ee+3,U+ee+1),x.emplaceBack(U+ee,U+ee+2,U+ee+3);var re=_.length,ce=re+2*(C+1);for(const ee of[0,1])for(let he=0;he<=C;he++)for(const Ee of[0,1])_.emplaceBack(ee*h.EXTENT,he*M,Ee);for(let ee=0;ee<2*C;ee+=2)x.emplaceBack(re+ee,re+ee+1,re+ee+3),x.emplaceBack(re+ee,re+ee+3,re+ee+2),x.emplaceBack(ce+ee,ce+ee+3,ce+ee+1),x.emplaceBack(ce+ee,ce+ee+2,ce+ee+3);this._mesh={indexBuffer:d.createIndexBuffer(x),vertexBuffer:d.createVertexBuffer(_,Vw.members),segments:h.SegmentVector.simpleSegment(0,0,_.length,x.length)}}return this._mesh}getMeshFrameDelta(d){return 2*Math.PI*h.earthRadius/Math.pow(2,d)/5}getMinTileElevationForLngLatZoom(d,_){return d=this._getOverscaledTileIDFromLngLatZoom(d,_).tileID,null!=(_=this.getMinMaxElevation(d).minElevation)?_:0}getMinMaxElevation(_){var x={minElevation:null,maxElevation:null};return(_=this.getTerrainData(_).tile)&&_.dem&&(x.minElevation=_.dem.min*this.exaggeration,x.maxElevation=_.dem.max*this.exaggeration),x}_getOverscaledTileIDFromLngLatZoom(C,_){var x=(C=h.MercatorCoordinate.fromLngLat(C.wrap())).x*(M=(1<<_)*h.EXTENT),M=(C=C.y*M,Math.floor(x/h.EXTENT)),B=Math.floor(C/h.EXTENT);return{tileID:new h.OverscaledTileID(_,0,_,M,B),mercatorX:x,mercatorY:C}}}class U_{constructor(d,_,x){this._context=d,this._size=_,this._tileSize=x,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const d of this._objects)d.texture.destroy(),d.fbo.destroy()}_createObject(d){var _=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),x=new ot(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return x.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),_.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),_.colorAttachment.set(x.texture),{id:d,fbo:_,texture:x,stamp:-1,inUse:!1}}getObjectForId(d){return this._objects[d]}useObject(d){d.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(_=>d.id!==_),this._recentlyUsed.push(d.id)}stampObject(d){d.stamp=++this._stamp}getOrCreateFreeObject(){for(const _ of this._recentlyUsed)if(!this._objects[_].inUse)return this._objects[_];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");var d=this._createObject(this._objects.length);return this._objects.push(d),d}freeObject(d){d.inUse=!1}freeAllObjects(){for(const d of this._objects)this.freeObject(d)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(d=>!d.inUse)}}const Fp={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class CT{constructor(d,_){this.painter=d,this.terrain=_,this.pool=new U_(d.context,30,_.sourceCache.tileSize*_.qualityFactor)}destruct(){this.pool.destruct()}getTexture(d){return this.pool.getObjectForId(d.rtt[this._stacks.length-1].id).texture}prepareForRender(d,_){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=d._order.filter(U=>!d._layers[U].isHidden(_)),this._coordsDescendingInv={};for(const U in d.sourceCaches){this._coordsDescendingInv[U]={};for(const K of d.sourceCaches[U].getVisibleCoordinates()){var x=this.terrain.sourceCache.getTerrainCoords(K);for(const re in x)this._coordsDescendingInv[U][re]||(this._coordsDescendingInv[U][re]=[]),this._coordsDescendingInv[U][re].push(x[re])}}this._coordsDescendingInvStr={};for(const U of d._order){var C=d._layers[U],M=C.source;if(Fp[C.type]&&!this._coordsDescendingInvStr[M]){this._coordsDescendingInvStr[M]={};for(const K in this._coordsDescendingInv[M])this._coordsDescendingInvStr[M][K]=this._coordsDescendingInv[M][K].map(re=>re.key).sort().join()}}for(const U of this._renderableTiles)for(const K in this._coordsDescendingInvStr){var B=this._coordsDescendingInvStr[K][U.tileID.key];B&&B!==U.rttCoords[K]&&(U.rtt=[])}}renderLayer(d){if(!d.isHidden(this.painter.transform.zoom)){var _=d.type,x=this.painter,C=this._renderableLayerIds[this._renderableLayerIds.length-1]===d.id;if(Fp[_]&&(this._prevType&&Fp[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(d.id),!C))return!0;if(Fp[this._prevType]||Fp[_]&&C){this._prevType=_;var M=this._stacks.length-1,B=this._stacks[M]||[];for(const ce of this._renderableTiles){if(this.pool.isFull()&&(Sw(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(ce),ce.rtt[M]){var U=this.pool.getObjectForId(ce.rtt[M].id);if(U.stamp===ce.rtt[M].stamp){this.pool.useObject(U);continue}}var K=this.pool.getOrCreateFreeObject();this.pool.useObject(K),this.pool.stampObject(K),ce.rtt[M]={id:K.id,stamp:K.stamp},x.context.bindFramebuffer.set(K.fbo.framebuffer),x.context.clear({color:h.Color.transparent,stencil:0}),x.currentStencilSource=void 0;for(let ee=0;ee<B.length;ee++){const he=x.style._layers[B[ee]];var re=he.source?this._coordsDescendingInv[he.source][ce.tileID.key]:[ce.tileID];x.context.viewport.set([0,0,K.fbo.width,K.fbo.height]),x._renderTileClippingMasks(he,re),x.renderLayer(x,x.style.sourceCaches[he.source],he,re),he.source&&(ce.rttCoords[he.source]=this._coordsDescendingInvStr[he.source][ce.tileID.key])}}return Sw(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Fp[_]}}return!1}}const v5={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},IT=w,ST={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:kD,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:h.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]};fi=class extends Fw{constructor(A){if(h.PerformanceUtils.mark(h.PerformanceMarkers.create),null!=(A=h.extend({},ST,A)).minZoom&&null!=A.maxZoom&&A.minZoom>A.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=A.minPitch&&null!=A.maxPitch&&A.minPitch>A.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=A.minPitch&&A.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=A.maxPitch&&85<A.maxPitch)throw new Error("maxPitch must be less than or equal to 85");if(super(new cu(A.minZoom,A.maxZoom,A.minPitch,A.maxPitch,A.renderWorldCopies),{bearingSnap:A.bearingSnap}),this._contextLost=_=>{_.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new h.Event("webglcontextlost",{originalEvent:_}))},this._contextRestored=_=>{this._setupPainter(),this.resize(),this._update(),this.fire(new h.Event("webglcontextrestored",{originalEvent:_}))},this._onMapScroll=_=>{if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=A.interactive,this._maxTileCacheSize=A.maxTileCacheSize,this._maxTileCacheZoomLevels=A.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=A.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=A.preserveDrawingBuffer,this._antialias=A.antialias,this._trackResize=A.trackResize,this._bearingSnap=A.bearingSnap,this._refreshExpiredTiles=A.refreshExpiredTiles,this._fadeDuration=A.fadeDuration,this._crossSourceCollisions=A.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=A.collectResourceTiming,this._renderTaskQueue=new Nc,this._controls=[],this._mapId=h.uniqueId(),this._locale=h.extend({},v5,A.locale),this._clickTolerance=A.clickTolerance,this._overridePixelRatio=A.pixelRatio,this._maxCanvasSize=A.maxCanvasSize,this.transformCameraUpdate=A.transformCameraUpdate,this._imageQueueHandle=g.addThrottleControl(()=>this.isMoving()),this._requestManager=new et(A.transformRequest),"string"==typeof A.container){if(this._container=document.getElementById(A.container),!this._container)throw new Error(`Container '${A.container}' not found.`)}else{if(!(A.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=A.container}if(A.maxBounds&&this.setMaxBounds(A.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let _=!1;const x=SD(C=>{this._trackResize&&!this._removed&&this.resize(C)._update()},50);this._resizeObserver=new ResizeObserver(C=>{_?x(C):_=!0}),this._resizeObserver.observe(this._container)}this.handlers=new MD(this,A),this._hash=A.hash&&new Yu("string"==typeof A.hash&&A.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:A.center,zoom:A.zoom,bearing:A.bearing,pitch:A.pitch}),A.bounds&&(this.resize(),this.fitBounds(A.bounds,h.extend({},A.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=A.localIdeographFontFamily,this._validateStyle=A.validateStyle,A.style&&this.setStyle(A.style,{localIdeographFontFamily:A.localIdeographFontFamily}),A.attributionControl&&this.addControl(new V_("boolean"==typeof A.attributionControl?void 0:A.attributionControl)),A.maplibreLogo&&this.addControl(new B_,A.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",_=>{this._update("style"===_.dataType),this.fire(new h.Event(_.dataType+"data",_))}),this.on("dataloading",_=>{this.fire(new h.Event(_.dataType+"dataloading",_))}),this.on("dataabort",_=>{this.fire(new h.Event("sourcedataabort",_))})}_getMapId(){return this._mapId}addControl(A,d){var _;return void 0===d&&(d=A.getDefaultPosition?A.getDefaultPosition():"top-right"),A&&A.onAdd?(_=A.onAdd(this),this._controls.push(A),A=this._controlPositions[d],-1!==d.indexOf("bottom")?A.insertBefore(_,A.firstChild):A.appendChild(_),this):this.fire(new h.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")))}removeControl(A){var d;return A&&A.onRemove?(-1<(d=this._controls.indexOf(A))&&this._controls.splice(d,1),A.onRemove(this),this):this.fire(new h.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")))}hasControl(A){return-1<this._controls.indexOf(A)}calculateCameraOptionsFromTo(A,d,_,x){return null==x&&this.terrain&&(x=this.terrain.getElevationForLngLatZoom(_,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(A,d,_,x)}resize(A){var _,d=(_=this._containerDimensions())[0];const x=this._getClampedPixelRatio(d,_=_[1]);if(this._resizeCanvas(d,_,x),this.painter.resize(d,_,x),this.painter.overLimit()){var C=this.painter.context.gl;this._maxCanvasSize=[C.drawingBufferWidth,C.drawingBufferHeight];const M=this._getClampedPixelRatio(d,_);this._resizeCanvas(d,_,M),this.painter.resize(d,_,M)}return this.transform.resize(d,_),null!=(C=this._requestedCameraState)&&C.resize(d,_),(C=!this._moving)&&(this.stop(),this.fire(new h.Event("movestart",A)).fire(new h.Event("move",A))),this.fire(new h.Event("resize",A)),C&&this.fire(new h.Event("moveend",A)),this}_getClampedPixelRatio(M,B){var{0:_,1:x}=this._maxCanvasSize,C=this.getPixelRatio();return M*=C,B*=C,Math.min(_<M?_/M:1,x<B?x/B:1)*C}getPixelRatio(){var A;return null!=(A=this._overridePixelRatio)?A:devicePixelRatio}setPixelRatio(A){this._overridePixelRatio=A,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(A){return this.transform.setMaxBounds(yn.convert(A)),this._update()}setMinZoom(A){if(-2<=(A=A??-2)&&A<=this.transform.maxZoom)return this.transform.minZoom=A,this._update(),this.getZoom()<A&&this.setZoom(A),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(A){if((A=A??22)>=this.transform.minZoom)return this.transform.maxZoom=A,this._update(),this.getZoom()>A&&this.setZoom(A),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(A){if((A=A??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(0<=A&&A<=this.transform.maxPitch)return this.transform.minPitch=A,this._update(),this.getPitch()<A&&this.setPitch(A),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(A){if(85<(A=A??60))throw new Error("maxPitch must be less than or equal to 85");if(A>=this.transform.minPitch)return this.transform.maxPitch=A,this._update(),this.getPitch()>A&&this.setPitch(A),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(A){return this.transform.renderWorldCopies=A,this._update()}project(A){return this.transform.locationPoint(h.LngLat.convert(A),this.style&&this.terrain)}unproject(A){return this.transform.pointLocation(h.Point.convert(A),this.terrain)}isMoving(){var A;return this._moving||(null==(A=this.handlers)?void 0:A.isMoving())}isZooming(){var A;return this._zooming||(null==(A=this.handlers)?void 0:A.isZooming())}isRotating(){var A;return this._rotating||(null==(A=this.handlers)?void 0:A.isRotating())}_createDelegatedListener(A,d,_){if("mouseenter"===A||"mouseover"===A){let x=!1;return{layer:d,listener:_,delegates:{mousemove:C=>{var M=this.getLayer(d)?this.queryRenderedFeatures(C.point,{layers:[d]}):[];M.length?x||(x=!0,_.call(this,new Sl(A,this,C.originalEvent,{features:M}))):x=!1},mouseout:()=>{x=!1}}}}if("mouseleave"!==A&&"mouseout"!==A)return{layer:d,listener:_,delegates:{[A]:x=>{var C=this.getLayer(d)?this.queryRenderedFeatures(x.point,{layers:[d]}):[];C.length&&(x.features=C,_.call(this,x),delete x.features)}}};{let x=!1;return{layer:d,listener:_,delegates:{mousemove:C=>{(this.getLayer(d)?this.queryRenderedFeatures(C.point,{layers:[d]}):[]).length?x=!0:x&&(x=!1,_.call(this,new Sl(A,this,C.originalEvent)))},mouseout:C=>{x&&(x=!1,_.call(this,new Sl(A,this,C.originalEvent)))}}}}}on(A,d,_){if(void 0===_)return super.on(A,d);var x=this._createDelegatedListener(A,d,_);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[A]=this._delegatedListeners[A]||[],this._delegatedListeners[A].push(x);for(const C in x.delegates)this.on(C,x.delegates[C]);return this}once(A,d,_){if(void 0===_)return super.once(A,d);var x=this._createDelegatedListener(A,d,_);for(const C in x.delegates)this.once(C,x.delegates[C]);return this}off(A,d,_){return void 0===_?super.off(A,d):(this._delegatedListeners&&this._delegatedListeners[A]&&(x=>{var C=this._delegatedListeners[A];for(let B=0;B<C.length;B++){var M=C[B];if(M.layer===d&&M.listener===_){for(const U in M.delegates)this.off(U,M.delegates[U]);return C.splice(B,1),this}}})(),this)}queryRenderedFeatures(A,d){if(!this.style)return[];let _;var x=A instanceof h.Point||Array.isArray(A),C=x?A:[[0,0],[this.transform.width,this.transform.height]];return d=d||(x?{}:A)||{},_=C instanceof h.Point||"number"==typeof C[0]?[h.Point.convert(C)]:(x=h.Point.convert(C[0]),A=h.Point.convert(C[1]),[x,new h.Point(A.x,x.y),A,new h.Point(x.x,A.y),x]),this.style.queryRenderedFeatures(_,d,this.transform)}querySourceFeatures(A,d){return this.style.querySourceFeatures(A,d)}setStyle(A,d){return!1!==(d=h.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},d)).diff&&d.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&A?(this._diffStyle(A,d),this):(this._localIdeographFontFamily=d.localIdeographFontFamily,this._updateStyle(A,d))}setTransformRequest(A){return this._requestManager.setTransformRequest(A),this}_getUIString(A){var d=this._locale[A];if(null==d)throw new Error(`Missing UI string '${A}'`);return d}_updateStyle(A,d){var _;if(!d.transformStyle||!this.style||this.style._loaded)return _=this.style&&d.transformStyle?this.style.serialize():void 0,this.style&&(this.style.setEventedParent(null),this.style._remove(!A)),A?(this.style=new Ia(this,d||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof A?this.style.loadURL(A,d,_):this.style.loadJSON(A,d,_)):delete this.style,this;this.style.once("style.load",()=>this._updateStyle(A,d))}_lazyInitEmptyStyle(){this.style||(this.style=new Ia(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(A,d){var _;"string"==typeof A?(_=this._requestManager.transformRequest(A,"Style"),h.getJSON(_,new AbortController).then(x=>{this._updateDiff(x.data,d)}).catch(x=>{x&&this.fire(new h.ErrorEvent(x))})):"object"==typeof A&&this._updateDiff(A,d)}_updateDiff(A,d){try{this.style.setState(A,d)&&this._update(!0)}catch(_){h.warnOnce(`Unable to perform style diff: ${_.message||_.error||_}.  Rebuilding the style from scratch.`),this._updateStyle(A,d)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():h.warnOnce("There is no style added to the map.")}addSource(A,d){return this._lazyInitEmptyStyle(),this.style.addSource(A,d),this._update(!0)}isSourceLoaded(A){var d=this.style&&this.style.sourceCaches[A];if(void 0!==d)return d.loaded();this.fire(new h.ErrorEvent(new Error(`There is no source with ID '${A}'`)))}setTerrain(A){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),A){var d=this.style.sourceCaches[A.source];if(!d)throw new Error("cannot load terrain, because there exists no source with ID: "+A.source);null===this.terrain&&d.reload();for(const x in this.style._layers){var _=this.style._layers[x];"hillshade"===_.type&&_.source===A.source&&h.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Bw(this.painter,d,A),this.painter.renderToTexture=new CT(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=x=>{"style"===x.dataType?this.terrain.sourceCache.freeRtt():"source"===x.dataType&&x.tile&&(x.sourceId!==A.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(x.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new h.Event("terrain",{terrain:A})),this}getTerrain(){var A;return null!=(A=null==(A=this.terrain)?void 0:A.options)?A:null}areTilesLoaded(){var A=this.style&&this.style.sourceCaches;for(const x in A){var d=A[x]._tiles;for(const C in d){var _=d[C];if("loaded"!==_.state&&"errored"!==_.state)return!1}}return!0}removeSource(A){return this.style.removeSource(A),this._update(!0)}getSource(A){return this.style.getSource(A)}addImage(A,d,U={}){var x,C,M,B,{pixelRatio:U=1,sdf:K=!1,stretchX:re,stretchY:ce,content:ee,contentMatch:he}=U;if(this._lazyInitEmptyStyle(),!(d instanceof HTMLImageElement||h.isImageBitmap(d)))return void 0===d.width||void 0===d.height?this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):(({width:x,height:C,data:M}=d),B=d,this.style.addImage(A,{data:new h.RGBAImage({width:x,height:C},new Uint8Array(M)),pixelRatio:U,stretchX:re,stretchY:ce,content:ee,contentMatch:he,sdf:K,version:0,userImage:B}),B.onAdd&&B.onAdd(this,A),this);({width:x,height:C,data:M}=P.getImageData(d)),this.style.addImage(A,{data:new h.RGBAImage({width:x,height:C},M),pixelRatio:U,stretchX:re,stretchY:ce,content:ee,contentMatch:he,sdf:K,version:0})}updateImage(A,d){var _,x,C,M=this.style.getImage(A);return M?(({width:C,height:_,data:x}=d instanceof HTMLImageElement||h.isImageBitmap(d)?P.getImageData(d):d),void 0===C||void 0===_?this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):C!==M.data.width||_!==M.data.height?this.fire(new h.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(C=!(d instanceof HTMLImageElement||h.isImageBitmap(d)),M.data.replace(x,C),this.style.updateImage(A,M),this)):this.fire(new h.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")))}getImage(A){return this.style.getImage(A)}hasImage(A){return A?!!this.style.getImage(A):(this.fire(new h.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(A){this.style.removeImage(A)}loadImage(A){return g.getImage(this._requestManager.transformRequest(A,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(A,d){return this._lazyInitEmptyStyle(),this.style.addLayer(A,d),this._update(!0)}moveLayer(A,d){return this.style.moveLayer(A,d),this._update(!0)}removeLayer(A){return this.style.removeLayer(A),this._update(!0)}getLayer(A){return this.style.getLayer(A)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(A,d,_){return this.style.setLayerZoomRange(A,d,_),this._update(!0)}setFilter(A,d,_={}){return this.style.setFilter(A,d,_),this._update(!0)}getFilter(A){return this.style.getFilter(A)}setPaintProperty(A,d,_,x={}){return this.style.setPaintProperty(A,d,_,x),this._update(!0)}getPaintProperty(A,d){return this.style.getPaintProperty(A,d)}setLayoutProperty(A,d,_,x={}){return this.style.setLayoutProperty(A,d,_,x),this._update(!0)}getLayoutProperty(A,d){return this.style.getLayoutProperty(A,d)}setGlyphs(A,d={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(A,d),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(A,d,_={}){return this._lazyInitEmptyStyle(),this.style.addSprite(A,d,_,x=>{x||this._update(!0)}),this}removeSprite(A){return this._lazyInitEmptyStyle(),this.style.removeSprite(A),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(A,d={}){return this._lazyInitEmptyStyle(),this.style.setSprite(A,d,_=>{_||this._update(!0)}),this}setLight(A,d={}){return this._lazyInitEmptyStyle(),this.style.setLight(A,d),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(A,d){return this.style.setFeatureState(A,d),this._update()}removeFeatureState(A,d){return this.style.removeFeatureState(A,d),this._update()}getFeatureState(A){return this.style.getFeatureState(A)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let A=0,d=0;return this._container&&(A=this._container.clientWidth||400,d=this._container.clientHeight||300),[A,d]}_setupContainer(){var A=this._container,d=(A.classList.add("maplibregl-map"),this._canvasContainer=N.create("div","maplibregl-canvas-container",A)),_=(this._interactive&&d.classList.add("maplibregl-interactive"),this._canvas=N.create("canvas","maplibregl-canvas",d),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region"),d=this._containerDimensions(),this._getClampedPixelRatio(d[0],d[1]));this._resizeCanvas(d[0],d[1],_);const x=this._controlContainer=N.create("div","maplibregl-control-container",A),C=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(M=>{C[M]=N.create("div",`maplibregl-ctrl-${M} `,x)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(A,d,_){this._canvas.width=Math.floor(_*A),this._canvas.height=Math.floor(_*d),this._canvas.style.width=A+"px",this._canvas.style.height=d+"px"}_setupPainter(){const A={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let d=null;this._canvas.addEventListener("webglcontextcreationerror",C=>{d={requestedAttributes:A},C&&(d.statusMessage=C.statusMessage,d.type=C.type)},{once:!0});var _,x=this._canvas.getContext("webgl2",A)||this._canvas.getContext("webgl",A);if(!x)throw _="Failed to initialize WebGL",d?(d.message=_,new Error(JSON.stringify(d))):new Error(_);this.painter=new WN(x,this.transform),z.testSupport(x)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(A){return this.style&&this.style._loaded&&(this._styleDirty=this._styleDirty||A,this._sourcesDirty=!0,this.triggerRepaint()),this}_requestRenderFrame(A){return this._update(),this._renderTaskQueue.add(A)}_cancelRenderFrame(A){this._renderTaskQueue.remove(A)}_render(A){var d=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(A),!this._removed){let x=!1;this.style&&this._styleDirty&&(this._styleDirty=!1,A=this.transform.zoom,_=P.now(),this.style.zoomHistory.update(A,_),1===(_=(A=new h.EvaluationParameters(A,{now:_,fadeDuration:d,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()})).crossFadingFactor())&&_===this._crossFadingFactor||(x=!0,this._crossFadingFactor=_),this.style.update(A)),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,d,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:d,showPadding:this.showPadding}),this.fire(new h.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,h.PerformanceUtils.mark(h.PerformanceMarkers.load),this.fire(new h.Event("load"))),this.style&&(this.style.hasTransitions()||x)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();var _=this._sourcesDirty||this._styleDirty||this._placementDirty;return _||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.Event("idle")),!this._loaded||this._fullyLoaded||_||(this._fullyLoaded=!0,h.PerformanceUtils.mark(h.PerformanceMarkers.fullLoad)),this}}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),g.removeThrottleControl(this._imageQueueHandle),null!=(A=this._resizeObserver)&&A.disconnect();var A=this.painter.context.gl.getExtension("WEBGL_lose_context");A&&A.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),N.remove(this._canvasContainer),N.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),h.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new h.Event("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,P.frameAsync(this._frameRequest).then(A=>{h.PerformanceUtils.frame(A),this._frameRequest=null,this._render(A)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(A){this._showTileBoundaries!==A&&(this._showTileBoundaries=A,this._update())}get showPadding(){return!!this._showPadding}set showPadding(A){this._showPadding!==A&&(this._showPadding=A,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(A){this._showCollisionBoxes!==A&&((this._showCollisionBoxes=A)?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(A){this._showOverdrawInspector!==A&&(this._showOverdrawInspector=A,this._update())}get repaint(){return!!this._repaint}set repaint(A){this._repaint!==A&&(this._repaint=A,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(A){this._vertices=A,this._update()}get version(){return IT}getCameraTargetElevation(){return this.transform.elevation}};const Uw=A=>{A.touchstart=A.dragStart,A.touchmoveWindow=A.dragMove,A.touchend=A.dragEnd},OD={showCompass:!0,showZoom:!0,visualizePitch:!1};class DT{constructor(d,_,x=!1){this.mousedown=B=>{this.startMouse(h.extend({},B,{ctrlKey:!0,preventDefault:()=>B.preventDefault()}),N.mousePos(this.element,B)),N.addEventListener(window,"mousemove",this.mousemove),N.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=B=>{this.moveMouse(B,N.mousePos(this.element,B))},this.mouseup=B=>{this.mouseRotate.dragEnd(B),this.mousePitch&&this.mousePitch.dragEnd(B),this.offTemp()},this.touchstart=B=>{1!==B.targetTouches.length?this.reset():(this._startPos=this._lastPos=N.touchPos(this.element,B.targetTouches)[0],this.startTouch(B,this._startPos),N.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.addEventListener(window,"touchend",this.touchend))},this.touchmove=B=>{1!==B.targetTouches.length?this.reset():(this._lastPos=N.touchPos(this.element,B.targetTouches)[0],this.moveTouch(B,this._lastPos))},this.touchend=B=>{0===B.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;var C=d.dragRotate._mouseRotate.getClickTolerance(),M=d.dragRotate._mousePitch.getClickTolerance();this.element=_,this.mouseRotate=Oc({clickTolerance:C,enable:!0}),this.touchRotate=(({enable:A,clickTolerance:d,bearingDegreesPerPixelMoved:_=.8})=>{var x=new kw;return new uo({clickTolerance:d,move:(C,M)=>({bearingDelta:(M.x-C.x)*_}),moveStateManager:x,enable:A,assignEvents:Uw})})({clickTolerance:C,enable:!0}),this.map=d,x&&(this.mousePitch=Ow({clickTolerance:M,enable:!0}),this.touchPitch=(({enable:A,clickTolerance:d,pitchDegreesPerPixelMoved:_=-.5})=>{var x=new kw;return new uo({clickTolerance:d,move:(C,M)=>({pitchDelta:(M.y-C.y)*_}),moveStateManager:x,enable:A,assignEvents:Uw})})({clickTolerance:M,enable:!0})),N.addEventListener(_,"mousedown",this.mousedown),N.addEventListener(_,"touchstart",this.touchstart,{passive:!1}),N.addEventListener(_,"touchcancel",this.reset)}startMouse(d,_){this.mouseRotate.dragStart(d,_),this.mousePitch&&this.mousePitch.dragStart(d,_),N.disableDrag()}startTouch(d,_){this.touchRotate.dragStart(d,_),this.touchPitch&&this.touchPitch.dragStart(d,_),N.disableDrag()}moveMouse(d,_){var x=this.map,C=(this.mouseRotate.dragMove(d,_)||{}).bearingDelta;C&&x.setBearing(x.getBearing()+C),this.mousePitch&&(C=(this.mousePitch.dragMove(d,_)||{}).pitchDelta)&&x.setPitch(x.getPitch()+C)}moveTouch(d,_){var x=this.map,C=(this.touchRotate.dragMove(d,_)||{}).bearingDelta;C&&x.setBearing(x.getBearing()+C),this.touchPitch&&(C=(this.touchPitch.dragMove(d,_)||{}).pitchDelta)&&x.setPitch(x.getPitch()+C)}off(){var d=this.element;N.removeEventListener(d,"mousedown",this.mousedown),N.removeEventListener(d,"touchstart",this.touchstart,{passive:!1}),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend),N.removeEventListener(d,"touchcancel",this.reset),this.offTemp()}offTemp(){N.enableDrag(),N.removeEventListener(window,"mousemove",this.mousemove),N.removeEventListener(window,"mouseup",this.mouseup),N.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),N.removeEventListener(window,"touchend",this.touchend)}}let Bg;function jw(A,d,_){var x,C,M,B=new h.LngLat(A.lng,A.lat);for(A=new h.LngLat(A.lng,A.lat),d&&(x=new h.LngLat(A.lng-360,A.lat),C=new h.LngLat(A.lng+360,A.lat),M=_.locationPoint(A).distSqr(d),_.locationPoint(x).distSqr(d)<M?A=x:_.locationPoint(C).distSqr(d)<M&&(A=C));180<Math.abs(A.lng-_.center.lng);){var U=_.locationPoint(A);if(0<=U.x&&0<=U.y&&U.x<=_.width&&U.y<=_.height)break;A.lng>_.center.lng?A.lng-=360:A.lng+=360}return A.lng!==B.lng&&_.locationPoint(A).y>_.height/2-_.getHorizon()?A:B}const z_={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ND(A,d,_){var x=A.classList;for(const C in z_)x.remove(`maplibregl-${_}-anchor-`+C);x.add(`maplibregl-${_}-anchor-`+d)}class Hw extends h.Evented{constructor(d){if(super(),this._onKeyPress=Se=>{var Ee=Se.code;Se=Se.charCode||Se.keyCode,"Space"!==Ee&&"Enter"!==Ee&&32!==Se&&13!==Se||this.togglePopup()},this._onMapClick=Ee=>{Ee=Ee.originalEvent.target;var Se=this._element;this._popup&&(Ee===Se||Se.contains(Ee))&&this.togglePopup()},this._update=he=>{if(this._map){var Ee=this._map.loaded()&&!this._map.isMoving();"terrain"!==he?.type&&("render"!==he?.type||Ee)||this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?jw(this._lngLat,this._flatPos,this._map.transform):null==(Ee=this._lngLat)?void 0:Ee.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let Se="",Oe=("viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?Se=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(Se=`rotateZ(${this._rotation-this._map.getBearing()}deg)`),"");"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?Oe="rotateX(0deg)":"map"===this._pitchAlignment&&(Oe=`rotateX(${this._map.getPitch()}deg)`),he&&"moveend"!==he.type||(this._pos=this._pos.round()),N.setTransform(this._element,`${z_[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${Oe} `+Se),P.frameAsync(new AbortController).then(()=>{this._updateOpacity(he&&"moveend"===he.type)}).catch(()=>{})}},this._onMove=he=>{var Ee;this._isDragging||(Ee=this._clickTolerance||this._map._clickTolerance,this._isDragging=he.point.dist(this._pointerdownPos)>=Ee),this._isDragging&&(this._pos=he.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new h.Event("dragstart"))),this.fire(new h.Event("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new h.Event("dragend")),this._state="inactive"},this._addDragHandler=he=>{this._element.contains(he.originalEvent.target)&&(he.preventDefault(),this._positionDelta=he.point.sub(this._pos).add(this._offset),this._pointerdownPos=he.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=d&&d.anchor||"center",this._color=d&&d.color||"#3FB1CE",this._scale=d&&d.scale||1,this._draggable=d&&d.draggable||!1,this._clickTolerance=d&&d.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=d&&d.rotation||0,this._rotationAlignment=d&&d.rotationAlignment||"auto",this._pitchAlignment=d&&d.pitchAlignment&&"auto"!==d.pitchAlignment?d.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(d?.opacity,d?.opacityWhenCovered),d&&d.element)this._element=d.element,this._offset=h.Point.convert(d&&d.offset||[0,0]);else{this._defaultMarker=!0,this._element=N.create("div"),this._element.setAttribute("aria-label","Map marker");var x,_=N.createNS("http://www.w3.org/2000/svg","svg"),C=(((_.setAttributeNS(null,"display","block"),_.setAttributeNS(null,"height","41px"),_.setAttributeNS(null,"width","27px"),_.setAttributeNS(null,"viewBox","0 0 27 41"),x=N.createNS("http://www.w3.org/2000/svg","g")).setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd"),x=N.createNS("http://www.w3.org/2000/svg","g")).setAttributeNS(null,"fill-rule","nonzero"),N.createNS("http://www.w3.org/2000/svg","g")),B=(C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000"),[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}]);for(const he of B){var M=N.createNS("http://www.w3.org/2000/svg","ellipse");M.setAttributeNS(null,"opacity","0.04"),M.setAttributeNS(null,"cx","10.5"),M.setAttributeNS(null,"cy","5.80029008"),M.setAttributeNS(null,"rx",he.rx),M.setAttributeNS(null,"ry",he.ry),C.appendChild(M)}var U,K,re=((((((B=N.createNS("http://www.w3.org/2000/svg","g")).setAttributeNS(null,"fill",this._color),U=N.createNS("http://www.w3.org/2000/svg","path")).setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(U),U=N.createNS("http://www.w3.org/2000/svg","g")).setAttributeNS(null,"opacity","0.25"),U.setAttributeNS(null,"fill","#000000"),K=N.createNS("http://www.w3.org/2000/svg","path")).setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),U.appendChild(K),K=N.createNS("http://www.w3.org/2000/svg","g")).setAttributeNS(null,"transform","translate(6.0, 7.0)"),K.setAttributeNS(null,"fill","#FFFFFF"),N.createNS("http://www.w3.org/2000/svg","g")),ce=(re.setAttributeNS(null,"transform","translate(8.0, 8.0)"),N.createNS("http://www.w3.org/2000/svg","circle")),ee=(ce.setAttributeNS(null,"fill","#000000"),ce.setAttributeNS(null,"opacity","0.25"),ce.setAttributeNS(null,"cx","5.5"),ce.setAttributeNS(null,"cy","5.5"),ce.setAttributeNS(null,"r","5.4999962"),N.createNS("http://www.w3.org/2000/svg","circle"));ee.setAttributeNS(null,"fill","#FFFFFF"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962"),re.appendChild(ce),re.appendChild(ee),x.appendChild(C),x.appendChild(B),x.appendChild(U),x.appendChild(K),x.appendChild(re),_.appendChild(x),_.setAttributeNS(null,"height",41*this._scale+"px"),_.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(_),this._offset=h.Point.convert(d&&d.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",he=>{he.preventDefault()}),this._element.addEventListener("mousedown",he=>{he.preventDefault()}),ND(this._element,this._anchor,"marker"),d&&d.className)for(const he of d.className.split(" "))this._element.classList.add(he);this._popup=null}addTo(d){return this.remove(),(this._map=d).getCanvasContainer().appendChild(this._element),d.on("move",this._update),d.on("moveend",this._update),d.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),N.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=h.LngLat.convert(d),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(d){var _;return this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),d&&("offset"in d.options||(_=Math.abs(13.5)/Math.SQRT2,d.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(24.6+_)],"bottom-right":[-_,-1*(24.6+_)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset),this._popup=d,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)),this}getPopup(){return this._popup}togglePopup(){var d=this._popup;return this._element.style.opacity!==this._opacityWhenCovered&&d&&(d.isOpen()?d.remove():(d.setLngLat(this._lngLat),d.addTo(this._map))),this}_updateOpacity(d=!1){if(null!=(x=this._map)&&x.terrain){if(d)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}var _,x=this._map,C=(d=x.terrain.depthAtPoint(this._pos),x.terrain.getElevationForLngLatZoom(this._lngLat,x.transform.tileZoom));x.transform.lngLatToCameraDepth(this._lngLat,C)-d<.006?this._element.style.opacity=this._opacity:(d=-this._offset.y/x.transform._pixelPerMeter,d=Math.sin(x.getPitch()*Math.PI/180)*d,_=x.terrain.depthAtPoint(new h.Point(this._pos.x,this._pos.y-this._offset.y)),x=.006<x.transform.lngLatToCameraDepth(this._lngLat,C+d)-_,null!=(C=this._popup)&&C.isOpen()&&x&&this._popup.remove(),this._element.style.opacity=x?this._opacityWhenCovered:this._opacity)}else this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity)}getOffset(){return this._offset}setOffset(d){return this._offset=h.Point.convert(d),this._update(),this}addClassName(d){this._element.classList.add(d)}removeClassName(d){this._element.classList.remove(d)}toggleClassName(d){return this._element.classList.toggle(d)}setDraggable(d){return this._draggable=!!d,this._map&&(d?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(d){return this._rotation=d||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(d){return this._rotationAlignment=d||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(d){return this._pitchAlignment=d&&"auto"!==d?d:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(d,_){return void 0===d&&void 0===_&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==d&&(this._opacity=d),void 0!==_&&(this._opacityWhenCovered=_),this._map&&this._updateOpacity(!0),this}}const w5={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let j_=0,RT=!1;const $w={maxWidth:100,unit:"metric"};function MT(A,d,_){var x=_&&_.maxWidth||100,M=A.unproject([0,C=A._container.clientHeight/2]),C=A.unproject([x,C]);M=M.distanceTo(C),_&&"imperial"===_.unit?5280<(C=3.2808*M)?Ug(d,x,C/5280,A._getUIString("ScaleControl.Miles")):Ug(d,x,C,A._getUIString("ScaleControl.Feet")):_&&"nautical"===_.unit?Ug(d,x,M/1852,A._getUIString("ScaleControl.NauticalMiles")):1e3<=M?Ug(d,x,M/1e3,A._getUIString("ScaleControl.Kilometers")):Ug(d,x,M,A._getUIString("ScaleControl.Meters"))}function Ug(A,d,_,x){var M,U,K,B,C=(M=_,(B=Math.pow(10,(""+Math.floor(M)).length-1))*(M=10<=(M/=B)?10:5<=M?5:3<=M?3:2<=M?2:1<=M?1:(U=M,K=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10)),Math.round(U*K)/K)));A.style.width=d*(C/_)+"px",A.innerHTML=C+"&nbsp;"+x}const kT={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},OT=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function H_(A){var d;return A?"number"==typeof A?(d=Math.round(Math.abs(A)/Math.SQRT2),{center:new h.Point(0,0),top:new h.Point(0,A),"top-left":new h.Point(d,d),"top-right":new h.Point(-d,d),bottom:new h.Point(0,-A),"bottom-left":new h.Point(d,-d),"bottom-right":new h.Point(-d,-d),left:new h.Point(A,0),right:new h.Point(-A,0)}):A instanceof h.Point||Array.isArray(A)?{center:d=h.Point.convert(A),top:d,"top-left":d,"top-right":d,bottom:d,"bottom-left":d,"bottom-right":d,left:d,right:d}:{center:h.Point.convert(A.center||[0,0]),top:h.Point.convert(A.top||[0,0]),"top-left":h.Point.convert(A["top-left"]||[0,0]),"top-right":h.Point.convert(A["top-right"]||[0,0]),bottom:h.Point.convert(A.bottom||[0,0]),"bottom-left":h.Point.convert(A["bottom-left"]||[0,0]),"bottom-right":h.Point.convert(A["bottom-right"]||[0,0]),left:h.Point.convert(A.left||[0,0]),right:h.Point.convert(A.right||[0,0])}:H_(new h.Point(0,0))}const W7=w;u.AJAXError=h.AJAXError,u.Evented=h.Evented,u.LngLat=h.LngLat,u.MercatorCoordinate=h.MercatorCoordinate,u.Point=h.Point,u.addProtocol=h.addProtocol,u.config=h.config,u.removeProtocol=h.removeProtocol,u.AttributionControl=V_,u.BoxZoomHandler=yT,u.CanvasSource=De,u.CooperativeGesturesHandler=TT,u.DoubleClickZoomHandler=ET,u.DragPanHandler=Nw,u.DragRotateHandler=Np,u.EdgeInsets=N_,u.FullscreenControl=class FD extends h.Evented{constructor(d={}){super(),this._onFullscreenChange=()=>{var _;let x=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null!=(_=x?.shadowRoot)&&_.fullscreenElement;)x=x.shadowRoot.fullscreenElement;x===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,d&&d.container&&(d.container instanceof HTMLElement?this._container=d.container:h.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){N.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){var d=this._fullscreenButton=N.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);N.create("span","maplibregl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){var d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.title=d}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new h.Event("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new h.Event("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},u.GeoJSONSource=oe,u.GeolocateControl=class LD extends h.Evented{constructor(d){super(),this._onSuccess=_=>{if(this._map){if(this._isOutOfMapMaxBounds(_))this._setErrorState(),this.fire(new h.Event("outofmaxbounds",_)),this._updateMarker();else{if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error("Unexpected watchState "+this._watchState)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(_),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new h.Event("geolocate",_))}this._finish()}},this._updateCamera=x=>{var M=new h.LngLat(x.coords.longitude,x.coords.latitude),C=(x=x.coords.accuracy,this._map.getBearing());C=h.extend({bearing:C},this.options.fitBoundsOptions),M=yn.fromLngLat(M,x),this._map.fitBounds(M,C,{geolocateSource:!0})},this._updateMarker=_=>{var x;_?(x=new h.LngLat(_.coords.longitude,_.coords.latitude),this._accuracyCircleMarker.setLngLat(x).addTo(this._map),this._userLocationDotMarker.setLngLat(x).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()):(this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove())},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=_=>{if(this._map){if(this.options.trackUserLocation)if(1===_.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var x=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=x,this._geolocateButton.setAttribute("aria-label",x),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===_.code&&RT)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new h.Event("error",_)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=_=>{this._map&&(this._container.addEventListener("contextmenu",x=>x.preventDefault()),this._geolocateButton=N.create("button","maplibregl-ctrl-geolocate",this._container),N.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),!(this._geolocateButton.type="button")===_?(h.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled."),_=this._map._getUIString("GeolocateControl.LocationNotAvailable"),this._geolocateButton.disabled=!0,this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)):(_=this._map._getUIString("GeolocateControl.FindMyLocation"),this._geolocateButton.title=_,this._geolocateButton.setAttribute("aria-label",_)),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=N.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Hw({element:this._dotElement}),this._circleElement=N.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Hw({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation)&&this._map.on("movestart",x=>{x.geolocateSource||"ACTIVE_LOCK"!==this._watchState||x.originalEvent&&"resize"===x.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new h.Event("trackuserlocationend")))})},this.options=h.extend({},w5,d)}onAdd(d){return this._map=d,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function PT(){return h.__awaiter(this,arguments,void 0,function*(A=!1){if(void 0===Bg||A){if(void 0===window.navigator.permissions)return Bg=!!window.navigator.geolocation;try{var d=yield window.navigator.permissions.query({name:"geolocation"});Bg="denied"!==d.state}catch{Bg=!!window.navigator.geolocation}}return Bg})}().then(_=>this._setupUI(_)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),N.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,j_=0,RT=!1}_isOutOfMapMaxBounds(x){var _=this._map.getMaxBounds();return x=x.coords,_&&(x.longitude<_.getWest()||x.longitude>_.getEast()||x.latitude<_.getSouth()||x.latitude>_.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error("Unexpected watchState "+this._watchState)}}_updateCircleRadius(){var _=(d=this._map.getBounds()).getSouthEast(),d=d.getNorthEast();_=_.distanceTo(d),d=this._map._container.clientHeight,_=Math.ceil(this._accuracy/(_/d)*2),this._circleElement.style.width=_+"px",this._circleElement.style.height=_+"px"}trigger(){if(!this._setup)return h.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":j_--,RT=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new h.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.Event("trackuserlocationstart"));break;default:throw new Error("Unexpected watchState "+this._watchState)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error("Unexpected watchState "+this._watchState)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let d;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),j_++,RT=1<j_?(d={maximumAge:6e5,timeout:0},!0):(d=this.options.positionOptions,!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},u.Hash=Yu,u.ImageSource=X,u.KeyboardHandler=No,u.LngLatBounds=yn,u.LogoControl=B_,u.Map=fi,u.MapMouseEvent=Sl,u.MapTouchEvent=Rp,u.MapWheelEvent=Xf,u.Marker=Hw,u.NavigationControl=class{constructor(A){this._updateZoomButtons=()=>{var d=(_=this._map.getZoom())===this._map.getMaxZoom(),_=_===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())},this._rotateCompassArrow=()=>{var d=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=d},this._setButtonTitle=(d,_)=>{_=this._map._getUIString("NavigationControl."+_),d.title=_,d.setAttribute("aria-label",_)},this.options=h.extend({},OD,A),this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",d=>d.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",d=>this._map.zoomIn({},{originalEvent:d})),N.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",d=>this._map.zoomOut({},{originalEvent:d})),N.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",d=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:d}):this._map.resetNorth({},{originalEvent:d})}),this._compassIcon=N.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(A){return this._map=A,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new DT(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){N.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(A,d){return(A=N.create("button",A,this._container)).type="button",A.addEventListener("click",d),A}},u.Popup=class Jf extends h.Evented{constructor(d){super(),this.remove=()=>(this._content&&N.remove(this._content),this._container&&(N.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new h.Event("close"))),this),this._onMouseUp=_=>{this._update(_.point)},this._onMouseMove=_=>{this._update(_.point)},this._onDrag=_=>{this._update(_.point)},this._update=_=>{var x=this._lngLat||this._trackPointer;if(this._map&&x&&this._content){if(!this._container){if(this._container=N.create("div","maplibregl-popup",this._map.getContainer()),this._tip=N.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const B of this.options.className.split(" "))this._container.classList.add(B);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?jw(this._lngLat,this._flatPos,this._map.transform):null==(x=this._lngLat)?void 0:x.wrap(),!this._trackPointer||_){x=this._flatPos=this._pos=this._trackPointer&&_?_:this._map.project(this._lngLat),this._map.terrain&&(this._flatPos=this._trackPointer&&_?_:this._map.transform.locationPoint(this._lngLat));let B=this.options.anchor;if(_=H_(this.options.offset),!B){var C=this._container.offsetWidth,M=this._container.offsetHeight;let K;K=x.y+_.bottom.y<M?["top"]:x.y>this._map.transform.height-M?["bottom"]:[],x.x<C/2?K.push("left"):x.x>this._map.transform.width-C/2&&K.push("right"),B=0===K.length?"bottom":K.join("-")}let U=x.add(_[B]);this.options.subpixelPositioning||(U=U.round()),N.setTransform(this._container,`${z_[B]} translate(${U.x}px,${U.y}px)`),ND(this._container,B,"popup")}}},this._onClose=()=>{this.remove()},this.options=h.extend(Object.create(kT),d)}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new h.Event("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=h.LngLat.convert(d),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(document.createTextNode(d))}setHTML(d){var _,x=document.createDocumentFragment(),C=document.createElement("body");for(C.innerHTML=d;_=C.firstChild;)x.appendChild(_);return this.setDOMContent(x)}getMaxWidth(){var d;return null==(d=this._container)?void 0:d.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=N.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(d),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(d){this._container&&this._container.classList.add(d)}removeClassName(d){this._container&&this._container.classList.remove(d)}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){if(this._container)return this._container.classList.toggle(d)}setSubpixelPositioning(d){this.options.subpixelPositioning=d}_createCloseButton(){this.options.closeButton&&(this._closeButton=N.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){var d;this.options.focusAfterOpen&&this._container&&(d=this._container.querySelector(OT))&&d.focus()}},u.RasterDEMTileSource=Jt,u.RasterTileSource=Ut,u.ScaleControl=class{constructor(A){this._onMove=()=>{MT(this._map,this._container,this.options)},this.setUnit=d=>{this.options.unit=d,MT(this._map,this._container,this.options)},this.options=h.extend({},$w,A)}getDefaultPosition(){return"bottom-left"}onAdd(A){return this._map=A,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-scale",A.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){N.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},u.ScrollZoomHandler=Op,u.Style=Ia,u.TerrainControl=class{constructor(A){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=A}onAdd(A){return this._map=A,this._container=N.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=N.create("button","maplibregl-ctrl-terrain",this._container),N.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){N.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},u.TwoFingersTouchPitchHandler=ZN,u.TwoFingersTouchRotateHandler=Fg,u.TwoFingersTouchZoomHandler=F_,u.TwoFingersTouchZoomRotateHandler=PD,u.VectorTileSource=st,u.VideoSource=ye,u.addSourceType=(A,d)=>h.__awaiter(void 0,void 0,void 0,function*(){if(wt(A))throw new Error(`A source type called "${A}" already exists.`);Ke[A]=d}),u.clearPrewarmedResources=function(){var A=dt;A&&(A.isPreloaded()&&1===A.numActive()?(A.release(sr),dt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},u.getMaxParallelImageRequests=function(){return h.config.MAX_PARALLEL_IMAGE_REQUESTS},u.getRTLTextPluginStatus=function(){return en().getRTLTextPluginStatus()},u.getVersion=function(){return W7},u.getWorkerCount=function(){return nn.workerCount},u.getWorkerUrl=function(){return h.config.WORKER_URL},u.importScriptInWorkers=function(A){return Wr().broadcast("IS",A)},u.prewarm=function(){pi().acquire(sr)},u.setMaxParallelImageRequests=function(A){h.config.MAX_PARALLEL_IMAGE_REQUESTS=A},u.setRTLTextPlugin=function(A,d){return en().setRTLTextPlugin(A,d)},u.setWorkerCount=function(A){nn.workerCount=A},u.setWorkerUrl=function(A){h.config.WORKER_URL=A}}),o}(),pn.exports)),Wp={exports:{}},Kg=function bC(a){var o,i;return a.__esModule?a:("function"==typeof(o=a.default)?(i=function l(){return this instanceof l?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)}).prototype=o.prototype:i={},Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(a).forEach(function(l){var u=Object.getOwnPropertyDescriptor(a,l);Object.defineProperty(i,l,u.get?u:{enumerable:!0,get:function(){return a[l]}})}),i)}(Object.freeze({__proto__:null,default:{}})),IF=(function(a){for(var o,i,l=0,u=[],h=0;h<256;h++)u[h]=(h+256).toString(16).substr(1);function g(){T=16,(!o||w.BUFFER_SIZE<l+T)&&(l=0,o=w.randomBytes(w.BUFFER_SIZE));var T=o.slice(l,l+=T);return T[6]=15&T[6]|64,T[8]=63&T[8]|128,T}function w(){var T=g();return u[T[0]]+u[T[1]]+u[T[2]]+u[T[3]]+"-"+u[T[4]]+u[T[5]]+"-"+u[T[6]]+u[T[7]]+"-"+u[T[8]]+u[T[9]]+"-"+u[T[10]]+u[T[11]]+u[T[12]]+u[T[13]]+u[T[14]]+u[T[15]]}w.BUFFER_SIZE=4096,w.bin=g,w.clearBuffer=function(){o=null,l=0},w.test=function(T){return"string"==typeof T&&/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(T)},typeof crypto<"u"?i=crypto:typeof window<"u"&&void 0!==window.msCrypto&&(i=window.msCrypto),i=i||Kg,a.exports=w,w.randomBytes=function(){if(i){if(i.randomBytes)return i.randomBytes;if(i.getRandomValues)return"function"!=typeof Uint8Array.prototype.slice?function(T){return T=new Uint8Array(T),i.getRandomValues(T),Array.from(T)}:function(T){return T=new Uint8Array(T),i.getRandomValues(T),T}}return function(T){for(var D=[],P=0;P<T;P++)D.push(Math.floor(256*Math.random()));return D}}()}(Wp),Wp.exports),dm=Nl(IF),mc={domain:"atlas.microsoft.com",staticAssetsDomain:"atlas.microsoft.com",stylePath:"styling",styleDefinitionsVersion:"2023-01-01",appInsightsKey:"e96cb745-c6f5-409c-a775-c4313e468c1d",aadInstance:"https://login.microsoftonline.com/"},pm=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},To=function(){function a(){}return a.prototype.merge=function(){for(var o,i,l,u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];try{for(var g=pm(u),w=g.next();!w.done;w=g.next()){var T=w.value;if(T)for(var D in T)T.hasOwnProperty(D)&&this.hasOwnProperty(D)&&(void 0!==T[D]&&null!=T[D]?this[D]instanceof a?this[D].merge(T[D]):this[D]=T[D]:(l=l||new(Object.getPrototypeOf(this).constructor),this[D]=l[D]))}}catch(P){o={error:P}}finally{try{w&&!w.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}return this},a}(),SF=window&&window.__extends||(a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)},function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}),OP=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},AF=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.domain=void 0,i.headers={},i.path="",i.protocol="https",i.queryParams={},i.subdomain="",i}return SF(o,a),o}(To),vu=function(){function a(o){this.options=(new AF).merge(o)}return a.prototype.get=function(){return fetch(this.toString(),{method:"GET",mode:"cors",headers:new Headers(this.options.headers)}).then(function(o){if(o.ok)return o.json();throw new Error("HTTP ".concat(o.status,": ").concat(o.statusText))})},a.prototype.toString=function(){var o=Object.entries(this.options.queryParams).map(function(g){var h=(g=OP(g,2))[0];return g=g[1],"".concat(h,"=").concat(g)}).join("&"),i=[],l=this.options.path||"";return a.protoRegEx.test(l)?i.push(l):(this.options.domain&&(a.protoRegEx.test(this.options.domain)||(i.push("".concat(this.options.protocol,"://")),i.push(this.options.subdomain?"".concat(this.options.subdomain,"."):"")),i.push(this.options.domain)),i.push(this.options.path?"/".concat(l):"")),i.push(o?"?".concat(o):""),i.join("")},a.protoRegEx=new RegExp(/^(((file|http|https):\/\/)|blob:)/i),a}(),DF=function(){function a(){}return a.parse=function(o){var i=(o=o.toLowerCase()).lastIndexOf("-");return-1!==i?{code:o,language:o.substring(0,i),region:o.substring(i+1)}:{code:o,language:o}},a}(),wu={localizationsPath:"locs/mapcontrol/2019-3-12",sensitiveUserRegions:["il","kr","pk","in","cn","ar","bh","eg","jo","sa","kw","om","qa","ma","ae"],locales:{defaultLanguage:{defaultRegion:{code:"NGT",strings:"en/resource.json"},latn:{code:"NGT-Latn",strings:"en/resource.json"}},ar:{defaultRegion:{code:"ar",strings:"ar-sa/resource.json"}},bg:{defaultRegion:{code:"bg-BG",strings:"bg-bg/resource.json"}},cs:{defaultRegion:{code:"cs-CZ",strings:"cs-cz/resource.json"}},da:{defaultRegion:{code:"da-DK",strings:"da-dk/resource.json"}},de:{defaultRegion:{code:"de-DE",strings:"de-de/resource.json"}},el:{defaultRegion:{code:"el-GR",strings:"el-gr/resource.json"}},en:{defaultRegion:{code:"en",strings:"en/resource.json"},us:{code:"en-US",strings:"en/resource.json"},au:{code:"en-AU",strings:"en/resource.json"},gb:{code:"en-GB",strings:"en/resource.json"},nz:{code:"en-NZ",strings:"en/resource.json"}},es:{defaultRegion:{code:"es-ES",strings:"es-es/resource.json"},mx:{code:"es-MX",strings:"es-mx/resource.json"}},fi:{defaultRegion:{code:"fi-FI",strings:"fi-fi/resource.json"}},fr:{defaultRegion:{code:"fr-FR",strings:"fr-fr/resource.json"}},hu:{defaultRegion:{code:"hu-HU",strings:"hu-hu/resource.json"}},id:{defaultRegion:{code:"id-ID",strings:"id-id/resource.json"}},it:{defaultRegion:{code:"it-IT",strings:"it-it/resource.json"}},ko:{defaultRegion:{code:"ko-KR",strings:"ko-kr/resource.json"}},lt:{defaultRegion:{code:"lt-LT",strings:"lt-lt/resource.json"}},ms:{defaultRegion:{code:"ms-MY",strings:"ms-my/resource.json"}},nb:{defaultRegion:{code:"nb-NO",strings:"nb-no/resource.json"}},nl:{defaultRegion:{code:"nl-NL",strings:"nl-nl/resource.json"}},pl:{defaultRegion:{code:"pl-PL",strings:"pl-pl/resource.json"}},pt:{defaultRegion:{code:"pt-PT",strings:"pt-pt/resource.json"},br:{code:"pt-BR",strings:"pt-br/resource.json"}},ru:{defaultRegion:{code:"ru-RU",strings:"ru-ru/resource.json"}},sk:{defaultRegion:{code:"sk-SK",strings:"sk-sk/resource.json"}},sl:{defaultRegion:{code:"sl-SL",strings:"sl-sl/resource.json"}},sv:{defaultRegion:{code:"sv-SE",strings:"sv-se/resource.json"}},th:{defaultRegion:{code:"th-TH",strings:"th-th/resource.json"}},tr:{defaultRegion:{code:"tr-TR",strings:"tr-tr/resource.json"}},zh:{defaultRegion:{code:"zh",strings:"en/resource.json"}},"zh-hans":{defaultRegion:{code:"zh-Hans",strings:"zh-cn/resource.json"},cn:{code:"zh-Hans-CN",strings:"zh-cn/resource.json"}},"zh-hant":{defaultRegion:{code:"zh-Hant",strings:"en/resource.json"},tw:{code:"zh-Hant-TW",strings:"zh-tw/resource.json"}}}},pv=function(){this.Unknown="Unknown",this.Accident="Accident",this.Fog="Fog",this.Danger="Danger",this.Rain="Rain",this.Ice="Ice",this.Jam="Jam",this.LaneClosed="Lane Closed",this.RoadClosed="Road Closed",this.RoadWorks="Road Works",this.Wind="Wind",this.Flood="Flood",this.Detour="Detour"},EC=function(){function a(){}return a.getCode=function(o){var i=DF.parse(o);return-1===wu.sensitiveUserRegions.indexOf(i.region)?this.getLocaleData(i).code:o},a.getStrings=function(o){return o=this.getLocaleData(o),wu.locales.defaultLanguage.defaultRegion.code===o.code?new Promise(function(i){i(new pv)}):new vu({domain:mc.staticAssetsDomain,path:"".concat(wu.localizationsPath,"/").concat(o.strings)}).get().then(function(i){return i},function(){return new pv})},a.getLocaleData=function(o){if("string"==typeof o&&(o=DF.parse(o)),wu.locales[o.code])return wu.locales[o.code].defaultRegion;var i;if(wu.locales[o.language])i=wu.locales[o.language];else{if(-1!==o.language.indexOf("-"))return this.getLocaleData(o.language);i=wu.locales.defaultLanguage}return o.region&&i[o.region]?i[o.region]:i.defaultRegion},a}(),xC=function(){function a(){}return a.getEdgeOrIEVersion=function(){var o=window.navigator.userAgent,i=o.indexOf("MSIE ");return 0<i?parseInt(o.substring(i+5,o.indexOf(".",i)),10):0<o.indexOf("Trident/")?(i=o.indexOf("rv:"),parseInt(o.substring(i+3,o.indexOf(".",i)),10)):0<(i=o.indexOf("Edge/"))?parseInt(o.substring(i+5,o.indexOf(".",i)),10):-1},a.isEdgeOrIE=function(){return-1!==this.getEdgeOrIEVersion()},a.isIE=function(){var o=this.getEdgeOrIEVersion();return-1!==o&&o<=11},a}(),Yp="3.4.0",fv=function(){function a(){}return a.getFullVersion=function(){return Yp},a.getEndpointVersion=function(){var o=Yp.indexOf(".");return-1===(o=Yp.indexOf(".",o+1))?Yp:Yp.substring(0,o)},a}(),Zp=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),PF=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},NP=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},ls=(function(a){a.subscriptionKey="subscriptionKey",a.aad="aad",a.anonymous="anonymous",a.sas="sas"}(so=so||{}),function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.authType=void 0,i.subscriptionKey=void 0,i.clientId=void 0,i.aadAppId=void 0,i.aadTenant=void 0,i.aadInstance=void 0,i.getToken=void 0,i.sasToken=void 0,i.authContext=void 0,i}return Zp(o,a),o.prototype.setSubscriptionKey=function(i){this.authType=so.subscriptionKey,this.subscriptionKey=i},o.prototype.setAadProperties=function(i,l,u,h,g){this.authType=so.aad,this.authContext=g||this.authContext,this.aadInstance=h||this.aadInstance,this.clientId=i,this.aadAppId=l,this.aadTenant=u},o.prototype.setTokenCallbackFunction=function(i){this.authType=so.anonymous,this.getToken=i},o.prototype.setSasCallbackFunction=function(i){this.authType=so.sas,this.getToken=i},o.prototype.merge=function(){for(var i=[],l=0;l<arguments.length;l++)i[l]=arguments[l];var u=a.prototype.merge.apply(this,NP([],PF(i),!1));return u.authType===so.subscriptionKey?u.authContext=u.aadAppId=u.getToken=void 0:u.authType===so.aad?u.subscriptionKey=u.getToken=void 0:u.authType===so.anonymous?u.subscriptionKey=u.authContext=u.aadAppId=void 0:u.authType===so.sas&&(u.authContext=u.subscriptionKey=u.aadAppId=void 0),u},o}(To)),pb=Qp;function Qp(a){return!function fb(a){return function RF(){return typeof window<"u"&&typeof document<"u"}()?function bu(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}()?function LP(){return Function.prototype&&Function.prototype.bind}()?function FP(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}()?function Ws(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}()?function Bs(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var a,o,i=new Blob([""],{type:"text/javascript"});i=URL.createObjectURL(i);try{o=new Worker(i),a=!0}catch{a=!1}return o&&o.terminate(),URL.revokeObjectURL(i),a}()?function MF(){return"Uint8ClampedArray"in window}()?function go(){return ArrayBuffer.isView}()?function TC(){var a=document.createElement("canvas"),o=(a.width=a.height=1,a.getContext("2d"));return!!o&&(o=o.getImageData(0,0,1,1))&&o.width===a.width}()?function gb(a){return void 0===Wg[a]&&(Wg[a]=function OF(i){var o;if(!(i=function kF(a){var o=document.createElement("canvas"),i=Object.create(Qp.webGLContextAttributes);return i.failIfMajorPerformanceCaveat=a,o.getContext("webgl",i)||o.getContext("experimental-webgl",i)}(i)))return!1;try{o=i.createShader(i.VERTEX_SHADER)}catch{return!1}return!(!o||i.isContextLost())&&(i.shaderSource(o,"void main() {}"),i.compileShader(o),!0===i.getShaderParameter(o,i.COMPILE_STATUS))}(a)),Wg[a]}(a&&a.failIfMajorPerformanceCaveat)?function Nd(){return!document.documentMode}()?void 0:"insufficient ECMAScript 6 support":"insufficient WebGL support":"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support":"not a browser"}(a)}var mb,Wg={};Qp.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};var xj="NGT",NF=dm(),fm=mc.domain,VP=mc.staticAssetsDomain,yb=mc.stylePath,BP=mc.styleDefinitionsVersion,_b="2.0",Hh=new ls,mv=!1,CC=!1,UP=!1,zP=!1,jP=!1,Xp=!1,HP=!1,$P=!1,vb=!1;function IC(){return Object.assign({},Hh)}function SC(){return VP}function Yg(){return fm}function AC(){return yb}function Zg(){return BP}function DC(){return _b}function mm(){return Ka.getWorkerCount()}function PC(){return Ka.getMaxParallelImageRequests()}function RC(){return xj}function MC(){return NF}function qP(){return Hh.authType===so.subscriptionKey?Hh.subscriptionKey:void 0}function wb(){return mb}function bb(){return mb}function kC(){return fv.getFullVersion()}function Eb(a){return!xC.isIE()&&pb({failIfMajorPerformanceCaveat:a})&&null!==document.createElement("canvas").getContext("webgl2")}function OC(a){Hh=(new ls).merge(Hh,a),vb=!0}function NC(a){fm=a,CC=!0}function LC(a){yb=a,UP=!0}function gv(a){BP=a,zP=!0}function xb(a){_b=a}function Tb(a){0<a&&(Ka.setWorkerCount(a),jP=!0)}function Wa(a){0<a&&(Ka.setMaxParallelImageRequests(a),Xp=!0)}function FC(a){xj=EC.getCode(a),HP=!0}function VC(a){NF=a,$P=!0}function BC(a){Hh.setSubscriptionKey(a),vb=!0}function Cb(a){mb=a,mv=!0}function UC(a){mb=a,mv=!0}function GP(a,o,i){!i&&_m[a.toLowerCase()]||(_m[a.toLowerCase()]=o)}function zC(a,o){if(o=Math.abs(o||1),"string"==typeof a&&_m[a.toLowerCase()]){for(var i=_m[a.toLowerCase()],l=/calc\(([0-9.]+)[px]*\s*\*\s*\{scale\}\)/gi,u=i,h=l.exec(i);h;)u=u.replace(h[0],parseFloat(h[1])*o+""),h=l.exec(i);return u.replace("{scale}",o+"")}throw new Error("Invalid templateName.")}function $h(){return Object.keys(_m)}function KP(){Ka.prewarm()}function la(){Ka.clearPrewarmedResources()}function gm(a,o){Ka.addProtocol(a,o)}function sh(a){Ka.removeProtocol(a)}function jC(){return vb}function HC(){return CC}function Ib(){return UP}function Sb(){return zP}function $C(){return jP}function ym(){return Xp}function WP(){return HP}function Ab(){return $P}function Db(){return mv}function YP(){return mc.domain}function Jp(){return Yg()}function ZP(){var a=new vu({domain:mc.staticAssetsDomain,path:"sdk/javascript/mapcontrol/".concat(fv.getEndpointVersion(),"/mapbox-gl-rtl-text.min.js")});Ka.setRTLTextPlugin(a.toString(),!0).catch(function(o){o&&console.warn(o)})}var Ll,ya,_m={marker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 26 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><text x="12.5" y="17.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:2"/><text x="12.5" y="18.5" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-circle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(39 * {scale})" viewBox="-1 -1 27 38"><path d="M12.25.25a12.254 12.254 0 0 0-12 12.494c0 6.444 6.488 12.109 11.059 22.564.549 1.256 1.333 1.256 1.882 0C17.762 24.853 24.25 19.186 24.25 12.744A12.254 12.254 0 0 0 12.25.25Z" style="fill:{color};stroke:{secondaryColor};stroke-width:1"/><circle cx="12.5" cy="12.5" r="9" fill="{secondaryColor}"/><text x="12" y="17.5" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',pin:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(24 * {scale})" height="calc(28 * {scale})" viewBox="0 0 24 28"><path d="m11.988 16.615a5.15 5.15 0 0 1-2.268-.525 4.909 4.909 0 0 1-2.805-4.442 5.019 5.019 0 0 1 5.072-4.936h.012a5.03 5.03 0 0 1 5.085 4.961 4.907 4.907 0 0 1-.549 2.224 5.114 5.114 0 0 1-4.548 2.718zm0-8.06a3.173 3.173 0 0 0-3.226 3.099 3.081 3.081 0 0 0 1.77 2.782 3.299 3.299 0 0 0 4.365-1.386 3.049 3.049 0 0 0 .342-1.381 3.184 3.184 0 0 0-3.239-3.114h-.012z" fill="{secondaryColor}"/><path d="m11.999.922a10.908 10.908 0 0 0-11.076 10.732 10.639 10.639 0 0 0 4.418 8.598l6.658 6.464 6.658-6.463a10.537 10.537 0 0 0 2.198-15.041 11.182 11.182 0 0 0-8.856-4.289zm1.873 14.341a4.221 4.221 0 0 1-5.589-1.789 3.945 3.945 0 0 1-.445-1.8 4.164 4.164 0 0 1 8.323-.037 4.028 4.028 0 0 1-2.289 3.626Z" fill="{color}"/><path d="m11.999 28-7.256-7.044a11.611 11.611 0 0 1-4.743-9.303 11.844 11.844 0 0 1 11.988-11.652.102 .102 0 0 1 .02 0 12.164 12.164 0 0 1 9.577 4.647 11.357 11.357 0 0 1 2.299 8.614 11.521 11.521 0 0 1-4.63 7.695zm-.01-26.157a9.997 9.997 0 0 0-10.143 9.812 9.769 9.769 0 0 0 4.04 7.853l.099.083 6.014 5.838 6.113-5.922a9.7 9.7 0 0 0 3.945-6.505 9.533 9.533 0 0 0-1.933-7.229 10.305 10.305 0 0 0-8.116-3.931h-.021zm.021 14.772a5.11 5.11 0 0 1-4.547-2.718 4.868 4.868 0 0 1 .932-5.743 5.118 5.118 0 0 1 3.58-1.46h.024a5.031 5.031 0 0 1 5.084 4.938 4.92 4.92 0 0 1-2.805 4.457h0a5.152 5.152 0 0 1-2.269.525zm-.011-8.079h-.015a3.277 3.277 0 0 0-2.295.933 3.029 3.029 0 0 0-.587 3.58 3.297 3.297 0 0 0 4.364 1.386h0a3.092 3.092 0 0 0 1.772-2.795 3.185 3.185 0 0 0-3.239-3.105z" fill="{secondaryColor}"/><text x="12" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"pin-round":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25 * {scale})" height="calc(25 * {scale})" viewBox="0 0 25 25"><g transform="translate(0 1)"><circle cx="12.25" cy="11.5833" r="11" fill="{color}"/><path d="m12.25 23.583a12 12 0 1 1 12-12 12 12 0 0 1-12 12zm0-22a10 10 0 1 0 10 10 10 10 0 0 0-10-10z" fill="{secondaryColor}"/><circle cx="12.25" cy="11.5833" r="4.2386" fill="{secondaryColor}"/></g><text x="12.5" y="17" style="font-size:14px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-flat":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(42.8 * {scale})"  viewBox="0 0 1600 2570"><g fill="{color}"><path d="M691 2419c-409-575-641-1086-683-1504-10-106-10-136 5-224 31-188 105-330 241-458 129-124 270-190 453-214 69-9 113-10 182-1 373 46 655 326 703 698 40 308-120 801-424 1309-134 224-348 535-369 535-4 0-53-63-108-141z"/></g><g fill="rgba(0,0,0,0.15)" style="transform:scale(-1,1);transform-origin:center"><path d="M691 2419c-407-571-639-1083-682-1498-14-139-3-249 37-371 69-208 254-402 459-481 68-27 217-59 271-59h24v160 180 940 635c0 349-2 635-5 635-2 0-49-63-104-141z"/></g><circle cx="800" cy="800" r="600" fill="{secondaryColor}"/><text x="800" y="1100" style="font-size:800px;fill:#000;text-anchor:middle">{text}</text></svg>',"marker-arrow":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(25.47 * {scale})" height="calc(35.18 * {scale})" viewBox="0 0 4330 5980"><g fill="{color}"><path d="m2080 5969c-49-20-93-63-115-113-25-55-1928-5486-1953-5573-40-138 67-282 210-283 36 0 246 73 987 345 518 190 947 345 955 345 8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29-33 0-71-5-85-10z"/></g><g fill="{secondaryColor}"><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z"/><path d="m2200 1600c-36 10-83 2-484-84-243-53-451-94-461-91-11 4-22 18-25 31-5 19 114 371 436 1292 244 697 448 1273 454 1281 19 24 50 30 71 12z" style="transform:scale(-1,1);transform-origin:center"/></g><g fill="rgba(0,0,0,0.2)" ><path d="m2165 685c8 0 438-155 955-345 615-226 954-345 979-345 87 0 165 47 204 123 46 91 107-95-957 2942-537 1535-986 2805-997 2823-11 18-43 46-72 62-41 24-62 30-111 29z"/></g><text x="2165" y="3300" style="font-size:2500px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-ball-pin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15.67 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 235 452"><g transform="translate(-135 10)"><path fill="{secondaryColor}" d="m256 442 0 0c-13 0-18-11-18-24l-6-323c0-13 11-24 24-24h0c13 0 24 11 24 24l-6 323c0 13-5 24-18 24z"/><circle style="fill:{color};stroke-width:10;stroke:{secondaryColor}" cx="256" cy="112" r="111"/><ellipse transform="matrix(0.834 0.5518 -0.5518 0.834 65.7916 -97.18)" fill="rgba(255,255,255,0.3)" cx="194.399" cy="60.749" rx="19.076" ry="32.428"/></g><text x="117.5" y="160" style="font-size:160px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.67 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2000 2420"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M845 2152c-22-37-58-95-80-129-22-35-62-99-90-143l-50-80-312 0-313 0 0-900 0-900 900 0 900 0 0 900 0 900-313 0-313 0-34 58c-19 31-38 59-42 60-5 2-8 8-8 12 0 9-69 123-88 145-5 6-11 15-13 21-16 39-77 123-89 124-8 0-33-31-55-68z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(38.8 * {scale})" viewBox="0 0 2500 2910"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m866 2652c-17-31-37-68-46-82-9-14-32-54-51-90-19-36-50-92-70-125l-36-60-332-3-331-2 0-905 0-905 660 0 660 0 0-38c0-71 50-196 102-258 71-85 189-164 244-164 12 0 26-4 29-10 8-13 222-13 230 0 3 6 17 10 30 10 25 0 117 45 154 76 130 107 191 232 191 392 0 155-63 284-190 386-36 29-129 76-150 76-11 0-22 5-25 10-3 6-31 10-61 10l-54 0 0 660 0 660-332 2-332 3-29 50c-17 28-48 84-70 125-22 41-47 86-56 100-9 14-30 51-46 83-17 32-36 57-45 57-8 0-28-25-44-58z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(26.8 * {scale})" height="calc(32.27 * {scale})" viewBox="0 0 2010 2410"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="M856 2155c-20-30-36-59-36-65 0-5-4-10-10-10-5 0-10-5-10-11 0-5-18-37-40-69-22-32-40-64-40-69 0-6-4-11-10-11-5 0-10-5-10-10 0-6-15-33-32-60l-33-50-127 0c-74 0-129-4-133-10-3-5-17-10-30-10-25 0-116-45-155-76-87-69-142-151-178-265-15-46-17-1075-2-1084 5-3 10-17 10-30 0-13 5-27 10-30 6-3 10-13 10-22 0-22 83-135 122-168 57-46 62-50 112-75l50-25 585 0 586 0 63 34c84 46 169 133 212 218l35 68 0 565 0 565-28 59c-32 69-100 157-139 180-15 9-33 22-40 29-23 22-99 57-123 57-13 0-27 5-30 10-4 6-60 10-135 10l-128 0-128 205c-84 136-133 205-144 205-10 0-33-24-54-55z"/></g><text x="1000" y="1300" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',"marker-square-rounded-cluster":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(33.33 * {scale})" height="calc(32.13 * {scale})" viewBox="0 0 2500 2900"><g transform="translate(100 100)" style="stroke:{secondaryColor};stroke-width:100;fill:{color}"><path d="m874 2669c-9-18-26-49-37-68-11-20-30-55-43-78-13-24-36-64-51-90-14-27-38-69-52-95l-26-48-142 0c-84 0-144-4-148-10-3-5-17-10-30-10-25 0-118-46-154-76-91-76-136-142-175-254-13-38-16-119-16-554 0-358 3-520 12-545 40-125 106-219 195-278 127-84 116-83 646-83l467 0 0-42c0-46 11-87 45-163 54-121 169-220 306-264 46-14 232-14 278 0 165 53 284 175 340 350 19 61 14 204-10 273-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-3 6-28 10-56 10l-49 0 0 462c0 446-1 464-21 522-32 91-94 178-169 240-38 31-130 76-155 76-13 0-27 5-30 10-4 6-65 10-149 10-138 0-143 1-154 23-12 23-62 114-112 202-16 28-44 79-63 115-42 77-67 88-93 39z"/></g><text x="1650" y="900" style="font-size:1000px;fill:#fff">+</text><text x="1000" y="1800" style="font-size:1000px;fill:#fff;text-anchor:middle">{text}</text></svg>',flag:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(23.5 * {scale})" height="calc(40 * {scale})" viewBox="34 28 198 308"><path style="stroke:{secondaryColor};stroke-width:15;stroke-linecap:round;" d="M42 327l0 -291"/><path style="fill:{color};stroke:{secondaryColor};stroke-width:10;stroke-linejoin:round;" d="M49 50c70 30 104 28 178 2-21 42-21 74 0 116-72 25-101 25-178 0l0-118z"/><text x="130" y="165" style="font-size:100px;fill:#fff;text-anchor:middle">{text}</text></svg>',"flag-triangle":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(27 * {scale})" height="calc(35.33 * {scale})" viewBox="0 0 40.5 53"><g transform="translate(-31 -20)"><path fill="{secondaryColor}" d="M34.7,73.3V48.4l34.6-10.1c0.7-0.2,1.2-0.8,1.2-1.5s-0.4-1.4-1-1.7L33.7,20.5c-0.5-0.2-1.1-0.2-1.6,0.2 c-0.5,0.3-0.7,0.8-0.7,1.4v51.2H34.7z"/><polygon points="34.7,24.5 66,36.5 34.7,45 34.7,10" fill="{color}"/></g><text x="11" y="21" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(34 * {scale})" height="calc(34 * {scale})" viewBox="0 0 34 34"><g transform="translate(2 2)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17" y="22" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"rounded-square-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(38 * {scale})" height="calc(38 * {scale})" viewBox="0 0 38 38"><g transform="translate(4 4)"><rect x="0" y="0" rx="8" ry="8" width="30" height="30" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19" y="24" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',triangle:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(36 * {scale})" height="calc(36 * {scale})" viewBox="0 0 36 36"><g transform="translate(2 2)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="30" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><g transform="translate(4 4)"><polygon points="16,0 32,32 0,32 16,0" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="32" style="font-size:12px;fill:#fff;text-anchor:middle">{text}</text></svg>',hexagon:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(35 * {scale})" height="calc(40 * {scale})" viewBox="0 0 35 40"><g transform="translate(2 2)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:2;fill:{color}"/></g><text x="17.5" y="25" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(39 * {scale})" height="calc(44 * {scale})" viewBox="0 0 39 44"><g transform="translate(4 4)"><path d="M31 9 15.5 0 0 9 0 27 15.5 36 31 27 31 9Z" style="stroke:{secondaryColor};stroke-width:4;fill:{color}"/></g><text x="19.5" y="27" style="font-size:14px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1100 1100"><g transform="translate(50 50)"><path style="stroke:{secondaryColor};stroke-width:50;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="550" y="700" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"hexagon-rounded-thick":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 1200 1200"><g transform="translate(100 100)"><path style="stroke:{secondaryColor};stroke-width:100;fill:{color}" d="M881 210 561 25c-33-19-88-19-121 0L119 210c-33 19-61 67-61 105v370c0 39 27 86 61 105l321 185c33 19 88 19 122 0l321-185c33-19 61-67 61-105V315C942 276 915 229 881 210z"/></g><text x="600" y="750" style="font-size:400px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="12,0 0,24 12,17 24,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="17" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"triangle-arrow-left":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(28 * {scale})" height="calc(28 * {scale})" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="24,12 0,0 7,12 0,24" stroke-width="2" stroke="{secondaryColor}" fill="{color}"/></g><text x="14" y="16.5" style="font-size:8px;fill:#fff;text-anchor:middle">{text}</text></svg>',"arrow-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(12.16 * {scale})" height="calc(30.1 * {scale})" viewBox="0 0 902 364"><g fill="{color}" transform="matrix(0,2.4,-2.4,0,897,-930)"><polygon points="902,222 233,222 233,364 0,182 233,0 233,141 902,141 902,222"/></g><text x="450" y="700" style="font-size:900px;fill:#000;text-anchor:middle">{text}</text></svg>',"arrow-up-thin":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(33.33 * {scale})" viewBox="0 0 12 25"><g transform="translate(-136.91823 -751.91998)"><path fill="{color}" d="m148.271 760.71c-1.641-.547-3.186-1.47-4.633-2.769l0 18.07-1.675 0 0-18.07c-1.447 1.299-2.986 2.222-4.616 2.769l0-1.231c2.325-1.596 4.006-3.812 5.043-6.65l.838 0c1.037 2.838 2.718 5.055 5.043 6.65l0 1.231z"/></g><text x="6" y="20" style="font-size:10px;fill:#000;text-anchor:middle">{text}</text></svg>',car:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(21.93 * {scale})" height="calc(40.9 * {scale})" viewBox="0 0 6580 12270"><g transform="translate(0 12270) rotate(-90)"><path fill="{secondaryColor}" d="M7045 6566c-42-13-105-44-105-51 0-2 23-105 50-228 28-123 50-230 50-236 0-8-241-11-907-11-855 0-1145 6-1513 30-85 6-189 13-230 15-41 3-133 10-205 15-286 21-430 32-705 50-953 63-1459 18-2335-205-304-77-746-209-799-238-131-72-221-408-285-1062-34-345-42-532-48-1130-16-1557 108-2532 336-2649 32-17 469-149 676-205 409-110 819-191 1205-238 116-14 224-18 540-18 395 1 494 5 1140 50 1124 79 1224 82 2496 78l641-3-53-237c-29-131-52-238-51-239 1-1 31-14 66-29 56-23 76-26 142-23 67 3 83 7 120 33 23 17 50 41 61 55 10 14 51 117 91 230l73 205 674 3 675 2 90-39c98-43 198-72 315-93 122-21 829-18 990 5 321 45 626 143 849 270 293 168 516 378 704 662 266 402 416 893 467 1527 15 174 8 882-9 998-6 41-18 127-27 190-69 502-253 969-523 1325-79 105-262 284-381 374-189 142-355 229-574 300-336 110-526 139-952 148-457 9-685-23-887-124l-47-24-678-6-678-6-64 179c-79 224-92 253-121 284-67 70-177 97-274 66zm-2752-5073c-23-2-64-2-90 0-26 2-7 3 42 3 50 0 71-1 48-3zm395 0c-21-2-55-2-75 0-21 2-4 4 37 4 41 0 58-2 38-4z"/><path fill="{color}" d="M7043 6498c-13-6-23-19-23-28 0-9 23-117 50-240 28-123 50-230 50-237 0-22-2126-13-2465 10-132 10-400 28-595 42-661 47-824 55-1160 62-435 7-656-8-1040-73-415-70-865-183-1447-365-168-53-272-556-325-1569-16-319-16-1311 0-1630 45-872 129-1366 257-1518 22-26 51-39 172-77 557-177 1122-310 1563-369 271-36 351-40 690-40 361 1 463 6 1165 54 1122 78 1288 83 2337 79 460-2 840-7 843-11 4-4-17-117-47-252l-55-245 39-16c76-30 180-8 224 47 10 13 54 124 98 246l79 222 709 0 709 0 47-24c74-37 219-83 322-101 122-22 606-32 802-16 374 29 658 102 933 238 124 62 271 155 361 230l61 51 6 100c19 278 103 497 247 643 88 89 173 136 278 152l70 11 41 131c116 369 159 673 168 1170 10 584-38 984-167 1397l-40 126-70 12c-193 33-348 175-441 405-56 139-89 302-89 445 0 43-3 47-58 91-290 235-644 384-1068 450-191 29-796 39-974 16-135-18-263-54-368-102l-75-35-701 0-701 0-79 223c-82 232-102 267-163 293-38 16-138 17-170 2zm-2023-820c332-15 1155-12 1835 6 308 8 563 12 566 8 4-4 10-21 13-38 7-30 6-31-92-77-518-244-1197-396-2112-474-295-25-1282-25-1579 0-231 20-473 46-479 51-6 7 49 110 93 171 160 226 416 335 855 365 142 10 539 5 900-12zm3304-263c525-111 899-887 934-1935 19-557-37-1023-172-1435-186-563-521-900-896-899-81 0-158 14-525 92-426 91-431 92-540 146-195 96-287 207-306 368-12 104-11 2985 1 3078 22 170 135 291 365 389 49 21 191 55 480 115 226 47 419 87 430 89 45 10 164 6 229-8zm-5570-485c112-43 197-156 216-291 12-83 13-2623 1-2706-23-158-125-273-270-304-44-9-100-1-542 75-272 47-514 91-539 98-266 68-487 424-594 958-56 280-70 548-40 800 56 484 207 878 414 1081 115 114 122 116 702 218 277 49 524 90 550 90 26 1 72-8 102-19zm2111-3440c1023-44 1884-213 2462-486l113-53-7-33c-3-18-8-35-10-37-2-3-236 1-521 7-993 24-1271 26-1708 11-541-18-1128-18-1249-1-377 56-588 181-734 437-32 55-41 79-32 84 12 8 246 32 491 51 356 28 815 36 1195 20z"/></g><text x="3250" y="8250" style="font-size:3000px;fill:#fff;text-anchor:middle">{text}</text></svg>',checker:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 16 16"><pattern id="p" x="0" y="0" width="16" height="16" patternUnits="userSpaceOnUse"><rect fill="{color}" x="0" width="8" height="8" y="0"/><rect fill="{color}" x="8" width="8" height="8" y="8"/></pattern><rect x="0" y="0" width="16" height="16" fill="{secondaryColor}"/><rect x="0" y="0" width="16" height="16" fill="url(#p)"/></svg>',"checker-rotated":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(16 * {scale})" height="calc(16 * {scale})" viewBox="0 0 60 60"><rect width="60" height="60" fill="{secondaryColor}"/><rect width="42.42" height="42.42" transform="translate(30 0) rotate(45)" fill="{color}"/></svg>',"zig-zag":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 120 60 120 90 90 120 60 120 0 120 0 60 60 0 0 0 60 30 90 60 120 120 120"/></svg>',"zig-zag-vertical":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(15 * {scale})" height="calc(15 * {scale})" viewBox="0 0 120 120"><rect x="0" y="0" width="120" height="120" fill="{secondaryColor}"/><polygon fill="{color}" points="120 0 120 60 90 30 60 0 0 0 0 0 60 60 0 120 60 120 90 90 120 60 120 0"/></svg>',"circles-spaced":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="2" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',circles:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(7 * {scale})" height="calc(7 * {scale})" viewBox="0 0 20 20"><defs><pattern id="p" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="6" stroke="none" fill="{color}"/></pattern></defs><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><rect x="0" y="0" width="100" height="100" fill="url(#p)"/></svg>',"diagonal-lines-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-lines-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"diagonal-stripes-up":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"diagonal-stripes-down":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(14 * {scale})" height="calc(14 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(45 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}" transform="rotate(-45 3 3)"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-lines":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(18 * {scale})" height="calc(18 * {scale})" viewBox="0 0 6 6"><rect x="0" y="0" width="6" height="6" fill="{secondaryColor}"/><g transform="rotate(90 3 3)" fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g><g fill="{color}"><path d="M5 0h1L0 6V5zM6 5v1H5z"/></g></svg>',"rotated-grid-stripes":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(20 * {scale})" height="calc(20 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="40" height="40" fill="{secondaryColor}"/><g transform="rotate(90 20 20)" fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g><g fill="{color}"><path d="M0 40L40 0H20L0 20M40 40V20L20 40"/></g></svg>',"x-fill":'<svg xmlns="http://www.w3.org/2000/svg" width="calc(40 * {scale})" height="calc(40 * {scale})" viewBox="0 0 40 40"><rect x="0" y="0" width="45.3" height="45.3" fill="{secondaryColor}"/><g fill="{color}"><path d="M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z"/></g></svg>',dots:'<svg xmlns="http://www.w3.org/2000/svg" width="calc(13 * {scale})" height="calc(13 * {scale})" viewBox="0 0 20 20"><rect x="0" y="0" width="20" height="20" fill="{secondaryColor}"/><g fill="{color}"><circle cx="3" cy="3" r="3"/><circle cx="13" cy="13" r="3"/></g></svg>'},ki=function(a){var o=document.createElement("span");return o.innerText=a,o.classList.add("tooltiptext"),-1!=navigator.userAgent.indexOf("Edg")?o.classList.add("edge"):-1!=navigator.userAgent.indexOf("Chrome")?o.classList.add("chrome"):-1!=navigator.userAgent.indexOf("Safari")?o.classList.add("safari"):-1!=navigator.userAgent.indexOf("Firefox")&&o.classList.add("firefox"),-1!=navigator.userAgent.indexOf("Windows")?o.classList.add("win"):-1!=navigator.userAgent.indexOf("Macintosh")&&o.classList.add("mac"),o},Vo=function(a,o,i){function l(u){var h=o.getBoundingClientRect(),w=a.getBoundingClientRect(),g=h.x+w.width>window.innerWidth?window.innerWidth-w.width:h.x;w=h.y+h.height+w.height+4>window.innerHeight?h.y-w.height-4:h.y+h.height+4,i&&o.parentElement&&(h=o.parentElement?o.parentElement.getBoundingClientRect():null,a.style.position="absolute",g-=h.x,w-=h.y),a.style.transform="translate(".concat(g,"px, ").concat(w,"px)"),a.style.display="block"}void 0===i&&(i=!1),o.addEventListener("mouseover",l),o.addEventListener("focusin",l),o.addEventListener("keydown",function(u){"Escape"!==u.key&&"Esc"!==u.key||"block"!==a.style.display||(u.stopPropagation(),a.style.display="none")})},pl=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Sr=(function(a){a.TopLeft="top-left",a.TopRight="top-right",a.BottomLeft="bottom-left",a.BottomRight="bottom-right",a.NonFixed="non-fixed"}(Ll=Ll||{}),function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.position=Ll.NonFixed,i}return pl(o,a),o}(To)),XP=function(){function a(o){var i;o&&(i=void 0,3<=(i="string"==typeof o?this.getRBGA(o):o).length)&&(this.r=i[0],this.g=i[1],this.b=i[2],3<i.length)&&(this.a=i[3])}return a.prototype.getLuminosity=function(){for(var o=[this.r,this.g,this.b],i=[],l=0;l<o.length;l++){var u=o[l]/255;i[l]=u<=.03928?u/12.92:Math.pow((.055+u)/1.055,2.4)}return.2126*i[0]+.7152*i[1]+.0722*i[2]},a.prototype.getRBGA=function(l){var i=document.createElement("canvas").getContext("2d");return[(i.globalAlpha=1,i.fillStyle=l,i.fillRect(0,0,1,1),l=i.getImageData(0,0,1,1).data)[0],l[1],l[2],l[3]]},a}(),Fl=(function(a){a.light="light",a.dark="dark",a.auto="auto"}(ya=ya||{}),Map),Pa=function(){function a(){this.listeners=new Fl}return a.prototype._addEventListener=function(o,i,l){this.listeners.has(o)||this.listeners.set(o,new Fl),this.listeners.get(o).set(i,l)},a.prototype._removeEventListener=function(o,i){this.listeners.has(o)&&this.listeners.get(o).delete(i)},a.prototype._invokeEvent=function(o,i){var l=this;this.listeners.has(o)&&this.listeners.get(o).forEach(function(u,h){u&&l._removeEventListener(o,h);try{h(i)}catch(g){console.error(g)}})},a}(),JP=Object.freeze({__proto__:null,EventEmitter:Pa}),LF=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),oi=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i._onStyleChange=function(){i._map.getStyle().style.toLowerCase().startsWith("blank")?i._observer||(i._onBackgroundChange(),i._observer=new MutationObserver(i._onBackgroundChange),i._observer.observe(i._map.getMapContainer(),{attributes:!0,attributeFilter:["style"]})):(i._observer&&(i._observer.disconnect(),delete i._observer),i._map.styles.getThemeAsync(i._map.getStyle()).then(function(l){i._setTheme(l)}))},i._onBackgroundChange=function(){var l=new XP(i._map.getMapContainer().style.backgroundColor).getLuminosity();l=isNaN(l)||.5<l?ya.light:ya.dark,i._setTheme(l)},i}return LF(o,a),o.prototype.onRemove=function(){this._container&&(this._container.remove(),delete this._container),this._map&&(this._map.events.remove("stylechanged",this._onStyleChange),delete this._map),this._observer&&(this._observer.disconnect(),delete this._observer),delete this._theme},o.prototype.buildContainer=function(i,l,u,h){return this._map=i,this._container=document.createElement(h||"div"),this._container.classList.add("azure-maps-control-container"),"string"==typeof u&&this._container.setAttribute("aria-label",u),l.toLowerCase()===ya.auto?this._map&&this._map.events.add("stylechanged",this._onStyleChange):this._container.classList.add(l),this._container},o.prototype._setTheme=function(i){this._theme!==i&&(this._container.classList.remove(this._theme),this._container.classList.add(i),this._theme=i)},o.activateClickDelay=100,o}(Pa),Pb=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),_a=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.rotationDegreesDelta=15,i.style=ya.light,i.inverted=!1,i}return Pb(o,a),o}(To),qC=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),eR=function(a){function o(i){var l=a.call(this)||this;return l.hasMouse=!1,l.hasFocus=!1,l.options=(new _a).merge(i),l}return qC(o,a),o.prototype.onAdd=function(i,l){function u(P){P?(g.classList.add("in-use"),T.setAttribute("aria-hidden","false"),T.classList.remove("hidden-accessible-element")):(g.classList.remove("in-use"),T.setAttribute("aria-hidden","true"),T.classList.add("hidden-accessible-element"))}var h=this,g=this.buildContainer(i,this.options.style,"Rotation Control"),w=this.constructRotationButton(i),T=this.constructRotationGrid(i,l),D=ki("Reset to Default Rotation");return g.addEventListener("mouseover",function(P){h.lastActiveTime=h.lastActiveTime||P.timeStamp,h.hasMouse=!0,u(!0)}),g.addEventListener("focusin",function(P){h.lastActiveTime=h.lastActiveTime||P.timeStamp,h.hasFocus=!0,u(!0)}),g.addEventListener("mouseleave",function(){h.hasMouse=!1,h.hasFocus||(delete h.lastActiveTime,u(!1))}),g.addEventListener("focusout",function(P){P.relatedTarget instanceof Node&&g.contains(P.relatedTarget)||(h.hasFocus=!1,h.hasMouse)||(delete h.lastActiveTime,u(!1))}),T.addEventListener("keydown",function(P){"Escape"!==P.key&&"Esc"!==P.key||(P.stopPropagation(),w.focus(),u(!1))}),w.addEventListener("keydown",function(P){"Escape"!==P.key&&"Esc"!==P.key||null==g||!g.classList.contains("in-use")||"none"!==D?.style.display||(P.stopPropagation(),u(!1))}),l&&o.InvertOrderPositions.includes(l.position)?(g.appendChild(T),g.appendChild(w),g.appendChild(D),Vo(D,w)):(g.appendChild(w),g.appendChild(D),Vo(D,w),g.appendChild(T)),g},o.prototype.constructRotationGrid=function(g,l){var u=document.createElement("div"),h=(u.classList.add("sub-container"),u.classList.add("hidden-accessible-element"),u.setAttribute("aria-hidden","true"),this.constructRightRotationButton(g)),w=(g=this.constructLeftRotationButton(g),ki("Rotate Left")),T=ki("Rotate Right");return l&&o.InvertOrderPositions.includes(l.position)?(u.appendChild(h),u.appendChild(T),Vo(T,h),u.appendChild(g),u.appendChild(w),Vo(w,g)):(u.appendChild(g),u.appendChild(w),Vo(w,g),u.appendChild(h),u.appendChild(T),Vo(T,h)),u},o.prototype.constructRotationButton=function(i){var l=this,u=document.createElement("button"),h=(u.classList.add("azure-maps-control-button"),u.classList.add("rotation"),u.setAttribute("aria-label","Reset to Default Rotation"),u.setAttribute("alt","Reset to Default Rotation"),u.setAttribute("type","button"),document.createElement("div"));return u.appendChild(h),u.addEventListener("click",function(g){g.timeStamp-l.lastActiveTime>oi.activateClickDelay&&i.setCamera({bearing:o.DefaultRotation},!0)}),i.events.add("rotate",function(g){h.style.transform="rotate(".concat(-g.map.getCamera().bearing,"deg)")}),u},o.prototype.constructRightRotationButton=function(i){var l=this,u=document.createElement("button");return u.classList.add("azure-maps-control-button"),u.classList.add("rotation-right"),u.setAttribute("aria-label","Rotate Right"),u.setAttribute("alt","Rotate Right"),u.setAttribute("type","button"),u.addEventListener("click",function(){i.setCamera({bearing:i.getCamera().bearing-(l.options.inverted?-1:1)*l.options.rotationDegreesDelta,duration:o.RotationDuration,type:"ease"},!0)}),u},o.prototype.constructLeftRotationButton=function(i){var l=this,u=document.createElement("button");return u.classList.add("azure-maps-control-button"),u.classList.add("rotation-left"),u.setAttribute("aria-label","Rotate Left"),u.setAttribute("alt","Rotate Left"),u.setAttribute("type","button"),u.addEventListener("click",function(){i.setCamera({bearing:i.getCamera().bearing+(l.options.inverted?-1:1)*l.options.rotationDegreesDelta,duration:o.RotationDuration,type:"ease"},!0)}),u},o.DefaultRotation=0,o.RotationDuration=100,o.InvertOrderPositions=[Ll.BottomRight,Ll.TopRight],o}(oi),Yo=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Vr=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.pitchDegreesDelta=10,i.style=ya.light,i.inverted=!1,i}return Yo(o,a),o}(To),GC=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),tR=function(a){function o(i){var l=a.call(this)||this;return l.container=null,l.map=null,l.pitchButton=null,l.pitchIncrementButton=null,l.pitchDecrementButton=null,l.hasMouse=!1,l.hasFocus=!1,l.pitchChanged=function(u){return l.updatePitchButtonsState()},l.updatePitchButtonsState=function(){var u=l.map.getCamera().pitch<=0,h=60<=l.map.getCamera().pitch;l.hasFocus&&l.pitchButton&&(u||h)&&l.pitchButton.focus(),l.options.inverted?(l.pitchIncrementButton&&l.pitchIncrementButton.disabled!=u&&(l.pitchIncrementButton.disabled=u),l.pitchDecrementButton&&l.pitchDecrementButton.disabled!=h&&(l.pitchDecrementButton.disabled=h)):(l.pitchIncrementButton&&l.pitchIncrementButton.disabled!=h&&(l.pitchIncrementButton.disabled=h),l.pitchDecrementButton&&l.pitchDecrementButton.disabled!=u&&(l.pitchDecrementButton.disabled=u))},l.options=(new Vr).merge(i),l}return GC(o,a),o.prototype.onAdd=function(i,l){function u(P){P?(g.classList.add("in-use"),T.setAttribute("aria-hidden","false"),T.classList.remove("hidden-accessible-element")):(g.classList.remove("in-use"),T.setAttribute("aria-hidden","true"),T.classList.add("hidden-accessible-element"))}var h=this,g=this.buildContainer(i,this.options.style,"Pitch Control"),w=this.constructPitchButton(i),T=this.constructPitchGrid(i,l),D=ki("Reset to Default Pitch");return g.addEventListener("mouseover",function(P){h.lastActiveTime=h.lastActiveTime||P.timeStamp,h.hasMouse=!0,u(!0)}),g.addEventListener("focusin",function(P){h.lastActiveTime=h.lastActiveTime||P.timeStamp,h.hasFocus=!0,u(!0)}),g.addEventListener("mouseleave",function(){h.hasMouse=!1,h.hasFocus||(delete h.lastActiveTime,u(!1))}),g.addEventListener("focusout",function(P){P.relatedTarget instanceof Node&&g.contains(P.relatedTarget)||(h.hasFocus=!1,h.hasMouse)||(delete h.lastActiveTime,u(!1))}),T.addEventListener("keydown",function(P){"Escape"!==P.key&&"Esc"!==P.key||(P.stopPropagation(),w.focus(),u(!1))}),w.addEventListener("keydown",function(P){"Escape"!==P.key&&"Esc"!==P.key||null==g||!g.classList.contains("in-use")||"none"!==D?.style.display||(P.stopPropagation(),u(!1))}),l&&o.INVERT_ORDER_POSITIONS.includes(l.position)?(g.appendChild(T),g.appendChild(w),g.appendChild(D),Vo(D,g)):(g.appendChild(w),g.appendChild(D),Vo(D,g),g.appendChild(T)),this.map=i,this.container=g,this.pitchButton=w,i.events.add("pitch",this.pitchChanged),this.updatePitchButtonsState(),g},o.prototype.onRemove=function(){this.container&&(this.container.remove(),this.container=null,this.pitchButton=null,this.pitchIncrementButton=null,this.pitchDecrementButton=null),this.map&&(this.map.events.remove("pitch",this.pitchChanged),this.map=null)},o.prototype.constructPitchGrid=function(h,l){var u=document.createElement("div"),g=(u.classList.add("sub-container"),u.classList.add("hidden-accessible-element"),u.setAttribute("aria-hidden","true"),this.pitchIncrementButton=this.constructPitchIncrementButton(h),this.pitchDecrementButton=this.constructPitchDecrementButton(h),h=ki("Increase Pitch"),ki("Decrease Pitch"));return l&&o.INVERT_ORDER_POSITIONS.includes(l.position)?(u.appendChild(this.pitchDecrementButton),u.appendChild(g),Vo(g,this.pitchDecrementButton),u.appendChild(this.pitchIncrementButton),u.appendChild(h),Vo(h,this.pitchIncrementButton)):(u.appendChild(this.pitchIncrementButton),u.appendChild(h),Vo(h,this.pitchIncrementButton),u.appendChild(this.pitchDecrementButton),u.appendChild(g),Vo(g,this.pitchDecrementButton)),u},o.prototype.constructPitchButton=function(i){var l=this,u=document.createElement("button");return u.classList.add("azure-maps-control-button"),u.classList.add("pitch"),u.setAttribute("aria-label","Reset to Default Pitch"),u.setAttribute("alt","Reset to Default Pitch"),u.setAttribute("type","button"),u.addEventListener("click",function(){event.timeStamp-l.lastActiveTime>oi.activateClickDelay&&i.setCamera({pitch:o.DEFAULT_PITCH},!0)}),u},o.prototype.constructPitchDecrementButton=function(i){var l=this,u=document.createElement("button");return u.classList.add("azure-maps-control-button"),u.classList.add("pitch-down"),u.setAttribute("aria-label","Decrease Pitch"),u.setAttribute("alt","Decrease Pitch"),u.setAttribute("type","button"),u.addEventListener("click",function(){i.setCamera({pitch:i.getCamera().pitch-(l.options.inverted?-1:1)*l.options.pitchDegreesDelta,duration:o.PITCH_DURATION_MS,type:"ease"},!0)}),u},o.prototype.constructPitchIncrementButton=function(i){var l=this,u=document.createElement("button");return u.classList.add("azure-maps-control-button"),u.classList.add("pitch-up"),u.setAttribute("aria-label","Increase Pitch"),u.setAttribute("alt","Increase Pitch"),u.setAttribute("type","button"),u.addEventListener("click",function(){i.setCamera({pitch:i.getCamera().pitch+(l.options.inverted?-1:1)*l.options.pitchDegreesDelta,duration:o.PITCH_DURATION_MS,type:"ease"},!0)}),u},o.PITCH_DURATION_MS=100,o.DEFAULT_PITCH=0,o.INVERT_ORDER_POSITIONS=[Ll.BottomRight,Ll.TopRight],o}(oi),Tj=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),nR=function(a){function o(i){var l=a.call(this)||this;return l.map=null,l.control=new Ka.ScaleControl({maxWidth:i?.maxWidth,unit:i?.unit}),l}return Tj(o,a),o.prototype.onAdd=function(i,l){this.map=i,null!=(u=null==(u=this.map)?void 0:u._getMap())&&u.addControl(this.control);var u=this.buildContainer(i,ya.auto,"Scale Bar");return u.appendChild(null==(i=this.control)?void 0:i._container),u},o.prototype.onRemove=function(){var i;a.prototype.onRemove.call(this),null!=(i=null==(i=this.map)?void 0:i._getMap())&&i.removeControl(this.control),this.map=null},o.prototype.setUnit=function(i){var l;null!=(l=this.control)&&l.setUnit(i)},o}(oi),$i=function jr(a,o){return a===o||a!=a&&o!=o},FF=$i,Rb=function Cj(a,o){for(var i=a.length;i--;)if(FF(a[i][0],o))return i;return-1},ef=Rb,VF=Array.prototype.splice,vm=Rb,PY=Rb,RY=Rb;function jn(a){var o=-1,i=null==a?0:a.length;for(this.clear();++o<i;){var l=a[o];this.set(l[0],l[1])}}jn.prototype.clear=function Gt(){this.__data__=[],this.size=0},jn.prototype.delete=function BF(i){var o=this.__data__;return!((i=ef(o,i))<0||(i==o.length-1?o.pop():VF.call(o,i,1),--this.size,0))},jn.prototype.get=function AY(i){var o=this.__data__;return(i=vm(o,i))<0?void 0:o[i][1]},jn.prototype.has=function Ij(a){return-1<PY(this.__data__,a)},jn.prototype.set=function UF(a,o){var i=this.__data__,l=RY(i,a);return l<0?(++this.size,i.push([a,o])):i[l][1]=o,this};var rR=jn,cs=rR,mi="object"==typeof Si&&Si&&Si.Object===Object&&Si,sR="object"==typeof self&&self&&self.Object===Object&&self,lh=mi||sR||Function("return this")(),Qg=lh.Symbol,Xn=Object.prototype,QC=Xn.hasOwnProperty,XC=Xn.toString,ch=Qg?Qg.toStringTag:void 0,Pj=Object.prototype.toString,kj=function Nb(a){var o=QC.call(a,ch),i=a[ch];try{var l=!(a[ch]=void 0)}catch{}var u=XC.call(a);return l&&(o?a[ch]=i:delete a[ch]),u},Xg=function Rj(a){return Pj.call(a)},aR=Qg?Qg.toStringTag:void 0,yv=function $F(a){return null==a?void 0===a?"[object Undefined]":"[object Null]":(aR&&aR in Object(a)?kj:Xg)(a)},$c=function tI(a){var o=typeof a;return null!=a&&("object"==o||"function"==o)},qF=yv,tf=$c,_v=function Ld(a){return!!tf(a)&&("[object Function]"==(a=qF(a))||"[object GeneratorFunction]"==a||"[object AsyncFunction]"==a||"[object Proxy]"==a)},cR=lh["__core-js_shared__"],uh=function(){var a=/[^.]+$/.exec(cR&&cR.keys&&cR.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Xi=Function.prototype.toString,zb=function Ub(a){if(null!=a){try{return Xi.call(a)}catch{}try{return a+""}catch{}}return""},nI=_v,vv=function Bb(a){return!!uh&&uh in a},Tu=$c,wv=zb,jb=/^\[object .+?Constructor\]$/,pR=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nf=function YF(a,o){return a=function mR(a,o){return a?.[o]}(a,o),function fR(a){return!(!Tu(a)||vv(a))&&(nI(a)?pR:jb).test(wv(a))}(a)?a:void 0},iI=nf(lh,"Map"),XF=nf(Object,"create"),gR=XF,_s=XF,vr=Object.prototype.hasOwnProperty,Ya=XF,Jg=Object.prototype.hasOwnProperty,_R=XF,On=function eV(a){return a=this.has(a)&&delete this.__data__[a],this.size-=a?1:0,a},Zr=function yc(a){var o,i=this.__data__;return _s?"__lodash_hash_undefined__"===(o=i[a])?void 0:o:vr.call(i,a)?i[a]:void 0};function Gh(a){var o=-1,i=null==a?0:a.length;for(this.clear();++o<i;){var l=a[o];this.set(l[0],l[1])}}Gh.prototype.clear=function Ra(){this.__data__=gR?gR(null):{},this.size=0},Gh.prototype.delete=On,Gh.prototype.get=Zr,Gh.prototype.has=function Ai(a){var o=this.__data__;return Ya?void 0!==o[a]:Jg.call(o,a)},Gh.prototype.set=function oI(a,o){var i=this.__data__;return this.size+=this.has(a)?0:1,i[a]=_R&&void 0===o?"__lodash_hash_undefined__":o,this};var bm=Gh,Ys=rR,rf=iI;function vs(a,o){return a=a.__data__,function Ev(a){var o=typeof a;return"string"==o||"number"==o||"symbol"==o||"boolean"==o?"__proto__"!==a:null===a}(o)?a["string"==typeof o?"string":"hash"]:a.map}var ny=vs,vR=vs,Tv=vs,Vj=vs;function oy(a){var o=-1,i=null==a?0:a.length;for(this.clear();++o<i;){var l=a[o];this.set(l[0],l[1])}}oy.prototype.clear=function ey(){this.size=0,this.__data__={hash:new bm,map:new(rf||Ys),string:new bm}},oy.prototype.delete=function Kh(a){return a=ny(this,a).delete(a),this.size-=a?1:0,a},oy.prototype.get=function Fd(a){return vR(this,a).get(a)},oy.prototype.has=function qb(a){return Tv(this,a).has(a)},oy.prototype.set=function aI(a,o){var i=Vj(this,a),l=i.size;return i.set(a,o),this.size+=i.size==l?0:1,this};var Bl=oy,Ul=rR,cI=iI,xm=Bl,sV=rR,Bj=function iR(i){var o=this.__data__;return i=o.delete(i),this.size=o.size,i},Uj=function kb(a){return this.__data__.get(a)},lV=function YC(a){return this.__data__.has(a)};function Iv(a){a=this.__data__=new sV(a),this.size=a.size}Iv.prototype.clear=function Mb(){this.__data__=new cs,this.size=0},Iv.prototype.delete=Bj,Iv.prototype.get=Uj,Iv.prototype.has=lV,Iv.prototype.set=function dh(a,o){var i=this.__data__;if(i instanceof Ul){var l=i.__data__;if(!cI||l.length<199)return l.push([a,o]),this.size=++i.size,this;i=this.__data__=new xm(l)}return i.set(a,o),this.size=i.size,this};var bR=Iv,OY=nf,$j=function(){try{var a=OY(Object,"defineProperty");return a({},"",{}),a}catch{}}(),cV=$j,uV=cV,Gb=function qj(a,o,i){"__proto__"==o&&uV?uV(a,o,{configurable:!0,enumerable:!0,value:i,writable:!0}):a[o]=i},Gj=Gb,ER=$i,Kj=Object.prototype.hasOwnProperty,hV=function uI(a,o,i){var l=a[o];Kj.call(a,o)&&ER(l,i)&&(void 0!==i||o in a)||Gj(a,o,i)},Tm=hV,sf=Gb,hI=function Wj(a,o,i,l){for(var u=!i,h=(i=i||{},-1),g=o.length;++h<g;){var w=o[h],T=l?l(i[w],a[w],w,i,a):void 0;void 0===T&&(T=a[w]),(u?sf:Tm)(i,w,T)}return i},Yh=function Iu(a){return null!=a&&"object"==typeof a},TR=yv,CR=Yh,Kb=function pI(a){return CR(a)&&"[object Arguments]"==TR(a)},mI=Yh,gI=Object.prototype,IR=gI.hasOwnProperty,SR=gI.propertyIsEnumerable,Av=Kb(function(){return arguments}())?Kb:function(a){return mI(a)&&IR.call(a,"callee")&&!SR.call(a,"callee")},Dv=Av,Cm=Array.isArray,yI={exports:{}},Zj=function Yj(){return!1},Wb=(function(a,l){var i;a.exports=(l=(i=(i=(l=l&&!l.nodeType&&l)&&a&&!a.nodeType&&a)&&i.exports===l?lh.Buffer:void 0)?i.isBuffer:void 0)||Zj}(yI,yI.exports),yI.exports),pV=/^(?:0|[1-9]\d*)$/,Yb=function fV(a,o){var i=typeof a;return!!(o=o??9007199254740991)&&("number"==i||"symbol"!=i&&pV.test(a))&&-1<a&&a%1==0&&a<o},gV=function _I(a){return"number"==typeof a&&-1<a&&a%1==0&&a<=9007199254740991},Qj=yv,yV=gV,vI=Yh,Uo={};Uo["[object Float32Array]"]=Uo["[object Float64Array]"]=Uo["[object Int8Array]"]=Uo["[object Int16Array]"]=Uo["[object Int32Array]"]=Uo["[object Uint8Array]"]=Uo["[object Uint8ClampedArray]"]=Uo["[object Uint16Array]"]=Uo["[object Uint32Array]"]=!0,Uo["[object Arguments]"]=Uo["[object Array]"]=Uo["[object ArrayBuffer]"]=Uo["[object Boolean]"]=Uo["[object DataView]"]=Uo["[object Date]"]=Uo["[object Error]"]=Uo["[object Function]"]=Uo["[object Map]"]=Uo["[object Number]"]=Uo["[object Object]"]=Uo["[object RegExp]"]=Uo["[object Set]"]=Uo["[object String]"]=Uo["[object WeakMap]"]=!1;var Zh=function Zb(a){return function(o){return a(o)}},Ma={exports:{}},af=(function(a,u){var i=(u=u&&!u.nodeType&&u)&&a&&!a.nodeType&&a,l=i&&i.exports===u&&mi.process;u=function(){try{return i&&i.require&&i.require("util").types||l&&l.binding&&l.binding("util")}catch{}}(),a.exports=u}(Ma,Ma.exports),Ma.exports),bI=function _c(a){return vI(a)&&yV(a.length)&&!!Uo[Qj(a)]},Qb=af&&af.isTypedArray,Pv=Qb?Zh(Qb):bI,EI=function Qa(a,o){for(var i=-1,l=Array(a);++i<a;)l[i]=o(i);return l},xI=Dv,NR=Cm,Lr=Wb,LR=Yb,nH=Pv,RV=Object.prototype.hasOwnProperty,ly=function Im(a,o){var i,l=NR(a),u=!l&&xI(a),h=!l&&!u&&Lr(a),g=!l&&!u&&!h&&nH(a),w=l||u||h||g,T=w?EI(a.length,String):[],D=T.length;for(i in a)!o&&!RV.call(a,i)||w&&("length"==i||h&&("offset"==i||"parent"==i)||g&&("buffer"==i||"byteLength"==i||"byteOffset"==i)||LR(i,D))||T.push(i);return T},cy=Object.prototype,TI=function MV(a){var o=a&&a.constructor;return a===("function"==typeof o&&o.prototype||cy)},OV=function kV(a,o){return function(i){return a(o(i))}},Bt=OV(Object.keys,Object),va=TI,Zs=Bt,FR=Object.prototype.hasOwnProperty,CI=_v,II=gV,Xb=function iH(a){return null!=a&&II(a.length)&&!CI(a)},SI=ly,zl=function Rv(a){if(!va(a))return Zs(a);var o,i=[];for(o in Object(a))FR.call(a,o)&&"constructor"!=o&&i.push(o);return i},lf=Xb,cf=function VR(a){return(lf(a)?SI:zl)(a)},uf=hI,NV=cf,AI=$c,zR=TI,jR=Object.prototype.hasOwnProperty,HR=ly,$R=function PI(a){if(!AI(a))return function FV(a){var o=[];if(null!=a)for(var i in Object(a))o.push(i);return o}(a);var o,i=zR(a),l=[];for(o in a)("constructor"!=o||!i&&jR.call(a,o))&&l.push(o);return l},qR=Xb,Mv=function RI(a){return qR(a)?HR(a,!0):$R(a)},UV=hI,jl=Mv,vc={exports:{}},GR=(function(a,i){var l,u=(l=(l=(i=i&&!i.nodeType&&i)&&a&&!a.nodeType&&a)&&l.exports===i?lh.Buffer:void 0)?l.allocUnsafe:void 0;a.exports=function(h,g){return g?h.slice():(g=h.length,g=u?u(g):new h.constructor(g),h.copy(g),g)}}(vc,vc.exports),vc.exports),KR=function zV(a,o){var i=-1,l=a.length;for(o=o||Array(l);++i<l;)o[i]=a[i];return o},Ud=function kv(){return[]},t1=Object.prototype.propertyIsEnumerable,n1=Object.getOwnPropertySymbols,YR=n1?function(a){return null==a?[]:(a=Object(a),function WR(a,o){for(var i=-1,l=null==a?0:a.length,u=0,h=[];++i<l;){var g=a[i];o(g,i,a)&&(h[u++]=g)}return h}(n1(a),function(o){return t1.call(a,o)}))}:Ud,r1=YR,HV=hI,uy=r1,o1=function aH(a,o){for(var i=-1,l=o.length,u=a.length;++i<l;)a[u+i]=o[i];return a},MI=OV(Object.getPrototypeOf,Object),lH=o1,cH=MI,kI=r1,Lv=Object.getOwnPropertySymbols?function(a){for(var o=[];a;)lH(o,kI(a)),a=cH(a);return o}:Ud,s1=hI,NY=Lv,uH=o1,Qh=Cm;function JR(a,o,i){return o=o(a),Qh(a)?o:uH(o,i(a))}var LI=JR,eM=r1,a1=cf,tM=function FI(a){return LI(a,a1,eM)},nM=JR,rM=Lv,iM=Mv,hf=nf(lh,"DataView"),Vv=iI,Bv=nf(lh,"Promise"),df=nf(lh,"Set"),lM=nf(lh,"WeakMap"),zI=yv,Uv=zb,ZV="[object Map]",QV="[object Promise]",XV="[object Set]",JV="[object WeakMap]",Am="[object DataView]",e3=Uv(hf),t3=Uv(Vv),wa=Uv(Bv),n3=Uv(df),zv=Uv(lM),Dm=zI,$l=Dm=hf&&Dm(new hf(new ArrayBuffer(1)))!=Am||Vv&&Dm(new Vv)!=ZV||Bv&&Dm(Bv.resolve())!=QV||df&&Dm(new df)!=XV||lM&&Dm(new lM)!=JV?function(i){var o=zI(i);if(i=(i="[object Object]"==o?i.constructor:void 0)?Uv(i):"")switch(i){case e3:return Am;case t3:return ZV;case wa:return QV;case n3:return XV;case zv:return JV}return o}:Dm,cM=Object.prototype.hasOwnProperty,uM=lh.Uint8Array,o3=uM,c1=function qc(a){var o=new a.constructor(a.byteLength);return new o3(o).set(new o3(a)),o},ff=c1,mH=/\w*$/,dM=Qg?Qg.prototype:void 0,pM=dM?dM.valueOf:void 0,a3=c1,mM=function zd(a,o){return o=o?a3(a.buffer):a.buffer,new a.constructor(o,a.byteOffset,a.length)},jd=c1,l3=function fH(a,o){return o=o?ff(a.buffer):a.buffer,new a.constructor(o,a.byteOffset,a.byteLength)},gM=function s3(a){var o=new a.constructor(a.source,mH.exec(a));return o.lastIndex=a.lastIndex,o},u1=mM,y3=$c,p1=Object.create,bH=function(){function a(){}return function(o){return y3(o)?p1?p1(o):(a.prototype=o,o=new a,a.prototype=void 0,o):{}}}(),HI=bH,_3=MI,xM=TI,v3=function EH(a){return"function"!=typeof a.constructor||xM(a)?{}:HI(_3(a))},w3=$l,b3=Yh,$I=af&&af.isMap,Hv=$I?Zh($I):function m1(a){return b3(a)&&"[object Map]"==w3(a)},$v=$l,Hd=Yh,GI=af&&af.isSet,S3=GI?Zh(GI):function C3(a){return Hd(a)&&"[object Set]"==$v(a)},A3=bR,CM=function jj(a,o){for(var i=-1,l=null==a?0:a.length;++i<l&&!1!==o(a[i],i,a););return a},ql=hV,IM=function BR(a,o){return a&&uf(o,NV(o),a)},SM=function Sm(a,o){return a&&UV(o,jl(o),a)},KI=GR,ir=KR,y1=function Ov(a,o){return HV(a,uy(a),o)},AM=function OI(a,o){return s1(a,NY(a),o)},_1=tM,WI=function oM(a){return nM(a,iM,rM)},DM=$l,PM=function Co(a){var o=a.length,i=new a.constructor(o);return o&&"string"==typeof a[0]&&cM.call(a,"index")&&(i.index=a.index,i.input=a.input),i},YI=function wH(a,o,i){var l=a.constructor;switch(o){case"[object ArrayBuffer]":return jd(a);case"[object Boolean]":case"[object Date]":return new l(+a);case"[object DataView]":return l3(a,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return u1(a,i);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(a);case"[object RegExp]":return gM(a);case"[object Symbol]":return function fy(a){return pM?Object(pM.call(a)):{}}(a)}},D3=v3,RM=Cm,P3=Wb,R3=Hv,ZI=$c,Ja=S3,CH=cf,yy=Mv,XI="[object Arguments]",v1="[object Function]",kM="[object Object]",at={};at[XI]=at["[object Array]"]=at["[object ArrayBuffer]"]=at["[object DataView]"]=at["[object Boolean]"]=at["[object Date]"]=at["[object Float32Array]"]=at["[object Float64Array]"]=at["[object Int8Array]"]=at["[object Int16Array]"]=at["[object Int32Array]"]=at["[object Map]"]=at["[object Number]"]=at[kM]=at["[object RegExp]"]=at["[object Set]"]=at["[object String]"]=at["[object Symbol]"]=at["[object Uint8Array]"]=at["[object Uint8ClampedArray]"]=at["[object Uint16Array]"]=at["[object Uint32Array]"]=!0,at["[object Error]"]=at[v1]=at["[object WeakMap]"]=!1;var Er=function fr(a,o,i,l,u,h){var g,w=1&o,T=2&o,D=4&o;if(void 0===(g=i?u?i(a,l,u,h):i(a):g)){if(!ZI(a))return a;if(l=RM(a)){if(g=PM(a),!w)return ir(a,g)}else{var P=DM(a),N=P==v1||"[object GeneratorFunction]"==P;if(P3(a))return KI(a,w);if(P==kM||P==XI||N&&!u){if(g=T||N?{}:D3(a),!w)return T?AM(a,SM(g,a)):y1(a,IM(g,a))}else{if(!at[P])return u?a:{};g=YI(a,P,w)}}if(N=(h=h||new A3).get(a))return N;h.set(a,g),Ja(a)?a.forEach(function(W){g.add(fr(W,o,i,W,a,h))}):R3(a)&&a.forEach(function(W,ue){g.set(ue,fr(W,o,i,ue,a,h))});var z=l?void 0:(D?T?WI:_1:T?yy:CH)(a);CM(z||a,function(W,ue){z&&(W=a[ue=W]),ql(g,ue,fr(W,o,i,ue,a,h))})}return g},Qr=Er,Ki=Nl(function Xo(a){return Qr(a,5)}),ph=Gb,x1=$i,vy=function Rm(a,o,i){(void 0===i||x1(a[o],i))&&(void 0!==i||o in a)||ph(a,o,i)},IH=function L3(a){return function(o,i,l){for(var u=-1,h=Object(o),g=l(o),w=g.length;w--;){var T=g[a?w:++u];if(!1===i(h[T],T,h))break}return o}}(),VY=IH,BY=Xb,UY=Yh,FM=yv,F3=MI,T1=Yh,DH=Function.prototype.toString,V3=Object.prototype.hasOwnProperty,HY=DH.call(Object),nS=function C1(a){return!(!T1(a)||"[object Object]"!=FM(a))&&(null===(a=F3(a))||"function"==typeof(a=V3.call(a,"constructor")&&a.constructor)&&a instanceof a&&DH.call(a)==HY)};function VM(a,o){if(("constructor"!==o||"function"!=typeof a[o])&&"__proto__"!=o)return a[o]}var PH=hI,RH=Mv,qY=vy,GY=GR,KY=mM,WY=KR,wy=v3,I1=Dv,kH=Cm,zoe=function SH(a){return UY(a)&&BY(a)},joe=Wb,Hoe=_v,$oe=$c,qoe=nS,OH=Pv,NH=VM,B3=bR,Mm=vy,rS=VY,LH=function ZY(a,o,i,l,u,h,g){var w,T,D,P=NH(a,i),N=NH(o,i),z=g.get(N);z||((o=void 0===(z=h?h(P,N,i+"",a,o,g):void 0))&&(T=!(w=kH(N))&&joe(N),D=!w&&!T&&OH(N),z=N,w||T||D?z=kH(P)?P:zoe(P)?WY(P):T?GY(N,!(o=!1)):D?KY(N,!(o=!1)):[]:qoe(N)||I1(N)?I1(z=P)?z=function MH(a){return PH(a,RH(a))}(P):$oe(P)&&!Hoe(P)||(z=wy(N)):o=!1),o&&(g.set(N,z),u(z,N,l,h,g),g.delete(N))),qY(a,i,z)},FH=$c,VH=Mv,Koe=VM,BM=function U3(a){return a},UH=Math.max,UM=function eZ(a){return function(){return a}},zH=cV,nZ=zH?function(a,o){return zH(a,"toString",{configurable:!0,enumerable:!1,value:UM(o),writable:!0})}:BM,$H=Date.now,iZ=function qH(a){var o=0,i=0;return function(){var l=$H(),u=16-(l-i);if(i=l,0<u){if(++o>=800)return arguments[0]}else o=0;return a.apply(void 0,arguments)}}(nZ),Joe=BM,ese=function XY(a,o,i){return o=UH(void 0===o?a.length-1:o,0),function(){for(var l=arguments,u=-1,h=UH(l.length-o,0),g=Array(h);++u<h;)g[u]=l[o+u];u=-1;for(var w=Array(o+1);++u<o;)w[u]=l[u];return w[o]=i(g),function Yoe(a,o,i){switch(i.length){case 0:return a.call(o);case 1:return a.call(o,i[0]);case 2:return a.call(o,i[0],i[1]);case 3:return a.call(o,i[0],i[1],i[2])}return a.apply(o,i)}(a,this,w)}},iS=iZ,GH=$i,z3=Xb,KH=Yb,aZ=$c,H3=function QY(a,o,i,l,u){a!==o&&rS(o,function(h,g){var w;u=u||new B3,FH(h)?LH(a,o,g,i,QY,l,u):(w=l?l(Koe(a,g),h,g+"",a,o,u):void 0,Mm(a,g,w=void 0===w?h:w))},VH)},YH=function j3(a){return function oS(a,o){return iS(ese(a,o,Joe),a+"")}(function(o,i){var l=-1,u=i.length,g=1<u?i[u-1]:void 0,h=2<u?i[2]:void 0;for(g=3<a.length&&"function"==typeof g?(u--,g):void 0,h&&function WH(a,o,i){var l;return!!aZ(i)&&!!("number"==(l=typeof o)?z3(i)&&KH(o,i.length):"string"==l&&o in i)&&GH(i[o],a)}(i[0],i[1],h)&&(g=u<3?void 0:g,u=1),o=Object(o);++l<u;){var w=i[l];w&&a(o,w,l,g)}return o})}(function(a,o,i){H3(a,o,i)}),ZH=Nl(YH),$3=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),jM=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.layout="icons",i.mapStyles=["road","grayscale_light","grayscale_dark","night","road_shaded_relief"],i.style=ya.light,i.autoSelectionMode=!0,i}return $3(o,a),o}(To),uZ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),q3=window&&window.__awaiter||function(a,o,i,l){return new(i=i||Promise)(function(u,h){function g(D){try{T(l.next(D))}catch(P){h(P)}}function w(D){try{T(l.throw(D))}catch(P){h(P)}}function T(D){var P;D.done?u(D.value):((P=D.value)instanceof i?P:new i(function(N){N(P)})).then(g,w)}T((l=l.apply(a,o||[])).next())})},HM=window&&window.__generator||function(a,o){var i,l,u,h={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},g={next:w(0),throw:w(1),return:w(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function w(T){return function(D){var P=[T,D];if(i)throw new TypeError("Generator is already executing.");for(;h=g&&P[g=0]?0:h;)try{if(i=1,l&&(u=2&P[0]?l.return:P[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,P[1])).done)return u;switch(l=0,(P=u?[2&P[0],u.value]:P)[0]){case 0:case 1:u=P;break;case 4:return h.label++,{value:P[1],done:!1};case 5:h.label++,l=P[1],P=[0];continue;case 7:P=h.ops.pop(),h.trys.pop();continue;default:if(!(u=0<(u=h.trys).length&&u[u.length-1])&&(6===P[0]||2===P[0])){h=0;continue}if(3===P[0]&&(!u||P[1]>u[0]&&P[1]<u[3]))h.label=P[1];else if(6===P[0]&&h.label<u[1])h.label=u[1],u=P;else{if(!(u&&h.label<u[2])){u[2]&&h.ops.pop(),h.trys.pop();continue}h.label=u[2],h.ops.push(P)}}P=o.call(a,h)}catch(N){P=[6,N],l=0}finally{i=u=0}if(5&P[0])throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}},Au=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},D1=function(a){function o(i){var l=a.call(this)||this;return l.styleOpsGrid=null,l.hasMouse=!1,l.hasFocus=!1,l.styleButtons=new Fl,l.styleIcons=new Fl,l.thumbnailCache={assumedConfiguration:void 0,response:new Fl,blob:new Fl},l.onStyleChange=function(){var u;l.options.autoSelectionMode&&(u=l.map.getStyle().style,l.setSelectedStyle(u))},l.onMapConfigurationChange=function(u){!l.styleOpsGrid||0<l.styleOpsGrid.children.length&&l.thumbnailCache.assumedConfiguration===u||(l.thumbnailCache.assumedConfiguration=u,Array.from(l.styleOpsGrid.children).forEach(function(h){return h.remove()}),l.styleButtons.clear(),l.populateOpsGridFromDefinitions(u))},l.mapToFriendlyStyleName=function(u,h){return h=h.configurations.find(function(g){return g.name===u}),h?.displayName||u},l.options=(new jM).merge(Ki(i)),l}return uZ(o,a),o.prototype.onAdd=function(D,l){function u(P){P?(g.classList.add(o.Css.inUse),w.setAttribute("aria-hidden","false"),w.classList.remove("hidden-accessible-element")):(g.classList.remove(o.Css.inUse),w.setAttribute("aria-hidden","true"),w.classList.add("hidden-accessible-element"))}var h=this,g=(this.map=D,this.buildContainer(D,this.options.style,"Map Style Control")),w=this.buildStyleOpsGrid(),T=(this.styleOpsGrid=w,this.buildCurrStyleBtn());return D=ki("Select Style"),w.classList.add(l&&l.position||"top-right"),g.addEventListener("mouseover",function(){h.hasMouse=!0,u(!0)}),g.addEventListener("focusin",function(){h.hasFocus=!0,u(!0)}),g.addEventListener("mouseleave",function(){h.hasMouse=!1,h.hasFocus||u(!1)}),g.addEventListener("focusout",function(P){P.target===T&&Array.from(w.children).forEach(function(N){return N.removeAttribute("tabIndex")}),P.relatedTarget instanceof Node&&g.contains(P.relatedTarget)||(h.hasFocus=!1,h.hasMouse)||u(!1)}),w.addEventListener("keydown",function(P){27===P.keyCode&&(P.stopPropagation(),T.focus(),Array.from(w.children).forEach(function(N){return N.setAttribute("tabIndex","-1")}),g.classList.contains(o.Css.inUse))&&u(!1)}),T.addEventListener("click",function(P){g.classList.contains(o.Css.inUse)?u(!1):(u(!0),w.firstElementChild&&w.firstElementChild.focus())}),l&&o.InvertOrderPositions.includes(l.position)?(g.appendChild(w),g.appendChild(T),g.appendChild(D),Vo(D,T)):(g.appendChild(T),g.appendChild(D),Vo(D,T),g.appendChild(w)),g},o.prototype.onRemove=function(){a.prototype.onRemove.call(this),this.styleOpsGrid=null,this.styleButtons.clear(),this.thumbnailCache.response.clear(),this.thumbnailCache.blob.clear(),this.thumbnailCache.assumedConfiguration=void 0,this.map.events.remove("stylechanged",this.onStyleChange),this.map.events.remove("mapconfigurationchanged",this.onMapConfigurationChange)},o.prototype.setSelectedStyle=function(i){var l,u,h=this;this.styleIcons.has(i)&&(l=this.currStyleImage,u=this.styleIcons.get(i),l.src!==u&&(l.src=u),Object.entries(this.styleButtons).forEach(function(w){return(w=Au(w,2))[1].setAttribute("aria-current",w[0]===i?"true":"false")}),this.map.styles.definitions().then(function(g){g=h.mapToFriendlyStyleName(i,g),l.alt!==g&&(l.alt=g),l.parentElement.lastChild instanceof Text&&(l.parentElement.lastChild.textContent=g)}))},o.prototype.disableStyle=function(i){(i=this.styleButtons[i])&&i.setAttribute("disabled","true")},o.prototype.enableStyle=function(i){(i=this.styleButtons[i])&&i.removeAttribute("disabled")},o.prototype.buildSelectStyleBtn=function(i,D,u){var h=this,g=document.createElement("button"),w=this.mapToFriendlyStyleName(i,D),T=(g.setAttribute("aria-label",w),g.setAttribute("type","button"),new Image);return(u.then(function(P){var N;return h.thumbnailCache.blob.has(P.url)?h.thumbnailCache.blob.get(P.url):(N=P.clone().blob(),h.thumbnailCache.blob.set(P.url,N),N)}).then(function(P){P=URL.createObjectURL(P),T.src=P,i===h.map.getStyle().style&&(h.currStyleImage.src=P,h.currStyleImage.alt=w,h.currStyleImage.parentElement.lastChild.nodeType==Node.TEXT_NODE?h.currStyleImage.parentElement.lastChild.textContent=w:h.currStyleImage.parentElement.appendChild(document.createTextNode(w))),h.styleIcons.set(i,P)}),T.setAttribute("aria-hidden","true"),g.appendChild(T),"icons"===this.options.layout?g.classList.add(o.Css.button):(g.classList.add(o.Css.listButton),g.classList.add(o.Css.expanded),g.appendChild(document.createTextNode(w))),g.addEventListener("click",function(){h.hasMouse=!1,h.hasFocus=!1;var P=h.styleButtons[i];P&&!P.hasAttribute("disabled")&&(h._invokeEvent("styleselected",i),h.options.autoSelectionMode&&h.map.setStyle({style:i}),Object.entries(h.styleButtons).forEach(function(z){return(z=Au(z,2))[1].setAttribute("aria-current",z[0]===i?"true":"false")}))}),D=document.createElement("div")).classList.add("selected-icon"),g.appendChild(D),g},o.prototype.buildCurrStyleBtn=function(){var i=document.createElement("button"),l=(i.classList.add("icons"==this.options.layout?o.Css.button:o.Css.listButton),i.classList.add(o.Css.currentStyle),i.setAttribute("aria-label","Select Style"),i.setAttribute("tabindex","-1"),this.currStyleImage=new Image,i.appendChild(this.currStyleImage),document.createElement("div"));return l.classList.add("icon"),i.appendChild(l),i},o.prototype.buildStyleOpsGrid=function(){var i=this,l=document.createElement("div");return l.classList.add(o.Css.styleOptions),l.classList.add("icons"===this.options.layout?this.options.layout:o.Css.dropdown),l.setAttribute("aria-label","Style Options"),l.classList.add("hidden-accessible-element"),l.setAttribute("aria-hidden","true"),this.map.styles.definitions().then(function(u){return q3(i,void 0,void 0,function(){return HM(this,function(h){return this.onMapConfigurationChange(u),this.map.events.add("stylechanged",this.onStyleChange),[2]})})}),this.map.events.add("mapconfigurationchanged",this.onMapConfigurationChange),l},o.prototype.populateOpsGridFromDefinitions=function(i){var l,u,h=this;this.styleOpsGrid&&(l=i.configurations,(l=Array.isArray(this.options.mapStyles)?l.filter(function(g){return h.options.mapStyles.includes(g.name.split("_indoor")[0])}):l).forEach(function(g){var w,T={url:g.thumbnail},D=((g.thumbnail&&h.map.styles._transformStyleRequest(g.thumbnail,T),D=h.map.getServiceOptions()).transformRequest&&ZH(T,D.transformRequest(T.url,"Thumbnail")),h.thumbnailCache.response.has(T.url)?w=Promise.resolve(h.thumbnailCache.response.get(T.url)):(w=fetch(T.url,{headers:T.headers}),h.thumbnailCache.response.set(T.url,w)),h.buildSelectStyleBtn(g.name,i,w));h.styleOpsGrid.appendChild(D),h.styleButtons[g.name]=D,"icons"===h.options.layout&&(T=ki(h.mapToFriendlyStyleName(g.name,i)),h.styleOpsGrid.appendChild(T),Vo(T,D))}),u=this.map.getStyle().style,Object.entries(this.styleButtons).forEach(function(w){return(w=Au(w,2))[1].setAttribute("aria-current",w[0]===u?"true":"false")}))},o.InvertOrderPositions=[Ll.TopRight,Ll.BottomRight],o.Css={button:"azure-maps-control-button",listButton:"azure-maps-control-list-button",expanded:"expanded",currentStyle:"curr-style",inUse:"in-use",styleOptions:"style-options",dropdown:"azure-maps-control-dropdown"},o}(oi),G3=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),$M=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.flow="none",i.incidents=!1,i}return G3(o,a),o}(To),hZ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),QH=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.isActive=!1,i.style=ya.light,i}return hZ(o,a),o}($M),P1=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),XH=function(a){function o(i){var l,u=this;return(u=a.call(this)||this).hasMouse=!1,u.hasFocus=!1,u.options=(new $M).merge({flow:"relative",incidents:!0}),u.style=ya.light,u.container=null,u.trafficButton=null,u.map=null,i&&(u.initIsActive=null!=(l=i.isActive)&&l,u.options.flow=i.flow||"relative",u.options.incidents=null==(l=i.incidents)||l,u.style=i.style||ya.light),u}return P1(o,a),Object.defineProperty(o.prototype,"isActive",{get:function(){var i;return!!this.map&&("none"!==(i=this.map.getTraffic()).flow||i.incidents)},set:function(i){this.map&&this.map.setTraffic({flow:i?this.options.flow:"none",incidents:!!i&&this.options.incidents})},enumerable:!1,configurable:!0}),o.prototype.onAdd=function(l){(this.map=l).getTraffic(),void 0!==this.initIsActive&&(this.isActive=this.initIsActive),this.container=this.buildContainer(l,this.style,"Traffic Control"),this.container.style.flexDirection="column",l=this.constructTrafficButton(l);var u=(this.container.appendChild(l),ki("Toggle Traffic Display"));return this.container.appendChild(u),Vo(u,l),this.container},o.prototype.onRemove=function(){a.prototype.onRemove.call(this),this.map=null},o.prototype.getOptions=function(){return(new QH).merge({isActive:this.isActive,flow:this.options.flow,incidents:this.options.incidents,style:this.style})},o.prototype.updateButtonState=function(){this.trafficButton&&(this.isActive?(this.container.classList.add("in-use"),this.trafficButton.setAttribute("aria-description","Traffic is displayed")):(this.container.classList.remove("in-use"),this.trafficButton.removeAttribute("aria-description")),this.trafficButton.setAttribute("aria-pressed",this.isActive?"true":"false"))},o.prototype.constructTrafficButton=function(i){var l=this,u=document.createElement("button");return u.classList.add("azure-maps-control-button"),u.classList.add("traffic"),u.setAttribute("aria-label","Toggle Traffic Display"),u.setAttribute("alt","Toggle Traffic Display"),u.setAttribute("type","button"),this.trafficButton=u,this.updateButtonState(),u.addEventListener("click",function(){l.isActive=!l.isActive}),u},o}(oi),dZ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),JH=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},K3=function(a){function o(){var i=a.call(this)||this;return i.table=["Fast",["green","yellow","red","dark-red"],"Slow"],i.map=null,i.syncHiddenState=null,i}return dZ(o,a),o.prototype.onAdd=function(u){this.map=u;var l=this.buildContainer(u,ya.auto,"Traffic Legend");return u=this.buildTrafficLegendDiv(u),l.setAttribute("role","definition"),l.appendChild(u),l},o.prototype.onRemove=function(){a.prototype.onRemove.call(this),this.syncHiddenState&&(this.map.events.remove("styledata",this.syncHiddenState),this.syncHiddenState=null),this.map=null},o.prototype.buildTrafficLegendDiv=function(i){var l,u,h,g,w=document.createElement("div"),T=(w.classList.add("traffic-legend","hidden"),w.setAttribute("alt","Traffic Legend"),document.createElement("table")),D=document.createElement("tr"),P=document.createElement("td"),N=(P.setAttribute("alt","Traffic"),P.appendChild(document.createTextNode("Traffic")),ki("Traffic")),z=(P.classList.add("traffic-legend-title"),P.colSpan=6,D.appendChild(P),D.appendChild(N),Vo(N,P),T.appendChild(D),document.createElement("tr"));try{for(var W=JH(this.table),ue=W.next();!ue.done;ue=W.next()){var ge=ue.value,we=document.createElement("td");if("Fast"===ge||"Slow"===ge)we.setAttribute("alt",ge),we.appendChild(document.createTextNode(ge)),we.classList.add("traffic-legend-text");else{we.classList.add("traffic-legend-colors"),we.setAttribute("aria-label","Traffic Legend"),we.setAttribute("role","img");try{h=void 0;for(var Re=JH(ge),et=Re.next();!et.done;et=Re.next()){var Mt=et.value,St=document.createElement("div");St.classList.add(Mt),we.appendChild(St)}}catch(Le){h={error:Le}}finally{try{et&&!et.done&&(g=Re.return)&&g.call(Re)}finally{if(h)throw h.error}}}z.appendChild(we);var Qt=ki(ge instanceof Array?"Traffic Legend":ge);z.appendChild(Qt),Vo(Qt,we)}}catch(Le){l={error:Le}}finally{try{ue&&!ue.done&&(u=W.return)&&u.call(W)}finally{if(l)throw l.error}}return T.appendChild(z),w.appendChild(T),this.syncHiddenState=function(Le){"style"===Le.dataType&&((Le=i.getTraffic()).flow&&"none"!==Le.flow?w.classList.remove("hidden"):w.classList.add("hidden"))},this.syncHiddenState({dataType:"style"}),i.events.add("styledata",this.syncHiddenState),w},o}(oi),rse=Bl;function W3(a){var o=-1,i=null==a?0:a.length;for(this.__data__=new rse;++o<i;)this.add(a[o])}W3.prototype.add=W3.prototype.push=function pZ(a){return this.__data__.set(a,"__lodash_hash_undefined__"),this},W3.prototype.has=function R1(a){return this.__data__.has(a)};var Jo,si,Mo,es,ao,M1=W3,Z3=function GM(a,o){for(var i=-1,l=null==a?0:a.length;++i<l;)if(o(a[i],i,a))return!0;return!1},Q3=function Y3(a,o){return a.has(o)},WM=function k1(a,o,i,l,u,h){var g=1&i,w=a.length;if(w!=(T=o.length)&&!(g&&w<T))return!1;var T=h.get(a),D=h.get(o);if(T&&D)return T==o&&D==a;var P=-1,N=!0,z=2&i?new M1:void 0;for(h.set(a,o),h.set(o,a);++P<w;){var W,ue=a[P],ge=o[P];if(void 0!==(W=l?g?l(ge,ue,P,o,a,h):l(ue,ge,P,a,o,h):W)){if(W)continue;N=!1;break}if(z){if(!Z3(o,function(we,Re){if(!Q3(z,Re)&&(ue===we||u(ue,we,i,l,h)))return z.push(Re)})){N=!1;break}}else if(ue!==ge&&!u(ue,ge,i,l,h)){N=!1;break}}return h.delete(a),h.delete(o),N},r$=uM,i$=$i,gZ=WM,yZ=function X3(a){var o=-1,i=Array(a.size);return a.forEach(function(l,u){i[++o]=[u,l]}),i},e4=function ose(a){var o=-1,i=Array(a.size);return a.forEach(function(l){i[++o]=l}),i},l$=Qg?Qg.prototype:void 0,XM=l$?l$.valueOf:void 0,aS=tM,yl=Object.prototype.hasOwnProperty,Kc=bR,SZ=WM,AZ=function ase(a,o,i,l,u,h,g){switch(i){case"[object DataView]":if(a.byteLength!=o.byteLength||a.byteOffset!=o.byteOffset)return!1;a=a.buffer,o=o.buffer;case"[object ArrayBuffer]":return!(a.byteLength!=o.byteLength||!h(new r$(a),new r$(o)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i$(+a,+o);case"[object Error]":return a.name==o.name&&a.message==o.message;case"[object RegExp]":case"[object String]":return a==o+"";case"[object Map]":var w=yZ;case"[object Set]":if(w=w||e4,a.size!=o.size&&!(1&l))return!1;var T=g.get(a);return T?T==o:(l|=2,g.set(a,o),T=gZ(w(a),w(o),l,u,h,g),g.delete(a),T);case"[object Symbol]":if(XM)return XM.call(a)==XM.call(o)}return!1},c$=$l,JM=Cm,DZ=Wb,r4=Pv,h$="[object Arguments]",d$="[object Array]",cS="[object Object]",i4=Object.prototype.hasOwnProperty,cse=function RZ(a,o,i,l,u,h){var g=JM(a),P=JM(o),w=g?d$:c$(a),T=(P=P?d$:c$(o),(w=w==h$?cS:w)==cS),D=(P=P==h$?cS:P)==cS;if((P=w==P)&&DZ(a)){if(!DZ(o))return!1;T=!(g=!0)}return P&&!T?(h=h||new Kc,g||r4(a)?SZ(a,o,i,l,u,h):AZ(a,o,w,i,l,u,h)):1&i||(g=T&&i4.call(a,"__wrapped__"),w=D&&i4.call(o,"__wrapped__"),!g&&!w)?P&&function CZ(a,o,i,l,u,h){var g=1&i,w=aS(a),T=w.length;if(T!=aS(o).length&&!g)return!1;for(var D=T;D--;){var P=w[D];if(!(g?P in o:yl.call(o,P)))return!1}var N=h.get(a),z=h.get(o);if(N&&z)return N==o&&z==a;for(var W=!0,ue=(h.set(a,o),h.set(o,a),g);++D<T;){var ge,we=a[P=w[D]],Re=o[P];if(!(void 0===(ge=l?g?l(Re,we,P,o,a,h):l(we,Re,P,a,o,h):ge)?we===Re||u(we,Re,i,l,h):ge)){W=!1;break}ue=ue||"constructor"==P}return W&&!ue&&(N=a.constructor)!=(z=o.constructor)&&"constructor"in a&&"constructor"in o&&!("function"==typeof N&&N instanceof N&&"function"==typeof z&&z instanceof z)&&(W=!1),h.delete(a),h.delete(o),W}(a,o,i,l,u,h=h||new Kc):u(g?a.value():a,w?o.value():o,i,l,h=h||new Kc)},o4=Yh,p$=function s4(a,o,i,l,u){return a===o||(null==a||null==o||!o4(a)&&!o4(o)?a!=a&&o!=o:cse(a,o,i,l,s4,u))},Gl=Nl(function use(a,o){return p$(a,o)}),Rr=function(){function a(o,i,l,u){this.type="Feature",this.type=a.TYPE,this.properties=i||{},this.id=l,this.geometry=o,this.bbox=u}return a.TYPE="Feature",a}(),f$=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),_l=function(a){function o(i,l){return a.call(this,i,l)||this}return f$(o,a),o.fromData=function(i){var l=NaN,u=NaN,h=new Set(["y"]),g=new Set(["x"]);return Object.keys(i).forEach(function(w){var T=w.toLowerCase();isNaN(l)&&h.has(T)&&"number"==typeof i[w]?l=i[w]:isNaN(u)&&g.has(T)&&"number"==typeof i[w]&&(u=i[w])}),isNaN(l)||isNaN(u)?null:new o(l,u)},o.getX=function(i){return 0<i.length?i[0]:NaN},o.getY=function(i){return 1<i.length?i[1]:NaN},o.getDestination=function(i,l,u){return new o(o.getX(i)+u*Math.cos((l+270)*Math.PI/180),o.getY(i)+u*Math.sin((l+270)*Math.PI/180))},o.getDistance=function(h,l){var u=o.getX(h)-o.getX(l);return h=o.getY(h)-o.getY(l),Math.sqrt(u*u+h*h)},o.getHeading=function(h,l){var u=o.getX(l)-o.getX(h);return h=o.getY(h)-o.getY(l),180*(2.5*Math.PI-Math.atan2(h,u))/Math.PI%360},o}(Array),mf=function(){function a(o){this.type="Point",this.type=a.TYPE,this.coordinates=o}return a.TYPE="Point",a}(),Ji=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},MZ=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},N1=6378137,kZ=Math.PI/180,m$=180/Math.PI,e2=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9],L1=85.0511;function vl(a){return a*kZ}function uS(a){return a*m$}function t2(a,o,i){return Math.min(Math.max(a,o),i)}function a4(u,o){var l=vl(o[1]-u[1]),i=vl(o[0]-u[0]);return l=Math.pow(Math.sin(l/2),2)+Math.cos(vl(u[1]))*Math.cos(vl(o[1]))*Math.pow(Math.sin(i/2),2),u=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),Math.round(N1*u*100)/100}function l4(a){if(a)switch(a.toLowerCase()){case"feet":case"foot":case"ft":return si.feet;case"kilometers":case"kilometer":case"kilometres":case"kilometre":case"km":case"kms":return si.kilometers;case"miles":case"mile":case"mi":return si.miles;case"nauticalmiles":case"nauticalmile":case"nms":case"nm":return si.nauticalMiles;case"yards":case"yard":case"yds":case"yrd":case"yrds":return si.yards;default:return si.meters}return si.meters}function g$(a){if(a)switch(a.toLowerCase()){case"milespersecondsquared":case"milepersecondsquared":case"mi/s^2":case"mi/s2":return ao.milesPerSecondSquared;case"kilometerspersecondsquared":case"kilometrespersecondsquared":case"kilometerpersecondsquared":case"kilometrepersecondsquared":case"km/s^2":case"km/s2":return ao.kilometersPerSecondSquared;case"knotspersecond":case"knotpersecond":case"knts/s":case"kn/s":case"kt/s":return ao.knotsPerSecond;case"standardgravity":case"g":return ao.standardGravity;case"feetpersecondsquared":case"footpersecondsquared":case"ft/s^2":case"ft/s2":return ao.feetPerSecondSquared;case"yardspersecondsquared":case"yardpersecondsquared":case"yds/s^2":case"yds/s2":case"yd/s^2":case"yd/s2":return ao.yardsPerSecondSquared;case"milesperhoursecond":case"mileperhoursecond":case"milesperhourseconds":case"mileperhourseconds":case"mi/h/s":return ao.milesPerHourSecond;case"kilometersperhoursecond":case"kilometrespersoursecond":case"kilometerperhoursecond":case"kilometrepersoursecond":case"kilometersperhourssecond":case"kilometrespersourssecond":case"kilometerperhourssecond":case"kilometrepersourssecond":case"kmhs":case"km/h/s":return ao.kilometersPerHourSecond;default:return ao.metersPerSecondSquared}return ao.metersPerSecondSquared}function y$(a){if(a)switch(a){case"acres":case"ac":return Jo.acres;case"hectares":case"ha":return Jo.hectares;case"squareFeet":case"ft^2":case"ft2":return Jo.squareFeet;case"squareYards":case"squareYard":case"yds^2":case"yds2":case"yd^2":case"yd2":return Jo.squareYards;case"squareKilometers":case"squareKilometres":case"squareKilometer":case"squareKilometre":case"km^2":case"km2":return Jo.squareKilometers;case"squareMiles":case"squareMile":case"mi^2":case"mi2":return Jo.squareMiles;default:return Jo.squareMeters}return Jo.squareMeters}function c4(a){if(a)switch(a.toLowerCase()){case"feetpersecond":case"footsecond":case"ftps":case"ft/s":return es.feetPerSecond;case"milesperhour":case"mileperhour":case"mph":case"mi/hr":case"mi/h":return es.milesPerHour;case"knots":case"knot":case"knts":case"knt":case"kn":case"kt":return es.knots;case"mach":case"m":return es.mach;case"kilometersperhour":case"kilometresperhour":case"kmperhour":case"kmph":case"km/hr":case"km/h":return es.kilometersPerHour;default:return es.metersPerSecond}return es.metersPerSecond}function Gv(a){if(a)switch(a.toLowerCase()){case"milliseconds":case"ms":return Mo.ms;case"minutes":case"minute":case"mins":case"min":return Mo.minutes;case"hours":case"hour":case"hr":case"h":return Mo.hours;case"days":case"day":case"d":return Mo.days;default:return Mo.seconds}return Mo.seconds}function gf(a){var o=0;if(a&&0<a.length){o=Math.abs(Kv(a[0]));for(var i=1,l=a.length;i<l;i++)o-=Math.abs(Kv(a[i]))}return o}function Kv(a){var o=0;if(3<=a.length){for(var i=void 0,l=void 0,u=0,h=a.length;u<h;u++)o+=(vl(a[u===h-2?(i=h-2,l=h-1,0):u===h-1?(i=h-1,l=0,1):(l=(i=u)+1,u+2)][0])-vl(a[i][0]))*Math.sin(vl(a[l][1]));o=o*N1*N1/2}return o}function _$(a,o,i){return(a[0]-i[0])*(o[1]-i[1])-(a[1]-i[1])*(o[0]-i[0])}function OZ(a,o,i){if(2<=i.length){for(var l,u,h,g=1/0,w=null,T=Ur(i,22),D=0,P=T.length-1;D<P;D++)u=v$(o,T[D],T[D+1]),(l=_l.getDistance(o,u))<g&&(g=l,w=u);if(w)return h=r2([w],22)[0],new Rr(new mf(h),{distance:Yc(a,h)})}else if(1===i.length)return new Rr(new mf(i[0]),{distance:Yc(a,i[0])});return null}function v$(a,o,i){var l,u;return o[0]===i[0]&&o[1]===i[1]||(a=((l=i[0]-o[0])*(u=a[0]-o[0])+(u=i[1]-o[1])*(a=a[1]-o[1]))/(l*l+u*u))<0?o:1<a?i:[o[0]+l*a,o[1]+u*a]}function Wc(a,o){var i;return!isNaN(a)&&"number"==typeof o&&0<=o&&(i=o<e2.length?e2[o]:Math.pow(10,o),a=Math.round(a*i)/i),a}function mh(a,o,i,l){switch(l4(o)){case si.meters:a/=1e3;break;case si.feet:a/=3280.8399;break;case si.miles:a/=.62137119;break;case si.yards:a/=1093.6133;break;case si.nauticalMiles:a/=.5399568}switch(l4(i)){case si.meters:a*=1e3;break;case si.feet:a*=3280.8399;break;case si.miles:a*=.62137119;break;case si.yards:a*=1093.6133;break;case si.nauticalMiles:a*=.5399568}return"number"==typeof l&&0<=l&&(o=Math.pow(10,l),a=Math.round(a*o)/o),a}function Wv(w,T,h,g){g=g||"meters",w=Zc(w),g=h4(g);var u=vl(w[1]);return w=vl(w[0]),T=vl(T),h/=g,g=Math.asin(Math.sin(u)*Math.cos(h)+Math.cos(u)*Math.sin(h)*Math.cos(T)),w+=Math.atan2(Math.sin(T)*Math.sin(h)*Math.cos(u),Math.cos(h)-Math.sin(u)*Math.sin(g)),T=t2(ba(uS(g)),-85,85),[Qs(uS(w)),T]}function Yc(a,o,i){return a=a4(a=Zc(a),o=Zc(o)),"meters"===i?a:mh(a,"meters",i||"meters")}function h4(a){return a=l4(a),mh(N1,si.meters,a)}function w$(a,o,i){for(var l=[],u=vl(a[1]),h=vl(a[0]),g=vl(o[1]),w=vl(o[0]),T=2*Math.asin(Math.sqrt(Math.pow(Math.sin((u-g)/2),2)+Math.cos(u)*Math.cos(g)*Math.pow(Math.sin((h-w)/2),2))),D=0;D<=i;D++){var z=D/i,W=Math.sin((1-z)*T)/Math.sin(T),P=(z=Math.sin(z*T)/Math.sin(T),W*Math.cos(u)*Math.cos(h)+z*Math.cos(g)*Math.cos(w)),N=W*Math.cos(u)*Math.sin(h)+z*Math.cos(g)*Math.sin(w);W=W*Math.sin(u)+z*Math.sin(g),z=Math.atan2(W,Math.sqrt(Math.pow(P,2)+Math.pow(N,2))),W=Math.atan2(N,P),z=t2(uS(z),-85,85),W=uS(W),l.push([W,z])}return l}function d4(a){return(Array.isArray(a)?a:a.coordinates).reduce(function(o,i){var l=0<o.length?o[o.length-1]:null;return l&&180<Math.abs(i[0]-l[0])?o.push([l=l[0]<0?i[0]-360:i[0]+360,i[1]]):o.push(i),o},[])}function b$(a){for(var o,i,l,u,h,g=Array.isArray(a)?a:a.coordinates,w=[],T=[],D=0;D<g.length;D++)w.push(g[D]),D+1>=g.length||(o=(i=Ji(g[D],2))[0],i=i[1],u=(h=Ji(g[D+1],2))[0],h=h[1],180<Math.abs(u-o)&&(l=0<o?180:-180,u=Math.abs((0<o?u+360:u-360)-o),h=i+(h-i)*(Math.abs(l-o)/u),w.push([l,h]),T.push(w),w=[[-l,h]]));return T.push(w),T}function by(a,o){var i,l;return a=Zc(a),o=Zc(o),a&&2<=a.length&&o&&2<=o.length?(l=vl(a[1]),i=vl(o[1]),o=vl(o[0]-a[0]),a=Math.sin(o)*Math.cos(i),l=Math.cos(l)*Math.sin(i)-Math.sin(l)*Math.cos(i)*Math.cos(o),(uS(Math.atan2(a,l))+360)%360):NaN}function x$(a,o){var i,l=0;Array.isArray(a)?i=a:a.type&&"LineString"===a.type&&(i=a.coordinates);for(var u=0,h=i.length-1;u<h;u++)l+=a4(i[u],i[u+1]);return mh(l,"meters",o||"meters")}function NZ(a,o,i){i=i||"meters";var l,u=0;if(Array.isArray(a)?l=a:a.type&&"LineString"===a.type&&(l=a.coordinates),2<=l.length){for(var h,g,w=l.length,T=1;T<w;T++){if(o<=u+(g=Yc(l[T-1],l[T],i)))return h=by(l[T-1],l[T]),Wv(l[T-1],h,o-u,i);u+=g}return u<=o?l[w-1]:l[0]}return null}function p4(a,o,i,l,u){l=l||"meters",u=u||0,a=Zc(a);for(var h=[],g=360/i,w=0;w<=i;w++)h.push(Wv(a,(w*g+u)%360,o,l));return h}function f4(a,o,i,l,u){return d4(p4(a,o,i,l,u))}function F1(a,o,i){i=void 0===i?.5:i;var l=Yc(a=Zc(a),o=Zc(o),"kilometers");return Wv(a,by(a,o),l*i,"kilometers")}function ba(a){return 90<a?180<(a=(a+90)%360)?90-(a-180):a-90:a<-90?(a=(a-90)%360)<-180?-90-(a+180):a+90:a}function Qs(a){return 180<a?(a+180)%360-180:a<-180?(a-180)%360+180:a}function T$(a,o,i){if(0===i)return Object.assign({},a);o=Zc(o);for(var l,u,h=[],g=0,w=a.length;g<w;g++)l=Yc(o,a[g]),u=by(o,a[g]),h.push(Wv(o,u+i,l));return h}function r2(a,o){for(var u=512*Math.pow(2,o),h=[],g=0,w=a.length;g<w;g++)h.push([360*(a[g][0]/u-.5),90-360*Math.atan(Math.exp(2*-(.5-a[g][1]/u)*Math.PI))/Math.PI]);return h}function Ur(a,o){for(var i,l,u=512*Math.pow(2,o),h=[],g=0,w=a.length;g<w;g++)l=Math.sin(a[g][1]*Math.PI/180),i=(a[g][0]+180)/360,l=.5-Math.log((1+l)/(1-l))/(4*Math.PI),h.push([Math.round(i*u),Math.round(l*u)]);return h}function fn(a,o,i,l){switch(g$(o)){case ao.kilometersPerHourSecond:a/=3.6;break;case ao.milesPerHourSecond:a/=2.236936292054;break;case ao.knotsPerSecond:a/=1.943844492441;break;case ao.standardGravity:a/=.1019716212978;break;case ao.kilometersPerSecondSquared:a/=.001;break;case ao.milesPerSecondSquared:a/=.000621371192;break;case ao.feetPerSecondSquared:a/=3.280839895012;break;case ao.yardsPerSecondSquared:a/=1.093613298338}switch(g$(i)){case ao.kilometersPerHourSecond:a*=3.6;break;case ao.milesPerHourSecond:a*=2.236936292054;break;case ao.knotsPerSecond:a*=1.943844492441;break;case ao.standardGravity:a*=.1019716212978;break;case ao.kilometersPerSecondSquared:a*=.001;break;case ao.milesPerSecondSquared:a*=.000621371192;break;case ao.feetPerSecondSquared:a*=3.280839895012;break;case ao.yardsPerSecondSquared:a*=1.093613298338}return Wc(a,l)}function m4(a,o,i,l){switch(y$(o)){case Jo.acres:a*=4046.8564224;break;case Jo.hectares:a*=1e4;break;case Jo.squareFeet:a*=.09290304;break;case Jo.squareKilometers:a*=1e6;break;case Jo.squareMiles:a*=259e4;break;case Jo.squareYards:a*=.83612736}switch(y$(i)){case Jo.acres:a/=4046.8564224;break;case Jo.hectares:a/=1e4;break;case Jo.squareFeet:a/=.09290304;break;case Jo.squareKilometers:a/=1e6;break;case Jo.squareMiles:a/=259e4;break;case Jo.squareYards:a/=.83612736}return Wc(a,l)}function vt(a,o,i,l){switch(c4(o)){case es.feetPerSecond:a*=1.09728;break;case es.milesPerHour:a*=1.6093;break;case es.knots:a*=1.852;break;case es.metersPerSecond:a*=3.6;break;case es.mach:a*=1234.8}switch(c4(i)){case es.feetPerSecond:a/=1.09728;break;case es.milesPerHour:a/=1.6093;break;case es.knots:a/=1.852;break;case es.metersPerSecond:a/=3.6;break;case es.mach:a/=1234.8}return Wc(a,l)}function Yv(a,o,i,l){switch(Gv(o)){case Mo.ms:a/=1e3;break;case Mo.hours:a*=3600;break;case Mo.minutes:a*=60;break;case Mo.days:a*=86400}switch(Gv(i)){case Mo.ms:a*=1e3;break;case Mo.hours:a/=3600;break;case Mo.minutes:a/=60;break;case Mo.days:a/=86400}return Wc(a,l)}function I$(a,o,i,l,u,h,g,w){return o=mh(o,u,si.meters),u=Yv(i,h,Mo.seconds),fn(2*(o-vt(a,l,es.metersPerSecond)*u)/(u*u),ao.metersPerSecondSquared,g,w)}function hS(a,o,i,l,u,h,g){return a=vt(a,l,es.metersPerSecond),fn((vt(o,l,es.metersPerSecond)-a)/Yv(i,u,Mo.seconds),ao.metersPerSecondSquared,h,g)}function pS(a,o,i,l){return a=fS(a),o=fS(o),null!=a&&null!=o?Yv(o.getTime()-a.getTime(),Mo.ms,i,l):NaN}function fS(a){if("[object Date]"===Object.prototype.toString.call(a))return a;if("string"==typeof a){var o=Date.parse(a);if(!isNaN(o))return new Date(o);if(0<=a.indexOf("Date("))return o=(o=0)<(a=a.replace("/Date(","").replace(")/","")).indexOf("+")?parseInt(a.substr(0,a.indexOf("+")),10):0<a.indexOf("-")?parseInt(a.substr(0,a.indexOf("-")),10):parseInt(a,10),new Date(o)}else if("number"==typeof a)return new Date(a);return null}function km(a){var o=[],i=null,l=null;if(Array.isArray(a)&&0<a.length)if(Array.isArray(a[0])&&"number"==typeof a[0][0])o=a;else for(var u=a.length,h=0;h<u;h++)o=o.concat(km(a[h]));else if(a.type)switch(a.type){case"Point":o=[a.coordinates];break;case"LineString":case"MultiPoint":o=a.coordinates;break;case"Polygon":case"MultiLineString":i=a.coordinates;break;case"MultiPolygon":l=a.coordinates;break;case"Feature":var g=a;o=ws._isCircle(g)?ws._getCirclePositions(g):km(g.geometry);break;case"FeatureCollection":o=km(a.features);break;case"GeometryCollection":o=km(a.geometries)}else if(a instanceof ws)return km(a.toJson());if(i)for(u=i.length,h=0;h<u;h++)o=o.concat(i[h]);else if(l){var w=l.length;for(h=0;h<w;h++)for(var T=l[h].length,D=0;D<T;D++)o=o.concat(l[h][D])}return o}function Zc(a){if(Array.isArray(a)&&"number"==typeof a[0])return a;if(a.type){if("Point"===a.type)return a.coordinates;if("Feature"===a.type&&"Point"===a.geometry.type)return a.geometry.coordinates}else if(a instanceof ws&&"Point"===a.getType())return a.getCoordinates();return null}function D$(a,o,i){i=i||"meters";var l,u=0;if(Array.isArray(a)?l=a:a.type&&"LineString"===a.type&&(l=a.coordinates),2<=l.length){for(var h,g,w,T=l.length,D=1;D<T;D++){if(o<=u+(w=Yc(l[D-1],l[D],i)))return h=by(l[D-1],l[D]),g=Wv(l[D-1],h,o-u,i),new Rr(new mf(g),{heading:h});u+=w}return u<=o?new Rr(new mf(l[T-1]),{heading:by(l[T-2],l[T-1])}):new Rr(new mf(l[0]),{heading:by(l[0],l[1])})}return null}function s2(a,o,i,l){var ue,u=Zc(a),h=Ur([u],22)[0],g=null,w=1/0;switch((o=o instanceof ws?o.toJson():o).type){case"Feature":return s2(a,o.geometry,i);case"Point":W=[[o.coordinates]];break;case"MultiPoint":for(var T,D=o.coordinates,P=0,N=D.length;P<N;P++)(T=Yc(u,D[P]))<w&&(w=T,g=new Rr(new mf(D[P]),{distance:T}));break;case"LineString":W=[o.coordinates];break;case"Polygon":case"MultiLineString":W=o.coordinates;break;case"MultiPolygon":var z=o.coordinates;if(0<z.length){var W=z[0];for(P=1,N=z.length;P<N;P++)W=W.concat(z[P])}}if(W)for(P=0,N=W.length;P<N;P++)(ue=OZ(u,h,W[P]))&&ue.properties.distance<w&&(w=ue.properties.distance,g=ue);return g&&(g.properties.distance=mh(g.properties.distance,"meters",i,l)),g}(function(a){a.squareMeters="squareMeters",a.acres="acres",a.hectares="hectares",a.squareFeet="squareFeet",a.squareKilometers="squareKilometers",a.squareMiles="squareMiles",a.squareYards="squareYards"})(Jo=Jo||{}),function(a){a.meters="meters",a.kilometers="kilometers",a.feet="feet",a.miles="miles",a.nauticalMiles="nauticalMiles",a.yards="yards"}(si=si||{}),function(a){a.seconds="seconds",a.hours="hours",a.ms="ms",a.minutes="minutes",a.days="days"}(Mo=Mo||{}),function(a){a.metersPerSecond="metersPerSecond",a.kilometersPerHour="kilometersPerHour",a.feetPerSecond="feetPerSecond",a.milesPerHour="milesPerHour",a.knots="knots",a.mach="mach"}(es=es||{}),function(a){a.milesPerSecondSquared="milesPerSecondSquared",a.kilometersPerSecondSquared="kilometersPerSecondSquared",a.knotsPerSecond="knotsPerSecond",a.standardGravity="standardGravity",a.feetPerSecondSquared="feetPerSecondSquared",a.yardsPerSecondSquared="yardsPerSecondSquared",a.milesPerHourSecond="milesPerHourSecond",a.kilometersPerHourSecond="kilometersPerHourSecond",a.metersPerSecondSquared="metersPerSecondSquared"}(ao=ao||{});var FZ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Kl=function(a){function o(i,l,u){return u?a.call(this,i,l,u)||this:a.call(this,i,l)||this}return FZ(o,a),o.fromPosition=function(i){return 2===i.length?new o(i[0],i[1]):2<i.length?new o(i[0],i[1],i[2]):null},o.areEqual=function(i,l,u){var h,g;return void 0===u&&(u=6),!!(i&&2<=i.length&&l&&2<=l.length)&&(u=Math.pow(10,u),g=ba(i[1]),h=ba(l[1]),i=Qs(i[0]),l=Qs(l[0]),Math.round((g-h)*u)/u==0)&&(0==(g=Math.round((i-l)*u)/u)||360==g)},o.fromLatLng=function(i,l,u){var h,g,w,T,D,P,N=[];return"number"==typeof i?("number"==typeof l&&N.push(l),N.push(i),"number"==typeof u&&N.push(u)):Array.isArray(i)?2<=i.length&&"number"==typeof i[0]&&"number"==typeof i[1]&&(3<=i.length&&"number"==typeof i[2]?N.push(i[1],i[0],i[2]):N.push(i[1],i[0])):"object"==typeof i&&(h=["lat","latitude","y"],g=["lng","longitude","lon","x"],w=["elv","elevation","alt","altitude","z"],P=D=T=NaN,Object.keys(i).forEach(function(z,W,ue){var ge=z.toLowerCase();isNaN(T)&&0<=h.indexOf(ge)&&"number"==typeof i[z]?T=i[z]:isNaN(D)&&0<=g.indexOf(ge)&&"number"==typeof i[z]?D=i[z]:isNaN(P)&&0<=w.indexOf(ge)&&"number"==typeof i[z]&&(P=i[z])}),isNaN(T)||isNaN(D)||(N.push(D,T),isNaN(P))||N.push(P)),2<=N.length?N:null},o.fromLatLngs=function(i){var l=[];if(Array.isArray(i))for(var u=0,h=i.length;u<h;u++){var g=o.fromLatLng(i[u]);g&&l.push(g)}return l},o._getDimensions=function(i){for(var l=0;Array.isArray(i);)i=i[0],l++;return"number"==typeof i&&l--,l},o}(Array),a2=function(){function a(o,i){this.type="Polygon",this.type=a.TYPE,this.coordinates=1===Kl._getDimensions(o)?[o]:o,this.bbox=i}return a.TYPE="Polygon",a}(),R$=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),y4=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},ws=function(a){function o(i,l,u){var h,g,w=a.call(this)||this;return"Feature"===i.type?(g=Ki((h=i).geometry),u=h.properties?Ki(h.properties):{},l=null==h.id||""===h.id?dm():h.id):(g=Ki(i),l=null==l||""===l?dm():l,u=u?Ki(u):{}),u[o._shapeIdPropName]=l,w.data=new Rr(g,u,l),w._handleCircle(),w}return R$(o,a),o.prototype.addProperty=function(i,l){Gl(this.data.properties[i],l)||(this.data.properties[i]=Ki(l),"subType"!==i&&"radius"!==i||this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},o.prototype.getBounds=function(){var i,l,u,h,g,w=this.getCoordinates(),T=this.getType();if("Point"===T)g=this.circlePolygon?gi.fromPositions((D=this.circlePolygon.geometry.coordinates)[0]):new gi(D=w,D);else if("MultiPoint"===T||"LineString"===T){var D=w;g=gi.fromPositions(D)}else if("Polygon"===T)g=gi.fromPositions((D=w)[0]);else if("MultiLineString"===T){D=w;try{for(var P=y4(D),N=P.next();!N.done;N=P.next())g=gi.merge(g,gi.fromPositions(N.value))}catch(we){i={error:we}}finally{try{N&&!N.done&&(l=P.return)&&l.call(P)}finally{if(i)throw i.error}}}else if("MultiPolygon"===T){D=w;try{for(var W=y4(D),ue=W.next();!ue.done;ue=W.next())g=gi.merge(g,gi.fromPositions(ue.value[0]))}catch(we){u={error:we}}finally{try{ue&&!ue.done&&(h=W.return)&&h.call(W)}finally{if(u)throw u.error}}}return g},o.prototype.getCoordinates=function(){return Ki(this.data.geometry.coordinates)},o.prototype.getCircleCoordinates=function(){return this.circlePolygon?Ki(this.circlePolygon.geometry.coordinates[0]):null},o.prototype.getId=function(){return this.data.id},o.prototype.getProperties=function(){return Ki(this.data.properties)},o.prototype.getType=function(){return this.data.geometry.type},o.prototype.isCircle=function(){return o._isCircle(this.data)},o.prototype.isRectangle=function(){return o._isRectangle(this.data)},o.prototype.setCoordinates=function(i){i="Polygon"===this.getType()&&1===Kl._getDimensions(i)?[i]:i,Gl(this.data.geometry.coordinates,i)||(this.data.geometry.coordinates=Ki(i),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},o.prototype.setProperties=function(i){i[o._shapeIdPropName]=this.data.id,Gl(this.data.properties,i)||(this.data.properties=Ki(i),this._handleCircle(),this.dataSource&&this.dataSource._updateSource(),this._invokeEvent("shapechanged",this))},o.prototype.toJson=function(){return JSON.parse(JSON.stringify(this.data))},o.prototype._toJson=function(){return this.circlePolygon||this.data},o.prototype._setDataSource=function(i){void 0===i||null==i?delete this.dataSource:this.dataSource=i},o.prototype._handleCircle=function(){var i;this.isCircle()?(i=o._getCirclePositions(this.data),this.circlePolygon=new Rr(new a2([i]),this.data.properties,this.data.id),this.data.properties.subType="Circle"):delete this.circlePolygon},o._isCircle=function(i){return i&&i.geometry&&"Point"===i.geometry.type&&i.geometry.coordinates&&i.properties&&"string"==typeof i.properties.subType&&"circle"===i.properties.subType.toLowerCase()&&"number"==typeof i.properties.radius},o._isRectangle=function(i){if("Polygon"===i.geometry.type&&i.geometry.coordinates&&"string"==typeof i.properties.subType&&"rectangle"===i.properties.subType.toLowerCase()&&1===(i=i.geometry.coordinates).length){if(5===(i=i[0]).length)return i[0][0]===i[4][0]&&i[0][1]===i[4][1];if(4===i.length)return!0}return!1},o._getCirclePositions=function(i){return f4(i.geometry.coordinates,i.properties.radius,72,"meters")},o._shapeIdPropName="_azureMapsShapeId",o}(Pa),VZ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),gh=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},gi=function(a){function o(i,l){var u,h=this;return i&&l?h=(u=i)[2]&&l[2]?a.call(this,u[0],u[1],u[2]||0,l[0],l[1],l[2]||0)||this:a.call(this,u[0],u[1],l[0],l[1])||this:i&&(u=i)&&(4===u.length?h=a.call(this,u[0],u[1],u[2],u[3])||this:6<=u.length&&(h=a.call(this,u[0],u[1],u[2],u[3],u[4],u[5])||this)),h}return VZ(o,a),o.fromBoundingBox=function(g){var l=o.getWest(g),u=o.getSouth(g),h=o.getEast(g);return g=o.getNorth(g),new o([l,u,h,g])},o.fromDimensions=function(w,l,T){var h=w[0],g=(w=w[1],Math.min(Math.max(w+T/2,-85.5),85.5));return w=Math.min(Math.max(w-T/2,-85.5),85.5),T=Qs(h+l/2),new o([Qs(h-l/2),w,T,g])},o.fromEdges=function(i,l,u,h){return new o([i,l,u,h])},o.containsPosition=function(w,g){var h=o.getCenter(w),u=Math.abs(h[1]-g[1]);return 180<(h=Math.abs(h[0]-g[0]))&&(h=360-h),g=o.getHeight(w),w=o.getWidth(w),u<=g/2+1e-8&&h<=w/2+1e-8},o.containsBoundingBox=function(i,l){return!(!i||4!==i.length||!l||4!==l.length)&&o.getWest(i)<o.getWest(l)&&o.getWest(l)<o.getEast(i)&&o.getWest(i)<o.getEast(l)&&o.getEast(l)<o.getEast(i)&&o.getSouth(i)<o.getSouth(l)&&o.getSouth(l)<o.getNorth(i)&&o.getSouth(i)<o.getNorth(l)&&o.getNorth(l)<o.getNorth(i)},o.crossesAntimeridian=function(i){return Qs(o.getEast(i))-Qs(o.getWest(i))<0||o.isBoundingBoxWithSixOrMoreElementsLargerThanGlobe(i)||o.isBoundingBoxWithLessThanSixElementsLargerThanGlobe(i)},o.getCenter=function(h){var l=((u=Qs(o.getEast(h)))<(l=Qs(o.getWest(h)))&&(u+=360),Qs((l+u)/2)),u=ba(o.getSouth(h));return h=ba(o.getNorth(h)),[l,ba((u+h)/2)]},o.getHeight=function(i){return i=ba(o.getNorth(i))-ba(o.getSouth(i)),isNaN(i)?0:i},o.getWidth=function(i){return i=Qs(o.getEast(i))-Qs(o.getWest(i)),isNaN(i)?0:i<0?i+360:i},o.getSouthWest=function(u){var l=this.getSouth(u);return u=this.getWest(u),isNaN(l)||isNaN(u)?null:[u,l]},o.getNorthEast=function(u){var l=this.getNorth(u);return u=this.getEast(u),isNaN(l)||isNaN(u)?null:[u,l]},o.getNorthWest=function(u){var l=this.getNorth(u);return u=this.getWest(u),isNaN(l)||isNaN(u)?null:[u,l]},o.getSouthEast=function(u){var l=this.getSouth(u);return u=this.getEast(u),isNaN(l)||isNaN(u)?null:[u,l]},o.getSouth=function(i){return i&&4<=i.length?Number(i[1]):NaN},o.getWest=function(i){return i&&4<=i.length?Number(i[0]):NaN},o.getNorth=function(i){if(i){if(4===i.length)return Number(i[3]);if(6===i.length)return Number(i[4])}return NaN},o.getEast=function(i){if(i){if(4===i.length)return Number(i[2]);if(6===i.length)return Number(i[3])}return NaN},o.intersect=function(w,D){var h=o.getCenter(w),g=o.getCenter(D),u=Math.abs(h[1]-g[1]),T=(180<(h=Math.abs(h[0]-g[0]))&&(h=360-h),g=o.getHeight(w),w=o.getWidth(w),o.getHeight(D));return D=o.getWidth(D),u<=g/2+T/2&&h<=w/2+D/2},o.merge=function(i,l){var h=l&&4===l.length;if((u=i&&4===i.length)&&!h)return i;if(h&&!u)return l;if(!u&&!h)return null;var u=Math.max(ba(o.getNorth(i)),ba(o.getNorth(l))),g=(h=Math.min(ba(o.getSouth(i)),ba(o.getSouth(l))),[i,l]),w=[],T=0;for(T=0;T<g.length;T++){var D=g[T],P=Qs(o.getWest(D)),N=Qs(o.getEast(D));o.crossesAntimeridian(D)?(w.push([P,180]),w.push([-180,N])):w.push([P,N])}w.sort(function(Mt,St){return Mt[0]===St[0]?Mt[1]-St[1]:Mt[0]-St[0]});var z=[],W=w[0];for(T=1;T<w.length;){var ue=w[T];W[1]>=ue[0]?W[1]=Math.max(W[1],ue[1]):(z.push(W),W=ue),T++}z.push(W);var ge=z.length,we=z[0][0]+360-z[ge-1][1],Re=[z[ge-1][1],z[0][0]];for(T=1;T<ge;T++){var et=z[T][0]-z[T-1][1];we<et&&(we=et,Re=[z[T-1][1],z[T][0]])}return new o([Re[1],h],[Re[0],u])},o.fromPositions=function(i){for(var l,u,h=NaN,g=NaN,w=NaN,T=NaN,D=i.length,P=new Array(D),N=0;D--;)(u=i[D])&&2<=u.length&&(l=ba(u[1]),h=isNaN(h)?l:Math.max(h,l),g=isNaN(g)?l:Math.min(g,l),P[N++]=Qs(u[0]));if(N){P.length=N,P.sort(function(ge,we){return ge-we});var z=P[0]+360-P[N-1],W=0;for(D=1;D<N;D++){var ue=P[D]-P[D-1];z<ue&&(z=ue,W=D)}w=P[W],T=P[(W||N)-1]}return isNaN(w)||isNaN(g)||isNaN(T)||isNaN(h)?null:new o([w,g,T,h])},o.fromLatLngs=function(i){return o.fromPositions(Kl.fromLatLngs(i))},o.fromData=function(i){var l,u,h=null;if(Array.isArray(i)&&0<i.length){try{for(var g=gh(i),w=g.next();!w.done;w=g.next()){var T;null!=(T=o.fromData(w.value))&&(h=null===h?T:o.merge(h,T))}}catch(et){l={error:et}}finally{try{w&&!w.done&&(u=g.return)&&u.call(g)}finally{if(l)throw l.error}}return h}if(i instanceof ws)return i.getBounds();if(i&&i.type){var P=i;if(P.bbox&&4===P.bbox.length)return P.bbox;switch(P.type){case"FeatureCollection":return o.fromData(P.features);case"Feature":return ws._isCircle(P)?o.fromPositions(ws._getCirclePositions(P)):o.fromData(P.geometry);case"GeometryCollection":return o.fromData(P.geometries);case"Point":var N=P.coordinates;if(N&&2<=N.length)return[N[0],N[1],N[0],N[1]];break;case"LineString":case"MultiPoint":return o.fromPositions(P.coordinates);case"Polygon":case"MultiLineString":var z=P.coordinates;if(z&&0<z.length){for(var W=0,ue=z.length;W<ue;W++)null!=(T=o.fromPositions(z[W]))&&(h=null===h?T:o.merge(h,T));if(null!=h)return h}break;case"MultiPolygon":var ge=P.coordinates;if(ge&&0<ge.length){for(W=0,ue=ge.length;W<ue;W++)for(var we=0,Re=ge[W].length;we<Re;we++)null!=(T=o.fromPositions(ge[W][we]))&&(h=null===h?T:o.merge(h,T));return h}}}return null},o.splitOnAntimeridian=function(i){var l,u,h,g,w,T,D=[];return o.isBoundingBoxWithSixOrMoreElementsLargerThanGlobe(i)?[[-180,i[1],i[2],180,i[4],i[5]]]:o.isBoundingBoxWithLessThanSixElementsLargerThanGlobe(i)?[[-180,i[1],180,i[3]]]:(o.crossesAntimeridian(i)?(l=void 0,u=Qs(o.getWest(i)),h=Qs(o.getEast(i)),g=ba(o.getNorth(i)),w=ba(o.getSouth(i)),T=6<=i.length?(l=[u,w,i[2],180,g,i[5]],[-180,w,i[2],h,g,i[5]]):(l=[u,w,180,g],[-180,w,h,g]),D.push(l,T)):D.push(i),D)},o.isBoundingBoxWithSixOrMoreElementsLargerThanGlobe=function(i){return 6<=i.length&&360<i[3]-i[0]},o.isBoundingBoxWithLessThanSixElementsLargerThanGlobe=function(i){return i.length<6&&360<i[2]-i[0]},o}(Array),Zv=function(){function a(o,i){this.type="FeatureCollection",this.type=a.TYPE,this.features=o,this.bbox=i}return a.TYPE="FeatureCollection",a}(),fse=function(){function a(o){this.type="GeometryCollection",this.type=a.TYPE,this.geometries=o}return a.TYPE="GeometryCollection",a}(),_4=function(){function a(o,i){this.type="LineString",this.type=a.TYPE,this.coordinates=o,this.bbox=i}return a.TYPE="LineString",a}(),M$=function(){function a(o,i){this.type="MultiLineString",this.type=a.TYPE,this.coordinates=o,this.bbox=i}return a.TYPE="MultiLineString",a}(),BZ=function(){function a(o,i){this.type="MultiPoint",this.type=a.TYPE,this.coordinates=o,this.bbox=i}return a.TYPE="MultiPoint",a}(),UZ=function(){function a(o,i){this.type="MultiPolygon",this.type=a.TYPE,this.coordinates=o,this.bbox=i}return a.TYPE="MultiPolygon",a}(),zZ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),k$=function(a){function o(i,l,u){return a.call(this,i,l,u||0)||this}return zZ(o,a),o.fromPosition=function(i){return 2<=i.length?new o((180+i[0])/360,o._latToMercatorY(i[1]),3<=i.length?o._altitudeToMercatorZ(i[2],i[1]):0):[0,0,0]},o.fromPositions=function(i){for(var l=[],u=0,h=i.length;u<h;u++)l.push(this.fromPosition(i[u]));return l},o.toFloat32Array=function(i){for(var l=new Float32Array(3*i.length),u=0,h=i.length;u<h;u++){var g=3*u,w=i[u];l[g]=(180+w[0])/360,l[1+g]=o._latToMercatorY(w[1]),l[2+g]=3<=w.length?o._altitudeToMercatorZ(w[2],w[1]):0}return l},o.toPosition=function(i){var l;return 2<=i.length?(l=360/Math.PI*Math.atan(Math.exp((180-360*i[1])*Math.PI/180))-90,new Kl(360*i[0]-180,l,3<=i.length?o._mercatorZToAltitude(i[2],i[1]):0)):[0,0,0]},o.toPositions=function(i){for(var l=[],u=0,h=i.length;u<h;u++)l.push(this.toPosition(i[u]));return l},o.mercatorScale=function(i){return 1/Math.cos(i*Math.PI/180)},o.meterInMercatorUnits=function(i){return 1/o.earthCircumference*o.mercatorScale(o._latToMercatorY(i))},o._circumferenceAtLatitude=function(i){return o.earthCircumference*Math.cos(i*Math.PI/180)},o._altitudeToMercatorZ=function(i,l){return i/o._circumferenceAtLatitude(l)},o._mercatorZToAltitude=function(i,l){return i*o._circumferenceAtLatitude(o._latToMercatorY(l))},o._latToMercatorY=function(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360},o.earthCircumference=2*Math.PI*h4(),o}(Array),O$=Object.freeze({__proto__:null,BoundingBox:gi,Feature:Rr,FeatureCollection:Zv,GeometryCollection:fse,LineString:_4,MercatorPoint:k$,MultiLineString:M$,MultiPoint:BZ,MultiPolygon:UZ,Point:mf,Polygon:a2,Position:Kl});function v4(a,o){return a*a+o*o}function w4(a,o){return v4(a[0]-o[0],a[1]-o[1])}function jZ(a,h,i){var l,u=h[0],g=i[0]-u,w=i[1]-(h=h[1]);return 0==g&&0==w||(1<(l=((a[0]-u)*g+(a[1]-h)*w)/v4(g,w))?(u=i[0],h=i[1]):0<l&&(u+=g*l,h+=w*l)),v4(a[0]-u,a[1]-h)}function b4(a,o,i,l,u){for(var h,g=l,w=o+1;w<i;w++){var T=jZ(a[w],a[o],a[i]);g<T&&(h=w,g=T)}l<g&&(1<h-o&&b4(a,o,h,l,u),u.push(a[h]),1<i-h)&&b4(a,h,i,l,u)}function $Z(a,o){var i=a.length-1,l=[a[0]];return b4(a,0,i,o,l),l.push(a[i]),l}var GZ=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},mS=function(){function a(o,i){this.M=a._calculateAffineTransform(o,i),this.inverseM=a._calculateAffineTransform(i,o)}return a.prototype.toTarget=function(o,i){return this.transformArray(o,this.M,i)},a.prototype.toSource=function(o,i){return this.transformArray(o,this.inverseM,i)},a.prototype.transformArray=function(o,i,l){var u,h;if(o&&Array.isArray(o)&&Array.isArray(o[0])){var g=[];try{for(var w=GZ(o),T=w.next();!T.done;T=w.next())g.push(this.transform(T.value,i,l))}catch(P){u={error:P}}finally{try{T&&!T.done&&(h=w.return)&&h.call(w)}finally{if(u)throw u.error}}return g}return null},a.prototype.transform=function(h,i,l){var u=h[0]*i[0][3]+h[1]*i[1][3]+i[2][3];return h=h[0]*i[0][4]+h[1]*i[1][4]+i[2][4],"number"==typeof l&&0<=l?[Wc(u,l),Wc(h,l)]:[Wc(u,6),Wc(h,6)]},a._calculateAffineTransform=function(o,i){if(o.length!==i.length||o.length<1)throw new Error("Error: source and target arrays must have the same length.");var l=Math.min(o[0].length,i[0].length),u=l+1;if(o.length<l)throw new Error("Erorr: At least "+l+" reference points required.");for(var h=[],g=[],w=0;w<u;w++){g[w]=[];for(var T=0;T<u;T++){T<l&&(h[T]=0);for(var D=g[w][T]=0;D<o.length;D++)T<l&&(h[T]+=w<l?o[D][w]*i[D][T]:i[D][T]),g[w][T]+=l<=w&&l<=T?1:l<=w?o[D][T]:l<=T?o[D][w]:o[D][w]*o[D][T]}g[w]=g[w].concat(h)}if(this._gaussJordanElimination(g))return g;throw new Error("Error: Singular matrix. Points are likely coplanar.")},a._gaussJordanElimination=function(o){for(var i,l=o.length,u=2*l-1,h=0;h<l;h++){for(var g=h,w=h+1;w<l;w++)Math.abs(o[w][h])>Math.abs(o[g][h])&&(g=w);if(i=o[g],o[g]=o[h],o[h]=i,Math.abs(o[h][h])<=1e-12)return!1;for(var T=h+1;T<l;T++)for(var D=o[T][h]/o[h][h],P=h;P<u;P++)o[T][P]-=o[h][P]*D}for(h=l-1;-1<h;h--){for(D=o[h][h],w=0;w<h;w++)for(var N=u-1;h-1<N;N--)o[w][N]-=o[h][N]*o[w][h]/D;o[h][h]/=D;for(var z=l;z<u;z++)o[h][z]/=D}return!0},a}(),N$=Object.freeze({__proto__:null,get AccelerationUnits(){return ao},AffineTransform:mS,get AreaUnits(){return Jo},get DistanceUnits(){return si},get SpeedUnits(){return es},get TimeUnits(){return Mo},WEBMERCATOR_MAXLAT:L1,_precision:Wc,boundingBoxToPolygon:function u4(u){var o=Qs(gi.getWest(u)),i=Qs(gi.getEast(u)),l=ba(gi.getNorth(u)),h=ba(gi.getSouth(u));return u=gi.getCenter(u),new a2([h=[[o,l],[o,h],[u[0],h],[i,h],[i,l],[u[0],l],[o,l]]])},convertAcceleration:fn,convertArea:m4,convertDistance:mh,convertSpeed:vt,convertTimespan:Yv,getAcceleration:I$,getAccelerationFromFeatures:function V1(a,o,i,l,u,h,g){if("string"==typeof i&&"Feature"===a.type&&"Point"===a.geometry.type&&"Feature"===o.type&&"Point"===o.geometry.type&&(i=pS(a.properties[i],o.properties[i],Mo.seconds),!isNaN(i))){var w=0;if(l&&"string"==typeof l){var T=a.properties[l];if(l=o.properties[l],"number"==typeof T&&(w=T,"number"==typeof l))return hS(T,l,i,u,Mo.seconds,h,g)}return I$(w,Yc(a.geometry.coordinates,o.geometry.coordinates,si.meters),i,u,si.meters,Mo.seconds,h,g)}return NaN},getAccelerationFromSpeeds:hS,getArea:function o2(a,o,i){if(a){var l=0;switch((a=a instanceof ws?a.toJson():a).type){case"Feature":var u=a;if(u.geometry)return o2(u.geometry,o,i);break;case"Polygon":(u=a).coordinates&&(l=gf(u.coordinates));break;case"MultiPolygon":var h=a;if(h.coordinates)for(var g=0,w=h.coordinates.length;g<w;g++)l+=gf(h.coordinates[g])}return m4(l,Jo.squareMeters,o,i)}return 0},getCardinalSpline:function n2(a,o,i,l){if(!a||a.length<=2)return T;"number"!=typeof o&&(o=.5),("number"!=typeof i||i<=0)&&(i=15);var u,h,g,w=a.length,T=a.slice(0),D=(l?(Kl.areEqual(T[0],T[w-1])&&(T.pop(),w--),T.unshift(a[w-1]),T.push(a[0]),T.push(a[1]),w++):(T.unshift(a[0]),T.push(a[w-1])),[]);D.push([1,0,0,0]);for(var P=1;P<i-1;P++)D.push([2*(g=(u=P/i)*(h=u*u))-3*h+1,-2*g+3*h,g-2*h+u,g-h]);D.push([0,1,0,0]);var N,z,W,ue,ge,we,Re=[];for(P=1;P<w;P++)for(N=o*(T[P+1][0]-T[P-1][0]),z=o*(T[P+1][1]-T[P-1][1]),W=o*(T[P+2][0]-T[P][0]),ue=o*(T[P+2][1]-T[P][1]),u=0;u<i;u++)we=(ge=D[u])[0]*T[P][0]+ge[1]*T[P+1][0]+ge[2]*N+ge[3]*W,ge=t2(ge[0]*T[P][1]+ge[1]*T[P+1][1]+ge[2]*z+ge[3]*ue,-85,85),Re.push([we,ge]);return Re},getClosestPointOnGeometry:s2,getConvexHull:function A$(a){var o,i,l=km(a).map(function(P){return[Qs(P[0]),ba(P[1])]}),u=(l.sort(function(P,N){return P[0]===N[0]?P[1]-N[1]:P[0]-N[0]}),[]);try{for(var h=MZ(l),g=h.next();!g.done;g=h.next()){for(var w=g.value;2<=u.length&&_$(u[u.length-2],u[u.length-1],w)<=0;)u.pop();u.push(w)}}catch(P){o={error:P}}finally{try{g&&!g.done&&(i=h.return)&&i.call(h)}finally{if(o)throw o.error}}for(var T=[],D=l.length-1;0<=D;D--){for(;2<=T.length&&_$(T[T.length-2],T[T.length-1],l[D])<=0;)T.pop();T.push(l[D])}return new a2([u.concat(T)])},getDestination:Wv,getDistanceTo:Yc,getEarthRadius:h4,getGeodesicPath:function E$(a,o){(!o||o<=0)&&(o=15),Array.isArray(a)?i=a:a.type&&"LineString"===a.type&&(i=a.coordinates);for(var i,l=i.length-1,u=[],h=0;h<l;h++)u=u.concat(w$(i[h],i[h+1],o));return d4(u)},getGeodesicPaths:function dse(a,o){(!o||o<=0)&&(o=15),Array.isArray(a)?i=a:a.type&&"LineString"===a.type&&(i=a.coordinates);for(var i,l=i.length-1,u=[],h=[],g=0;g<l;g++)for(var w,T,D,P,N,z=w$(i[g],i[g+1],o),W=0;W<z.length;W++)u.push(z[W]),W+1>=z.length||(w=(T=Ji(z[W],2))[0],T=T[1],P=(N=Ji(z[W+1],2))[0],N=N[1],180<Math.abs(P-w)&&(D=0<w?180:-180,P=Math.abs((0<w?P+360:P-360)-w),N=T+(N-T)*(Math.abs(D-w)/P),u.push([D,N]),h.push(u),u=[[-D,N]]));return h.push(u),h},getHeading:by,getLengthOfPath:x$,getPathDenormalizedAtAntimerian:d4,getPathSplitByAntimeridian:b$,getPixelHeading:function C$(i,u){i=Zc(i),u=Zc(u),u=(i=Ji(Ur([i,u],21),2))[0];var l=(i=i[1])[0]-u[0];return u=u[1]-i[1],(2.5*Math.PI-Math.atan2(u,l))*m$%360},getPointWithHeadingAlongPath:D$,getPointsWithHeadingsAlongPath:function P$(a,o){if(o<=0)return[];for(var i=[],l=x$(a,si.meters)/(o-1),u=0;u<o;u++){var h=D$(a,l*u,si.meters);null!=h&&i.push(h)}return i},getPosition:Zc,getPositionAlongPath:NZ,getPositions:km,getPositionsAlongPath:function LZ(a,o){if(o<2)return[];for(var i=[],l=x$(a,si.meters)/(o-1),u=0;u<o;u++){var h=NZ(a,l*u,si.meters);null!=h&&i.push(h)}return i},getRegularPolygonPath:f4,getRegularPolygonPaths:function pse(a,o,i,l,u){return b$(p4(a,o,i,l,u))},getSpeed:function dS(a,o,i,l,u,h){return a=Zc(a),o=Zc(o),a&&o?(i=Yv(i,l,Mo.seconds),vt(Yc(a,o,si.meters)/i,es.metersPerSecond,u,h)):0},getSpeedFromFeatures:function S$(a,o,i,l,u){return"string"!=typeof i||"Feature"!==a.type||"Point"!==a.geometry.type||"Feature"!==o.type||"Point"!==o.geometry.type||(i=pS(a.properties[i],o.properties[i],Mo.seconds),isNaN(i))?NaN:vt(Yc(a.geometry.coordinates,o.geometry.coordinates,si.meters)/i,es.metersPerSecond,l,u)},getTimespan:pS,getTravelDistance:function g4(a,o,i,l,u,h,g,w){return o=Yv(o,u,Mo.seconds),u=(i=vt(i,h,es.metersPerSecond))*o,"number"==typeof l&&(u+=.5*fn(l,g,ao.metersPerSecondSquared)*o*o),mh(u,si.meters,a,w)},interpolate:F1,mercatorPixelsToPositions:r2,mercatorPositionsToPixels:Ur,normalizeLatitude:ba,normalizeLongitude:Qs,parseTimestamp:fS,rotatePositions:T$,simplify:function E4(a,o){return function qZ(a,o,i){return void 0===o&&(o=1),void 0===i&&(i=!1),a.length<=2||(o*=o,a=$Z(a=i?a:function HZ(a,o){for(var i,l=a[0],u=[l],h=1,g=a.length;h<g;h++)w4(i=a[h],l)>o&&(u.push(i),l=i);return l!==i&&u.push(i),u}(a,o),o)),a}(a,o,!0)}}),L$=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),F$=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.zoomDelta=1,i.style=ya.light,i}return L$(o,a),o}(To),l2=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),x4=function(a){function o(i){var l=a.call(this)||this;return l.container=null,l.zoomInButton=null,l.zoomOutButton=null,l.zoomChanged=function(u){return l.updateZoomButtonsState()},l.minZoomChanged=function(u){return l.updateZoomButtonsState()},l.maxZoomChanged=function(u){return l.updateZoomButtonsState()},l.options=(new F$).merge(i),l}return l2(o,a),o.prototype.onAdd=function(i){this.container=this.buildContainer(i,this.options.style,"Zoom Control"),this.container.style.flexDirection="column",this.zoomInButton=this.constructZoomInButton(i),this.zoomOutButton=this.constructZoomOutButton(i);var l=ki("Zoom In"),u=ki("Zoom Out");return this.container.appendChild(this.zoomInButton),this.container.appendChild(l),this.container.appendChild(this.zoomOutButton),this.container.appendChild(u),Vo(l,this.zoomInButton),Vo(u,this.zoomOutButton),i.events.add("zoom",this.zoomChanged),i.events.add("minzoomchanged",this.minZoomChanged),i.events.add("maxzoomchanged",this.maxZoomChanged),this.map=i,this.container},o.prototype.onRemove=function(){a.prototype.onRemove.call(this),this.map&&(this.map.events.remove("zoom",this.zoomChanged),this.map.events.remove("minzoomchanged",this.minZoomChanged),this.map.events.remove("maxzoomchanged",this.maxZoomChanged),this.map=null),this.container&&(this.container.remove(),this.container=null,this.zoomInButton=null,this.zoomOutButton=null)},o.prototype.updateZoomButtonsState=function(){var i=this.map.getCamera().zoom>=this.map._getMap().getMaxZoom(),l=gi.getSouth(this.map.getCamera().bounds)<=-L1&&gi.getNorth(this.map.getCamera().bounds)>=L1;l=this.map.getCamera().zoom<=this.map._getMap().getMinZoom()||l,this.zoomInButton&&this.zoomInButton.disabled!=i&&(this.zoomInButton.disabled=i,this.zoomInButton.setAttribute("aria-label",i?"Zoom In disabled":"Zoom In")),this.zoomOutButton&&this.zoomOutButton.disabled!=l&&(this.zoomOutButton.disabled=l,this.zoomOutButton.setAttribute("aria-label",i?"Zoom Out disabled":"Zoom Out"))},o.prototype.constructZoomInButton=function(i){var l=this,u=document.createElement("button");return u.classList.add("azure-maps-control-button"),u.classList.add("zoom-in"),u.setAttribute("aria-label","Zoom In"),u.setAttribute("alt","Zoom In"),u.setAttribute("type","button"),u.addEventListener("click",function(){var h;i.setCamera({maxBounds:null==(h=i._getMap().getMaxBounds())?void 0:h.toArray().flat(),zoom:i.getCamera().zoom+l.options.zoomDelta,duration:o.ZOOM_DURATION_MS,type:"ease"},!0)}),u},o.prototype.constructZoomOutButton=function(i){var l=this,u=document.createElement("button");return u.classList.add("azure-maps-control-button"),u.classList.add("zoom-out"),u.setAttribute("aria-label","Zoom Out"),u.setAttribute("alt","Zoom Out"),u.setAttribute("type","button"),u.addEventListener("click",function(){var h;i.setCamera({maxBounds:null==(h=i._getMap().getMaxBounds())?void 0:h.toArray().flat(),zoom:i.getCamera().zoom-l.options.zoomDelta,duration:o.ZOOM_DURATION_MS,type:"ease"},!0)}),u},o.ZOOM_DURATION_MS=200,o}(oi),KZ=Object.freeze({__proto__:null,CompassControl:eR,ControlBase:oi,PitchControl:tR,ScaleControl:nR,StyleControl:D1,TrafficControl:XH,TrafficLegendControl:K3,ZoomControl:x4}),V$=Er,ai=Nl(function z$(a,o){return V$(a,5,o="function"==typeof o?o:void 0)}),WZ=function(){function a(o){var i=this;this.attach=function(l){i.map!==l&&(i.map&&i.detachFromCurrentMap(),i.map=l,i.map.indicators._getCollectionDiv().appendChild(i.element),i.map.indicators.add(i))},this.remove=function(){i.detachFromCurrentMap(),i.element.remove()},this.getElement=function(){return i.element},this.detachFromCurrentMap=function(){i.map&&(i.map.indicators.remove(i),delete i.map)},this.element=document.createElement("div"),this.element.setAttribute("tabindex","0"),this.element.setAttribute("role","option"),null!=o&&o.setSize&&this.element.setAttribute("aria-setsize",o.setSize.toString()),null!=o&&o.positionInSet&&this.element.setAttribute("aria-posinset",o.positionInSet.toString()),this.element.setAttribute("aria-label","data point"),this.element.classList.add(a.Css.hidden)}return a.Css={hidden:"hidden-accessible-element"},a}(),YZ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),c2=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.buffer=128,i.maxZoom=18,i.cluster=!1,i.clusterRadius=50,i.clusterMaxZoom=void 0,i.clusterProperties=void 0,i.lineMetrics=!1,i.tolerance=.375,i.clusterMinPoints=2,i.generateId=!1,i.promoteId=void 0,i.filter=void 0,i}return YZ(o,a),o}(To),ZZ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),us=function(a){function o(i){var l=a.call(this)||this;return l.id=i||dm(),l}return ZZ(o,a),o.prototype.getId=function(){return this.id},o.prototype._setMap=function(i,l){var u;void 0===l&&(l=!0),null==i||void 0===i?(u=this.map,delete this.map,l&&(this._invokeEvent("sourceremoved",this),u)&&u.events.invoke("sourceremoved",this)):(this.map=i,l&&(this._invokeEvent("sourceadded",this),this.map.events.invoke("sourceadded",this)))},o}(Pa),QZ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Qv=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},Wl=function(a){function o(i,l){return(i=a.call(this,i)||this).requestId=void 0,i.options=(new c2).merge(Ki(l)),i.shapes=[],i.shapesMap=new Fl,i}return QZ(o,a),o.prototype.add=function(i,l){this._addNoUpdate(i,l),this._updateSource()},o.prototype.clear=function(){this._clearNoUpdate(),this._updateSource()},o.prototype.dispose=function(){this.options=null,this.shapes=null,this.shapesMap=null,this.map=null},o.prototype.getClusterExpansionZoom=function(i){var l=this;return new Promise(function(u,h){var g;l.map?(g=l.map._getMap().getSource(l.getId()))&&"geojson"===g.type&&g.getClusterExpansionZoom(i).then(function(w){"number"==typeof w&&u(w)}).catch(function(w){w&&h(w)}):h("The DataSource hasn't been added to a map.")})},o.prototype.getClusterChildren=function(i){var l=this;return new Promise(function(u,h){var g;l.map?(g=l.map._getMap().getSource(l.getId()))&&"geojson"===g.type&&g.getClusterChildren(i).then(function(w){w&&u(l.map.sources._mapFeaturesToShapes(w,!1,l))}).catch(function(w){w&&h(w)}):h("The DataSource hasn't been added to a map.")})},o.prototype.getClusterLeaves=function(i,l,u){var h=this;return new Promise(function(g,w){var T;h.map?(T=h.map._getMap().getSource(h.getId()))&&"geojson"===T.type&&T.getClusterLeaves(i,l,u).then(function(D){D&&g(h.map.sources._mapFeaturesToShapes(D,!1,h))}).catch(function(D){D&&w(D)}):w("The DataSource hasn't been added to a map.")})},o.prototype.getOptions=function(){return Ki(this.options)},o.prototype.getShapes=function(){return Array.from(this.shapes)},o.prototype.importDataFromUrl=function(i){var l=this;return fetch(i,{method:"GET",mode:"cors"}).then(function(u){if(u.ok)return u.json();throw new Error("HTTP ".concat(u.status,": ").concat(u.statusText))}).then(function(u){l.add(u)})},o.prototype.getShapeById=function(i){return this.shapes[this.shapesMap.get(i)]||null},o.prototype.remove=function(h){var l,u;h=Array.isArray(h)?h:[h];try{for(var g=Qv(h),w=g.next();!w.done;w=g.next()){var T=w.value;"number"==typeof T?this._removeByIndex(T):this._removeById(T)}}catch(D){l={error:D}}finally{try{w&&!w.done&&(u=g.return)&&u.call(g)}finally{if(l)throw l.error}}this._updateSource()},o.prototype.removeById=function(h){var l,u;h=Array.isArray(h)?h:[h];try{for(var g=Qv(h),w=g.next();!w.done;w=g.next())this._removeById(w.value)}catch(D){l={error:D}}finally{try{w&&!w.done&&(u=g.return)&&u.call(g)}finally{if(l)throw l.error}}this._updateSource()},o.prototype.setOptions=function(i){i=(new c2).merge(this.options,Ki(i)),Gl(this.options,i)||(this._invokeEvent("datasourceupdated",this),this.options=i,this.map&&this.map._rebuildStyle())},o.prototype.setShapes=function(i){this._clearNoUpdate(),this.add(i)},o.prototype.toJson=function(){return new Zv(this.shapes.map(function(i){return i.toJson()}))},o.prototype._toJson=function(){return new Zv(this.shapes.map(function(i){return i._toJson()}))},o.prototype._buildSource=function(){var i={type:"geojson",data:this._toJson(),maxzoom:this.options.maxZoom,cluster:this.options.cluster,clusterRadius:this.options.clusterRadius,tolerance:this.options.tolerance,lineMetrics:this.options.lineMetrics,clusterProperties:this.options.clusterProperties,buffer:this.options.buffer,clusterMinPoints:this.options.clusterMinPoints,generateId:this.options.generateId,promoteId:this.options.promoteId,filter:this.options.filter};return"number"==typeof this.options.clusterMaxZoom&&(i.clusterMaxZoom=this.options.clusterMaxZoom),i},o.prototype._isDeepEqual=function(i){var l;return this.constructor===i.constructor&&(l=this._buildSource(),i=i._buildSource(),l.type===i.type)&&l.maxzoom===i.maxzoom&&l.cluster===i.cluster&&l.clusterRadius===i.clusterRadius&&l.tolerance===i.tolerance&&l.lineMetrics===i.lineMetrics&&JSON.stringify(l.clusterProperties)===JSON.stringify(i.clusterProperties)&&l.buffer===i.buffer&&l.clusterMinPoints===i.clusterMinPoints&&l.generateId===i.generateId&&l.promoteId===i.promoteId&&l.filter===i.filter},o.prototype._addNoUpdate=function(i,l){var u;i instanceof ws?(this._addToSources(i,l),u=[i]):Array.isArray(i)?(u=i.map(function(h){return h instanceof ws?h:new ws(h)}),this._addToSources(u,l)):"FeatureCollection"===i.type?(u=i.features.map(function(h){return new ws(h)}),this._addToSources(u,l)):"GeometryCollection"===i.type?(u=i.geometries.map(function(h){return new ws(h)}),this._addToSources(u,l)):(i=new ws(i),this._addToSources(i,l),u=[i]),this._invokeEvent("dataadded",u)},o.prototype._clearNoUpdate=function(){var i=this.shapes;this.shapes=[],this.shapesMap=new Fl,i&&0<i.length&&this._invokeEvent("dataremoved",i)},o.prototype._updateSource=function(){var i=this;void 0===this.requestId&&(this.requestId=requestAnimationFrame(function(){i._updateMboxSource(),i.requestId=void 0}))},o.prototype._addToSources=function(i,l){var u,h,g,w;if(i=Array.isArray(i)?i:[i],"number"!=typeof l)try{for(var T=Qv(i),D=T.next();!D.done;D=T.next()){var P=D.value;this.shapes.push(P),this.shapesMap.set(P.getId(),this.shapes.length-1)}}catch(ue){u={error:ue}}finally{try{D&&!D.done&&(h=T.return)&&h.call(T)}finally{if(u)throw u.error}}else for(var N=i.length-1;0<=N;N--)this.shapes.splice(l,0,i[N]),this._updateShapesMap(l);try{for(var z=Qv(i),W=z.next();!W.done;W=z.next())(P=W.value)._setDataSource(this)}catch(ue){g={error:ue}}finally{try{W&&!W.done&&(w=z.return)&&w.call(z)}finally{if(g)throw g.error}}},o.prototype._removeById=function(l){l=l instanceof ws?l.getId():"string"==typeof l||"number"==typeof l?l:l.id;var u=this.shapes[this.shapesMap.get(l)];u&&(u._setDataSource(null),this.shapes.splice(this.shapesMap.get(l),1),this._updateShapesMap(this.shapesMap.get(l)),this.shapesMap.delete(l),this._invokeEvent("dataremoved",[u]))},o.prototype._removeByIndex=function(i){var l;if(i>=this.shapes.length)throw new Error("The specified remove index '".concat(i,"' ")+"is greater than the maximum possible index '".concat(this.shapes.length-1,"'"));this.shapesMap.delete((l=this.shapes[i]).getId()),l._setDataSource(null),this.shapes.splice(i,1),this._updateShapesMap(i),this._invokeEvent("dataremoved",[l])},o.prototype._updateShapesMap=function(i){for(var l=i;l<this.shapes.length;l++)this.shapesMap.set(this.shapes[l].getId(),l)},o.prototype._updateMboxSource=function(){var i;this.map&&this.map._getMap()&&(i=this.map._getMap().getSource(this.getId()))&&"geojson"===i.type&&i.setData(this._toJson())},o}(us),H$=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),gS=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.bounds=void 0,i.minZoom=0,i.maxZoom=22,i.isTMS=!1,i.tiles=void 0,i.url=void 0,i}return H$(o,a),o}(To),mse=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),$$=function(a){function o(i,l){return(i=a.call(this,i)||this).options=(new gS).merge(Ki(l)),i}return mse(o,a),o.prototype.getOptions=function(){return Ki(this.options)},o.prototype.getShape=function(i,l){return this.map._getMap().querySourceFeatures(this.getId(),{sourceLayer:i,filter:l})},o.prototype._buildSource=function(){var i={type:"vector"};return this.options.bounds&&(i.bounds=this.options.bounds),this.options.tiles?(i.tiles=this.options.tiles,i.minzoom=this.options.minZoom,i.maxzoom=this.options.maxZoom):this.options.url&&(i.url=this.options.url),this.options.isTMS&&(i.scheme="tms"),i},o.prototype._isDeepEqual=function(i){var l,u;return this.constructor===i.constructor&&(l=this._buildSource(),u=i._buildSource(),l.type===u.type)&&l.url===u.url&&(void 0===l.tiles&&void 0===u.tiles||l.tiles&&u.tiles&&l.tiles.length===u.tiles.length&&l.tiles.every(function(h,g){return h===u.tiles[g]}))&&l.minzoom===u.minzoom&&l.maxzoom===u.maxzoom&&l.bounds===u.bounds&&l.attribution===u.attribution&&l.promoteId===u.promoteId&&l.scheme===u.scheme},o}(us),q$=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),T4=function(a){function o(i,l,u){return(i=a.call(this,i)||this).source=l,i}return q$(o,a),o.prototype._isDeepEqual=function(i){var l;return this.constructor===i.constructor&&(l=this.source).type===(i=i.source).type&&l.canvas===i.canvas&&JSON.stringify(l.coordinates)===JSON.stringify(i.coordinates)&&l.animate===i.animate},o.prototype._buildSource=function(){return this.source},o}(us),XZ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),G$=function(a){function o(i,l,u){return(i=a.call(this,i)||this).source=l,i}return XZ(o,a),o.prototype._isDeepEqual=function(i){return this.constructor===i.constructor&&this.source.type===(i=i.source).type},o.prototype._buildSource=function(){return this.source},o}(us),K$=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),u2=function(a){function o(i,l,u){return(i=a.call(this,i)||this).source=l,i}return K$(o,a),o.prototype._isDeepEqual=function(i){var l;return this.constructor===i.constructor&&(l=this.source).type===(i=i.source).type&&JSON.stringify(l.coordinates)===JSON.stringify(i.coordinates)&&l.url===i.url},o.prototype._buildSource=function(){return this.source},o}(us),yS=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),W$=function(a){function o(i,l,u){return(i=a.call(this,i)||this).source=l,i}return yS(o,a),o.prototype._isDeepEqual=function(i){var l;return this.constructor===i.constructor&&(l=this.source).type===(i=i.source).type&&JSON.stringify(l.coordinates)===JSON.stringify(i.coordinates)&&l.urls===i.urls},o.prototype._buildSource=function(){return this.source},o}(us),Y$=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Z$=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.tileSize=512,i}return Y$(o,a),o}(gS),JZ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),eQ=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.encoding=void 0,i}return JZ(o,a),o}(Z$),_S=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Q$=window&&window.__assign||function(){return(Q$=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)},tQ=function(a){function o(i,l){return(i=a.call(this,i)||this).options=(new eQ).merge(Ki(l)),i}return _S(o,a),o.prototype.getOptions=function(){return Ki(this.options)},o.prototype._buildSource=function(){return Q$({type:"raster-dem",bounds:this.options.bounds,minzoom:this.options.minZoom,maxzoom:this.options.maxZoom,tileSize:this.options.tileSize,encoding:this.options.encoding},this.options.tiles?{tiles:this.options.tiles}:{url:this.options.url})},o.prototype._isDeepEqual=function(i){return this.constructor===i.constructor&&(i=i.getOptions(),this.options.url===i.url)&&this.options.tiles===i.tiles&&this.options.bounds===i.bounds&&this.options.minZoom===i.minZoom&&this.options.maxZoom===i.maxZoom&&this.options.tileSize===i.tileSize&&this.options.encoding===i.encoding},o}(us),X$=Object.freeze({__proto__:null,CanvasSource:T4,DataSource:Wl,ElevationTileSource:tQ,ImageSource:u2,Source:us,UnknownSource:G$,VectorTileSource:$$,VideoSource:W$}),nQ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Ps=function(a){function o(i){var l=a.call(this)||this;return l.id=i||dm(),l}return nQ(o,a),o.prototype.getId=function(){return this.id},o.prototype.getMap=function(){return this.map||null},o.prototype.onAdd=function(i){this.map=i,this._invokeEvent("layeradded",this),this.map.events.invoke("layeradded",this)},o.prototype.onRemove=function(){var i=this.map;delete this.map,this._invokeEvent("layerremoved",this),i&&i.events.invoke("layerremoved",this)},o._isMBoxEvent=function(i){return!this.LayerEvents.hasOwnProperty(i)},o.prototype._updateBaseProperties=function(i,l){this._updateFilter(i.filter,l.filter),this._updateZoomRange(i.minZoom,l.minZoom,i.maxZoom,l.maxZoom),this._updateLayoutProperty("visibility",i.visible,l.visible,i.visible?"visible":"none")},o.prototype._updateFilter=function(i,l){Gl(i,l)||this.map._getMap().setFilter(this.id,i)},o.prototype._updatePaintProperty=function(i,l,u,h){Gl(l,u)||this.map._getMap().setPaintProperty(this.id,i,h||l)},o.prototype._updateLayoutProperty=function(i,l,u,h){Gl(l,u)||this.map._getMap().setLayoutProperty(this.id,i,h||l)},o.prototype._updateZoomRange=function(i,l,u,h){i===l&&h===u||this.map._getMap().setLayerZoomRange(this.id,i,u)},o.LayerEvents={layeradded:void 0,layerremoved:void 0,focusin:void 0,focusout:void 0},o}(Pa),rQ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Ey=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.filter=void 0,i.minZoom=0,i.maxZoom=24,i.visible=!0,i}return rQ(o,a),o._cloneCustomizer=function(i){if(i instanceof us)return i},o}(To),iQ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),B1=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.source=void 0,i.sourceLayer=void 0,i.color="#1A73AA",i.blur=0,i.opacity=1,i.strokeColor="#FFFFFF",i.strokeOpacity=1,i.strokeWidth=2,i.pitchAlignment="viewport",i.radius=8,i.createIndicators=!1,i.accessibilityIdKey=void 0,i}return iQ(o,a),o}(Ey),_o=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),oQ=window&&window.__awaiter||function(a,o,i,l){return new(i=i||Promise)(function(u,h){function g(D){try{T(l.next(D))}catch(P){h(P)}}function w(D){try{T(l.throw(D))}catch(P){h(P)}}function T(D){var P;D.done?u(D.value):((P=D.value)instanceof i?P:new i(function(N){N(P)})).then(g,w)}T((l=l.apply(a,o||[])).next())})},h2=window&&window.__generator||function(a,o){var i,l,u,h={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},g={next:w(0),throw:w(1),return:w(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function w(T){return function(D){var P=[T,D];if(i)throw new TypeError("Generator is already executing.");for(;h=g&&P[g=0]?0:h;)try{if(i=1,l&&(u=2&P[0]?l.return:P[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,P[1])).done)return u;switch(l=0,(P=u?[2&P[0],u.value]:P)[0]){case 0:case 1:u=P;break;case 4:return h.label++,{value:P[1],done:!1};case 5:h.label++,l=P[1],P=[0];continue;case 7:P=h.ops.pop(),h.trys.pop();continue;default:if(!(u=0<(u=h.trys).length&&u[u.length-1])&&(6===P[0]||2===P[0])){h=0;continue}if(3===P[0]&&(!u||P[1]>u[0]&&P[1]<u[3]))h.label=P[1];else if(6===P[0]&&h.label<u[1])h.label=u[1],u=P;else{if(!(u&&h.label<u[2])){u[2]&&h.ops.pop(),h.trys.pop();continue}h.label=u[2],h.ops.push(P)}}P=o.call(a,h)}catch(N){P=[6,N],l=0}finally{i=u=0}if(5&P[0])throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}},J$=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},e8=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},C4=function(a){function o(i,l,u){var h=a.call(this,l)||this;return h.accessibleIndicator=[],h._setAccessibleIndicator=function(){return oQ(h,void 0,void 0,function(){var g,w,T,D,P,N,z=this;return h2(this,function(W){return this.accessibleIndicator.forEach(function(ue){return ue.remove()}),this.accessibleIndicator=[],g=this.map.layers.getRenderedShapes(this.map.getCamera().bounds,this),w=this.options.accessibilityIdKey||(this._getDataSource()?ws._shapeIdPropName:void 0),T=function(ue,ge){var we=ue[ge],Re=we instanceof ws?we.toJson():we,et=new WZ({positionInSet:ge+1,setSize:ue.length}),Mt=et.getElement(),St=J$(z.map.positionsToPixels([z.getFirstCoordinate(Re.geometry.coordinates)]),1)[0];return Mt.addEventListener("focusin",function(Qt){z.accessibleIndicator.filter(function(Le){return Le!==et}).forEach(function(Le){return Le.remove()}),0<=ge-1&&D(et,T(ue,ge-1)),ge+1<ue.length&&N(T(ue,ge+1)),2<=ge&&ge==ue.length-1&&P(T(ue,0)),0==ge&&2<=ue.length&&N(T(ue,ue.length-1)),void 0!==w&&z.map._getMap().setPaintProperty(z.id,"circle-stroke-color",["case",["==",["get",w],Re.properties[w]],"#000000",z.options.strokeColor]),z._invokeEvent("focusin",Qt={target:Mt,type:"focusin",map:z.map,shape:we,originalEvent:Qt,pixel:St})}),Mt.addEventListener("focusout",function(Qt){void 0!==w&&z.map._getMap().setPaintProperty(z.id,"circle-stroke-color",["case",["==",["get",w],Re.properties[w]],z.options.strokeColor,z.options.strokeColor]),z._invokeEvent("focusout",Qt={target:Mt,type:"focusout",map:z.map,shape:we,originalEvent:Qt,pixel:St})}),z.accessibleIndicator.push(et),et},D=function(ue,ge){ge.attach(z.map),ge=ge.getElement(),(ue=ue.getElement()).parentElement.insertBefore(ge,ue)},P=function(ge){ge.attach(z.map);var we=(ge=ge.getElement()).parentElement;we.insertBefore(ge,we.firstElementChild)},N=function(ue){ue.attach(z.map)},0<g.length&&N(T(g,0)),1<g.length&&N(T(g,g.length-1)),[2]})})},h.options=(new B1).merge(ai(u,B1._cloneCustomizer)),h.options.source=i||h.options.source,h}return _o(o,a),o.prototype.getOptions=function(){return ai(this.options,B1._cloneCustomizer)},o.prototype.getSource=function(){return this.options.source},o.prototype.setOptions=function(i){if(i=(new B1).merge(this.options,ai(i,B1._cloneCustomizer)),this.map){if(i.source!==this.options.source||i.sourceLayer!==this.options.sourceLayer)return this.options=i,void this.map.layers.add(this);this._updateBaseProperties(i,this.options),this._updatePaintProperty("circle-blur",i.blur,this.options.blur),this._updatePaintProperty("circle-color",i.color,this.options.color),this._updatePaintProperty("circle-opacity",i.opacity,this.options.opacity),this._updatePaintProperty("circle-radius",i.radius,this.options.radius),this._updatePaintProperty("circle-stroke-color",i.strokeColor,this.options.strokeColor),this._updatePaintProperty("circle-stroke-opacity",i.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("circle-stroke-width",i.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("circle-pitch-alignment",i.pitchAlignment,this.options.pitchAlignment)}this.options=i},o.prototype.onAdd=function(i){var l,u,h=this;a.prototype.onAdd.call(this,i),this.options.createIndicators&&(i.events.addOnce("idle",this._setAccessibleIndicator),i.events.add("moveend",this._setAccessibleIndicator),(l=this._getDataSource())?i.events.add("dataadded",l,function(){i.events.addOnce("idle",h._setAccessibleIndicator)}):(u="string"==typeof this.options.source?this.options.source:this.options.source.getId(),i.events.add("sourcedata",function(g){(null==(g=g.source)?void 0:g.getId())===u&&i._getMap().isSourceLoaded(u)&&(g=h._getSourceDataEventCacheKey())!==h.sourceDataEventCacheKey&&(h._setAccessibleIndicator(),h.sourceDataEventCacheKey=g)})))},o.prototype.onRemove=function(){var i;this.options.createIndicators&&(this.map.events.remove("idle",this._setAccessibleIndicator),this.map.events.remove("moveend",this._setAccessibleIndicator),(i=this._getDataSource())?this.map.events.remove("dataadded",i,this._setAccessibleIndicator):this.map.events.remove("sourcedata",this._setAccessibleIndicator)),a.prototype.onRemove.call(this)},o.prototype._getSourceDataEventCacheKey=function(){var i;if(this.map)return i=this.map.getServiceOptions().mapConfiguration,e8(e8([],J$(this.map.getCamera().bounds),!1),[this.map.getCamera().zoom,this.map.getCamera().pitch,this.map.getStyle().style,i instanceof Object?i.id:i],!1).join(",")},o.prototype._getDataSource=function(){var i="string"==typeof this.options.source?this.map.sources.getById(this.options.source):this.options.source;if(i instanceof Wl)return i},o.prototype._buildLayers=function(){var i={id:this.id,type:"circle",source:this.options.source instanceof us?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"circle-color":this.options.color,"circle-blur":this.options.blur,"circle-opacity":this.options.opacity,"circle-stroke-color":this.options.strokeColor,"circle-stroke-opacity":this.options.strokeOpacity,"circle-stroke-width":this.options.strokeWidth,"circle-pitch-alignment":this.options.pitchAlignment,"circle-radius":this.options.radius},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(i.filter=this.options.filter),this.options.sourceLayer&&(i["source-layer"]=this.options.sourceLayer),[i]},o.prototype._getLayerIds=function(){return[this.id]},o.prototype._getSourceIds=function(){var i=new Set;return i.add(this.options.source instanceof us?this.options.source.getId():this.options.source),i},o.prototype.getFirstCoordinate=function(i){return Array.isArray(i[0])?this.getFirstCoordinate(i[0]):i},o}(Ps),sQ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),vS=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.source=void 0,i.sourceLayer=void 0,i.color=["interpolate",["linear"],["heatmap-density"],0,"rgba(0,0, 255,0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],i.intensity=1,i.opacity=1,i.radius=30,i.weight=1,i}return sQ(o,a),o._cloneCustomizer=function(i){if(i instanceof us)return i},o}(Ey),aQ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),lQ=function(a){function o(i,l,u){return(l=a.call(this,l)||this).options=(new vS).merge(ai(u,vS._cloneCustomizer)),l.options.source=i||l.options.source,l}return aQ(o,a),o.prototype.getOptions=function(){return ai(this.options,vS._cloneCustomizer)},o.prototype.getSource=function(){return this.options.source},o.prototype.setOptions=function(i){if(i=(new vS).merge(this.options,ai(i,vS._cloneCustomizer)),this.map){if(i.source!==this.options.source||i.sourceLayer!==this.options.sourceLayer)return this.options=i,void this.map.layers.add(this);this._updateBaseProperties(i,this.options),this._updatePaintProperty("heatmap-color",i.color,this.options.color),this._updatePaintProperty("heatmap-intensity",i.intensity,this.options.intensity),this._updatePaintProperty("heatmap-opacity",i.opacity,this.options.opacity),this._updatePaintProperty("heatmap-radius",i.radius,this.options.radius),this._updatePaintProperty("heatmap-weight",i.weight,this.options.weight)}this.options=i},o.prototype._buildLayers=function(){var i={id:this.id,type:"heatmap",source:this.options.source instanceof us?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"heatmap-color":this.options.color,"heatmap-intensity":this.options.intensity,"heatmap-opacity":this.options.opacity,"heatmap-radius":this.options.radius,"heatmap-weight":this.options.weight},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(i.filter=this.options.filter),this.options.sourceLayer&&(i["source-layer"]=this.options.sourceLayer),[i]},o.prototype._getLayerIds=function(){return[this.id]},o.prototype._getSourceIds=function(){var i=new Set;return i.add(this.options.source instanceof us?this.options.source.getId():this.options.source),i},o}(Ps),t8=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),I4=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.contrast=0,i.fadeDuration=300,i.hueRotation=0,i.maxBrightness=1,i.minBrightness=0,i.opacity=1,i.saturation=0,i}return t8(o,a),o}(Ey),cQ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),d2=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.url=void 0,i.coordinates=void 0,i}return cQ(o,a),o._cloneCustomizer=function(i){if(i instanceof us)return i},o}(I4),n8=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),U1=function(a){function o(){return null!==a&&a.apply(this,arguments)||this}return n8(o,a),o.prototype._getSourceIds=function(){var i=new Set;return i.add(this._getSourceId()),i},o.prototype.onAdd=function(i){a.prototype.onAdd.call(this,i)},o}(Ps),gse=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),p2=function(a){function o(i,l){return(l=a.call(this,l)||this).isLoading=!1,l.options=(new d2).merge(ai(i,d2._cloneCustomizer)),l.img=new Image,l.reloadImage(),l}return gse(o,a),o.prototype.getOptions=function(){return ai(this.options,d2._cloneCustomizer)},o.prototype.setOptions=function(g){var l,u=(new d2).merge(this.options,ai(g,d2._cloneCustomizer)),h="string"==typeof g.url&&g.url!==this.getOptions().url;g=void 0!==g.coordinates&&g.coordinates!==this.getOptions().coordinates,this.map&&(this._updateBaseProperties(u,this.options),this._updatePaintProperty("raster-contrast",u.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",u.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",u.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",u.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",u.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",u.saturation,this.options.saturation),l=this.map._getMap().getSource(this._getSourceId()))&&l.updateImage(u),this.options=u,h?this.reloadImage():g&&this.updateTransform()},o.prototype.getPositions=function(i){return this.transform.then(function(l){return l.toTarget(i)})},o.prototype.getPixels=function(i){return this.transform.then(function(l){return l.toSource(i)})},o.getCoordinatesFromRefPoints=function(i,l,u,h){return new mS(u,h).toTarget([[0,0],[i,0],[i,l],[0,l]])},o.getCoordinatesFromEdges=function(i,l,u,h,g){return"number"!=typeof g&&(g=0),l=[Math.min(h,u),l,Math.max(h,u),i],h=gi.getCenter(l),T$([gi.getNorthWest(l),gi.getNorthEast(l),gi.getSouthEast(l),gi.getSouthWest(l)],h,g)},o.prototype._buildLayers=function(){var i={id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-opacity":this.options.opacity,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-min":this.options.minBrightness,"raster-brightness-max":this.options.maxBrightness,"raster-saturation":this.options.saturation,"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(i.filter=this.options.filter),[i]},o.prototype._getLayerIds=function(){return[this.id]},o.prototype._buildSource=function(){return{type:"image",url:this.options.url,coordinates:this.options.coordinates}},o.prototype._getSourceId=function(){return"".concat(this.getId(),"-ImageSource")},o.prototype.reloadImage=function(){var i=this;this.options.url&&(this.transform=new Promise(function(l,u){i.img.onload=function(){l(new mS([[0,0],[i.img.width,0],[i.img.width,i.img.height],[0,i.img.height]],i.options.coordinates)),i.isLoading=!1},i.img.onerror=i.img.onabort=function(){u("Failed to load image")},i.isLoading=!0,i.img.src=i.options.url}))},o.prototype.updateTransform=function(){this.isLoading||(this.transform=Promise.resolve(new mS([[0,0],[this.img.width,0],[this.img.width,this.img.height],[0,this.img.height]],this.options.coordinates)))},o.prototype._getSourceWrapper=function(){var i=this._getSourceId(),l=this._buildSource();return new u2(i,l)},o}(U1),uQ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),wS=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.source=void 0,i.sourceLayer=void 0,i.lineCap="round",i.lineJoin="round",i.blur=0,i.strokeColor="#1E90FF",i.strokeDashArray=void 0,i.strokeGradient=void 0,i.offset=0,i.strokeOpacity=1,i.translate=new _l(0,0),i.translateAnchor="map",i.strokeWidth=2,i}return uQ(o,a),o}(Ey),S4=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),xy=window&&window.__assign||function(){return(xy=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)},Xh=function(a){function o(i,l,u){return(l=a.call(this,l)||this).options=(new wS).merge(ai(u,wS._cloneCustomizer)),l.options.source=i||l.options.source,l}return S4(o,a),o.prototype.getOptions=function(){return ai(this.options,wS._cloneCustomizer)},o.prototype.getSource=function(){return this.options.source},o.prototype.setOptions=function(i){if(i=(new wS).merge(this.options,ai(i,wS._cloneCustomizer)),this.map){if(i.source!==this.options.source||i.sourceLayer!==this.options.sourceLayer)return this.options=i,void this.map.layers.add(this);this._updateBaseProperties(i,this.options),this._updatePaintProperty("line-blur",i.blur,this.options.blur),this._updateLayoutProperty("line-cap",i.lineCap,this.options.lineCap),this._updateLayoutProperty("line-join",i.lineJoin,this.options.lineJoin),this._updatePaintProperty("line-offset",i.offset,this.options.offset),this._updatePaintProperty("line-color",i.strokeColor,this.options.strokeColor),this._updatePaintProperty("line-dasharray",i.strokeDashArray,this.options.strokeDashArray),this._updatePaintProperty("line-gradient",i.strokeGradient,this.options.strokeGradient),this._updatePaintProperty("line-opacity",i.strokeOpacity,this.options.strokeOpacity),this._updatePaintProperty("line-width",i.strokeWidth,this.options.strokeWidth),this._updatePaintProperty("line-translate",i.translate,this.options.translate),this._updatePaintProperty("line-translate-anchor",i.translateAnchor,this.options.translateAnchor)}this.options=i},o.prototype._buildLayers=function(){return[xy(xy(xy(xy({id:this.id,type:"line"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof us?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none","line-cap":this.options.lineCap,"line-join":this.options.lineJoin},paint:xy(xy(xy({"line-blur":this.options.blur,"line-color":this.options.strokeColor},this.options.strokeDashArray?{"line-dasharray":this.options.strokeDashArray}:{}),this.options.strokeGradient?{"line-gradient":this.options.strokeGradient}:{}),{"line-offset":this.options.offset,"line-opacity":this.options.strokeOpacity,"line-translate":this.options.translate,"line-translate-anchor":this.options.translateAnchor,"line-width":this.options.strokeWidth})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},o.prototype._getLayerIds=function(){return[this.id]},o.prototype._getSourceIds=function(){var i=new Set;return i.add(this.options.source instanceof us?this.options.source.getId():this.options.source),i},o}(Ps),bS=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),ka=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.source=void 0,i.sourceLayer=void 0,i.base=0,i.fillColor="#1E90FF",i.height=0,i.fillOpacity=1,i.fillPattern=void 0,i.translate=new _l(0,0),i.translateAnchor="map",i.verticalGradient=!0,i}return bS(o,a),o}(Ey),Xv=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),_f=window&&window.__assign||function(){return(_f=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)},Jh=function(a){function o(i,l,u){return(l=a.call(this,l)||this).options=(new ka).merge(ai(u,ka._cloneCustomizer)),l.options.source=i||l.options.source,l}return Xv(o,a),o.prototype.getOptions=function(){return ai(this.options,ka._cloneCustomizer)},o.prototype.getSource=function(){return this.options.source},o.prototype.setOptions=function(i){if(i=(new ka).merge(this.options,ai(i,ka._cloneCustomizer)),this.map){if(i.source!==this.options.source||i.sourceLayer!==this.options.sourceLayer)return this.options=i,void this.map.layers.add(this);this._updateBaseProperties(i,this.options),this._updatePaintProperty("fill-extrusion-base",i.base,this.options.base),this._updatePaintProperty("fill-extrusion-color",i.fillColor,this.options.fillColor),this._updatePaintProperty("fill-extrusion-height",i.height,this.options.height),this._updatePaintProperty("fill-extrusion-opacity",i.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-extrusion-pattern",i.fillPattern,this.options.fillPattern),this._updatePaintProperty("fill-extrusion-translate",i.translate,this.options.translate),this._updatePaintProperty("fill-extrusion-translate-anchor",i.translateAnchor,this.options.translateAnchor),this._updatePaintProperty("fill-extrusion-vertical-gradient",i.verticalGradient,this.options.verticalGradient)}this.options=i},o.prototype._buildLayers=function(){return[_f(_f(_f(_f({id:this.id,type:"fill-extrusion"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof us?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:_f(_f({"fill-extrusion-base":this.options.base,"fill-extrusion-height":this.options.height,"fill-extrusion-opacity":this.options.fillOpacity},this.options.fillPattern?{"fill-extrusion-pattern":this.options.fillPattern}:{"fill-extrusion-color":this.options.fillColor}),{"fill-extrusion-translate":this.options.translate,"fill-extrusion-translate-anchor":this.options.translateAnchor,"fill-extrusion-vertical-gradient":this.options.verticalGradient})}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},o.prototype._getLayerIds=function(){return[this.id]},o.prototype._getSourceIds=function(){var i=new Set;return i.add(this.options.source instanceof us?this.options.source.getId():this.options.source),i},o}(Ps),ca=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),vf=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.source=void 0,i.sourceLayer=void 0,i.fillColor="#1E90FF",i.fillOpacity=.5,i.fillPattern=void 0,i.fillAntialias=!0,i}return ca(o,a),o}(Ey),z1=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Ty=function(a){function o(i,l,u){return(l=a.call(this,l)||this).options=(new vf).merge(ai(u,vf._cloneCustomizer)),l.options.source=i||l.options.source,l}return z1(o,a),o.prototype.getOptions=function(){return ai(this.options,vf._cloneCustomizer)},o.prototype.getSource=function(){return this.options.source},o.prototype.setOptions=function(i){if(i=(new vf).merge(this.options,ai(i,vf._cloneCustomizer)),this.map){if(i.source!==this.options.source||i.sourceLayer!==this.options.sourceLayer)return this.options=i,void this.map.layers.add(this);this._updateBaseProperties(i,this.options),this._updatePaintProperty("fill-color",i.fillColor,this.options.fillColor),this._updatePaintProperty("fill-opacity",i.fillOpacity,this.options.fillOpacity),this._updatePaintProperty("fill-pattern",i.fillPattern,this.options.fillPattern),this._updatePaintProperty("fill-antialias",i.fillAntialias,this.options.fillAntialias)}this.options=i},o.prototype._buildLayers=function(){var i={id:this.id,type:"fill",source:this.options.source instanceof us?this.options.source.getId():this.options.source,layout:{visibility:this.options.visible?"visible":"none"},paint:{"fill-opacity":this.options.fillOpacity,"fill-antialias":this.options.fillAntialias},minzoom:this.options.minZoom,maxzoom:this.options.maxZoom};return this.options.filter&&(i.filter=this.options.filter),this.options.sourceLayer&&(i["source-layer"]=this.options.sourceLayer),this.options.fillPattern?i.paint["fill-pattern"]=this.options.fillPattern:i.paint["fill-color"]=this.options.fillColor,[i]},o.prototype._getLayerIds=function(){return[this.id]},o.prototype._getSourceIds=function(){var i=new Set;return i.add(this.options.source instanceof us?this.options.source.getId():this.options.source),i},o}(Ps),j1=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),H1=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.allowOverlap=!1,i.anchor="bottom",i.ignorePlacement=!1,i.image="marker-blue",i.offset=new _l(0,0),i.optional=!1,i.padding=2,i.pitchAlignment="auto",i.rotation=0,i.rotationAlignment="auto",i.size=1,i.opacity=1,i}return j1(o,a),o}(To),$1=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),q1=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.allowOverlap=!1,i.anchor="center",i.textField=void 0,i.font=["StandardFont-Regular"],i.ignorePlacement=!1,i.justify="center",i.offset=new _l(0,0),i.optional=!1,i.padding=2,i.pitchAlignment="auto",i.radialOffset=void 0,i.rotation=0,i.rotationAlignment="auto",i.variableAnchor=void 0,i.size=16,i.color="#000000",i.haloBlur=0,i.haloColor="rgba(0,0,0,0)",i.haloWidth=0,i.opacity=1,i}return $1(o,a),o}(To),G1=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),wf=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.source=void 0,i.sourceLayer=void 0,i.iconOptions=new H1,i.textOptions=new q1,i.placement="point",i.sortKey=void 0,i.zOrder="auto",i.lineSpacing=250,i}return G1(o,a),o}(Ey),r8=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Cy=window&&window.__assign||function(){return(Cy=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)},ES=function(a){function o(i,l,u){return(l=a.call(this,l)||this).options=(new wf).merge(ai(u,wf._cloneCustomizer)),l.options.source=i||l.options.source,l}return r8(o,a),o.prototype.getOptions=function(){return ai(this.options,wf._cloneCustomizer)},o.prototype.getSource=function(){return this.options.source},o.prototype.setOptions=function(i){if(i=(new wf).merge(this.options,ai(i,wf._cloneCustomizer)),this.map){if(i.source!==this.options.source||i.sourceLayer!==this.options.sourceLayer)return this.options=i,void this.map.layers.add(this);var l=this.options,u=i.iconOptions,h=l.iconOptions,g=i.textOptions,w=l.textOptions;this._updateBaseProperties(i,l),this._updateLayoutProperty("symbol-spacing",i.lineSpacing,l.lineSpacing),this._updateLayoutProperty("symbol-placement",i.placement,l.placement),this._updateLayoutProperty("symbol-sort-key",i.sortKey,l.sortKey),this._updateLayoutProperty("symbol-z-order",i.zOrder,l.zOrder),this._updateLayoutProperty("icon-allow-overlap",u.allowOverlap,h.allowOverlap),this._updateLayoutProperty("icon-anchor",u.anchor,h.anchor),this._updateLayoutProperty("icon-ignore-placement",u.ignorePlacement,h.ignorePlacement),this._updateLayoutProperty("icon-image",u.image,h.image),this._updateLayoutProperty("icon-offset",u.offset,h.offset),this._updatePaintProperty("icon-opacity",u.opacity,h.opacity),this._updateLayoutProperty("icon-optional",u.optional,h.optional),this._updateLayoutProperty("icon-padding",u.padding,h.padding),this._updateLayoutProperty("icon-pitch-alignment",u.pitchAlignment,h.pitchAlignment),this._updateLayoutProperty("icon-rotate",u.rotation,h.rotation),this._updateLayoutProperty("icon-rotation-alignment",u.rotationAlignment,h.rotationAlignment),this._updateLayoutProperty("icon-size",u.size,h.size),this._updateLayoutProperty("text-allow-overlap",g.allowOverlap,w.allowOverlap),this._updateLayoutProperty("text-anchor",g.anchor,w.anchor),this._updatePaintProperty("text-color",g.color,w.color),this._updateLayoutProperty("text-font",g.font,w.font),this._updateLayoutProperty("text-ignore-placement",g.ignorePlacement,w.ignorePlacement),this._updateLayoutProperty("text-justify",g.justify,w.justify),this._updatePaintProperty("text-halo-blur",g.haloBlur,w.haloBlur),this._updatePaintProperty("text-halo-color",g.haloColor,w.haloColor),this._updatePaintProperty("text-halo-width",g.haloWidth,w.haloWidth),this._updateLayoutProperty("text-offset",g.offset,w.offset),this._updatePaintProperty("text-opacity",g.opacity,w.opacity),this._updateLayoutProperty("text-optional",g.optional,w.optional),this._updateLayoutProperty("text-padding",g.padding,w.padding),this._updateLayoutProperty("text-pitch-alignment",g.pitchAlignment,w.pitchAlignment),this._updateLayoutProperty("text-radial-offset",g.radialOffset,w.radialOffset),this._updateLayoutProperty("text-rotate",g.rotation,w.rotation),this._updateLayoutProperty("text-rotation-alignment",g.rotationAlignment,w.rotationAlignment),this._updateLayoutProperty("text-size",g.size,w.size),this._updateLayoutProperty("text-variable-anchor",g.variableAnchor,w.variableAnchor),this._updateLayoutProperty("text-field",g.textField,w.textField)}this.options=i},o.prototype._buildLayers=function(){var i=Cy(Cy(Cy(Cy({id:this.id,type:"symbol"},this.options.sourceLayer&&{"source-layer":this.options.sourceLayer}),{source:this.options.source instanceof us?this.options.source.getId():this.options.source,layout:Cy(Cy({visibility:this.options.visible?"visible":"none","symbol-placement":this.options.placement,"symbol-spacing":this.options.lineSpacing,"symbol-z-order":this.options.zOrder,"text-allow-overlap":this.options.textOptions.allowOverlap,"text-anchor":this.options.textOptions.anchor},this.options.textOptions.textField&&{"text-field":this.options.textOptions.textField}),{"text-font":this.options.textOptions.font,"text-ignore-placement":this.options.textOptions.ignorePlacement,"text-justify":this.options.textOptions.justify,"text-offset":this.options.textOptions.offset,"text-optional":this.options.textOptions.optional,"text-padding":this.options.textOptions.padding,"text-pitch-alignment":this.options.textOptions.pitchAlignment,"text-rotate":this.options.textOptions.rotation,"text-rotation-alignment":this.options.textOptions.rotationAlignment,"text-size":this.options.textOptions.size,"icon-allow-overlap":this.options.iconOptions.allowOverlap,"icon-anchor":this.options.iconOptions.anchor,"icon-ignore-placement":this.options.iconOptions.ignorePlacement,"icon-image":this.options.iconOptions.image,"icon-offset":this.options.iconOptions.offset,"icon-optional":this.options.iconOptions.optional,"icon-padding":this.options.iconOptions.padding,"icon-pitch-alignment":this.options.iconOptions.pitchAlignment,"icon-rotate":this.options.iconOptions.rotation,"icon-rotation-alignment":this.options.iconOptions.rotationAlignment,"icon-size":this.options.iconOptions.size}),paint:{"text-color":this.options.textOptions.color,"text-halo-blur":this.options.textOptions.haloBlur,"text-halo-color":this.options.textOptions.haloColor,"text-halo-width":this.options.textOptions.haloWidth,"text-opacity":this.options.textOptions.opacity,"icon-opacity":this.options.iconOptions.opacity}}),this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom});return void 0!==this.options.sortKey&&(i.layout["symbol-sort-key"]=this.options.sortKey),void 0!==this.options.textOptions.radialOffset&&(i.layout["text-radial-offset"]=this.options.textOptions.radialOffset),void 0!==this.options.textOptions.variableAnchor&&(i.layout["text-variable-anchor"]=this.options.textOptions.variableAnchor),[i]},o.prototype._getLayerIds=function(){return[this.id]},o.prototype._getSourceIds=function(){var i=new Set;return i.add(this.options.source instanceof us?this.options.source.getId():this.options.source),i},o}(Ps),i8=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),K1=window&&window.__assign||function(){return(K1=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)},A4=function(a){function o(i,l,u){return(i=a.call(this,i)||this).source=i._modifySource(l,u),i}return i8(o,a),o.prototype._buildSource=function(){return this.source},o.prototype._isDeepEqual=function(i){var l,u,h,g;return this.constructor===i.constructor&&(i=(g=this.source).type===(l=i.source).type&&g.url===l.url&&(void 0===g.tiles&&void 0===l.tiles||g.tiles&&l.tiles&&g.tiles.length===l.tiles.length&&g.tiles.every(function(w,T){return w===l.tiles[T]}))&&g.minzoom===l.minzoom&&g.maxzoom===l.maxzoom&&g.bounds===l.bounds&&g.attribution===l.attribution,u="raster"!==g.type||"raster"===g.type&&g.type===l.type&&g.tileSize===l.tileSize&&g.scheme===l.scheme,h="raster-dem"!==g.type||"raster-dem"===g.type&&g.type===l.type&&g.tileSize===l.tileSize&&g.encoding===l.encoding,g="vector"!==g.type||"vector"===g.type&&g.type===l.type&&g.promoteId===l.promoteId&&g.scheme===l.scheme,i)&&u&&h&&g},o.prototype._modifySource=function(i,l){if("raster"!==i.type&&"raster-dem"!==i.type&&"vector"!==i.type||!i.tiles){if("raster"!==i.type&&"raster-dem"!==i.type&&"vector"!==i.type||!i.url)throw new Error("Source definition must define a TileJSON 'url' or a 'tiles' array.");i.url="string"==typeof i.url?i.url:new vu({domain:"{{azMapsDomain}}",path:i.url.path,queryParams:K1(K1({},l),i.url.queryParams)}).toString()}else{var u=i.tiles.map(function(h){return"string"==typeof h?h:new vu({domain:"{{azMapsDomain}}",path:h.path,queryParams:K1(K1({},l),h.queryParams)}).toString()});i.tiles=u}return i},o}(us),o8=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),W1=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.bounds=[-180,-85.0511,180,85.0511],i.minSourceZoom=0,i.maxSourceZoom=22,i.tileSize=512,i.isTMS=!1,i.subdomains=void 0,i.tileUrl=void 0,i}return o8(o,a),o}(I4),s8=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Y1=window&&window.__assign||function(){return(Y1=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)},hQ=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},D4=function(a){function o(i,l){return l=a.call(this,l)||this,i&&l.setOptions(i),l}return s8(o,a),o.prototype.getOptions=function(){return ai(this.options,W1._cloneCustomizer)},o.prototype.setOptions=function(i){if(i=(new W1).merge(this.options,ai(i,W1._cloneCustomizer)),this.map){if(!Gl(i.bounds,this.options.bounds)||i.isTMS!==this.options.isTMS||i.maxSourceZoom!==this.options.maxSourceZoom||i.minSourceZoom!==this.options.minSourceZoom||!Gl(i.subdomains,this.options.subdomains)||i.tileSize!==this.options.tileSize||i.tileUrl!==this.options.tileUrl)return this.options=i,void this.map.layers.add(this);this._updateBaseProperties(i,this.options),this._updatePaintProperty("raster-contrast",i.contrast,this.options.contrast),this._updatePaintProperty("raster-fade-duration",i.fadeDuration,this.options.fadeDuration),this._updatePaintProperty("raster-hue-rotate",i.hueRotation,this.options.hueRotation),this._updatePaintProperty("raster-brightness-max",i.maxBrightness,this.options.maxBrightness),this._updatePaintProperty("raster-opacity",i.opacity,this.options.opacity),this._updatePaintProperty("raster-saturation",i.saturation,this.options.saturation)}this.options=i},o.prototype._setOptionsNoUpdate=function(i){this.options=(new W1).merge(this.options,ai(i,W1._cloneCustomizer))},o.prototype._buildLayers=function(){return[Y1(Y1({id:this.id,type:"raster",source:this._getSourceId(),layout:{visibility:this.options.visible?"visible":"none"},paint:{"raster-contrast":this.options.contrast,"raster-fade-duration":this.options.fadeDuration,"raster-hue-rotate":this.options.hueRotation,"raster-brightness-max":this.options.maxBrightness,"raster-brightness-min":this.options.minBrightness,"raster-opacity":this.options.opacity,"raster-saturation":this.options.saturation}},this.options.filter&&{filter:this.options.filter}),{minzoom:this.options.minZoom,maxzoom:this.options.maxZoom})]},o.prototype._getLayerIds=function(){return[this.id]},o.prototype._buildSource=function(){var i,l;if(this.options.tileUrl){if(-1===this.options.tileUrl.indexOf("{"))return{type:"raster",url:this.options.tileUrl};if(-1!==this.options.tileUrl.indexOf("{subdomain}")){if(!(this.options.subdomains&&0<this.options.subdomains.length))throw new Error("The {subdomain} placeholder was included in the tileUrl but no subdomains were specified");var u=[];try{for(var h=hQ(this.options.subdomains),g=h.next();!g.done;g=h.next())u.push(this.options.tileUrl.replace(/{subdomain}/g,g.value))}catch(T){i={error:T}}finally{try{g&&!g.done&&(l=h.return)&&l.call(h)}finally{if(i)throw i.error}}l=u}else l=[this.options.tileUrl]}return Y1({type:"raster",bounds:this.options.bounds,maxzoom:this.options.maxSourceZoom,minzoom:this.options.minSourceZoom,scheme:this.options.isTMS?"tms":"xyz",tileSize:this.options.tileSize},l&&{tiles:l})},o.prototype._getSourceId=function(){return"".concat(this.getId(),"-RasterSource")},o.prototype._getSourceWrapper=function(){var i=this._getSourceId(),l=this._buildSource();return new A4(i,{name:i,tiles:l.tiles,type:l.type,url:l.url})},o}(U1),yse=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),xS=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.renderer=void 0,i}return yse(o,a),o}(Ey),dQ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),pQ=function(a){function o(i,l){var u=a.call(this,i)||this;return u._onStyleChange=function(){var h,g;u.map._getMap().getLayer(u.id)||(h=u.map,g=null==(g=u.map.layers._getUserLayers().find(function(w){return w.layer.getId()==u.id}))?void 0:g.before,h.layers.remove(u),h.layers.add(u,g))},u.options=(new xS).merge(ai(l,xS._cloneCustomizer)),u.source=new Wl,u}return dQ(o,a),o.prototype.getOptions=function(){return ai(this.options,xS._cloneCustomizer)},o.prototype.setOptions=function(i){i=(new xS).merge(this.options,ai(i,xS._cloneCustomizer)),this.map&&this.map.triggerRepaint(),this.options=i},o.prototype.onAdd=function(i){var l,u;a.prototype.onAdd.call(this,i),this.map.events.add("stylechanged",this._onStyleChange),this.options.renderer&&this.glContext&&null!=(u=(l=this.options.renderer).onAdd)&&u.call(l,i,this.glContext)},o.prototype.onRemove=function(){var i,l;this.options.renderer&&this.glContext&&null!=(l=(i=this.options.renderer).onRemove)&&l.call(i,this.map,this.glContext),this.map.events.remove("stylechanged",this._onStyleChange),this.glContext=null,a.prototype.onRemove.call(this)},o.prototype._buildLayers=function(){var i=this;if(this.options.renderer)return[{id:this.id,type:"custom",renderingMode:this.options.renderer.renderingMode,onAdd:function(l,u){i.glContext=u},onRemove:function(l,u){},prerender:function(l,u){var h,g;i._shouldRender()&&null!=(g=(h=i.options.renderer).prerender)&&g.call(h,l,u)},render:function(l,u){i._shouldRender()&&i.options.renderer.render(l,u)}}];throw new Error("Cannot build the WebGL layer because renderer was not set.")},o.prototype._getLayerIds=function(){return[this.id]},o.prototype._getSourceIds=function(){return(new Set).add(this.source.getId())},o.prototype._shouldRender=function(){var i;return!!this.map&&(i=this.map.getCamera().zoom,this.options.visible)&&this.options.minZoom<=i&&this.options.maxZoom>i},o}(Ps),a8=Object.freeze({__proto__:null,BubbleLayer:C4,HeatMapLayer:lQ,ImageLayer:p2,Layer:Ps,LineLayer:Xh,PolygonExtrusionLayer:Jh,PolygonLayer:Ty,SymbolLayer:ES,TileLayer:D4,WebGLLayer:pQ}),P4=function(){function a(){}return a.convertHtmlString=function(o){var i;return"string"==typeof o?((i=document.createElement("div")).innerHTML=o,i):o},a.parseWithFilter=function(o,i,l,u){var h=this;if(void 0===i&&(i=function(T){return!0}),void 0===l&&(l=function(T){return T}),void 0===u&&(u=function(){return document.createElement("div")}),"string"==typeof o){if(0==(w=(new DOMParser).parseFromString(o,"text/html").body).children.length)return l(w.innerHTML);var g,w=1==w.children.length&&1==w.childNodes.length?w.children[0]:(g=u(),Array.from(w.childNodes).map(function(T){return g.append(T)}),g)}else w=o;return Array.from(w.children).forEach(function(T){return h.parseWithFilter(T,i,l)}),i(w)?l(w):(w.parentNode&&w.parentNode.removeChild(w),null)},a}(),fQ=Yh,mQ=nS,Z1=Nl(function gQ(a){return fQ(a)&&1===a.nodeType&&!mQ(a)}),R4=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Iy=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.anchor="none",i.draggable=!1,i.closeButton=!0,i.content=document.createElement("span"),i.fillColor="#FFFFFF",i.pixelOffset=new _l(0,0),i.position=new Kl(0,0),i.showPointer=!0,i}return R4(o,a),o._cloneCustomizer=function(i){if(Z1(i))return i},o}(To),c8=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Sy=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},Q1=function(a){function o(i){var l=a.call(this)||this;return l.attach=function(u){l.map!==u&&(l.map&&l.remove(),l.map=u,l.marker=l._createMarker(l.options),l.marker.addTo(l.map._getMap()),l.map.popups._getCollectionDiv().appendChild(l.containerDiv),l.map.popups.add(l))},l.open=function(u){if(!u&&!l.map)throw new Error("Must specify a map to open on or attach to a map in advance");l.attach(u||l.map),l.containerDiv.classList.remove(o.Css.hidden),l.map.events.add("move",l._onMove),l._onMove(),l._invokeEvent("open",{target:l,type:"open"})},l.close=function(){l.map&&l.map.events.remove("move",l._onMove),l.containerDiv.classList.add(o.Css.hidden),l._invokeEvent("close",{target:l,type:"close"})},l.remove=function(){l.map&&(l.marker.remove(),l.containerDiv.classList.remove(l.autoAnchor||l.options.anchor),l.map.events.remove("move",l._onMove),l.map.popups.remove(l),delete l.map,delete l.marker,delete l.autoAnchor)},l.isOpen=function(){return l.map&&!l.containerDiv.classList.contains(o.Css.hidden)},l._onMove=function(){var u=l._getAutoAnchor(l.map,l.options);u!==l.autoAnchor&&(l._replaceMarker(l.map,l.options,u),l.map.events.add("move",l._onMove))},l._onDown=function(u){l.map.popups._addDraggedPopup(l);var h=Sy(l.map.positionsToPixels([l.options.position]),1)[0];"mousedown"===u.type?l.dragOffset=[h[0]-u.clientX,h[1]-u.clientY]:"touchstart"===u.type&&(l.dragOffset=[h[0]-u.touches[0].clientX,h[1]-u.touches[0].clientY])},l._onDragStart=function(u){u.preventDefault()},l.options=(new Iy).merge(ai(i,Iy._cloneCustomizer)),l.containerDiv=l._createContainerDiv(l.options),l.contentDiv=l._createContentDiv(l.options),l.containerDiv.appendChild(l.contentDiv),l.options.showPointer&&(l.arrowDiv=l._createArrowDiv(),l.containerDiv.appendChild(l.arrowDiv)),l.options.closeButton&&(l.closeBtn=l._createCloseButton(),l.contentDiv.appendChild(l.closeBtn),i=ki("close"),l.contentDiv.appendChild(i),Vo(i,l.closeBtn,!0)),l}return c8(o,a),o.prototype.setPopupOptions=function(i){this.setOptions(i)},o.prototype.setOptions=function(u){var l;(u=(new Iy).merge(this.options,ai(u,Iy._cloneCustomizer))).content!==this.options.content?(this.htmlContent.remove(),this.htmlContent=this._createHtmlContent(u),this.contentDiv.prepend(this.htmlContent)):u.draggable!==this.options.draggable&&this._setDraggable(this.htmlContent,u.draggable),u.closeButton&&!this.closeBtn?(this.closeBtn=this._createCloseButton(),this.contentDiv.appendChild(this.closeBtn),l=ki("close"),this.contentDiv.appendChild(l),Vo(l,this.closeBtn,!0)):!u.closeButton&&this.closeBtn&&(this.contentDiv.removeChild(this.closeBtn),delete this.closeBtn),u.showPointer&&!this.arrowDiv?(this.arrowDiv=this._createArrowDiv(),this.containerDiv.appendChild(this.arrowDiv)):!u.showPointer&&this.arrowDiv&&(this.containerDiv.removeChild(this.arrowDiv),delete this.arrowDiv),u.fillColor!==this.options.fillColor&&(this.containerDiv.style.borderColor=u.fillColor,this.contentDiv.style.backgroundColor=u.fillColor),this.marker&&(u.anchor!==this.options.anchor?"none"===this.options.anchor?(this.autoAnchor!==u.anchor&&this._replaceMarker(this.map,u),this.map.events.remove("move",this._onMove),delete this.autoAnchor):(this._replaceMarker(this.map,u),"none"===u.anchor&&this.map.events.add("move",this._onMove)):(Gl(u.position,this.options.position)||this.marker.setLngLat(u.position),Gl(u.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(u.pixelOffset))),this.options=u},o.prototype.getPopupOptions=function(){return this.getOptions()},o.prototype.getOptions=function(){return ai(this.options,Iy._cloneCustomizer)},o.prototype.getPopupContainer=function(){return this.containerDiv},o.prototype._dragToPixel=function(i){this.dragging||(this.dragging=!0,this.contentDiv.style.pointerEvents="none",this._invokeEvent("dragstart",{type:"dragstart",target:this})),i=Sy(this.map.pixelsToPositions([i=[i[0]+this.dragOffset[0],i[1]+this.dragOffset[1]]]),1)[0],this.options.position=i,this.marker.setLngLat(this.options.position),this._invokeEvent("drag",{type:"drag",target:this})},o.prototype._onUp=function(){this.dragging&&(this.contentDiv.style.pointerEvents="",this._invokeEvent("dragend",{type:"dragend",target:this}),"none"===this.options.anchor)&&this._onMove(),delete this.dragOffset,delete this.dragging},o.prototype._createContainerDiv=function(i){var l=this,u=document.createElement("div"),h=(u.classList.add(o.Css.container),u.classList.add(o.Css.hidden),u.style.borderColor=i.fillColor,u.setAttribute("role","dialog"),u.setAttribute("aria-label","Map Information Window"),!1);return u.addEventListener("keydown",function(g){"Tab"!==g.key&&"Escape"!==g.key&&"Esc"!==g.key||(h=!0)}),u.addEventListener("keyup",function(g){"Tab"!==g.key&&"Escape"!==g.key&&"Esc"!==g.key||(h=!1)}),u.addEventListener("focusin",function(g){l.map&&!l.isOpen()&&(l.open(l.map),g.target instanceof HTMLElement)&&g.target.focus()}),u.addEventListener("focusout",function(g){h&&g.relatedTarget instanceof Node&&!u.contains(g.relatedTarget)&&(h=!1,l.isOpen())&&l.close()}),u},o.prototype._createContentDiv=function(i){var l=document.createElement("div");return l.classList.add(o.Css.content),l.style.backgroundColor=i.fillColor,l.setAttribute("tabindex","0"),this.htmlContent=this._createHtmlContent(i),l.appendChild(this.htmlContent),l},o.prototype._createArrowDiv=function(){var i=document.createElement("div");return i.classList.add(o.Css.arrow),i},o.prototype._createCloseButton=function(){var i=document.createElement("button");return i.addEventListener("click",this.close),i.classList.add(o.Css.close),i.setAttribute("aria-label","close"),i.setAttribute("tabindex","0"),i.innerHTML="&times;",i},o.prototype._createHtmlContent=function(i){var l=P4.convertHtmlString(i.content);return i.draggable&&this._setDraggable(l,i.draggable),l},o.prototype._createMarker=function(i,h){var u=this.marker?this.marker.getLngLat():i.position;return("none"===i.anchor?(this.autoAnchor=h||"bottom",this.containerDiv.classList.add(this.autoAnchor),new Ka.Marker({anchor:this.autoAnchor,element:this.containerDiv,offset:i.pixelOffset})):(this.containerDiv.classList.add(i.anchor),new Ka.Marker({anchor:i.anchor,element:this.containerDiv,offset:i.pixelOffset}))).setLngLat(u)},o.prototype._getAutoAnchor=function(i,l){var u,h,g=this.containerDiv.offsetWidth,w=this.containerDiv.offsetHeight,T=[];return(h=this.marker?(u=(h=i._getMap().project(this.marker.getLngLat())).x,h.y):(h=Sy(i.positionsToPixels([l.position]),1),u=(l=Sy(h[0],2))[0],l[1]))<w?T.push("top"):h>i.getCanvas().offsetHeight-w&&T.push("bottom"),u<g/2?T.push("left"):u>i.getCanvas().offsetWidth-g/2&&T.push("right"),0<T.length?T.join("-"):"bottom"},o.prototype._replaceMarker=function(i,l,u){var h=this.containerDiv.nextElementSibling;this.marker.remove(),this.containerDiv.classList.remove(this.autoAnchor||this.options.anchor),this.marker=this._createMarker(l,u),this.marker.addTo(i._getMap()),i.popups._getCollectionDiv().insertBefore(this.containerDiv,h||null)},o.prototype._setDraggable=function(i,l){l?(i.addEventListener("mousedown",this._onDown),i.addEventListener("touchstart",this._onDown),i.addEventListener("dragstart",this._onDragStart)):(i.removeEventListener("mousedown",this._onDown),i.removeEventListener("touchstart",this._onDown),i.removeEventListener("dragstart",this._onDragStart))},o.Css={arrow:"popup-arrow",close:"popup-close",container:"popup-container",content:"popup-content-container",hidden:"hidden-accessible-element"},o}(Pa),yQ=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Om=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.anchor="bottom",i.color="#1A73AA",i.draggable=!1,i.htmlContent='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24.5 36.5" id="marker_'.concat(dm(),'" width="24.5" height="36.5" display="block"><path d="M12.25.25a12.2543,12.2543,0,0,0-12,12.4937c0,6.4436,6.4879,12.1093,11.059,22.5641.5493,1.2563,1.3327,1.2563,1.882,0C17.7621,24.8529,24.25,19.1857,24.25,12.7437A12.2543,12.2543,0,0,0,12.25.25Z"   fill="{color}" stroke="{secondaryColor}" stroke-width="0.5"/><text style="font-family: Arial, Helvetica, sans-serif; font-size: 14px; fill: white;" text-anchor="middle" x="12" y="18">{text}</text></svg>'),i.pixelOffset=new _l(0,0),i.position=new Kl(0,0),i.popup=void 0,i.secondaryColor="white",i.text=void 0,i.visible=!0,i}return yQ(o,a),o._cloneCustomizer=function(i){if(i instanceof Q1||Z1(i))return i},o}(To),_Q=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),f2=function(a){function o(i){var l=a.call(this)||this;return l._onDrag=function(){var u=l.marker.getLngLat().wrap();l.options.position=new Kl(u.lng,u.lat),l._invokeEvent("drag",{type:"drag",target:l})},l._onDragStart=function(){l._invokeEvent("dragstart",{type:"dragstart",target:l})},l._onDragEnd=function(){l._invokeEvent("dragend",{type:"dragend",target:l})},l._bubbleElementEvent=function(u){l._invokeEvent(u.type,{type:u.type,target:l})},l._onEleDragStart=function(u){u.preventDefault()},l.options=(new Om).merge(ai(i,Om._cloneCustomizer)),l._buildMarker(l.options),l}return _Q(o,a),o.prototype.getOptions=function(){return ai(this.options,Om._cloneCustomizer)},o.prototype.getElement=function(){return this.marker.getElement()},o.prototype.setOptions=function(i){i=(new Om).merge(this.options,ai(i,Om._cloneCustomizer)),Gl(i.htmlContent,this.options.htmlContent)&&i.anchor===this.options.anchor?("string"!=typeof i.htmlContent||i.color===this.options.color&&i.text===this.options.text&&i.secondaryColor===this.options.secondaryColor||(this.element.innerHTML=this._getSubbedHtmlString(i)||""),i.draggable!==this.options.draggable&&(this._setDraggable(i.draggable),this.marker.setDraggable(i.draggable)),Gl(i.pixelOffset,this.options.pixelOffset)||this.marker.setOffset(i.pixelOffset),Gl(i.position,this.options.position)||this.marker.setLngLat(i.position),i.visible!==this.options.visible&&(i.visible?this.element.classList.remove(o.hiddenClass):this.element.classList.add(o.hiddenClass))):(this.marker.remove(),this._buildMarker(i),this.map&&(this.marker.addTo(this.map._getMap()),this._getCollectionContainer().appendChild(this.element))),this.options=i},o.prototype.togglePopup=function(){if(this.options.popup)if(this.options.popup.isOpen())this.options.popup.close();else{if(!this.map)throw new Error("The marker must be added to a map before calling togglePopup().");this.options.popup.setOptions({position:this.options.position}),this.options.popup.open(this.map)}},o.prototype._addToMap=function(i,l){this.map&&this.map!==i&&this._removeFromMap(),l&&(this.options.position=Ki(l),this.marker.setLngLat(this.options.position)),this.map!==i&&(this.map=i,this.marker.addTo(i._getMap()),this._getCollectionContainer().appendChild(this.element))},o.prototype._removeFromMap=function(){this.map&&(this.marker.remove(),delete this.map)},o.prototype._getId=function(){if(this.element)return("string"==typeof this.options.htmlContent?this.element.firstChild:this.element).id},o.prototype._buildMarker=function(i){var l;"string"==typeof i.htmlContent?(l=this._getSubbedHtmlString(i)||"",this.element=P4.convertHtmlString(l)):this.element=i.htmlContent,this.element.classList.add(o.containerClass),i.draggable&&this._setDraggable(!0),i.visible||this.element.classList.add(o.hiddenClass),this.marker=new Ka.Marker({element:this.element,offset:i.pixelOffset,draggable:i.draggable,anchor:i.anchor}).setLngLat(i.position),this.marker.on("drag",this._onDrag),this.marker.on("dragstart",this._onDragStart),this.marker.on("dragend",this._onDragEnd),this.element.addEventListener("click",this._bubbleElementEvent),this.element.addEventListener("dblclick",this._bubbleElementEvent),this.element.addEventListener("contextmenu",this._bubbleElementEvent),this.element.addEventListener("keydown",this._bubbleElementEvent),this.element.addEventListener("keypress",this._bubbleElementEvent),this.element.addEventListener("keyup",this._bubbleElementEvent),this.element.addEventListener("mousedown",this._bubbleElementEvent),this.element.addEventListener("mouseenter",this._bubbleElementEvent),this.element.addEventListener("mouseleave",this._bubbleElementEvent),this.element.addEventListener("mousemove",this._bubbleElementEvent),this.element.addEventListener("mouseout",this._bubbleElementEvent),this.element.addEventListener("mouseover",this._bubbleElementEvent),this.element.addEventListener("mouseup",this._bubbleElementEvent)},o.prototype._getSubbedHtmlString=function(i){return"string"==typeof i.htmlContent?i.htmlContent.replace(/{color}/gi,i.color||"").replace(/{secondaryColor}/gi,i.secondaryColor||"").replace(/{text}/gi,i.text||""):null},o.prototype._getCollectionContainer=function(){var i=this.map.getCanvasContainer().querySelector(".".concat(o.collectionContainerClass));return i||((i=document.createElement("div")).classList.add(o.collectionContainerClass),this.map.getCanvasContainer().appendChild(i)),i},o.prototype._setDraggable=function(i){i?this.element.addEventListener("dragstart",this._onEleDragStart):this.element.removeEventListener("dragstart",this._onEleDragStart)},o.collectionContainerClass="marker-collection-container",o.hiddenClass="hidden-accessible-element",o.containerClass="marker-container",o}(Pa),vQ=function(){function a(){}return a.getHighContrastMode=function(){return matchMedia("(-ms-high-contrast: white-on-black)").matches?"dark":matchMedia("(-ms-high-contrast: black-on-white)").matches?"light":matchMedia("(-ms-high-contrast: active)").matches?"dark":matchMedia("(inverted-colors: inverted)").matches?"invert":null},a}();function Nm(a,o){return a||o}function wc(a,o){return a[o]}var X1,Yl=void 0,Du=null,M4="",m2="function",Jv="object",Lm="prototype",g2="__proto__",e0="undefined",y2="constructor",mr="Symbol",u8="_polyfill",t0="length",_2="name",Zl="call",v2="toString",Ql=Nm(Object),un=wc(Ql,Lm),w2=Nm(String),n0=wc(w2,Lm),Gn=Nm(Math),_r=Nm(Array),Rs=wc(_r,Lm),bf=wc(Rs,"slice");function wl(a,o){try{return{v:a.apply(this,o)}}catch(i){return{e:i}}}function b2(a){return function(o){return typeof o===a}}function bc(a){var o="[object "+a+"]";return function(i){return!(!i||function Qc(a){return un[v2].call(a)}(i)!==o)}}function bs(a){return typeof a===e0||a===e0}function tn(a){return a===Du||bs(a)}function h8(a){return!!a||a!==Yl}var xr=b2("string"),$r=b2(m2);function Ar(a){return!(!a&&tn(a)||!a||typeof a!==Jv)}var Di=wc(_r,"isArray"),EQ=bc("Date"),J1=b2("number"),k4=b2("boolean"),E2=bc("Error");function or(a){return!!(a&&a.then&&$r(a.then))}function x2(a){return!(!a||function wQ(a,o){return(a=wl(a)).e?o:a.v}(function(){return!(a&&0+a)},!a))}var qd=wc(Ql,"getOwnPropertyDescriptor");function Oa(a,o){return!!a&&un.hasOwnProperty[Zl](a,o)}var Fm=Nm(wc(Ql,"hasOwn"),function O4(a,o){return Oa(a,o)||!!qd(a,o)});function Pi(a,o,i){if(a&&Ar(a))for(var l in a)if(Fm(a,l)&&-1===o[Zl](i||a,l,a[l]))break}var TS={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"},Ef=wc(Ql,"defineProperty");function eo(a,o,i){return Ef(a,o,function d8(a){var o,i={};return i[TS.c]=!0,i[TS.e]=!0,a.l&&(i.get=function(){return a.l.v},o=qd(a.l,"v"))&&o.set&&(i.set=function(l){a.l.v=l}),Pi(a,function(l,u){i[TS[l]]=bs(u)?i[TS[l]]:u}),i}(i))}function N4(a,o,i,l,u){var h={};return Pi(a,function(g,w){CS(h,g,o?w:g,u),CS(h,w,i?w:g,u)}),l?l(h):h}function CS(a,o,i,l){Ef(a,o,{value:i,enumerable:!0,writable:!!l})}var Xc=Nm(w2),T2="[object Error]";function Mn(a,o){var i=M4,l=un[v2][Zl](a);l===T2&&(a={stack:Xc(a.stack),message:Xc(a.message),name:Xc(a.name)});try{i=(i=JSON.stringify(a,Du,o?"number"==typeof o?o:4:Yl))&&i.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: ")||Xc(a)}catch(u){i=" - "+Mn(u,o)}return l+": "+i}function yh(a){throw new Error(a)}function Gd(a){throw new TypeError(a)}var C2=wc(Ql,"freeze"),F4=wc(Ql,"assign"),Kd=wc(Ql,"keys");function IS(a){return C2&&Pi(a,function(o,i){(Di(i)||Ar(i))&&IS(i)}),Ay(a)}var I2,Ay=Nm(C2,function r0(a){return a}),V4=Nm(wc(Ql,"getPrototypeOf"),function L4(a){return a[g2]||Du}),f8=function p8(a){return N4(a,0,0,Ay)}({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12}),m8="__tsUtils$gblCfg";function B4(){var a;return(a=(a=(a=typeof globalThis!==e0?globalThis:a)||typeof self===e0?a:self)||typeof window===e0?a:window)||typeof global===e0?a:global}function g8(){var a;return I2||(a=wl(B4).v||{},I2=a[m8]=a[m8]||{}),I2}function Wd(a,o,i){var l=o&&o[a];return function(u){var h,g=u&&u[a]||l;if(g||i)return h=arguments,(g||i).apply(u,g?bf[Zl](h,1):h);Gd('"'+Xc(a)+'" not defined for '+Mn(u))}}var IQ=wc(Gn,"max"),y8=Wd("slice",n0),Yd=Wd("substring",n0),Dy=Wd("substr",n0,function _8(a,o,i){return tn(a)&&Gd("Invalid "+Mn(a)),i<0?M4:((o=o||0)<0&&(o=IQ(o+a[t0],0)),bs(i)?y8(a,o):y8(a,o,o+i))});function v8(a,o){return Yd(a,0,o)}var tE,Xl,jo,w8="_urid";function ed(a){var o={description:Xc(a),toString:function(){return mr+"("+a+")"}};return o[u8]=!0,o}function Zd(a){var o,i,l=function SQ(){var a;return tE||(a=g8(),tE=a.gblSym=a.gblSym||{k:{},s:{}}),tE}();return Fm(l.k,a)||(o=ed(a),i=Kd(l.s).length,o[w8]=function(){return i+"_"+o[v2]()},l.k[a]=o,l.s[o[w8]()]=Xc(a)),l.k[a]}function Vm(){jo=g8()}function td(a){return Ef({toJSON:function(){return a}},"v",{value:a})}var SS,E8="window";function nE(a,o){var i;return function(){return jo||Vm(),(i=i&&!jo.lzy?i:td(wl(a,o).v)).v}}function Pu(a){return jo||Vm(),(SS=SS&&!1!==a&&!jo.lzy?SS:td(wl(B4).v||Du)).v}function hs(a,o){return(o=SS&&!1!==o?SS.v:Pu(o))&&o[a]?o[a]:a===E8?Ru():Du}function x8(){return!!Jl()}var Jl=nE(hs,["document"]);function S2(){return!!Ru()}var AS,U4,Ho,Ru=nE(hs,[E8]),Xd=nE(hs,["navigator"]),z4=nE(hs,["history"]),AQ=nE(function(){return!!wl(function(){return process&&(process.versions||{}).node}).v}),C8=nE(function(){return!!wl(function(){return self&&self instanceof WorkerGlobalScope}).v});function Xs(){return AS=td(wl(hs,[mr]).v)}function rE(a){var o=(jo.lzy?0:AS)||Xs();return o.v?o.v[a]:Yl}function D2(a,o){var i=f8[a],l=(jo||Vm(),(jo.lzy?0:AS)||Xs());return l.v?l.v[i||a]:o?Yl:function Qd(i){return Xl=Xl||{},(i=f8[i])?Xl[i]=Xl[i]||ed(mr+"."+i):undefined}(a)}function iE(a,o){jo||Vm();var i=(jo.lzy?0:AS)||Xs();return i.v?i.v(a):o?Du:ed(a)}function P2(a){return jo||Vm(),((U4=(jo.lzy?0:U4)||td(wl(rE,["for"]).v)).v||Zd)(a)}function R2(a){return!!a&&$r(a.next)}function j4(a){return!function bQ(a){return a===Du||!h8(a)}(a)&&$r(a[D2(3)])}function M2(a,o,i){if(a&&(R2(a)||(a=a[(Ho=Ho||td(D2(3))).v]?a[Ho.v]():null),R2(a))){var l=Yl,u=Yl;try{for(var h=0;!(u=a.next()).done&&-1!==o[Zl](i||a,u.value,h,a);)h++}catch(g){l={e:g},a.throw&&(u=Du,a.throw(l))}finally{try{u&&!u.done&&a.return&&a.return(u)}finally{if(l)throw l.e}}}}function o0(a,o,i){return a.apply(o,i)}function oE(a,o){return!bs(o)&&a&&(Di(o)?o0(a.push,a,o):R2(o)||j4(o)?M2(o,function(i){a.push(i)}):a.push(o)),a}function Hn(a,o,i){if(a)for(var l=a[t0]>>>0,u=0;u<l&&(!(u in a)||-1!==o[Zl](i||a,a[u],u,a));u++);}var Ec=Wd("indexOf",Rs),DS=Wd("map",Rs);function k2(a,o,i){return(a&&a.slice||bf).apply(a,bf[Zl](arguments,1))}var A8,D8,DQ=Wd("reduce",Rs),Py=Nm(wc(Ql,"create"),function PQ(a){var o;return a?((o=typeof a)!==Jv&&o!==m2&&Gd("Prototype must be an Object or function: "+Mn(a)),i[Lm]=a,new i):{};function i(){}});function P8(a,o){return(Ql.setPrototypeOf||function(i,l){var u;(A8=A8||td(((u={})[g2]=[],u instanceof Array))).v?i[g2]=l:Pi(l,function(h,g){return i[h]=g})})(a,o)}function R8(a,o){o&&(a[_2]=o)}function M8(a,o,i){var l=i||Error,u=l[Lm][_2],h=Error.captureStackTrace;return function RQ(a,o,i){function l(){this[y2]=o,wl(eo,[this,_2,{v:a,c:!0,e:!1}])}return wl(eo,[o,_2,{v:a,c:!0,e:!1}]),(o=P8(o,i))[Lm]=i===Du?Py(i):(l[Lm]=i[Lm],new l),o}(a,function(){var g=arguments;try{wl(R8,[l,a]);var w,T=o0(l,this,bf[Zl](g))||this;return T!==this&&(w=V4(this))!==V4(T)&&P8(T,w),h&&h(T,this[y2]),o&&o(T,g),T}finally{wl(R8,[l,u])}},l)}function xf(){return(Date.now||kQ)()}function kQ(){return(new Date).getTime()}var O2,N2,H4,O8=function k8(a){return function(o){return tn(o)&&Gd("strTrim called ["+Mn(o)+"]"),o&&o.replace?o.replace(a,M4):o}}(/^\s+|(?=\s)\s+$/g),Ea=Wd("trim",n0,O8);function xc(a){if(!a||typeof a!==Jv)return!1;var o=!1;if(a!==(H4=H4||!S2()||Ru())){N2||(N2=(O2=Function[Lm][v2])[Zl](Ql));try{var i=V4(a);o=(o=!i)||(i=Oa(i,y2)?i[y2]:i)&&typeof i===m2&&O2[Zl](i)===N2}catch{}}return o}function N8(a){return a.value&&LQ(a),!0}var $4=[function sE(a){var o,i=a.value;return!!Di(i)&&((o=a.result=[]).length=i.length,a.copyTo(o,i),!0)},LQ,function Jc(a){return a.type===m2},function _se(a){var o=a.value;return!!EQ(o)&&(a.result=new Date(o.getTime()),!0)}];function L2(a,o,i,h){var u=i.handler,g=(h=i.path?h?i.path.concat(h):i.path:[],{handler:i.handler,src:i.src,path:h}),w=typeof o,T=!1,D=!1,P=(o&&w===Jv?T=xc(o):D=o===Du||function $d(a){return X1=X1||["string","number","boolean",e0,"symbol","bigint"],a!==Jv&&-1!==X1.indexOf(a)}(w),{type:w,isPrim:D,isPlain:T,value:o,result:o,path:h,origin:i.src,copy:function(N,z){return L2(a,N,z?g:i,z)},copyTo:function(N,z){return Ry(a,N,z,g)}});return P.isPrim?u&&u[Zl](i,P)?P.result:o:function L8(a,o,i,l){var u;return Hn(a,function(h){if(h.k===o)return u=h,-1}),u||(a.push(u={k:o,v:o}),l(u)),u.v}(a,o,0,function(N){eo(P,"result",{g:function(){return N.v},s:function(ue){N.v=ue}});for(var z=0,W=u;!(W||(z<$4.length?$4[z++]:N8))[Zl](i,P);)W=Du})}function Ry(a,o,i,l){if(!tn(i))for(var u in i)o[u]=L2(a,i[u],l,u);return o}function LQ(a){var o,i=a.value;return!(!i||!a.isPlain||(o=a.result={},a.copyTo(o,i),0))}function q4(a,o){return Hn(o,function(i){!function OQ(a,o,i){Ry([],a,o,{handler:i,src:o,path:[]})}(a,i)}),a}function G4(a,o,i,l,u,h,g){return q4(function NQ(a,o){return L2([],a,{handler:o,src:a})}(a)||{},bf[Zl](arguments))}var ts,FQ=function eE(a){return function(o){return o[a]}}(t0);function Bm(){return jo||Vm(),(ts=ts&&!jo.lzy?ts:td(wl(hs,["performance"]).v)).v}var F8=Wd("split",n0);function s0(a,o,i){var l;a&&o&&(l=(o=F8(o,".")).pop(),Hn(o,function(u){tn(a[u])&&(a[u]={}),a=a[u]}),a[l]=i)}var V8=Wd("endsWith",n0,function F2(a,o,i){return xr(a)||Gd("'"+Mn(a)+"' is not a string"),o=xr(o)?o:Xc(o),i=!bs(i)&&i<a[t0]?i:a[t0],Yd(a,i-o[t0],i)===o}),ec=Wd("indexOf",n0),Tc="ref",B8="unref",V2="hasRef",U8="enabled";function K4(a,o,i){var l=Di(o),u=l?o.length:0,h=(0<u?o[0]:l?Yl:o)||setTimeout,g=(1<u?o[1]:Yl)||clearTimeout,w=i[0],T=(i[0]=function(){T.dn(),o0(w,Yl,bf[Zl](arguments))},function VQ(a,o,i){var l,u=!0,h=a?o(Du):Du;function g(){return u=!1,h&&h[B8]&&h[B8](),l}function w(){h&&i(h),h=Du}function T(){return h=o(h),u||g(),l}return(l={cancel:w,refresh:T})[V2]=function(){return h&&h[V2]?h[V2]():u},l[Tc]=function(){return u=!0,h&&h[Tc]&&h[Tc](),l},l[B8]=g,{h:l=Ef(l,U8,{get:function(){return!!h},set:function(D){!D&&h&&w(),D&&!h&&T()}}),dn:function(){h=Du}}}(a,function(D){if(D){if(D.refresh)return D.refresh(),D;o0(g,Yl,[D])}return o0(h,Yl,i)},function(D){o0(g,Yl,[D])}));return T.h}function _h(a,o){return K4(!0,Yl,bf[Zl](arguments))}var B2,rB,j8=function xQ(a){return N4(a,1,0,Ay)},My=j8({NONE:0,PENDING:3,INACTIVE:1,ACTIVE:2}),Tf="toLowerCase",U2="blkVal",qr="length",z2="rdOnly",a0="notify",PS="warnToConsole",aE="throwInternal",l0="setDf",c0="watch",Ms="logger",Jd="apply",Io="push",lE="splice",H8="hdlr",u0="cancel",cE="initialize",Um="identifier",j2="removeNotificationListener",RS="addNotificationListener",Cf="isInitialized",$8="instrumentationKey",q8="INACTIVE",H2="value",W4="getNotifyMgr",$2="getPlugin",If="name",ky="iKey",uE="time",eu="processNext",Y4="getProcessTelContext",hE="pollInternalLogs",dE="enabled",G8="stopPollingInternalLogs",Oy="unload",q2="onComplete",Z4="version",K8="loggingLevelConsole",Ny="createNew",zm="teardown",G2="messageId",ep="message",pE="isAsync",jm="diagLog",K2="_doTeardown",fE="update",Sf="getNext",mE="setNextPlugin",W8="protocol",MS="userAgent",gE="split",W2="nodeType",Ly="replace",Y8="logInternalMessage",Hm="type",Q4="handler",h0="status",Z8="getResponseHeader",X4="getAllResponseHeaders",J4="isChildEvt",yE="data",_E="getCtx",Af="setCtx",eB="complete",Q8="itemsReceived",kS="urlString",X8="sendPOST",Y2="headers",d0="timeout",J8="setRequestHeader",tB="traceId",Z2="spanId",nB="traceFlags",eq="function",Q2="object",OS="undefined",tp="prototype",NS=Object,zQ=NS[tp],tq=(Pu(),Pu(),"hasOwnProperty"),tu=F4||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])zQ[tq].call(o,u)&&(a[u]=o[u]);return a},ns=function(a,o){return(ns=NS.setPrototypeOf||({__proto__:[]}instanceof Array?function(i,l){i.__proto__=l}:function(i,l){for(var u in l)l[tq](u)&&(i[u]=l[u])}))(a,o)};function nu(a,o){function i(){this.constructor=a}typeof o!==eq&&null!==o&&Gd("Class extends value "+String(o)+" is not a constructor or null"),ns(a,o),a[tp]=null===o?Py(o):(i[tp]=o[tp],new i)}function oB(a,o){for(var i=0,l=o.length,u=a.length;i<l;i++,u++)a[u]=o[i];return a}var X2="constructor",Fy="prototype",vE="function",wE="_dynInstFuncs",sB="_isDynProxy",p0="_dynClass",lB="_dynInstChk",bE=lB,J2="_dfOpts",cB="_unknown_",ek="__proto__",LS="_dyn"+ek,uB="__dynProto$Gbl",hB="_dynInstProto",tk="useBaseInst",dB="setInstFuncs",pB=Object,EE=pB.getPrototypeOf,jQ=pB.getOwnPropertyNames,fB=Pu(),mB=fB[uB]||(fB[uB]={o:((rB={})[dB]=!0,rB[tk]=!0,rB),n:1e3});function nk(a){return a&&(a===pB[Fy]||a===Array[Fy])}function nq(a){return nk(a)||a===Function[Fy]}function f0(a){if(a){if(EE)return EE(a);var o=a[ek]||a[Fy]||(a[X2]?a[X2][Fy]:null),i=a[LS]||o;Oa(a,LS)||(delete a[hB],i=a[LS]=a[hB]||a[LS],a[hB]=o)}return i}function rk(a,o){var i=[];if(jQ)i=jQ(a);else for(var l in a)"string"==typeof l&&Oa(a,l)&&i.push(l);if(i&&0<i.length)for(var u=0;u<i.length;u++)o(i[u])}function ik(a,o,i){return o!==X2&&typeof a[o]===vE&&(i||Oa(a,o))&&o!==ek&&o!==Fy}function vh(a){Gd("DynamicProto: "+a)}function sk(a,o){for(var i=a.length-1;0<=i;i--)if(a[i]===o)return!0;return!1}function ak(a,o){return Oa(a,Fy)?a.name||o||cB:((a||{})[X2]||{}).name||o||cB}function ko(g,o,D,l){Oa(g,Fy)||vh("theClass is an invalid class definition.");var u=g[Fy],h=(function GQ(a,o){if(EE){for(var i=[],l=f0(o);l&&!nq(l)&&!sk(i,l);){if(l===a)return!0;i.push(l),l=f0(l)}return!1}return!0}(u,o)||vh("["+ak(g)+"] not in hierarchy of ["+ak(o)+"]"),null),w=!!(Oa(u,p0)?h=u[p0]:(h="_dynCls$"+ak(g,"_")+"$"+mB.n,mB.n++,u[p0]=h),g=ko[J2])[tk],T=(w&&l&&void 0!==l[tk]&&(w=!!l[tk]),function ok(a){var o=Py(null);return rk(a,function(i){!o[i]&&ik(a,i,!1)&&(o[i]=a[i])}),o}(o));D(o,function rq(a,o,i,l){function u(T,D,P){var N,z=D[P];return z[sB]&&l&&!1!==(N=T[wE]||{})[bE]&&(z=(N[D[p0]]||{})[P]||z),function(){return z.apply(T,arguments)}}for(var h=Py(null),g=(rk(i,function(T){h[T]=u(o,i,T)}),f0(a)),w=[];g&&!nq(g)&&!sk(w,g);)rk(g,function(T){!h[T]&&ik(g,T,!EE)&&(h[T]=u(o,g,T))}),w.push(g),g=f0(g);return h}(u,o,T,w)),function qQ(a,o,i,l,u){var h,g;nk(a)||nk(h=i[wE]=i[wE]||Py(null))||(g=h[o]=h[o]||Py(null),!1!==h[bE]&&(h[bE]=!!u),nk(g))||rk(i,function(w){function T(){return(function HQ(a,o,i,l){var u=null;if(a&&Oa(i,p0)){var h=a[wE]||Py(null);if((u=(h[i[p0]]||Py(null))[o])||vh("Missing ["+o+"] "+vE),!u[lB]&&!1!==h[bE]){for(var g=!Oa(a,o),w=f0(a),T=[];g&&w&&!nq(w)&&!sk(T,w);){var D=w[o];if(D){g=D===l;break}T.push(w),w=f0(w)}try{g&&(a[o]=u),u[lB]=1}catch{h[bE]=!1}}}return u}(this,P,D,T)||function $Q(a,o,i){var l=o[a];return typeof(l=l===i?f0(o)[a]:l)!==vE&&vh("["+a+"] is not a "+vE),l}(P,D,T)).apply(this,arguments)}var D,P;ik(i,w,!1)&&i[w]!==l[w]&&(g[w]=i[w],delete i[w],Oa(a,w)&&(!a[w]||a[w][sB])||(a[w]=(D=a,P=w,T[sB]=1,T)))})}(u,h,o,T,!1!==(D=(D=!!EE&&!!g[dB])&&l?!!l[dB]:D))}ko[J2]=mB.o;var FS="Promise",lk="rejected";function Df(a,o){return gB(a,function(i){return o?o({status:"fulfilled",rejected:!1,value:i}):i},function(i){return o?o({status:lk,rejected:!0,reason:i}):i})}function gB(a,o,i,l){var u=a;try{if(or(a))(o||i)&&(u=a.then(o,i));else try{o&&(u=o(a))}catch(h){if(!i)throw h;u=i(h)}}finally{l&&function iq(a,o){var i=a;o&&(or(a)?i=a.finally?a.finally(o):a.then(function(l){return o(),l},function(l){throw o(),l}):o())}(u,l)}return u}var ck,oq=["pending","resolving","resolved",lk],KQ="dispatchEvent";function wse(a){var o;return!!(o=a&&a.createEvent?a.createEvent("Event"):o)&&o.initEvent}var yB,aq,lq,cq,xE="unhandledRejection",WQ=xE.toLowerCase(),_B=10;function uq(a){return $r(a)?a.toString():Mn(a)}function bse(a,o,i){var l,u,h=k2(arguments,3),g=0,w=!1,T=[],D=!1,P=null;function N(Re,et){return D=!0,P&&P.cancel(),P=null,a(function(Mt,St){T.push(function(){try{var Qt=2===g?Re:et,Le=bs(Qt)?l:$r(Qt)?Qt(l):Qt;or(Le)?Le.then(Mt,St):(Qt||3!==g?Mt:St)(Le)}catch(Je){St(Je)}}),w&&W()},h)}function z(){return oq[g]}function W(){var Re;0<T.length&&(Re=T.slice(),T=[],D=!0,P&&P.cancel(),P=null,o(Re))}function ue(Re,et){return function(Mt){g===et&&(2===Re&&or(Mt)?(g=1,Mt.then(ue(2,1),ue(3,1))):(g=Re,w=!0,l=Mt,W(),D||3!==Re||(P=P||_h(ge,_B))))}}function ge(){var Re;D||(D=!0,AQ()?process.emit(xE,l,u):(Re=Ru()||Pu(),yB=yB||td(wl(hs,[FS+"RejectionEvent"]).v),function sq(a,o,i,l){var u=Jl();u=(ck=ck||td(!!wl(wse,[u]).v)).v?u.createEvent("Event"):l?new Event(o):{},i&&i(u),ck.v&&u.initEvent(o,!1,!0),u&&a[KQ]?a[KQ](u):(l=a["on"+o])?l(u):(i=hs("console"))&&(i.error||i.log)(o,Mn(u))}(Re,WQ,function(et){return eo(et,"promise",{g:function(){return u}}),et.reason=l,et},!!yB.v)))}Ef(u={then:N,catch:function(Re){return N(void 0,Re)},finally:function(Re){var et=Re,Mt=Re;return $r(Re)&&(et=function(St){return Re&&Re(),St},Mt=function(St){throw Re&&Re(),St}),N(et,Mt)}},"state",{get:z}),function I8(){return!!function S8(){return jo||Vm(),((jo.lzy?0:AS)||Xs()).v}()}()&&(u[D2(11)]="IPromise"),u.toString=function(){return"IPromise "+z()+(w?" - "+uq(l):"")},$r(i)||Gd(FS+": executor is not a function - "+uq(i));var we=ue(3,0);try{i.call(u,ue(2,0),we)}catch(Re){we(Re)}return u}function VS(a,o){return bse(VS,function ZQ(a){var o=J1(a)?a:0;return function(i){_h(function(){!function nd(a){Hn(a,function(o){try{o()}catch{}})}(i)},o)}}(o),a,o)}function QQ(a,o){var i=(aq=aq||td(wl(hs,[FS]).v||null)).v;if(!i)return VS(a);$r(a)||Gd(FS+": executor is not a function - "+Mn(a));var l=0;return i=new i(function(u,h){a(function(g){l=2,u(g)},function(g){l=3,h(g)})}),Ef(i,"state",{get:function(){return oq[l]}}),i}function rd(a,o){return(lq=lq||td(QQ)).v.call(this,a,o)}var hq=function YQ(a){return function(o){var i=k2(arguments,1);return a(function(l,u){try{var h=[],g=1;M2(o,function(w,T){w&&(g++,gB(w,function(D){h[T]=D,0==--g&&l(h)},u))}),0==--g&&l(h)}catch(w){u(w)}},i)}}(rd);var np=void 0,Ni="",m0="channels",nl="core",uk="createPerfMgr",vB="disabled",TE="extensionConfig",g0="extensions",Na="processTelemetry",hk="priority",dk="eventsSent",CE="eventsDiscarded",BS="eventsSendRequest",$m="perfEvent",pk="offlineEventsStored",wB="offlineBatchSent",fk="offlineBatchDrop",US="getPerfMgr",bB="domain",EB="path",xB="Not dynamic - ",dq=/-([a-z])/g,CB=/([^\w\d_$])/g,IB=/^(\d+[\w\d_$])/,JQ=Object.getPrototypeOf;function y0(a){return!tn(a)}function mk(a){return a&&xr(a)?(a=(a=a[Ly](dq,function(o,i){return i.toUpperCase()}))[Ly](CB,"_"))[Ly](IB,function(o,i){return"_"+i}):a}function Cc(a,o){return!(!a||!o)&&-1!==ec(a,o)}function _0(a){return a&&a.toISOString()||""}function to(a){return E2(a)?a[If]:Ni}function yi(a,o,i,l,u){var h=i;return!a||(h=a[o])===i||u&&!u(h)||l&&!l(i)||(a[o]=h=i),h}function Es(a,o,i){var l;return a?!(l=a[o])&&tn(l)&&(l=bs(i)?{}:i,a[o]=l):l=bs(i)?{}:i,l}function gk(a,o){var i=null,l=null;return $r(a)?i=a:l=a,function(){var u=arguments;if(l=i?i():l)return l[o][Jd](l,u)}}function yk(a,o,i,l,u){a&&o&&i&&(!1===u&&!bs(a[o])||(a[o]=gk(i,l)))}function IE(a,o,i,l){return a&&o&&Ar(a)&&Di(i)&&Hn(i,function(u){xr(u)&&yk(a,u,o,u,l)}),a}function fq(a){return a&&F4?NS(F4({},a)):a}function SB(a,o,i,l,u,h){var g=arguments,w=g[0]||{},T=g[qr],D=!1,P=1;for(0<T&&k4(w)&&(D=w,w=g[P]||{},P++),Ar(w)||(w={});P<T;P++){var N,z,W,ue,ge=g[P],we=Di(ge),Re=Ar(ge);for(N in ge)(we&&N in ge||Re&&Fm(ge,N))&&(z=ge[N],W=void 0,D&&z&&((W=Di(z))||xc(z))&&(ue=w[N],W?Di(ue)||(ue=[]):xc(ue)||(ue={}),z=SB(D,ue,z)),void 0!==z)&&(w[N]=z)}return w}function zS(a,l){return l=l&&l.featureOptIn&&l.featureOptIn[a],!(!a||!l)&&(3==(a=l.mode)||1==a)}function bl(a){try{return a.responseText}catch{}return null}function v0(a,o){return a?"XDomainRequest,Response:"+bl(a)||0:o}function _k(a,o){return a?"XMLHttpRequest,Status:"+a[h0]+",Response:"+bl(a)||0:o}function mq(a,o){return o&&(J1(o)?a=[o].concat(a):Di(o)&&(a=o.concat(a))),a}var eX="withCredentials";function yq(a,o,i){return!a[i]&&o&&o[Z8]&&(o=o[Z8](i))&&(a[i]=Ea(o)),a}function HS(a,o){var i={};return a[X4]?i=function Tse(a){var o={};return xr(a)&&Hn(Ea(a)[gE](/[\r\n]+/),function(i){var l,u;i&&(-1!==(u=i.indexOf(": "))?(l=Ea(i.substring(0,u))[Tf](),u=Ea(i.substring(u+1)),o[l]=u):o[Ea(i)]=1)}),o}(a[X4]()):o&&(i=yq(i,a,"time-delta-millis"),i=yq(i,a,"kill-duration"),i=yq(i,a,"kill-duration-seconds")),i}var _q="location",vq="JSON",iX="crypto",DB="msCrypto",PB="msie",SE="trident/",vk="XMLHttpRequest",bq=null,RB=null,oX=!1,AE=null,Vy=null;function Eq(a,o){var i,l=!1;if(a){try{(l=o in a)||(i=a[tp])&&(l=o in i)}catch{}if(!l)try{l=!bs((new a)[o])}catch{}}return l}function rp(a){return a&&oX&&(a=hs("__mockLocation"))?a:typeof location===Q2&&location?location:hs(_q)}function wk(){return!!(typeof JSON===Q2&&JSON||null!==hs(vq))}function ip(){return wk()?JSON||hs(vq):null}function kB(){var a=Xd();return!a||a[MS]===RB&&null!==bq||(a=((RB=a[MS])||Ni)[Tf](),bq=Cc(a,PB)||Cc(a,SE)),bq}function OB(a){var o=((a=(a=void 0===a?null:a)?a:(o=Xd()||{})?(o.userAgent||Ni)[Tf]():Ni)||Ni)[Tf]();return Cc(o,PB)?(a=Jl()||{},Math.max(parseInt(o[gE](PB)[1]),a.documentMode||0)):Cc(o,SE)&&(a=parseInt(o[gE](SE)[1]))?a+4:null}function DE(a){return Vy=null!==Vy&&!1!==a?Vy:function T8(){return!!Xd()}()&&!!Xd().sendBeacon}function NB(a){var o=!1;try{o=!!hs("fetch");var i=hs("Request");o&&a&&i&&(o=Eq(i,"keepalive"))}catch{}return o}function $S(){var a=!1;try{a=!!hs(vk)}catch{}return a}var Cq=4294967296,qm=4294967295,LB=123456789,FB=987654321,VB=!1,bk=LB,Ek=FB;function xk(a){var o=0,i=function Ise(){return hs(iX)}()||function sX(){return hs(DB)}();return 0===(o=i&&i.getRandomValues?i.getRandomValues(new Uint32Array(1))[0]&qm:o)&&kB()&&(VB||function Iq(){try{var a=2147483647&xf();!function Sse(a){a<0&&(a>>>=0),bk=LB+a&qm,Ek=FB-a&qm,VB=!0}((Math.random()*Cq^a)+a)}catch{}}(),o=function Dse(a){var o=((Ek=36969*(65535&Ek)+(Ek>>16)&qm)<<16)+(65535&(bk=18e3*(65535&bk)+(bk>>16)&qm))>>>0&qm|0;return a||(o>>>=0),o}()&qm),0===o&&(o=Math.floor(Cq*Math.random()|0)),a||(o>>>=0),o}function Sq(a){void 0===a&&(a=22);for(var o=xk()>>>0,i=0,l=Ni;l[qr]<a;)i++,l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&o),o>>>=6,5===i&&(o=(xk()<<2&4294967295|3&o)>>>0,i=0);return l}var uX="3.3.0",Pse="."+Sq(6),Rse=0;function hX(a){return 1===a[W2]||9===a[W2]||!+a[W2]}function ku(a,o){return mk(a+Rse+++((o=void 0!==o&&o)?"."+uX:Ni)+Pse)}function Tk(a){var o={id:ku("_aiData-"+(a||Ni)+"."+uX),accept:function(i){return hX(i)},get:function(i,l,u,h){var g=i[o.id];return g?g[mk(l)]:(h&&((g=function Mse(a,o){var i=o[a.id];if(!i){i={};try{hX(o)&&eo(o,a.id,{e:!1,v:i})}catch{}}return i}(o,i))[mk(l)]=u),u)},kill:function(i,l){if(i&&i[l])try{delete i[l]}catch{}}};return o}function qS(a){return a&&Ar(a)&&(a.isVal||a.fb||Fm(a,"v")||Fm(a,"mrg")||Fm(a,"ref")||a.set)}function Aq(a,o,i){var l,u=i.dfVal||h8;if(o&&i.fb){var h=i.fb;Di(h)||(h=[h]);for(var g=0;g<h[qr];g++){var w=h[g],T=o[w];if(u(T)?l=T:a&&(u(T=a.cfg[w])&&(l=T),a.set(a.cfg,Xc(w),T)),u(l))break}}return!u(l)&&u(i.v)?i.v:l}function op(a,o,i){var l,u=i;return(u=i&&qS(i)?Aq(a,o,i):u)&&(qS(u)&&(u=op(a,o,u)),Di(u)?(l=[])[qr]=u[qr]:xc(u)&&(l={}),l)&&(Pi(u,function(h,g){g&&qS(g)&&(g=op(a,o,g)),l[h]=g}),u=l),u}function BB(a,o,i,N){var u,h,g,w,T,D,P=qS(P=N)?(u=P.isVal,h=P.set,T=P[z2],z=P[U2],g=P.mrg,!(w=P.ref)&&bs(w)&&(w=!!g),Aq(a,o,P)):N,z=(z&&a[U2](o,i),N=!0,o[i]);!z&&tn(z)||(D=z,N=!1,u&&D!==P&&!u(D)&&(D=P,N=!0),h&&(N=(D=h(D,P,o))===P)),N?D=P&&op(a,o,P):(xc(D)||Di(P))&&g&&P&&(xc(P)||Di(P))&&Pi(P,function(W,ue){BB(a,D,W,ue)}),a.set(o,i,D),w&&a.ref(o,i),T&&a[z2](o,i)}var w0=P2("[[ai_dynCfg_1]]"),dX=P2("[[ai_blkDynCfg_1]]"),pX=P2("[[ai_frcDynCfg_1]]");function UB(a){var o;return a&&(Di(a)?(o=[])[qr]=a[qr]:xc(a)&&(o={}),o)?(Pi(a,function(i,l){o[i]=UB(l)}),o):a}function zB(a,o,i){var l=!1;return!i||a[o.blkVal]||(l=i[pX])||i[dX]?l:xc(i)||Di(i)}function mX(a){Gd("InvalidAccess:"+a)}var gX=["push","pop","shift","unshift","splice"],Gm=function(a,o,i,l){a&&a[aE](3,108,"".concat(i," [").concat(o,"] failed - ")+Mn(l))};function Ik(a,o){return(a=qd(a,o))&&a.get}function Sk(a,o,i,l){var u;return o&&((u=Ik(o,i))&&u[a.prop]?o[i]=l:function yX(a,o,i,l){var u={n:i,h:[],trk:function(T){T&&T.fn&&(-1===Ec(u.h,T)&&u.h[Io](T),a.trk(T,u))},clr:function(T){-1!==(T=Ec(u.h,T))&&u.h[lE](T,1)}},h=!0,g=!1;function w(){h&&(g=g||zB(w,a,l),l&&!l[w0]&&g&&(l=Ak(a,l,i,"Converting")),h=!1);var T=a.act;return T&&u.trk(T),l}w[a.prop]={chng:function(){a.add(u)}},eo(o,u.n,{g:w,s:function(T){if(l!==T){w[a.ro]&&!a.upd&&mX("["+i+"] is read-only:"+Mn(o)),h&&(g=g||zB(w,a,l),h=!1);var D,P=g&&w[a.rf];if(g)if(P){Pi(l,function(N){l[N]=T?T[N]:np});try{Pi(T,function(N,z){Sk(a,l,N,z)}),T=l}catch(N){Gm((a.hdlr||{})[Ms],i,"Assigning",N),g=!1}}else l&&l[w0]&&Pi(l,function(z){(z=Ik(l,z))&&(z=z[a.prop])&&z.chng()});T!==l&&(D=T&&zB(w,a,T),!P&&D&&(T=Ak(a,T,i,"Converting")),l=T,g=D),a.add(u)}}})}(a,o,i,l)),o}function jB(a,o,i,l){if(o){var u=Ik(o,i),g=l&&l[0],w=l&&l[1];if(l=l&&l[2],!u||!u[a.prop]){if(l)try{!function Dq(a){if(a&&(xc(a)||Di(a)))try{a[dX]=!0}catch{}}(o)}catch(D){Gm((a.hdlr||{})[Ms],i,"Blocking",D)}try{Sk(a,o,i,o[i]),u=Ik(o,i)}catch(D){Gm((a.hdlr||{})[Ms],i,"State",D)}}g&&(u[a.rf]=g),w&&(u[a.ro]=w),l&&(u[a.blkVal]=!0)}return o}function Ak(a,o,i,l){try{Pi(o,function(u,h){Sk(a,o,u,h)}),o[w0]||(Ef(o,w0,{get:function(){return a[H8]}}),function Ck(a,o,i){Di(o)&&Hn(gX,function(l){var u=o[l];o[l]=function(){for(var h=[],g=0;g<arguments.length;g++)h[g]=arguments[g];var w=u[Jd](this,h);return Ak(a,o,i,"Patching"),w}})}(a,o,i))}catch(u){Gm((a.hdlr||{})[Ms],i,l,u)}return o}var GS="[[ai_",b0="]]";function wX(a,o,i){var l,u,h=function fX(a){if(a){var o=a[w0]||a;if(o.cfg&&(o.cfg===a||o.cfg[w0]===o))return o}return null}(o);return h||(h=ku("dyncfg",!0),(o={uid:null,cfg:i=o&&!1!==i?o:UB(o)})[Ms]=a,o[a0]=function(){l[a0]()},o.set=function(g,w,T){try{g=Sk(l,g,w,T)}catch(D){Gm(a,w,"Setting value",D)}return g[w]},o[l0]=function(g,w){return w&&Pi(w,function(T,D){BB(u,g,T,D)}),g},o[c0]=function(g){return function vX(a,o){var i={fn:o,rm:function(){i.fn=null,o=a=null}};return eo(i,"toJSON",{v:function(){return"WatcherHandler"+(i.fn?"":"[X]")}}),a.use(i,o),i}(l,g)},o.ref=function(g,w){return jB(l,g,w,((g={})[0]=!0,g))[w]},o[z2]=function(g,w){return jB(l,g,w,((g={})[1]=!0,g))[w]},o[U2]=function(g,w){return jB(l,g,w,((g={})[2]=!0,g))[w]},o._block=function(g,w){l.use(null,function(T){var D=l.upd;try{bs(w)||(l.upd=w),g(T)}finally{l.upd=D}})},eo(u=o,"uid",{c:!1,e:!1,w:!1,v:h}),Ak(l=function _X(a){var o,i=iE(GS+"get"+a.uid+b0),l=iE(GS+"ro"+a.uid+b0),u=iE(GS+"rf"+a.uid+b0),h=iE(GS+"blkVal"+a.uid+b0),g=iE(GS+"dtl"+a.uid+b0),w=null,T=null;function D(N,z){var W=o.act;try{(o.act=N)&&N[g]&&(Hn(N[g],function(ge){ge.clr(N)}),N[g]=[]),z({cfg:a.cfg,set:a.set.bind(a),setDf:a[l0].bind(a),ref:a.ref.bind(a),rdOnly:a[z2].bind(a)})}catch(ge){var ue=a[Ms];throw ue&&ue[aE](1,107,Mn(ge)),ge}finally{o.act=W||null}}function P(){if(w){var N=w,z=(w=null,T&&T[u0](),T=null,[]);if(Hn(N,function(W){if(W&&(W[g]&&(Hn(W[g],function(ue){ue.clr(W)}),W[g]=null),W.fn))try{D(W,W.fn)}catch(ue){z[Io](ue)}}),w)try{P()}catch(W){z[Io](W)}0<z[qr]&&function UQ(a,o){B2=B2||M8("AggregationError",function(l,u){1<u[qr]&&(l.errors=u[1])});var i=a||"One or more errors occurred.";throw Hn(o,function(l,u){i+="\n".concat(u," > ").concat(Mn(l))}),new B2(i,o||[])}("Watcher error(s): ",z)}}return(i={prop:i,ro:l,rf:u})[U2]=h,i[H8]=a,i.add=function(N){if(N&&0<N.h[qr]){w=w||[],T=T||_h(function(){T=null,P()},0);for(var z=0;z<N.h[qr];z++){var W=N.h[z];W&&-1===Ec(w,W)&&w[Io](W)}}},i[a0]=P,i.use=D,i.trk=function(N,z){N&&(N=N[g]=N[g]||[],-1===Ec(N,z))&&N[Io](z)},o=i}(u),i,"config","Creating"),u)}function id(a,o,i,l){return i=wX(i,a||{},l),o&&i[l0](i.cfg,o),i}function xa(a,o,i){var l=a[w0]||a;return(!l.cfg||l.cfg!==a&&l.cfg[w0]!==l?(function bX(a,o){a?(a[PS](o),a[aE](2,108,o)):mX(o)}(i,xB+Mn(a)),id(a,null,i)):l)[c0](o)}function PE(a,o){if(a&&a[Oy])return a[Oy](o)}function Pq(a,o,i){var l;return i||(l=rd(function(u){i=u})),a&&0<FQ(a)?Df(PE(a[0],o),function(){Pq(k2(a,1),o,i)}):i(),l}var Rq="Microsoft_ApplicationInsights_BypassAjaxInstrumentation";function xX(a,o,i){return!a&&tn(a)?o:k4(a)?a:"true"===Xc(a)[Tf]()}function sp(a){return{mrg:!0,v:a}}function Dk(a,o){return{set:a,v:o}}function Pk(a,o,i){return{fb:i,isVal:a,v:o}}function La(a,o){return{fb:o,set:xX,v:!!a}}var KS,Rk,Ic=[dk,CE,BS,$m],WS=null;function Mk(a,o){return function(){var i=arguments,l=kk(o);l&&(l=l.listener)&&l[a]&&l[a][Jd](l,i)}}function kk(a){var o=WS;return(o=o||!0===a.disableDbgExt?o:WS||function HB(){var a=hs("Microsoft");return WS=a?a.ApplicationInsights:WS}())?o.ChromeDbgExt:null}var Ok="warnToConsole",qB={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},CX=((Rk={})[0]=null,Rk[1]="errorToConsole",Rk[2]=Ok,Rk[3]="debugToConsole",Rk);function IX(a){return a?'"'+a[Ly](/\"/g,Ni)+'"':Ni}function Nk(a,o){var i,l=function MB(){return typeof console!==OS?console:hs("console")}();l&&(i="log",l[a]&&(i=a),$r(l[i]))&&l[i](o)}var YS=function(){function a(o,i,l,u){void 0===l&&(l=!1),this[G2]=o,this[ep]=(l?"AI: ":"AI (Internal): ")+o,l=Ni,wk()&&(l=ip().stringify(u)),o=(i?" message:"+IX(i):Ni)+(u?" props:"+IX(l):Ni),this[ep]+=o}return a.dataType="MessageData",a}();function Uy(a,o){return(a||{})[Ms]||new ZS(o)}var Oq,RE,ZS=function(){function a(o){this.identifier="DiagnosticLogger",this.queue=[];var i,l,u,h,g,w=0,T={};ko(a,this,function(D){function P(z,W){var ue,ge;u<=w||(ge=!0,T[ue="AITR_"+W[G2]]?ge=!1:T[ue]=!0,ge&&(z<=l&&(D.queue[Io](W),w++,N(1===z?"error":"warn",W)),w===u)&&(ge=new YS(23,ue="Internal events throttle limit per PageView reached for this app.",!1),D.queue[Io](ge),1===z?D.errorToConsole(ue):D[PS](ue)))}function N(z,W){var ue=kk(o||{});ue&&ue[jm]&&ue[jm](z,W)}g=xa(id(o||{},qB,D).cfg,function(z){i=(z=z.cfg)[K8],l=z.loggingLevelTelemetry,u=z.maxMessageLimit,h=z.enableDebug}),D.consoleLoggingLevel=function(){return i},D[aE]=function(z,W,ue,ge,we){if(W=new YS(W,ue,we=void 0!==we&&we,ge),h)throw Mn(W);ue=CX[z]||Ok,bs(W[ep])?N("throw"+(1===z?"Critical":"Warning"),W):(we?!T[ge=+W[G2]]&&z<=i&&(D[ue](W[ep]),T[ge]=!0):z<=i&&D[ue](W[ep]),P(z,W))},D.debugToConsole=function(z){Nk("debug",z),N("warning",z)},D[PS]=function(z){Nk("warn",z),N("warning",z)},D.errorToConsole=function(z){Nk("error",z),N("error",z)},D.resetInternalMessageCount=function(){w=0,T={}},D[Y8]=P,D[Oy]=function(z){g&&g.rm(),g=null}})}return a.__ieDyn=1,a}();function Nq(a){return a||new ZS}function En(a,o,i,l,u,h){void 0===h&&(h=!1),Nq(a)[aE](o,i,l,u,h)}function E0(a,o){Nq(a)[PS](o)}var Km,Lk="toGMTString",GB="toUTCString",Fk="cookie",KB="expires",WB="isCookieUseDisabled",Vk="disableCookiesUsage",Ou="_ckMgr",x0=null,Bk=null,YB=null,Fq={},Uk={},kse=((Oq={cookieCfg:sp(((RE={})[bB]={fb:"cookieDomain",dfVal:y0},RE.path={fb:"cookiePath",dfVal:y0},RE.enabled=np,RE.ignoreCookies=np,RE.blockedCookies=np,RE)),cookieDomain:np,cookiePath:np})[Vk]=np,Oq);function zk(){Km=Km||function b8(a){var o={};return jo||Vm(),o.b=jo.lzy,Ef(o,"v",{configurable:!0,get:function(){var i=a();return jo.lzy||Ef(o,"v",{value:i}),o.b=jo.lzy,i}}),o}(function(){return Jl()})}function ZB(a){return!a||a.isEnabled()}function AX(a,o){return!!(o&&a&&Di(a.ignoreCookies))&&-1!==Ec(a.ignoreCookies,o)}function DX(a,l){var i;return tn(l=l[dE])&&(i=void 0,bs(a[WB])||(i=!a[WB]),l=i=bs(a[Vk])?i:!a[Vk]),l}function jk(a,o){var i,l;return a?l=a.getCookieMgr():o&&(l=(i=o.cookieCfg)&&i[Ou]?i[Ou]:Pf(o)),l||function SX(a,o){var i=Pf[Ou]||Uk[Ou];return i||(i=Pf[Ou]=Pf(a,o),Uk[Ou]=i),i}(o,(a||{})[Ms])}function Pf(a,o){a=id(a||Uk,null,o).cfg,g=xa(a,function(z){z[l0](z.cfg,kse),l=z.ref(z.cfg,"cookieCfg"),u=l[EB]||"/",h=l[bB],w=!1!==DX(a,l),T=l.getCookie||Nse,D=l.setCookie||MX,P=l.delCookie||MX},o),(i={isEnabled:function(){var z=!1!==DX(a,l)&&w&&Vq(o),W=Uk[Ou];return z&&W&&N!==W?ZB(W):z},setEnabled:function(z){w=!1!==z,l[dE]=z},set:function(z,W,ue,ge,we){var Re,et,Mt,St=!1;return ZB(N)&&!function Ose(a,o){return!!(o&&a&&Di(a.blockedCookies)&&-1!==Ec(a.blockedCookies,o))||AX(a,o)}(l,z)&&(Re={},et=Ea(W||Ni),-1!==(Mt=ec(et,";"))&&(et=Ea(v8(W,Mt)),Re=Bq(Yd(W,Mt+1))),yi(Re,bB,ge||h,x2,bs),tn(ue)||(W=kB(),bs(Re[KB])&&0<(Mt=xf()+1e3*ue)&&((ge=new Date).setTime(Mt),yi(Re,KB,PX(ge,W?Lk:GB)||PX(ge,W?Lk:GB)||Ni,x2)),W)||yi(Re,"max-age",Ni+ue,null,bs),(Mt=rp())&&"https:"===Mt[W8]&&(yi(Re,"secure",null,null,bs),Bk=null===Bk?!function Lse(a){return!(!xr(a)||!Cc(a,"CPU iPhone OS 12")&&!Cc(a,"iPad; CPU OS 12")&&!(Cc(a,"Macintosh; Intel Mac OS X 10_14")&&Cc(a,"Version/")&&Cc(a,"Safari"))&&(!Cc(a,"Macintosh; Intel Mac OS X 10_14")||!V8(a,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))&&!Cc(a,"Chrome/5")&&!Cc(a,"Chrome/6")&&(!Cc(a,"UnrealEngine")||Cc(a,"Chrome"))&&!Cc(a,"UCBrowser/12")&&!Cc(a,"UCBrowser/11"))}((Xd()||{})[MS]):Bk)&&yi(Re,"SameSite","None",null,bs),yi(Re,EB,we||u,null,bs),D(z,RX(et,Re)),St=!0),St},get:function(z){var W=Ni;return ZB(N)&&!AX(l,z)?T(z):W},del:function(z,W){return!!ZB(N)&&N.purge(z,W)},purge:function(z,W){var ue,ge=!1;return Vq(o)&&((ue={})[EB]=W||"/",ue[KB]="Thu, 01 Jan 1970 00:00:01 GMT",W=ue,kB()||(W["max-age"]="0"),P(z,RX(Ni,W)),ge=!0),ge}})[Oy]=function(z){g&&g.rm(),g=null};var i,l,u,h,g,w,T,D,P,N=i;return N[Ou]=N}function Vq(a){if(null===x0){x0=!1,Km||zk();try{x0=void 0!==(Km.v||{})[Fk]}catch(i){En(a,2,68,"Cannot access document.cookie - "+to(i),{exception:Mn(i)})}}return x0}function Bq(a){var o={};return a&&a[qr]&&Hn(Ea(a)[gE](";"),function(i){var l;(i=Ea(i||Ni))&&(-1===(l=ec(i,"="))?o[i]=null:o[Ea(v8(i,l))]=Ea(Yd(i,l+1)))}),o}function PX(a,o){return $r(a[o])?a[o]():null}function RX(a,o){var i=a||Ni;return Pi(o,function(l,u){i+="; "+l+(tn(u)?Ni:"="+u)}),i}function Nse(a){var o,i=Ni;return Km||zk(),Km.v&&(YB!==(o=Km.v[Fk]||Ni)&&(Fq=Bq(o),YB=o),i=Ea(Fq[a]||Ni)),i}function MX(a,o){Km||zk(),Km.v&&(Km.v[Fk]=a+"="+o)}var kX={perfEvtsSendAll:!1};function Hk(a){a.h=null;var o=a.cb;a.cb=[],Hn(o,function(i){wl(i.fn,[i.arg])})}function zy(a,o,i,l){Hn(a,function(u){u&&u[o]&&(i?(i.cb[Io]({fn:l,arg:u}),i.h=i.h||_h(Hk,0,i)):wl(l,[u]))})}var OX=function(){function a(o){this.listeners=[];var i,l=[],u={h:null,cb:[]},h=id(o,kX)[c0](function(g){i=!!g.cfg.perfEvtsSendAll});ko(a,this,function(g){eo(g,"listeners",{g:function(){return l}}),g[RS]=function(w){l[Io](w)},g[j2]=function(w){for(var T=Ec(l,w);-1<T;)l[lE](T,1),T=Ec(l,w)},g[dk]=function(w){zy(l,dk,u,function(T){T[dk](w)})},g[CE]=function(w,T){zy(l,CE,u,function(D){D[CE](w,T)})},g[BS]=function(w,T){zy(l,BS,T?u:null,function(D){D[BS](w,T)})},g[$m]=function(w){!w||!i&&w[J4]()||zy(l,$m,null,function(T){w[pE]?_h(function(){return T[$m](w)},0):T[$m](w)})},g[pk]=function(w){w&&w[qr]&&zy(l,pk,u,function(T){T[pk](w)})},g[wB]=function(w){w&&w[yE]&&zy(l,wB,u,function(T){T[wB](w)})},g[fk]=function(w,T){var D;0<w&&(D=T||0,zy(l,fk,u,function(P){P[fk](w,D)}))},g[Oy]=function(w){function T(){h&&h.rm(),h=null,l=[],u.h&&u.h[u0](),u.h=null,u.cb=[]}var D;if(zy(l,"unload",null,function(P){(P=P[Oy](w))&&(D=D||[])[Io](P)}),D)return rd(function(P){return Df(hq(D),function(){T(),P()})});T()}})}return a.__ieDyn=1,a}(),T0="ctx",Wm="ParentContextKey",ME="ChildrenContextKey",kE=function(){function a(o,i,l){var u,h=this;h.start=xf(),h[If]=o,h[pE]=l,h[J4]=function(){return!1},$r(i)&&eo(h,"payload",{g:function(){return!u&&$r(i)&&(u=i(),i=null),u}}),h[_E]=function(g){return g?(g===a[Wm]||g===a[ME]?h:h[T0]||{})[g]:null},h[Af]=function(g,w){g&&(g===a[Wm]?(h[g]||(h[J4]=function(){return!0}),h[g]=w):g===a[ME]?h[g]=w:(h[T0]=h[T0]||{})[g]=w)},h[eB]=function(){var g=0,w=h[_E](a[ME]);if(Di(w))for(var T=0;T<w[qr];T++){var D=w[T];D&&(g+=D[uE])}h[uE]=xf()-h.start,h.exTime=h[uE]-g,h[eB]=function(){}}}return a.ParentContextKey="parent",a.ChildrenContextKey="childEvts",a}(),NX=function(){function a(o){this.ctx={},ko(a,this,function(i){i.create=function(l,u,h){return new kE(l,u,h)},i.fire=function(l){l&&(l[eB](),o)&&$r(o[$m])&&o[$m](l)},i[Af]=function(l,u){l&&((i[T0]=i[T0]||{})[l]=u)},i[_E]=function(l){return(i[T0]||{})[l]}})}return a.__ieDyn=1,a}(),QS="CoreUtils.doPerf";function OE(a,o,i,l,u){if(a&&(a=a[US]?a[US]():a)){var h,g=void 0,w=a[_E](QS);try{if(g=a.create(o(),l,u))return w&&g[Af]&&(g[Af](kE[Wm],w),w[_E])&&w[Af]&&((h=w[_E](kE[ME]))||w[Af](kE[ME],h=[]),h[Io](g)),a[Af](QS,g),i(g)}catch(T){g&&g[Af]&&g[Af]("exception",T)}finally{g&&a.fire(g),a[Af](QS,w)}}return i()}function C0(){for(var a,o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],i=Ni,l=0;l<4;l++)i+=o[15&(a=xk())]+o[a>>4&15]+o[a>>8&15]+o[a>>12&15]+o[a>>16&15]+o[a>>20&15]+o[a>>24&15]+o[a>>28&15];var u=o[8+(3&xk())|0];return Dy(i,0,8)+Dy(i,9,4)+"4"+Dy(i,13,3)+u+Dy(i,16,3)+Dy(i,19,12)}var XB="00000000000000000000000000000000",zq="0000000000000000";function XS(a,o,i){return!(!a||a[qr]!==o||a===i||!a.match(/^[\da-f]*$/i))}function jq(a,o,i){return XS(a,o)?a:i}function JB(a,o,i,l){var u={};return u[Z4]=XS(l,2,"ff")?l:"00",u[tB]=qk(a)?a:C0(),u[Z2]=Gk(o)?o:v8(C0(),16),u.traceFlags=0<=i&&i<=255?i:1,u}function qk(a){return XS(a,32,XB)}function Gk(a){return XS(a,16,zq)}function Hq(a){var o,i;return a?(XS(o=function LX(a){for(var o=(a=isNaN(a)||a<0||255<a?1:a).toString(16);o[qr]<2;)o="0"+o;return o}(a[nB]),2)||(o="01"),"".concat((i="00"!==(i=a[Z4]||"00")&&"ff"!==i?"00":i).toLowerCase(),"-").concat(jq(a.traceId,32,XB).toLowerCase(),"-").concat(jq(a.spanId,16,zq).toLowerCase(),"-").concat(o.toLowerCase())):""}var FX=Tk("plugin");function jy(a){return FX.get(a,"state",{},!0)}function JS(a,o){for(var i=[],l=null,u=a[Sf]();u;){var h,g,w=u[$2]();w&&(l&&l[mE]&&w[Na]&&l[mE](w),g=!!(h=jy(w))[Cf],(g=w[Cf]?w[Cf]():g)||i[Io](w),l=w,u=u[Sf]())}Hn(i,function(T){var D=a[nl]();T[cE](a.getCfg(),D,o,a[Sf]()),h=jy(T),T[nl]||h[nl]||(h[nl]=D),h[Cf]=!0,delete h[zm]})}function $q(a){return a.sort(function(o,i){var l,u=0;return i?(l=i[Na],o[Na]?u=l?o[hk]-i[hk]:1:l&&(u=-1)):u=o?1:-1,u})}var NE,VX="TelemetryPluginChain",Gq="_hasRun",BX="_getTelCtx",UX=0;function eU(a,o,i,l){var u=null,h=[],g=(o=o||id({},null,i[Ms]),null!==l&&(u=l?function zX(a,o,i){for(;a;){if(a[$2]()===i)return a;a=a[Sf]()}return Hy([i],o.config||{},o)}(a,i,l):a),{_next:function(){var D,T=u;return u=T?T[Sf]():null,T||(D=h)&&0<D[qr]&&(Hn(D,function(P){try{P.func.call(P.self,P.args)}catch(N){En(i[Ms],2,73,"Unexpected Exception during onComplete - "+Mn(N))}}),h=[]),T},ctx:{core:function(){return i},diagLog:function(){return Uy(i,o.cfg)},getCfg:function(){return o.cfg},getExtCfg:function(T,D){var P=w(T,!0);return D&&Pi(D,function(N,z){var W;!tn(P[N])||!(W=o.cfg[N])&&tn(W)||(P[N]=W),BB(o,P,N,z)}),o[l0](P,D)},getConfig:function(z,D,P){void 0===P&&(P=!1),z=w(z,!1);var N,W=o.cfg;return!z||!z[D]&&tn(z[D])?!W[D]&&tn(W[D])||(N=W[D]):N=z[D],N||!tn(N)?N:P},hasNext:function(){return!!u},getNext:function(){return u},setNext:function(T){u=T},iterate:function(T){for(;D=g._next();){var D=D[$2]();D&&T(D)}},onComplete:function(T,D){for(var P=[],N=2;N<arguments.length;N++)P[N-2]=arguments[N];T&&h[Io]({func:T,self:bs(D)?g.ctx:D,args:P})}}});function w(T,D){var P,N=null,z=o.cfg;return z&&T&&(z[TE]=P=!(P=z[TE])&&D?{}:P,P=o.ref(z,TE))&&(P[T]=N=!(N=P[T])&&D?{}:N,N=o.ref(P,T)),N}return g}function ap(a,o,i,l){var u=id(o),h=eU(a,u,i,l),g=h.ctx;return g[eu]=function(w){var T=h._next();return T&&T[Na](w,g),!T},g[Ny]=function(w,T){return ap((w=Di(w=void 0===w?null:w)?Hy(w,u.cfg,i,T):w)||g[Sf](),u.cfg,i,T)},g}function Kk(a,o,i){var l=id(o.config),u=eU(a,l,o,i),h=u.ctx;return h[eu]=function(g){var w=u._next();return w&&w[Oy](h,g),!w},h[Ny]=function(g,w){return Kk((g=Di(g=void 0===g?null:g)?Hy(g,l.cfg,o,w):g)||h[Sf](),o,w)},h}function Wk(a,o,i){var l=id(o.config),u=eU(a,l,o,i).ctx;return u[eu]=function(h){return u.iterate(function(g){$r(g[fE])&&g[fE](u,h)})},u[Ny]=function(h,g){return Wk((h=Di(h=void 0===h?null:h)?Hy(h,l.cfg,o,g):h)||u[Sf](),o,g)},u}function Hy(a,o,i,l){var u,h=null,g=!l;return Di(a)&&0<a[qr]&&(u=null,Hn(a,function(w){(g=!g&&l===w||g)&&w&&$r(w[Na])&&(w=function jX(a,o,i){var l=null,u=$r(a[Na]),h=$r(a[mE]),g=a?a[Um]+"-"+a[hk]+"-"+UX++:"Unknown-0-"+UX++,w={getPlugin:function(){return a},getNext:function(){return l},processTelemetry:function(D,P){var N;T(P=P||(a&&$r(a[BX])&&(N=a[BX]()),N=N||ap(w,o,i)),function(N){var z;return!(!a||!u||(z=jy(a))[zm]||z[vB]||(h&&a[mE](l),a[Na](D,N),0))},"processTelemetry",function(){return{item:D}},!D.sync)||P[eu](D)},unload:function(D,P){T(D,function(){var N,z,W=!1;return a&&(N=jy(a),z=a[nl]||N[nl],!a||z&&z!==D.core()||N[zm]||(N[nl]=null,N[zm]=!0,N[Cf]=!1,a[zm]&&!0===a[zm](D,P)&&(W=!0))),W},"unload",function(){},P[pE])||D[eu](P)},update:function(D,P){T(D,function(){var N,z,W=!1;return a&&(N=jy(a),z=a[nl]||N[nl],!a||z&&z!==D.core()||N[zm]||a[fE]&&!0===a[fE](D,P)&&(W=!0)),W},"update",function(){},!1)||D[eu](P)},_id:g,_setNext:function(D){l=D}};function T(D,P,N,z,W){var ue=!1,ge=a?a[Um]:VX,we=(we=D[Gq])||(D[Gq]={});return D.setNext(l),a&&OE(D[nl](),function(){return ge+":"+N},function(){we[g]=!0;try{var Re=l?l._id:Ni;Re&&(we[Re]=!1),ue=P(D)}catch(et){(Re=!l||we[l._id])&&(ue=!0),l&&Re||En(D[jm](),1,73,"Plugin ["+ge+"] failed during "+N+" - "+Mn(et)+", run flags: "+Mn(we))}},z,W),ue}return Ay(w)}(w,o,i),h=h||w,u&&u._setNext(w),u=w)})),l&&!h?Hy([l],o,i):h}function tU(){var a=[];return{add:function(o){o&&a[Io](o)},run:function(o,i){Hn(a,function(l){try{l(o,i)}catch(u){En(o[jm](),2,73,"Unexpected error calling unload handler - "+Mn(u))}}),a=[]}}}function nU(){var a=[];return{run:function(o){var i=a;a=[],Hn(i,function(l){try{(l.rm||l.remove).call(l)}catch(u){En(o,2,73,"Unloading:"+Mn(u))}})},add:function(o){o&&oE(a,o)}}}var S0,I0="getPlugin",HX=((NE={})[TE]={isVal:y0,v:{}},NE),$y=function(){function a(){var o,i,l,u,h,g=this;function w(z){return(z=z=void 0===z?null:z)||(z=(i||ap(null,{},g[nl]))[Ny](null,l&&l[I0]?l[I0]:l)),z}function T(P,N,z){id(P,HX,Uy(N)),!z&&N&&(z=N[Y4]()[Sf]());var W=l;l&&l[I0]&&(W=l[I0]()),g[nl]=N,i=ap(z,P,N,W)}function D(){o=!1,g[nl]=null,l=i=null,h=nU(),u=tU()}D(),ko(a,g,function(P){P[cE]=function(N,z,W,ue){T(N,z,ue),o=!0},P[zm]=function(N,z){var W,ue,ge,we,Re=P[nl];if(Re&&(!N||Re===N[nl]()))return ue=!1,ge=N||Kk(null,Re,l&&l[I0]?l[I0]():l),we=z||((N={reason:0})[pE]=!1,N),P[K2]&&!0===P[K2](ge,we,et)?W=!0:et(),W;function et(){ue||(ue=!0,u.run(ge,z),h.run(ge[jm]()),!0===W&&ge[eu](we),D())}},P[fE]=function(N,z){var W,ue,ge,we=P[nl];if(we&&(!N||we===N[nl]()))return ue=!1,ge=N||Wk(null,we,l&&l[I0]?l[I0]():l),P._doUpdate&&!0===P._doUpdate(ge,z||{reason:0},Re)?W=!0:Re(),W;function Re(){ue||(ue=!0,T(ge.getCfg(),ge.core(),ge[Sf]()))}},yk(P,"_addUnloadCb",function(){return u},"add"),yk(P,"_addHook",function(){return h},"add"),eo(P,"_unloadHooks",{g:function(){return h}})}),g[jm]=function(P){return w(P)[jm]()},g[Cf]=function(){return o},g.setInitialized=function(P){o=P},g[mE]=function(P){l=P},g[eu]=function(P,N){N?N[eu](P):l&&$r(l[Na])&&l[Na](P,null)},g._getTelCtx=w}return a.__ieDyn=1,a}(),Yk=function(a){function o(){var i,l,u=a.call(this)||this;function h(){i=0,l=[]}return u.identifier="TelemetryInitializerPlugin",u.priority=199,h(),ko(o,u,function(g,w){g.addTelemetryInitializer=function(T){return function Kq(a,o,i){var l={id:o,fn:i};return oE(a,l),{remove:function(){Hn(a,function(u,h){if(u.id===l.id)return a[lE](h,1),-1})}}}(l,i++,T)},g[Na]=function(T,D){(function Wq(a,o,i){for(var l=!1,u=a[qr],h=0;h<u;++h){var g=a[h];if(g)try{if(!1===g.fn[Jd](null,[o])){l=!0;break}}catch(w){En(i,2,64,"Telemetry initializer failed: "+to(w),{exception:Mn(w)},!0)}}return!l})(l,T,(D||g)[jm]())&&g[eu](T,D)},g[K2]=function(){h()}}),u}return nu(o,a),o.__ieDyn=1,o}($y),Yq="Plugins must provide initialize method",rU="SDK is still unloading...",Qq=IS(((S0={cookieCfg:{}})[g0]={rdOnly:!0,ref:!0,v:[]},S0[m0]={rdOnly:!0,ref:!0,v:[]},S0[TE]={ref:!0,v:{}},S0[uk]=np,S0.loggingLevelConsole=0,S0.diagnosticLogInterval=np,S0));function GX(a,o){return new NX(o)}function KX(a,o){var i=!1;return Hn(o,function(l){if(l===a)return i=!0,-1}),i}function iU(a,o,i,l){i&&Pi(i,function(u,h){l&&xc(h)&&xc(o[u])&&iU(a,o[u],h,l),l&&xc(h)&&xc(o[u])?iU(a,o[u],h,l):a.set(o,u,h)})}function A0(a,o){var i=null,l=-1;return Hn(a,function(u,h){if(u.w===o)return i=u,l=h,-1}),{i:l,l:i}}var $se=function(){function a(){var o,i,l,u,h,g,w,T,D,P,N,z,W,ue,ge,we,Re,et,Mt,St,Qt,Le,Je,ot,Et,Kt,Ne,lt,It,xt,ln,Sn;ko(a,this,function(We){function on(){It=!0,tn(Qt)?(Kt=My[q8],En(l,1,112,"ikey can't be resolved from promises")):Kt=My.ACTIVE,Rn()}function Rn(){i&&(We.releaseQueue(),We[hE]())}function sr(st){return xt&&xt[dE]||Sn||(st||l&&0<l.queue[qr])&&(ln||(ln=!0,gr(o[c0](function(Jt){var oe=((Jt=Jt.cfg.diagnosticLogInterval)&&0<Jt||(Jt=1e4),!1);xt&&(oe=xt[dE],xt[u0]()),(xt=function z8(a,o){return K4(!1,Yl,bf[Zl](arguments))}(Fr,Jt)).unref(),xt[dE]=oe}))),xt[dE]=!0),xt}function nn(){function st(Jt){Jt&&Hn(Jt,function(oe){oe[Um]&&oe[Z4]&&!Ut[oe.identifier]&&(ot[Io](oe[Um]+"="+oe[Z4]),Ut[oe.identifier]=oe)})}var Ut={};ot=[],st(z),N&&Hn(N,function(Jt){st(Jt)}),st(P)}function dt(){i=!1,(o=id({},Qq,We[Ms])).cfg[K8]=1,eo(We,"config",{g:function(){return o.cfg},s:function(Ut){We.updateCfg(Ut,!1)}}),eo(We,"pluginVersionStringArr",{g:function(){return ot||nn(),ot}}),eo(We,"pluginVersionString",{g:function(){return Et||(ot||nn(),Et=ot.join(";")),Et||Ni}}),eo(We,"logger",{g:function(){return l||(l=new ZS(o.cfg),o[Ms]=l),l},s:function(Ut){o[Ms]=Ut,l!==Ut&&(PE(l,!1),l=Ut)}}),We[Ms]=new ZS(o.cfg),Je=[];var st=We.config[g0]||[];st.splice(0,st[qr]),oE(st,Je),ue=new Yk,PE(h,!(u=[])),w=g=h=null,PE(T,!1),W=!(P=[]),we=ku("AIBaseCore",!(ge=z=N=D=T=null)),Re=tU(),Qt=St=null,et=nU(),Kt=0,lt=Ne=xt=ot=Et=null,It=ln=Sn=!(Le=[])}function pi(){var st=ap(Wr(),o.cfg,We);return st[q2](sr),st}function Qn(st){var Ut=function Bse(a,o,i){var l=[],u=[],h={};return Hn(i,function(g){(tn(g)||tn(g[cE]))&&yh(Yq);var w=g[hk],T=g[Um];g&&w&&(tn(h[w])?h[w]=T:E0(a,"Two extensions have same priority #"+w+" - "+h[w]+", "+T)),(!w||w<o?l:u)[Io](g)}),(i={})[nl]=l,i[m0]=u,i}(We[Ms],500,P),Jt=(ot=Et=D=null,z=$q(oE(z=(N||[])[0]||[],Ut[m0])),Ut=oE($q(Ut[nl]),z),(Je=Ay(Ut),Jt=We.config[g0]||[]).splice(0,Jt[qr]),oE(Jt,Je),pi());z&&0<z[qr]&&JS(Jt[Ny](z),Ut),JS(Jt,Ut),st&&Ao(st)}function ar(st){var Jt=null,oe=[];return Hn(Je,function(ne){if(ne[Um]===st&&ne!==ue)return Jt=ne,-1;ne.getChannel&&oe[Io](ne)}),!Jt&&0<oe[qr]&&Hn(oe,function(ne){if(!(Jt=ne.getChannel(st)))return-1}),Jt?{plugin:Jt,setEnabled:function(ne){jy(Jt)[vB]=!ne},isEnabled:function(){var ne=jy(Jt);return!ne[zm]&&!ne[vB]},remove:function(ne,X){var ie,ye=[Jt];(ie={reason:1})[pE]=ne=void 0===ne||ne,zn(ye,ie,function(De){De&&Qn({reason:32,removed:ye}),X&&X(De)})}}:null}function Wr(){var st;return D||(st=(Je||[]).slice(),-1===Ec(st,ue)&&st[Io](ue),D=Hy($q(st),o.cfg,We)),D}function zn(st,Ut,Jt){var oe;st&&0<st[qr]?((oe=Kk(Hy(st,o.cfg,We),We))[q2](function(){var ne=!1,X=[],ie=(Hn(P,function(ye,De){KX(ye,st)?ne=!0:X[Io](ye)}),P=X,ot=Et=null,[]);N&&(Hn(N,function(ye,De){var Ke=[];Hn(ye,function(ct){KX(ct,st)?ne=!0:Ke[Io](ct)}),ie[Io](Ke)}),N=ie),Jt&&Jt(ne),sr()}),oe[eu](Ut)):Jt(!1)}function Fr(){var st;l&&l.queue&&(st=l.queue.slice(0),l.queue[qr]=0,Hn(st,function(oe){var Jt;(Jt={})[If]=ge||"InternalMessageId: "+oe[G2],Jt[ky]=Qt,Jt[uE]=_0(new Date),Jt.baseType=YS.dataType,Jt.baseData={message:oe[ep]},We.track(oe=Jt)}))}function So(st,Ut,Jt,oe){var ne=1,X=!1,ie=null;function ye(){ne--,X&&0===ne&&(ie&&ie[u0](),ie=null,Ut&&Ut(X),Ut=null)}return oe=oe||5e3,z&&0<z[qr]&&pi()[Ny](z).iterate(function(De){var Ke;De.flush&&(ne++,Ke=!1,De.flush(st,function(){Ke=!0,ye()},Jt)||Ke||(st&&null==ie?ie=_h(function(){ie=null,ye()},oe):ye()))}),X=!0,ye(),!0}function Ao(st){var Ut=Wk(Wr(),We);Ut[q2](sr),We._updateHook&&!0===We._updateHook(Ut,st)||Ut[eu](st)}function Ht(st){var Ut=We[Ms];Ut?(En(Ut,2,73,st),sr()):yh(st)}function yn(st){var Ut=We[W4]();Ut&&Ut[CE]([st],2)}function gr(st){et.add(st)}dt(),We._getDbgPlgTargets=function(){return[Je,u]},We[Cf]=function(){return i},We.activeStatus=function(){return Kt},We._setPendingStatus=function(){Kt=3},We[cE]=function(st,Ut,Jt,X){var ne;W&&yh(rU),We[Cf]()&&yh("Core cannot be initialized more than once"),o=id(st,Qq,Jt||We[Ms],!1),st=o.cfg,gr(o[c0](function(ie){var ye,De,Ke,ct,wt=ie.cfg;3!==Kt&&(lt=wt.initInMemoMaxSize||100,Ke=wt.endpointUrl,tn(De=wt[$8])?(Qt=null,Kt=My[q8],ye="Please provide instrumentation key",i?(En(l,1,100,ye),Rn()):yh(ye)):(ye=[],Qt=or(De)?(ye[Io](De),null):De,Ne=or(Ke)?(ye[Io](Ke),null):Ke,ye[qr]?(It=!1,Kt=3,De=y0(wt.initTimeOut)?wt.initTimeOut:5e4,Ke=function XQ(a,o){return(cq=cq||function Ese(a){return td(function(o){var i=k2(arguments,1);return a(function(l,u){var h=[],g=1;function w(T,D){g++,Df(T,function(P){h[D]=P.rejected?{status:lk,reason:P.reason}:{status:"fulfilled",value:P.value},0==--g&&l(h)})}try{Di(o)?Hn(o,w):j4(o)?M2(o,w):Gd("Input is not an iterable"),0==--g&&l(h)}catch(T){u(T)}},i)})}(rd)).v(a,o)}(ye),_h(function(){It||on()},De),Df(Ke,function(Me){try{var Pe,Ft,kt;It||(Me.rejected||((Pe=Me[H2])&&Pe[qr]&&(Qt=(Ft=Pe[0])&&Ft[H2],1<Pe[qr])&&(Ne=(kt=Pe[1])&&kt[H2]),Qt&&(st[$8]=Qt,st.endpointUrl=Ne)),on())}catch{It||on()}})):on(),Pi(ct=ie.ref(ie.cfg,TE),function(Me){ie.ref(ct,Me)})))})),Mt=function jse(a,o,i,l){return o.add(a[c0](function(u){var h=u.cfg.disableDbgExt;!0===h&&l&&(i[j2](l),l=null),i&&!l&&!0!==h&&(l=function TX(a){if(!KS){KS={};for(var o=0;o<Ic[qr];o++)KS[Ic[o]]=Mk(Ic[o],a)}return KS}(u.cfg),i[RS](l))})),l}(o,et,(h=X)&&We[W4](),Mt),gr(o[c0](function(ie){var ye;ie.cfg.enablePerfMgr?(ne!==(ye=ie.cfg[uk])&&(Es(ie.cfg,uk,ye=ye||GX),ne=ye,w=null),g||w||!$r(ye)||(w=ye(We,We[W4]()))):ne=w=null})),We[Ms]=Jt,X=st[g0],(P=[])[Io].apply(P,oB(oB([],Ut),X)),N=st[m0],Qn(null),z&&0!==z[qr]||yh("No "+m0+" available"),N&&1<N[qr]&&((Jt=We[$2]("TeeChannelController"))&&Jt.plugin||En(l,1,28,"TeeChannel required")),function zse(a,o,i){Hn(o,function(l){var u=xa(a,l.w,i);delete l.w,l.rm=function(){u.rm()}})}(st,Le,l),i=!(Le=null),Kt===My.ACTIVE&&Rn()},We.getChannels=function(){var st=[];return z&&Hn(z,function(Ut){st[Io](Ut)}),Ay(st)},We.track=function(st){OE(We[US](),function(){return"AppInsightsCore:track"},function(){null===st&&(yn(st),yh("Invalid telemetry item")),!st[If]&&tn(st[If])&&(yn(st),yh("telemetry name required")),st[ky]=st[ky]||Qt,st[uE]=st[uE]||_0(new Date),st.ver=st.ver||"4.0",!W&&We[Cf]()&&Kt===My.ACTIVE?pi()[eu](st):Kt!==My[q8]&&u[qr]<=lt&&u[Io](st)},function(){return{item:st}},!st.sync)},We[Y4]=pi,We[W4]=function(){return h||(h=new OX(o.cfg),We._notificationManager=h),h},We[RS]=function(st){We.getNotifyMgr()[RS](st)},We[j2]=function(st){h&&h[j2](st)},We.getCookieMgr=function(){return T=T||Pf(o.cfg,We[Ms])},We.setCookieMgr=function(st){T!==st&&(PE(T,!1),T=st)},We[US]=function(){return g||w||null},We.setPerfMgr=function(st){g=st},We.eventCnt=function(){return u[qr]},We.releaseQueue=function(){var st;i&&0<u[qr]&&(st=u,u=[],2===Kt?Hn(st,function(Ut){Ut[ky]=Ut[ky]||Qt,pi()[eu](Ut)}):En(l,2,20,"core init status is not active"))},We[hE]=function(st){return ge=st||null,Sn=!1,xt&&xt[u0](),sr(!0)},We[G8]=function(){Sn=!0,xt&&xt[u0](),Fr()},IE(We,function(){return ue},["addTelemetryInitializer"]),We[Oy]=function(st,Ut,Jt){void 0===st&&(st=!0),i||yh("SDK is not initialized"),W&&yh(rU),(oe={reason:50})[pE]=st,oe.flushComplete=!1;var oe,ne,X=oe,ie=(st&&!Ut&&(ne=rd(function(ye){Ut=ye})),Kk(Wr(),We));return ie[q2](function(){et.run(We[Ms]),Pq([T,h,l],st,function(){dt(),Ut&&Ut(X)})},We),Fr(),So(st,function(ye){X.flushComplete=ye,W=!0,Re.run(ie,X),We[G8](),ie[eu](X)},6,Jt),ne},We[$2]=ar,We.addPlugin=function(st,Ut,Jt,oe){var ne,X,ie;function ye(){P[Io](st),X.added=[st],Qn(X),oe&&oe(!0)}st?(ne=ar(st[Um]))&&!Ut?(oe&&oe(!1),Ht("Plugin ["+st[Um]+"] is already loaded!")):(X={reason:16},ne?zn(ie=[ne.plugin],{reason:2,isAsync:!!Jt},function(De){De?(X.removed=ie,X.reason|=32,ye()):oe&&oe(!1)}):ye()):(oe&&oe(!1),Ht(Yq))},We.updateCfg=function(st,Ut){var Jt,oe;void 0===Ut&&(Ut=!0),We[Cf]()&&(Jt={reason:1,cfg:o.cfg,oldCfg:G4({},o.cfg),newConfig:G4({},st),merge:Ut},(st=Jt.newConfig)[g0]=(oe=o.cfg)[g0],st[m0]=oe[m0]),o._block(function(ne){var X=ne.cfg;iU(ne,X,st,Ut),Ut||Pi(X,function(ie){Fm(st,ie)||ne.set(X,ie,np)}),ne[l0](X,Qq)},!0),o[a0](),Jt&&Ao(Jt)},We.evtNamespace=function(){return we},We.flush=So,We.getTraceCtx=function(st){return St=St||function qq(a){var o={};return{getName:function(){return o[If]},setName:function(i){a&&a.setName(i),o[If]=i},getTraceId:function(){return o[tB]},setTraceId:function(i){a&&a.setTraceId(i),qk(i)&&(o[tB]=i)},getSpanId:function(){return o[Z2]},setSpanId:function(i){a&&a.setSpanId(i),Gk(i)&&(o[Z2]=i)},getTraceFlags:function(){return o[nB]},setTraceFlags:function(i){a&&a.setTraceFlags(i),o[nB]=i}}}()},We.setTraceCtx=function(st){St=st||null},We.addUnloadHook=gr,yk(We,"addUnloadCb",function(){return Re},"add"),We.onCfgChange=function(st){return st=i?xa(o.cfg,st,We[Ms]):function Use(a,o){var i=A0(a,o).l;return i||a[Io](i={w:o,rm:function(){var l=A0(a,o);-1!==l.i&&a[lE](l.i,1)}}),i}(Le,st),function Hse(a){return eo({rm:function(){a.rm()}},"toJSON",{v:function(){return"aicore::onCfgChange<"+JSON.stringify(a)+">"}})}(st)},We.getWParam=function(){return x8()||o.cfg.enableWParam?0:-1}})}return a.__ieDyn=1,a}();function oU(a,o){try{if(a&&""!==a){var i=ip().parse(a);if(i&&i[Q8]&&i[Q8]>=i.itemsAccepted&&i.itemsReceived-i.itemsAccepted===i.errors[qr])return i}}catch(l){En(o,1,43,"Cannot parse the response. "+(l[If]||Mn(l)),{response:a})}return null}var WX="&NoResponseBody=true",Xq="POST",Gse=function(){function a(){var o,i,l,u,h,g,w,T,D,P,N,z,W,ue=0;ko(a,this,function(ge,we){var Re=!0;function et(Ne,lt){En(l,2,26,"Failed to send telemetry.",{message:Ne}),St(lt,400,{})}function Mt(Ne){et("No endpoint url is provided for the batch",Ne)}function St(Ne,lt,It,xt){try{Ne&&Ne(lt,It,xt)}catch{}}function Qt(Ne,lt){var It,xt=Xd();return(It=Ne[kS])?(It=Ne[kS]+(z?WX:""),Ne=Ne[yE],Ne=u?Ne:new Blob([Ne],{type:"text/plain;charset=UTF-8"}),xt.sendBeacon(It,Ne)):(Mt(lt),!0)}function Le(Ne,lt,It){var xt,ln=Ne[yE];try{ln&&(Qt(Ne,lt)?St(lt,200,{},""):(xt=h&&h.beaconOnRetry)&&$r(xt)?xt(Ne,lt,Qt):(w&&w[X8](Ne,lt,!0),En(l,2,40,". Failed to send telemetry with Beacon API, retried with normal sender.")))}catch(Sn){u&&E0(l,"Failed to send telemetry using sendBeacon API. Ex:"+Mn(Sn)),St(lt,u?0:400,{},"")}}function Je(Ne,lt,It){var xt,ln,Sn,We,on=Ne[Y2]||{},Rn=(!It&&o&&(xt=rd(function(nn,dt){ln=nn,Sn=dt})),u&&It&&Ne.disableXhrSync&&(It=!1),Ne[kS]);if(Rn)return We=function AB(a,o,i,l,u,h){function g(T,D,P){try{T[D]=P}catch{}}void 0===l&&(l=!1),void 0===u&&(u=!1);var w=new XMLHttpRequest;return l&&g(w,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",l),i&&g(w,eX,i),w.open(a,o,!u),i&&g(w,eX,i),!u&&h&&g(w,"timeout",h),w}(Xq,Rn,Re,!0,It,Ne[d0]),u||We[J8]("Content-type","application/json"),Hn(Kd(on),function(nn){We[J8](nn,on[nn])}),We.onreadystatechange=function(){u||(sr(We),4===We.readyState&&ln&&ln(!0))},We.onload=function(){u&&sr(We)},We.onerror=function(nn){St(lt,u?We[h0]:400,HS(We,u),u?"":_k(We)),Sn&&Sn(nn)},We.ontimeout=function(){St(lt,u?We[h0]:500,HS(We,u),u?"":_k(We)),ln&&ln(!1)},We.send(Ne[yE]),xt;function sr(nn){var dt=h&&h.xhrOnComplete;dt&&$r(dt)?dt(nn,lt,Ne):(dt=bl(nn),St(lt,nn[h0],HS(nn,u),dt))}Mt(lt),ln&&ln(!1)}function ot(Ne,lt,It){var xt,ln,Sn,We=Ne[kS],nn=Ne[yE],on=u?nn:new Blob([nn],{type:"application/json"}),Rn=new Headers,sr=nn[qr],dt=(nn=!1,!1),pi=Ne[Y2]||{},Qn=((on={method:Xq,body:on})[Rq]=!0,Ne.headers&&0<Kd(Ne.headers)[qr]&&(Hn(Kd(pi),function(zn){Rn.append(zn,pi[zn])}),on[Y2]=Rn),Re&&u&&(on.credentials="include"),It&&(on.keepalive=!0,ue+=sr,u?2===Ne._sendReason&&(nn=!0,z)&&(We+=WX):nn=!0),new Request(We,on));try{Qn[Rq]=!0}catch{}if(!It&&o&&(xt=rd(function(zn,Fr){ln=zn,Sn=Fr})),We){try{Df(fetch(u?We:Qn,u?on:null),function(zn){if(It&&(ue-=sr,sr=0),!dt)if(dt=!0,zn.rejected)ar(zn.reason&&zn.reason[ep]),Sn&&Sn(zn.reason);else{var Fr=zn[H2];try{u||Fr.ok?u&&!Fr.body?(Wr(Fr,null,""),ln&&ln(!0)):Df(Fr.text(),function(So){Wr(Fr,Ne,So[H2]),ln&&ln(!0)}):(ar(Fr.statusText),ln&&ln(!1))}catch(So){ar(Mn(So)),Sn&&Sn(So)}}})}catch(zn){dt||(ar(Mn(zn)),Sn&&Sn(zn))}return nn&&!dt&&(dt=!0,St(lt,200,{}),ln)&&ln(!0),u&&!dt&&0<Ne[d0]&&W&&W.set(function(){dt||(dt=!0,St(lt,500,{}),ln&&ln(!0))},Ne[d0]),xt}function ar(zn){St(lt,u?0:400,{},u?"":zn)}function Wr(zn,Fr,So){var Ao=zn[h0],Ht=h.fetchOnComplete;Ht&&$r(Ht)?Ht(zn,lt,So||"",Fr):St(lt,Ao,{},So||"")}Mt(lt),ln&&ln(!1)}function Et(Ne,lt,It){var Sn=Ru(),xt=new XDomainRequest,ln=Ne[yE],We=(xt.onload=function(){var on=bl(xt),Rn=h&&h.xdrOnComplete;Rn&&$r(Rn)?Rn(xt,lt,Ne):St(lt,200,{},on)},xt.onerror=function(){St(lt,400,{},u?"":v0(xt))},xt.ontimeout=function(){St(lt,500,{})},xt.onprogress=function(){},Sn=Sn&&Sn.location&&Sn.location[W8]||"",Ne[kS]);We?u||0===We.lastIndexOf(Sn,0)?(Sn=u?We:We[Ly](/^(https?:)/,""),xt.open(Xq,Sn),Ne[d0]&&(xt[d0]=Ne[d0]),xt.send(ln),u&&It?W&&W.set(function(){xt.send(ln)},0):xt.send(ln)):(En(l,2,40,". "+(We="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.")),et(We,lt)):Mt(lt)}function Kt(){ue=0,z=N=P=D=T=o=i=!1,W=w=g=h=u=l=null}Kt(),ge[cE]=function(Ne,lt){l=lt,i&&En(l,1,28,"Sender is already initialized"),ge.SetConfig(Ne),i=!0},ge._getDbgPlgTargets=function(){return[i,u,g,o]},ge.SetConfig=function(Ne){try{var lt;return h=Ne.senderOnCompleteCallBack||{},o=!!Ne.enableSendPromise,T=!!Ne.disableXhr,D=!!Ne.disableBeacon,P=!!Ne.disableBeaconSync,W=Ne.timeWrapper,z=!!Ne.addNoResponse,N=!!Ne.disableFetchKeepAlive,w={sendPOST:Je},(u=!!Ne.isOneDs)||(Re=!1),(g=!!Ne.disableCredentials)&&(lt=rp())&&lt.protocol&&"file:"===lt.protocol[Tf]()&&(Re=!1),!0}catch{}return!1},ge.getSyncFetchPayload=function(){return ue},ge.getSenderInst=function(Ne,lt){if(Ne&&Ne[qr]){for(var It=Ne,xt=lt,ln=0,Sn=null,We=0;null==Sn&&We<It[qr];)ln=It[We],T||1!==ln?2!==ln||!NB(xt)||xt&&N?3!==ln||!DE()||(xt?P:D)||(Sn=Le):Sn=ot:(AE=null===AE&&(AE=typeof XDomainRequest!==OS)&&$S()?AE&&!Eq(hs(vk),"withCredentials"):AE)?Sn=Et:$S()&&(Sn=Je),We++;return Sn?((Ne={_transport:ln,_isSync:xt})[X8]=Sn,Ne):null}return null},ge.getFallbackInst=function(){return w},ge[K2]=function(Ne,lt){Kt()}})}return a.__ieDyn=1,a}(),Jq="on",YX="attachEvent",Zk="addEventListener",Zm="detachEvent",eG="removeEventListener",sU="events",ru="visibilitychange",LE="pagehide",nG="beforeunload",Qk=ku("aiEvtPageHide"),rG=(ku("aiEvtPageShow"),/\.[\.]+/g),Qm=/[\.]+$/,D0=1,eA=Tk("events"),iG=/^([^.]*)(?:\.(.+)|)/;function oG(a){return a&&a[Ly]?a[Ly](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Ni):a}function tA(u,l){var i;return l&&(i=Ni,Di(l)?(i=Ni,Hn(l,function(h){(h=oG(h))&&("."!==h[0]&&(h="."+h),i+=h)})):i=oG(l),i)&&("."!==i[0]&&(i="."+i),u=(u||Ni)+i),l=iG.exec(u||Ni)||[],(u={})[Hm]=l[1],u.ns=(l[2]||Ni).replace(rG,".").replace(Qm,Ni)[gE](".").sort().join("."),u}function sG(a,o,i){return(a=eA.get(a,sU,{},i=void 0===i||i))[o]||(a[o]=[])}function aG(a,o,i,l){a&&o&&o[Hm]&&(a[eG]?a[eG](o[Hm],i,l):a[Zm]&&a[Zm](Jq+o[Hm],i))}function cG(a,o,i,l){for(var u=o[qr];u--;){var h=o[u];!h||i.ns&&i.ns!==h.evtName.ns||l&&!l(h)||(aG(a,h.evtName,h[Q4],h.capture),o[lE](u,1))}}function lp(a,o){var i=o?tA("xx",i=Di(o)?[a].concat(o):[a,o]).ns[gE]("."):a;return i}function Nu(a,o,i,l,u){void 0===u&&(u=!1);var h,g=!1;if(a)try{var w,T=tA(o,l);(g=function lG(a,o,i,l){var u=!1;return a&&o&&o[Hm]&&i&&(a[Zk]?(a[Zk](o[Hm],i,l),u=!0):a[YX]&&(a[YX](Jq+o[Hm],i),u=!0)),u}(a,T,i,u))&&eA.accept(a)&&((h={guid:D0++,evtName:T})[Q4]=i,h.capture=u,w=h,sG(a,T.type)[Io](w))}catch{}return g}function Fa(a,o,i,l,u){if(void 0===u&&(u=!1),a)try{var h=tA(o,l),g=!1;(function uG(a,o,i){var l;o[Hm]?cG(a,sG(a,o[Hm]),o,i):(Pi(l=eA.get(a,sU,{}),function(u,h){cG(a,h,o,i)}),0===Kd(l)[qr]&&eA.kill(a,sU))})(a,h,function(w){return!((!h.ns||i)&&w[Q4]!==i)&&(g=!0)}),g||aG(a,h,i,u)}catch{}}function Us(a,o,i,l){var u=!1;return o&&a&&0<a[qr]&&Hn(a,function(h){!h||i&&-1!==Ec(i,h)||(u=function ds(a,o,i){var u,l=!1;return(u=Ru())&&(l=Nu(u,a,o,i),l=Nu(u.body,a,o,i)||l),(u=Jl())&&Nu(u,a,o,i)||l}(h,o,l)||u)}),u}function aU(a,o,i){a&&Di(a)&&Hn(a,function(l){l&&function wh(a,o,i){var l;(l=Ru())&&(Fa(l,a,o,i),Fa(l.body,a,o,i)),(l=Jl())&&Fa(l,a,o,i)}(l,o,i)})}function lU(a,o,i){var l=lp(Qk,i),u=Us([LE],a,o,l);return!(u=o&&-1!==Ec(o,ru)?u:Us([ru],function(h){var g=Jl();a&&g&&"hidden"===g.visibilityState&&a(h)},o,l)||u)&&o?lU(a,null,i):u}var eJ="_aiHooks",tJ=["req","rsp","hkErr","fnErr"];function FE(a,o){if(a)for(var i=0;i<a[qr]&&!o(a[i],i);i++);}function VE(a,o,i,l,u){0<=u&&u<=2&&FE(a,function(w,g){var T=(w=w.cbks)[tJ[u]];if(T){o.ctx=function(){return l[g]=l[g]||{}};try{T[Jd](o.inst,i)}catch(P){T=o.err;try{var D=w[tJ[2]];D&&(o.err=P,D[Jd](o.inst,i))}catch{}finally{o.err=T}}}})}function Lu(a,o,i,l){var u=null;return a&&(Oa(a,o)?u=a:i&&(u=Lu(JQ(a),o,l,!1))),u}function nJ(h,o,i,l){var u=i&&i[eJ];return u||((i=function Xk(a){return function(){var o=arguments,i=a.h,l=((u={})[If]=a.n,u.inst=this,u.ctx=null,u.set=function(T,D){(o=g([],o))[T]=D,h=g([l],o)},u),u=[],h=g([l],o);function g(T,D){return FE(D,function(P){T[Io](P)}),T}l.evt=hs("event"),VE(i,l,h,u,0);var w=a.f;if(w)try{l.rslt=w[Jd](this,o)}catch(T){throw l.err=T,VE(i,l,h,u,3),T}return VE(i,l,h,u,1),l.rslt}}(u={i:0,n:o,f:i,h:[]}))[eJ]=u,h[o]=i),h={id:u.i,cbks:l,rm:function(){var g=this.id;FE(u.h,function(w,T){if(w.id===g)return u.h[lE](T,1),1})}},u.i++,u.h[Io](h),h}function hG(a,o,i,l,u){return void 0===l&&(l=!0),a&&o&&i&&(a=Lu(a,o,l,u))&&typeof(l=a[o])===eq?nJ(a,o,l,i):null}function uU(a,o,i,l,u){return a&&o&&i&&(l=Lu(a,o,l,u)||a)?nJ(l,o,l[o],i):null}var Jk="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",dG="sampleRate",eO="ProcessLegacy",pG="http.method",hU="https://dc.services.visualstudio.com",nA="/v2/track",Ta="not_specified",rA="iKey",rs=function tl(a){return function TQ(a){var o={};return Pi(a,function(i,l){CS(o,i,l[1]),CS(o,l[0],l[1])}),Ay(o)}(a)}({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]}),BE="split",li="length",iA="toLowerCase",cp="ingestionendpoint",UE="toString",od="push",lo="removeItem",di="name",qy="message",Xm="count",up="preTriggerDate",zE="disabled",bh="interval",fG="daysOfMonth",ua="date",dU="getUTCDate",$o="stringify",pU="pathname",oA="correlationHeaderExcludePatterns",jE="exceptions",Fu="parsedStack",Rf="properties",Mf="measurements",Gy="sizeInBytes",sd="typeName",P0="severityLevel",fU="problemGroup",tO="isManual",mG="CreateFromInterface",HE="assembly",R0="fileName",nO="hasFullStack",sA="level",$E="method",qE="line",M0="duration",GE="receivedResponse";function gG(a,o,i){var l=o[li],u=function rJ(a,o){var i;return o&&150<(o=Ea(Xc(o)))[li]&&(i=Yd(o,0,150),En(a,2,57,"name is too long.  It has been truncated to 150 characters.",{name:o},!0)),i||o}(a,o);if(u[li]!==l){for(var h=0,g=u;void 0!==i[g];)h++,g=Yd(u,0,147)+oJ(h);u=g}return u}function ha(a,o,i){var l;return void 0===i&&(i=1024),o&&(i=i||1024,(o=Ea(Xc(o)))[li]>i)&&(l=Yd(o,0,i),En(a,2,61,"string value is too long. It has been truncated to "+i+" characters.",{value:o},!0)),l||o}function aA(a,o){return rO(a,o,2048,66)}function yG(a,o){var i;return o&&32768<o[li]&&(i=Yd(o,0,32768),En(a,2,56,"message is too long, it has been truncated to 32768 characters.",{message:o},!0)),i||o}function k0(a,o){var i;return o&&(i={},Pi(o,function(l,u){if(Ar(u)&&wk())try{u=ip()[$o](u)}catch(h){En(a,2,49,"custom property is not valid",{exception:h},!0)}u=ha(a,u,8192),l=gG(a,l,i),i[l]=u}),o=i),o}function O0(a,o){var i;return o&&(i={},Pi(o,function(l,u){l=gG(a,l,i),i[l]=u}),o=i),o}function rO(a,o,i,l){var u;return o&&(o=Ea(Xc(o)))[li]>i&&(u=Yd(o,0,i),En(a,2,l,"input is too long, it has been truncated to "+i+" characters.",{data:o},!0)),u||o}function oJ(a){return Dy(a="00"+a,a[li]-3)}var _G=Jl()||{},vG=0,gU=[null,null,null,null,null];function lA(a){var o=vG,i=gU,l=i[o];return _G.createElement?i[o]||(l=i[o]=_G.createElement("a")):l={host:Kse(a,!0)},l.href=a,++o>=i[li]&&(o=0),vG=o,l}function Kse(a,o){return(a=bG(a,o)||"")&&null!=(o=a.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i))&&3<o[li]&&xr(o[2])&&0<o[2][li]?o[2]+(o[3]||""):a}function bG(a,o){var i=null;return a&&null!=(a=a.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i))&&2<a[li]&&xr(a[2])&&0<a[2][li]&&(i=a[2]||"",o)&&2<a[li]&&(o=(a[1]||"")[iA](),a=a[3]||"",i+=a="http"===o&&":80"===a||"https"===o&&":443"===a?"":a),i}var yU=[hU+nA,"https://breeze.aimon.applicationinsights.io"+nA,"https://dc-int.services.visualstudio.com"+nA];function hp(a){return-1!==Ec(yU,a[iA]())}function xG(a,o,g){if(!o||a&&a.disableCorrelationHeaders)return!1;if(a&&a[oA])for(var l=0;l<a.correlationHeaderExcludePatterns[li];l++)if(a[oA][l].test(o))return!1;var h,u=lA(o).host[iA]();if(!u||-1===ec(u,":443")&&-1===ec(u,":80")||(u=(bG(o,!0)||"")[iA]()),(!a||!a.enableCorsCorrelation)&&u&&u!==g)return!1;if((g=a&&a.correlationHeaderDomains)&&(Hn(g,function(T){T=new RegExp(T.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")),h=h||T.test(u)}),!h))return!1;var w=a&&a.correlationHeaderExcludedDomains;if(!w||0===w[li])return!0;for(l=0;l<w[li];l++)if(new RegExp(w[l].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")).test(u))return!1;return u&&0<u[li]}function _U(a){if(a&&(a=function aJ(a,o){if(a)for(var i=a[BE](","),l=0;l<i[li];++l){var u=i[l][BE]("=");if(2===u[li]&&u[0]===o)return u[1]}}(a,rs[1]))&&"cid-v1:"!==a)return a}function uA(){var a=Bm();return a&&a.now&&a.timing&&0<(a=a.now()+a.timing.navigationStart)?a:xf()}function Eh(a,o){return 0===a||0===o||tn(a)||tn(o)?null:o-a}function dp(a,o){var i=a||{};return{getName:function(){return i[di]},setName:function(l){o&&o.setName(l),i[di]=l},getTraceId:function(){return i.traceID},setTraceId:function(l){o&&o.setTraceId(l),qk(l)&&(i.traceID=l)},getSpanId:function(){return i.parentID},setSpanId:function(l){o&&o.setSpanId(l),Gk(l)&&(i.parentID=l)},getTraceFlags:function(){return i.traceFlags},setTraceFlags:function(l){o&&o.setTraceFlags(l),i.traceFlags=l}}}var hA=j8({LocalStorage:0,SessionStorage:1}),Jm=void 0,kf=void 0,iO="";function vU(){return Ky()?oO(hA.LocalStorage):null}function oO(a){try{if(tn(Pu()))return null;var o=(new Date)[UE](),i=hs(a===hA.LocalStorage?"localStorage":"sessionStorage"),l=iO+o,u=(i.setItem(l,o),i.getItem(l)!==o);if(i[lo](l),!u)return i}catch{}return null}function TG(){return dA()?oO(hA.SessionStorage):null}function CG(){kf=Jm=!1}function wU(a){iO=a||""}function lJ(){Jm=Ky(!0),kf=dA(!0)}function Ky(a){return Jm=a||void 0===Jm?!!oO(hA.LocalStorage):Jm}function cJ(a,o){var i=vU();if(null!==i)try{return i.getItem(o)}catch(l){Jm=!1,En(a,2,1,"Browser failed read of local storage. "+to(l),{exception:Mn(l)})}return null}function ad(a,o,i){var l=vU();if(null!==l)try{return l.setItem(o,i),!0}catch(u){Jm=!1,En(a,2,3,"Browser failed write to local storage. "+to(u),{exception:Mn(u)})}return!1}function dA(a){return kf=a||void 0===kf?!!oO(hA.SessionStorage):kf}function bU(a,o){var i=TG();if(null!==i)try{return i.getItem(o)}catch(l){kf=!1,En(a,2,2,"Browser failed read of session storage. "+to(l),{exception:Mn(l)})}return null}function IG(a,o,i){var l=TG();if(null!==l)try{return l.setItem(o,i),!0}catch(u){kf=!1,En(a,2,4,"Browser failed write to session storage. "+to(u),{exception:Mn(u)})}return!1}function EU(a,o){var i=TG();if(null!==i)try{return i[lo](o),!0}catch(l){kf=!1,En(a,2,6,"Browser failed removal of session storage item. "+to(l),{exception:Mn(l)})}return!1}var dJ=function(a,o){var i,l,u,h,g,w,T,D=this,P=!1,N=!1;function z(Je,ot,Et,Kt){if(P){if(!function(Rn){try{var sr=W(Rn);return function Ase(a){return 0<a?Math.floor(xk()/qm*(a+1))>>>0:0}(1e6)<=sr.limit.samplingRate}catch{}return!1}(Je))return;var Ne=W(Je),lt=St(Je),It=ge(Ne,i,lt),xt=!1,ln=0,Sn=Qt(Je);try{It&&!Sn?(ln=Math.min(Ne.limit.maxSendNumber,lt[Xm]+1),xt=!(lt[Xm]=0),g[Je]=!0,lt[up]=new Date):(g[Je]=It,lt[Xm]+=1);var We=we(Je);et(l,We,lt);for(var on=0;on<ln;on++)En(l,Et||1,Je,ot)}catch{}return{isThrottled:xt,throttleNum:ln}}return Kt&&Le(Je)[od]({msgID:Je,message:ot,severity:Et}),null}function W(Je){return u[Je]||u[109]}function ue(Je,ot){var Et,Kt,ln,Sn,We;try{var Ne=ot||{},lt={},It=(lt[zE]=!!Ne[zE],Ne[bh]||{}),xt=(N=(null===It?void 0:It.daysOfMonth)&&0<(null===It?void 0:It.daysOfMonth[li]),lt[bh]=(Sn=null==(ln=(ln=It)||{})?void 0:ln.monthInterval,We=ln?.dayInterval,tn(Sn)&&tn(We)&&(ln.monthInterval=3,N||(ln[fG]=[28],N=!0)),{monthInterval:ln?.monthInterval,dayInterval:ln?.dayInterval,daysOfMonth:ln?.daysOfMonth}),{samplingRate:(null==(Et=Ne.limit)?void 0:Et.samplingRate)||100,maxSendNumber:(null==(Kt=Ne.limit)?void 0:Kt.maxSendNumber)||1});lt.limit=xt,u[Je]=lt}catch{}}function ge(Je,ot,Et){var Kt,Ne;return!(!Je||Je[zE]||!ot||!y0(Et))&&(ot=Re(),Et=Et[ua],Kt=1,null!=(Je=Je[bh])&&Je.monthInterval&&(Ne=12*(ot.getUTCFullYear()-Et.getUTCFullYear())+ot.getUTCMonth()-Et.getUTCMonth(),Kt=Mt(Je.monthInterval,0,Ne)),Ne=1,N?Ne=Ec(Je[fG],ot[dU]()):null!=Je&&Je.dayInterval&&(ot=Math.floor((ot.getTime()-Et.getTime())/864e5),Ne=Mt(Je.dayInterval,0,ot)),0<=Kt)&&0<=Ne}function we(Je,ot){return ot=y0(ot)?ot:"",Je?"appInsightsThrottle"+ot+"-"+Je:null}function Re(Je){try{if(!Je)return new Date;var ot=new Date(Je);if(!isNaN(ot.getDate()))return ot}catch{}return null}function et(Je,ot,Et){try{return ad(Je,ot,Ea(JSON[$o](Et)))}catch{}}function Mt(Je,ot,Et){return Je<=0?1:ot<=Et&&(Et-ot)%Je==0?Math.floor((Et-ot)/Je)+1:-1}function St(Je){try{var ot,Et=h[Je];return Et||(ot=we(Je,w),Et=function(Kt,Ne,lt){try{var It,xt={date:Re(),count:0};return Kt?{date:Re((It=JSON.parse(Kt))[ua])||xt[ua],count:It[Xm]||xt[Xm],preTriggerDate:It.preTriggerDate?Re(It[up]):void 0}:(et(Ne,lt,xt),xt)}catch{}return null}(cJ(l,ot),l,ot),h[Je]=Et),h[Je]}catch{}return null}function Qt(Je){var ot,Et=g[Je];return tn(Et)&&(Et=!1,(ot=St(Je))&&(Et=function(Kt){try{var Ne;if(Kt)return Ne=new Date,Kt.getUTCFullYear()===Ne.getUTCFullYear()&&Kt.getUTCMonth()===Ne.getUTCMonth()&&Kt[dU]()===Ne[dU]()}catch{}return!1}(ot[up])),g[Je]=Et),g[Je]}function Le(Je){return tn((T=T||{})[Je])&&(T[Je]=[]),T[Je]}l=Uy(a),g={},h={},T={},u={},ue(109),w=y0(o)?o:"",a.addUnloadHook(xa(a.config,function(Je){Je=Je.cfg,i=Ky(),Pi(Je.throttleMgrCfg||{},function(ot,Et){ue(parseInt(ot),Et)})})),D._getDbgPlgTargets=function(){return[T]},D.getConfig=function(){return u},D.canThrottle=function(Je){var ot=St(Je);return ge(W(Je),i,ot)},D.isTriggered=Qt,D.isReady=function(){return P},D.flush=function(Je){try{var ot,Et=Le(Je);if(Et&&0<Et[li])return ot=Et.slice(0),T[Je]=[],Hn(ot,function(Kt){z(Kt.msgID,Kt[qy],Kt.severity,!1)}),!0}catch{}return!1},D.flushAll=function(){try{var Je;if(T)return Je=!0,Pi(T,function(ot){ot=D.flush(parseInt(ot)),Je=Je&&ot}),Je}catch{}return!1},D.onReadyState=function(Je,ot){return void 0===ot&&(ot=!0),(P=!!tn(Je)||Je)&&ot?D.flushAll():null},D.sendMessage=function(Je,ot,Et){return z(Je,ot,Et,!0)}};function SG(a){return a?(a=a[BE](";"),a=DQ(a,function(i,h){return 2===(h=h[BE]("="))[li]&&(i[h[0][iA]()]=h=h[1]),i},{}),0<Kd(a)[li]&&(a.endpointsuffix&&(a[cp]=a[cp]||"https://"+(a.location?a.location+".":"")+"dc."+a.endpointsuffix),a[cp]=a[cp]||hU,V8(a[cp],"/"))&&(a[cp]=a[cp].slice(0,-1)),a):{}}var mJ=function(a,o,i){var l=this;this.ver=1,this.sampleRate=100,this.tags={},this[di]=ha(a,i)||Ta,this.data=o,this.time=_0(new Date),this.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return 100===l.sampleRate?4:1},tags:1,data:1}},Wy=function(){function a(o,i,l,u){this.aiDataContract={ver:1,name:1,properties:0,measurements:0},this.ver=2,this[di]=ha(o,i)||Ta,this[Rf]=k0(o,l),this[Mf]=O0(o,u)}return a.envelopeType="Microsoft.ApplicationInsights.{0}.Event",a.dataType="EventData",a}(),KE="error",Vu="stack",xU="stackDetails",AG="errorSrc",TU="message",DG="description";function sO(a,o){var i=a;return i&&!xr(i)&&(JSON&&JSON[$o]?(i=JSON[$o](a),!o||i&&"{}"!==i||(i=$r(a[UE])?a[UE]():""+a)):i=a+" - (Missing JSON.stringify)"),i||""}function PG(a,o){var i=a;return a&&((i=i&&!xr(i)&&(a[TU]||a[DG])||i)&&!xr(i)&&(i=sO(i,!0)),a.filename)&&(i=i+" @"+(a.filename||"")+":"+(a.lineno||"?")+":"+(a.colno||"?")),(i=o&&"String"!==o&&"Object"!==o&&"Error"!==o&&-1===ec(i||"",o)?o+": "+i:i)||""}function aO(a){return a&&a.src&&xr(a.src)&&a.obj&&Di(a.obj)}function eg(o){var i=(o=xr(o=o||"")?o:xr(o[Vu])?o[Vu]:""+o)[BE]("\n");return{src:o,obj:i}}function vJ(a){var o,i=null;if(a)try{a[Vu]?i=eg(a[Vu]):a[KE]&&a[KE][Vu]?i=eg(a[KE][Vu]):a.exception&&a.exception[Vu]?i=eg(a.exception[Vu]):aO(a)?i=a:aO(a[xU])?i=a[xU]:Ru()&&Ru().opera&&a[TU]?i=function Wse(a){for(var o=[],i=a[BE]("\n"),l=0;l<i[li];l++){var u=i[l];i[l+1]&&(u+="@"+i[l+1],l++),o[od](u)}return{src:a,obj:o}}(a[qy]):a.reason&&a.reason[Vu]?i=eg(a.reason[Vu]):xr(a)?i=eg(a):(o=a[TU]||a[DG]||"",xr(a[AG])&&(o&&(o+="\n"),o+=" from "+a[AG]),o&&(i=eg(o)))}catch(l){i=eg(l)}return i||{src:"",obj:null}}function lO(a){var o="";if(a&&!(o=a.typeName||a[di]||""))try{var i=/function (.{1,200})\(/.exec(a.constructor[UE]());o=i&&1<i[li]?i[1]:""}catch{}return o}function CU(a){if(a)try{var o,i;if(!xr(a))return o=lO(a),(i=sO(a,!1))&&"{}"!==i||(a[KE]&&(o=lO(a=a[KE])),i=sO(a,!0)),0!==ec(i,o)&&"String"!==o?o+":"+i:i}catch{}return""+(a||"")}var cd=function(){function a(o,i,l,u,h,g){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var w=this;w.ver=2,function _J(a){try{if(Ar(a))return"ver"in a&&"exceptions"in a&&"properties"in a}catch{}return!1}(i)?(w[jE]=i[jE]||[],w[Rf]=i[Rf],w[Mf]=i[Mf],i[P0]&&(w[P0]=i[P0]),i.id&&(w.id=i.id,i[Rf].id=i.id),i[fU]&&(w[fU]=i[fU]),tn(i[tO])||(w[tO]=i[tO])):(l=l||{},g&&(l.id=g),w[jE]=[new wJ(o,i,l)],w[Rf]=k0(o,l),w[Mf]=O0(o,u),h&&(w[P0]=h),g&&(w.id=g))}return a.CreateAutoException=function(o,i,l,u,h,g,w,T){var D=lO(h||g||o),P={};return P[qy]=PG(o,D),P.url=i,P.lineNumber=l,P.columnNumber=u,P.error=CU(h||g||o),P.evt=CU(g||o),P[sd]=D,P.stackDetails=vJ(w||h||g),P.errorSrc=T,P},a.CreateFromInterface=function(o,i,l,u){var h=i[jE]&&DS(i[jE],function(g){return wJ[mG](o,g)});return new a(o,tu(tu({},i),{exceptions:h}),l,u)},a.prototype.toInterface=function(){var o=this.properties,i=this.measurements,l=this.severityLevel,u=this.problemGroup,h=this.id,g=this.isManual,w=(w=this.exceptions)instanceof Array&&DS(w,function(D){return D.toInterface()})||void 0,T={ver:"4.0"};return T[jE]=w,T.severityLevel=l,T.properties=o,T.measurements=i,T.problemGroup=u,T.id=h,T.isManual=g,T},a.CreateSimpleException=function(o,i,l,u,h,g){var w;return{exceptions:[((w={})[nO]=!0,w.message=o,w.stack=h,w.typeName=i,w)]}},a.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",a.dataType="ExceptionData",a.formatError=CU,a}(),wJ=function(){function a(o,i,l){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var u,h,g=this;!function yJ(a){try{if(Ar(a))return"hasFullStack"in a&&"typeName"in a}catch{}return!1}(i)?(h=(u=i)&&u.evt,E2(u)||(u=u[KE]||h||u),g[sd]=ha(o,lO(u))||Ta,g[qy]=yG(o,PG(i||u,g[sd]))||Ta,h=i[xU]||vJ(i),g[Fu]=function RG(a){if((a=a.obj)&&0<a[li]){var o=[],i=0,l=0;if(Hn(a,function(P){P=P[UE](),cO.regex.test(P)&&(P=new cO(P,i++),l+=P[Gy],o[od](P))}),32768<l)for(var u=0,h=o[li]-1,g=0,w=u,T=h;u<h;){if(32768<(g+=o[u][Gy]+o[h][Gy])){o.splice(w,T-w+1);break}w=u,T=h,u++,h--}}return o}(h),Di(g[Fu])&&DS(g[Fu],function(w){w[HE]=ha(o,w[HE]),w[R0]=ha(o,w[R0])}),g[Vu]=function mU(a,o){var i,l;return o&&32768<(l=""+o)[li]&&(i=Yd(l,0,32768),En(a,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:o},!0)),i||o}(o,function ld(a){var o="";return a&&(a.obj?Hn(a.obj,function(i){o+=i+"\n"}):o=a.src||""),o}(h)),g.hasFullStack=Di(g.parsedStack)&&0<g.parsedStack[li],l&&(l[sd]=l[sd]||g[sd])):(g[sd]=i[sd],g[qy]=i[qy],g[Vu]=i[Vu],g[Fu]=i[Fu]||[],g[nO]=i[nO])}return a.prototype.toInterface=function(){var o,i=this[Fu]instanceof Array&&DS(this[Fu],function(l){return l.toInterface()});return(o={id:this.id,outerId:this.outerId,typeName:this[sd],message:this[qy],hasFullStack:this[nO],stack:this[Vu]})[Fu]=i||void 0,o},a.CreateFromInterface=function(o,i){var l=i[Fu]instanceof Array&&DS(i[Fu],function(u){return cO[mG](u)})||i[Fu];return new a(o,tu(tu({},i),{parsedStack:l}))},a}(),cO=function(){function a(o,i){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var l,u=this;u[Gy]=0,"string"==typeof o?(l=o,u[sA]=i,u[$E]="<no_method>",u[HE]=Ea(l),u[R0]="",u[qE]=0,(i=l.match(a.regex))&&5<=i[li]&&(u[$E]=Ea(i[2])||u[$E],u[R0]=Ea(i[4]),u[qE]=parseInt(i[5])||0)):(u[sA]=o[sA],u[$E]=o[$E],u[HE]=o[HE],u[R0]=o[R0],u[qE]=o[qE],u[Gy]=0),u.sizeInBytes+=u.method[li],u.sizeInBytes+=u.fileName[li],u.sizeInBytes+=u.assembly[li],u[Gy]+=a.baseSize,u.sizeInBytes+=u.level.toString()[li],u.sizeInBytes+=u.line.toString()[li]}return a.CreateFromInterface=function(o){return new a(o,null)},a.prototype.toInterface=function(){return{level:this[sA],method:this[$E],assembly:this[HE],fileName:this[R0],line:this[qE]}},a.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,a.baseSize=58,a}(),Yse=function(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0},WE=function(){function a(o,i,l,u,h,g,w,T,D){this.aiDataContract={ver:1,metrics:1,properties:0},this.ver=2;var P=new Yse;P[Xm]=0<u?u:void 0,P.max=isNaN(g)||null===g?void 0:g,P.min=isNaN(h)||null===h?void 0:h,P[di]=ha(o,i)||Ta,P.value=l,P.stdDev=isNaN(w)||null===w?void 0:w,this.metrics=[P],this[Rf]=k0(o,T),this[Mf]=O0(o,D)}return a.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",a.dataType="MetricData",a}(),uO="";function Yy(h){(isNaN(h)||h<0)&&(h=0),h=Math.round(h);var o=uO+h%1e3,i=uO+Math.floor(h/1e3)%60,l=uO+Math.floor(h/6e4)%60,u=uO+Math.floor(h/36e5)%24;return(0<(h=Math.floor(h/864e5))?h+".":uO)+(u[li]<2?"0"+u:u)+":"+(l[li]<2?"0"+l:l)+":"+(i[li]<2?"0"+i:i)+"."+(1===o[li]?"00"+o:2===o[li]?"0"+o:o)}var Zy=function(){function a(o,i,l,u,h,g,w){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0},this.ver=2,this.id=function iJ(a,o){return o&&rO(a,o,128,69)[UE]()}(o,w),this.url=aA(o,l),this[di]=ha(o,i)||Ta,isNaN(u)||(this[M0]=Yy(u)),this[Rf]=k0(o,h),this[Mf]=O0(o,g)}return a.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",a.dataType="PageviewData",a}(),YE=function(){function a(o,ue,l,u,h,g,w,T,D,P,N,z){void 0===D&&(D="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var W=this;W.ver=2,W.id=ue,W[M0]=Yy(h),W.success=g,W.resultCode=w+"",W.type=ha(o,D),ue=function cA(a,o,i,l){var u,h,g,w=l,T=l;return w=o&&0<o[li]?(g=(u=lA(o)).host,w||(null!=u[pU]?("/"!==(h=0===u.pathname[li]?"/":u[pU]).charAt(0)&&(h="/"+h),T=u[pU],ha(a,i?i+" "+h:h)):ha(a,o))):g=l,{target:g,name:w,data:T}}(o,l,T,u),W.data=aA(o,u)||ue.data,W.target=ha(o,ue.target),P&&(W.target="".concat(W.target," | ").concat(P)),W[di]=ha(o,ue[di]),W[Rf]=k0(o,N),W[Mf]=O0(o,z)}return a.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",a.dataType="RemoteDependencyData",a}(),ZE=function(){function a(o,i,l,u,h){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0},this.ver=2,this[qy]=yG(o,i=i||Ta),this[Rf]=k0(o,u),this[Mf]=O0(o,h),l&&(this[P0]=l)}return a.envelopeType="Microsoft.ApplicationInsights.{0}.Message",a.dataType="MessageData",a}(),pA=function(){function a(o,i,l,u,h,g,w){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var T=this;T.ver=2,T.url=aA(o,l),T[di]=ha(o,i)||Ta,T[Rf]=k0(o,h),T[Mf]=O0(o,g),w&&(T.domProcessing=w.domProcessing,T[M0]=w[M0],T.networkConnect=w.networkConnect,T.perfTotal=w.perfTotal,T[GE]=w[GE],T.sentRequest=w.sentRequest)}return a.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",a.dataType="PageviewPerformanceData",a}(),tg=function(a,o){this.aiDataContract={baseType:1,baseData:1},this.baseType=a,this.baseData=o};function N0(a){var o="ai."+a+".";return function(i){return o+i}}var fA=N0("application"),rl=N0("device"),hO=N0("location"),ng=N0("operation"),IU=N0("session"),L0=N0("user"),F0=N0("cloud"),mA=N0("internal"),EJ=function(a){function o(){return a.call(this)||this}return nu(o,a),o}(function pq(a){return function(){var o=this;a&&Pi(a,function(i,l){o[i]=l})}}({applicationVersion:fA("ver"),applicationBuild:fA("build"),applicationTypeId:fA("typeId"),applicationId:fA("applicationId"),applicationLayer:fA("layer"),deviceId:rl("id"),deviceIp:rl("ip"),deviceLanguage:rl("language"),deviceLocale:rl("locale"),deviceModel:rl("model"),deviceFriendlyName:rl("friendlyName"),deviceNetwork:rl("network"),deviceNetworkName:rl("networkName"),deviceOEMName:rl("oemName"),deviceOS:rl("os"),deviceOSVersion:rl("osVersion"),deviceRoleInstance:rl("roleInstance"),deviceRoleName:rl("roleName"),deviceScreenResolution:rl("screenResolution"),deviceType:rl("type"),deviceMachineName:rl("machineName"),deviceVMName:rl("vmName"),deviceBrowser:rl("browser"),deviceBrowserVersion:rl("browserVersion"),locationIp:hO("ip"),locationCountry:hO("country"),locationProvince:hO("province"),locationCity:hO("city"),operationId:ng("id"),operationName:ng("name"),operationParentId:ng("parentId"),operationRootId:ng("rootId"),operationSyntheticSource:ng("syntheticSource"),operationCorrelationVector:ng("correlationVector"),sessionId:IU("id"),sessionIsFirst:IU("isFirst"),sessionIsNew:IU("isNew"),userAccountAcquisitionDate:L0("accountAcquisitionDate"),userAccountId:L0("accountId"),userAgent:L0("userAgent"),userId:L0("id"),userStoreRegion:L0("storeRegion"),userAuthUserId:L0("authUserId"),userAnonymousUserAcquisitionDate:L0("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:L0("authUserAcquisitionDate"),cloudName:F0("name"),cloudRole:F0("role"),cloudRoleVer:F0("roleVer"),cloudRoleInstance:F0("roleInstance"),cloudEnvironment:F0("environment"),cloudLocation:F0("location"),cloudDeploymentUnit:F0("deploymentUnit"),internalNodeName:mA("nodeName"),internalSdkVersion:mA("sdkVersion"),internalAgentVersion:mA("agentVersion"),internalSnippet:mA("snippet"),internalSdkSrc:mA("sdkSrc")}));function V0(a,o,i,w,u,h){i=ha(w,i)||Ta,(tn(a)||tn(o)||tn(i))&&yh("Input doesn't contain all required fields"),w="";var g,T=(a[rA]&&(w=a[rA],delete a[rA]),(g={})[di]=i,g.time=_0(new Date),g.iKey=w,g.ext=h||{},g.tags=[],g.data={},g.baseType=o,g.baseData=a,g);return tn(u)||Pi(u,function(D,P){T.data[D]=P}),T}var ps=new EJ;function gA(a){var o,i=null;return $r(Event)?i=new Event(a):(o=Jl())&&o.createEvent&&(i=o.createEvent("Event")).initEvent(a,!0,!0),i}function xJ(a,o){Fa(a,null,null,o)}var dO="AppInsightsPropertiesPlugin",MG="AppInsightsChannelPlugin",kG="ApplicationInsightsAnalytics",SU="toString",OG="isStorageUseDisabled",QE="_addHook",tc="core",Qy="dataType",XE="envelopeType",ud="diagLog",is="track",AU="trackPageView",NG="trackPreviousPageVisit",JE="sendPageViewInternal",yA="startTime",LG="properties",rg="duration",FG="sendPageViewPerformanceInternal",DU="populatePageViewPerformanceEvent",pO="href",TJ="sendExceptionInternal",VG="exception",ex="error",PU="_onerror",RU="errorSrc",_A="lineNumber",B0="columnNumber",CJ="message",BG="CreateAutoException",vA="addTelemetryInitializer",IJ="autoTrackPageVisitTime",SJ="isBrowserLinkTrackingEnabled",wA="length",MU="enableAutoRouteTracking",AJ="enableUnhandledPromiseRejectionTracking",zG="autoUnhandledPromiseInstrumented",jG="getEntriesByType",DJ="isPerformanceTimingSupported",PJ="getPerformanceTiming",kU="navigationStart",HG="shouldCollectDuration",RJ="isPerformanceTimingDataReady",bA="responseStart",fO="loadEventEnd",OU="responseEnd",NU="connectEnd",MJ="pageVisitStartTime",Xse=function(){function a(o,i,l,u){ko(a,this,function(h){var g,w=null,T=[],D=!1,P=!1;function N(W){l&&l.flush(W,function(){})}l&&(g=l.logger),h[AU]=function(W,ue){var ge,we,Re,et,Mt,St,Qt=W.name,Le=(!tn(Qt)&&"string"==typeof Qt||(we=Jl(),Qt=W.name=we&&we.title||""),W.uri);!tn(Le)&&"string"==typeof Le||(we=rp(),Le=W.uri=we&&we[pO]||""),P||((ge=(we=Bm())&&we[jG]&&we[jG]("navigation"))&&ge[0]&&!bs(we.timeOrigin)?(ge=ge[0].loadEventStart,W[yA]=new Date(we.timeOrigin+ge)):(we=(ue||W[LG]||{})[rg]||0,W[yA]=new Date((new Date).getTime()-we)),P=!0),u[DJ]()?(Re=!1,0<(Mt=u[PJ]()[kU])&&(et=Eh(Mt,+new Date),u[HG](et)||(et=void 0)),tn(ue)||tn(ue[rg])||(St=ue[rg]),!i&&isNaN(St)||(isNaN(St)&&((ue=ue||{})[rg]=et),o[JE](W,ue),N(!0),Re=!0),ue=ue||{},function z(W){T.push(W),function ue(){w=w||_h(function(){w=null;var ge=T.slice(0),we=!1;T=[],Hn(ge,function(Re){Re()?we=!0:T.push(Re)}),0<T[wA]&&ue(),we&&N(!0)},100)}()}(function(){var Je,ot=!1;try{u[RJ]()?(ot=!0,u[DU](Je={name:Qt,uri:Le}),Je.isValid||Re?(Re||(ue[rg]=Je.durationMs,o[JE](W,ue)),D||(o[FG](Je,ue),D=!0)):(ue[rg]=et,o[JE](W,ue))):0<Mt&&6e4<Eh(Mt,+new Date)&&(ot=!0,Re||(ue[rg]=6e4,o[JE](W,ue)))}catch(Et){En(g,1,38,"trackPageView failed on page load calculation: "+to(Et),{exception:Mn(Et)})}return ot})):(o[JE](W,ue),N(!0),C8()||En(g,2,25,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info."))},h.teardown=function(W,ue){var ge;w&&(w.cancel(),w=null,ge=T.slice(0),T=[],Hn(ge,function(we){we()}))}})}return a.__ieDyn=1,a}(),kJ=["googlebot","adsbot-google","apis-google","mediapartners-google"];function OJ(){var a=Bm();return a&&!!a.timing}function tae(){var a;return(a=(a=Bm())?a.timing:0)&&0<a.domainLookupStart&&0<a[kU]&&0<a[bA]&&0<a.requestStart&&0<a[fO]&&0<a[OU]&&0<a[NU]&&0<a.domLoading}function NJ(){return OJ()?Bm().timing:null}function mO(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var i=(Xd()||{}).userAgent,l=!1;if(i)for(var u=0;u<kJ[wA];u++)l=l||-1!==ec(i.toLowerCase(),kJ[u]);if(l)return!1;for(u=0;u<a[wA];u++)if(a[u]<0||36e5<=a[u])return!1;return!0}var hd,LJ=function(){function a(o){var i=Uy(o);ko(a,this,function(l){l[DU]=function(u){u.isValid=!1;var h=function nae(){return function eae(){var a=Bm();return a&&a.getEntriesByType&&0<a.getEntriesByType("navigation")[wA]}()?Bm()[jG]("navigation")[0]:null}(),g=NJ(),w=0,T=0,D=0,P=0,N=0;(h||g)&&(N=h?(w=h[rg],T=0===h[yA]?h[NU]:Eh(h[yA],h[NU]),D=Eh(h.requestStart,h[bA]),P=Eh(h[bA],h[OU]),Eh(h.responseEnd,h[fO])):(w=Eh(g[kU],g[fO]),T=Eh(g[kU],g[NU]),D=Eh(g.requestStart,g[bA]),P=Eh(g[bA],g[OU]),Eh(g.responseEnd,g[fO])),0===w?En(i,2,10,"error calculating page view performance.",{total:w,network:T,request:D,response:P,dom:N}):l[HG](w,T,D,P,N)?w<Math.floor(T)+Math.floor(D)+Math.floor(P)+Math.floor(N)?En(i,2,8,"client performance math error.",{total:w,network:T,request:D,response:P,dom:N}):(u.durationMs=w,u.perfTotal=u[rg]=Yy(w),u.networkConnect=Yy(T),u.sentRequest=Yy(D),u.receivedResponse=Yy(P),u.domProcessing=Yy(N),u.isValid=!0):En(i,2,45,"Invalid page load duration value. Browser perf data won't be sent.",{total:w,network:T,request:D,response:P,dom:N}))},l[PJ]=NJ,l[DJ]=OJ,l[RJ]=tae,l[HG]=mO})}return a.__ieDyn=1,a}(),LU=function(){function a(o,i){var l="prevPageVisitData";ko(a,this,function(u){u[NG]=function(h,g){try{var w=function(T,D){var P=null;try{var N;P=function(){var z=null;try{var W,ue;dA()&&(W=xf(),ue=bU(o,l))&&wk()&&((z=ip().parse(ue)).pageVisitTime=W-z[MJ],EU(o,l))}catch(ge){E0(o,"Stop page visit timer failed: "+Mn(ge)),z=null}return z}(),dA()&&(null!=bU(o,l)&&yh("Cannot call startPageVisit consecutively without first calling stopPageVisit"),N=ip().stringify(new EA(T,D)),IG(o,l,N))}catch(z){E0(o,"Call to restart failed: "+Mn(z)),P=null}return P}(h,g);w&&i(w.pageName,w.pageUrl,w.pageVisitTime)}catch(T){E0(o,"Auto track page visit time failed, metric will not be collected: "+Mn(T))}},eo(u,"_logger",{g:function(){return o}}),eo(u,"pageVisitTimeTrackingHandler",{g:function(){return i}})})}return a.__ieDyn=1,a}(),EA=function(a,o){this[MJ]=xf(),this.pageName=a,this.pageUrl=o},$G=function(a,o){var i=this,l={};i.start=function(u){void 0!==l[u]&&En(a,2,62,"start was called more than once for this event without calling stop.",{name:u,key:u},!0),l[u]=+new Date},i.stop=function(u,h,g,w){var T=l[u];isNaN(T)?En(a,2,63,"stop was called without a corresponding start.",{name:u,key:u},!0):(T=Eh(T,+new Date),i.action(u,h,T,g,w)),delete l[u],l[u]=void 0}};function xA(a,o){a&&a.dispatchEvent&&o&&a.dispatchEvent(o)}var FU=IS(((hd={sessionRenewalMs:Dk(VU,18e5),sessionExpirationMs:Dk(VU,864e5),disableExceptionTracking:La()})[IJ]=La(),hd.overridePageViewDuration=La(),hd[AJ]=La(),hd[zG]=!1,hd.samplingPercentage=Pk(function GG(a){return!isNaN(a)&&0<a&&a<=100},100),hd[OG]=La(),hd[SJ]=La(),hd[MU]=La(),hd.namePrefix=function Mq(a){return{isVal:xr,v:Xc(a||Ni)}}(),hd.enableDebug=La(),hd.disableFlushOnBeforeUnload=La(),hd.disableFlushOnUnload=La(!1,"disableFlushOnBeforeUnload"),hd));function VU(a,o){return+(a=(a=a||o)<6e4?6e4:a)}function BU(a){bs(a[OG])||(a[OG]?CG:lJ)()}var KG=function(a){function o(){var i,l,u,h,g,w,T,D,P,N,z,W,ue,ge,we,Re,et,Mt,St,Qt=a.call(this)||this;return Qt.identifier=kG,Qt.priority=180,Qt.autoRoutePVDelay=500,ko(o,Qt,function(Le,Je){var ot=Je[QE];function Et(Ne,lt,It,xt,ln){Le[ud]().throwInternal(Ne,lt,It,xt,ln)}function Kt(){w=g=h=u=l=i=null;var Ne=rp(!(Re=ge=ue=W=z=N=P=D=T=!1));et=Ne&&Ne[pO]||"",we=St=Mt=null,eo(Le,"config",{g:function(){return we}})}Kt(),Le.getCookieMgr=function(){return jk(Le[tc])},Le.processTelemetry=function(Ne,lt){Le.processNext(Ne,lt)},Le.trackEvent=function(Ne,lt){try{var It=V0(Ne,Wy[Qy],Wy[XE],Le[ud](),lt);Le[tc][is](It)}catch(xt){Et(2,39,"trackTrace failed, trace will not be collected: "+to(xt),{exception:Mn(xt)})}},Le.startTrackEvent=function(Ne){try{i.start(Ne)}catch(lt){Et(1,29,"startTrackEvent failed, event will not be collected: "+to(lt),{exception:Mn(lt)})}},Le.stopTrackEvent=function(Ne,lt,It){try{i.stop(Ne,void 0,lt,It)}catch(xt){Et(1,30,"stopTrackEvent failed, event will not be collected: "+to(xt),{exception:Mn(xt)})}},Le.trackTrace=function(Ne,lt){try{var It=V0(Ne,ZE[Qy],ZE[XE],Le[ud](),lt);Le[tc][is](It)}catch(xt){Et(2,39,"trackTrace failed, trace will not be collected: "+to(xt),{exception:Mn(xt)})}},Le.trackMetric=function(Ne,lt){try{var It=V0(Ne,WE[Qy],WE[XE],Le[ud](),lt);Le[tc][is](It)}catch(xt){Et(1,36,"trackMetric failed, metric will not be collected: "+to(xt),{exception:Mn(xt)})}},Le[AU]=function(Ne,lt){try{var It=Ne||{};u[AU](It,tu(tu(tu({},It.properties),It.measurements),lt)),Re&&g[NG](It.name,It.uri)}catch(xt){Et(1,37,"trackPageView failed, page view will not be collected: "+to(xt),{exception:Mn(xt)})}},Le[JE]=function(Ne,lt,It){var xt=((xt=Jl())&&(Ne.refUri=void 0===Ne.refUri?xt.referrer:Ne.refUri),tn(Ne[yA])&&(xt=(lt||Ne[LG]||{})[rg]||0,Ne[yA]=new Date((new Date).getTime()-xt)),V0(Ne,Zy[Qy],Zy[XE],Le[ud](),lt,It));Le[tc][is](xt)},Le[FG]=function(Ne,lt,It){Ne=V0(Ne,pA[Qy],pA[XE],Le[ud](),lt,It),Le[tc][is](Ne)},Le.trackPageViewPerformance=function(Ne,lt){Ne=Ne||{};try{h[DU](Ne),Le[FG](Ne,lt)}catch(It){Et(1,37,"trackPageViewPerformance failed, page view will not be collected: "+to(It),{exception:Mn(It)})}},Le.startTrackPage=function(Ne){try{var lt;"string"!=typeof Ne&&(Ne=(lt=Jl())&&lt.title||""),l.start(Ne)}catch(It){Et(1,31,"startTrackPage failed, page view may not be collected: "+to(It),{exception:Mn(It)})}},Le.stopTrackPage=function(Ne,lt,It,xt){try{var ln,Sn;"string"!=typeof Ne&&(Ne=(ln=Jl())&&ln.title||""),"string"!=typeof lt&&(lt=(Sn=rp())&&Sn[pO]||""),l.stop(Ne,lt,It,xt),Re&&g[NG](Ne,lt)}catch(We){Et(1,32,"stopTrackPage failed, page view will not be collected: "+to(We),{exception:Mn(We)})}},Le[TJ]=function(Ne,lt,It){var xt=Ne&&(Ne[VG]||Ne[ex])||E2(Ne)&&Ne||{name:Ne&&typeof Ne,message:Ne||Ta};Ne=Ne||{},xt=V0(new cd(Le[ud](),xt,Ne[LG]||lt,Ne.measurements,Ne.severityLevel,Ne.id).toInterface(),cd[Qy],cd[XE],Le[ud](),lt,It),Le[tc][is](xt)},Le.trackException=function(Ne,lt){Ne&&!Ne[VG]&&Ne[ex]&&(Ne[VG]=Ne[ex]);try{Le[TJ](Ne,lt)}catch(It){Et(1,35,"trackException failed, exception will not be collected: "+to(It),{exception:Mn(It)})}},Le[PU]=function(Ne){var lt=Ne&&Ne[ex],It=Ne&&Ne.evt;try{It||(Rn=Ru())&&(It=Rn.event);var xt,ln,Sn=Ne&&Ne.url||(Jl()||{}).URL,We=Ne[RU]||"window.onerror@"+Sn+":"+(Ne[_A]||0)+":"+(Ne[B0]||0),on={errorSrc:We,url:Sn,lineNumber:Ne[_A]||0,columnNumber:Ne[B0]||0,message:Ne[CJ]};!function bJ(a,o,i,l,u){return!u&&xr(a)&&("Script error."===a||"Script error"===a)}(Ne.message,0,0,0,Ne[ex])?(Ne[RU]||(Ne[RU]=We),Le.trackException({exception:Ne,severityLevel:3},on)):(xt=cd[BG]("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",Sn,Ne[_A]||0,Ne[B0]||0,lt,It,null,We),ln=on,xt=V0(xt,cd[Qy],cd[XE],Le[ud](),ln),Le[tc][is](xt))}catch(sr){var Rn=lt?lt.name+", "+lt[CJ]:"null";Et(1,11,"_onError threw exception while logging error, error will not be collected: "+to(sr),{exception:Mn(sr),errorString:Rn})}},Le[vA]=function(Ne){if(Le[tc])return Le[tc][vA](Ne);(w=w||[]).push(Ne)},Le.initialize=function(Ne,lt,It,xt){if(!Le.isInitialized()){tn(lt)&&yh("Error initializing"),Je.initialize(Ne,lt,It,xt);try{var ln,Sn;St=lp(ku(Le.identifier),lt.evtNamespace&&lt.evtNamespace()),w&&(Hn(w,function(Qn){lt[vA](Qn)}),w=null),dt=Le.identifier,pi=Le[tc],Le[QE](xa(nn=Ne,function(){var Qn,ar=ap(null,nn,pi);we=ar.getExtCfg(dt,FU),Re=we[IJ],nn.storagePrefix&&wU(nn.storagePrefix),BU(we),T=we[SJ],!D&&T&&(Qn=["/browserLinkSignalR/","/__browserLink/"],Le[QE](Le[vA](function(Wr){if(T&&Wr.baseType===YE[Qy]){var zn=Wr.baseData;if(zn)for(var Fr=0;Fr<Qn[wA];Fr++)if(zn.target&&0<=ec(zn.target,Qn[Fr]))return!1}return!0})),D=!0)})),h=new LJ(Le[tc]),u=new Xse(Le,we.overridePageViewDuration,Le[tc],h),g=new LU(Le[ud](),function(Qn,ar,Wr){Le.trackMetric({name:"PageVisitTime",average:Wr,max:Wr,min:Wr,sampleCount:1},{PageName:Qn,PageUrl:ar})}),(i=new $G(Le[ud](),"trackEvent")).action=function(Qn,ar,Wr,zn,Fr){Fr=Fr||{},(zn=zn||{}).duration=Wr[SU](),Le.trackEvent({name:Qn,properties:zn,measurements:Fr})},(l=new $G(Le[ud](),"trackPageView")).action=function(Qn,ar,Wr,zn,Fr){(zn=tn(zn)?{}:zn).duration=Wr[SU](),Le[JE]({name:Qn,uri:ar,properties:zn,measurements:Fr},zn)},S2()&&(Rn=Ru(),sr=rp(!0),Le[QE](xa(we,function(){(z=we.disableExceptionTracking)||W||we.autoExceptionInstrumented||(ot(uU(Rn,"onerror",{ns:St,rsp:function(Qn,ar,Wr,zn,Fr,So){z||!0===Qn.rslt||Le[PU](cd[BG](ar,Wr,zn,Fr,So,Qn.evt))}},!1)),W=!0)})),ln=Rn,Sn=sr,Le[QE](xa(we,function(){W=W||we[zG],(ue=!0===we[AJ])&&!ge&&(ot(uU(ln,"onunhandledrejection",{ns:St,rsp:function(Qn,ar){ue&&!0!==Qn.rslt&&Le[PU](cd[BG](function FJ(a){var o;return a&&a.reason?!xr(o=a.reason)&&$r(o[SU])?o[SU]():Mn(o):a||""}(ar),Sn?Sn[pO]:"",0,0,ar,Qn.evt))}},!1)),we[zG]=ge=!0)})),We=Ru(),on=rp(!0),Le[QE](xa(we,function(){var Qn,ar,Wr,zn;P=!0===we[MU],We&&P&&!N&&function A2(){return!!z4()}()&&(ar=z4(),$r(ar.pushState))&&$r(ar.replaceState)&&typeof Event!==OS&&(Qn=We,Wr=on,N||(zn=we.namePrefix||"",ot(uU(ar,"pushState",{ns:St,rsp:function(){P&&(xA(Qn,gA(zn+"pushState")),xA(Qn,gA(zn+"locationchange")))}},!0)),ot(uU(ar,"replaceState",{ns:St,rsp:function(){P&&(xA(Qn,gA(zn+"replaceState")),xA(Qn,gA(zn+"locationchange")))}},!0)),Nu(Qn,zn+"popstate",function(){P&&xA(Qn,gA(zn+"locationchange"))},St),Nu(Qn,zn+"locationchange",function(){var Fr,So,Ht,Ao;Mt&&(et=Mt),Mt=Wr&&Wr[pO]||"",P&&(Ao=null,Le[tc]&&Le[tc].getTraceCtx&&(Ao=Le[tc].getTraceCtx(!1)),Ao||(Ht=Le[tc].getPlugin(dO))&&(Ht=Ht.plugin.context)&&(Ao=dp(Ht.telemetryTrace)),(Fr=Ao)&&(Fr.setTraceId(C0()),So="_unknown_",Wr&&Wr.pathname&&(So=Wr.pathname+(Wr.hash||"")),Fr.setName(ha(Le[ud](),So))),_h(function(Ao){Le[AU]({refUri:Ao,properties:{duration:0}})}.bind(Le,et),Le.autoRoutePVDelay))},St),N=!0))})))}catch(Qn){throw Le.setInitialized(!1),Qn}var We,on,Rn,sr,nn,dt,pi}},Le._doTeardown=function(Ne,lt){u&&u.teardown(Ne,lt),Fa(window,null,null,St),Kt()},eo(Le,"_pageViewManager",{g:function(){return u}}),eo(Le,"_pageViewPerformanceManager",{g:function(){return h}}),eo(Le,"_pageVisitTimeManager",{g:function(){return g}}),eo(Le,"_evtNamespace",{g:function(){return"."+St}})}),Qt}return nu(o,a),o.Version="3.3.0",o}($y),tx="featureOptIn",yO="onCfgChangeReceive",UU="nonOverrideConfigs",WG="scheduleFetchTimeout";function YG(a,o,i,l){try{var u=l<i,h=(u&&(a=null),0==i?function vse(a,o,i,l,u,h,g){return q4(a||{},bf[Zl](arguments))}({},a):a);return h&&o&&!u&&Pi(h,function(g){var w=o[g];w&&(Ar(h[g])&&Ar(w)?h[g]=YG(h[g],w,++i,l):delete h[g])}),h}catch{}return a}var _O,nx="featureOptIn.",zU=".offCfg";var Xy=void 0,UJ=IS(((_O={syncMode:1,blkCdnCfg:Xy,customEvtName:Xy,cfgUrl:Xy,overrideSyncFn:Xy,overrideFetchFn:Xy})[yO]=Xy,_O[WG]=18e5,_O[UU]={instrumentationKey:!0,connectionString:!0,endpointUrl:!0},_O)),e9=function(a){function o(){var i,l,u,h,g,w,T,D,P,N,z,W,ue,ge,Re,et=a.call(this)||this,Mt=(et.priority=198,!(et.identifier="AppInsightsCfgSyncPlugin"));return ko(o,et,function(St,Qt){function Le(){W=Re=P=z=N=w=ue=D=T=g=h=u=l=null}function Je(on,Rn){if(on){if(l=on,Rn&&!Mt)return Et();if(T&&!Mt)return St.core.updateCfg(on),!0}return!1}function ot(){try{var on=Pu();on&&Fa(on,null,null,h)}catch{}}function Et(on){try{return Re&&$r(Re)?Re(l,on):function Tq(a,o,i){var l=Pu();if(l&&l.CustomEvent)try{return function lX(a,o){return!!(a&&a.dispatchEvent&&o)&&(a.dispatchEvent(o),!0)}(l,function cX(a,u){var i,l=null;return u={detail:u||null},$r(CustomEvent)?l=new CustomEvent(a,u):(i=Jl())&&i.createEvent&&(l=i.createEvent("CustomEvent")).initCustomEvent(a,!0,!0,u),l}(a,{cfg:o||null,customDetails:i||null}))}catch{}return!1}(u,l,on)}catch{}return!1}function Kt(on){try{if(ot(),on&&(u=on,T)){var Rn=Pu();if(Rn)try{Nu(Rn,u,function(nn){nn=nn&&nn.detail,W&&nn?W(nn):(nn=(nn=nn&&nn.cfg)&&xc(nn)&&ln(nn))&&Je(nn)},h,!0)}catch{}}return!0}catch{}return!1}function Ne(on,Rn,sr){var nn=(nn=Pu())&&nn.fetch||null;if(on&&nn&&$r(nn))try{var dt=new Request(on,{method:"GET"});Df(fetch(dt),function(pi){var Qn=pi.value;pi.rejected?xt(Rn,400):Qn.ok?Df(Qn.text(),function(ar){xt(Rn,Qn.status,ar.value,sr)}):xt(Rn,Qn.status,null,sr)})}catch{}}function lt(on,Rn,sr){try{var nn=new XMLHttpRequest;nn.open("GET",on),nn.onreadystatechange=function(){nn.readyState===XMLHttpRequest.DONE&&xt(Rn,nn.status,nn.responseText,sr)},nn.onerror=function(){xt(Rn,400)},nn.ontimeout=function(){xt(Rn,400)},nn.send()}catch{}}function It(on,Rn,sr){try{var nn,dt,pi;200<=on&&on<400&&Rn?(z=0,(nn=ip())&&(pi=(dt=function jU(a,o){try{var l;return a&&a.enabled?a[tx]?(l=a.config||{},Pi(a[tx],function(u){var h=function XG(a,o,i){var l,u,h,g,w,T,D,P,N,z;return o&&o.enabled?(l=(o=(o[tx]||{})[a]||{mode:1}).mode,u=o.onCfg,o=o.offCfg,h=(i=(i||{})[a]||{mode:2}).mode,T=nx+a+".onCfg",D=nx+a+zU,P=h,N=g=i.onCfg,z=w=i.offCfg,(i=!!i.blockCdnCfg)||(4===l||5===l?(P=4==l?3:2,N=u||g,z=o||w):2===l||2===h?(P=2,N=g||u,z=w||o):3===l?(P=3,N=g||u,z=w||o):1===l&&1===h&&(P=1)),(i={})[nx+a+".mode"]=P,i[T]=N,i[D]=z,i):null}(u,a,o.config[tx]);tn(h)||(Pi(h,function(g,w){s0(l,g,w)}),function VJ(g,h,i){var l=h[nx+g+".mode"],u=h[nx+g+".onCfg"];h=h[nx+g+zU],(g=2===l?h:3===l?u:null)&&Pi(g,function(w,T){s0(i,w,T)})}(u,h,l))}),l):a.config:null}catch{}return null}(nn.parse(Rn),St.core))&&xc(dt)&&ln(dt))&&Je(pi,sr)):z++,z<3&&Sn()}catch{}}function xt(on,Rn,sr,nn){try{on(Rn,sr,nn)}catch{}}function ln(on){var Rn=null;try{on&&(Rn=YG(on,ue,0,5))}catch{}return Rn}function Sn(){!w&&N&&(w=_h(function(){w=null,ge(g,It,D)},N)).unref()}function We(){w&&w.cancel(),w=null,z=0}Le(),St.initialize=function(on,Rn,sr,nn){var dt,pi,Qn,ar;Qt.initialize(on,Rn,sr,nn),h=lp(ku(St.identifier),Rn.evtNamespace&&Rn.evtNamespace()),pi=St.identifier,Qn=St.core,St._addHook(xa(dt=on,function(){var ar=ap(null,dt,Qn);i=ar.getExtCfg(pi,UJ),ar=P,P=!!i.blkCdnCfg,tn(ar)||ar===P||(!P&&g?ge&&ge(g,It,D):We()),tn(T)&&(T=2===i.syncMode),tn(D)&&(D=1===i.syncMode),u!==(ar=i.customEvtName||"ai_cfgsync")&&(T?Kt(ar):(ot(),u=ar)),(g=tn(g)?i.cfgUrl:g)||(l=dt,D&&Et())})),Re=i.overrideSyncFn,W=i[yO],ue=i[UU],N=i[WG],tn(ar=i.overrideFetchFn)&&(NB()?ar=Ne:$S()&&(ar=lt)),ge=ar,z=0,g&&!P&&ge&&ge(g,It,D)},St.getCfg=function(){return l},St.pause=function(){Mt=!0,We()},St.resume=function(){Mt=!1,Sn()},St.setCfg=function(on){return Je(on)},St.sync=Et,St.updateEventListenerName=Kt,St._doTeardown=function(on,Rn){ot(),We(),Le()},St._getDbgPlgTargets=function(){return[D,T,u,P,ue]},St.processTelemetry=function(on,Rn){St.processNext(on,Rn)}}),et}return nu(o,a),o.__ieDyn=1,o}($y),U0="duration",nc="tags",$U="deviceType",Bu="data",Jy="name",rx="traceID",zi="length",TA="stringify",z0="measurements",Of="dataType",e_="envelopeType",j0="toString",CA="_get",t_="enqueue",n_="count",t9="eventsLimitInMem",H0="push",vO="item",n9="emitLineDelimitedJson",ix="clear",wO="createNew",IA="markAsSent",dd="clearSent",qU="bufferOverride",GU="BUFFER_KEY",Nf="SENT_BUFFER_KEY",$0="concat",bO="MAX_BUFFER_SIZE",EO="triggerSend",iu="diagLog",KU="initialize",xO="_sender",r9="customHeaders",zJ="maxBatchSizeInBytes",i9="onunloadDisableBeacon",o9="isBeaconApiDisabled",jJ="alwaysUseXhrOverride",s9="disableXhr",HJ="enableSessionStorageBuffer",r_="_buffer",WU="onunloadDisableFetch",$J="disableSendBeaconSplit",qJ="instrumentationKey",GJ="enableSendPromise",YU="getSenderInst",KJ="unloadTransports",WJ="convertUndefined",YJ="maxBatchInterval",TO="serialize",ox="_onError",ZU="_onPartialSuccess",CO="_onSuccess",IO="itemsReceived",QU="itemsAccepted",XU="oriPayload",JU="baseType",sx="sampleRate",ez="eventsSendRequest",a9="getSamplingScore",ig="baseType",Wi="baseData",El="properties",tz="true";function Ca(a,o,i){return yi(a,o,i,x2)}function i_(a,o,i){tn(a)||Pi(a,function(l,u){J1(u)?i[l]=u:xr(u)?o[l]=u:wk()&&(o[l]=ip()[TA](u))})}function og(a,o){tn(a)||Pi(a,function(i,l){a[i]=l||o})}function Uu(a,o,i,l){return Ca(l=new mJ(a,l,o),"sampleRate",i[dG]),(i[Wi]||{}).startTime&&(l.time=_0(i[Wi].startTime)),l.iKey=i.iKey,o=i.iKey.replace(/-/g,""),l[Jy]=l[Jy].replace("{0}",o),function ZJ(a,o,i){for(var g,l=i[nc]=i[nc]||{},u=o.ext=o.ext||{},h=o[nc]=o[nc]||[],w=((g=u.user)&&(Ca(l,ps.userAuthUserId,g.authId),Ca(l,ps.userId,g.id||g.localId)),(g=u.app)&&Ca(l,ps.sessionId,g.sesId),(g=u.device)&&(Ca(l,ps.deviceId,g.id||g.localId),Ca(l,ps[$U],g.deviceClass),Ca(l,ps.deviceIp,g.ip),Ca(l,ps.deviceModel,g.model),Ca(l,ps[$U],g[$U])),(g=o.ext.web)&&(Ca(l,ps.deviceLanguage,g.browserLang),Ca(l,ps.deviceBrowserVersion,g.browserVer),Ca(l,ps.deviceBrowser,g.browser),Ca(o=(o=(o=i[Bu]=i[Bu]||{})[Wi]=o[Wi]||{})[El]=o[El]||{},"domain",g.domain),Ca(o,"isManual",g.isManual?tz:null),Ca(o,"screenRes",g.screenRes),Ca(o,"userConsent",g.userConsent?tz:null)),(o=u.os)&&(Ca(l,ps.deviceOS,o[Jy]),Ca(l,ps.deviceOSVersion,o.osVer)),(g=u.trace)&&(Ca(l,ps.operationParentId,g.parentID),Ca(l,ps.operationName,ha(a,g[Jy])),Ca(l,ps.operationId,g[rx])),{}),T=h[zi]-1;0<=T;T--)Pi(h[T],function(P,N){w[P]=N}),h.splice(T,1);Pi(h,function(D,P){w[D]=P}),(o=tu(tu({},l),w))[ps.internalSdkVersion]||(o[ps.internalSdkVersion]=ha(a,"javascript:".concat(Sc.Version),64)),i[nc]=fq(o)}(a,i,l),i[nc]=i[nc]||[],fq(l)}function o_(a,o){tn(o[Wi])&&En(a,1,46,"telemetryItem.baseData cannot be null.")}var Sc={Version:"3.3.0"};function c9(a,o,u){o_(a,o);var h={},l={};return o[ig]!==Wy[Of]&&(h.baseTypeSource=o[ig]),o[ig]===Wy[Of]?(h=o[Wi][El]||{},l=o[Wi][z0]||{}):o[Wi]&&i_(o[Wi],h,l),i_(o[Bu],h,l),tn(u)||og(h,u),u=new Wy(a,u=o[Wi][Jy],h,l),h=new tg(Wy[Of],u),Uu(a,Wy[e_],o,h)}var ks,sg,nz=function(){function a(o,i){var l=[],u=!1,h=i.maxRetryCnt;this[CA]=function(){return l},this._set=function(g){return l=g},ko(a,this,function(g){g[t_]=function(w){g[n_]()>=i[t9]?u||(En(o,2,105,"Maximum in-memory buffer size reached: "+g[n_](),!0),u=!0):(w.cnt=w.cnt||0,!tn(h)&&w.cnt>h||l[H0](w))},g[n_]=function(){return l[zi]},g.size=function(){for(var w=l[zi],T=0;T<l[zi];T++)w+=l[T].item[zi];return i[n9]||(w+=2),w},g[ix]=function(){u=!(l=[])},g.getItems=function(){return l.slice(0)},g.batchPayloads=function(w){var T;return w&&0<w[zi]?(T=[],Hn(w,function(D){T[H0](D[vO])}),i[n9]?T.join("\n"):"["+T.join(",")+"]"):null},g[wO]=function(w,T,D){var P=l.slice(0),N=new(D?rz:SO)(w=w||o,T=T||{});return Hn(P,function(z){N[t_](z)}),N}})}return a.__ieDyn=1,a}(),SO=function(a){function o(i,l){return ko(o,i=a.call(this,i,l)||this,function(u,h){u[IA]=function(g){h[ix]()},u[dd]=function(g){}}),i}return nu(o,a),o.__ieDyn=1,o}(nz),AO=["AI_buffer","AI_sentBuffer"],rz=function(a){function o(l,u){var h=a.call(this,l,u)||this,g=!1,w=u?.namePrefix,T=u[qU]||{getItem:bU,setItem:IG},D=T.getItem,P=T.setItem,N=u.maxRetryCnt;return ko(o,h,function(z,W){var ue=et(o[GU]),ge=et(o[Nf]),we=function(){var Le=[];try{return Hn(AO,function(Je){var ot=Qt(Je);Le=Le[$0](ot),w&&(ot=Qt(w+"_"+Je),Le=Le[$0](ot))}),Le}catch(Je){En(l,2,41,"Transfer events from previous buffers: "+to(Je)+". previous Buffer items can not be removed",{exception:Mn(Je)})}return[]}();function Re(Le,Je){var ot=[],Et=[];return Hn(Le,function(Kt){Et[H0](Kt[vO])}),Hn(Je,function(Kt){$r(Kt)||-1!==Ec(Et,Kt[vO])||ot[H0](Kt)}),ot}function et(Le){return Mt(w?w+"_"+Le:Le)}function Mt(Le){try{var Je=D(l,Le);if(Je){var ot=ip().parse(Je);if((ot=xr(ot)?ip().parse(ot):ot)&&Di(ot))return ot}}catch(Et){En(l,1,42," storage key: "+Le+", "+to(Et),{exception:Mn(Et)})}return[]}function St(Le,Je){try{Le=w?w+"_"+Le:Le;var ot=JSON[TA](Je);P(l,Le,ot)}catch(Et){P(l,Le,JSON[TA]([])),En(l,2,41," storage key: "+Le+", "+to(Et)+". Buffer cleared",{exception:Mn(Et)})}}function Qt(Le){try{var Je=Mt(Le),ot=[];return Hn(Je,function(Et){ot[H0]({item:Et,cnt:0})}),EU(l,Le),ot}catch{}return[]}ge=ge[$0](we),(we=z._set(ue[$0](ge)))[zi]>o[bO]&&(we[zi]=o[bO]),St(o[Nf],[]),St(o[GU],we),z[t_]=function(Le){z[n_]()>=o[bO]?g||(En(l,2,67,"Maximum buffer size reached: "+z[n_](),!0),g=!0):(Le.cnt=Le.cnt||0,!tn(N)&&Le.cnt>N||(W[t_](Le),St(o.BUFFER_KEY,z[CA]())))},z[ix]=function(){W[ix](),St(o.BUFFER_KEY,z[CA]()),St(o[Nf],[]),g=!1},z[IA]=function(Le){St(o[GU],z._set(Re(Le,z[CA]())));var Je=et(o[Nf]);Je instanceof Array&&Le instanceof Array&&((Je=Je[$0](Le))[zi]>o[bO]&&(En(l,1,67,"Sent buffer reached its maximum size: "+Je[zi],!0),Je[zi]=o[bO]),St(o[Nf],Je))},z[dd]=function(Le){Le=Re(Le,et(o[Nf])),St(o[Nf],Le)},z[wO]=function(Le,Je,ot){ot=!!ot;var Et=z[CA]().slice(0),Kt=et(o[Nf]).slice(0),Ne=(Le=Le||l,Je=Je||{},z[ix](),new(ot?o:SO)(Le,Je));return Hn(Et,function(lt){Ne[t_](lt)}),ot&&Ne[IA](Kt),Ne}}),h}var i;return nu(o,a),(i=o).VERSION="_1",o.BUFFER_KEY="AI_buffer"+i.VERSION,o.SENT_BUFFER_KEY="AI_sentBuffer"+i.VERSION,o.MAX_BUFFER_SIZE=2e3,o}(nz),f9=function(){function a(o){ko(a,this,function(i){function l(g,w){var T="__aiCircularRefCheck",D={};if(g)if(g[T])En(o,2,50,"Circular reference detected while serializing object",{name:w},!0);else if(g.aiDataContract)g[T]=!0,Pi(g.aiDataContract,function(P,ue){var z=$r(ue)?1&ue():1&ue,W=$r(ue)?4&ue():4&ue,ge=(ue&=2,void 0!==g[P]),we=Ar(g[P])&&null!==g[P];!z||ge||ue?W||(z=void 0)!==(z=we?(ue?u:l)(g[P],P):g[P])&&(D[P]=z):En(o,1,24,"Missing required field specification. The field is required but not present on source",{field:P,name:w})}),delete g[T];else if("measurements"===w)D=h(g,"number",w);else if("properties"===w)D=h(g,"string",w);else if("tags"===w)D=h(g,"string",w);else if(Di(g))D=u(g,w);else{En(o,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:w},!0);try{ip()[TA](g),D=g}catch(P){En(o,1,48,P&&$r(P[j0])?P[j0]():"Error serializing object",null,!0)}}else En(o,1,48,"cannot serialize object because it is null or undefined",{name:w},!0);return D}function u(g,w){if(g)if(Di(g))for(var T=[],D=0;D<g[zi];D++){var P=l(g[D],w+"["+D+"]");T[H0](P)}else En(o,1,54,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:w},!0);return T}function h(g,w,T){var D;return g&&(D={},Pi(g,function(P,N){"string"===w?D[P]=void 0===N?"undefined":null===N?"null":N[j0]?N[j0]():"invalid field: toString() is not defined.":"number"===w?void 0===N?D[P]="undefined":null===N?D[P]="null":(N=parseFloat(N),D[P]=N):(D[P]="invalid field: "+T+" is of unknown type.",En(o,1,D[P],null,!0))})),D}i[TO]=function(g){g=l(g,"root");try{return ip()[TA](g)}catch(w){En(o,1,48,w&&$r(w[j0])?w[j0]():"Error serializing object",null,!0)}}})}return a.__ieDyn=1,a}(),g9=function(){function a(){}return a.prototype.getHashCodeScore=function(o){return this.getHashCode(o)/a.INT_MAX_VALUE*100},a.prototype.getHashCode=function(o){if(""===o)return 0;for(;o[zi]<8;)o=o[$0](o);for(var i=5381,l=0;l<o[zi];++l)i=(i<<5)+i+o.charCodeAt(l),i&=i;return Math.abs(i)},a.INT_MAX_VALUE=2147483647,a}(),QJ=function(){var a=new g9,o=new EJ;this[a9]=function(i){return i[nc]&&i[nc][o.userId]?a.getHashCodeScore(i[nc][o.userId]):i.ext&&i.ext.user&&i.ext.user.id?a.getHashCodeScore(i.ext.user.id):i[nc]&&i[nc][o.operationId]?a.getHashCodeScore(i[nc][o.operationId]):i.ext&&i.ext.telemetryTrace&&i.ext.telemetryTrace[rx]?a.getHashCodeScore(i.ext.telemetryTrace[rx]):100*Math.random()}},y9=function(){function a(o,i){this.INT_MAX_VALUE=2147483647,i=i||Uy(null),(100<o||o<0)&&(i.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:o},!0),o=100),this[sx]=o,this.samplingScoreGenerator=new QJ}return a.prototype.isSampledIn=function(o){var i=this[sx];return null==i||100<=i||o.baseType===WE[Of]||this.samplingScoreGenerator[a9](o)<i},a}(),Lf=void 0;function PO(a){try{return a.responseText}catch{}return null}var iz=IS(((ks={endpointUrl:Pk(x2,hU+nA)})[n9]=La(),ks[YJ]=15e3,ks[zJ]=102400,ks.disableTelemetry=La(),ks[HJ]=La(!0),ks.isRetryDisabled=La(),ks[o9]=La(!0),ks[$J]=La(!0),ks[s9]=La(),ks[WU]=La(),ks[i9]=La(),ks[qJ]=Lf,ks.namePrefix=Lf,ks.samplingPercentage=Pk(function w9(a){return!isNaN(a)&&0<a&&a<=100},100),ks[r9]=Lf,ks[WJ]=Lf,ks[t9]=1e4,ks[qU]=!1,ks.httpXHROverride={isVal:function v9(a){return a&&a.sendPOST},v:Lf},ks[jJ]=La(),ks.transports=Lf,ks.retryCodes=Lf,ks.maxRetryCnt={isVal:J1,v:10},ks));(sg={})[Wy.dataType]=c9,sg[ZE.dataType]=function p9(a,o,g){o_(a,o);var w=o[Wi].message,l=o[Wi].severityLevel,u=o[Wi][El]||{},h=o[Wi][z0]||{};return i_(o[Bu],u,h),tn(g)||og(u,g),g=new ZE(a,w,l,u,h),w=new tg(ZE[Of],g),Uu(a,ZE[e_],o,w)},sg[Zy.dataType]=function h9(a,o,P){o_(a,o);var l,D=(tn(D=o[Wi])||tn(D[El])||tn(D[El][U0])?tn(o[Bu])||tn(o[Bu][U0])||(l=o[Bu][U0],delete o[Bu][U0]):(l=D[El][U0],delete D[El][U0]),o[Wi]),u=(((o.ext||{}).trace||{})[rx]&&(u=o.ext.trace[rx]),D.id||u),h=D[Jy],g=D.uri,w=D[El]||{},T=D[z0]||{};return tn(D.refUri)||(w.refUri=D.refUri),tn(D.pageType)||(w.pageType=D.pageType),tn(D.isLoggedIn)||(w.isLoggedIn=D.isLoggedIn[j0]()),tn(D[El])||Pi(D[El],function(N,z){w[N]=z}),i_(o[Bu],w,T),tn(P)||og(w,P),D=new Zy(a,h,g,l,w,T,u),P=new tg(Zy[Of],D),Uu(a,Zy[e_],o,P)},sg[pA.dataType]=function d9(a,o,w){o_(a,o);var l=o[Wi],T=l[Jy],u=l.uri||l.url,h=l[El]||{},g=l[z0]||{};return i_(o[Bu],h,g),tn(w)||og(h,w),w=new pA(a,T,u,void 0,h,g,l),T=new tg(pA[Of],w),Uu(a,pA[e_],o,T)},sg[cd.dataType]=function iae(a,o,u){o_(a,o);var l=o[Wi][z0]||{},h=(i_(o[Bu],h=o[Wi][El]||{},l),tn(u)||og(h,u),u=cd.CreateFromInterface(a,u=o[Wi],h,l),new tg(cd[Of],u));return Uu(a,cd[e_],o,h)},sg[WE.dataType]=function u9(a,o,h){o_(a,o);var l=(g=o[Wi])[El]||{},u=g[z0]||{},g=(i_(o[Bu],l,u),tn(h)||og(l,h),h=new WE(a,g[Jy],g.average,g.sampleCount,g.min,g.max,g.stdDev,l,u),new tg(WE[Of],h));return Uu(a,WE[e_],o,g)},sg[YE.dataType]=function s_(a,o,g){o_(a,o);var l,u=o[Wi][z0]||{},h=o[Wi][El]||{};return i_(o[Bu],h,u),tn(g)||og(h,g),tn(g=o[Wi])?(E0(a,"Invalid input for dependency data"),null):(l=new YE(a,g.id,g.target,g[Jy],g[U0],g.success,g.responseCode,l=g[El]&&g[El][pG]?g[El][pG]:"GET",g.type,g.correlationContext,h,u),g=new tg(YE[Of],l),Uu(a,YE[e_],o,g))};var oz=sg,RO=function(a){function o(){var i,l,u,h,g,w,T,D,P,N,z,W,ue,ge,we,Re,et,Mt,St,Qt,Le,Je,ot,Et,Kt,Ne,lt,It,xt,ln,Sn,We,on,Rn,sr=a.call(this)||this,nn=(sr.priority=1001,sr.identifier=MG,0);return ko(o,sr,function(dt,pi){function Qn(Me,Pe){var Ft=PO(Me);!Me||Ft+""!="200"&&""!==Ft?(Ft=oU(Ft))&&Ft[IO]&&Ft[IO]>Ft[QU]&&!Le?dt[ZU](Pe,Ft):dt[ox](Pe,v0(Me)):(i=0,dt[CO](Pe,0))}function ar(Me,Pe,Ft){4===Me.readyState&&Jt(Me.status,Pe,Me.responseURL,Ft,_k(Me),PO(Me)||Me.response)}function Wr(Me){try{var Pe;if(Me)return(Pe=Me[XU])&&Pe[zi]?Pe:null}catch{}return null}function zn(Me,Pe){return!(Mt||(Me?Me.baseData&&!Me[JU]?(Pe&&En(Pe,1,70,"Cannot send telemetry without baseData and baseType"),1):(Me[JU]||(Me[JU]="EventData"),dt[xO]?dt._sample.isSampledIn(Me)?(Me[dG]=dt._sample[sx],0):(Pe&&En(Pe,2,33,"Telemetry item was sampled out and not sent",{SampleRate:dt._sample[sx]}),1):(Pe&&En(Pe,1,28,"Sender was not initialized"),1)):(Pe&&En(Pe,1,7,"Cannot send empty telemetry"),1)))}function Fr(Me,Pe){var kt=o.constructEnvelope(Me,Me.iKey||St,Pe,Qt);if(kt){var en=!1;if(Me[nc]&&Me[nc][eO]&&(Hn(Me[nc][eO],function(Yn){try{Yn&&!1===Yn(kt)&&(en=!0,E0(Pe,"Telemetry processor check returns false"))}catch(ut){En(Pe,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+to(ut),{exception:Mn(ut)},!0)}}),delete Me[nc][eO]),!en)return kt}else En(Pe,1,47,"Unable to create an AppInsights envelope")}function So(Me){var Pe="",Ft=dt[iu]();try{var kt=zn(Me,Ft),en=null;(en=kt?Fr(Me,Ft):en)&&(Pe=g[TO](en))}catch{}return Pe}function Ao(Me){return Me&&Me[zi]?"["+Me.join(",")+"]":""}function Ht(Me){var Pe=st(),Ft={urlString:z};return Ft[Bu]=Me,Ft.headers=Pe,Ft}function yn(ut,Pe,Ft,kt){void 0===kt&&(kt=!0);var Yn=gr(Pe);return(ut=ut&&ut.sendPOST)&&Yn?(kt&&dt._buffer[IA](Pe),ut(Yn,function en(Dt,qt,Tr){var _i;_i=Pe,200===Dt&&_i?dt._onSuccess(_i,_i[zi]):Tr&&dt[ox](_i,Tr)},!Ft)):null}function gr(Me){var Pe,Ft,kt;return Di(Me)&&0<Me[zi]?(Ft=dt[r_].batchPayloads(Me),kt=st(),(Pe={})[Bu]=Ft,Pe.urlString=z,Pe.headers=kt,Pe.disableXhrSync=It,Pe.disableFetchKeepAlive=!xt,Pe[XU]=Me,Pe):null}function st(){try{var Me=T||{};return hp(z)&&(Me[rs[6]]=rs[7]),Me}catch{}return null}function Ut(Me){Me=Me?Me[zi]:0,dt[r_].size()+Me>ue&&(P&&!P.isOnline()||dt[EO](!0,null,10))}function Jt(Me,Pe,Ft,kt,en,Yn){var ut=null;dt._appId||(ut=oU(Yn))&&ut.appId&&(dt._appId=ut.appId),(Me<200||300<=Me)&&0!==Me?(301!==Me&&307!==Me&&308!==Me||oe(Ft))&&!Le&&ct(Me)?(ye(Pe),En(dt[iu](),2,40,". Response code "+Me+". Will retry to send "+Pe[zi]+" items.")):dt[ox](Pe,en):P&&!P.isOnline()?Le||(ye(Pe,10),En(dt[iu](),2,40,". Offline - Response Code: ".concat(Me,". Offline status: ").concat(!P.isOnline(),". Will retry to send ").concat(Pe.length," items."))):(oe(Ft),206===Me?(ut=ut||oU(Yn))&&!Le?dt[ZU](Pe,ut):dt[ox](Pe,en):(i=0,dt[CO](Pe,kt)))}function oe(Me){return!(10<=w||tn(Me)||""===Me||Me===z)&&(z=Me,++w,1)}function ne(Me,Pe){if(!D)return yn(on&&on[YU]([3],!0),Me,Pe);D(Me,!1)}function X(Me){try{if(Me&&Me[zi])return xr(Me[0])}catch{}}function ie(Me,Pe){var Ft=null;if(Di(Me)){for(var kt=Me[zi],en=0;en<Me[zi];en++)kt+=Me[en].item[zi];return on.getSyncFetchPayload()+kt<=65e3?Ft=2:DE()?Ft=3:(Ft=1,En(dt[iu](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender.")),yn(on&&on[YU]([Ft],!0),Me,Pe)}return null}function ye(Me,Pe){if(void 0===Pe&&(Pe=1),Me&&0!==Me[zi]){var Ft=dt[r_];Ft[dd](Me),i++;for(var kt,en=0,Yn=Me;en<Yn.length;en++){var ut=Yn[en];ut.cnt=ut.cnt||0,ut.cnt++,Ft[t_](ut)}Me=Pe,Me=i<=1?10:(kt=(Math.pow(2,i)-1)/2,kt=Math.floor(Math.random()*kt*10)+1,kt*=Me,Math.max(Math.min(kt,3600),10)),kt=xf()+1e3*Me,l=kt,De()}}function De(){var Me;h||u||(Me=l?Math.max(0,l-xf()):0,Me=Math.max(Je,Me),h=_h(function(){h=null,dt[EO](!0,null,1)},Me))}function Ke(){h&&h.cancel(),l=h=null}function ct(Me){return tn(Rn)?401===Me||408===Me||429===Me||500===Me||502===Me||503===Me||504===Me:Rn[zi]&&-1<Rn.indexOf(Me)}function wt(){dt[xO]=null,dt[r_]=null,dt._appId=null,dt._sample=null,ue=nn=w=i=0,Kt=Qt=Lf,We=xt=It=Le=Mt=ge=u=!(T={}),on=Sn=ln=ot=St=et=W=z=N=D=g=h=l=P=null,eo(dt,"_senderConfig",{g:function(){return SB({},iz)}})}wt(),dt.pause=function(){Ke(),u=!0},dt.resume=function(){u&&(u=!1,l=null,Ut(),De())},dt.flush=function(Me,Pe,Ft){if(void 0===Me&&(Me=!0),!u){Ke();try{return dt[EO](Me,null,Ft||1)}catch(kt){En(dt[iu](),1,22,"flush failed, telemetry will not be collected: "+to(kt),{exception:Mn(kt)})}}},dt.onunloadFlush=function(){if(!u)if(ge||lt)try{return dt[EO](!0,ne,2)}catch(Me){En(dt[iu](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+to(Me),{exception:Mn(Me)})}else dt.flush(!1)},dt.addHeader=function(Me,Pe){T[Me]=Pe},dt[KU]=function(Me,Pe,Ft,kt){dt.isInitialized()&&En(dt[iu](),1,28,"Sender is already initialized"),pi[KU](Me,Pe,Ft,kt);var en=dt.identifier,Yn=(g=new f9(Pe.logger),i=0,l=null,dt[xO]=null,w=0,dt[iu]());N=lp(ku("Sender"),Pe.evtNamespace&&Pe.evtNamespace()),P=function Zse(a){var o,i=Jl(),l=Xd(),u=!1,h=[],g=1,w=(!l||tn(l.onLine)||l.onLine||(g=2),0),T=N(),D=lp(ku("OfflineListener"),a);try{P(Ru())&&(u=!0),i&&(o=i.body||i).ononline&&P(o)&&(u=!0)}catch{u=!1}function P(ge){var we=!1;return ge&&(we=Nu(ge,"online",W,D))&&Nu(ge,"offline",ue,D),we}function N(){return 2!==w&&2!==g}function z(){var ge=N();T!==ge&&(T=ge,Hn(h,function(we){var Re={isOnline:T,rState:g,uState:w};try{we(Re)}catch{}}))}function W(){g=1,z()}function ue(){g=2,z()}return{isOnline:function(){return T},isListening:function(){return u},unload:function(){var ge=Ru();ge&&u&&(xJ(ge,D),i&&!bs((ge=i.body||i).ononline)&&xJ(ge,D),u=!1)},addListener:function(ge){return h[od](ge),{rm:function(){var we=h.indexOf(ge);if(-1<we)return h.splice(we,1)}}},setOnlineState:function(ge){w=ge,z()}}}(N),dt._addHook(xa(Me,function(ut){(ut=ut.cfg).storagePrefix&&wU(ut.storagePrefix);var me,J,Dt=ap(null,ut,Pe).getExtCfg(en,iz),vi=(eo(dt,"_senderConfig",{g:function(){return Dt}}),Pe.activeStatus()===My.PENDING?dt.pause():Pe.activeStatus()===My.ACTIVE&&dt.resume(),W!==Dt.endpointUrl&&(z=W=Dt.endpointUrl),et&&et!==Dt[r9]&&Hn(et,function(me){delete T[me.header]}),ue=Dt[zJ],ge=(!1===Dt[i9]||!1===Dt[o9])&&DE(),we=!1===Dt[i9]&&DE(),Re=!1===Dt[o9]&&DE(),lt=Dt[jJ],It=!!Dt[s9],Rn=Dt.retryCodes,Dt[qU]),In=!!Dt[HJ]&&(!!vi||dA()),_i=Dt.namePrefix,Tr=In!==ot||In&&Kt!==_i||In&&Et!==vi;if(dt[r_]){if(Tr)try{dt._buffer=dt._buffer[wO](Yn,Dt,In)}catch(me){En(dt[iu](),1,12,"failed to transfer telemetry to different buffer storage, telemetry will be lost: "+to(me),{exception:Mn(me)})}Ut()}else dt[r_]=new(In?rz:SO)(Yn,Dt);Kt=_i,ot=In,Et=vi,xt=!Dt[WU]&&NB(!0),We=!!Dt[$J],dt._sample=new y9(Dt.samplingPercentage,Yn),me=St=Dt[qJ],(!tn(J=(J=ut).disableInstrumentationKeyValidation)&&J?1:new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(me))||En(Yn,1,100,"Invalid Instrumentation key "+St),et=Dt[r9],xr(z)&&!hp(z)&&et&&0<et[zi]?Hn(et,function(me){sr.addHeader(me.header,me.value)}):et=null,Ne=Dt[GJ],Tr=function(){var me;try{var J={xdrOnComplete:function(se,le,Ce){if(Ce=Wr(Ce))return Qn(se,Ce)},fetchOnComplete:function(se,le,Ce,Ue){if(Ue=Wr(Ue))return Jt(se.status,Ue,se.url,Ue[zi],se.statusText,Ce||"")},xhrOnComplete:function(se,le,Ce){if(Ce=Wr(Ce))return ar(se,Ce,Ce[zi])},beaconOnRetry:function(se,le,Ce){var Ue=le,Xe=Ce,He=se&&se[XU];if(We)Sn&&Sn(He,!0),En(dt[iu](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender.");else{for(var Ve=[],$e=0;$e<He[zi];$e++){var Rt=He[$e],Ot=[Rt];Xe(gr(Ot),Ue)?dt._onSuccess(Ot,Ot[zi]):Ve[H0](Rt)}0<Ve[zi]&&(Sn&&Sn(Ve,!0),En(dt[iu](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}};return(me={})[GJ]=Ne,me.isOneDs=!1,me.disableCredentials=!1,me[s9]=It,me.disableBeacon=!Re,me.disableBeaconSync=!we,me.senderOnCompleteCallBack=J,me}catch{}return null}(),on?on.SetConfig(Tr):(on=new Gse)[KU](Tr,Yn),_i=Dt.httpXHROverride,In=mq([3,1,2],Dt.transports);var qt,Li=on&&on[YU](In,!1),os=on&&on.getFallbackInst();ln=function(me,J){return yn(os,me,J)},Sn=function(me,J){return yn(os,me,J,!1)},Li=lt?_i:Li||_i||os,dt[xO]=function(me,J){return yn(Li,me,J)},xt&&(D=ie),vi=mq([3,1],Dt[KJ]),xt||(vi=vi.filter(function(me){return 2!==me})),qt=on&&on[YU](vi,!0),qt=!lt&&qt||_i,D=(D=(lt||Dt[KJ]||!D)&&qt?function(me,J){return yn(qt,me,J)}:D)||ln,Mt=Dt.disableTelemetry,Qt=Dt[WJ]||Lf,Le=Dt.isRetryDisabled,Je=Dt[YJ]}))},dt.processTelemetry=function(Me,Pe){var Ft,kt=(Pe=dt._getTelCtx(Pe))[iu]();try{if(!zn(Me,kt))return;var en=Fr(Me,kt);if(!en)return;var Yn=g[TO](en),ut=dt[r_],Dt=(Ut(Yn),(Ft={})[vO]=Yn,Ft.cnt=0,Ft);ut[t_](Dt),De()}catch(qt){En(kt,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+to(qt),{exception:Mn(qt)})}dt.processNext(Me,Pe)},dt.isCompletelyIdle=function(){return!u&&0===nn&&0===dt._buffer[n_]()},dt._xhrReadyStateChange=function(Me,Pe,Ft){if(!X(Pe))return ar(Me,Pe,Ft)},dt[EO]=function(Me,Pe,Ft){var kt,Tr;if(void 0===Me&&(Me=!0),!u)try{var en=dt[r_];if(Mt)en[ix]();else if(0<en[n_]()){var Yn=en.getItems(),ut=Ft||0,Dt=Me,qt=dt.core[Tr="getNotifyMgr"]?dt.core.getNotifyMgr():dt.core._notificationManager;if(qt&&qt[ez])try{qt[ez](ut,Dt)}catch(Tr){En(dt[iu](),1,74,"send request notification failed: "+to(Tr),{exception:Mn(Tr)})}kt=Pe?Pe.call(dt,Yn,Me):dt[xO](Yn,Me)}Ke()}catch(Tr){(!(en=OB())||9<en)&&En(dt[iu](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+to(Tr),{exception:Mn(Tr)})}return kt},dt.getOfflineSupport=function(){var Me={getUrl:function(){return z},createPayload:Ht};return Me[TO]=So,Me.batch=Ao,Me.shouldProcess=function(Pe){return!!zn(Pe)},Me},dt._doTeardown=function(Me,Pe){dt.onunloadFlush(),PE(P,!1),wt()},dt[ox]=function(Me,Pe,Ft){if(!X(Me))return En(dt[iu](),2,26,"Failed to send telemetry.",{message:Pe}),void(dt._buffer&&dt._buffer[dd](Me))},dt[ZU]=function(Me,Pe){if(!X(Me)){for(var Ft=Me,kt=[],en=[],Yn=0,ut=Pe=(Me=Pe).errors.reverse();Yn<ut.length;Yn++){var Dt=ut[Yn],qt=Ft.splice(Dt.index,1)[0];(ct(Dt.statusCode)?en:kt)[H0](qt)}0<Ft[zi]&&dt[CO](Ft,Me[QU]),0<kt[zi]&&dt[ox](kt,_k(null,["partial success",Me[QU],"of",Me.itemsReceived].join(" "))),0<en[zi]&&(ye(en),En(dt[iu](),2,40,"Partial success. Delivered: "+Ft[zi]+", Failed: "+kt[zi]+". Will retry to send "+en[zi]+" our of "+Me[IO]+" items"))}},dt[CO]=function(Me,Pe){X(Me)||dt._buffer&&dt._buffer[dd](Me)},dt._xdrOnLoad=function(Me,Pe){if(!X(Pe))return Qn(Me,Pe)}}),sr}return nu(o,a),o.constructEnvelope=function(i,l,u,h){return i=l===i.iKey||tn(l)?i:tu(tu({},i),{iKey:l}),(oz[i.baseType]||c9)(u,i,h)},o}($y),sz="duration",a_="properties",pd="requestUrl",il="inst",zu="length",Ff="traceID",q0="spanID",pp="traceFlags",SA="context",ax="aborted",lx="traceId",G0="spanId",MO="_addHook",Th="core",az="includeCorrelationHeaders",b9="getAbsoluteUrl",cx="headers",fp="requestHeaders",E9="setRequestHeader",XJ="trackDependencyDataInternal",ux="startTime",AA="toLowerCase",lz="enableRequestHeaderTracking",cz="enableAjaxErrorStatusText",JJ="enableAjaxPerfTracking",eee="maxAjaxCallsPerView",tee="excludeRequestFromAutoTrackingPatterns",hx="addRequestContext",dx="disableAjaxTracking",K0="ajaxPerfLookupDelay",px="disableFetchTracking",kO="enableResponseHeaderTracking",mp="status",ag="statusText",fx="headerMap",mx="openDone",OO="sendDone",l_="requestSentTime",NO="abortDone",DA="getTraceId",x9="getTraceFlags",W0="method",uz="errorStatusText",nee="stateChangeAttached",Y0="responseText",c_="responseFinishedTime",gx="CreateTrackItem",yx="response",PA="getAllResponseHeaders",_x="getPartAProps",LO="perfMark",u_="name",vx="perfTiming",RA="exception",T9="ajaxDiagnosticsMessage",FO="correlationContext",hz="ajaxTotalDuration",dz="eventTraceCtx";function C9(h,u,i){return u=h[u],h=h[i],u&&h?Eh(u,h):0}function wx(a,o,g,l,u){return(g=C9(g,l,u))?h_(a,o,Yy(g)):0}function h_(a,o,i){var l=0;return a&&o&&i&&((a.ajaxPerf=a.ajaxPerf||{})[o]=i,l=1),l}var Va,oae=function(){this[mx]=!1,this.setRequestHeaderDone=!1,this[OO]=!1,this[NO]=!1,this[nee]=!1},VO=function(){function a(o,i,l,u){var h=this,g=l;h[LO]=null,h.completed=!1,h.requestHeadersSize=null,h[fp]=null,h.responseReceivingDuration=null,h.callbackDuration=null,h[hz]=null,h[ax]=0,h.pageUrl=null,h[pd]=null,h.requestSize=0,h[W0]=null,h[mp]=null,h[l_]=null,h.responseStartedTime=null,h[c_]=null,h.callbackFinishedTime=null,h.endTime=null,h.xhrMonitoringState=new oae,h.clientFailure=0,h[Ff]=o,h[q0]=i,h[pp]=u?.getTraceFlags(),h[dz]=u?((l={})[lx]=u[DA](),l[G0]=u.getSpanId(),l[pp]=u[x9](),l):null,ko(a,h,function(w){w.getAbsoluteUrl=function(){return w[pd]?function wG(i){return(i=lA(i))?i.href:undefined}(w[pd]):null},w.getPathName=function(){return w[pd]?aA(g,function sJ(a,o){return a?a.toUpperCase()+" "+o:o}(w[W0],w[pd])):null},w[gx]=function(T,D,P){var N;return w.ajaxTotalDuration=Math.round(1e3*Eh(w.requestSentTime,w.responseFinishedTime))/1e3,w[hz]<0?null:((N={id:"|"+w[Ff]+"."+w[q0],target:w[b9]()})[u_]=w.getPathName(),N.type=T,N[ux]=null,N.duration=w[hz],N.success=200<=+w[mp]&&+w[mp]<400,N.responseCode=+w[mp],N[a_]={HttpMethod:w[W0]},N=(T=N)[a_],w[ax]&&(N[ax]=!0),w[l_]&&(T[ux]=new Date,T[ux].setTime(w[l_])),function pz(a,o){var i,l=a[vx],u=o[a_]||{},h=0,g="domainLookup",w="connect",T="request",D="response",P=w+"End",N=T+(N="Start"),z=D+"End",W="transferSize",ue="encodedBodySize",ge="decodedBodySize",we="serverTiming";l?(h=(h=(h=(h=(h=(h=(h|=wx(u,"End",l,"redirectStart","End"))|wx(u,g,l,"domainLookupStart","domainLookupEnd"))|wx(u,w,l,"connectStart",P))|wx(u,T,l,N,"requestEnd"))|wx(u,D,l,"responseStart",z))|wx(u,"networkConnect",l,"startTime",P))|wx(u,"sentRequest",l,N,z),g=(g=l[sz])||C9(l,"startTime",z)||0,h=(h|=h_(u,sz,g))|h_(u,"perfTotal",g),(w=l[we])&&(i={},Hn(w,function(Re,Mt){Mt=mk(Re.name||""+Mt);var St=i[Mt]||{};Pi(Re,function(Qt,Le){!("name"!==Qt&&xr(Le)||J1(Le))||!(Le=St[Qt]?St[Qt]+";"+Le:Le)&&xr(Le)||(St[Qt]=Le)}),i[Mt]=St}),h|=h_(u,we,i)),h=(h=(h|=h_(u,W,l[W]))|h_(u,ue,l[ue]))|h_(u,ge,l[ge])):a[LO]&&(h|=h_(u,"missing",a.perfAttempts)),h&&(o[a_]=u)}(w,T),D&&0<Kd(w.requestHeaders)[zu]&&(N[fp]=w[fp]),P&&(D=P())&&((P=D[FO])&&(T.correlationContext=P),D[fx]&&0<Kd(D.headerMap)[zu]&&(N.responseHeaders=D[fx]),w[uz])&&(400<=w[mp]?(""!==(P=D.type)&&"text"!==P||(N.responseText=D.responseText?D[ag]+" - "+D.responseText:D[ag]),"json"===P&&(N.responseText=D.response?D[ag]+" - "+JSON.stringify(D[yx]):D[ag])):0===w[mp]&&(N.responseText=D[ag]||"")),T)},w[_x]=function(){var T,D=null,P=w[dz];return P&&(P[lx]||P[G0])&&(T=(D={}).trace=((T={})[Ff]=P[lx],T.parentID=P[G0],T),tn(P[pp])||(T[pp]=P[pp])),D}})}return a.__ieDyn=1,a}(),MA="diagLog",lg="_ajaxData",cg="fetch",kA="Failed to monitor XMLHttpRequest",ree=", monitoring data for this ajax call ",bx=ree+"may be incorrect.",Ex=ree+"won't be sent.",BO="Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",fz="Failed to add custom defined request context as configured call back may missing a null check.",mz="Failed to calculate the duration of the ",I9=0,Z0=function(a,o){return a&&o&&a[lg]?(a[lg].i||{})[o]:null},S9=function(a,o){var i=!1;return a&&(a=(a[lg]||{}).xh)&&Hn(a,function(l){if(l.n===o)return i=!0,-1}),i};function gz(a,o){var i="";try{var l=Z0(a,o);l&&l[pd]&&(i+="(url: '"+l[pd]+"')")}catch{}return i}function UO(a,o,i,l,u){En(a[MA](),1,o,i,l,u)}function ug(a,o,i,l,u){En(a[MA](),2,o,i,l,u)}function xx(a,o,i){return function(l){var u;UO(a,o,i,((u={ajaxDiagnosticsMessage:gz(l[il],a._ajaxDataId)})[RA]=Mn(l.err),u))}}function Tx(a,o){return a&&o?ec(a,o):-1}function yz(a,o,i){var l={id:o,fn:i};return a.push(l),{remove:function(){Hn(a,function(u,h){if(u.id===l.id)return a.splice(h,1),-1})}}}function _z(a,o,i,l){var u=!0;return Hn(o,function(h,g){try{!1===h.fn.call(null,i)&&(u=!1)}catch(w){En(a&&a.logger,1,64,"Dependency "+l+" [#"+g+"] failed: "+to(w),{exception:Mn(w)},!0)}}),u}var zO="*.blob.core.",A9=Ay([zO+"windows.net",zO+"chinacloudapi.cn",zO+"cloudapi.de",zO+"usgovcloudapi.net"]),see=[/https:\/\/[^\/]*(\.pipe\.aria|aria\.pipe|events\.data|collector\.azure)\.[^\/]+\/(OneCollector\/1|Collector\/3)\.0/i],lae=Ay(((Va={})[eee]=500,Va[dx]=!1,Va[px]=!1,Va[tee]=void 0,Va.disableCorrelationHeaders=!1,Va.distributedTracingMode=1,Va.correlationHeaderExcludedDomains=A9,Va.correlationHeaderDomains=void 0,Va.correlationHeaderExcludePatterns=void 0,Va.appId=void 0,Va.enableCorsCorrelation=!1,Va[lz]=!1,Va[kO]=!1,Va[cz]=!1,Va[JJ]=!1,Va.maxAjaxPerfLookupAttempts=3,Va[K0]=25,Va.ignoreHeaders=["Authorization","X-API-Key","WWW-Authenticate"],Va[hx]=void 0,Va.addIntEndpoints=!0,Va)),D9=function(a){function o(){var i,l,u,h,g,w,T,D,P,N,z,W,ue,ge,we,Re,et,Mt,St,Qt,Le,Je,ot,Et,Kt,Ne,lt,It,xt,ln,Sn=a.call(this)||this;return Sn.identifier=o.identifier,Sn.priority=120,ko(o,Sn,function(We,on){var Rn=on[MO];function sr(){var Ht=rp();ln=l=i=!1,u=Ht&&Ht.host&&Ht.host[AA](),ge=W=N=P=w=g=!1,et=Re=!(we={}),Qt=St=Mt=z=D=h=null,Je=ue=T=0,ot=[],Et=[],Le=ku("ajaxData"),We._ajaxDataId=Le,It=lt=Ne=1,xt=Kt=null}function nn(Ht){var yn=!0;return(Ht||Kt)&&Hn(Kt,function(gr){if(gr[AA]()===Ht[AA]())return yn=!1,-1}),yn}function dt(Ht,yn,gr){Rn(function cU(a,o,i){return a?hG(a[tp],o,i,!1):null}(Ht,yn,gr))}function pi(Ht,yn,gr){var st,Ut,Jt=!1,oe=((xr(yn)?yn:(yn||{}).url||"")||"")[AA]();return Hn(Mt,function(ne){var X=ne;xr(ne)&&(X=new RegExp(ne)),Jt=Jt||X.test(oe)}),Jt||(st=Tx(oe,"?"),Ut=Tx(oe,"#"),-1!==(st=-1===st||-1!==Ut&&Ut<st?Ut:st)&&(oe=oe.substring(0,st)),tn(Ht)?tn(yn)||(Jt="object"==typeof yn&&!0===yn[Jk]||!!gr&&!0===gr[Jk]):Jt=!0===Ht[Jk]||!0===oe[Jk],(Jt=!(Jt||!oe||!hp(oe))||Jt)?we[oe]||(we[oe]=1):we[oe]&&(Jt=!0)),Jt}function Qn(Ht,yn,gr){var st=!0,Ut=l;return tn(Ht)||(st=!0===gr||!tn(yn)),Ut&&st}function ar(){var Ht=null;return!(Ht=We[Th]&&We[Th].getTraceCtx?We[Th].getTraceCtx(!1):Ht)&&D&&D.telemetryTrace?dp(D.telemetryTrace):Ht}function Wr(Ht,yn){var gr;yn[pd]&&z&&W&&(gr=Bm())&&$r(gr.mark)&&(Ht=z+Ht+"#"+ ++I9,gr.mark(Ht),gr=gr.getEntriesByName(Ht))&&1===gr[zu]&&(yn[LO]=gr[0])}function zn(Ht,yn,gr,st){var Ut=yn[LO],Jt=Bm(),oe=Ne,ne=lt,X=yn[pd],ie=0;!function ye(){try{if(Jt&&Ut){ie++;for(var De=null,Ke=Jt.getEntries(),ct=Ke[zu]-1;0<=ct;ct--){var wt=Ke[ct];if(wt){if("resource"===wt.entryType)wt.initiatorType!==Ht||-1===Tx(wt[u_],X)&&-1===Tx(X,wt[u_])||(De=wt);else if("mark"===wt.entryType&&wt[u_]===Ut[u_]){yn[vx]=De;break}if(wt[ux]<Ut[ux]-1e3)break}}}!Ut||yn[vx]||oe<=ie||!1===yn.async?(Ut&&$r(Jt.clearMarks)&&Jt.clearMarks(Ut[u_]),yn.perfAttempts=ie,gr()):_h(ye,ne)}catch(Me){st(Me)}}()}function Fr(Ht){var yn="";try{tn(Ht)||(yn+="(url: '".concat("string"==typeof Ht?Ht:Ht.url,"')"))}catch(gr){UO(We,15,"Failed to grab failed fetch diagnostics message",{exception:Mn(gr)})}return yn}function So(Ht,yn,gr,st,Ut,Jt){function oe(ne,X,ie){(ie=ie||{}).fetchDiagnosticsMessage=Fr(gr),X&&(ie.exception=Mn(X)),ug(We,ne,mz+"fetch call"+Ex,ie)}Ut&&(Ut[c_]=uA(),Ut[mp]=yn,zn(cg,Ut,function(){var ne,X=Ut[gx]("Fetch",g,Jt);try{St&&(ne=St({status:yn,request:gr,response:st}))}catch{ug(We,104,fz)}X?(void 0!==ne&&(X[a_]=tu(tu({},X.properties),ne)),ne=Ut[_x](),Ao(Et,We[Th],Ut,X,null,ne)):oe(14,null,{requestSentTime:Ut[l_],responseFinishedTime:Ut[c_]})},function(ne){oe(18,ne,null)}))}function Ao(Ht,yn,gr,st,Ut,Jt){var oe,ne=!0;0<Ht[zu]&&((oe={item:st})[a_]=Ut,oe.sysProperties=Jt,oe.context=gr?gr[SA]:null,oe.aborted=!!gr&&!!gr[ax],ne=_z(yn,Ht,oe,"initializer")),ne&&We[XJ](st,Ut,Jt)}sr(),We.initialize=function(Ht,yn,gr,st){var Ut,Jt;!We.isInitialized()&&(on.initialize(Ht,yn,gr,st),Qt=lp(ku("ajax"),yn&&yn.evtNamespace&&yn.evtNamespace()),We[MO](xa(Ht,function(oe){oe=ap(null,oe.cfg,We[Th]),h=oe.getExtCfg(o.identifier,lae),It=h.distributedTracingMode,g=h[lz],w=h[cz],W=h[JJ],ue=h[eee],Mt=[].concat(h[tee]||[],!1!==h.addIntEndpoints?see:[]),St=h[hx],N=0===It||1===It,P=1===It||2===It,W&&(z=Le),Re=!!h[dx],Ne=h.maxAjaxPerfLookupAttempts,lt=h[K0],Kt=h.ignoreHeaders,xt=h.appId})),function iee(a,o){var i,l=!1,u=($S()&&(l=!(tn(u=XMLHttpRequest[tp])||tn(u.open)||tn(u.send)||tn(u.abort))),OB());if(l=!(u&&u<9)&&l)try{var h=new XMLHttpRequest,g={xh:[],i:((i={})[o]={},i)},w=(h[lg]=g,XMLHttpRequest[tp].open);XMLHttpRequest[tp].open=w}catch(T){l=!1,UO(a,15,"Failed to enable XMLHttpRequest monitoring, extension is not supported",((u={})[RA]=Mn(T),u))}return l}(We,Le)&&We[MO](xa(h,function(){g=h[lz],(Re=!!h[dx])||l||(dt(XMLHttpRequest,"open",{ns:Qt,req:function(oe,ne,X,ie){var ye,De,Ke,ct,wt,Me,Pe;Re||(ye=Z0(oe=oe[il],Le),!pi(oe,X)&&Qn(oe,ye,!0)&&(ye&&ye.xhrMonitoringState[mx]||(ct=oe,Me=(wt=ar())&&wt[DA]()||C0(),Pe=Dy(C0(),0,16),(Me=(ct=(ct=ct[lg]=ct[lg]||{xh:[],i:{}}).i=ct.i||{})[Le]=ct[Le]||new VO(Me,Pe,We[MA](),null==(ct=We.core)?void 0:ct.getTraceCtx()))[pp]=wt&&wt[x9](),Me[W0]=ne,Me[pd]=X,Me.xhrMonitoringState[mx]=!0,Me[fp]={},Me.async=ie,Me[uz]=w,ye=Me),(Ke=ye).xhrMonitoringState[nee]=Nu(De=oe,"readystatechange",function(){var Ft,kt,en;try{De&&4===De.readyState&&Qn(De,Ke)&&((en=Z0(kt=De,Le))[c_]=uA(),en[mp]=kt[mp],zn("xmlhttprequest",en,function(){try{var Dt,qt=en[gx]("Ajax",g,function(){var In,Li,os;return(os={statusText:kt[ag]})[fx]=null,os[FO]=function(vi){try{var me=vi[PA]();if(null!==me&&-1!==Tx(me[AA](),rs[8]))return _U(vi.getResponseHeader(rs[0]))}catch(J){ug(We,18,BO,((me={})[T9]=gz(vi,Le),me[RA]=Mn(J),me))}}(kt),os.type=kt.responseType,os[Y0]=function(vi){try{var me=vi.responseType;if(""===me||"text"===me)return vi[Y0]}catch{}return null}(kt),os.response=kt[yx],ge&&(In=kt[PA]())&&(In=Ea(In).split(/[\r\n]+/),Li={},Hn(In,function(J){var me=(J=J.split(": ")).shift();J=J.join(": "),nn(me)&&(Li[me]=J)}),os[fx]=Li),os}),Tr=void 0;try{St&&(Tr=St({status:kt[mp],xhr:kt}))}catch{ug(We,104,fz)}qt?(void 0!==Tr&&(qt[a_]=tu(tu({},qt.properties),Tr)),Dt=en[_x](),Ao(Et,We[Th],en,qt,null,Dt)):ut(null,{requestSentTime:en[l_],responseFinishedTime:en[c_]})}finally{try{var _i=(kt[lg]||{i:{}}).i||{};_i[Le]&&(_i[Le]=null)}catch{}}},function(Dt){ut(Dt,null)}))}catch(Dt){var Yn=Mn(Dt);Yn&&-1!==Tx(Yn[AA](),"c00c023f")||UO(We,16,kA+" 'readystatechange' event handler"+bx,((Ft={})[T9]=gz(De,Le),Ft[RA]=Yn,Ft))}function ut(Dt,qt){(qt=qt||{}).ajaxDiagnosticsMessage=gz(kt,Le),Dt&&(qt.exception=Mn(Dt)),ug(We,14,mz+"ajax call"+Ex,qt)}},Qt)))},hkErr:xx(We,15,kA+".open"+bx)}),dt(XMLHttpRequest,"send",{ns:Qt,req:function(oe,ne){var X;Re||Qn(oe=oe[il],X=Z0(oe,Le))&&!X.xhrMonitoringState[OO]&&(Wr("xhr",X),X[l_]=uA(),We[az](X,void 0,void 0,oe),X.xhrMonitoringState[OO]=!0)},hkErr:xx(We,17,kA+bx)}),dt(XMLHttpRequest,"abort",{ns:Qt,req:function(oe){Re||Qn(oe=oe[il],oe=Z0(oe,Le))&&!oe.xhrMonitoringState[NO]&&(oe[ax]=1,oe.xhrMonitoringState[NO]=!0)},hkErr:xx(We,13,kA+".abort"+bx)}),dt(XMLHttpRequest,"setRequestHeader",{ns:Qt,req:function(oe,ne,X){var ie;Re||(ie=Z0(oe=oe[il],Le))&&Qn(oe,ie)&&(function(a,o,i){a&&(a=(a[lg]||{}).xh)&&a.push({n:o,v:i})}(oe,ne,X),g)&&nn(ne)&&ie&&(ie[fp][ne]=X)},hkErr:xx(We,71,kA+".setRequestHeader"+bx)}),l=!0)})),(gr=function sae(){var a=Pu();return!a||tn(a.Request)||tn(a.Request[tp])||tn(a[cg])?null:a[cg]}())&&(Ut=Pu(),Jt=gr.polyfill,We[MO](xa(h,function(){ge=h[kO],(et=!!h[px])||i?Jt&&!ln&&(Rn(hG(Ut,cg,{ns:Qt,req:function(oe,ne,X){pi(null,ne,X)}})),ln=!0):(Rn(hG(Ut,cg,{ns:Qt,req:function(oe,ne,X){var ie,ye;et||!i||pi(null,ne,X)||Jt&&l||(ie=oe.ctx(),ye=function(De,Ke){var ct=ar(),wt=ct&&ct[DA]()||C0(),Me=Dy(C0(),0,16);(Me=new VO(wt,Me,We[MA](),null==(wt=We.core)?void 0:wt.getTraceCtx()))[pp]=ct&&ct[x9](),Me[l_]=uA(),Me[uz]=w,""===(wt=De instanceof Request?(De||{}).url||"":De)&&(ct=rp())&&ct.href&&(wt=F8(ct.href,"#")[0]),Me[pd]=wt,ct="GET",Ke&&Ke[W0]?ct=Ke[W0]:De&&De instanceof Request&&(ct=De[W0]),Me[W0]=ct;var Pe={};return g&&new Headers((Ke?Ke[cx]:0)||De instanceof Request&&De[cx]||{}).forEach(function(Ft,kt){nn(kt)&&(Pe[kt]=Ft)}),Me[fp]=Pe,Wr(cg,Me),Me}(ne,X),(ne=We[az](ye,ne,X))!==X&&oe.set(1,ne),ie.data=ye)},rsp:function(oe,ne){var X;et||(X=oe.ctx().data)&&(oe.rslt=oe.rslt.then(function(ie){return So(0,(ie||{})[mp],ne,ie,X,function(){var ye,De;return(De={statusText:(ie||{})[ag]})[fx]=null,De[FO]=function(Ke){if(Ke&&Ke[cx])try{return _U(Ke[cx].get(rs[0]))}catch(ct){ug(We,18,BO,((Ke={fetchDiagnosticsMessage:Fr(Ke)})[RA]=Mn(ct),Ke))}}(ie),ge&&ie&&(ye={},ie.headers.forEach(function(Ke,ct){nn(ct)&&(ye[ct]=Ke)}),De[fx]=ye),De}),ie}).catch(function(ie){throw So(0,0,ne,null,X,null,ie.message||Mn(ie)),ie}))},hkErr:xx(We,15,"Failed to monitor Window.fetch"+bx)},!0,C8())),i=!0)})),Jt)&&(Ut[cg].polyfill=Jt),st=We[Th].getPlugin(dO))&&(D=st.plugin[SA])},We._doTeardown=function(){sr()},We.trackDependencyData=function(Ht,yn){Ao(Et,We[Th],null,Ht,yn)},We[az]=function(Ht,yn,gr,st){var Ut,Jt,oe,ne,X=We._currentWindowHost||u;return function oee(a,o,i,l,u,h){var g;0<a[zu]&&((g={})[Th]=o,g.xhr=l,g.input=u,g.init=h,g.traceId=i[Ff],g.spanId=i[q0],g.traceFlags=i[pp],g.context=i[SA]||{},g.aborted=!!i[ax],_z(o,a,l=g,"listener"),i[Ff]=l[lx],i[q0]=l[G0],i[pp]=l[pp],i[SA]=l[SA])}(ot,We[Th],Ht,st,yn,gr),yn||""===yn?(xG(h,Ht[b9](),X)&&(gr=gr||{},yn=new Headers(gr[cx]||yn instanceof Request&&yn[cx]||{}),N&&(yn.set(rs[3],Ut="|"+Ht[Ff]+"."+Ht[q0]),g)&&(Ht[fp][rs[3]]=Ut),(Jt=xt||D&&D.appId())&&(yn.set(rs[0],rs[2]+Jt),g)&&(Ht[fp][rs[0]]=rs[2]+Jt),P&&(tn(oe=Ht[pp])&&(oe=1),ne=Hq(JB(Ht[Ff],Ht[q0],oe)),yn.set(rs[4],ne),g)&&(Ht[fp][rs[4]]=ne),gr[cx]=yn),gr):st?(xG(h,Ht[b9](),X)&&(N&&(S9(st,rs[3])?ug(We,71,"Unable to set ["+rs[3]+"] as it has already been set by another instance"):(st[E9](rs[3],Ut="|"+Ht[Ff]+"."+Ht[q0]),g&&(Ht[fp][rs[3]]=Ut))),(Jt=xt||D&&D.appId())&&(S9(st,rs[0])?ug(We,71,"Unable to set ["+rs[0]+"] as it has already been set by another instance"):(st[E9](rs[0],rs[2]+Jt),g&&(Ht[fp][rs[0]]=rs[2]+Jt))),P)&&(tn(oe=Ht[pp])&&(oe=1),S9(st,rs[4])?ug(We,71,"Unable to set ["+rs[4]+"] as it has already been set by another instance"):(ne=Hq(JB(Ht[Ff],Ht[q0],oe)),st[E9](rs[4],ne),g&&(Ht[fp][rs[4]]=ne))),st):void 0},We[XJ]=function(Ht,yn,gr){-1===ue||T<ue?(2!==It&&1!==It||"string"!=typeof Ht.id||"."===Ht.id[Ht.id[zu]-1]||(Ht.id+="."),tn(Ht[ux])&&(Ht[ux]=new Date),Ht=V0(Ht,YE.dataType,YE.envelopeType,We[MA](),yn,gr),We[Th].track(Ht)):T===ue&&UO(We,55,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0),++T},We.addDependencyListener=function(Ht){return yz(ot,Je++,Ht)},We.addDependencyInitializer=function(Ht){return yz(Et,Je++,Ht)}}),Sn}return nu(o,a),o.prototype.processTelemetry=function(i,l){this.processNext(i,l)},o.prototype.addDependencyInitializer=function(i){return null},o.identifier="AjaxDependencyPlugin",o}($y),aee=function(){},P9=function(){this.id="browser",this.deviceClass="Browser"},R9=function(a,o){var i=this,l=xa(a,function(){var u=a.sdkExtension;i.sdkVersion=(u?u+"_":"")+"javascript:3.3.0"});o&&o.add(l)},M9=function(){},jO="sessionManager",OA="update",HO="isUserCookieSet",Cx="isNewUser",vz="getTraceCtx",NA="telemetryTrace",k9="applySessionContext",$O="applyApplicationContext",wz="applyDeviceContext",O9="applyOperationContext",bz="applyUserContext",N9="applyOperatingSystemContxt",Ez="applyLocationContext",L9="applyInternalContext",hg="accountId",qO="getSessionId",xz="namePrefix",V9="userCookiePostfix",Tz="idLength",LA="getNewId",GO="length",Q0="automaticSession",X0="authenticatedId",gp="acquisitionDate",KO="renewalDate",Ix="join",FA="cookieSeparator",WO="authUserCookieName",U9=function(){},z9=function(){function a(o,i,l){var u,h,g,w,T=Uy(i),D=jk(i);ko(a,this,function(P){var N=xa(o=o||{},function(ue){g=o.sessionExpirationMs||864e5,w=o.sessionRenewalMs||18e5,u="ai_session"+(o.sessionCookiePostfix||o[xz]||"")});function W(Re,ge){var et=Re[gp],we=(Re[KO]=ge,w),Mt=et+g-ge;Re=[Re.id,et,ge],et=0,et=Mt<we?Mt/1e3:we/1e3,Mt=o.cookieDomain||null,D.set(u,Re[Ix]("|"),0<g?et:null,Mt),h=ge}l&&l.add(N),P[Q0]=new U9,P[OA]=function(){var ue,ge,Mt,St,Qt,we=xf(),Re=!1,et=P[Q0];!(Re=et.id?Re:(Mt=et,St=!1,Qt=D.get(u),(Qt&&$r(Qt.split)||(Qt=cJ(T,u)))&&(St=function z(ue,ge){var we=!1,Re=", session will be reset",et=ge.split("|");if(2<=et[GO])try{var Mt=+et[1]||0,St=+et[2]||0;isNaN(Mt)||Mt<=0?En(T,2,27,"AI session acquisition date is 0"+Re):isNaN(St)||St<=0?En(T,2,27,"AI session renewal date is 0"+Re):et[0]&&(ue.id=et[0],ue[gp]=Mt,ue[KO]=St,we=!0)}catch(Qt){En(T,1,9,"Error parsing ai_session value ["+(ge||"")+"]"+Re+" - "+to(Qt),{exception:Mn(Qt)})}return we}(Mt,Qt)),!(St||Mt.id)))&&0<g&&(ge=we-et[KO],Re=(Re=(Re=(ue=we-et[gp])<0||ge<0)||g<ue)||w<ge),Re?(ue=we,P.automaticSession.id=(ge=o[LA]||Sq)(o[Tz]||22),P[Q0][gp]=ue,W(P[Q0],ue),Ky()||En(T,2,0,"Browser does not support local storage. Session durations will be inaccurate.")):(!h||6e4<we-h)&&W(et,we)},P.backup=function(){var we=P[Q0];ad(T,u,[we.id,we[gp],we=we[KO]][Ix]("|"))}})}return a.__ieDyn=1,a}(),hee=function(a,o,i,l){this.traceID=a||C0(),this.parentID=o,a=rp(),!i&&a&&a.pathname&&(i=a.pathname),this.name=ha(l,i)};function Iz(a){return!("string"!=typeof a||!a||a.match(/,|;|=| |\|/))}var dee=function(){function a(o,i,l){this.isNewUser=!1,this.isUserCookieSet=!1;var u,h=Uy(i),g=jk(i);ko(a,this,function(w){eo(w,"config",{g:function(){return o}});var T=xa(o,function(){var z=((z=g.get(u=a.userCookieName+(z=o[V9]||"")))&&(w[Cx]=!1,0<(z=z.split(a[FA]))[GO])&&(w.id=z[0],w[HO]=!!w.id),w.id||(w.id=D(),N(P(w.id)[Ix](a[FA])),function uJ(a,o){var i=vU();if(null!==i)try{return i[lo](o),!0}catch(l){Jm=!1,En(a,2,5,"Browser failed removal of local storage item. "+to(l),{exception:Mn(l)})}}(h,z=(o[xz]||"")+"ai_session")),w[hg]=o[hg]||void 0,g.get(a[WO]));z&&((z=(z=decodeURI(z)).split(a[FA]))[0]&&(w[X0]=z[0]),1<z[GO])&&z[1]&&(w[hg]=z[1])});function D(){var z=o||{};return(z[LA]||Sq)(z[Tz]?o[Tz]:22)}function P(z){var W=_0(new Date);return w.accountAcquisitionDate=W,w[Cx]=!0,[z,W]}function N(z){w[HO]=g.set(u,z,31536e3)}l&&l.add(T),w.setAuthenticatedUserContext=function(z,W,ue){void 0===ue&&(ue=!1),!Iz(z)||W&&!Iz(W)?En(h,2,60,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0):(w[X0]=z,z=w[X0],W&&(w[hg]=W,z=[w[X0],w.accountId][Ix](a[FA])),ue&&g.set(a[WO],encodeURI(z)))},w.clearAuthenticatedUserContext=function(){w[X0]=null,w[hg]=null,g.del(a[WO])},w[OA]=function(z){w.id===z&&w[HO]||N(P(z||D())[Ix](a[FA]))}})}return a.cookieSeparator="|",a.userCookieName="ai_user",a.authUserCookieName="ai_authUser",a}(),VA="ext",YO="tags";function J0(a,o){a&&a[o]&&0===Kd(a[o])[GO]&&delete a[o]}function pee(){return null}var ju,j9,dg,ZO,QO,fee,Sz,gg,cae=function(){function a(o,i,l,u){var h=this,g=o.logger;ko(a,this,function(w){var T,D,P;w.appId=pee,w[qO]=pee,w.application=new aee,w.internal=new R9(i,u),S2()&&(w[jO]=new z9(i,o,u),w.device=new P9,w.location=new M9,w.user=new dee(i,o,u),D=T=void 0,l&&(T=l.getTraceId(),D=l.getSpanId(),P=l.getName()),w[NA]=new hee(T,D,P,g),w.session=new U9),w[qO]=function(){var N=w.session;return N&&xr(N.id)||(N=(w[jO]||{})[Q0])&&xr(N.id)?N.id:null},w[k9]=function(N,z){yi(Es(N.ext,"app"),"sesId",w[qO](),xr)},w[N9]=function(N,z){yi(N.ext,"os",w.os)},w[$O]=function(N,z){var W=w.application;W&&(yi(N=Es(N,YO),ps.applicationVersion,W.ver,xr),yi(N,ps.applicationBuild,W.build,xr))},w[wz]=function(N,z){var W=w.device;W&&(yi(N=Es(Es(N,VA),"device"),"localId",W.id,xr),yi(N,"ip",W.ip,xr),yi(N,"model",W.model,xr),yi(N,"deviceClass",W.deviceClass,xr))},w[L9]=function(N,z){var W,ue=w.internal;ue&&(yi(W=Es(N,YO),ps.internalAgentVersion,ue.agentVersion,xr),yi(W,ps.internalSdkVersion,ha(g,ue.sdkVersion,64),xr),N.baseType!==YS.dataType&&N.baseType!==Zy.dataType||(yi(W,ps.internalSnippet,ue.snippetVer,xr),yi(W,ps.internalSdkSrc,ue.sdkSrc,xr)))},w[Ez]=function(N,z){var W=h.location;W&&yi(Es(N,YO,[]),ps.locationIp,W.ip,xr)},w[O9]=function(N,z){var W=w[NA];W&&(yi(N=Es(Es(N,VA),"trace",{traceID:void 0,parentID:void 0}),"traceID",W.traceID,xr,tn),yi(N,"name",W.name,xr,tn),yi(N,"parentID",W.parentID,xr,tn))},w.applyWebContext=function(N,z){var W=h.web;W&&yi(Es(N,VA),"web",W)},w[bz]=function(N,z){var W=w.user;W&&(yi(Es(N,YO,[]),ps.userAccountId,W[hg],xr),yi(N=Es(Es(N,VA),"user"),"id",W.id,xr),yi(N,"authId",W[X0],xr))},w.cleanUp=function(N,z){(N=N.ext)&&(J0(N,"device"),J0(N,"user"),J0(N,"web"),J0(N,"os"),J0(N,"app"),J0(N,"trace"))}})}return a.__ieDyn=1,a}(),BA=null,uae=IS(((ju={})[hg]=BA,ju.sessionRenewalMs=18e5,ju.samplingPercentage=100,ju.sessionExpirationMs=864e5,ju.cookieDomain=BA,ju.sdkExtension=BA,ju.isBrowserLinkTrackingEnabled=!1,ju.appId=BA,ju[qO]=BA,ju[xz]=j9,ju.sessionCookiePostfix=j9,ju[V9]=j9,ju[Tz]=22,ju[LA]=BA,ju)),hae=function(a){function o(){var i,l,u,h,g,w=a.call(this)||this;return w.priority=110,w.identifier=dO,ko(o,w,function(T,D){function P(){g=!(h=u=l=i=null)}P(),eo(T,"context",{g:function(){return h}}),T.initialize=function(N,z,W,ue){var ge,we,Re;D.initialize(N,z,W,ue),we=T.identifier,Re=T.core,T._addHook(xa(ge=N,function(){var et=ap(null,ge,Re);ge.storagePrefix&&wU(ge.storagePrefix),g=!1!==ge.disableUserInitMessage,i=et.getExtCfg(we,uae),T._extConfig=i})),u=Re[vz](!1),h=new cae(Re,i,u,T._unloadHooks),l=dp(T.context[NA],u),Re.setTraceCtx(l),T.context.appId=function(){var et=Re.getPlugin(MG);return et?et.plugin._appId:null}},T.processTelemetry=function(N,z){var W,ue,ge,we;tn(N)||(z=T._getTelCtx(z),N.name===Zy.envelopeType&&z.diagLog().resetInternalMessageCount(),(ge=h||{}).session&&"string"!=typeof h.session.id&&ge[jO]&&ge[jO][OA](),(W=ge.user)&&!W[HO]&&W[OA](ge.user.id),ge=z,Es(ue=N,"tags",[]),Es(ue,"ext",{}),(we=T.context)[k9](ue,ge),we[$O](ue,ge),we[wz](ue,ge),we[O9](ue,ge),we[bz](ue,ge),we[N9](ue,ge),we.applyWebContext(ue,ge),we[Ez](ue,ge),we[L9](ue,ge),we.cleanUp(ue,ge),W&&W[Cx]&&(W[Cx]=!1,g||(we=new YS(72,(Xd()||{}).userAgent||""),function Lq(a,o,i){Nq(a)[Y8](o,i)}(z.diagLog(),1,we))),T.processNext(N,z))},T._doTeardown=function(N,z){(N=(N||{}).core())&&N[vz]&&N[vz](!1)===l&&N.setTraceCtx(u),P()}}),w}return nu(o,a),o.__ieDyn=1,o}($y),H9=hae,mee="AuthenticatedUserContext",d_="track",UA="snippet",Az="flush",eN="pollInternalLogs",tN="getPlugin",Vf="evtNamespace",yee=d_+"Event",pg=d_+"Trace",nN=d_+"Metric",q9=d_+"PageView",_ee=d_+"Exception",p_=d_+"DependencyData",jA="set"+mee,rc="clear"+mee,Pz="version",tw="queue",Sx="connectionString",HA="instrumentationKey",Rz="instrumentationkey",Ax="userOverrideEndpointUrl",rN="endpointUrl",ii="ingestionendpoint",fg="onunloadFlush",fd="context",nw="addHousekeepingBeforeUnload",Mz="sendMessage",yp=[UA,"dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],kz="iKeyUsage",Oz="CdnUsage",mg="SdkLoaderVer",iN=void 0,oN={disabled:!0,limit:sp({samplingRate:100,maxSendNumber:1}),interval:sp({monthInterval:3,daysOfMonth:[28]})},W9=((dg={})[Sx]=iN,dg[rN]=iN,dg[HA]=iN,dg[Ax]=iN,dg.diagnosticLogInterval=Pk(function wee(a){return a&&0<a},1e4),dg.featureOptIn=((ZO={})[kz]={mode:3},ZO[Oz]={mode:2},ZO[mg]={mode:2},ZO),dg.throttleMgrCfg=sp(((QO={})[109]=sp(oN),QO[106]=sp(oN),QO[111]=sp(oN),QO[110]=sp(oN),QO)),dg.extensionConfig=sp(((fee={}).AppInsightsCfgSyncPlugin=sp({cfgUrl:"https://js.monitor.azure.com/scripts/b/ai.config.1.cfg.json",syncMode:2}),fee)),dg),Y9=function(){function a(o){var i,l,u,h,g,w,T,D,P,N,z,W,ue,ge,we=this;ko(a,this,function(Re){Mt(),eo(Re,"config",{g:function(){return D}}),Hn(["pluginVersionStringArr","pluginVersionString"],function(Le){eo(Re,Le,{g:function(){return T?T[Le]:null}})}),h=""+(o.sv||o[Pz]||""),o[tw]=o[tw]||[],o[Pz]=o[Pz]||2;var et=id(o.config||{},W9);function Mt(){g=ku("AISKU"),z=h=u=l=i=w=null,ge=ue=W=!1,N=new e9}function St(){w&&(function XX(a,o){aU([nG,"unload",LE],a,o)}(null,w),function JX(a,o){o=lp(Qk,o),aU([LE],a,o),aU([ru],null,o)}(null,w))}function Qt(Le){T.addUnloadHook(Le)}D=et.cfg,P=new KG,eo(Re,"appInsights",{g:function(){return P}}),l=new H9,i=new D9,u=new RO,T=new $se,eo(Re,"core",{g:function(){return T}}),Qt(xa(et,function(){var Le,Je,ot=D[Sx];function Et(){return VS(function(Kt,Ne){Df(ot,function(lt){var It=lt&&lt.value,xt=null;!lt.rejected&&It&&(xt=SG(D[Sx]=It)),Kt(xt)})})}or(ot)&&(Le=VS(function(Kt,Ne){Et().then(function(lt){var It=D[HA];Kt(It=lt&&lt[Rz]||It)}).catch(function(lt){Kt(null)})}),tn(Je=D[Ax])&&(Je=VS(function(Kt,Ne){Et().then(function(xt){Kt((xt=xt&&xt[ii])?xt+nA:D[rN])}).catch(function(lt){Kt(null)})})),D[HA]=Le,D[rN]=Je),xr(ot)&&(Je=(Le=SG(ot))[ii],D.endpointUrl=D[Ax]||Je+nA,D[HA]=Le[Rz]||D[HA]),D.endpointUrl=D[Ax]||D[rN]})),Re[UA]=o,Re[Az]=function(Le,Je){var ot;return OE(T,function(){return"AISKU.flush"},function(){function Et(){0==--Kt&&Je()}Le&&!Je&&(ot=rd(function(Ne){Je=Ne}));var Kt=1;Hn(T.getChannels(),function(Ne){Ne&&(Kt++,Ne[Az](Le,Et))}),Et()},null,Le=void 0===Le||Le),ot},Re[fg]=function(Le){void 0===Le&&(Le=!0),Hn(T.getChannels(),function(Je){Je[fg]?Je[fg]():Je[Az](Le)})},Re.loadAppInsights=function(Le,Je,ot){return(Le=void 0!==Le&&Le)&&function MQ(a){throw new(D8=D8||M8("UnsupportedError"))(a)}("Legacy Mode is no longer supported"),OE(Re.core,function(){return"AISKU.loadAppInsights"},function(){T.initialize(D,[u,l,i,P,N],Je,ot),eo(Re,"context",{g:function(){return l[fd]}}),z=z||new dJ(T);var Et,Kt=function Z9(){if(!Sz){var a=null;try{var o=(document||{}).currentScript;o&&(a=o.src)}catch{}if(a){try{var i,l=a.toLowerCase();l&&(i="",Hn(["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"],function(u,h){if(-1!==ec(l,u))return i="cdn"+(h+1),-1===ec(l,"/scripts/")&&(-1!==ec(l,"/next/")?i+="-next":-1!==ec(l,"/beta/")&&(i+="-beta")),Sz=i+"",-1}))}catch{}Sz=a}}return Sz}();Kt&&Re[fd]&&(Re[fd].internal.sdkSrc=Kt),(Et=Re[UA])&&(Kt="",tn(h)||(Kt+=h),Re[fd]&&Re[fd].internal&&(Re[fd].internal.snippetVer=Kt||"-"),Pi(Re,function(Ne,lt){xr(Ne)&&!$r(lt)&&Ne&&"_"!==Ne[0]&&-1===Ec(yp,Ne)&&Et[Ne]!==lt&&(Et[Ne]=lt)})),Re.emptyQueue(),Re[eN](),Re[nw](Re),Qt(xa(et,function(){var Ne=!1;D.throttleMgrCfg[109]&&(Ne=!D.throttleMgrCfg[109].disabled),!z.isReady()&&D.extensionConfig&&D.extensionConfig[N.identifier]&&Ne&&z.onReadyState(!0),W||D[Sx]||!zS(kz,D)||(z[Mz](106,"See Instrumentation key support at aka.ms/IkeyMigrate"),W=!0),!ue&&Re[fd].internal.sdkSrc&&-1!=Re[fd].internal.sdkSrc.indexOf("az416426")&&zS(Oz,D)&&(z[Mz](110,"See Cdn support notice at aka.ms/JsActiveCdn"),ue=!0),!ge&&parseInt(h)<6&&zS(mg,D)&&(z[Mz](111,"An updated Sdk Loader is available, see aka.ms/SnippetVer"),ge=!0)}))}),Re},Re.updateSnippetDefinitions=function(Le){!function Mu(a,o,i){if(a&&o&&Ar(a)&&Ar(o))for(var l in o)!function(u){xr(u)&&($r(o[u])?i&&!i(u,!0,o,a)||(a[u]=gk(o,u)):i&&!i(u,!1,o,a)||(Fm(a,u)&&delete a[u],eo(a,u,{g:function(){return o[u]},s:function(g){o[u]=g}})))}(l)}(Le,Re,function(Je){return Je&&-1===Ec(yp,Je)})},Re.emptyQueue=function(){try{if(Di(Re.snippet[tw])){for(var Le=Re.snippet[tw].length,Je=0;Je<Le;Je++)(0,Re.snippet[tw][Je])();Re.snippet[tw]=void 0,delete Re.snippet[tw]}}catch(ot){ot&&$r(ot.toString)&&ot.toString()}},Re[nw]=function(Le){var Je,ot;(S2()||x8())&&(ot=!(Je=function(){var Et;Le[fg](!1),$r(Re.core[tN])&&(Et=we.core[tN](dO))&&(Et=Et.plugin)&&Et[fd]&&Et[fd]._sessionManager&&Et[fd]._sessionManager.backup()}),w=w||lp(g,T[Vf]&&T[Vf]()),Qt(xa(D,function(Ne){var Kt=ap(null,Ne=Ne.cfg,(Kt=Le.appInsights).core).getExtCfg(Kt.identifier||kG);St(),Ne=Ne.disablePageUnloadEvents,Kt.disableFlushOnBeforeUnload||(function QX(a,o,i){return function ZX(a,o,i,l){var u=!1;return o&&a&&Di(a)&&!(u=Us(a,o,i,l))&&i&&0<i[qr]?Us(a,o,null,l):u}([nG,"unload",LE],a,o,i)}(Je,Ne,w)&&(ot=!0),ot=!!lU(Je,Ne,w)||ot)||function aX(){var a=Xd();return!(!a||!a.product)&&"ReactNative"===a.product}()||En(T.logger,1,19,"Could not add handler for beforeunload and pagehide"),ot||Kt.disableFlushOnUnload||lU(Je,Ne,w)})))},Re.getSender=function(){return u},Re.unload=function(Le,Je,ot){var Et,Kt=!1;return Le&&!Je&&(Et=rd(function(Ne){Je=Ne})),Re[fg](Le),St(),T.unload&&T.unload(Le,function(Ne){Kt||(Kt=!0,Mt(),Je&&Je(Ne))},ot),Et},IE(Re,P,["getCookieMgr",yee,q9,"trackPageViewPerformance",_ee,"_onerror",pg,nN,"startTrackPage","stopTrackPage","startTrackEvent","stopTrackEvent"]),IE(Re,function(){return i},[p_,"addDependencyListener","addDependencyInitializer"]),IE(Re,T,["addTelemetryInitializer",eN,"stopPollingInternalLogs",tN,"addPlugin",Vf,"addUnloadCb","getTraceCtx","updateCfg","onCfgChange"]),IE(Re,function(){var Le=l[fd];return Le?Le.user:null},[jA,rc])})}return a.prototype.addDependencyInitializer=function(o){return null},a}(),Dx=function(){function a(o){this.options=o,!this.options.disableTelemetry&&mc.appInsightsKey&&(this.appInsights=new Y9({config:{instrumentationKey:mc.appInsightsKey,disableExceptionTracking:!0,disableAjaxTracking:!0,isCookieUseDisabled:!0,maxBatchInterval:5e3}}),this.appInsights.loadAppInsights(),this.appInsights.addTelemetryInitializer(function(i){i.tags[ps.applicationVersion]=fv.getFullVersion()}))}return a.prototype.trackEvent=function(o,i){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackEvent(o,i)},a.prototype.setAuthenticatedUserContext=function(o,i){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.setAuthenticatedUserContext(o,i)},a.prototype.trackException=function(o){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.trackException(o)},a.prototype.flush=function(o){!this.options.disableTelemetry&&this.appInsights&&this.appInsights.flush(o)},a}(),qo=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Px=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.copyrightMessage=void 0,i.copyrightContent=void 0,i.customAttribution=void 0,i.showFeedbackLink=!0,i.showLogo=!0,i}return qo(o,a),o}(To),bee=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),rw=function(a){function o(i){var l=a.call(this)||this;return l.textAttribution=function(u){return[l.options.copyrightMessage,l.options.customAttribution].filter(function(h){return h}).join("")},l.updateFeedbackLink=function(){var u,h;l.feedbackAnchor&&l.map&&(u=(h=l.map.getCamera()).center,h=h.zoom,l.feedbackAnchor.href="".concat(o.feedbackLink,"&cp=").concat(u[1],"~").concat(u[0],"&lvl=").concat(h+1))},l.options=(new Px).merge(i),l}return bee(o,a),o.prototype.onAdd=function(i){return this.map=i,this.container=this.buildContainer(i,ya.auto),this.container.className="map-copyright without-bg",this.copyrightDiv=this.buildCopyrightDiv(),this.copyrightDiv.className="azure-map-copyright",this.container.appendChild(this.copyrightDiv),this.options.showFeedbackLink&&this.addRemoveFeedbackDiv(!0),this.container},o.prototype.onRemove=function(){a.prototype.onRemove.call(this),delete this.container},o.prototype.setOptions=function(h){var l,u=this;(h=(new Px).merge(this.options,h)).copyrightMessage===this.options.copyrightMessage&&h.customAttribution===this.options.customAttribution||(this.copyrightDiv.innerText=this.textAttribution(h)),h.copyrightContent!==this.options.copyrightContent&&(this.options.copyrightContent&&(l=Array.from(this.copyrightDiv.children).find(function(g){return g===u.options.copyrightContent}),this.copyrightDiv.removeChild(l)),0<this.copyrightDiv.childNodes.length?this.copyrightDiv.insertBefore(h.copyrightContent,this.copyrightDiv.childNodes[0]):this.copyrightDiv.appendChild(h.copyrightContent),this.options.copyrightContent=h.copyrightContent),!h.showFeedbackLink&&this.feedbackAnchor?this.addRemoveFeedbackDiv(!1):h.showFeedbackLink&&!this.feedbackAnchor&&this.addRemoveFeedbackDiv(!0),this.options=h},o.prototype.getDefaultAttributions=function(){var i=(new Date).getFullYear(),l=["\xa9".concat(i," TomTom")];return this.options.showLogo||l.push("\xa9".concat(i," Microsoft")),l},o.prototype.buildCopyrightDiv=function(){var i=document.createElement("div");return i.innerText=this.textAttribution(this.options)||"",i},o.prototype.buildFeedbackLink=function(){var i=document.createElement("a");return i.setAttribute("alt","Provide Map Data Feedback"),i.setAttribute("aria-label","Provide Map Data Feedback"),i.innerText="Feedback",i.href=o.feedbackLink,i.target="_blank",i.rel="noopener",i.className="azure-map-feedback-text",i},o.prototype.addRemoveFeedbackDiv=function(i){i?(this.feedbackAnchor=this.buildFeedbackLink(),this.feedbackTooltip=ki("Provide Map Data Feedback"),this.container.appendChild(this.feedbackAnchor),this.container.appendChild(this.feedbackTooltip),Vo(this.feedbackTooltip,this.feedbackAnchor),null!=(i=null==(i=this.map)?void 0:i.events)&&i.add("moveend",this.updateFeedbackLink)):(this.feedbackAnchor.remove(),this.feedbackTooltip.remove(),delete this.feedbackTooltip,delete this.feedbackAnchor,null!=(i=null==(i=this.map)?void 0:i.events)&&i.remove("moveend",this.updateFeedbackLink))},o.feedbackLink="https://aka.ms/azuremaps-feedback?feedbackep=UrlAzureMapsWebSdk",o}(oi),Eee=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Rx=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.showLogo=!0,i}return Eee(o,a),o}(To),Nz=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),xee=function(a){function o(i){var l=a.call(this)||this;return l.map=null,l._onResize=function(){var u=(null==(u=null==(u=l.map)?void 0:u.getMapContainer())?void 0:u.clientWidth)||0;l._setVisiblity(l.options.showLogo&&o.CONTAINER_MIN_WIDTH<=u)},l.options=(new Rx).merge(i),l}return Nz(o,a),o.prototype.onAdd=function(i){return this.map=i,this.container=this.buildContainer(i,ya.auto),this.container.className="map-logo-control",null!=(i=this.map)&&i.events.add("resize",this._onResize),this._addRemoveLogo(this.options.showLogo),this.container},o.prototype.onRemove=function(){var i;a.prototype.onRemove.call(this),null!=(i=this.map)&&i.events.remove("resize",this._onResize),this.map=null,delete this.container},o.prototype.setOptions=function(i){!(i=(new Rx).merge(this.options,i)).showLogo&&this.logoAnchor?this._addRemoveLogo(!1):i.showLogo&&!this.logoAnchor&&this._addRemoveLogo(!0),this.options=i},o.prototype._addRemoveLogo=function(i){i?(this.logoAnchor=document.createElement("a"),this.logoAnchor.className="azure-map-logo",this.logoAnchor.href="https://aka.ms/azuremaps",this.logoAnchor.setAttribute("aria-label","Visit azure.microsoft.com"),this.logoAnchor.setAttribute("target","_blank"),this.container.appendChild(this.logoAnchor),this.logoTooltip=ki("Visit azure.microsoft.com"),this.container.appendChild(this.logoTooltip),Vo(this.logoTooltip,this.logoAnchor),this._setVisiblity(!0)):(null!=(i=this.logoAnchor)&&i.remove(),null!=(i=this.logoTooltip)&&i.remove(),delete this.logoAnchor,this._setVisiblity(!1))},o.prototype._setVisiblity=function(i){this.container&&(this.container.style.display=i?"flex":"none")},o.CONTAINER_MIN_WIDTH=480,o}(oi),sN=function(){function a(){}return a.throwOnError=function(h,i){function l(g){throw u.off("error",l),g.error}var u=h instanceof Cg?h._getMap():h;return u.on("error",l),h=i(),u.off("error",l),h},a.tryCatch=function(o,i,l,u){try{return this.throwOnError(o,i)}catch(h){return l(h)}finally{"function"==typeof u&&u()}},a.tryFinally=function(o,i,l){try{return this.throwOnError(o,i)}finally{l()}},a}(),Mx=window&&window.__assign||function(){return(Mx=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)},Q9=function(){function a(o){this.map=o}return a.prototype.request=function(l){var i;return l={domain:this.map.getServiceOptions().domain,path:"reverseGeocode",queryParams:Mx({"api-version":"2023-06-01",coordinates:"".concat(Qs(l.position[0]),",").concat(ba(l.position[1]))},l.style.view&&{view:l.style.view}),headers:{"Accept-Language":l.style.language}},new vu((null==(i=this.map.authentication)?void 0:i.signRequest(l))||l).get()},a}(),aN=function(){function a(){this._labelCache={},this._labelIdx={},this._preloadedCache=new Set}return a.prototype.cache=function(o,i,l,u){u="".concat(o,"_").concat(l[0],"_").concat(l[1],"_").concat(u),this._labelIdx[i.labelType]||(this._labelIdx[i.labelType]=[],this._labelCache[i.labelType]=[]),-1===this._labelIdx[i.labelType].indexOf(u)&&(this._labelCache[i.labelType].push({name:o,radius:i.radius,minZoom:i.minZoom,maxZoom:i.maxZoom||24,position:l}),this._labelIdx[i.labelType].push(u))},a.prototype.getNearestLabel=function(o,i,l){var u=null,h=this._labelCache[o];if(h)for(var g,w=1/0,T=0,D=h.length;T<D;T++)l>=h[T].minZoom&&l<=h[T].maxZoom&&(g=Yc(h[T].position,i))<=h[T].radius&&g<=w&&(w=g,u=h[T]);return u},a.prototype._preloadCache=function(o){if(!this._preloadedCache.has(o)){this._preloadedCache.add(o);var i={source:[],labelType:"water",minZoom:0,radius:395e4,polygonSources:[]},l=o,u=l.indexOf("-");switch(l=-1!==u?l.substr(0,u):l){case"fr":this.cache("Oc\xe9an Pacifique",i,[-170,32],o),this.cache("Oc\xe9an Pacifique",i,[-138,-27],o),this.cache("Oc\xe9an Atlantique",i,[-40,32],o),this.cache("Oc\xe9an Atlantique",i,[-17,-29],o);break;case"es":this.cache("Oc\xe9an Pacifique",i,[-170,32],o),this.cache("Oc\xe9an Pacifique",i,[-138,-27],o),this.cache("Oc\xe9ano Atl\xe1ntico",i,[-40,32],o),this.cache("Oc\xe9ano Atl\xe1ntico",i,[-17,-29],o);break;case"pt":this.cache("Oceano Pac\xedfico",i,[-170,32],o),this.cache("Oceano Pac\xedfico",i,[-138,-27],o),this.cache("Oceano Atl\xe2ntico",i,[-40,32],o),this.cache("Oceano Atl\xe2ntico",i,[-17,-29],o);break;case"ja":this.cache("\u592a\u5e73\u6d0b",i,[-170,32],o),this.cache("\u592a\u5e73\u6d0b",i,[-138,-27],o);break;case"en":this.cache("Pacific Ocean",i,[-170,32],o),this.cache("Pacific Ocean",i,[-138,-27],o),this.cache("Atlantic Ocean",i,[-40,32],o),this.cache("Atlantic Ocean",i,[-17,-29],o),this.cache("Indian Ocean",i,[77,-26],o)}}},a}(),$A=window&&window.__awaiter||function(a,o,i,l){return new(i=i||Promise)(function(u,h){function g(D){try{T(l.next(D))}catch(P){h(P)}}function w(D){try{T(l.throw(D))}catch(P){h(P)}}function T(D){var P;D.done?u(D.value):((P=D.value)instanceof i?P:new i(function(N){N(P)})).then(g,w)}T((l=l.apply(a,o||[])).next())})},iw=window&&window.__generator||function(a,o){var i,l,u,h={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},g={next:w(0),throw:w(1),return:w(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function w(T){return function(D){var P=[T,D];if(i)throw new TypeError("Generator is already executing.");for(;h=g&&P[g=0]?0:h;)try{if(i=1,l&&(u=2&P[0]?l.return:P[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,P[1])).done)return u;switch(l=0,(P=u?[2&P[0],u.value]:P)[0]){case 0:case 1:u=P;break;case 4:return h.label++,{value:P[1],done:!1};case 5:h.label++,l=P[1],P=[0];continue;case 7:P=h.ops.pop(),h.trys.pop();continue;default:if(!(u=0<(u=h.trys).length&&u[u.length-1])&&(6===P[0]||2===P[0])){h=0;continue}if(3===P[0]&&(!u||P[1]>u[0]&&P[1]<u[3]))h.label=P[1];else if(6===P[0]&&h.label<u[1])h.label=u[1],u=P;else{if(!(u&&h.label<u[2])){u[2]&&h.ops.pop(),h.trys.pop();continue}h.label=u[2],h.ops.push(P)}}P=o.call(a,h)}catch(N){P=[6,N],l=0}finally{i=u=0}if(5&P[0])throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}},qA=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},X9=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},J9=function(){function a(o,i){var l=this;this._disposed=!1,this._lastHeadingTime=0,this._actionQueue=[],this._pointerUpdateDelay=3e3,this._camUpdateDelay=1e3,this._headUpdateLimit=1e3,this._controlEventDelay=500,this._moveThreshold=25,this._headingThreshold=5,this._pitchThreshold=5,this._roadPixelRadius=120,this._minRoadDistance=25,this._minIntersectionPixelDistance=50,this._labelConfig=[{source:["Ocean label","Ocean name"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["Ocean","Ocean or sea"]},{source:["Sea label"],labelType:"water",minZoom:3,radius:1e6,polygonSources:["Sea","Ocean or sea"]},{source:["Country name"],labelType:"country",minZoom:0,maxZoom:5,radius:3e5},{source:["State name","State name short"],labelType:"state",minZoom:4,maxZoom:7,radius:3e5},{source:["Capital city","Large city"],labelType:"city",minZoom:8,radius:4e4},{source:["Medium city"],labelType:"city",minZoom:8,radius:3e4},{source:["Small city"],labelType:"city",minZoom:8,radius:2e4},{source:["Island label"],labelType:"city",minZoom:8,radius:1e4},{source:["Town"],labelType:"city",minZoom:10,radius:1e4},{source:["Village"],labelType:"neighbourhood",minZoom:12,radius:6e3},{source:["Amusement area label"],labelType:"poi",minZoom:14,radius:2e3,polygonSources:["Amusement park"]},{source:["Hospital label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Hospital"]},{source:["Shopping centre label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Shopping"]},{source:["Stadium label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Stadium"]},{source:["University/School label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["University"]},{source:["Zoo label"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["Zoo"]},{source:["Airport Label","Airport name","Airport POI"],labelType:"majorPoi",minZoom:11,radius:3e3,polygonSources:["Airport","Runway"]},{source:["National park label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["National or state park","National park","Forest"]},{source:["Reservation label"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["Reservation"]}],this._labelCache=new Set(["city","state","country","water","majorPoi"]),this._roadLayers=new Set(["Connecting road","Connecting road tunnel","International road","International road tunnel","Local road","Local road tunnel","Major local road","Major local road tunnel","Major road","Major road tunnel","Minor local road","Minor local road tunnel","Motorway","Motorway tunnel","Secondary road","Secondary road tunnel","Toll connecting road","Toll connecting road tunnel","Toll international road","Toll international road tunnel","Toll local road","Toll local road tunnel","Toll major local road","Toll major local road tunnel","Toll major road","Toll major road tunnel","Toll minor local road","Toll minor local road tunnel","Toll motorway","Toll motorway tunnel","Toll secondary road","Toll secondary road tunnel"]),this._returnDetailedDescriptions=!1,this._shortcutListener=function(u){return $A(l,void 0,void 0,function(){var h,g,w;return iw(this,function(T){switch(T.label){case 0:return u.altKey&&u.ctrlKey&&68===u.keyCode?(this._returnDetailedDescriptions=!this._returnDetailedDescriptions,w=this._map.getCamera(),g=this._map.getStyle(),h=g.language.toLowerCase(),g=g.style.toLowerCase(),[4,this._getLocDesc(w,h,g)]):[3,2];case 1:w=T.sent(),this._descCallback(w),T.label=2;case 2:return[2]}})})},this._onRotate=function(){l._rotateTimeout||(l._rotateTimeout=Date.now()-l._lastHeadingTime>=l._headUpdateLimit?setTimeout(l._updateHeading,eR.RotationDuration+25):setTimeout(l._updateHeading,l._headUpdateLimit-(Date.now()-l._lastHeadingTime)))},this._onMove=function(){l._moveTimeout&&(clearTimeout(l._moveTimeout),delete l._moveTimeout),l._controlTimeout&&(clearTimeout(l._controlTimeout),delete l._controlTimeout)},this._onMoveEnd=function(u){u.fromControl?l._controlTimeout=setTimeout(l._updateCam,l._controlEventDelay):l._updateCam()},this._onStyleData=function(){setTimeout(l._updateStyle)},this._onPointerDown=function(u){l._lastPointerPos=l._getEventPos(u),l._pointerTimeout=setTimeout(function(){return $A(l,void 0,void 0,function(){var h,g,w;return iw(this,function(T){switch(T.label){case 0:return g=this._map.getStyle(),h=g.language.toLowerCase(),g=g.style.toLowerCase(),(w=this._map.getCamera()).center=this._map.pixelsToPositions([this._lastPointerPos])[0],[4,this._getLocDesc(w,h,g)];case 1:return w=T.sent(),this._descCallback(w),this._onPointerUp(),[2]}})})},l._pointerUpdateDelay),l._map.getCanvas().addEventListener("mousemove",l._onPointerMove),l._map.getCanvas().addEventListener("touchmove",l._onPointerMove),l._map.getCanvas().addEventListener("mouseup",l._onPointerUp),l._map.getCanvas().addEventListener("touchend",l._onPointerUp)},this._onPointerMove=function(g){g=l._getEventPos(g);var h=l._lastPointerPos[0]-g[0];g=l._lastPointerPos[1]-g[1],Math.sqrt(h*h+g*g)>l._moveThreshold&&l._onPointerUp()},this._onPointerUp=function(){clearTimeout(l._pointerTimeout),delete l._pointerTimeout,l._map.getCanvas().removeEventListener("mousemove",l._onPointerMove),l._map.getCanvas().removeEventListener("touchmove",l._onPointerMove),l._map.getCanvas().removeEventListener("mouseup",l._onPointerUp),l._map.getCanvas().removeEventListener("touchend",l._onPointerUp)},this._updateHeading=function(){var u,h=l._map.getCamera();l._lastHead&&!l._checkHeadingThreshold(h.bearing,l._lastHead)||(u=l._getHeadingDesc(h),l._lastHead=h.bearing,l._descCallback("<p>Map heading ".concat(u,".</p>")),l._lastHeadingTime=Date.now()),delete l._rotateTimeout},this._updateStyle=function(){return $A(l,void 0,void 0,function(){var u,h,g,w;return iw(this,function(T){switch(T.label){case 0:return u=this._map.getCamera(),g=this._map.getStyle(),h=g.language.toLowerCase(),g=g.style.toLowerCase(),this._lastLang===h?[3,2]:(a._labelCache._preloadCache(h),[4,this._getLocDesc(u,h,g)]);case 1:return w=T.sent(),[3,4];case 2:return this._lastStyle===g||"blank"!==this._lastStyle?[3,4]:[4,this._getLocDesc(u,h,g)];case 3:w=T.sent(),T.label=4;case 4:return this._lastLang=h,this._lastStyle=g,w&&this._descCallback(w),[2]}})})},this._updateCam=function(u){void 0===u&&(u=!1);var h,g,w,T=l._map.getCamera();(!l._lastCam||0<l._actionQueue.length||l._checkThresholds(T,l._lastCam))&&(w=l._map.getStyle(),h=w.language.toLowerCase(),g=w.style.toLowerCase(),(w=l._getActionDesc(T))&&l._actionQueue.push(w),l._lastCam=T,l._moveTimeout&&(clearTimeout(l._moveTimeout),delete l._moveTimeout),l._moveTimeout=setTimeout(function(){return $A(l,void 0,void 0,function(){var D;return iw(this,function(P){switch(P.label){case 0:return clearTimeout(this._rotateTimeout),delete this._rotateTimeout,[4,this._getLocDesc(T,h,g)];case 1:return D=P.sent(),0<this._actionQueue.length?(this._descCallback("<p>Map ".concat(this._actionQueue.join(", then "),".</p>").concat(D)),this._actionQueue=[]):this._descCallback(D),[2]}})})},u?0:l._camUpdateDelay))},this._map=o,this._restFallback=o.getServiceOptions().enableAccessibilityLocationFallback,this._descCallback=i,this._reverseSearch=new Q9(o),a._labelCache||(a._labelCache=new aN),this._lastLang=this._map.getStyle().language.toLowerCase(),a._labelCache._preloadCache(this._lastLang),this._map.events.addOnce("idle",function(){var u;l._disposed||(l._updateCam(!0),l._baseVectorTileSourceId=a._baseVectorTileSourceIds.find(function(h){return l._map.sources.getById(h)}),"bing-mvt"===l._baseVectorTileSourceId&&(l._labelConfig=a._labelConfigBing,l._roadLayers=a._roadLayersBing),l._polygonStyleLayer=l._labelConfig.reduce(function(h,g){return g.polygonSources&&h.push.apply(h,X9([],qA(g.polygonSources),!1)),h},[]),(u=l._map._getMap()).on("move",l._onMove),u.on("moveend",l._onMoveEnd),u.on("styledata",l._onStyleData),u.on("rotate",l._onRotate),(u=l._map.getCanvas()).addEventListener("mousedown",l._onPointerDown),u.addEventListener("touchstart",l._onPointerDown))}),this._map.getMapContainer().addEventListener("keydown",this._shortcutListener)}return a.prototype.dispose=function(){var o;this._disposed=!0,((o=this._map._getMap()).off("move",this._onMove),o.off("moveend",this._onMoveEnd),o.off("styledata",this._onStyleData),o.off("rotate",this._onRotate),o=this._map.getCanvas()).removeEventListener("mousedown",this._onPointerDown),o.removeEventListener("touchstart",this._onPointerDown),this._map.getMapContainer().removeEventListener("keydown",this._shortcutListener)},a.prototype._getEventPos=function(o){var i,l;return"touches"in o?(i=o.touches[0],l=o.target.getBoundingClientRect(),[i.pageX-l.left,i.pageY-l.top]):[o.offsetX,o.offsetY]},a.prototype._checkThresholds=function(o,i){return this._checkZoomThreshold(o.zoom,i.zoom)||this._checkPitchThreshold(o.pitch,i.pitch)||this._checkLocThreshold(o.center,i.center)||this._checkHeadingThreshold(o.bearing,i.bearing)},a.prototype._checkZoomThreshold=function(o,i){return this._round(o)!==this._round(i)},a.prototype._checkPitchThreshold=function(o,i){return Math.abs(o-i)>=this._pitchThreshold},a.prototype._checkLocThreshold=function(o,i){return o=(i=qA(this._map.positionsToPixels([i,o]),2))[0],_l.getDistance(o,i=i[1])>=this._moveThreshold},a.prototype._checkHeadingThreshold=function(o,i){return o<0&&(o+=360),i<0&&(i+=360),(o=180<(o=Math.abs(o-i))?360-o:o)>=this._headingThreshold},a.prototype._getLocDesc=function(o,i,l){return $A(this,void 0,void 0,function(){var u,h,g,w,T,D,P,N,z,W=this;return iw(this,function(ue){switch(ue.label){case 0:return"blank"===l?[3,3]:this._map._getMap().loaded()?[3,2]:[4,new Promise(function(ge){return W._map._getMap().once("idle",ge)})];case 1:ue.sent(),ue.label=2;case 2:for(u={},h=this._map.positionsToPixels([o.center])[0],sN.tryCatch(this._map,function(){var ge=W._map._getMap();g=ge.queryRenderedFeatures(h,{layers:W._polygonStyleLayer.filter(function(we){return ge.getLayer(we)}),filter:["==",["geometry-type"],"Polygon"]})},function(){}),w=null,g&&0<g.length&&(w=g[0]),T=null,D=0,P=this._labelConfig.length;D<P;D++)o.zoom>=(N=this._labelConfig[D]).minZoom?N.polygonSources?w&&-1!==N.polygonSources.indexOf(w.layer["source-layer"])?(T=N.labelType,this._getClosestLabel(N,o,i,u,!1)):this._getClosestLabel(N,o,i,u,!0):this._getClosestLabel(N,o,i,u,!1):this._getClosestLabel(N,o,i,u,!0);return 8<=o.zoom&&this._processRoads(u,o,i),this._labelCache.forEach(function(ge){!u[ge]&&(z=null,z="water"!==ge&&"majorPoi"!==ge||ge===T?a._labelCache.getNearestLabel(ge,o.center,o.zoom):z)&&(u[ge]=z.name)}),[2,this._processLocInfo(o,T,u,!0,this._restFallback)];case 3:return[2,this._processLocInfo(o,null,null,!1,!1)]}})})},a.prototype._getHeadingDesc=function(o){var i=o.bearing;switch(i<0&&(i+=360),i=this._round(i,this._headingThreshold)){case 0:case 360:return"north";case 45:return"north east";case 90:return"east";case 135:return"south east";case 180:return"south";case 225:return"south west";case 270:return"west";case 315:return"north west";default:return"".concat(i," degrees")}},a.prototype._getClosestLabel=function(o,i,l,u,h){for(var g=o.radius,w=0,T=o.source.length;w<T;w++){var D={sourceLayer:o.source[w],filter:["has","name"]},P=this._map._getMap().querySourceFeatures(this._baseVectorTileSourceId,D),N=null,z=1/0,W=this._labelCache.has(o.labelType);if(!h||W)for(var ue=0,ge=P.length;ue<ge;ue++){var we,Re="Point"===P[ue].geometry.type?P[ue]:s2(i.center,P[ue].geometry);h||(we="Point"===P[ue].geometry.type?Yc(i.center,Re.geometry.coordinates):Re.properties.distance)<z&&(z=we,N=P[ue]),W&&a._labelCache.cache(P[ue].properties.name,o,Re.geometry.coordinates,l)}h||(D=o.labelType+"Dis",N&&z<=g&&("number"!=typeof u[D]||z<=u[D])&&(u[o.labelType]=N.properties.name,u[D]=z))}},a.prototype._processRoads=function(o,i,l,u){var h=this._map._getMap().queryRenderedFeatures(u,{filter:["==",["geometry-type"],"LineString"]});if(h){for(var g,w=void 0,T=void 0,D=void 0,P=void 0,N=0,z=h.length;N<z;N++)this._roadLayers.has(h[N].layer["source-layer"])&&h[N].properties.name&&""!==h[N].properties.name&&(g=s2(i.center,h[N]),!D||g.properties.distance<D.properties.distance)&&(w&&h[N].properties.name===w.properties.name?D=g:w&&h[N].properties.name===w.properties.name?(!P||g.properties.distance<P.properties.distance)&&(P=g,T=h[N]):(P=D,T=w,D=g,w=h[N]));w&&(!o.country&&w.properties.country_code&&(o.country=w.properties.country_code,o.countryDis=0,a._labelCache.cache(o.country,{source:[],labelType:"country",radius:5e3,minZoom:0},D.geometry.coordinates,l)),!o.state&&w.properties.country_subdivision&&(o.state=w.properties.country_subdivision,o.stateDis=0,a._labelCache.cache(o.state,{source:[],labelType:"state",radius:5e3,minZoom:4},D.geometry.coordinates,l)),15<=i.zoom)&&(u=this._map.positionsToPixels([i.center,D.geometry.coordinates]),(_l.getDistance(u[0],u[1])<this._roadPixelRadius||D.properties.distance<this._minRoadDistance)&&(o.road=w.properties.name),T)&&(l=this._map.positionsToPixels([P.geometry.coordinates]),_l.getDistance(u[0],l[0])<this._minIntersectionPixelDistance||P.properties.distance<this._minRoadDistance)&&(o.secondRoad=T.properties.name,o.secondRoadDis=P.properties.distance)}},a.prototype._getActionDesc=function(o){var i,l,u;return this._lastCam&&(i=[],this._checkLocThreshold(o.center,this._lastCam.center)&&(u=["panned"],0===(l=Math.round(by(this._lastCam.center,o.center)))||360===l?u.push("north"):l<90?u.push("north east"):90===l?u.push("east"):l<180?u.push("south east"):180===l?u.push("south"):l<270?u.push("south west"):270===l?u.push("west"):l<360&&u.push("north west"),l=Yc(this._lastCam.center,o.center,si.meters),u.push(1e3<l?"".concat(Wc(l/1e3,2)," kilometers"):"".concat(Wc(l,2)," meters")),i.push(u.join(" "))),this._checkZoomThreshold(o.zoom,this._lastCam.zoom)&&((u=["zoomed"]).push(this._lastCam.zoom<o.zoom?"in":"out"),1<=(l=Math.abs(this._lastCam.zoom-o.zoom))&&(l=Math.ceil(l),u.push("".concat(l,1<l?" levels":" level"))),this._getCanonicalZoom(this._lastCam.zoom)!==this._getCanonicalZoom(o.zoom)&&u.push("to ".concat(this._getCanonicalZoom(o.zoom)," level")),o.zoom>=o.maxZoom&&u.push("Zoom In button disabled, maximum zoom level reached"),l=gi.getSouth(o.bounds)<=-L1&&gi.getNorth(o.bounds)>=L1,(o.zoom<=o.minZoom||l)&&u.push("Zoom Out button disabled, minimum zoom level reached"),i.push(u.join(" "))),this._checkPitchThreshold(o.pitch,this._lastCam.pitch)&&(l=this._round(o.pitch,this._pitchThreshold),i.push("pitched to ".concat(l," degrees")),60!==o.pitch&&0!==o.pitch||i.push("reached ".concat(u=60===o.pitch?"maximum":"minimum"," of ").concat(o.pitch," degrees"))),this._checkHeadingThreshold(this._lastCam.bearing,o.bearing)&&i.push("rotated to ".concat(this._getHeadingDesc(o))),i.join(" and "))||null},a.prototype._getCanonicalZoom=function(o){return(o=this._round(o))<2?"world":o<5?"country":o<11?"state province":o<15?"city":"street"},a.prototype._processLocInfo=function(o,i,l,u,h){var g=this;return new Promise(function(w,T){var D=[];if(u){var P=[];if(l&&(i&&("water"===i&&l.water?P.push(l.water):"majorPoi"===i&&l.majorPoi&&P.push(l.majorPoi)),0===P.length)&&(l.majorPoi&&8<=o.zoom?P.push(l.majorPoi):(l.poi&&14<=o.zoom?P.push(l.poi):l.road&&15<=o.zoom&&P.push(l.secondRoad?l.road+" & "+l.secondRoad:l.road),l.neighbourhood&&12<=o.zoom&&P.push(l.neighbourhood),l.city&&6<=o.zoom&&P.push(l.city)),l.state&&4<=o.zoom&&P.push(l.state),0===P.length?l.water?P.push(l.water):l.country&&P.push(l.country):1===P.length&&l.state&&4<=o.zoom&&l.country&&P.push(l.country)),0<P.length)D.push("<p>Location: ",P.join(", "),".</p>");else if(h&&"water"!==i)return void g._reverseGeocodeDescription(o).then(function(N){w(N)},function(){T("<p>Location: unknown</p>")})}g._returnDetailedDescriptions&&(D.push("<p>Zoom: ",Wc(o.zoom,2),".</p>"),D.push("<p>Latitude: ",Wc(o.center[1],5),".</p>"),D.push("<p>Longitude: ",Wc(o.center[0],5),".</p>")),w(D.join(""))})},a.prototype._reverseGeocodeDescription=function(o){var i=this;return new Promise(function(l){var u=i._map.getStyle();i._reverseSearch.request({position:o.center,style:u}).then(function(h){var g,w={};h&&h.features&&0<h.features.length&&null!=(g=null==(g=h.features[0])?void 0:g.properties)&&g.address&&((g=h.features[0].properties.address).countryRegion&&(w.country=g.countryRegion.name,a._labelCache.cache(w.country,{source:[],labelType:"country",radius:5e3,minZoom:0},o.center,u.language)),g.adminDistricts&&(w.state=null==(h=g.adminDistricts[0])?void 0:h.shortName,a._labelCache.cache(w.state,{source:[],labelType:"state",radius:5e3,minZoom:4},o.center,u.language)),g.locality&&(w.city=g.locality,a._labelCache.cache(w.city,{source:[],labelType:"city",radius:1e3,minZoom:10},o.center,u.language)),g.addressLine)&&(w.road=g.addressLine),i._processLocInfo(o,null,w,!0,!1).then(function(T){l(T)})},function(h){i._processLocInfo(o,null,null,!0,!1).then(function(g){l(g)})}).catch(function(h){i._processLocInfo(o,null,null,!0,!1).then(function(g){l(g)})})})},a.prototype._round=function(o,i){return void 0===i&&(i=1),Math.round(o/i)*i},a._baseVectorTileSourceIds=["microsoft.base","vectorTiles","bing-mvt"],a._labelConfigBing=[{source:["water_feature"],labelType:"water",minZoom:0,radius:395e4,polygonSources:["generic_water_fill"]},{source:["water_feature"],labelType:"water",minZoom:3,radius:1e6,polygonSources:["generic_water_fill"]},{source:["country_region"],labelType:"country",minZoom:0,maxZoom:5,radius:3e5},{source:["admin_division1"],labelType:"state",minZoom:4,maxZoom:7,radius:3e5},{source:["populated_place"],labelType:"city",minZoom:8,radius:4e4},{source:["neighborhood"],labelType:"neighbourhood",minZoom:12,radius:6e3},{source:["amusement_park"],labelType:"poi",minZoom:14,radius:2e3,polygonSources:["amusement_park_fill"]},{source:["hospital"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["hospital_fill"]},{source:["shopping_center"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["shopping_center_fill"]},{source:["stadium"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["stadium_fill"]},{source:["higher_education_facility","school"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["higher_education_facility_fill","school_fill"]},{source:["zoo"],labelType:"poi",minZoom:14,radius:1e3,polygonSources:["zoo_fill"]},{source:["airport","airport_terminal"],labelType:"majorPoi",minZoom:11,radius:3e3,polygonSources:["airport_terminal_fill","airport_fill-merged7","airport_runway_fill"]},{source:["reserve"],labelType:"majorPoi",minZoom:7,radius:15e3,polygonSources:["generic_reserve_fill","land_cover_forest_fill"]}],a._roadLayersBing=new Set(["road"]),a}(),Tee=function(a){var o=this;this.addToMap=function(){null==o.mapViewDesc&&(o.initializeMapLiveStateInfo(),o.initializeMapStyleInfo(),o.createMapKeyBindingInfo(),o.map.getMapContainer().setAttribute("role","application"),o.map.getMapContainer().setAttribute("aria-label","Map Application"),o.map.getCanvasContainer().setAttribute("aria-live","polite"),o.map.getCanvasContainer().setAttribute("aria-describedby","atlas-map-state atlas-map-style"),o.map.getCanvas().setAttribute("aria-label","Interactive Map"),o.map.getCanvas().setAttribute("aria-describedby","atlas-map-shortcuts"),o.map.getCanvas().setAttribute("alt","Interactive Map"))},this.removeFromMap=function(){null!=o.mapViewDesc&&o.mapViewDesc.dispose(),delete o.mapViewDesc,null!=o.atlasMapKeyBindings&&o.map.getCanvasContainer().removeChild(o.atlasMapKeyBindings),delete o.atlasMapKeyBindings,null!=o.atlasMapLiveStateInfo&&o.map.getCanvasContainer().removeChild(o.atlasMapLiveStateInfo),delete o.atlasMapLiveStateInfo,null!=o.atlasMapStyleInfo&&o.map.getCanvasContainer().removeChild(o.atlasMapStyleInfo),delete o.atlasMapStyleInfo,o.map.getMapContainer().removeAttribute("role"),o.map.getMapContainer().removeAttribute("aria-label"),o.map.getCanvasContainer().removeAttribute("aria-live"),o.map.getCanvasContainer().removeAttribute("aria-describedby"),o.map.getCanvas().removeAttribute("aria-label"),o.map.getCanvas().removeAttribute("aria-describedby"),o.map.getCanvas().removeAttribute("alt"),o.map.events.remove("stylechanged",o.updateMapStyle)},this.createMapKeyBindingInfo=function(){o.atlasMapKeyBindings=document.createElement("div"),o.atlasMapKeyBindings.setAttribute("tabindex","-1"),o.atlasMapKeyBindings.setAttribute("aria-hidden","true"),o.atlasMapKeyBindings.id="atlas-map-shortcuts",o.atlasMapKeyBindings.classList.add("hidden-accessible-element"),o.atlasMapKeyBindings.innerHTML=["Map shortcuts:","Zoom out: hyphen.","Zoom in: plus.","Pan right 100 pixels: right arrow.","Pan left 100 pixels: left arrow.","Pan up 100 pixels: up arrow.","Pan down 100 pixels: down arrow.","Rotate 15 degrees clockwise: shift + right arrow.","Rotate 15 degrees counter clockwise: shift + left arrow.","Increase pitch 10 degrees: shift + up arrow.","Decrease pitch 10 degrees: shift + down arrow.","Jump focus to the map: Escape."].join("\n"),o.map.getCanvasContainer().appendChild(o.atlasMapKeyBindings);var i=[189,187,38,37,39,40],l=o.map._getMap()._canvas;l?.addEventListener("keyup",function(u){i.find(function(h){return u.keyCode===h})&&(o.atlasMapKeyBindings.innerHTML="")})},this.initializeMapLiveStateInfo=function(){o.mapViewDesc=new J9(o.map,o.updateMapState),o.atlasMapLiveStateInfo=document.createElement("div"),o.atlasMapLiveStateInfo.setAttribute("tabindex","-1"),o.atlasMapLiveStateInfo.setAttribute("aria-hidden","true"),o.atlasMapLiveStateInfo.id="atlas-map-state",o.atlasMapLiveStateInfo.classList.add("hidden-accessible-element"),o.map.getCanvasContainer().appendChild(o.atlasMapLiveStateInfo)},this.initializeMapStyleInfo=function(){o.atlasMapStyleInfo=document.createElement("div"),o.atlasMapStyleInfo.setAttribute("tabindex","-1"),o.atlasMapStyleInfo.setAttribute("aria-hidden","true"),o.atlasMapStyleInfo.id="atlas-map-style",o.atlasMapStyleInfo.classList.add("hidden-accessible-element"),o.map.events.add("stylechanged",o.updateMapStyle),o.map.getCanvasContainer().appendChild(o.atlasMapStyleInfo)},this.updateMapStyle=function(){o.atlasMapStyleInfo.innerHTML="<p>Map style: ".concat(o.map.getStyle().style,".</p>")},this.updateMapState=function(i){o.atlasMapLiveStateInfo.innerHTML=i},this.map=a},Cee=function(a){var o=this;this.listenerEnabled=!1,this.lastFlowMode="none",this.addToMap=function(){if(!o.map._isReady())throw new Error("Traffic flow could not be added to the map because the map is not ready. Please use a ready event listener to guarantee the map is ready before enabling traffic flow.");o.listenerEnabled||(o.map.events.add("styledata",o.addToMap),o.listenerEnabled=!0);var i,l=o.map.getTraffic();"none"!==l.flow&&(i=o.map.layers.getLayerById("traffic_".concat(l.flow)))&&(o.lastFlowMode=l.flow,i._updateLayoutProperty("visibility","visible","none"))},this.removeFromMap=function(){var i;o.map.getTraffic(),"none"!=o.lastFlowMode&&((i=o.map.layers.getLayerById("traffic_".concat(o.lastFlowMode)))&&i._updateLayoutProperty("visibility","none","visible"),o.lastFlowMode="none"),o.listenerEnabled&&(o.map.events.remove("styledata",o.addToMap),o.listenerEnabled=!1)},this.map=a},Iee=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),lN=function(a){function o(i,l,u){var g=null!=(g=null!=(g=null!=(g=null!=(g=null!=(g=null!=(g=null!=(g=null!=(g=null!=(g=null!=(g=null!=(g=null!=(g=null!=(g=i.icon_category_12)?g:i.icon_category_11)?g:i.icon_category_10)?g:i.icon_category_9)?g:i.icon_category_8)?g:i.icon_category_7)?g:i.icon_category_6)?g:i.icon_category_5)?g:i.icon_category_4)?g:i.icon_category_3)?g:i.icon_category_2)?g:i.icon_category_1)?g:i.icon_category_0)?g:i.icon_category,h=null!=(h=null!=(h=null!=(h=null!=(h=null!=(h=null!=(h=null!=(h=null!=(h=null!=(h=null!=(h=null!=(h=null!=(h=null!=(h=i.description_12)?h:i.description_11)?h:i.description_10)?h:i.description_9)?h:i.description_8)?h:i.description_7)?h:i.description_6)?h:i.description_5)?h:i.description_4)?h:i.description_3)?h:i.description_2)?h:i.description_1)?h:i.description_0)?h:i.description;return g={icon:"".concat(o.getSeverityColorName(i.magnitude),"-").concat(o.getIncidentTypeIconName(g)),incidentType:o.getIncidentTypeName(g,u),description:h,delay:i.delay,color:o.getSeverityColorHexCode(i.magnitude),id:i.id},a.call(this,l,g)||this}return Iee(o,a),o.getIncidentTypeName=function(i,l){switch(i){case 0:default:return l.Unknown;case 1:return l.Accident;case 2:return l.Fog;case 3:return l.Danger;case 4:return l.Rain;case 5:return l.Ice;case 6:return l.Jam;case 7:return l.LaneClosed;case 8:return l.RoadClosed;case 9:return l.RoadWorks;case 10:return l.Wind;case 11:return l.Flood;case 12:return l.Detour}},o.getIncidentTypeIconName=function(i){switch(i){case 0:default:return"unknown";case 1:return"accident";case 2:return"fog";case 3:return"danger";case 4:return"rain";case 5:return"ice";case 6:return"jam";case 7:return"lane-closed";case 8:return"road-closed";case 9:return"road-work";case 10:return"wind";case 11:return"flood";case 12:return"detour"}},o.getSeverityColorName=function(i){switch(i){case 0:default:return"grey";case 1:return"yellow";case 2:return"orange";case 3:return"red"}},o.getSeverityColorHexCode=function(i){switch(i){case 0:default:return"#B5B6B7";case 1:return"#F4C951";case 2:return"#F4873F";case 3:return"#F04F4E"}},o}(Rr),e7=(function(a){a.DELAY="delay",a.LENGTH="length",a.FROM="from",a.TO="to"}(gg=gg||{}),function(){function a(){}return a.build=function(o,i){void 0===i&&(i="en-US");var l,h,g,u=(((h=document.createElement("div")).classList.add("incident-popup-title"),h.classList.add("font-segoeui-b"),h.innerText=o.properties.incidentType,h.setAttribute("aria-label","Incident Type ".concat(o.properties.incidentType)),g=document.createElement("div")).classList.add("incident-popup-subtitle"),g.classList.add("font-segoeui-b"),g.setAttribute("aria-label","Incident Description ".concat(o.properties.description)),g.innerText=o.properties.description,document.createElement("div"));return((u.classList.add("incident-popup-header"),u.style.backgroundColor=o.properties.color,u.appendChild(h),u.appendChild(g),h=document.createElement("div")).classList.add("incident-popup-body"),o.properties.delay&&(g="".concat(Math.floor(o.properties.delay/60)," min"),g=this.createInfoSection(g,gg.DELAY),h.appendChild(g)),o.properties.length&&(g=new Intl.NumberFormat([i,"en-US"],{maximumFractionDigits:2}),l=void 0,l="en-US"===i?(i=mh(o.properties.length,"meters","miles"),"".concat(g.format(i)," miles")):(i=mh(o.properties.length,"meters","kilometers"),"".concat(g.format(i)," km")),g=this.createInfoSection(l,gg.LENGTH),h.appendChild(g)),o.properties.from&&(i=this.createInfoSection(o.properties.from,gg.FROM),h.appendChild(i)),o.properties.to&&(l=this.createInfoSection(o.properties.to,gg.TO),h.appendChild(l)),g=document.createElement("div")).classList.add("incident-popup-content"),g.appendChild(u),g.appendChild(h),new Q1({content:g,position:o.geometry.coordinates})},a.createInfoSection=function(o,i){var l=document.createElement("div"),u=(l.classList.add("incident-popup-info"),document.createElement("div")),h=(u.classList.add("icon"),u.classList.add(i),document.createElement("span"));return h.classList.add("message"),h.classList.add("font-segoeui"),h.setAttribute("aria-label","Incident ".concat(i," ").concat(o)),h.innerText=o,l.appendChild(u),l.appendChild(h),l},a}()),See=window&&window.__awaiter||function(a,o,i,l){return new(i=i||Promise)(function(u,h){function g(D){try{T(l.next(D))}catch(P){h(P)}}function w(D){try{T(l.throw(D))}catch(P){h(P)}}function T(D){var P;D.done?u(D.value):((P=D.value)instanceof i?P:new i(function(N){N(P)})).then(g,w)}T((l=l.apply(a,o||[])).next())})},Aee=window&&window.__generator||function(a,o){var i,l,u,h={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},g={next:w(0),throw:w(1),return:w(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function w(T){return function(D){var P=[T,D];if(i)throw new TypeError("Generator is already executing.");for(;h=g&&P[g=0]?0:h;)try{if(i=1,l&&(u=2&P[0]?l.return:P[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,P[1])).done)return u;switch(l=0,(P=u?[2&P[0],u.value]:P)[0]){case 0:case 1:u=P;break;case 4:return h.label++,{value:P[1],done:!1};case 5:h.label++,l=P[1],P=[0];continue;case 7:P=h.ops.pop(),h.trys.pop();continue;default:if(!(u=0<(u=h.trys).length&&u[u.length-1])&&(6===P[0]||2===P[0])){h=0;continue}if(3===P[0]&&(!u||P[1]>u[0]&&P[1]<u[3]))h.label=P[1];else if(6===P[0]&&h.label<u[1])h.label=u[1],u=P;else{if(!(u&&h.label<u[2])){u[2]&&h.ops.pop(),h.trys.pop();continue}h.label=u[2],h.ops.push(P)}}P=o.call(a,h)}catch(N){P=[6,N],l=0}finally{i=u=0}if(5&P[0])throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}},Dee=function(){function a(l){var i=this;this.incidentLayerName="incidents",this.incidentSourceName="mapcontrol_traffic_incident",this.addToMap=function(){i.map.sources.getById(i.incidentSourceName)||i.map.sources.add(i.vectorTileSource),i.map.layers.getLayerById(i.incidentLayerName)||i.map.layers.add(i.incidentLayer,"labels"),i.clickPopup=new Q1({position:[0,0],pixelOffset:[0,-18]}),i.map.addEventListener("mouseover",i.incidentLayerName,i.cursorToPointer),i.map.addEventListener("mouseleave",i.incidentLayerName,i.cursorToDefault),i.map.addEventListener("click",i.incidentLayerName,i.openIncidentPopup),i.map.events.addOnce("idle",i.setAccessiblePopups),i.map.events.add("moveend",i.setAccessiblePopups)},this.accessiblePopups=[],this.setAccessiblePopups=function(){return See(i,void 0,void 0,function(){var u,h,g,w,T,D,P=this;return Aee(this,function(N){switch(N.label){case 0:return this.accessiblePopups.forEach(function(z){return z.remove()}),this.accessiblePopups=[],u=this.map.layers.getRenderedShapes(this.map.getCamera().bounds,this.incidentLayer),[4,this.map._getLocalizedStrings()];case 1:return h=N.sent(),g=function(z,W){var we=new mf(new Kl((we=(ue=z[W]).geometry.coordinates)[0],we[1])),ue=new lN(ue.properties,we,h),ge=e7.build(ue,P.incidentLanguage);return(we=ge.getPopupContainer()).addEventListener("focusin",function(Re){P.clickPopup.remove(),P.accessiblePopups.filter(function(et){return et!==ge}).forEach(function(et){return et.remove()}),0<=W-1&&w(ge,g(z,W-1)),W+1<z.length&&D(g(z,W+1)),2<=W&&W==z.length-1&&T(g(z,0)),0==W&&2<=z.length&&D(g(z,z.length-1))}),W==z.length-1&&we.addEventListener("focusout",function(Re){null===Re.relatedTarget&&ge.close()}),P.accessiblePopups.push(ge),ge},w=function(z,W){W.open(P.map),W.close(),W=W.getPopupContainer(),(z=z.getPopupContainer()).parentElement.insertBefore(W,z)},T=function(W){W.open(P.map),W.close();var ue=(W=W.getPopupContainer()).parentElement;ue.insertBefore(W,ue.firstElementChild)},D=function(z){z.open(P.map),z.close()},0<u.length&&D(g(u,0)),1<u.length&&D(g(u,u.length-1)),[2]}})})},this.removeFromMap=function(){var u;i.map.removeEventListener("mouseover",i.incidentLayerName,i.cursorToPointer),i.map.removeEventListener("mouseleave",i.incidentLayerName,i.cursorToDefault),i.map.removeEventListener("click",i.incidentLayerName,i.openIncidentPopup),i.map.events.remove("idle",i.setAccessiblePopups),i.map.events.remove("moveend",i.setAccessiblePopups),i.accessiblePopups.forEach(function(h){return h.remove()}),i.accessiblePopups=[],null!=(u=i.clickPopup)&&u.remove(),null!=i.map.layers.getLayerById(i.incidentLayerName)&&i.map.layers.remove(i.incidentLayerName),null!=i.map.sources.getById(i.incidentSourceName)&&i.map.sources.remove(i.incidentSourceName)},this.cursorToPointer=function(u){i.map.getCanvas().style.cursor="pointer"},this.cursorToDefault=function(u){i.map.getCanvas().style.cursor=""},this.openIncidentPopup=function(u){i.clickPopup.remove(),i.accessiblePopups.forEach(function(w){return w.close()});var h=u.position,g=u.features[0];i.map._getLocalizedStrings().then(function(w){var T=new mf(new Kl(h[0],h[1]));T=new lN(g.properties,T,w),i.clickPopup=e7.build(T,i.incidentLanguage),i.clickPopup.open(i.map),i.clickPopup.getPopupContainer().addEventListener("focusout",function(D){null===D.relatedTarget&&i.clickPopup.close()})})},this.map=l,this.vectorTileSource=new $$(this.incidentSourceName,{maxZoom:22,tiles:["https://".concat("{{azMapsDomain}}","/traffic/incident/tile/pbf?api-version=1.0&zoom={z}&x={x}&y={y}")]}),l=this.getIncidentIconImageExpression(),this.incidentLayer=new ES(this.incidentSourceName,this.incidentLayerName,{sourceLayer:"Traffic incident POI",iconOptions:{ignorePlacement:!0,allowOverlap:!0,image:l,size:.75}})}return a.prototype.getIncidentIconImageExpression=function(){return["concat",["let","magnitude",["get","magnitude"],["case",["==",["var","magnitude"],0],"grey",["==",["var","magnitude"],1],"yellow",["==",["var","magnitude"],2],"orange",["==",["var","magnitude"],3],"red",["==",["var","magnitude"],4],"grey","grey"]],"-",["let","category",["coalesce",["get","icon_category_12"],["get","icon_category_11"],["get","icon_category_10"],["get","icon_category_9"],["get","icon_category_8"],["get","icon_category_7"],["get","icon_category_6"],["get","icon_category_5"],["get","icon_category_4"],["get","icon_category_3"],["get","icon_category_2"],["get","icon_category_0"],["get","icon_category"],0],["case",["==",["var","category"],0],"unknown",["==",["var","category"],1],"accident",["==",["var","category"],2],"fog",["==",["var","category"],3],"danger",["==",["var","category"],4],"rain",["==",["var","category"],5],"ice",["==",["var","category"],6],"jam",["==",["var","category"],7],"lane-closed",["==",["var","category"],8],"road-closed",["==",["var","category"],9],"road-work",["==",["var","category"],10],"wind",["==",["var","category"],11],"flood",["==",["var","category"],12],"detour","unknown"]]]},a}(),Pee=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),t7=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.interactive=!0,i.scrollZoomInteraction=!0,i.boxZoomInteraction=!0,i.dragRotateInteraction=!0,i.dragPanInteraction=!0,i.keyboardInteraction=!0,i.dblClickZoomInteraction=!0,i.touchInteraction=!0,i.touchRotate=!0,i.wheelZoomRate=1/450,i}return Pee(o,a),o}(To),Ree=function(){function a(o){var i=this;this._onKeyDown=function(l){27===l.keyCode&&i.map.getCanvas().focus()},this.map=o}return a.prototype.enable=function(){this.map.getMapContainer().addEventListener("keydown",this._onKeyDown)},a.prototype.disable=function(){this.map.getMapContainer().removeEventListener("keydown",this._onKeyDown)},a}(),n7=function(){function a(o){var i=this;this._onGestureStart=function(l){i.hasTouch||(l.preventDefault(),i.initZoom=i.map.getCamera().zoom)},this._onGestureChange=function(l){i.hasTouch||(l.preventDefault(),i.map.setCamera({zoom:i.initZoom+l.scale-1}))},this._onTouchStart=function(l){i.hasTouch=!0},this._onTouchEnd=function(l){0===l.touches.length&&(i.hasTouch=!1)},this.map=o}return a.prototype.enable=function(){this.map.getCanvasContainer().addEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().addEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().addEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().addEventListener("touchend",this._onTouchEnd)},a.prototype.disable=function(){this.map.getCanvasContainer().removeEventListener("gesturestart",this._onGestureStart),this.map.getCanvasContainer().removeEventListener("gesturechange",this._onGestureChange),this.map.getCanvasContainer().removeEventListener("touchstart",this._onTouchStart),this.map.getCanvasContainer().removeEventListener("touchend",this._onTouchEnd)},a}(),r7=function(){function a(o,i){this.added=!1,this.map=o,this.focusShortcut=new Ree(o),this.pinchZoom=new n7(o),this.options=(new t7).merge(i)}return a.prototype.addToMap=function(){this.added||(this.added=!0,this._setInteractions(this.options))},a.prototype.removeFromMap=function(){this.added&&(this.added=!1,this._setInteractions({interactive:!1}))},a.prototype.setOptions=function(o){this.options=(new t7).merge(this.options,o),this.added&&this._setInteractions(this.options)},a.prototype.getOptions=function(){return Object.assign({},this.options)},a.prototype._setInteractions=function(o){var i;o.interactive?(o.boxZoomInteraction?this.map._getMap().boxZoom.enable():this.map._getMap().boxZoom.disable(),o.dblClickZoomInteraction?this.map._getMap().doubleClickZoom.enable():this.map._getMap().doubleClickZoom.disable(),o.dragPanInteraction?this.map._getMap().dragPan.enable():this.map._getMap().dragPan.disable(),o.dragRotateInteraction?this.map._getMap().dragRotate.enable():this.map._getMap().dragRotate.disable(),o.keyboardInteraction?(this.map._getMap().keyboard.enable(),this.focusShortcut.enable()):(this.map._getMap().keyboard.disable(),this.focusShortcut.disable()),o.scrollZoomInteraction?(this.map._getMap().scrollZoom.enable(),this.map._getMap().scrollZoom.setWheelZoomRate(o.wheelZoomRate)):this.map._getMap().scrollZoom.disable(),i=this.map._getMap().touchZoomRotate,o.touchInteraction?(i.enable(),o.touchRotate?i.enableRotation():i.disableRotation()):i.disable(),this.pinchZoom.enable()):(this.map._getMap().boxZoom.disable(),this.map._getMap().doubleClickZoom.disable(),this.map._getMap().dragPan.disable(),this.map._getMap().dragRotate.disable(),this.map._getMap().keyboard.disable(),this.focusShortcut.disable(),this.map._getMap().scrollZoom.disable(),this.map._getMap().touchZoomRotate.disable(),this.pinchZoom.disable())},a}();function i7(a,o,i){var l={type:"Feature"};return 0!==(i=void 0===i?{}:i).id&&!i.id||(l.id=i.id),i.bbox&&(l.bbox=i.bbox),l.properties=o||{},l.geometry=a,l}function Lz(a){return"Feature"===a.type?a.geometry:a}var Fz={exports:{}},cN=(Fz.exports=function(){function a(oe,ne){if(!(oe instanceof ne))throw new TypeError("Cannot call a class as a function")}function o(oe,ne){for(var X=0;X<ne.length;X++){var ie=ne[X];ie.enumerable=ie.enumerable||!1,ie.configurable=!0,"value"in ie&&(ie.writable=!0),Object.defineProperty(oe,ie.key,ie)}}function i(oe,ne,X){return ne&&o(oe.prototype,ne),X&&o(oe,X),oe}var l=function oe(ne,X){this.next=null,this.key=ne,this.data=X,this.left=null,this.right=null};function u(oe,ne){return oe>ne?1:oe<ne?-1:0}function h(oe,ne,X){for(var ie=new l(null,null),ye=ie,De=ie;;){var Ke=X(oe,ne.key);if(Ke<0){if(null===ne.left)break;if(X(oe,ne.left.key)<0&&(ne.left=(ct=ne.left).right,ct.right=ne,null===(ne=ct).left))break;De.left=ne,De=ne,ne=ne.left}else{if(!(Ke>0))break;if(null===ne.right)break;var ct;if(X(oe,ne.right.key)>0&&(ne.right=(ct=ne.right).left,ct.left=ne,null===(ne=ct).right))break;ye.right=ne,ye=ne,ne=ne.right}}return ye.right=ne.left,De.left=ne.right,ne.left=ie.right,ne.right=ie.left,ne}function g(oe,ne,X,ie){var ye=new l(oe,ne);if(null===X)return ye.left=ye.right=null,ye;var De=ie(oe,(X=h(oe,X,ie)).key);return De<0?(ye.left=X.left,ye.right=X,X.left=null):De>=0&&(ye.right=X.right,ye.left=X,X.right=null),ye}function w(oe,ne,X){var ie=null,ye=null;if(ne){var De=X((ne=h(oe,ne,X)).key,oe);0===De?(ie=ne.left,ye=ne.right):De<0?(ye=ne.right,ne.right=null,ie=ne):(ie=ne.left,ne.left=null,ye=ne)}return{left:ie,right:ye}}function D(oe,ne,X,ie,ye){if(oe){ie(ne+(X?"\u2514\u2500\u2500 ":"\u251c\u2500\u2500 ")+ye(oe)+"\n");var De=ne+(X?"    ":"\u2502   ");oe.left&&D(oe.left,De,!1,ie,ye),oe.right&&D(oe.right,De,!0,ie,ye)}}var P=function(){function oe(ne){void 0===ne&&(ne=u),this._root=null,this._size=0,this._comparator=ne}return oe.prototype.insert=function(ne,X){return this._size++,this._root=g(ne,X,this._root,this._comparator)},oe.prototype.add=function(ne,X){var ie=new l(ne,X);null===this._root&&(ie.left=ie.right=null,this._size++,this._root=ie);var ye=this._comparator,De=h(ne,this._root,ye),Ke=ye(ne,De.key);return 0===Ke?this._root=De:(Ke<0?(ie.left=De.left,ie.right=De,De.left=null):Ke>0&&(ie.right=De.right,ie.left=De,De.right=null),this._size++,this._root=ie),this._root},oe.prototype.remove=function(ne){this._root=this._remove(ne,this._root,this._comparator)},oe.prototype._remove=function(ne,X,ie){var ye;return null===X?null:0===ie(ne,(X=h(ne,X,ie)).key)?(null===X.left?ye=X.right:(ye=h(ne,X.left,ie)).right=X.right,this._size--,ye):X},oe.prototype.pop=function(){var ne=this._root;if(ne){for(;ne.left;)ne=ne.left;return this._root=h(ne.key,this._root,this._comparator),this._root=this._remove(ne.key,this._root,this._comparator),{key:ne.key,data:ne.data}}return null},oe.prototype.findStatic=function(ne){for(var X=this._root,ie=this._comparator;X;){var ye=ie(ne,X.key);if(0===ye)return X;X=ye<0?X.left:X.right}return null},oe.prototype.find=function(ne){return this._root&&(this._root=h(ne,this._root,this._comparator),0!==this._comparator(ne,this._root.key))?null:this._root},oe.prototype.contains=function(ne){for(var X=this._root,ie=this._comparator;X;){var ye=ie(ne,X.key);if(0===ye)return!0;X=ye<0?X.left:X.right}return!1},oe.prototype.forEach=function(ne,X){for(var ie=this._root,ye=[],De=!1;!De;)null!==ie?(ye.push(ie),ie=ie.left):0!==ye.length?(ie=ye.pop(),ne.call(X,ie),ie=ie.right):De=!0;return this},oe.prototype.range=function(ne,X,ie,ye){for(var De=[],Ke=this._comparator,ct=this._root;0!==De.length||ct;)if(ct)De.push(ct),ct=ct.left;else{if(Ke((ct=De.pop()).key,X)>0)break;if(Ke(ct.key,ne)>=0&&ie.call(ye,ct))return this;ct=ct.right}return this},oe.prototype.keys=function(){var ne=[];return this.forEach(function(X){return ne.push(X.key)}),ne},oe.prototype.values=function(){var ne=[];return this.forEach(function(X){return ne.push(X.data)}),ne},oe.prototype.min=function(){return this._root?this.minNode(this._root).key:null},oe.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},oe.prototype.minNode=function(ne){if(void 0===ne&&(ne=this._root),ne)for(;ne.left;)ne=ne.left;return ne},oe.prototype.maxNode=function(ne){if(void 0===ne&&(ne=this._root),ne)for(;ne.right;)ne=ne.right;return ne},oe.prototype.at=function(ne){for(var X=this._root,ie=!1,ye=0,De=[];!ie;)if(X)De.push(X),X=X.left;else if(De.length>0){if(X=De.pop(),ye===ne)return X;ye++,X=X.right}else ie=!0;return null},oe.prototype.next=function(ne){var X=this._root,ie=null;if(ne.right){for(ie=ne.right;ie.left;)ie=ie.left;return ie}for(var ye=this._comparator;X;){var De=ye(ne.key,X.key);if(0===De)break;De<0?(ie=X,X=X.left):X=X.right}return ie},oe.prototype.prev=function(ne){var X=this._root,ie=null;if(null!==ne.left){for(ie=ne.left;ie.right;)ie=ie.right;return ie}for(var ye=this._comparator;X;){var De=ye(ne.key,X.key);if(0===De)break;De<0?X=X.left:(ie=X,X=X.right)}return ie},oe.prototype.clear=function(){return this._root=null,this._size=0,this},oe.prototype.toList=function(){return function W(oe){for(var ne=oe,X=[],ie=!1,ye=new l(null,null),De=ye;!ie;)ne?(X.push(ne),ne=ne.left):X.length>0?ne=(ne=De=De.next=X.pop()).right:ie=!0;return De.next=null,ye.next}(this._root)},oe.prototype.load=function(ne,X,ie){void 0===X&&(X=[]),void 0===ie&&(ie=!1);var ye=ne.length,De=this._comparator;if(ie&&we(ne,X,0,ye-1,De),null===this._root)this._root=N(ne,X,0,ye),this._size=ye;else{var Ke=function ge(oe,ne,X){for(var ie=new l(null,null),ye=ie,De=oe,Ke=ne;null!==De&&null!==Ke;)X(De.key,Ke.key)<0?(ye.next=De,De=De.next):(ye.next=Ke,Ke=Ke.next),ye=ye.next;return null!==De?ye.next=De:null!==Ke&&(ye.next=Ke),ie.next}(this.toList(),function z(oe,ne){for(var X=new l(null,null),ie=X,ye=0;ye<oe.length;ye++)ie=ie.next=new l(oe[ye],ne[ye]);return ie.next=null,X.next}(ne,X),De);this._root=ue({head:Ke},0,ye=this._size+ye)}return this},oe.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(oe.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(oe.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),oe.prototype.toString=function(ne){void 0===ne&&(ne=function(ye){return String(ye.key)});var X=[];return D(this._root,"",!0,function(ie){return X.push(ie)},ne),X.join("")},oe.prototype.update=function(ne,X,ie){var ye=this._comparator,De=w(ne,this._root,ye),Ke=De.left,ct=De.right;ye(ne,X)<0?ct=g(X,ie,ct,ye):Ke=g(X,ie,Ke,ye),this._root=function T(oe,ne,X){return null===ne?oe:(null===oe||((ne=h(oe.key,ne,X)).left=oe),ne)}(Ke,ct,ye)},oe.prototype.split=function(ne){return w(ne,this._root,this._comparator)},oe}();function N(oe,ne,X,ie){var ye=ie-X;if(ye>0){var De=X+Math.floor(ye/2),wt=new l(oe[De],ne[De]);return wt.left=N(oe,ne,X,De),wt.right=N(oe,ne,De+1,ie),wt}return null}function ue(oe,ne,X){var ie=X-ne;if(ie>0){var ye=ne+Math.floor(ie/2),De=ue(oe,ne,ye),Ke=oe.head;return Ke.left=De,oe.head=oe.head.next,Ke.right=ue(oe,ye+1,X),Ke}return null}function we(oe,ne,X,ie,ye){if(!(X>=ie)){for(var De=oe[X+ie>>1],Ke=X-1,ct=ie+1;;){do{Ke++}while(ye(oe[Ke],De)<0);do{ct--}while(ye(oe[ct],De)>0);if(Ke>=ct)break;var wt=oe[Ke];oe[Ke]=oe[ct],oe[ct]=wt,wt=ne[Ke],ne[Ke]=ne[ct],ne[ct]=wt}we(oe,ne,X,ct,ye),we(oe,ne,ct+1,ie,ye)}}var Re=function(ne,X){return ne.ll.x<=X.x&&X.x<=ne.ur.x&&ne.ll.y<=X.y&&X.y<=ne.ur.y},et=function(ne,X){return X.ur.x<ne.ll.x||ne.ur.x<X.ll.x||X.ur.y<ne.ll.y||ne.ur.y<X.ll.y?null:{ll:{x:ne.ll.x<X.ll.x?X.ll.x:ne.ll.x,y:ne.ll.y<X.ll.y?X.ll.y:ne.ll.y},ur:{x:ne.ur.x<X.ur.x?ne.ur.x:X.ur.x,y:ne.ur.y<X.ur.y?ne.ur.y:X.ur.y}}},Mt=Number.EPSILON;void 0===Mt&&(Mt=Math.pow(2,-52));var St=Mt*Mt,Qt=function(ne,X){if(-Mt<ne&&ne<Mt&&-Mt<X&&X<Mt)return 0;var ie=ne-X;return ie*ie<St*ne*X?0:ne<X?-1:1},Le=function(){function oe(){a(this,oe),this.reset()}return i(oe,[{key:"reset",value:function(){this.xRounder=new Je,this.yRounder=new Je}},{key:"round",value:function(X,ie){return{x:this.xRounder.round(X),y:this.yRounder.round(ie)}}}]),oe}(),Je=function(){function oe(){a(this,oe),this.tree=new P,this.round(0)}return i(oe,[{key:"round",value:function(X){var ie=this.tree.add(X),ye=this.tree.prev(ie);if(null!==ye&&0===Qt(ie.key,ye.key))return this.tree.remove(X),ye.key;var De=this.tree.next(ie);return null!==De&&0===Qt(ie.key,De.key)?(this.tree.remove(X),De.key):X}}]),oe}(),ot=new Le,Et=function(ne,X){return ne.x*X.y-ne.y*X.x},Kt=function(ne,X){return ne.x*X.x+ne.y*X.y},Ne=function(ne,X,ie){var Ke=Et({x:X.x-ne.x,y:X.y-ne.y},{x:ie.x-ne.x,y:ie.y-ne.y});return Qt(Ke,0)},lt=function(ne){return Math.sqrt(Kt(ne,ne))},It=function(ne,X,ie){var ye={x:X.x-ne.x,y:X.y-ne.y},De={x:ie.x-ne.x,y:ie.y-ne.y};return Et(De,ye)/lt(De)/lt(ye)},xt=function(ne,X,ie){var ye={x:X.x-ne.x,y:X.y-ne.y},De={x:ie.x-ne.x,y:ie.y-ne.y};return Kt(De,ye)/lt(De)/lt(ye)},ln=function(ne,X,ie){return 0===X.y?null:{x:ne.x+X.x/X.y*(ie-ne.y),y:ie}},Sn=function(ne,X,ie){return 0===X.x?null:{x:ie,y:ne.y+X.y/X.x*(ie-ne.x)}},on=function(){function oe(ne,X){a(this,oe),void 0===ne.events?ne.events=[this]:ne.events.push(this),this.point=ne,this.isLeft=X}return i(oe,null,[{key:"compare",value:function(X,ie){var ye=oe.comparePoints(X.point,ie.point);return 0!==ye?ye:(X.point!==ie.point&&X.link(ie),X.isLeft!==ie.isLeft?X.isLeft?1:-1:sr.compare(X.segment,ie.segment))}},{key:"comparePoints",value:function(X,ie){return X.x<ie.x?-1:X.x>ie.x?1:X.y<ie.y?-1:X.y>ie.y?1:0}}]),i(oe,[{key:"link",value:function(X){if(X.point===this.point)throw new Error("Tried to link already linked events");for(var ie=X.point.events,ye=0,De=ie.length;ye<De;ye++){var Ke=ie[ye];this.point.events.push(Ke),Ke.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var X=this.point.events.length,ie=0;ie<X;ie++){var ye=this.point.events[ie];if(void 0===ye.segment.consumedBy)for(var De=ie+1;De<X;De++){var Ke=this.point.events[De];void 0===Ke.consumedBy&&ye.otherSE.point.events===Ke.otherSE.point.events&&ye.segment.consume(Ke.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var X=[],ie=0,ye=this.point.events.length;ie<ye;ie++){var De=this.point.events[ie];De!==this&&!De.segment.ringOut&&De.segment.isInResult()&&X.push(De)}return X}},{key:"getLeftmostComparator",value:function(X){var ie=this,ye=new Map,De=function(ct){var wt=ct.otherSE;ye.set(ct,{sine:It(ie.point,X.point,wt.point),cosine:xt(ie.point,X.point,wt.point)})};return function(Ke,ct){ye.has(Ke)||De(Ke),ye.has(ct)||De(ct);var wt=ye.get(Ke),Me=wt.sine,Pe=wt.cosine,Ft=ye.get(ct),kt=Ft.sine,en=Ft.cosine;return Me>=0&&kt>=0?Pe<en?1:Pe>en?-1:0:Me<0&&kt<0?Pe<en?-1:Pe>en?1:0:kt<Me?-1:kt>Me?1:0}}}]),oe}(),Rn=0,sr=function(){function oe(ne,X,ie,ye){a(this,oe),this.id=++Rn,this.leftSE=ne,ne.segment=this,ne.otherSE=X,this.rightSE=X,X.segment=this,X.otherSE=ne,this.rings=ie,this.windings=ye}return i(oe,null,[{key:"compare",value:function(X,ie){var ye=X.leftSE.point.x,De=ie.leftSE.point.x,Ke=X.rightSE.point.x,ct=ie.rightSE.point.x;if(ct<ye)return 1;if(Ke<De)return-1;var wt=X.leftSE.point.y,Me=ie.leftSE.point.y,Pe=X.rightSE.point.y,Ft=ie.rightSE.point.y;if(ye<De){if(Me<wt&&Me<Pe)return 1;if(Me>wt&&Me>Pe)return-1;var kt=X.comparePoint(ie.leftSE.point);if(kt<0)return 1;if(kt>0)return-1;var en=ie.comparePoint(X.rightSE.point);return 0!==en?en:-1}if(ye>De){if(wt<Me&&wt<Ft)return-1;if(wt>Me&&wt>Ft)return 1;var Yn=ie.comparePoint(X.leftSE.point);if(0!==Yn)return Yn;var ut=X.comparePoint(ie.rightSE.point);return ut<0?1:ut>0?-1:1}if(wt<Me)return-1;if(wt>Me)return 1;if(Ke<ct){var Dt=ie.comparePoint(X.rightSE.point);if(0!==Dt)return Dt}if(Ke>ct){var qt=X.comparePoint(ie.rightSE.point);if(qt<0)return 1;if(qt>0)return-1}if(Ke!==ct){var Tr=Pe-wt,_i=Ke-ye,In=Ft-Me,Li=ct-De;if(Tr>_i&&In<Li)return 1;if(Tr<_i&&In>Li)return-1}return Ke>ct?1:Ke<ct||Pe<Ft?-1:Pe>Ft?1:X.id<ie.id?-1:X.id>ie.id?1:0}}]),i(oe,[{key:"replaceRightSE",value:function(X){this.rightSE=X,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var X=this.leftSE.point.y,ie=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:X<ie?X:ie},ur:{x:this.rightSE.point.x,y:X>ie?X:ie}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(X){return X.x===this.leftSE.point.x&&X.y===this.leftSE.point.y||X.x===this.rightSE.point.x&&X.y===this.rightSE.point.y}},{key:"comparePoint",value:function(X){if(this.isAnEndpoint(X))return 0;var ie=this.leftSE.point,ye=this.rightSE.point,De=this.vector();if(ie.x===ye.x)return X.x===ie.x?0:X.x<ie.x?1:-1;if(X.x===ie.x+(X.y-ie.y)/De.y*De.x)return 0;var Me=ie.y+(X.x-ie.x)/De.x*De.y;return X.y===Me?0:X.y<Me?-1:1}},{key:"getIntersection",value:function(X){var ie=this.bbox(),ye=X.bbox(),De=et(ie,ye);if(null===De)return null;var Ke=this.leftSE.point,ct=this.rightSE.point,wt=X.leftSE.point,Me=X.rightSE.point,Pe=Re(ie,wt)&&0===this.comparePoint(wt),Ft=Re(ye,Ke)&&0===X.comparePoint(Ke),kt=Re(ie,Me)&&0===this.comparePoint(Me),en=Re(ye,ct)&&0===X.comparePoint(ct);if(Ft&&Pe)return en&&!kt?ct:!en&&kt?Me:null;if(Ft)return kt&&Ke.x===Me.x&&Ke.y===Me.y?null:Ke;if(Pe)return en&&ct.x===wt.x&&ct.y===wt.y?null:wt;if(en&&kt)return null;if(en)return ct;if(kt)return Me;var Yn=function(ne,X,ie,ye){if(0===X.x)return Sn(ie,ye,ne.x);if(0===ye.x)return Sn(ne,X,ie.x);if(0===X.y)return ln(ie,ye,ne.y);if(0===ye.y)return ln(ne,X,ie.y);var De=Et(X,ye);if(0==De)return null;var Ke={x:ie.x-ne.x,y:ie.y-ne.y},ct=Et(Ke,X)/De,wt=Et(Ke,ye)/De;return{x:(ne.x+wt*X.x+(ie.x+ct*ye.x))/2,y:(ne.y+wt*X.y+(ie.y+ct*ye.y))/2}}(Ke,this.vector(),wt,X.vector());return null!==Yn&&Re(De,Yn)?ot.round(Yn.x,Yn.y):null}},{key:"split",value:function(X){var ie=[],ye=void 0!==X.events,De=new on(X,!0),Ke=new on(X,!1),ct=this.rightSE;this.replaceRightSE(Ke),ie.push(Ke),ie.push(De);var wt=new oe(De,ct,this.rings.slice(),this.windings.slice());return on.comparePoints(wt.leftSE.point,wt.rightSE.point)>0&&wt.swapEvents(),on.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),ye&&(De.checkForConsuming(),Ke.checkForConsuming()),ie}},{key:"swapEvents",value:function(){var X=this.rightSE;this.rightSE=this.leftSE,this.leftSE=X,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var ie=0,ye=this.windings.length;ie<ye;ie++)this.windings[ie]*=-1}},{key:"consume",value:function(X){for(var ie=this,ye=X;ie.consumedBy;)ie=ie.consumedBy;for(;ye.consumedBy;)ye=ye.consumedBy;var De=oe.compare(ie,ye);if(0!==De){if(De>0){var Ke=ie;ie=ye,ye=Ke}if(ie.prev===ye){var ct=ie;ie=ye,ye=ct}for(var wt=0,Me=ye.rings.length;wt<Me;wt++){var Pe=ye.rings[wt],Ft=ye.windings[wt],kt=ie.rings.indexOf(Pe);-1===kt?(ie.rings.push(Pe),ie.windings.push(Ft)):ie.windings[kt]+=Ft}ye.rings=null,ye.windings=null,ye.consumedBy=ie,ye.leftSE.consumedBy=ie.leftSE,ye.rightSE.consumedBy=ie.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this._prevInResult=this.prev?this.prev.isInResult()?this.prev:this.prev.prevInResult():null),this._prevInResult}},{key:"beforeState",value:function(){return void 0!==this._beforeState||(this._beforeState=this.prev?(this.prev.consumedBy||this.prev).afterState():{rings:[],windings:[],multiPolys:[]}),this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var X=this.beforeState();this._afterState={rings:X.rings.slice(0),windings:X.windings.slice(0),multiPolys:[]};for(var ie=this._afterState.rings,ye=this._afterState.windings,De=this._afterState.multiPolys,Ke=0,ct=this.rings.length;Ke<ct;Ke++){var wt=this.rings[Ke],Me=this.windings[Ke],Pe=ie.indexOf(wt);-1===Pe?(ie.push(wt),ye.push(Me)):ye[Pe]+=Me}for(var Ft=[],kt=[],en=0,Yn=ie.length;en<Yn;en++)if(0!==ye[en]){var ut=ie[en],Dt=ut.poly;if(-1===kt.indexOf(Dt))if(ut.isExterior)Ft.push(Dt);else{-1===kt.indexOf(Dt)&&kt.push(Dt);var qt=Ft.indexOf(ut.poly);-1!==qt&&Ft.splice(qt,1)}}for(var Tr=0,_i=Ft.length;Tr<_i;Tr++){var In=Ft[Tr].multiPoly;-1===De.indexOf(In)&&De.push(In)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var X=this.beforeState().multiPolys,ie=this.afterState().multiPolys;switch(Ht.type){case"union":this._isInResult=0===X.length!=(0===ie.length);break;case"intersection":var Ke,ct;X.length<ie.length?(Ke=X.length,ct=ie.length):(Ke=ie.length,ct=X.length),this._isInResult=ct===Ht.numMultiPolys&&Ke<ct;break;case"xor":var wt=Math.abs(X.length-ie.length);this._isInResult=wt%2==1;break;case"difference":var Me=function(Ft){return 1===Ft.length&&Ft[0].isSubject};this._isInResult=Me(X)!==Me(ie);break;default:throw new Error("Unrecognized operation type found ".concat(Ht.type))}return this._isInResult}}],[{key:"fromRing",value:function(X,ie,ye){var De,Ke,ct,wt=on.comparePoints(X,ie);if(wt<0)De=X,Ke=ie,ct=1;else{if(!(wt>0))throw new Error("Tried to create degenerate segment at [".concat(X.x,", ").concat(X.y,"]"));De=ie,Ke=X,ct=-1}return new oe(new on(De,!0),new on(Ke,!1),[ye],[ct])}}]),oe}(),nn=function(){function oe(ne,X,ie){if(a(this,oe),!Array.isArray(ne)||0===ne.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=X,this.isExterior=ie,this.segments=[],"number"!=typeof ne[0][0]||"number"!=typeof ne[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var ye=ot.round(ne[0][0],ne[0][1]);this.bbox={ll:{x:ye.x,y:ye.y},ur:{x:ye.x,y:ye.y}};for(var De=ye,Ke=1,ct=ne.length;Ke<ct;Ke++){if("number"!=typeof ne[Ke][0]||"number"!=typeof ne[Ke][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var wt=ot.round(ne[Ke][0],ne[Ke][1]);wt.x===De.x&&wt.y===De.y||(this.segments.push(sr.fromRing(De,wt,this)),wt.x<this.bbox.ll.x&&(this.bbox.ll.x=wt.x),wt.y<this.bbox.ll.y&&(this.bbox.ll.y=wt.y),wt.x>this.bbox.ur.x&&(this.bbox.ur.x=wt.x),wt.y>this.bbox.ur.y&&(this.bbox.ur.y=wt.y),De=wt)}(ye.x!==De.x||ye.y!==De.y)&&this.segments.push(sr.fromRing(De,ye,this))}return i(oe,[{key:"getSweepEvents",value:function(){for(var X=[],ie=0,ye=this.segments.length;ie<ye;ie++){var De=this.segments[ie];X.push(De.leftSE),X.push(De.rightSE)}return X}}]),oe}(),dt=function(){function oe(ne,X){if(a(this,oe),!Array.isArray(ne))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new nn(ne[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var ie=1,ye=ne.length;ie<ye;ie++){var De=new nn(ne[ie],this,!1);De.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=De.bbox.ll.x),De.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=De.bbox.ll.y),De.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=De.bbox.ur.x),De.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=De.bbox.ur.y),this.interiorRings.push(De)}this.multiPoly=X}return i(oe,[{key:"getSweepEvents",value:function(){for(var X=this.exteriorRing.getSweepEvents(),ie=0,ye=this.interiorRings.length;ie<ye;ie++)for(var De=this.interiorRings[ie].getSweepEvents(),Ke=0,ct=De.length;Ke<ct;Ke++)X.push(De[Ke]);return X}}]),oe}(),pi=function(){function oe(ne,X){if(a(this,oe),!Array.isArray(ne))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof ne[0][0][0]&&(ne=[ne])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var ie=0,ye=ne.length;ie<ye;ie++){var De=new dt(ne[ie],this);De.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=De.bbox.ll.x),De.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=De.bbox.ll.y),De.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=De.bbox.ur.x),De.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=De.bbox.ur.y),this.polys.push(De)}this.isSubject=X}return i(oe,[{key:"getSweepEvents",value:function(){for(var X=[],ie=0,ye=this.polys.length;ie<ye;ie++)for(var De=this.polys[ie].getSweepEvents(),Ke=0,ct=De.length;Ke<ct;Ke++)X.push(De[Ke]);return X}}]),oe}(),Qn=function(){function oe(ne){a(this,oe),this.events=ne;for(var X=0,ie=ne.length;X<ie;X++)ne[X].segment.ringOut=this;this.poly=null}return i(oe,null,[{key:"factory",value:function(X){for(var ie=[],ye=0,De=X.length;ye<De;ye++){var Ke=X[ye];if(Ke.isInResult()&&!Ke.ringOut){for(var ct=null,wt=Ke.leftSE,Me=Ke.rightSE,Pe=[wt],Ft=wt.point,kt=[];ct=wt,Pe.push(wt=Me),wt.point!==Ft;)for(;;){var en=wt.getAvailableLinkedEvents();if(0===en.length){var Yn=Pe[0].point,ut=Pe[Pe.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Yn.x,",")+" ".concat(Yn.y,"]. Last matching segment found ends at")+" [".concat(ut.x,", ").concat(ut.y,"]."))}if(1===en.length){Me=en[0].otherSE;break}for(var Dt=null,qt=0,Tr=kt.length;qt<Tr;qt++)if(kt[qt].point===wt.point){Dt=qt;break}if(null===Dt){kt.push({index:Pe.length,point:wt.point});var Li=wt.getLeftmostComparator(ct);Me=en.sort(Li)[0].otherSE;break}var _i=kt.splice(Dt)[0],In=Pe.splice(_i.index);In.unshift(In[0].otherSE),ie.push(new oe(In.reverse()))}ie.push(new oe(Pe))}}return ie}}]),i(oe,[{key:"getGeom",value:function(){for(var X=this.events[0].point,ie=[X],ye=1,De=this.events.length-1;ye<De;ye++){var Ke=this.events[ye].point;0!==Ne(Ke,X,this.events[ye+1].point)&&(ie.push(Ke),X=Ke)}if(1===ie.length)return null;0===Ne(ie[0],X,ie[1])&&ie.shift(),ie.push(ie[0]);for(var Pe=this.isExteriorRing()?1:-1,Ft=this.isExteriorRing()?0:ie.length-1,kt=this.isExteriorRing()?ie.length:-1,en=[],Yn=Ft;Yn!=kt;Yn+=Pe)en.push([ie[Yn].x,ie[Yn].y]);return en}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var X=this.enclosingRing();this._isExteriorRing=!X||!X.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var X=this.events[0],ie=1,ye=this.events.length;ie<ye;ie++){var De=this.events[ie];on.compare(X,De)>0&&(X=De)}for(var Ke=X.segment.prevInResult(),ct=Ke?Ke.prevInResult():null;;){if(!Ke)return null;if(!ct)return Ke.ringOut;if(ct.ringOut!==Ke.ringOut)return ct.ringOut.enclosingRing()!==Ke.ringOut?Ke.ringOut:Ke.ringOut.enclosingRing();Ke=ct.prevInResult(),ct=Ke?Ke.prevInResult():null}}}]),oe}(),ar=function(){function oe(ne){a(this,oe),this.exteriorRing=ne,ne.poly=this,this.interiorRings=[]}return i(oe,[{key:"addInterior",value:function(X){this.interiorRings.push(X),X.poly=this}},{key:"getGeom",value:function(){var X=[this.exteriorRing.getGeom()];if(null===X[0])return null;for(var ie=0,ye=this.interiorRings.length;ie<ye;ie++){var De=this.interiorRings[ie].getGeom();null!==De&&X.push(De)}return X}}]),oe}(),Wr=function(){function oe(ne){a(this,oe),this.rings=ne,this.polys=this._composePolys(ne)}return i(oe,[{key:"getGeom",value:function(){for(var X=[],ie=0,ye=this.polys.length;ie<ye;ie++){var De=this.polys[ie].getGeom();null!==De&&X.push(De)}return X}},{key:"_composePolys",value:function(X){for(var ie=[],ye=0,De=X.length;ye<De;ye++){var Ke=X[ye];if(!Ke.poly)if(Ke.isExteriorRing())ie.push(new ar(Ke));else{var ct=Ke.enclosingRing();ct.poly||ie.push(new ar(ct)),ct.poly.addInterior(Ke)}}return ie}}]),oe}(),zn=function(){function oe(ne){var X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sr.compare;a(this,oe),this.queue=ne,this.tree=new P(X),this.segments=[]}return i(oe,[{key:"process",value:function(X){var ie=X.segment,ye=[];if(X.consumedBy)return X.isLeft?this.queue.remove(X.otherSE):this.tree.remove(ie),ye;var De=X.isLeft?this.tree.insert(ie):this.tree.find(ie);if(!De)throw new Error("Unable to find segment #".concat(ie.id," ")+"[".concat(ie.leftSE.point.x,", ").concat(ie.leftSE.point.y,"] -> ")+"[".concat(ie.rightSE.point.x,", ").concat(ie.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var Ke=De,ct=De,wt=void 0,Me=void 0;void 0===wt;)null===(Ke=this.tree.prev(Ke))?wt=null:void 0===Ke.key.consumedBy&&(wt=Ke.key);for(;void 0===Me;)null===(ct=this.tree.next(ct))?Me=null:void 0===ct.key.consumedBy&&(Me=ct.key);if(X.isLeft){var Pe=null;if(wt){var Ft=wt.getIntersection(ie);if(null!==Ft&&(ie.isAnEndpoint(Ft)||(Pe=Ft),!wt.isAnEndpoint(Ft)))for(var kt=this._splitSafely(wt,Ft),en=0,Yn=kt.length;en<Yn;en++)ye.push(kt[en])}var ut=null;if(Me){var Dt=Me.getIntersection(ie);if(null!==Dt&&(ie.isAnEndpoint(Dt)||(ut=Dt),!Me.isAnEndpoint(Dt)))for(var qt=this._splitSafely(Me,Dt),Tr=0,_i=qt.length;Tr<_i;Tr++)ye.push(qt[Tr])}if(null!==Pe||null!==ut){var In=null;In=null===Pe?ut:null===ut||on.comparePoints(Pe,ut)<=0?Pe:ut,this.queue.remove(ie.rightSE),ye.push(ie.rightSE);for(var os=ie.split(In),vi=0,me=os.length;vi<me;vi++)ye.push(os[vi])}ye.length>0?(this.tree.remove(ie),ye.push(X)):(this.segments.push(ie),ie.prev=wt)}else{if(wt&&Me){var J=wt.getIntersection(Me);if(null!==J){if(!wt.isAnEndpoint(J))for(var se=this._splitSafely(wt,J),le=0,Ce=se.length;le<Ce;le++)ye.push(se[le]);if(!Me.isAnEndpoint(J))for(var Ue=this._splitSafely(Me,J),Xe=0,He=Ue.length;Xe<He;Xe++)ye.push(Ue[Xe])}}this.tree.remove(ie)}return ye}},{key:"_splitSafely",value:function(X,ie){this.tree.remove(X);var ye=X.rightSE;this.queue.remove(ye);var De=X.split(ie);return De.push(ye),void 0===X.consumedBy&&this.tree.insert(X),De}}]),oe}(),Fr=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,So=typeof process<"u"&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Ht=new(function(){function oe(){a(this,oe)}return i(oe,[{key:"run",value:function(X,ie,ye){Ht.type=X,ot.reset();for(var De=[new pi(ie,!0)],Ke=0,ct=ye.length;Ke<ct;Ke++)De.push(new pi(ye[Ke],!1));if(Ht.numMultiPolys=De.length,"difference"===Ht.type)for(var wt=De[0],Me=1;Me<De.length;)null!==et(De[Me].bbox,wt.bbox)?Me++:De.splice(Me,1);if("intersection"===Ht.type)for(var Pe=0,Ft=De.length;Pe<Ft;Pe++)for(var kt=De[Pe],en=Pe+1,Yn=De.length;en<Yn;en++)if(null===et(kt.bbox,De[en].bbox))return[];for(var ut=new P(on.compare),Dt=0,qt=De.length;Dt<qt;Dt++)for(var Tr=De[Dt].getSweepEvents(),_i=0,In=Tr.length;_i<In;_i++)if(ut.insert(Tr[_i]),ut.size>Fr)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Li=new zn(ut),os=ut.size,vi=ut.pop();vi;){var me=vi.key;if(ut.size===os){var J=me.segment;throw new Error("Unable to pop() ".concat(me.isLeft?"left":"right"," SweepEvent ")+"[".concat(me.point.x,", ").concat(me.point.y,"] from segment #").concat(J.id," ")+"[".concat(J.leftSE.point.x,", ").concat(J.leftSE.point.y,"] -> ")+"[".concat(J.rightSE.point.x,", ").concat(J.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(ut.size>Fr)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Li.segments.length>So)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var se=Li.process(me),le=0,Ce=se.length;le<Ce;le++){var Ue=se[le];void 0===Ue.consumedBy&&ut.insert(Ue)}os=ut.size,vi=ut.pop()}ot.reset();var Xe=Qn.factory(Li.segments);return new Wr(Xe).getGeom()}}]),oe}());return{union:function(ne){for(var X=arguments.length,ie=new Array(X>1?X-1:0),ye=1;ye<X;ye++)ie[ye-1]=arguments[ye];return Ht.run("union",ne,ie)},intersection:function(ne){for(var X=arguments.length,ie=new Array(X>1?X-1:0),ye=1;ye<X;ye++)ie[ye-1]=arguments[ye];return Ht.run("intersection",ne,ie)},xor:function(ne){for(var X=arguments.length,ie=new Array(X>1?X-1:0),ye=1;ye<X;ye++)ie[ye-1]=arguments[ye];return Ht.run("xor",ne,ie)},difference:function(ne){for(var X=arguments.length,ie=new Array(X>1?X-1:0),ye=1;ye<X;ye++)ie[ye-1]=arguments[ye];return Ht.run("difference",ne,ie)}}}(),Fz.exports),GA=Nl(cN);var o7=function(a){return function(o,i,l){var u=l.value,h=new Map;return l.value=function(){var g=this,w=arguments;!h.get(g)&&(u.apply(g,w),h.set(g,!0),setTimeout(function(){return h.delete(g)},a))},l}},s7=window&&window.__decorate||function(a,o,i,l){var u,h=arguments.length,g=h<3?o:null===l?l=Object.getOwnPropertyDescriptor(o,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,o,i,l);else for(var w=a.length-1;0<=w;w--)(u=a[w])&&(g=(h<3?u(g):3<h?u(o,i,g):u(o,i))||g);return 3<h&&g&&Object.defineProperty(o,i,g),g},Bz=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},kx=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},kee=["DIV","SPAN","A"],Uz=["data-azure-maps-attribution-minzoom","data-azure-maps-attribution-maxzoom","data-azure-maps-attribution-geometry","data-azure-maps-attribution-tileset","data-azure-maps-attribution-order","data-azure-maps-attribution-dynamic"],Oee=kx(["href"],Bz(Uz),!1),zz=function(){function a(o,i){var l=this;this.lastFetchState={bounds:null,zoom:null},this.getElement=function(){return l.element},this.element=o,this.attributionChangeCallback=i}return a.prototype.equals=function(o){return this.stringRepresentation===o.stringRepresentation},Object.defineProperty(a.prototype,"stringRepresentation",{get:function(){return[void 0!==this.minZoom?"minzoom=".concat(this.minZoom):"",void 0!==this.maxZoom?"maxzoom=".concat(this.maxZoom):"",void 0!==this.geometry?this.element.attributes.getNamedItem("data-azure-maps-attribution-geometry").value:"",void 0!==this.tilesetId?"tilesetId=".concat(this.tilesetId):"",this.dynamic?"dynamic":""].filter(function(o){return 0<o.length}).join(";")},enumerable:!1,configurable:!0}),a.applicable=function(o){return Array.from(o.attributes).map(function(i){return Uz.includes(i.name)}).reduce(function(i,l){return i||l},!1)},Object.defineProperty(a.prototype,"minZoom",{get:function(){var o=this.element.attributes.getNamedItem("data-azure-maps-attribution-minzoom");return o&&!isNaN(o.value)?parseInt(o.value):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"maxZoom",{get:function(){var o=this.element.attributes.getNamedItem("data-azure-maps-attribution-maxzoom");return o&&!isNaN(o.value)?parseInt(o.value):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"geometry",{get:function(){var o=this.element.attributes.getNamedItem("data-azure-maps-attribution-geometry");if(o&&o.value)try{return JSON.parse(o.value)}catch{}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"tilesetId",{get:function(){var o=this.element.attributes.getNamedItem("data-azure-maps-attribution-tileset");return o&&o.value?o.value:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"order",{get:function(){var o=this.element.attributes.getNamedItem("data-azure-maps-attribution-order");return o&&!isNaN(o.value)?parseInt(o.value):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"dynamic",{get:function(){return null!==this.element.attributes.getNamedItem("data-azure-maps-attribution-dynamic")},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"hidesElement",{get:function(){return"none"==this.element.style.display},enumerable:!1,configurable:!0}),a.prototype.forceHide=function(){this.element.style.display="none"},a.prototype.satisfied=function(o){var i=!this.minZoom||!o.zoom||o.zoom>=this.minZoom,l=!this.maxZoom||!o.zoom||o.zoom<=this.maxZoom,u=!0;return this.geometry&&o.bounds&&(u=null!==function Vz(a,o,i){return void 0===i&&(i={}),a=Lz(a),o=Lz(o),0===(a=GA.intersection(a.coordinates,o.coordinates)).length?null:1===a.length?function ow(a,o,i){void 0===i&&(i={});for(var l=0,u=a;l<u.length;l++){var h=u[l];if(h.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var g=0;g<h[h.length-1].length;g++)if(h[h.length-1][g]!==h[0][g])throw new Error("First and last Position are not equivalent.")}return i7({type:"Polygon",coordinates:a},o,i)}(a[0],i.properties):function Mee(a,o,i){return i7({type:"MultiPolygon",coordinates:a},o,i=void 0===i?{}:i)}(a,i.properties)}({type:"Feature",geometry:this.geometry,properties:{}},{type:"Feature",geometry:{type:"Polygon",coordinates:[[gi.getNorthWest(o.bounds),gi.getNorthEast(o.bounds),gi.getSouthEast(o.bounds),gi.getSouthWest(o.bounds),gi.getNorthWest(o.bounds)]]},properties:{}})),i&&l&&u},a.prototype.apply=function(o,w){var l=this,u=(void 0===w&&(w=null),this.satisfied(o.getCamera())),h=this.dynamic&&this.tilesetId,g=this.hidesElement;return w=w&&["dragend","zoomend","pitchend"].includes(w.type),u||g?u&&(g||h)&&(u&&g&&this.element.style.removeProperty("display"),h)&&(w?o.events.addOnce("idle",function(T){return l.fetchAndApplyDynamicAttribution(o)}):this.fetchAndApplyDynamicAttribution(o)):this.element.style.display="none",u===g},a.prototype.fetchAndApplyDynamicAttribution=function(o){var i,l,u,h=this,g=o.getCamera();this.lastFetchState&&gi.containsBoundingBox(this.lastFetchState.bounds,g.bounds)&&Math.floor(this.lastFetchState.zoom)==Math.floor(g.zoom)||(i=F1(g.center,gi.getSouthWest(g.bounds),a.viewportBufferExpansionRatio),u=((l=F1(g.center,gi.getNorthEast(g.bounds),a.viewportBufferExpansionRatio))[0]<i[0]?[[i[0],i[1],180,l[1]],[-180,i[1],l[0],l[1]]]:[[i[0],i[1],l[0],l[1]]]).map(function(T){T=new URLSearchParams({"api-version":"2.1",tilesetId:h.tilesetId,zoom:void 0!==g.zoom?"".concat(Math.floor(g.zoom)):void 0,bounds:T.join(",")});var D={url:P="".concat("https://{{azMapsDomain}}","/map/attribution"),headers:{}},P=(o._substituteDomainLanguageViewAndSignInRequest(P,D),"".concat(D.url).concat(D.url.includes("?")?"&":"?").concat(T.toString()));return o._sendRequest(P,"Attribution",D.headers).then(function(N){return N.json()})}),Promise.all(u).then(function(w){h.applyAttributionResponse(w),h.lastFetchState={bounds:new gi([i[0],i[1],l[0],l[1]]),zoom:g.zoom}}).catch(function(w){return console.error(w)}))},a.prototype.applyAttributionResponse=function(g){var i,l,u,h=this;0!=(g=g.map(function(w){return w.copyrights||[]}).reduce(function(w,T){return kx(kx([],Bz(w),!1),Bz(T),!1)},[])).length&&(null===(g=P4.parseWithFilter(g.join(""),function(w){return!0},function(w){return w},function(){return h.element.innerHTML="",h.element}))?console.warn("Dynamic attribution is empty after filtering"):(i="string"==typeof g?((i=document.createElement("span")).innerHTML=g,i):g,u=i===this.element?(l=document.createElement("span"),Array.from(this.element.childNodes).forEach(function(w){return l.appendChild(w)}),l):i,Array.from(this.element.attributes).filter(function(w){return Uz.includes(w.name)}).forEach(function(w){return u.attributes.setNamedItem(w.cloneNode())}),u.style.display=this.element.style.display,g=this.element.parentElement,this.element.remove(),g.append(u),this.element=u,this.attributionChangeCallback(this)))},a.viewportBufferExpansionRatio=2,s7([o7(1e3)],a.prototype,"fetchAndApplyDynamicAttribution",null),a}(),md=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},Ox=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},jz=[/all rights reserved/gi],Nee=function(){function a(o,i,l){var u,h=this;this.rules=[],this.virtualContext=((u=document.createElement("span")).className="azure-map-copyright-context",u),this.renderContext=this.virtualContext.cloneNode(!1),this.addAttributionFromSource=function(g){},this.removeAttributionFromSource=function(g){},this.getMapStyleVisibleSources=function(){var g=h.map._getMap(),w=g.getStyle();return Object.entries(w.sources).filter(function(T){var D=md(T,1)[0];return w.layers.filter(function(P){return P&&P.source==D}).reduce(function(P,N){return!(N.layout&&"none"===N.layout.visibility||N.paint&&0===N.paint["icon-opacity"]&&0===N.paint["text-opacity"])||P},!1)}).map(function(T){return T=md(T,1)[0],g.getSource(T)})},this.loadAttributionOnceSourcesLoaded=function(){var g=h.getMapStyleVisibleSources();Promise.all(g.map(function(w){return new Promise(function(T,D){var P;"tiles"in w||"geojson"===w?.type?T(w):((P=w).on("data",function N(z){"metadata"==z.sourceDataType&&(P.off("data",N),T(w))}),P.on("error",function N(z){P.off("error",N),D(z)}))}).then(function(T){return{status:"fulfilled",value:T}}).catch(function(T){return{status:"rejected",reason:T}})})).then(function(w){h.reloadAttribution()})},this.reloadAttribution=function(){var T=h.getMapStyleVisibleSources(),g=new Set,w={},D=(T=T.filter(function(W){return"attribution"in W&&W.attribution&&"tiles"in W&&W.tiles instanceof Array&&0<W.tiles.length}).map(function(W){return P4.parseWithFilter(null!=(W=W.attribution)?W:"",function(ue){return kee.includes(ue.tagName)&&Array.from(ue.attributes).map(function(ge){return Oee.includes(ge.name)}).reduce(function(ge,we){return ge&&we},!0)},function(ue){var ge,we=null;return ue instanceof HTMLElement&&zz.applicable(ue)&&(we=new zz(ue,function(){return h.renderAttribution()}),g.add(we),void 0!==we.order)&&(ue.style.order="".concat(we.order)),we&&ue instanceof HTMLElement&&(!((ge=we.stringRepresentation)in w)||void 0!==we.order&&void 0!==w[ge].order&&we.order<w[ge].order||void 0!==we.order&&void 0===w[ge].order)&&(w[ge]=we),ue},function(){return document.createElement("span")})}),new Set(Object.values(w))),N=new Set(Ox([],md(g),!1).filter(function(W){return!D.has(W)})),P=new Set(Ox([],md(N),!1).map(function(W){return W.getElement()})),z=(Ox([],md(P),!1).filter(function(W){return null!==W.parentElement}).forEach(function(W){return W.parentElement.removeChild(W)}),h.rules=Object.values(w),N=T.filter(function(W){return"string"==typeof W||!P.has(W)}).map(function(W){return"string"==typeof W?new Text(W):W}),document.createElement("span"));0<N.length?N.forEach(function(W){return z.appendChild(W)}):h.getDefaultAttribution().forEach(function(W){return z.appendChild(W)}),h.virtualContext=z,h.copyrightControl.setOptions({copyrightContent:h.renderContext}),h.applyRules(),h.renderAttribution()},this.applyRules=function(g){void 0===g&&(g=null),h.rules.reduce(function(w,T){return T=T.apply(h.map,g),w||T},!1)&&h.renderAttribution()},this.renderAttribution=function(){var g=function(D){return Array.from("none"!=D.style.display?D.children:[]).map(function(P){return g(P)}).reduce(function(P,N){return Ox(Ox([],md(P),!1),md(N),!1)},Array.from("none"!=D.style.display?D.childNodes:[]).filter(function(P){return P.nodeType==P.TEXT_NODE}))},w=h.virtualContext.cloneNode(!0),T=g(w);T.forEach(function(D){return D.textContent=Ox([],md(jz),!1).reduce(function(P,N){return P.replace(N,"").trim()},D.textContent)}),T.reduce(function(D,P){return D.has(P.textContent)?(P.textContent="",P.parentElement&&P.parentElement.removeChild(P)):D.add(P.textContent),D},new Set),h.renderContext.innerHTML="",Array.from(w.childNodes).forEach(function(D){return h.renderContext.appendChild(D)})},this.map=o,this.copyrightControl=i,this.options=l}return a.prototype.addToMap=function(){this.map.events.add("stylechanged",this.loadAttributionOnceSourcesLoaded),this.map.events.add("dragend",this.applyRules),this.map.events.add("zoomend",this.applyRules),this.map.events.add("pitchend",this.applyRules)},a.prototype.removeFromMap=function(){this.map.events.remove("stylechanged",this.loadAttributionOnceSourcesLoaded),this.map.events.remove("dragend",this.applyRules),this.map.events.remove("zoomend",this.applyRules),this.map.events.remove("pitchend",this.applyRules)},a.prototype.getDefaultAttribution=function(){return this.copyrightControl.getDefaultAttributions().map(function(o){return(i=document.createElement("a")).textContent=o,i;var i})},a}(),Hz=function(a,o){return(Hz=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(i,l){i.__proto__=l}:function(i,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(i[u]=l[u])}))(a,o)};function xl(a,o){function i(){this.constructor=a}Hz(a,o),a.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}var Wn=function(){return(Wn=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)};function _p(a,o){var i={};for(u in a)Object.prototype.hasOwnProperty.call(a,u)&&o.indexOf(u)<0&&(i[u]=a[u]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var l=0,u=Object.getOwnPropertySymbols(a);l<u.length;l++)o.indexOf(u[l])<0&&Object.prototype.propertyIsEnumerable.call(a,u[l])&&(i[u[l]]=a[u[l]]);return i}function jt(a,o,i,l){return new(i=i||Promise)(function(u,h){function g(D){try{T(l.next(D))}catch(P){h(P)}}function w(D){try{T(l.throw(D))}catch(P){h(P)}}function T(D){var P;D.done?u(D.value):((P=D.value)instanceof i?P:new i(function(N){N(P)})).then(g,w)}T((l=l.apply(a,o||[])).next())})}function Lt(a,o){var i,l,u,h={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},g={next:w(0),throw:w(1),return:w(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function w(T){return function(D){var P=[T,D];if(i)throw new TypeError("Generator is already executing.");for(;h;)try{if(i=1,l&&(u=2&P[0]?l.return:P[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,P[1])).done)return u;switch(l=0,(P=u?[2&P[0],u.value]:P)[0]){case 0:case 1:u=P;break;case 4:return h.label++,{value:P[1],done:!1};case 5:h.label++,l=P[1],P=[0];continue;case 7:P=h.ops.pop(),h.trys.pop();continue;default:if(!(u=0<(u=h.trys).length&&u[u.length-1])&&(6===P[0]||2===P[0])){h=0;continue}if(3===P[0]&&(!u||P[1]>u[0]&&P[1]<u[3]))h.label=P[1];else if(6===P[0]&&h.label<u[1])h.label=u[1],u=P;else{if(!(u&&h.label<u[2])){u[2]&&h.ops.pop(),h.trys.pop();continue}h.label=u[2],h.ops.push(P)}}P=o.call(a,h)}catch(N){P=[6,N],l=0}finally{i=u=0}if(5&P[0])throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}}function KA(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g}function f_(){for(var a=[],o=0;o<arguments.length;o++)a=a.concat(KA(arguments[o]));return a}var WA=function(a,o){return(WA=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(i,l){i.__proto__=l}:function(i,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(i[u]=l[u])}))(a,o)};function ou(a,o){function i(){this.constructor=a}WA(a,o),a.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}var Oo=function(){return(Oo=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)};function Gr(a,o,i,l){return new(i=i||Promise)(function(u,h){function g(D){try{T(l.next(D))}catch(P){h(P)}}function w(D){try{T(l.throw(D))}catch(P){h(P)}}function T(D){var P;D.done?u(D.value):((P=D.value)instanceof i?P:new i(function(N){N(P)})).then(g,w)}T((l=l.apply(a,o||[])).next())})}function Kr(a,o){var i,l,u,h={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},g={next:w(0),throw:w(1),return:w(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function w(T){return function(D){var P=[T,D];if(i)throw new TypeError("Generator is already executing.");for(;h;)try{if(i=1,l&&(u=2&P[0]?l.return:P[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,P[1])).done)return u;switch(l=0,(P=u?[2&P[0],u.value]:P)[0]){case 0:case 1:u=P;break;case 4:return h.label++,{value:P[1],done:!1};case 5:h.label++,l=P[1],P=[0];continue;case 7:P=h.ops.pop(),h.trys.pop();continue;default:if(!(u=0<(u=h.trys).length&&u[u.length-1])&&(6===P[0]||2===P[0])){h=0;continue}if(3===P[0]&&(!u||P[1]>u[0]&&P[1]<u[3]))h.label=P[1];else if(6===P[0]&&h.label<u[1])h.label=u[1],u=P;else{if(!(u&&h.label<u[2])){u[2]&&h.ops.pop(),h.trys.pop();continue}h.label=u[2],h.ops.push(P)}}P=o.call(a,h)}catch(N){P=[6,N],l=0}finally{i=u=0}if(5&P[0])throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}}function uN(){for(var a=0,o=0,i=arguments.length;o<i;o++)a+=arguments[o].length;var l=Array(a),u=0;for(o=0;o<i;o++)for(var h=arguments[o],g=0,w=h.length;g<w;g++,u++)l[u]=h[g];return l}var Ch,ol,sw,ti,Nx,YA,ZA,Lx,vp,Tl,Mr,Ih,Sh,vo,Fx,Hu,Ah,Vx,yg,$z,Js,Bx,su,je={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",REGIONAL_AUTH_NON_MSI_QUERY_STRING:"allowestsrnonmsi=true",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},Ux=[je.OPENID_SCOPE,je.PROFILE_SCOPE,je.OFFLINE_ACCESS_SCOPE],hN=uN(Ux,[je.EMAIL_SCOPE]),ic=(function(a){a.CONTENT_TYPE="Content-Type",a.RETRY_AFTER="Retry-After",a.CCS_HEADER="X-AnchorMailbox",a.WWWAuthenticate="WWW-Authenticate",a.AuthenticationInfo="Authentication-Info",a.X_MS_REQUEST_ID="x-ms-request-id",a.X_MS_HTTP_VERSION="x-ms-httpver"}(Ch=Ch||{}),function(a){a.ID_TOKEN="idtoken",a.CLIENT_INFO="client.info",a.ADAL_ID_TOKEN="adal.idtoken",a.ERROR="error",a.ERROR_DESC="error.description",a.ACTIVE_ACCOUNT="active-account",a.ACTIVE_ACCOUNT_FILTERS="active-account-filters"}(ol=ol||{}),function(a){a.COMMON="common",a.ORGANIZATIONS="organizations",a.CONSUMERS="consumers"}(sw=sw||{}),function(a){a.CLIENT_ID="client_id",a.REDIRECT_URI="redirect_uri",a.RESPONSE_TYPE="response_type",a.RESPONSE_MODE="response_mode",a.GRANT_TYPE="grant_type",a.CLAIMS="claims",a.SCOPE="scope",a.ERROR="error",a.ERROR_DESCRIPTION="error_description",a.ACCESS_TOKEN="access_token",a.ID_TOKEN="id_token",a.REFRESH_TOKEN="refresh_token",a.EXPIRES_IN="expires_in",a.STATE="state",a.NONCE="nonce",a.PROMPT="prompt",a.SESSION_STATE="session_state",a.CLIENT_INFO="client_info",a.CODE="code",a.CODE_CHALLENGE="code_challenge",a.CODE_CHALLENGE_METHOD="code_challenge_method",a.CODE_VERIFIER="code_verifier",a.CLIENT_REQUEST_ID="client-request-id",a.X_CLIENT_SKU="x-client-SKU",a.X_CLIENT_VER="x-client-VER",a.X_CLIENT_OS="x-client-OS",a.X_CLIENT_CPU="x-client-CPU",a.X_CLIENT_CURR_TELEM="x-client-current-telemetry",a.X_CLIENT_LAST_TELEM="x-client-last-telemetry",a.X_MS_LIB_CAPABILITY="x-ms-lib-capability",a.X_APP_NAME="x-app-name",a.X_APP_VER="x-app-ver",a.POST_LOGOUT_URI="post_logout_redirect_uri",a.ID_TOKEN_HINT="id_token_hint",a.DEVICE_CODE="device_code",a.CLIENT_SECRET="client_secret",a.CLIENT_ASSERTION="client_assertion",a.CLIENT_ASSERTION_TYPE="client_assertion_type",a.TOKEN_TYPE="token_type",a.REQ_CNF="req_cnf",a.OBO_ASSERTION="assertion",a.REQUESTED_TOKEN_USE="requested_token_use",a.ON_BEHALF_OF="on_behalf_of",a.FOCI="foci",a.CCS_HEADER="X-AnchorMailbox",a.RETURN_SPA_CODE="return_spa_code",a.NATIVE_BROKER="nativebroker",a.LOGOUT_HINT="logout_hint"}(ti=ti||{}),function(a){a.ACCESS_TOKEN="access_token",a.XMS_CC="xms_cc"}(Nx=Nx||{}),{LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"}),dN=(function(a){a.ACCOUNT="account",a.SID="sid",a.LOGIN_HINT="login_hint",a.ID_TOKEN="id_token",a.DOMAIN_HINT="domain_hint",a.ORGANIZATIONS="organizations",a.CONSUMERS="consumers",a.ACCOUNT_ID="accountIdentifier",a.HOMEACCOUNT_ID="homeAccountIdentifier"}(YA=YA||{}),{PLAIN:"plain",S256:"S256"}),QA=(function(a){a.QUERY="query",a.FRAGMENT="fragment",a.FORM_POST="form_post"}(ZA=ZA||{}),function(a){a.IMPLICIT_GRANT="implicit",a.AUTHORIZATION_CODE_GRANT="authorization_code",a.CLIENT_CREDENTIALS_GRANT="client_credentials",a.RESOURCE_OWNER_PASSWORD_GRANT="password",a.REFRESH_TOKEN_GRANT="refresh_token",a.DEVICE_CODE_GRANT="device_code",a.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(Lx=Lx||{}),function(a){a.MSSTS_ACCOUNT_TYPE="MSSTS",a.ADFS_ACCOUNT_TYPE="ADFS",a.MSAV1_ACCOUNT_TYPE="MSA",a.GENERIC_ACCOUNT_TYPE="Generic"}(vp=vp||{}),function(a){a.CACHE_KEY_SEPARATOR="-",a.CLIENT_INFO_SEPARATOR="."}(Tl=Tl||{}),function(a){a.ID_TOKEN="IdToken",a.ACCESS_TOKEN="AccessToken",a.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",a.REFRESH_TOKEN="RefreshToken"}(Mr=Mr||{}),function(a){a[a.ADFS=1001]="ADFS",a[a.MSA=1002]="MSA",a[a.MSSTS=1003]="MSSTS",a[a.GENERIC=1004]="GENERIC",a[a.ACCESS_TOKEN=2001]="ACCESS_TOKEN",a[a.REFRESH_TOKEN=2002]="REFRESH_TOKEN",a[a.ID_TOKEN=2003]="ID_TOKEN",a[a.APP_METADATA=3001]="APP_METADATA",a[a.UNDEFINED=9999]="UNDEFINED"}(Ih=Ih||{}),"appmetadata"),Cl=(function(a){a.CONFIG="config",a.CACHE="cache",a.NETWORK="network",a.HARDCODED_VALUES="hardcoded_values"}(Sh=Sh||{}),{SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"}),JA=(function(a){a.BEARER="Bearer",a.POP="pop",a.SSH="ssh-cert"}(vo=vo||{}),{DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"}),pN=(function(a){a.username="username",a.password="password"}(Fx=Fx||{}),function(a){a[a.httpSuccess=200]="httpSuccess",a[a.httpBadRequest=400]="httpBadRequest"}(Hu=Hu||{}),function(a){a.FAILED_AUTO_DETECTION="1",a.INTERNAL_CACHE="2",a.ENVIRONMENT_VARIABLE="3",a.IMDS="4"}(Ah=Ah||{}),function(a){a.CONFIGURED_MATCHES_DETECTED="1",a.CONFIGURED_NO_AUTO_DETECTION="2",a.CONFIGURED_NOT_DETECTED="3",a.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",a.AUTO_DETECTION_REQUESTED_FAILED="5"}(Vx=Vx||{}),function(a){a.NO_CACHE_HIT="0",a.FORCE_REFRESH="1",a.NO_CACHED_ACCESS_TOKEN="2",a.CACHED_ACCESS_TOKEN_EXPIRED="3",a.REFRESH_CACHED_ACCESS_TOKEN="4",a.CLAIMS_REQUESTED_CACHE_SKIPPED="5"}(yg=yg||{}),function(a){a.Jwt="JWT",a.Jwk="JWK",a.Pop="pop"}($z=$z||{}),{unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."},postRequestFailed:{code:"post_request_failed",desc:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."}}),dr=function(a){function o(i,l,u){var h=this;return h=a.call(this,l?i+": "+l:i)||this,Object.setPrototypeOf(h,o.prototype),h.errorCode=i||je.EMPTY_STRING,h.errorMessage=l||je.EMPTY_STRING,h.subError=u||je.EMPTY_STRING,h.name="AuthError",h}return ou(o,a),o.prototype.setCorrelationId=function(i){this.correlationId=i},o.createUnexpectedError=function(i){return new o(pN.unexpectedError.code,pN.unexpectedError.desc+": "+i)},o.createPostRequestFailed=function(i){return new o(pN.postRequestFailed.code,pN.postRequestFailed.desc+": "+i)},o}(Error),jx={createNewGuid:function(){throw dr.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw dr.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw dr.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return Gr(this,void 0,void 0,function(){return Kr(this,function(a){throw dr.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")})})},getPublicKeyThumbprint:function(){return Gr(this,void 0,void 0,function(){return Kr(this,function(a){throw dr.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")})})},removeTokenBindingKey:function(){return Gr(this,void 0,void 0,function(){return Kr(this,function(a){throw dr.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")})})},clearKeystore:function(){return Gr(this,void 0,void 0,function(){return Kr(this,function(a){throw dr.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")})})},signJwt:function(){return Gr(this,void 0,void 0,function(){return Kr(this,function(a){throw dr.createUnexpectedError("Crypto interface - signJwt() has not been implemented")})})},hashString:function(){return Gr(this,void 0,void 0,function(){return Kr(this,function(a){throw dr.createUnexpectedError("Crypto interface - hashString() has not been implemented")})})}},hn_clientInfoDecodingError_code="client_info_decoding_error",hn_clientInfoDecodingError_desc="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",hn_clientInfoEmptyError_code="client_info_empty_error",hn_clientInfoEmptyError_desc="The client info was empty. Please review the trace to determine the root cause.",hn_tokenParsingError_code="token_parsing_error",hn_tokenParsingError_desc="Token cannot be parsed. Please review stack trace to determine root cause.",hn_nullOrEmptyToken_code="null_or_empty_token",hn_nullOrEmptyToken_desc="The token is null or empty. Please review the trace to determine the root cause.",hn_endpointResolutionError_code="endpoints_resolution_error",hn_endpointResolutionError_desc="Error: could not resolve endpoints. Please check network and try again.",hn_networkError_code="network_error",hn_networkError_desc="Network request failed. Please check network trace to determine root cause.",hn_unableToGetOpenidConfigError_code="openid_config_error",hn_unableToGetOpenidConfigError_desc="Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",hn_hashNotDeserialized_code="hash_not_deserialized",hn_hashNotDeserialized_desc="The hash parameters could not be deserialized. Please review the trace to determine the root cause.",hn_invalidStateError_code="invalid_state",hn_invalidStateError_desc="State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState().",hn_stateMismatchError_code="state_mismatch",hn_stateMismatchError_desc="State mismatch error. Please check your network. Continued requests may cause cache overflow.",hn_stateNotFoundError_code="state_not_found",hn_stateNotFoundError_desc="State not found",hn_nonceMismatchError_code="nonce_mismatch",hn_nonceMismatchError_desc="Nonce mismatch error. This may be caused by a race condition in concurrent requests.",hn_nonceNotFoundError_code="nonce_not_found",hn_nonceNotFoundError_desc="nonce not found",hn_authTimeNotFoundError_code="auth_time_not_found",hn_authTimeNotFoundError_desc="Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",hn_maxAgeTranspiredError_code="max_age_transpired",hn_maxAgeTranspiredError_desc="Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",hn_multipleMatchingTokens_code="multiple_matching_tokens",hn_multipleMatchingTokens_desc="The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",hn_multipleMatchingAccounts_code="multiple_matching_accounts",hn_multipleMatchingAccounts_desc="The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",hn_multipleMatchingAppMetadata_code="multiple_matching_appMetadata",hn_multipleMatchingAppMetadata_desc="The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",hn_tokenRequestCannotBeMade_code="request_cannot_be_made",hn_tokenRequestCannotBeMade_desc="Token request cannot be made without authorization code or refresh token.",hn_appendEmptyScopeError_code="cannot_append_empty_scope",hn_appendEmptyScopeError_desc="Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info.",hn_removeEmptyScopeError_code="cannot_remove_empty_scope",hn_removeEmptyScopeError_desc="Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info.",hn_appendScopeSetError_code="cannot_append_scopeset",hn_appendScopeSetError_desc="Cannot append ScopeSet due to error.",hn_emptyInputScopeSetError_code="empty_input_scopeset",hn_emptyInputScopeSetError_desc="Empty input ScopeSet cannot be processed.",hn_DeviceCodePollingCancelled_code="device_code_polling_cancelled",hn_DeviceCodePollingCancelled_desc="Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",hn_DeviceCodeExpired_code="device_code_expired",hn_DeviceCodeExpired_desc="Device code is expired.",hn_DeviceCodeUnknownError_code="device_code_unknown_error",hn_DeviceCodeUnknownError_desc="Device code stopped polling for unknown reasons.",hn_NoAccountInSilentRequest_code="no_account_in_silent_request",hn_NoAccountInSilentRequest_desc="Please pass an account object, silent flow is not supported without account information",hn_invalidCacheRecord_code="invalid_cache_record",hn_invalidCacheRecord_desc="Cache record object was null or undefined.",hn_invalidCacheEnvironment_code="invalid_cache_environment",hn_invalidCacheEnvironment_desc="Invalid environment when attempting to create cache entry",hn_noAccountFound_code="no_account_found",hn_noAccountFound_desc="No account found in cache for given key.",hn_CachePluginError_code="no cache plugin set on CacheManager",hn_CachePluginError_desc="ICachePlugin needs to be set before using readFromStorage or writeFromStorage",hn_noCryptoObj_code="no_crypto_object",hn_noCryptoObj_desc="No crypto object detected. This is required for the following operation: ",hn_invalidCacheType_code="invalid_cache_type",hn_invalidCacheType_desc="Invalid cache type",hn_unexpectedAccountType_code="unexpected_account_type",hn_unexpectedAccountType_desc="Unexpected account type.",hn_unexpectedCredentialType_code="unexpected_credential_type",hn_unexpectedCredentialType_desc="Unexpected credential type.",hn_invalidAssertion_code="invalid_assertion",hn_invalidAssertion_desc="Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",hn_invalidClientCredential_code="invalid_client_credential",hn_invalidClientCredential_desc="Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",hn_tokenRefreshRequired_code="token_refresh_required",hn_tokenRefreshRequired_desc="Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",hn_userTimeoutReached_code="user_timeout_reached",hn_userTimeoutReached_desc="User defined timeout for device code polling reached",hn_tokenClaimsRequired_code="token_claims_cnf_required_for_signedjwt",hn_tokenClaimsRequired_desc="Cannot generate a POP jwt if the token_claims are not populated",hn_noAuthorizationCodeFromServer_code="authorization_code_missing_from_server_response",hn_noAuthorizationCodeFromServer_desc="Server response does not contain an authorization code to proceed",hn_bindingKeyNotRemovedError_code="binding_key_not_removed",hn_bindingKeyNotRemovedError_desc="Could not remove the credential's binding key from storage.",hn_logoutNotSupported_code="end_session_endpoint_not_supported",hn_logoutNotSupported_desc="Provided authority does not support logout.",hn_keyIdMissing_code="key_id_missing",hn_keyIdMissing_desc="A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",hn_noNetworkConnectivity_code="no_network_connectivity",hn_noNetworkConnectivity_desc="No network connectivity. Check your internet connection.",hn_userCanceledError_code="user_canceled",hn_userCanceledError_desc="User canceled the flow.",Vn=function(a){function o(i,l){return(i=a.call(this,i,l)||this).name="ClientAuthError",Object.setPrototypeOf(i,o.prototype),i}return ou(o,a),o.createClientInfoDecodingError=function(i){return new o(hn_clientInfoDecodingError_code,hn_clientInfoDecodingError_desc+" Failed with error: "+i)},o.createClientInfoEmptyError=function(){return new o(hn_clientInfoEmptyError_code,""+hn_clientInfoEmptyError_desc)},o.createTokenParsingError=function(i){return new o(hn_tokenParsingError_code,hn_tokenParsingError_desc+" Failed with error: "+i)},o.createTokenNullOrEmptyError=function(i){return new o(hn_nullOrEmptyToken_code,hn_nullOrEmptyToken_desc+" Raw Token Value: "+i)},o.createEndpointDiscoveryIncompleteError=function(i){return new o(hn_endpointResolutionError_code,hn_endpointResolutionError_desc+" Detail: "+i)},o.createNetworkError=function(i,l){return new o(hn_networkError_code,hn_networkError_desc+" | Fetch client threw: "+l+" | Attempted to reach: "+i.split("?")[0])},o.createUnableToGetOpenidConfigError=function(i){return new o(hn_unableToGetOpenidConfigError_code,hn_unableToGetOpenidConfigError_desc+" Attempted to retrieve endpoints from: "+i)},o.createHashNotDeserializedError=function(i){return new o(hn_hashNotDeserialized_code,hn_hashNotDeserialized_desc+" Given Object: "+i)},o.createInvalidStateError=function(i,l){return new o(hn_invalidStateError_code,hn_invalidStateError_desc+" Invalid State: "+i+", Root Err: "+l)},o.createStateMismatchError=function(){return new o(hn_stateMismatchError_code,hn_stateMismatchError_desc)},o.createStateNotFoundError=function(i){return new o(hn_stateNotFoundError_code,hn_stateNotFoundError_desc+":  "+i)},o.createNonceMismatchError=function(){return new o(hn_nonceMismatchError_code,hn_nonceMismatchError_desc)},o.createAuthTimeNotFoundError=function(){return new o(hn_authTimeNotFoundError_code,hn_authTimeNotFoundError_desc)},o.createMaxAgeTranspiredError=function(){return new o(hn_maxAgeTranspiredError_code,hn_maxAgeTranspiredError_desc)},o.createNonceNotFoundError=function(i){return new o(hn_nonceNotFoundError_code,hn_nonceNotFoundError_desc+":  "+i)},o.createMultipleMatchingTokensInCacheError=function(){return new o(hn_multipleMatchingTokens_code,hn_multipleMatchingTokens_desc+".")},o.createMultipleMatchingAccountsInCacheError=function(){return new o(hn_multipleMatchingAccounts_code,hn_multipleMatchingAccounts_desc)},o.createMultipleMatchingAppMetadataInCacheError=function(){return new o(hn_multipleMatchingAppMetadata_code,hn_multipleMatchingAppMetadata_desc)},o.createTokenRequestCannotBeMadeError=function(){return new o(hn_tokenRequestCannotBeMade_code,hn_tokenRequestCannotBeMade_desc)},o.createAppendEmptyScopeToSetError=function(i){return new o(hn_appendEmptyScopeError_code,hn_appendEmptyScopeError_desc+" Given Scope: "+i)},o.createRemoveEmptyScopeFromSetError=function(i){return new o(hn_removeEmptyScopeError_code,hn_removeEmptyScopeError_desc+" Given Scope: "+i)},o.createAppendScopeSetError=function(i){return new o(hn_appendScopeSetError_code,hn_appendScopeSetError_desc+" Detail Error: "+i)},o.createEmptyInputScopeSetError=function(){return new o(hn_emptyInputScopeSetError_code,""+hn_emptyInputScopeSetError_desc)},o.createDeviceCodeCancelledError=function(){return new o(hn_DeviceCodePollingCancelled_code,""+hn_DeviceCodePollingCancelled_desc)},o.createDeviceCodeExpiredError=function(){return new o(hn_DeviceCodeExpired_code,""+hn_DeviceCodeExpired_desc)},o.createDeviceCodeUnknownError=function(){return new o(hn_DeviceCodeUnknownError_code,""+hn_DeviceCodeUnknownError_desc)},o.createNoAccountInSilentRequestError=function(){return new o(hn_NoAccountInSilentRequest_code,""+hn_NoAccountInSilentRequest_desc)},o.createNullOrUndefinedCacheRecord=function(){return new o(hn_invalidCacheRecord_code,hn_invalidCacheRecord_desc)},o.createInvalidCacheEnvironmentError=function(){return new o(hn_invalidCacheEnvironment_code,hn_invalidCacheEnvironment_desc)},o.createNoAccountFoundError=function(){return new o(hn_noAccountFound_code,hn_noAccountFound_desc)},o.createCachePluginError=function(){return new o(hn_CachePluginError_code,""+hn_CachePluginError_desc)},o.createNoCryptoObjectError=function(i){return new o(hn_noCryptoObj_code,""+hn_noCryptoObj_desc+i)},o.createInvalidCacheTypeError=function(){return new o(hn_invalidCacheType_code,""+hn_invalidCacheType_desc)},o.createUnexpectedAccountTypeError=function(){return new o(hn_unexpectedAccountType_code,""+hn_unexpectedAccountType_desc)},o.createUnexpectedCredentialTypeError=function(){return new o(hn_unexpectedCredentialType_code,""+hn_unexpectedCredentialType_desc)},o.createInvalidAssertionError=function(){return new o(hn_invalidAssertion_code,""+hn_invalidAssertion_desc)},o.createInvalidCredentialError=function(){return new o(hn_invalidClientCredential_code,""+hn_invalidClientCredential_desc)},o.createRefreshRequiredError=function(){return new o(hn_tokenRefreshRequired_code,hn_tokenRefreshRequired_desc)},o.createUserTimeoutReachedError=function(){return new o(hn_userTimeoutReached_code,hn_userTimeoutReached_desc)},o.createTokenClaimsRequiredError=function(){return new o(hn_tokenClaimsRequired_code,hn_tokenClaimsRequired_desc)},o.createNoAuthCodeInServerResponseError=function(){return new o(hn_noAuthorizationCodeFromServer_code,hn_noAuthorizationCodeFromServer_desc)},o.createBindingKeyNotRemovedError=function(){return new o(hn_bindingKeyNotRemovedError_code,hn_bindingKeyNotRemovedError_desc)},o.createLogoutNotSupportedError=function(){return new o(hn_logoutNotSupported_code,hn_logoutNotSupported_desc)},o.createKeyIdMissingError=function(){return new o(hn_keyIdMissing_code,hn_keyIdMissing_desc)},o.createNoNetworkConnectivityError=function(){return new o(hn_noNetworkConnectivity_code,hn_noNetworkConnectivity_desc)},o.createUserCanceledError=function(){return new o(hn_userCanceledError_code,hn_userCanceledError_desc)},o}(dr),Ln=function(){function a(){}return a.decodeAuthToken=function(o){if(a.isEmpty(o))throw Vn.createTokenNullOrEmptyError(o);var i=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(o);if(!i||i.length<4)throw Vn.createTokenParsingError("Given token is malformed: "+JSON.stringify(o));return{header:i[1],JWSPayload:i[2],JWSSig:i[3]}},a.isEmpty=function(o){return void 0===o||!o||0===o.length},a.isEmptyObj=function(o){if(o&&!a.isEmpty(o))try{var i=JSON.parse(o);return 0===Object.keys(i).length}catch{}return!0},a.startsWith=function(o,i){return 0===o.indexOf(i)},a.endsWith=function(o,i){return o.length>=i.length&&o.lastIndexOf(i)===o.length-i.length},a.queryStringToObject=function(u){function i(h){return decodeURIComponent(h.replace(/\+/g," "))}var l={};return(u=u.split("&")).forEach(function(h){var g;h.trim()&&(g=(h=h.split(/=(.+)/g,2))[0],h=h[1],g)&&h&&(l[i(g)]=i(h))}),l},a.trimArrayEntries=function(o){return o.map(function(i){return i.trim()})},a.removeEmptyStringsFromArray=function(o){return o.filter(function(i){return!a.isEmpty(i)})},a.jsonParseHelper=function(o){try{return JSON.parse(o)}catch{return null}},a.matchPattern=function(o,i){return new RegExp(o.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(i)},a}(),fN=(function(a){a[a.Error=0]="Error",a[a.Warning=1]="Warning",a[a.Info=2]="Info",a[a.Verbose=3]="Verbose",a[a.Trace=4]="Trace"}(Js=Js||{}),function(){function a(o,i,l){this.level=Js.Info,o=o||a.createDefaultLoggerOptions(),this.localCallback=o.loggerCallback||function(){},this.piiLoggingEnabled=o.piiLoggingEnabled||!1,this.level="number"==typeof o.logLevel?o.logLevel:Js.Info,this.correlationId=o.correlationId||je.EMPTY_STRING,this.packageName=i||je.EMPTY_STRING,this.packageVersion=l||je.EMPTY_STRING}return a.createDefaultLoggerOptions=function(){return{loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:Js.Info}},a.prototype.clone=function(o,i,l){return new a({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:l||this.correlationId},o,i)},a.prototype.logMessage=function(o,i){var l;i.logLevel>this.level||!this.piiLoggingEnabled&&i.containsPii||(l=(new Date).toUTCString(),l=(Ln.isEmpty(i.correlationId)?Ln.isEmpty(this.correlationId)?"["+l+"]":"["+l+"] : ["+this.correlationId+"]":"["+l+"] : ["+i.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+Js[i.logLevel]+" - "+o,this.executeCallback(i.logLevel,l,i.containsPii||!1))},a.prototype.executeCallback=function(o,i,l){this.localCallback&&this.localCallback(o,i,l)},a.prototype.error=function(o,i){this.logMessage(o,{logLevel:Js.Error,containsPii:!1,correlationId:i||je.EMPTY_STRING})},a.prototype.errorPii=function(o,i){this.logMessage(o,{logLevel:Js.Error,containsPii:!0,correlationId:i||je.EMPTY_STRING})},a.prototype.warning=function(o,i){this.logMessage(o,{logLevel:Js.Warning,containsPii:!1,correlationId:i||je.EMPTY_STRING})},a.prototype.warningPii=function(o,i){this.logMessage(o,{logLevel:Js.Warning,containsPii:!0,correlationId:i||je.EMPTY_STRING})},a.prototype.info=function(o,i){this.logMessage(o,{logLevel:Js.Info,containsPii:!1,correlationId:i||je.EMPTY_STRING})},a.prototype.infoPii=function(o,i){this.logMessage(o,{logLevel:Js.Info,containsPii:!0,correlationId:i||je.EMPTY_STRING})},a.prototype.verbose=function(o,i){this.logMessage(o,{logLevel:Js.Verbose,containsPii:!1,correlationId:i||je.EMPTY_STRING})},a.prototype.verbosePii=function(o,i){this.logMessage(o,{logLevel:Js.Verbose,containsPii:!0,correlationId:i||je.EMPTY_STRING})},a.prototype.trace=function(o,i){this.logMessage(o,{logLevel:Js.Trace,containsPii:!1,correlationId:i||je.EMPTY_STRING})},a.prototype.tracePii=function(o,i){this.logMessage(o,{logLevel:Js.Trace,containsPii:!0,correlationId:i||je.EMPTY_STRING})},a.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},a}()),Gz="@azure/msal-common",Kz="13.3.1",Xr=(function(a){a[a.None=0]="None",a.AzurePublic="https://login.microsoftonline.com",a.AzurePpe="https://login.windows-ppe.net",a.AzureChina="https://login.chinacloudapi.cn",a.AzureGermany="https://login.microsoftonline.de",a.AzureUsGovernment="https://login.microsoftonline.us"}(Bx=Bx||{}),{redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},urlParseError:{code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},urlEmptyError:{code:"empty_url_error",desc:"URL was empty or null."},emptyScopesError:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},nonArrayScopesError:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientIdSingleScopeError:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create', 'none' and 'no_session'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},invalidClaimsRequest:{code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},tokenRequestEmptyError:{code:"token_request_empty",desc:"Token request was empty and not found in cache."},logoutRequestEmptyError:{code:"logout_request_empty",desc:"The logout request was null or undefined."},invalidCodeChallengeMethod:{code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},invalidCodeChallengeParams:{code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},invalidCloudDiscoveryMetadata:{code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields"},invalidAuthorityMetadata:{code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields."},untrustedAuthority:{code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},invalidAzureCloudInstance:{code:"invalid_azure_cloud_instance",desc:"Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values"},missingSshJwk:{code:"missing_ssh_jwk",desc:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme."},missingSshKid:{code:"missing_ssh_kid",desc:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme."},missingNonceAuthenticationHeader:{code:"missing_nonce_authentication_header",desc:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce."},invalidAuthenticationHeader:{code:"invalid_authentication_header",desc:"Invalid authentication header provided"},authorityMismatch:{code:"authority_mismatch",desc:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."}}),Os=function(a){function o(i,l){return(i=a.call(this,i,l)||this).name="ClientConfigurationError",Object.setPrototypeOf(i,o.prototype),i}return ou(o,a),o.createRedirectUriEmptyError=function(){return new o(Xr.redirectUriNotSet.code,Xr.redirectUriNotSet.desc)},o.createPostLogoutRedirectUriEmptyError=function(){return new o(Xr.postLogoutUriNotSet.code,Xr.postLogoutUriNotSet.desc)},o.createClaimsRequestParsingError=function(i){return new o(Xr.claimsRequestParsingError.code,Xr.claimsRequestParsingError.desc+" Given value: "+i)},o.createInsecureAuthorityUriError=function(i){return new o(Xr.authorityUriInsecure.code,Xr.authorityUriInsecure.desc+" Given URI: "+i)},o.createUrlParseError=function(i){return new o(Xr.urlParseError.code,Xr.urlParseError.desc+" Given Error: "+i)},o.createUrlEmptyError=function(){return new o(Xr.urlEmptyError.code,Xr.urlEmptyError.desc)},o.createEmptyScopesArrayError=function(){return new o(Xr.emptyScopesError.code,""+Xr.emptyScopesError.desc)},o.createClientIdSingleScopeError=function(i){return new o(Xr.clientIdSingleScopeError.code,Xr.clientIdSingleScopeError.desc+" Given Scopes: "+i)},o.createInvalidPromptError=function(i){return new o(Xr.invalidPrompt.code,Xr.invalidPrompt.desc+" Given value: "+i)},o.createInvalidClaimsRequestError=function(){return new o(Xr.invalidClaimsRequest.code,Xr.invalidClaimsRequest.desc)},o.createEmptyLogoutRequestError=function(){return new o(Xr.logoutRequestEmptyError.code,Xr.logoutRequestEmptyError.desc)},o.createEmptyTokenRequestError=function(){return new o(Xr.tokenRequestEmptyError.code,Xr.tokenRequestEmptyError.desc)},o.createInvalidCodeChallengeMethodError=function(){return new o(Xr.invalidCodeChallengeMethod.code,Xr.invalidCodeChallengeMethod.desc)},o.createInvalidCodeChallengeParamsError=function(){return new o(Xr.invalidCodeChallengeParams.code,Xr.invalidCodeChallengeParams.desc)},o.createInvalidCloudDiscoveryMetadataError=function(){return new o(Xr.invalidCloudDiscoveryMetadata.code,Xr.invalidCloudDiscoveryMetadata.desc)},o.createInvalidAuthorityMetadataError=function(){return new o(Xr.invalidAuthorityMetadata.code,Xr.invalidAuthorityMetadata.desc)},o.createUntrustedAuthorityError=function(){return new o(Xr.untrustedAuthority.code,Xr.untrustedAuthority.desc)},o.createInvalidAzureCloudInstanceError=function(){return new o(Xr.invalidAzureCloudInstance.code,Xr.invalidAzureCloudInstance.desc)},o.createMissingSshJwkError=function(){return new o(Xr.missingSshJwk.code,Xr.missingSshJwk.desc)},o.createMissingSshKidError=function(){return new o(Xr.missingSshKid.code,Xr.missingSshKid.desc)},o.createMissingNonceAuthenticationHeadersError=function(){return new o(Xr.missingNonceAuthenticationHeader.code,Xr.missingNonceAuthenticationHeader.desc)},o.createInvalidAuthenticationHeaderError=function(i,l){return new o(Xr.invalidAuthenticationHeader.code,Xr.invalidAuthenticationHeader.desc+". Invalid header: "+i+". Details: "+l)},o.createAuthorityMismatchError=function(){return new o(Xr.authorityMismatch.code,Xr.authorityMismatch.desc)},o}(Vn),au=function(){function a(l){var i=this;l=(l=l?Ln.trimArrayEntries(uN(l)):[])?Ln.removeEmptyStringsFromArray(l):[],this.validateInputScopes(l),this.scopes=new Set,l.forEach(function(u){return i.scopes.add(u)})}return a.fromString=function(o){return new a((o||je.EMPTY_STRING).split(" "))},a.createSearchScopes=function(o){return(o=new a(o)).containsOnlyOIDCScopes()?o.removeScope(je.OFFLINE_ACCESS_SCOPE):o.removeOIDCScopes(),o},a.prototype.validateInputScopes=function(o){if(!o||o.length<1)throw Os.createEmptyScopesArrayError()},a.prototype.containsScope=function(o){var i=new a(this.printScopesLowerCase().split(" "));return!Ln.isEmpty(o)&&i.scopes.has(o.toLowerCase())},a.prototype.containsScopeSet=function(o){var i=this;return!(!o||o.scopes.size<=0)&&this.scopes.size>=o.scopes.size&&o.asArray().every(function(l){return i.containsScope(l)})},a.prototype.containsOnlyOIDCScopes=function(){var o=this,i=0;return hN.forEach(function(l){o.containsScope(l)&&(i+=1)}),this.scopes.size===i},a.prototype.appendScope=function(o){Ln.isEmpty(o)||this.scopes.add(o.trim())},a.prototype.appendScopes=function(o){var i=this;try{o.forEach(function(l){return i.appendScope(l)})}catch(l){throw Vn.createAppendScopeSetError(l)}},a.prototype.removeScope=function(o){if(Ln.isEmpty(o))throw Vn.createRemoveEmptyScopeFromSetError(o);this.scopes.delete(o.trim())},a.prototype.removeOIDCScopes=function(){var o=this;hN.forEach(function(i){o.scopes.delete(i)})},a.prototype.unionScopeSets=function(o){var i;if(o)return i=new Set,o.scopes.forEach(function(l){return i.add(l.toLowerCase())}),this.scopes.forEach(function(l){return i.add(l.toLowerCase())}),i;throw Vn.createEmptyInputScopeSetError()},a.prototype.intersectingScopeSets=function(l){if(!l)throw Vn.createEmptyInputScopeSetError();l.containsOnlyOIDCScopes()||l.removeOIDCScopes();var i=this.unionScopeSets(l),u=(l=l.getScopeCount(),this.getScopeCount());return i.size<u+l},a.prototype.getScopeCount=function(){return this.scopes.size},a.prototype.asArray=function(){var o=[];return this.scopes.forEach(function(i){return o.push(i)}),o},a.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):je.EMPTY_STRING},a.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},a}();function Wz(a,o){if(Ln.isEmpty(a))throw Vn.createClientInfoEmptyError();try{var i=o.base64Decode(a);return JSON.parse(i)}catch(l){throw Vn.createClientInfoDecodingError(l.message)}}function Hx(a){if(Ln.isEmpty(a))throw Vn.createClientInfoDecodingError("Home account ID was empty.");return{uid:(a=a.split(Tl.CLIENT_INFO_SEPARATOR,2))[0],utid:a.length<2?je.EMPTY_STRING:a[1]}}!function(a){a[a.Default=0]="Default",a[a.Adfs=1]="Adfs",a[a.Dsts=2]="Dsts",a[a.Ciam=3]="Ciam"}(su=su||{});var Ac=function(){function a(){}return a.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(Tl.CACHE_KEY_SEPARATOR).toLowerCase()},a.prototype.generateAccountKey=function(){return a.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},a.prototype.generateType=function(){switch(this.authorityType){case vp.ADFS_ACCOUNT_TYPE:return Ih.ADFS;case vp.MSAV1_ACCOUNT_TYPE:return Ih.MSA;case vp.MSSTS_ACCOUNT_TYPE:return Ih.MSSTS;case vp.GENERIC_ACCOUNT_TYPE:return Ih.GENERIC;default:throw Vn.createUnexpectedAccountTypeError()}},a.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},a.generateAccountCacheKey=function(o){return[o.homeAccountId,o.environment||je.EMPTY_STRING,o.tenantId||je.EMPTY_STRING].join(Tl.CACHE_KEY_SEPARATOR).toLowerCase()},a.createAccount=function(P,i,l,u,h,g,w,T){var D=new a;if(D.authorityType=vp.MSSTS_ACCOUNT_TYPE,D.clientInfo=P,D.homeAccountId=i,D.nativeAccountId=T,P=w||u&&u.getPreferredCache())return D.environment=P,D.realm=(null==(i=l?.claims)?void 0:i.tid)||je.EMPTY_STRING,l&&(D.idTokenClaims=l.claims,D.localAccountId=(null==(T=l?.claims)?void 0:T.oid)||(null==(w=l?.claims)?void 0:w.sub)||je.EMPTY_STRING,P=null==(u=l?.claims)?void 0:u.preferred_username,T=null!=(i=l?.claims)&&i.emails?l.claims.emails[0]:null,D.username=P||T||je.EMPTY_STRING,D.name=null==(w=l?.claims)?void 0:w.name),D.cloudGraphHostName=h,D.msGraphHost=g,D;throw Vn.createInvalidCacheEnvironmentError()},a.createGenericAccount=function(T,i,l,u,h,g){var w=new a;if(w.authorityType=l&&l.authorityType===su.Adfs?vp.ADFS_ACCOUNT_TYPE:vp.GENERIC_ACCOUNT_TYPE,w.homeAccountId=T,w.realm=je.EMPTY_STRING,T=g||l&&l.getPreferredCache())return i&&(w.localAccountId=(null==(g=i?.claims)?void 0:g.oid)||(null==(l=i?.claims)?void 0:l.sub)||je.EMPTY_STRING,w.username=(null==(g=i?.claims)?void 0:g.upn)||je.EMPTY_STRING,w.name=(null==(l=i?.claims)?void 0:l.name)||je.EMPTY_STRING,w.idTokenClaims=i?.claims),w.environment=T,w.cloudGraphHostName=u,w.msGraphHost=h,w;throw Vn.createInvalidCacheEnvironmentError()},a.generateHomeAccountId=function(o,i,l,u,h){var g=null!=(g=h?.claims)&&g.sub?h.claims.sub:je.EMPTY_STRING;if(i!==su.Adfs&&i!==su.Dsts){if(o)try{var w=Wz(o,u);if(!Ln.isEmpty(w.uid)&&!Ln.isEmpty(w.utid))return""+w.uid+Tl.CLIENT_INFO_SEPARATOR+w.utid}catch{}l.verbose("No client info in response")}return g},a.isAccountEntity=function(o){return!!o&&o.hasOwnProperty("homeAccountId")&&o.hasOwnProperty("environment")&&o.hasOwnProperty("realm")&&o.hasOwnProperty("localAccountId")&&o.hasOwnProperty("username")&&o.hasOwnProperty("authorityType")},a.accountInfoIsEqual=function(o,i,l){var u,h;return!(!o||!i)&&(h=!0,l&&(h=(l=o.idTokenClaims||{}).iat===(u=i.idTokenClaims||{}).iat&&l.nonce===u.nonce),o.homeAccountId===i.homeAccountId)&&o.localAccountId===i.localAccountId&&o.username===i.username&&o.tenantId===i.tenantId&&o.environment===i.environment&&o.nativeAccountId===i.nativeAccountId&&h},a}(),Bf=function(){function a(o,i){if(Ln.isEmpty(o))throw Vn.createTokenNullOrEmptyError(o);this.rawToken=o,this.claims=a.extractTokenClaims(o,i)}return a.extractTokenClaims=function(o,i){o=Ln.decodeAuthToken(o);try{var u=i.base64Decode(o.JWSPayload);return JSON.parse(u)}catch(h){throw Vn.createTokenParsingError(h)}},a.checkMaxAge=function(o,i){if(0===i||Date.now()-3e5>o+i)throw Vn.createMaxAgeTranspiredError()},a}(),$u=function(){function a(o,i,l){this.clientId=o,this.cryptoImpl=i,this.commonLogger=l.clone(Gz,Kz)}return a.prototype.getAllAccounts=function(){var o=this,i=this.getAccountKeys();return i.length<1||(i=i.reduce(function(l,u){return(u=o.getAccount(u))&&l.push(u),l},[])).length<1?[]:i.map(function(l){return o.getAccountInfoFromEntity(l)})},a.prototype.getAccountInfoFilteredBy=function(o){return 0<(o=this.getAccountsFilteredBy(o)).length?this.getAccountInfoFromEntity(o[0]):null},a.prototype.getAccountInfoFromEntity=function(i){i=i.getAccountInfo();var l=this.getIdToken(i);return l&&(i.idToken=l.secret,i.idTokenClaims=new Bf(l.secret,this.cryptoImpl).claims),i},a.prototype.saveCacheRecord=function(o){return Gr(this,void 0,void 0,function(){return Kr(this,function(i){switch(i.label){case 0:if(o)return o.account&&this.setAccount(o.account),o.idToken&&this.setIdTokenCredential(o.idToken),o.accessToken?[4,this.saveAccessToken(o.accessToken)]:[3,2];throw Vn.createNullOrUndefinedCacheRecord();case 1:i.sent(),i.label=2;case 2:return o.refreshToken&&this.setRefreshTokenCredential(o.refreshToken),o.appMetadata&&this.setAppMetadata(o.appMetadata),[2]}})})},a.prototype.saveAccessToken=function(o){return Gr(this,void 0,void 0,function(){var i,l,u,h,g=this;return Kr(this,function(w){switch(w.label){case 0:return i={clientId:o.clientId,credentialType:o.credentialType,environment:o.environment,homeAccountId:o.homeAccountId,realm:o.realm,tokenType:o.tokenType,requestedClaimsHash:o.requestedClaimsHash},l=this.getTokenKeys(),u=au.fromString(o.target),h=[],l.accessToken.forEach(function(T){var D;g.accessTokenKeyMatchesFilter(T,i,!1)&&(D=g.getAccessTokenCredential(T))&&g.credentialMatchesFilter(D,i)&&au.fromString(D.target).intersectingScopeSets(u)&&h.push(g.removeAccessToken(T))}),[4,Promise.all(h)];case 1:return w.sent(),this.setAccessTokenCredential(o),[2]}})})},a.prototype.getAccountsFilteredBy=function(o){var i=this,l=this.getAccountKeys(),u=[];return l.forEach(function(h){!i.isAccountKey(h,o.homeAccountId,o.realm)||!(h=i.getAccount(h))||o.homeAccountId&&!i.matchHomeAccountId(h,o.homeAccountId)||o.localAccountId&&!i.matchLocalAccountId(h,o.localAccountId)||o.username&&!i.matchUsername(h,o.username)||o.environment&&!i.matchEnvironment(h,o.environment)||o.realm&&!i.matchRealm(h,o.realm)||o.nativeAccountId&&!i.matchNativeAccountId(h,o.nativeAccountId)||u.push(h)}),u},a.prototype.isAccountKey=function(o,i,l){return!(o.split(Tl.CACHE_KEY_SEPARATOR).length<3||i&&!o.toLowerCase().includes(i.toLowerCase())||l&&!o.toLowerCase().includes(l.toLowerCase()))},a.prototype.isCredentialKey=function(o){if(o.split(Tl.CACHE_KEY_SEPARATOR).length<6||-1===(o=o.toLowerCase()).indexOf(Mr.ID_TOKEN.toLowerCase())&&-1===o.indexOf(Mr.ACCESS_TOKEN.toLowerCase())&&-1===o.indexOf(Mr.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===o.indexOf(Mr.REFRESH_TOKEN.toLowerCase()))return!1;if(-1<o.indexOf(Mr.REFRESH_TOKEN.toLowerCase())){var l=""+Mr.REFRESH_TOKEN+Tl.CACHE_KEY_SEPARATOR+"1"+Tl.CACHE_KEY_SEPARATOR;if(-1===o.indexOf((""+Mr.REFRESH_TOKEN+Tl.CACHE_KEY_SEPARATOR+this.clientId+Tl.CACHE_KEY_SEPARATOR).toLowerCase())&&-1===o.indexOf(l.toLowerCase()))return!1}else if(-1===o.indexOf(this.clientId.toLowerCase()))return!1;return!0},a.prototype.credentialMatchesFilter=function(o,i){return!(i.clientId&&!this.matchClientId(o,i.clientId)||i.userAssertionHash&&!this.matchUserAssertionHash(o,i.userAssertionHash)||"string"==typeof i.homeAccountId&&!this.matchHomeAccountId(o,i.homeAccountId)||i.environment&&!this.matchEnvironment(o,i.environment)||i.realm&&!this.matchRealm(o,i.realm)||i.credentialType&&!this.matchCredentialType(o,i.credentialType)||i.familyId&&!this.matchFamilyId(o,i.familyId)||i.target&&!this.matchTarget(o,i.target)||(i.requestedClaimsHash||o.requestedClaimsHash)&&o.requestedClaimsHash!==i.requestedClaimsHash||o.credentialType===Mr.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(i.tokenType&&!this.matchTokenType(o,i.tokenType)||i.tokenType===vo.SSH&&i.keyId&&!this.matchKeyId(o,i.keyId)))},a.prototype.getAppMetadataFilteredBy=function(o){return this.getAppMetadataFilteredByInternal(o.environment,o.clientId)},a.prototype.getAppMetadataFilteredByInternal=function(o,i){var l=this,u=this.getKeys(),h={};return u.forEach(function(g){var w;!l.isAppMetadata(g)||!(w=l.getAppMetadata(g))||o&&!l.matchEnvironment(w,o)||i&&!l.matchClientId(w,i)||(h[g]=w)}),h},a.prototype.getAuthorityMetadataByAlias=function(o){var i=this,l=this.getAuthorityMetadataKeys(),u=null;return l.forEach(function(h){i.isAuthorityMetadata(h)&&-1!==h.indexOf(i.clientId)&&(h=i.getAuthorityMetadata(h))&&-1!==h.aliases.indexOf(o)&&(u=h)}),u},a.prototype.removeAllAccounts=function(){return Gr(this,void 0,void 0,function(){var o,i,l=this;return Kr(this,function(u){switch(u.label){case 0:return o=this.getAccountKeys(),i=[],o.forEach(function(h){i.push(l.removeAccount(h))}),[4,Promise.all(i)];case 1:return u.sent(),[2]}})})},a.prototype.removeAccount=function(o){return Gr(this,void 0,void 0,function(){var i;return Kr(this,function(l){switch(l.label){case 0:if(i=this.getAccount(o))return[4,this.removeAccountContext(i)];throw Vn.createNoAccountFoundError();case 1:return l.sent(),this.removeItem(o),[2]}})})},a.prototype.removeAccountContext=function(o){return Gr(this,void 0,void 0,function(){var i,l,u,h=this;return Kr(this,function(g){switch(g.label){case 0:return i=this.getTokenKeys(),l=o.generateAccountId(),u=[],i.idToken.forEach(function(w){0===w.indexOf(l)&&h.removeIdToken(w)}),i.accessToken.forEach(function(w){0===w.indexOf(l)&&u.push(h.removeAccessToken(w))}),i.refreshToken.forEach(function(w){0===w.indexOf(l)&&h.removeRefreshToken(w)}),[4,Promise.all(u)];case 1:return g.sent(),[2]}})})},a.prototype.removeAccessToken=function(o){return Gr(this,void 0,void 0,function(){var i;return Kr(this,function(l){switch(l.label){case 0:if(!(i=this.getAccessTokenCredential(o)))return[2];if(i.credentialType.toLowerCase()!==Mr.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(i.tokenType!==vo.POP)return[3,4];if(!(i=i.keyId))return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(i)];case 2:return l.sent(),[3,4];case 3:throw l.sent(),Vn.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(o)]}})})},a.prototype.removeAppMetadata=function(){var o=this;return this.getKeys().forEach(function(i){o.isAppMetadata(i)&&o.removeItem(i)}),!0},a.prototype.readCacheRecord=function(w,g,l){var T=this.getTokenKeys(),u=this.readAccountFromCache(w),h=this.getIdToken(w,T);return g=this.getAccessToken(w,g,T),w=this.getRefreshToken(w,!1,T),T=this.readAppMetadataFromCache(l),u&&h&&(u.idTokenClaims=new Bf(h.secret,this.cryptoImpl).claims),{account:u,idToken:h,accessToken:g,refreshToken:w,appMetadata:T}},a.prototype.readAccountFromCache=function(o){return o=Ac.generateAccountCacheKey(o),this.getAccount(o)},a.prototype.getIdToken=function(u,h){var l=this;return this.commonLogger.trace("CacheManager - getIdToken called"),(h=(u=this.getIdTokensByFilter(u={homeAccountId:u.homeAccountId,environment:u.environment,credentialType:Mr.ID_TOKEN,clientId:this.clientId,realm:u.tenantId},h)).length)<1?(this.commonLogger.info("CacheManager:getIdToken - No token found"),null):1<h?(this.commonLogger.info("CacheManager:getIdToken - Multiple id tokens found, clearing them"),u.forEach(function(g){l.removeIdToken(g.generateCredentialKey())}),null):(this.commonLogger.info("CacheManager:getIdToken - Returning id token"),u[0])},a.prototype.getIdTokensByFilter=function(o,u){var l=this,h=(u=u&&u.idToken||this.getTokenKeys().idToken,[]);return u.forEach(function(g){l.idTokenKeyMatchesFilter(g,Oo({clientId:l.clientId},o))&&(g=l.getIdTokenCredential(g))&&l.credentialMatchesFilter(g,o)&&h.push(g)}),h},a.prototype.idTokenKeyMatchesFilter=function(o,i){return o=o.toLowerCase(),!(i.clientId&&-1===o.indexOf(i.clientId.toLowerCase())||i.homeAccountId&&-1===o.indexOf(i.homeAccountId.toLowerCase()))},a.prototype.removeIdToken=function(o){this.removeItem(o)},a.prototype.removeRefreshToken=function(o){this.removeItem(o)},a.prototype.getAccessToken=function(P,i,l){var u=this,h=(this.commonLogger.trace("CacheManager - getAccessToken called"),au.createSearchScopes(i.scopes)),g=i.authenticationScheme||vo.BEARER,T=g&&g.toLowerCase()!==vo.BEARER.toLowerCase()?Mr.ACCESS_TOKEN_WITH_AUTH_SCHEME:Mr.ACCESS_TOKEN,w={homeAccountId:P.homeAccountId,environment:P.environment,credentialType:T,clientId:this.clientId,realm:P.tenantId,target:h,tokenType:g,keyId:i.sshKid,requestedClaimsHash:i.requestedClaimsHash},D=(T=l&&l.accessToken||this.getTokenKeys().accessToken,[]);return T.forEach(function(N){u.accessTokenKeyMatchesFilter(N,w,!0)&&(N=u.getAccessTokenCredential(N))&&u.credentialMatchesFilter(N,w)&&D.push(N)}),(P=D.length)<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):1<P?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),D.forEach(function(N){u.removeAccessToken(N.generateCredentialKey())}),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),D[0])},a.prototype.accessTokenKeyMatchesFilter=function(o,i,l){var u=o.toLowerCase();if(i.clientId&&-1===u.indexOf(i.clientId.toLowerCase())||i.homeAccountId&&-1===u.indexOf(i.homeAccountId.toLowerCase())||i.realm&&-1===u.indexOf(i.realm.toLowerCase())||i.requestedClaimsHash&&-1===u.indexOf(i.requestedClaimsHash.toLowerCase()))return!1;if(i.target)for(var h=i.target.asArray(),g=0;g<h.length;g++){if(l&&!u.includes(h[g].toLowerCase()))return!1;if(!l&&u.includes(h[g].toLowerCase()))return!0}return!0},a.prototype.getAccessTokensByFilter=function(o){var i=this,l=this.getTokenKeys(),u=[];return l.accessToken.forEach(function(h){i.accessTokenKeyMatchesFilter(h,o,!0)&&(h=i.getAccessTokenCredential(h))&&i.credentialMatchesFilter(h,o)&&u.push(h)}),u},a.prototype.getRefreshToken=function(w,h,l){var u=this,g=(this.commonLogger.trace("CacheManager - getRefreshToken called"),{homeAccountId:w.homeAccountId,environment:w.environment,credentialType:Mr.REFRESH_TOKEN,clientId:this.clientId,familyId:h=h?"1":void 0}),T=(w=l&&l.refreshToken||this.getTokenKeys().refreshToken,[]);return w.forEach(function(D){u.refreshTokenKeyMatchesFilter(D,g)&&(D=u.getRefreshTokenCredential(D))&&u.credentialMatchesFilter(D,g)&&T.push(D)}),T.length<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),T[0])},a.prototype.refreshTokenKeyMatchesFilter=function(o,i){return o=o.toLowerCase(),!(i.familyId&&-1===o.indexOf(i.familyId.toLowerCase())||!i.familyId&&i.clientId&&-1===o.indexOf(i.clientId.toLowerCase())||i.homeAccountId&&-1===o.indexOf(i.homeAccountId.toLowerCase()))},a.prototype.readAppMetadataFromCache=function(l){var i=this.getAppMetadataFilteredBy(l={environment:l,clientId:this.clientId}),u=(l=Object.keys(i).map(function(h){return i[h]})).length;if(u<1)return null;if(1<u)throw Vn.createMultipleMatchingAppMetadataInCacheError();return l[0]},a.prototype.isAppMetadataFOCI=function(o){return!(!(o=this.readAppMetadataFromCache(o))||"1"!==o.familyId)},a.prototype.matchHomeAccountId=function(o,i){return!("string"!=typeof o.homeAccountId||i!==o.homeAccountId)},a.prototype.matchLocalAccountId=function(o,i){return!("string"!=typeof o.localAccountId||i!==o.localAccountId)},a.prototype.matchUsername=function(o,i){return!("string"!=typeof o.username||i.toLowerCase()!==o.username.toLowerCase())},a.prototype.matchUserAssertionHash=function(o,i){return!(!o.userAssertionHash||i!==o.userAssertionHash)},a.prototype.matchEnvironment=function(o,i){return!!((i=this.getAuthorityMetadataByAlias(i))&&-1<i.aliases.indexOf(o.environment))},a.prototype.matchCredentialType=function(o,i){return o.credentialType&&i.toLowerCase()===o.credentialType.toLowerCase()},a.prototype.matchClientId=function(o,i){return!(!o.clientId||i!==o.clientId)},a.prototype.matchFamilyId=function(o,i){return!(!o.familyId||i!==o.familyId)},a.prototype.matchRealm=function(o,i){return!(!o.realm||i!==o.realm)},a.prototype.matchNativeAccountId=function(o,i){return!(!o.nativeAccountId||i!==o.nativeAccountId)},a.prototype.matchTarget=function(o,i){return!(o.credentialType!==Mr.ACCESS_TOKEN&&o.credentialType!==Mr.ACCESS_TOKEN_WITH_AUTH_SCHEME||!o.target)&&au.fromString(o.target).containsScopeSet(i)},a.prototype.matchTokenType=function(o,i){return!(!o.tokenType||o.tokenType!==i)},a.prototype.matchKeyId=function(o,i){return!(!o.keyId||o.keyId!==i)},a.prototype.isAppMetadata=function(o){return-1!==o.indexOf(QA)},a.prototype.isAuthorityMetadata=function(o){return-1!==o.indexOf("authority-metadata")},a.prototype.generateAuthorityMetadataCacheKey=function(o){return"authority-metadata-"+this.clientId+"-"+o},a.toObject=function(o,i){for(var l in i)o[l]=i[l];return o},a}(),Yz=function(a){function o(){return null!==a&&a.apply(this,arguments)||this}return ou(o,a),o.prototype.setAccount=function(){throw dr.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},o.prototype.getAccount=function(){throw dr.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},o.prototype.setIdTokenCredential=function(){throw dr.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},o.prototype.getIdTokenCredential=function(){throw dr.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},o.prototype.setAccessTokenCredential=function(){throw dr.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},o.prototype.getAccessTokenCredential=function(){throw dr.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},o.prototype.setRefreshTokenCredential=function(){throw dr.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},o.prototype.getRefreshTokenCredential=function(){throw dr.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},o.prototype.setAppMetadata=function(){throw dr.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},o.prototype.getAppMetadata=function(){throw dr.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},o.prototype.setServerTelemetry=function(){throw dr.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},o.prototype.getServerTelemetry=function(){throw dr.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},o.prototype.setAuthorityMetadata=function(){throw dr.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},o.prototype.getAuthorityMetadata=function(){throw dr.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},o.prototype.getAuthorityMetadataKeys=function(){throw dr.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},o.prototype.setThrottlingCache=function(){throw dr.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},o.prototype.getThrottlingCache=function(){throw dr.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},o.prototype.removeItem=function(){throw dr.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},o.prototype.containsKey=function(){throw dr.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},o.prototype.getKeys=function(){throw dr.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},o.prototype.getAccountKeys=function(){throw dr.createUnexpectedError("Storage interface - getAccountKeys() has not been implemented for the cacheStorage interface.")},o.prototype.getTokenKeys=function(){throw dr.createUnexpectedError("Storage interface - getTokenKeys() has not been implemented for the cacheStorage interface.")},o.prototype.clear=function(){return Gr(this,void 0,void 0,function(){return Kr(this,function(i){throw dr.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")})})},o.prototype.updateCredentialCacheKey=function(){throw dr.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},o}($u),a7={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},eD={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:Js.Info,correlationId:je.EMPTY_STRING},dae={claimsBasedCachingEnabled:!0},Lee={sendGetRequestAsync:function(){return Gr(this,void 0,void 0,function(){return Kr(this,function(a){throw dr.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")})})},sendPostRequestAsync:function(){return Gr(this,void 0,void 0,function(){return Kr(this,function(a){throw dr.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")})})}},Fee={sku:je.SKU,version:Kz,cpu:je.EMPTY_STRING,os:je.EMPTY_STRING},l7={clientSecret:je.EMPTY_STRING,clientAssertion:void 0},mN={azureCloudInstance:Bx.None,tenant:""+je.DEFAULT_COMMON_TENANT},Vee={application:{appName:"",appVersion:""}};function $x(a){return Oo({clientCapabilities:[],azureCloudOptions:mN,skipAuthorityMetadataCache:!1},a)}var oc,Ct,gN,aw,bp=function(a){function o(i,l,u){return(i=a.call(this,i,l,u)||this).name="ServerError",Object.setPrototypeOf(i,o.prototype),i}return ou(o,a),o}(dr),yN=function(){function a(){}return a.generateThrottlingStorageKey=function(o){return JA.THROTTLING_PREFIX+"."+JSON.stringify(o)},a.preProcess=function(o,u){u=a.generateThrottlingStorageKey(u);var l,h=o.getThrottlingCache(u);if(h){if(!(h.throttleTime<Date.now()))throw new bp((null==(l=h.errorCodes)?void 0:l.join(" "))||je.EMPTY_STRING,h.errorMessage,h.subError);o.removeItem(u)}},a.postProcess=function(o,i,l){(a.checkResponseStatus(l)||a.checkResponseForRetryAfter(l))&&(l={throttleTime:a.calculateThrottleTime(parseInt(l.headers[Ch.RETRY_AFTER])),error:l.body.error,errorCodes:l.body.error_codes,errorMessage:l.body.error_description,subError:l.body.suberror},o.setThrottlingCache(a.generateThrottlingStorageKey(i),l))},a.checkResponseStatus=function(o){return 429===o.status||500<=o.status&&o.status<600},a.checkResponseForRetryAfter=function(o){return!!o.headers&&o.headers.hasOwnProperty(Ch.RETRY_AFTER)&&(o.status<200||300<=o.status)},a.calculateThrottleTime=function(i){i=i<=0?0:i;var l=Date.now()/1e3;return Math.floor(1e3*Math.min(l+(i||JA.DEFAULT_THROTTLE_TIME_SECONDS),l+JA.DEFAULT_MAX_THROTTLE_TIME_SECONDS))},a.removeThrottle=function(o,i,l,u){u=this.generateThrottlingStorageKey(i={clientId:i,authority:l.authority,scopes:l.scopes,homeAccountIdentifier:u,claims:l.claims,authenticationScheme:l.authenticationScheme,resourceRequestMethod:l.resourceRequestMethod,resourceRequestUri:l.resourceRequestUri,shrClaims:l.shrClaims,sshKid:l.sshKid}),o.removeItem(u)},a}(),Uee=function(){function a(o,i){this.networkClient=o,this.cacheManager=i}return a.prototype.sendPostRequest=function(o,i,l){return Gr(this,void 0,void 0,function(){var u,h;return Kr(this,function(g){switch(g.label){case 0:yN.preProcess(this.cacheManager,o),g.label=1;case 1:return g.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(i,l)];case 2:return u=g.sent(),[3,4];case 3:throw(h=g.sent())instanceof dr?h:Vn.createNetworkError(i,h);case 4:return yN.postProcess(this.cacheManager,o,u),[2,u]}})})},a}(),lw=(function(a){a.HOME_ACCOUNT_ID="home_account_id",a.UPN="UPN"}(oc=oc||{}),function(){function a(){}return a.validateRedirectUri=function(o){if(Ln.isEmpty(o))throw Os.createRedirectUriEmptyError()},a.validatePrompt=function(o){var i,l=[];for(i in ic)l.push(ic[i]);if(l.indexOf(o)<0)throw Os.createInvalidPromptError(o)},a.validateClaims=function(o){try{JSON.parse(o)}catch{throw Os.createInvalidClaimsRequestError()}},a.validateCodeChallengeParams=function(o,i){if(Ln.isEmpty(o)||Ln.isEmpty(i))throw Os.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(i)},a.validateCodeChallengeMethod=function(o){if([dN.PLAIN,dN.S256].indexOf(o)<0)throw Os.createInvalidCodeChallengeMethodError()},a.sanitizeEQParams=function(o,i){return o?(i.forEach(function(l,u){o[u]&&delete o[u]}),Object.fromEntries(Object.entries(o).filter(function(l){return""!==l[1]}))):{}},a}()),tD=function(){function a(){this.parameters=new Map}return a.prototype.addResponseTypeCode=function(){this.parameters.set(ti.RESPONSE_TYPE,encodeURIComponent(je.CODE_RESPONSE_TYPE))},a.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(ti.RESPONSE_TYPE,encodeURIComponent(je.TOKEN_RESPONSE_TYPE+" "+je.ID_TOKEN_RESPONSE_TYPE))},a.prototype.addResponseMode=function(o){this.parameters.set(ti.RESPONSE_MODE,encodeURIComponent(o||ZA.QUERY))},a.prototype.addNativeBroker=function(){this.parameters.set(ti.NATIVE_BROKER,encodeURIComponent("1"))},a.prototype.addScopes=function(o,i){i=(i=void 0===i||i)?uN(o||[],Ux):o||[],o=new au(i),this.parameters.set(ti.SCOPE,encodeURIComponent(o.printScopes()))},a.prototype.addClientId=function(o){this.parameters.set(ti.CLIENT_ID,encodeURIComponent(o))},a.prototype.addRedirectUri=function(o){lw.validateRedirectUri(o),this.parameters.set(ti.REDIRECT_URI,encodeURIComponent(o))},a.prototype.addPostLogoutRedirectUri=function(o){lw.validateRedirectUri(o),this.parameters.set(ti.POST_LOGOUT_URI,encodeURIComponent(o))},a.prototype.addIdTokenHint=function(o){this.parameters.set(ti.ID_TOKEN_HINT,encodeURIComponent(o))},a.prototype.addDomainHint=function(o){this.parameters.set(YA.DOMAIN_HINT,encodeURIComponent(o))},a.prototype.addLoginHint=function(o){this.parameters.set(YA.LOGIN_HINT,encodeURIComponent(o))},a.prototype.addCcsUpn=function(o){this.parameters.set(Ch.CCS_HEADER,encodeURIComponent("UPN:"+o))},a.prototype.addCcsOid=function(o){this.parameters.set(Ch.CCS_HEADER,encodeURIComponent("Oid:"+o.uid+"@"+o.utid))},a.prototype.addSid=function(o){this.parameters.set(YA.SID,encodeURIComponent(o))},a.prototype.addClaims=function(o,i){o=this.addClientCapabilitiesToClaims(o,i),lw.validateClaims(o),this.parameters.set(ti.CLAIMS,encodeURIComponent(o))},a.prototype.addCorrelationId=function(o){this.parameters.set(ti.CLIENT_REQUEST_ID,encodeURIComponent(o))},a.prototype.addLibraryInfo=function(o){this.parameters.set(ti.X_CLIENT_SKU,o.sku),this.parameters.set(ti.X_CLIENT_VER,o.version),o.os&&this.parameters.set(ti.X_CLIENT_OS,o.os),o.cpu&&this.parameters.set(ti.X_CLIENT_CPU,o.cpu)},a.prototype.addApplicationTelemetry=function(o){null!=o&&o.appName&&this.parameters.set(ti.X_APP_NAME,o.appName),null!=o&&o.appVersion&&this.parameters.set(ti.X_APP_VER,o.appVersion)},a.prototype.addPrompt=function(o){lw.validatePrompt(o),this.parameters.set(""+ti.PROMPT,encodeURIComponent(o))},a.prototype.addState=function(o){Ln.isEmpty(o)||this.parameters.set(ti.STATE,encodeURIComponent(o))},a.prototype.addNonce=function(o){this.parameters.set(ti.NONCE,encodeURIComponent(o))},a.prototype.addCodeChallengeParams=function(o,i){if(lw.validateCodeChallengeParams(o,i),!o||!i)throw Os.createInvalidCodeChallengeParamsError();this.parameters.set(ti.CODE_CHALLENGE,encodeURIComponent(o)),this.parameters.set(ti.CODE_CHALLENGE_METHOD,encodeURIComponent(i))},a.prototype.addAuthorizationCode=function(o){this.parameters.set(ti.CODE,encodeURIComponent(o))},a.prototype.addDeviceCode=function(o){this.parameters.set(ti.DEVICE_CODE,encodeURIComponent(o))},a.prototype.addRefreshToken=function(o){this.parameters.set(ti.REFRESH_TOKEN,encodeURIComponent(o))},a.prototype.addCodeVerifier=function(o){this.parameters.set(ti.CODE_VERIFIER,encodeURIComponent(o))},a.prototype.addClientSecret=function(o){this.parameters.set(ti.CLIENT_SECRET,encodeURIComponent(o))},a.prototype.addClientAssertion=function(o){Ln.isEmpty(o)||this.parameters.set(ti.CLIENT_ASSERTION,encodeURIComponent(o))},a.prototype.addClientAssertionType=function(o){Ln.isEmpty(o)||this.parameters.set(ti.CLIENT_ASSERTION_TYPE,encodeURIComponent(o))},a.prototype.addOboAssertion=function(o){this.parameters.set(ti.OBO_ASSERTION,encodeURIComponent(o))},a.prototype.addRequestTokenUse=function(o){this.parameters.set(ti.REQUESTED_TOKEN_USE,encodeURIComponent(o))},a.prototype.addGrantType=function(o){this.parameters.set(ti.GRANT_TYPE,encodeURIComponent(o))},a.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},a.prototype.addExtraQueryParameters=function(o){var i=this,l=lw.sanitizeEQParams(o,this.parameters);Object.keys(l).forEach(function(u){i.parameters.set(u,o[u])})},a.prototype.addClientCapabilitiesToClaims=function(o,i){var l;if(o)try{l=JSON.parse(o)}catch{throw Os.createInvalidClaimsRequestError()}else l={};return i&&0<i.length&&(l.hasOwnProperty(Nx.ACCESS_TOKEN)||(l[Nx.ACCESS_TOKEN]={}),l[Nx.ACCESS_TOKEN][Nx.XMS_CC]={values:i}),JSON.stringify(l)},a.prototype.addUsername=function(o){this.parameters.set(Fx.username,encodeURIComponent(o))},a.prototype.addPassword=function(o){this.parameters.set(Fx.password,encodeURIComponent(o))},a.prototype.addPopToken=function(o){Ln.isEmpty(o)||(this.parameters.set(ti.TOKEN_TYPE,vo.POP),this.parameters.set(ti.REQ_CNF,encodeURIComponent(o)))},a.prototype.addSshJwk=function(o){Ln.isEmpty(o)||(this.parameters.set(ti.TOKEN_TYPE,vo.SSH),this.parameters.set(ti.REQ_CNF,encodeURIComponent(o)))},a.prototype.addServerTelemetry=function(o){this.parameters.set(ti.X_CLIENT_CURR_TELEM,o.generateCurrentRequestHeaderValue()),this.parameters.set(ti.X_CLIENT_LAST_TELEM,o.generateLastRequestHeaderValue())},a.prototype.addThrottling=function(){this.parameters.set(ti.X_MS_LIB_CAPABILITY,JA.X_MS_LIB_CAPABILITY_VALUE)},a.prototype.addLogoutHint=function(o){this.parameters.set(ti.LOGOUT_HINT,encodeURIComponent(o))},a.prototype.createQueryString=function(){var o=new Array;return this.parameters.forEach(function(i,l){o.push(l+"="+i)}),o.join("&")},a}(),Zz=function(){function a(o,i){this.config=function Bee(z){var o=z.authOptions,i=z.systemOptions,W=z.loggerOptions,l=z.cacheOptions,u=z.storageInterface,h=z.networkInterface,g=z.cryptoInterface,w=z.clientCredentials,T=z.libraryInfo,D=z.telemetry,P=z.serverTelemetryManager,N=z.persistencePlugin;return z=z.serializableCache,W=Oo(Oo({},eD),W),{authOptions:$x(o),systemOptions:Oo(Oo({},a7),i),loggerOptions:W,cacheOptions:Oo(Oo({},dae),l),storageInterface:u||new Yz(o.clientId,jx,new fN(W)),networkInterface:h||Lee,cryptoInterface:g||jx,clientCredentials:w||l7,libraryInfo:Oo(Oo({},Fee),T),telemetry:Oo(Oo({},Vee),D),serverTelemetryManager:P||null,persistencePlugin:N||null,serializableCache:z||null}}(o),this.logger=new fN(this.config.loggerOptions,Gz,Kz),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Uee(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=i}return a.prototype.createTokenRequestHeaders=function(o){var i={};if(i[Ch.CONTENT_TYPE]=je.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&o)switch(o.type){case oc.HOME_ACCOUNT_ID:try{var l=Hx(o.credential);i[Ch.CCS_HEADER]="Oid:"+l.uid+"@"+l.utid}catch(u){this.logger.verbose("Could not parse home account ID for CCS Header: "+u)}break;case oc.UPN:i[Ch.CCS_HEADER]="UPN: "+o.credential}return i},a.prototype.executePostToTokenEndpoint=function(o,i,l,u){return Gr(this,void 0,void 0,function(){var h;return Kr(this,function(g){switch(g.label){case 0:return[4,this.networkManager.sendPostRequest(u,o,{body:i,headers:l})];case 1:return h=g.sent(),this.config.serverTelemetryManager&&h.status<500&&429!==h.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,h]}})})},a.prototype.updateAuthority=function(o){if(!o.discoveryComplete())throw Vn.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=o},a.prototype.createTokenQueryParameters=function(o){var i=new tD;return o.tokenQueryParameters&&i.addExtraQueryParameters(o.tokenQueryParameters),i.createQueryString()},a}(),Qz=function(){function a(){}return a.prototype.generateAccountId=function(){return a.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},a.prototype.generateCredentialId=function(){return a.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},a.prototype.generateTarget=function(){return a.generateTargetForCacheKey(this.target)},a.prototype.generateCredentialKey=function(){return a.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},a.prototype.generateType=function(){switch(this.credentialType){case Mr.ID_TOKEN:return Ih.ID_TOKEN;case Mr.ACCESS_TOKEN:case Mr.ACCESS_TOKEN_WITH_AUTH_SCHEME:return Ih.ACCESS_TOKEN;case Mr.REFRESH_TOKEN:return Ih.REFRESH_TOKEN;default:throw Vn.createUnexpectedCredentialTypeError()}},a.generateCredentialCacheKey=function(o,i,l,u,h,g,w,T,D){return[this.generateAccountIdForCacheKey(o,i),this.generateCredentialIdForCacheKey(l,u,h,w),this.generateTargetForCacheKey(g),this.generateClaimsHashForCacheKey(D),this.generateSchemeForCacheKey(T)].join(Tl.CACHE_KEY_SEPARATOR).toLowerCase()},a.generateAccountIdForCacheKey=function(o,i){return[o,i].join(Tl.CACHE_KEY_SEPARATOR).toLowerCase()},a.generateCredentialIdForCacheKey=function(o,i,l,u){return[o,o===Mr.REFRESH_TOKEN&&u||i,l||je.EMPTY_STRING].join(Tl.CACHE_KEY_SEPARATOR).toLowerCase()},a.generateTargetForCacheKey=function(o){return(o||je.EMPTY_STRING).toLowerCase()},a.generateClaimsHashForCacheKey=function(o){return(o||je.EMPTY_STRING).toLowerCase()},a.generateSchemeForCacheKey=function(o){return o&&o.toLowerCase()!==vo.BEARER.toLowerCase()?o.toLowerCase():je.EMPTY_STRING},a}(),qx=function(a){function o(){return null!==a&&a.apply(this,arguments)||this}return ou(o,a),o.createIdTokenEntity=function(i,l,u,h,g){var w=new o;return w.credentialType=Mr.ID_TOKEN,w.homeAccountId=i,w.environment=l,w.clientId=h,w.secret=u,w.realm=g,w},o.isIdTokenEntity=function(i){return!!i&&i.hasOwnProperty("homeAccountId")&&i.hasOwnProperty("environment")&&i.hasOwnProperty("credentialType")&&i.hasOwnProperty("realm")&&i.hasOwnProperty("clientId")&&i.hasOwnProperty("secret")&&i.credentialType===Mr.ID_TOKEN},o}(Qz),gd=function(){function a(){}return a.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},a.isTokenExpired=function(o,i){return(Number(o)||0)<a.nowSeconds()+i},a.wasClockTurnedBack=function(o){return Number(o)>a.nowSeconds()},a.delay=function(o,i){return new Promise(function(l){return setTimeout(function(){return l(i)},o)})},a}(),g_=function(a){function o(){return null!==a&&a.apply(this,arguments)||this}return ou(o,a),o.createAccessTokenEntity=function(Mt,l,u,h,g,w,T,D,P,N,z,W,ue,ge,we){var Re,et=new o;if(et.homeAccountId=Mt,et.credentialType=Mr.ACCESS_TOKEN,et.secret=u,Mt=gd.nowSeconds(),et.cachedAt=Mt.toString(),et.expiresOn=T.toString(),et.extendedExpiresOn=D.toString(),N&&(et.refreshOn=N.toString()),et.environment=l,et.clientId=h,et.realm=g,et.target=w,et.userAssertionHash=W,et.tokenType=Ln.isEmpty(z)?vo.BEARER:z,ge&&(et.requestedClaims=ge,et.requestedClaimsHash=we),(null==(Mt=et.tokenType)?void 0:Mt.toLowerCase())!==vo.BEARER.toLowerCase())switch(et.credentialType=Mr.ACCESS_TOKEN_WITH_AUTH_SCHEME,et.tokenType){case vo.POP:var St=Bf.extractTokenClaims(u,P);if(null==(Re=St?.cnf)||!Re.kid)throw Vn.createTokenClaimsRequiredError();et.keyId=St.cnf.kid;break;case vo.SSH:et.keyId=ue}return et},o.isAccessTokenEntity=function(i){return!!i&&i.hasOwnProperty("homeAccountId")&&i.hasOwnProperty("environment")&&i.hasOwnProperty("credentialType")&&i.hasOwnProperty("realm")&&i.hasOwnProperty("clientId")&&i.hasOwnProperty("secret")&&i.hasOwnProperty("target")&&(i.credentialType===Mr.ACCESS_TOKEN||i.credentialType===Mr.ACCESS_TOKEN_WITH_AUTH_SCHEME)},o}(Qz),_g=function(a){function o(){return null!==a&&a.apply(this,arguments)||this}return ou(o,a),o.createRefreshTokenEntity=function(i,l,u,h,g,w){var T=new o;return T.clientId=h,T.credentialType=Mr.REFRESH_TOKEN,T.environment=l,T.homeAccountId=i,T.secret=u,T.userAssertionHash=w,g&&(T.familyId=g),T},o.isRefreshTokenEntity=function(i){return!!i&&i.hasOwnProperty("homeAccountId")&&i.hasOwnProperty("environment")&&i.hasOwnProperty("credentialType")&&i.hasOwnProperty("clientId")&&i.hasOwnProperty("secret")&&i.credentialType===Mr.REFRESH_TOKEN},o}(Qz),cw=["interaction_required","consent_required","login_required"],zee=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Gx_noTokensFoundError_code="no_tokens_found",Gx_noTokensFoundError_desc="No refresh token found in the cache. Please sign-in.",Gx_native_account_unavailable_code="native_account_unavailable",Gx_native_account_unavailable_desc="The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",yd=function(a){function o(i,l,u,h,g,w,T){return i=a.call(this,i,l,u)||this,Object.setPrototypeOf(i,o.prototype),i.timestamp=h||je.EMPTY_STRING,i.traceId=g||je.EMPTY_STRING,i.correlationId=w||je.EMPTY_STRING,i.claims=T||je.EMPTY_STRING,i.name="InteractionRequiredAuthError",i}return ou(o,a),o.isInteractionRequiredError=function(h,l,g){h=!!h&&-1<cw.indexOf(h),g=!!g&&-1<zee.indexOf(g);var w=!!l&&cw.some(function(T){return-1<l.indexOf(T)});return h||w||g},o.createNoTokensFoundError=function(){return new o(Gx_noTokensFoundError_code,Gx_noTokensFoundError_desc)},o.createNativeAccountUnavailableError=function(){return new o(Gx_native_account_unavailable_code,Gx_native_account_unavailable_desc)},o}(dr),_N=function(a,o,i,l,u){this.account=a||null,this.idToken=o||null,this.accessToken=i||null,this.refreshToken=l||null,this.appMetadata=u||null},vg=function(){function a(){}return a.setRequestState=function(o,i,l){return o=a.generateLibraryState(o,l),Ln.isEmpty(i)?o:""+o+je.RESOURCE_DELIM+i},a.generateLibraryState=function(o,i){var l;if(o)return l={id:o.createNewGuid()},i&&(l.meta=i),i=JSON.stringify(l),o.base64Encode(i);throw Vn.createNoCryptoObjectError("generateLibraryState")},a.parseRequestState=function(o,i){if(!o)throw Vn.createNoCryptoObjectError("parseRequestState");if(Ln.isEmpty(i))throw Vn.createInvalidStateError(i,"Null, undefined or empty state");try{var l=i.split(je.RESOURCE_DELIM),u=l[0],h=1<l.length?l.slice(1).join(je.RESOURCE_DELIM):je.EMPTY_STRING,g=o.base64Decode(u),w=JSON.parse(g);return{userRequestState:Ln.isEmpty(h)?je.EMPTY_STRING:h,libraryState:w}}catch(T){throw Vn.createInvalidStateError(i,T)}},a}(),Yi=function(){function a(o){if(this._urlString=o,Ln.isEmpty(this._urlString))throw Os.createUrlEmptyError();Ln.isEmpty(this.getHash())&&(this._urlString=a.canonicalizeUri(o))}return Object.defineProperty(a.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),a.canonicalizeUri=function(o){var i;return o&&(i=o.toLowerCase(),Ln.endsWith(i,"?")?i=i.slice(0,-1):Ln.endsWith(i,"?/")&&(i=i.slice(0,-2)),Ln.endsWith(i,"/")||(i+="/"),i)},a.prototype.validateAsUri=function(){var o;try{o=this.getUrlComponents()}catch(i){throw Os.createUrlParseError(i)}if(!o.HostNameAndPort||!o.PathSegments)throw Os.createUrlParseError("Given url string: "+this.urlString);if(!o.Protocol||"https:"!==o.Protocol.toLowerCase())throw Os.createInsecureAuthorityUriError(this.urlString)},a.appendQueryString=function(o,i){return Ln.isEmpty(i)?o:o.indexOf("?")<0?o+"?"+i:o+"&"+i},a.removeHashFromUrl=function(o){return a.canonicalizeUri(o.split("#")[0])},a.prototype.replaceTenantPath=function(o){var i=this.getUrlComponents(),l=i.PathSegments;return!o||0===l.length||l[0]!==sw.COMMON&&l[0]!==sw.ORGANIZATIONS||(l[0]=o),a.constructAuthorityUriFromObject(i)},a.prototype.getHash=function(){return a.parseHash(this.urlString)},a.prototype.getUrlComponents=function(){var o,i=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?");if(i=this.urlString.match(i))return o=(o=(i={Protocol:i[1],HostNameAndPort:i[4],AbsolutePath:i[5],QueryString:i[7]}).AbsolutePath.split("/")).filter(function(l){return l&&0<l.length}),i.PathSegments=o,!Ln.isEmpty(i.QueryString)&&i.QueryString.endsWith("/")&&(i.QueryString=i.QueryString.substring(0,i.QueryString.length-1)),i;throw Os.createUrlParseError("Given url string: "+this.urlString)},a.getDomainFromUrl=function(o){var i=RegExp("^([^:/?#]+://)?([^/?#]*)");if(i=o.match(i))return i[2];throw Os.createUrlParseError("Given url string: "+o)},a.getAbsoluteUrl=function(o,i){return o[0]===je.FORWARD_SLASH?(i=new a(i).getUrlComponents()).Protocol+"//"+i.HostNameAndPort+o:o},a.parseHash=function(o){var i=o.indexOf("#"),l=o.indexOf("#/");return-1<l?o.substring(l+2):-1<i?o.substring(i+1):je.EMPTY_STRING},a.parseQueryString=function(o){var i=o.indexOf("?"),l=o.indexOf("/?");return-1<l?o.substring(l+2):-1<i?o.substring(i+1):je.EMPTY_STRING},a.constructAuthorityUriFromObject=function(o){return new a(o.Protocol+"//"+o.HostNameAndPort+"/"+o.PathSegments.join("/"))},a.getDeserializedHash=function(l){if(Ln.isEmpty(l))return{};var i=a.parseHash(l);if(l=Ln.queryStringToObject(Ln.isEmpty(i)?l:i))return l;throw Vn.createHashNotDeserializedError(JSON.stringify(l))},a.getDeserializedQueryString=function(l){if(Ln.isEmpty(l))return{};var i=a.parseQueryString(l);if(l=Ln.queryStringToObject(Ln.isEmpty(i)?l:i))return l;throw Vn.createHashNotDeserializedError(JSON.stringify(l))},a.hashContainsKnownProperties=function(o){return!(Ln.isEmpty(o)||o.indexOf("=")<0||!((o=a.getDeserializedHash(o)).code||o.error_description||o.error||o.state))},a}(),jee=(function(a){a.AcquireTokenByCode="acquireTokenByCode",a.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",a.AcquireTokenSilent="acquireTokenSilent",a.AcquireTokenSilentAsync="acquireTokenSilentAsync",a.AcquireTokenPopup="acquireTokenPopup",a.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",a.CryptoOptsSignJwt="cryptoOptsSignJwt",a.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",a.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",a.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",a.SsoSilent="ssoSilent",a.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",a.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",a.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",a.BaseClientCreateTokenRequestHeaders="baseClientCreateTokenRequestHeaders",a.BrokerHandhshake="brokerHandshake",a.AcquireTokenByRefreshTokenInBroker="acquireTokenByRefreshTokenInBroker",a.AcquireTokenByBroker="acquireTokenByBroker",a.RefreshTokenClientExecuteTokenRequest="refreshTokenClientExecuteTokenRequest",a.RefreshTokenClientAcquireToken="refreshTokenClientAcquireToken",a.RefreshTokenClientAcquireTokenWithCachedRefreshToken="refreshTokenClientAcquireTokenWithCachedRefreshToken",a.RefreshTokenClientAcquireTokenByRefreshToken="refreshTokenClientAcquireTokenByRefreshToken",a.RefreshTokenClientCreateTokenRequestBody="refreshTokenClientCreateTokenRequestBody",a.AcquireTokenFromCache="acquireTokenFromCache",a.AcquireTokenBySilentIframe="acquireTokenBySilentIframe",a.InitializeBaseRequest="initializeBaseRequest",a.InitializeSilentRequest="initializeSilentRequest",a.InitializeClientApplication="initializeClientApplication",a.SilentIframeClientTokenHelper="silentIframeClientTokenHelper",a.SilentHandlerInitiateAuthRequest="silentHandlerInitiateAuthRequest",a.SilentHandlerMonitorIframeForHash="silentHandlerMonitorIframeForHash",a.SilentHandlerLoadFrame="silentHandlerLoadFrame",a.StandardInteractionClientCreateAuthCodeClient="standardInteractionClientCreateAuthCodeClient",a.StandardInteractionClientGetClientConfiguration="standardInteractionClientGetClientConfiguration",a.StandardInteractionClientInitializeAuthorizationRequest="standardInteractionClientInitializeAuthorizationRequest",a.StandardInteractionClientInitializeAuthorizationCodeRequest="standardInteractionClientInitializeAuthorizationCodeRequest",a.GetAuthCodeUrl="getAuthCodeUrl",a.HandleCodeResponseFromServer="handleCodeResponseFromServer",a.HandleCodeResponseFromHash="handleCodeResponseFromHash",a.UpdateTokenEndpointAuthority="updateTokenEndpointAuthority",a.AuthClientAcquireToken="authClientAcquireToken",a.AuthClientExecuteTokenRequest="authClientExecuteTokenRequest",a.AuthClientCreateTokenRequestBody="authClientCreateTokenRequestBody",a.AuthClientCreateQueryString="authClientCreateQueryString",a.PopTokenGenerateCnf="popTokenGenerateCnf",a.PopTokenGenerateKid="popTokenGenerateKid",a.HandleServerTokenResponse="handleServerTokenResponse",a.AuthorityFactoryCreateDiscoveredInstance="authorityFactoryCreateDiscoveredInstance",a.AuthorityResolveEndpointsAsync="authorityResolveEndpointsAsync",a.AuthorityGetCloudDiscoveryMetadataFromNetwork="authorityGetCloudDiscoveryMetadataFromNetwork",a.AuthorityUpdateCloudDiscoveryMetadata="authorityUpdateCloudDiscoveryMetadata",a.AuthorityGetEndpointMetadataFromNetwork="authorityGetEndpointMetadataFromNetwork",a.AuthorityUpdateEndpointMetadata="authorityUpdateEndpointMetadata",a.AuthorityUpdateMetadataWithRegionalInformation="authorityUpdateMetadataWithRegionalInformation",a.RegionDiscoveryDetectRegion="regionDiscoveryDetectRegion",a.RegionDiscoveryGetRegionFromIMDS="regionDiscoveryGetRegionFromIMDS",a.RegionDiscoveryGetCurrentVersion="regionDiscoveryGetCurrentVersion",a.AcquireTokenByCodeAsync="acquireTokenByCodeAsync",a.GetEndpointMetadataFromNetwork="getEndpointMetadataFromNetwork",a.GetCloudDiscoveryMetadataFromNetworkMeasurement="getCloudDiscoveryMetadataFromNetworkMeasurement",a.HandleRedirectPromiseMeasurement="handleRedirectPromiseMeasurement",a.UpdateCloudDiscoveryMetadataMeasurement="updateCloudDiscoveryMetadataMeasurement",a.UsernamePasswordClientAcquireToken="usernamePasswordClientAcquireToken",a.NativeMessageHandlerHandshake="nativeMessageHandlerHandshake",a.ClearTokensAndKeysWithClaims="clearTokensAndKeysWithClaims"}(Ct=Ct||{}),function(a){a[a.NotStarted=0]="NotStarted",a[a.InProgress=1]="InProgress",a[a.Completed=2]="Completed"}(gN=gN||{}),new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status"])),Kx=(function(a){a.SW="sw",a.UHW="uhw"}(aw=aw||{}),function(){function a(o,i){this.cryptoUtils=o,this.performanceClient=i}return a.prototype.generateCnf=function(o){var i;return Gr(this,void 0,void 0,function(){var l,u;return Kr(this,function(h){switch(h.label){case 0:return null!=(i=this.performanceClient)&&i.addQueueMeasurement(Ct.PopTokenGenerateCnf,o.correlationId),null!=(i=this.performanceClient)&&i.setPreQueueTime(Ct.PopTokenGenerateKid,o.correlationId),[4,this.generateKid(o)];case 1:return u=h.sent(),l=this.cryptoUtils.base64Encode(JSON.stringify(u)),u={kid:u.kid,reqCnfString:l},[4,this.cryptoUtils.hashString(l)];case 2:return[2,(u.reqCnfHash=h.sent(),u)]}})})},a.prototype.generateKid=function(o){var i;return Gr(this,void 0,void 0,function(){return Kr(this,function(l){switch(l.label){case 0:return null!=(i=this.performanceClient)&&i.addQueueMeasurement(Ct.PopTokenGenerateKid,o.correlationId),[4,this.cryptoUtils.getPublicKeyThumbprint(o)];case 1:return[2,{kid:l.sent(),xms_ksl:aw.SW}]}})})},a.prototype.signPopToken=function(o,i,l){return Gr(this,void 0,void 0,function(){return Kr(this,function(u){return[2,this.signPayload(o,i,l)]})})},a.prototype.signPayload=function(o,i,l,u){return Gr(this,void 0,void 0,function(){var h,g,w,T;return Kr(this,function(D){switch(D.label){case 0:return h=l.resourceRequestMethod,g=l.shrClaims,w=l.shrNonce,T=(T=l.resourceRequestUri)?new Yi(T):void 0,T=T?.getUrlComponents(),[4,this.cryptoUtils.signJwt(Oo({at:o,ts:gd.nowSeconds(),m:h?.toUpperCase(),u:T?.HostNameAndPort,nonce:w||this.cryptoUtils.createNewGuid(),p:T?.AbsolutePath,q:null!=T&&T.QueryString?[[],T.QueryString]:void 0,client_claims:g||void 0},u),i,l.correlationId)];case 1:return[2,D.sent()]}})})},a}()),Xz=function(){function a(){}return a.prototype.generateAppMetadataKey=function(){return a.generateAppMetadataCacheKey(this.environment,this.clientId)},a.generateAppMetadataCacheKey=function(o,i){return[QA,o,i].join(Tl.CACHE_KEY_SEPARATOR).toLowerCase()},a.createAppMetadataEntity=function(o,i,l){var u=new a;return u.clientId=o,u.environment=i,l&&(u.familyId=l),u},a.isAppMetadataEntity=function(o,i){return!!i&&0===o.indexOf(QA)&&i.hasOwnProperty("clientId")&&i.hasOwnProperty("environment")},a}(),c7=function(){function a(o,i){this.cache=o,this.hasChanged=i}return Object.defineProperty(a.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),a}(),vN=function(){function a(o,i,l,u,h,g,w){this.clientId=o,this.cacheStorage=i,this.cryptoObj=l,this.logger=u,this.serializableCache=h,this.persistencePlugin=g,this.performanceClient=w}return a.prototype.validateServerAuthorizationCodeResponse=function(o,i,l){if(!o.state||!i)throw Vn.createStateNotFoundError(o.state?"Cached State":"Server State");if(decodeURIComponent(o.state)!==decodeURIComponent(i))throw Vn.createStateMismatchError();if(o.error||o.error_description||o.suberror)throw yd.isInteractionRequiredError(o.error,o.error_description,o.suberror)?new yd(o.error||je.EMPTY_STRING,o.error_description,o.suberror,o.timestamp||je.EMPTY_STRING,o.trace_id||je.EMPTY_STRING,o.correlation_id||je.EMPTY_STRING,o.claims||je.EMPTY_STRING):new bp(o.error||je.EMPTY_STRING,o.error_description,o.suberror);o.client_info&&Wz(o.client_info,l)},a.prototype.validateTokenResponse=function(o){if(o.error||o.error_description||o.suberror){if(yd.isInteractionRequiredError(o.error,o.error_description,o.suberror))throw new yd(o.error,o.error_description,o.suberror,o.timestamp||je.EMPTY_STRING,o.trace_id||je.EMPTY_STRING,o.correlation_id||je.EMPTY_STRING,o.claims||je.EMPTY_STRING);throw new bp(o.error,o.error_codes+" - ["+o.timestamp+"]: "+o.error_description+" - Correlation ID: "+o.correlation_id+" - Trace ID: "+o.trace_id,o.suberror)}},a.prototype.handleServerTokenResponse=function(o,i,l,u,h,g,w,T,D){var P;return Gr(this,void 0,void 0,function(){var N,z,W,ue,ge;return Kr(this,function(we){switch(we.label){case 0:if(null!=(P=this.performanceClient)&&P.addQueueMeasurement(Ct.HandleServerTokenResponse,o.correlation_id),o.id_token){if(N=new Bf(o.id_token||je.EMPTY_STRING,this.cryptoObj),h&&!Ln.isEmpty(h.nonce)&&N.claims.nonce!==h.nonce)throw Vn.createNonceMismatchError();if(u.maxAge||0===u.maxAge){if(!(W=N.claims.auth_time))throw Vn.createAuthTimeNotFoundError();Bf.checkMaxAge(W,u.maxAge)}}this.homeAccountIdentifier=Ac.generateHomeAccountId(o.client_info||je.EMPTY_STRING,i.authorityType,this.logger,this.cryptoObj,N),h&&h.state&&(z=vg.parseRequestState(this.cryptoObj,h.state)),o.key_id=o.key_id||u.sshKid||void 0,W=this.generateCacheRecord(o,i,l,u,N,g,h),we.label=1;case 1:return we.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),ue=new c7(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(ue)]):[3,3];case 2:we.sent(),we.label=3;case 3:return!w||T||!W.account||(ge=W.account.generateAccountKey(),this.cacheStorage.getAccount(ge))?[4,this.cacheStorage.saveCacheRecord(W)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,a.generateAuthenticationResult(this.cryptoObj,i,W,!1,u,N,z,void 0,D)]);case 4:return we.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&ue?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(ue)]):[3,7];case 6:we.sent(),we.label=7;case 7:return[7];case 8:return[2,a.generateAuthenticationResult(this.cryptoObj,i,W,!1,u,N,z,o,D)]}})})},a.prototype.generateCacheRecord=function(o,i,l,u,we,g,ue){var T,D,P=i.getPreferredCache();if(Ln.isEmpty(P))throw Vn.createInvalidCacheEnvironmentError();!Ln.isEmpty(o.id_token)&&we&&(T=qx.createIdTokenEntity(this.homeAccountIdentifier,P,o.id_token||je.EMPTY_STRING,this.clientId,we.claims.tid||je.EMPTY_STRING),D=this.generateAccountEntity(o,we,i,ue)),ue=null;var N,z,W,ge=(Ln.isEmpty(o.access_token)||(N=o.scope?au.fromString(o.scope):new au(u.scopes||[]),W=(z=l+(("string"==typeof o.expires_in?parseInt(o.expires_in,10):o.expires_in)||0))+(("string"==typeof o.ext_expires_in?parseInt(o.ext_expires_in,10):o.ext_expires_in)||0),l=(ge=("string"==typeof o.refresh_in?parseInt(o.refresh_in,10):o.refresh_in)||void 0)&&0<ge?l+ge:void 0,ue=g_.createAccessTokenEntity(this.homeAccountIdentifier,P,o.access_token||je.EMPTY_STRING,this.clientId,we?we.claims.tid||je.EMPTY_STRING:i.tenant,N.printScopes(),z,W,this.cryptoObj,l,o.token_type,g,o.key_id,u.claims,u.requestedClaimsHash)),null);return Ln.isEmpty(o.refresh_token)||(ge=_g.createRefreshTokenEntity(this.homeAccountIdentifier,P,o.refresh_token||je.EMPTY_STRING,this.clientId,o.foci,g)),we=null,Ln.isEmpty(o.foci)||(we=Xz.createAppMetadataEntity(this.clientId,P,o.foci)),new _N(D,T,ue,ge,we)},a.prototype.generateAccountEntity=function(o,i,l,w){var g=w?w.cloud_graph_host_name:je.EMPTY_STRING;if(w=w?w.msgraph_host:je.EMPTY_STRING,l.authorityType===su.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Ac.createGenericAccount(this.homeAccountIdentifier,i,l,g,w);if(Ln.isEmpty(o.client_info)&&"AAD"===l.protocolMode)throw Vn.createClientInfoEmptyError();return o.client_info?Ac.createAccount(o.client_info,this.homeAccountIdentifier,i,l,g,w):Ac.createGenericAccount(this.homeAccountIdentifier,i,l,g,w)},a.generateAuthenticationResult=function(o,i,l,u,h,g,w,T,D){var P;return Gr(this,void 0,void 0,function(){var N,z,W,ue,ge,we,Re,et;return Kr(this,function(Mt){switch(Mt.label){case 0:if(N=je.EMPTY_STRING,z=[],W=null,ge=je.EMPTY_STRING,!l.accessToken)return[3,4];if(l.accessToken.tokenType!==vo.POP)return[3,2];if(Re=new Kx(o),et=(we=l.accessToken).secret,we=we.keyId)return[4,Re.signPopToken(et,we,h)];throw Vn.createKeyIdMissingError();case 1:return N=Mt.sent(),[3,3];case 2:N=l.accessToken.secret,Mt.label=3;case 3:z=au.fromString(l.accessToken.target).asArray(),W=new Date(1e3*Number(l.accessToken.expiresOn)),ue=new Date(1e3*Number(l.accessToken.extendedExpiresOn)),Mt.label=4;case 4:return l.appMetadata&&(ge="1"===l.appMetadata.familyId?"1":je.EMPTY_STRING),Re=g?.claims.oid||g?.claims.sub||je.EMPTY_STRING,et=g?.claims.tid||je.EMPTY_STRING,null!=T&&T.spa_accountid&&l.account&&(l.account.nativeAccountId=T?.spa_accountid),[2,{authority:i.canonicalAuthority,uniqueId:Re,tenantId:et,scopes:z,account:l.account?l.account.getAccountInfo():null,idToken:g?g.rawToken:je.EMPTY_STRING,idTokenClaims:g?g.claims:{},accessToken:N,fromCache:u,expiresOn:W,correlationId:h.correlationId,requestId:D||je.EMPTY_STRING,extExpiresOn:ue,familyId:ge,tokenType:(null==(P=l.accessToken)?void 0:P.tokenType)||je.EMPTY_STRING,state:w?w.userRequestState:je.EMPTY_STRING,cloudGraphHostName:(null==(P=l.account)?void 0:P.cloudGraphHostName)||je.EMPTY_STRING,msGraphHost:(null==(P=l.account)?void 0:P.msGraphHost)||je.EMPTY_STRING,code:T?.spa_code,fromNativeBroker:!1}]}})})},a}(),nD=function(a){function o(i,l){return(i=a.call(this,i,l)||this).includeRedirectUri=!0,i}return ou(o,a),o.prototype.getAuthCodeUrl=function(i){var l;return Gr(this,void 0,void 0,function(){var u;return Kr(this,function(h){switch(h.label){case 0:return null!=(l=this.performanceClient)&&l.addQueueMeasurement(Ct.GetAuthCodeUrl,i.correlationId),null!=(l=this.performanceClient)&&l.setPreQueueTime(Ct.AuthClientCreateQueryString,i.correlationId),[4,this.createAuthCodeUrlQueryString(i)];case 1:return u=h.sent(),[2,Yi.appendQueryString(this.authority.authorizationEndpoint,u)]}})})},o.prototype.acquireToken=function(i,l){var u,h;return Gr(this,void 0,void 0,function(){var g,w,T,D,P,N=this;return Kr(this,function(z){switch(z.label){case 0:if(i&&i.code)return null!=(u=this.performanceClient)&&u.addQueueMeasurement(Ct.AuthClientAcquireToken,i.correlationId),g=null==(u=this.performanceClient)?void 0:u.startMeasurement("AuthCodeClientAcquireToken",i.correlationId),this.logger.info("in acquireToken call in auth-code client"),w=gd.nowSeconds(),null!=(u=this.performanceClient)&&u.setPreQueueTime(Ct.AuthClientExecuteTokenRequest,i.correlationId),[4,this.executeTokenRequest(this.authority,i)];throw Vn.createTokenRequestCannotBeMadeError();case 1:return T=z.sent(),D=null==(u=T.headers)?void 0:u[Ch.X_MS_REQUEST_ID],(P=null==(h=T.headers)?void 0:h[Ch.X_MS_HTTP_VERSION])&&null!=g&&g.addStaticFields({httpVerAuthority:P}),(P=new vN(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient)).validateTokenResponse(T.body),null!=(h=this.performanceClient)&&h.setPreQueueTime(Ct.HandleServerTokenResponse,i.correlationId),[2,P.handleServerTokenResponse(T.body,this.authority,w,i,l,void 0,void 0,void 0,D).then(function(W){return g?.endMeasurement({success:!0}),W}).catch(function(W){throw N.logger.verbose("Error in fetching token in ACC",i.correlationId),g?.endMeasurement({errorCode:W.errorCode,subErrorCode:W.subError,success:!1}),W})]}})})},o.prototype.handleFragmentResponse=function(h,l){var u=new vN(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null);if(h=new Yi(h),h=Yi.getDeserializedHash(h.getHash()),u.validateServerAuthorizationCodeResponse(h,l,this.cryptoUtils),h.code)return Oo(Oo({},h),{code:h.code});throw Vn.createNoAuthCodeInServerResponseError()},o.prototype.getLogoutUri=function(i){if(i)return i=this.createLogoutUrlQueryString(i),Yi.appendQueryString(this.authority.endSessionEndpoint,i);throw Os.createEmptyLogoutRequestError()},o.prototype.executeTokenRequest=function(i,l){var u;return Gr(this,void 0,void 0,function(){var h,g,w,T;return Kr(this,function(P){switch(P.label){case 0:return null!=(u=this.performanceClient)&&u.addQueueMeasurement(Ct.AuthClientExecuteTokenRequest,l.correlationId),null!=(u=this.performanceClient)&&u.setPreQueueTime(Ct.AuthClientCreateTokenRequestBody,l.correlationId),h=this.createTokenQueryParameters(l),h=Yi.appendQueryString(i.tokenEndpoint,h),[4,this.createTokenRequestBody(l)];case 1:if(g=P.sent(),T=void 0,l.clientInfo)try{w=Wz(l.clientInfo,this.cryptoUtils),T={credential:""+w.uid+Tl.CLIENT_INFO_SEPARATOR+w.utid,type:oc.HOME_ACCOUNT_ID}}catch(N){this.logger.verbose("Could not parse client info for CCS Header: "+N)}return T=this.createTokenRequestHeaders(T||l.ccsCredential),[2,this.executePostToTokenEndpoint(h,g,T,{clientId:this.config.authOptions.clientId,authority:i.canonicalAuthority,scopes:l.scopes,claims:l.claims,authenticationScheme:l.authenticationScheme,resourceRequestMethod:l.resourceRequestMethod,resourceRequestUri:l.resourceRequestUri,shrClaims:l.shrClaims,sshKid:l.sshKid})]}})})},o.prototype.createTokenRequestBody=function(i){var l;return Gr(this,void 0,void 0,function(){var u,h,g,w,T,D;return Kr(this,function(P){switch(P.label){case 0:return null!=(l=this.performanceClient)&&l.addQueueMeasurement(Ct.AuthClientCreateTokenRequestBody,i.correlationId),(u=new tD).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?u.addRedirectUri(i.redirectUri):lw.validateRedirectUri(i.redirectUri),u.addScopes(i.scopes),u.addAuthorizationCode(i.code),u.addLibraryInfo(this.config.libraryInfo),u.addApplicationTelemetry(this.config.telemetry.application),u.addThrottling(),this.serverTelemetryManager&&u.addServerTelemetry(this.serverTelemetryManager),i.codeVerifier&&u.addCodeVerifier(i.codeVerifier),this.config.clientCredentials.clientSecret&&u.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(u.addClientAssertion((h=this.config.clientCredentials.clientAssertion).assertion),u.addClientAssertionType(h.assertionType)),u.addGrantType(Lx.AUTHORIZATION_CODE_GRANT),u.addClientInfo(),i.authenticationScheme!==vo.POP?[3,2]:(h=new Kx(this.cryptoUtils,this.performanceClient),null!=(l=this.performanceClient)&&l.setPreQueueTime(Ct.PopTokenGenerateCnf,i.correlationId),[4,h.generateCnf(i)]);case 1:return g=P.sent(),u.addPopToken(g.reqCnfString),[3,3];case 2:if(i.authenticationScheme===vo.SSH){if(!i.sshJwk)throw Os.createMissingSshJwkError();u.addSshJwk(i.sshJwk)}P.label=3;case 3:if(g=i.correlationId||this.config.cryptoInterface.createNewGuid(),u.addCorrelationId(g),(!Ln.isEmptyObj(i.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&u.addClaims(i.claims,this.config.authOptions.clientCapabilities),w=void 0,i.clientInfo)try{T=Wz(i.clientInfo,this.cryptoUtils),w={credential:""+T.uid+Tl.CLIENT_INFO_SEPARATOR+T.utid,type:oc.HOME_ACCOUNT_ID}}catch(N){this.logger.verbose("Could not parse client info for CCS Header: "+N)}else w=i.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&w)switch(w.type){case oc.HOME_ACCOUNT_ID:try{T=Hx(w.credential),u.addCcsOid(T)}catch(N){this.logger.verbose("Could not parse home account ID for CCS Header: "+N)}break;case oc.UPN:u.addCcsUpn(w.credential)}return i.tokenBodyParameters&&u.addExtraQueryParameters(i.tokenBodyParameters),!i.enableSpaAuthorizationCode||i.tokenBodyParameters&&i.tokenBodyParameters[ti.RETURN_SPA_CODE]||u.addExtraQueryParameters(((D={})[ti.RETURN_SPA_CODE]="1",D)),[2,u.createQueryString()]}})})},o.prototype.createAuthCodeUrlQueryString=function(i){var l;return Gr(this,void 0,void 0,function(){var u,h,g,w;return Kr(this,function(T){switch(T.label){case 0:if(null!=(l=this.performanceClient)&&l.addQueueMeasurement(Ct.AuthClientCreateQueryString,i.correlationId),(u=new tD).addClientId(this.config.authOptions.clientId),h=uN(i.scopes||[],i.extraScopesToConsent||[]),u.addScopes(h),u.addRedirectUri(i.redirectUri),h=i.correlationId||this.config.cryptoInterface.createNewGuid(),u.addCorrelationId(h),u.addResponseMode(i.responseMode),u.addResponseTypeCode(),u.addLibraryInfo(this.config.libraryInfo),u.addApplicationTelemetry(this.config.telemetry.application),u.addClientInfo(),i.codeChallenge&&i.codeChallengeMethod&&u.addCodeChallengeParams(i.codeChallenge,i.codeChallengeMethod),i.prompt&&u.addPrompt(i.prompt),i.domainHint&&u.addDomainHint(i.domainHint),i.prompt!==ic.SELECT_ACCOUNT)if(i.sid&&i.prompt===ic.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),u.addSid(i.sid);else if(i.account){if(h=this.extractAccountSid(i.account),w=this.extractLoginHint(i.account)){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),u.addLoginHint(w);try{g=Hx(i.account.homeAccountId),u.addCcsOid(g)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(h&&i.prompt===ic.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),u.addSid(h);try{g=Hx(i.account.homeAccountId),u.addCcsOid(g)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(i.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),u.addLoginHint(i.loginHint),u.addCcsUpn(i.loginHint);else if(i.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),u.addLoginHint(i.account.username);try{g=Hx(i.account.homeAccountId),u.addCcsOid(g)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else i.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),u.addLoginHint(i.loginHint),u.addCcsUpn(i.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return i.nonce&&u.addNonce(i.nonce),i.state&&u.addState(i.state),(!Ln.isEmpty(i.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&u.addClaims(i.claims,this.config.authOptions.clientCapabilities),i.extraQueryParameters&&u.addExtraQueryParameters(i.extraQueryParameters),i.nativeBroker?(u.addNativeBroker(),i.authenticationScheme!==vo.POP?[3,2]:[4,new Kx(this.cryptoUtils).generateCnf(i)]):[3,2];case 1:w=T.sent(),u.addPopToken(w.reqCnfString),T.label=2;case 2:return[2,u.createQueryString()]}})})},o.prototype.createLogoutUrlQueryString=function(i){var l=new tD;return i.postLogoutRedirectUri&&l.addPostLogoutRedirectUri(i.postLogoutRedirectUri),i.correlationId&&l.addCorrelationId(i.correlationId),i.idTokenHint&&l.addIdTokenHint(i.idTokenHint),i.state&&l.addState(i.state),i.logoutHint&&l.addLogoutHint(i.logoutHint),i.extraQueryParameters&&l.addExtraQueryParameters(i.extraQueryParameters),l.createQueryString()},o.prototype.extractAccountSid=function(i){return(null==(i=i.idTokenClaims)?void 0:i.sid)||null},o.prototype.extractLoginHint=function(i){return(null==(i=i.idTokenClaims)?void 0:i.login_hint)||null},o}(Zz),Jz=function(a){function o(i,l){return a.call(this,i,l)||this}return ou(o,a),o.prototype.acquireToken=function(i){var l,u,h;return Gr(this,void 0,void 0,function(){var g,w,T,D,P,N=this;return Kr(this,function(z){switch(z.label){case 0:return null!=(l=this.performanceClient)&&l.addQueueMeasurement(Ct.RefreshTokenClientAcquireToken,i.correlationId),g=null==(l=this.performanceClient)?void 0:l.startMeasurement(Ct.RefreshTokenClientAcquireToken,i.correlationId),this.logger.verbose("RefreshTokenClientAcquireToken called",i.correlationId),w=gd.nowSeconds(),null!=(l=this.performanceClient)&&l.setPreQueueTime(Ct.RefreshTokenClientExecuteTokenRequest,i.correlationId),[4,this.executeTokenRequest(i,this.authority)];case 1:return T=z.sent(),D=null==(l=T.headers)?void 0:l[Ch.X_MS_HTTP_VERSION],g?.addStaticFields({refreshTokenSize:(null==(u=T.body.refresh_token)?void 0:u.length)||0}),D&&null!=g&&g.addStaticFields({httpVerToken:D}),D=null==(u=T.headers)?void 0:u[Ch.X_MS_REQUEST_ID],(P=new vN(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(T.body),null!=(h=this.performanceClient)&&h.setPreQueueTime(Ct.HandleServerTokenResponse,i.correlationId),[2,P.handleServerTokenResponse(T.body,this.authority,w,i,void 0,void 0,!0,i.forceCache,D).then(function(W){return g?.endMeasurement({success:!0}),W}).catch(function(W){throw N.logger.verbose("Error in fetching refresh token",i.correlationId),g?.endMeasurement({errorCode:W.errorCode,subErrorCode:W.subError,success:!1}),W})]}})})},o.prototype.acquireTokenByRefreshToken=function(i){var l,u;return Gr(this,void 0,void 0,function(){var g;return Kr(this,function(w){if(!i)throw Os.createEmptyTokenRequestError();if(null!=(u=this.performanceClient)&&u.addQueueMeasurement(Ct.RefreshTokenClientAcquireTokenByRefreshToken,i.correlationId),!i.account)throw Vn.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(i.account.environment))try{return null!=(l=this.performanceClient)&&l.setPreQueueTime(Ct.RefreshTokenClientAcquireTokenWithCachedRefreshToken,i.correlationId),[2,this.acquireTokenWithCachedRefreshToken(i,!0)]}catch(T){if(g=T instanceof bp&&"invalid_grant"===T.errorCode&&"client_mismatch"===T.subError,T instanceof yd&&T.errorCode===Gx_noTokensFoundError_code||g)return null!=(u=this.performanceClient)&&u.setPreQueueTime(Ct.RefreshTokenClientAcquireTokenWithCachedRefreshToken,i.correlationId),[2,this.acquireTokenWithCachedRefreshToken(i,!1)];throw T}return null!=(u=this.performanceClient)&&u.setPreQueueTime(Ct.RefreshTokenClientAcquireTokenWithCachedRefreshToken,i.correlationId),[2,this.acquireTokenWithCachedRefreshToken(i,!1)]})})},o.prototype.acquireTokenWithCachedRefreshToken=function(i,l){var u;return Gr(this,void 0,void 0,function(){var h,g;return Kr(this,function(w){if(null!=(u=this.performanceClient)&&u.addQueueMeasurement(Ct.RefreshTokenClientAcquireTokenWithCachedRefreshToken,i.correlationId),h=null==(u=this.performanceClient)?void 0:u.startMeasurement(Ct.RefreshTokenClientAcquireTokenWithCachedRefreshToken,i.correlationId),this.logger.verbose("RefreshTokenClientAcquireTokenWithCachedRefreshToken called",i.correlationId),g=this.cacheManager.getRefreshToken(i.account,l))return h?.endMeasurement({success:!0}),g=Oo(Oo({},i),{refreshToken:g.secret,authenticationScheme:i.authenticationScheme||vo.BEARER,ccsCredential:{credential:i.account.homeAccountId,type:oc.HOME_ACCOUNT_ID}}),null!=(u=this.performanceClient)&&u.setPreQueueTime(Ct.RefreshTokenClientAcquireToken,i.correlationId),[2,this.acquireToken(g)];throw h?.discardMeasurement(),yd.createNoTokensFoundError()})})},o.prototype.executeTokenRequest=function(i,l){var u;return Gr(this,void 0,void 0,function(){var h,g,w,T;return Kr(this,function(P){switch(P.label){case 0:return null!=(u=this.performanceClient)&&u.addQueueMeasurement(Ct.RefreshTokenClientExecuteTokenRequest,i.correlationId),h=null==(u=this.performanceClient)?void 0:u.startMeasurement(Ct.RefreshTokenClientExecuteTokenRequest,i.correlationId),null!=(u=this.performanceClient)&&u.setPreQueueTime(Ct.RefreshTokenClientCreateTokenRequestBody,i.correlationId),g=this.createTokenQueryParameters(i),g=Yi.appendQueryString(l.tokenEndpoint,g),[4,this.createTokenRequestBody(i)];case 1:return w=P.sent(),T=this.createTokenRequestHeaders(i.ccsCredential),[2,this.executePostToTokenEndpoint(g,w,T,{clientId:this.config.authOptions.clientId,authority:l.canonicalAuthority,scopes:i.scopes,claims:i.claims,authenticationScheme:i.authenticationScheme,resourceRequestMethod:i.resourceRequestMethod,resourceRequestUri:i.resourceRequestUri,shrClaims:i.shrClaims,sshKid:i.sshKid}).then(function(N){return h?.endMeasurement({success:!0}),N}).catch(function(N){throw h?.endMeasurement({success:!1}),N})]}})})},o.prototype.createTokenRequestBody=function(i){var l;return Gr(this,void 0,void 0,function(){var u,h,g,w;return Kr(this,function(T){switch(T.label){case 0:return null!=(l=this.performanceClient)&&l.addQueueMeasurement(Ct.RefreshTokenClientCreateTokenRequestBody,i.correlationId),g=i.correlationId,u=null==(l=this.performanceClient)?void 0:l.startMeasurement(Ct.BaseClientCreateTokenRequestHeaders,g),(h=new tD).addClientId(this.config.authOptions.clientId),h.addScopes(i.scopes),h.addGrantType(Lx.REFRESH_TOKEN_GRANT),h.addClientInfo(),h.addLibraryInfo(this.config.libraryInfo),h.addApplicationTelemetry(this.config.telemetry.application),h.addThrottling(),this.serverTelemetryManager&&h.addServerTelemetry(this.serverTelemetryManager),h.addCorrelationId(g),h.addRefreshToken(i.refreshToken),this.config.clientCredentials.clientSecret&&h.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(h.addClientAssertion((g=this.config.clientCredentials.clientAssertion).assertion),h.addClientAssertionType(g.assertionType)),i.authenticationScheme!==vo.POP?[3,2]:(g=new Kx(this.cryptoUtils,this.performanceClient),null!=(l=this.performanceClient)&&l.setPreQueueTime(Ct.PopTokenGenerateCnf,i.correlationId),[4,g.generateCnf(i)]);case 1:return g=T.sent(),h.addPopToken(g.reqCnfString),[3,3];case 2:if(i.authenticationScheme===vo.SSH){if(!i.sshJwk)throw u?.endMeasurement({success:!1}),Os.createMissingSshJwkError();h.addSshJwk(i.sshJwk)}T.label=3;case 3:if((!Ln.isEmptyObj(i.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&h.addClaims(i.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&i.ccsCredential)switch(i.ccsCredential.type){case oc.HOME_ACCOUNT_ID:try{w=Hx(i.ccsCredential.credential),h.addCcsOid(w)}catch(D){this.logger.verbose("Could not parse home account ID for CCS Header: "+D)}break;case oc.UPN:h.addCcsUpn(i.ccsCredential.credential)}return u?.endMeasurement({success:!0}),[2,h.createQueryString()]}})})},o}(Zz),Wx=function(a){function o(i,l){return a.call(this,i,l)||this}return ou(o,a),o.prototype.acquireToken=function(i){return Gr(this,void 0,void 0,function(){var l;return Kr(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,this.acquireCachedToken(i)];case 1:return[2,u.sent()];case 2:if((l=u.sent())instanceof Vn&&l.errorCode===hn_tokenRefreshRequired_code)return[2,new Jz(this.config,this.performanceClient).acquireTokenByRefreshToken(i)];throw l;case 3:return[2]}})})},o.prototype.acquireCachedToken=function(i){var l,u,h;return Gr(this,void 0,void 0,function(){var g;return Kr(this,function(w){switch(w.label){case 0:if(!i)throw Os.createEmptyTokenRequestError();if(i.forceRefresh)throw null!=(l=this.serverTelemetryManager)&&l.setCacheOutcome(yg.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),Vn.createRefreshRequiredError();if(!this.config.cacheOptions.claimsBasedCachingEnabled&&!Ln.isEmptyObj(i.claims))throw null!=(l=this.serverTelemetryManager)&&l.setCacheOutcome(yg.CLAIMS_REQUESTED_CACHE_SKIPPED),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because claims-based caching is disabled and claims were requested."),Vn.createRefreshRequiredError();if(!i.account)throw Vn.createNoAccountInSilentRequestError();if(g=i.authority||this.authority.getPreferredCache(),!(g=this.cacheManager.readCacheRecord(i.account,i,g)).accessToken)throw null!=(u=this.serverTelemetryManager)&&u.setCacheOutcome(yg.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),Vn.createRefreshRequiredError();if(gd.wasClockTurnedBack(g.accessToken.cachedAt)||gd.isTokenExpired(g.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null!=(u=this.serverTelemetryManager)&&u.setCacheOutcome(yg.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),Vn.createRefreshRequiredError();if(g.accessToken.refreshOn&&gd.isTokenExpired(g.accessToken.refreshOn,0))throw null!=(h=this.serverTelemetryManager)&&h.setCacheOutcome(yg.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),Vn.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(g,i)];case 1:return[2,w.sent()]}})})},o.prototype.generateResultFromCacheRecord=function(i,l){return Gr(this,void 0,void 0,function(){var u,h;return Kr(this,function(g){switch(g.label){case 0:if(i.idToken&&(u=new Bf(i.idToken.secret,this.config.cryptoInterface)),l.maxAge||0===l.maxAge){if(!(h=u?.claims.auth_time))throw Vn.createAuthTimeNotFoundError();Bf.checkMaxAge(h,l.maxAge)}return[4,vN.generateAuthenticationResult(this.cryptoUtils,this.authority,i,!0,l,u)];case 1:return[2,g.sent()]}})})},o}(Zz);function u7(a){return a.hasOwnProperty("authorization_endpoint")&&a.hasOwnProperty("token_endpoint")&&a.hasOwnProperty("issuer")&&a.hasOwnProperty("jwks_uri")}var rD,wg,Ba,Uf,co,Dh,Yx,xs,Jn,f7,m7,qu,zr,uw,oD,d7={"https://login.microsoftonline.com/common/":{token_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/common/":{token_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/common/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/common/":{token_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/common/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/common/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/common/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/consumers/":{token_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/consumers/":{token_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/consumers/":{token_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/consumers/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/consumers/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/consumers/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"},"https://login.microsoftonline.com/organizations/":{token_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.com/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.com/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.com/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.com",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pas.windows.net"},"https://login.chinacloudapi.cn/organizations/":{token_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.chinacloudapi.cn/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://microsoftgraph.chinacloudapi.cn/oidc/userinfo",authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.chinacloudapi.cn/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.chinacloudapi.cn/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"partner.microsoftonline.cn",cloud_graph_host_name:"graph.chinacloudapi.cn",msgraph_host:"microsoftgraph.chinacloudapi.cn",rbac_url:"https://pas.chinacloudapi.cn"},"https://login.microsoftonline.us/organizations/":{token_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/token",token_endpoint_auth_methods_supported:["client_secret_post","private_key_jwt","client_secret_basic"],jwks_uri:"https://login.microsoftonline.us/organizations/discovery/v2.0/keys",response_modes_supported:["query","fragment","form_post"],subject_types_supported:["pairwise"],id_token_signing_alg_values_supported:["RS256"],response_types_supported:["code","id_token","code id_token","id_token token"],scopes_supported:["openid","profile","email","offline_access"],issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",request_uri_parameter_supported:!1,userinfo_endpoint:"https://graph.microsoft.com/oidc/userinfo",authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/authorize",device_authorization_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/devicecode",http_logout_supported:!0,frontchannel_logout_supported:!0,end_session_endpoint:"https://login.microsoftonline.us/organizations/oauth2/v2.0/logout",claims_supported:["sub","iss","cloud_instance_name","cloud_instance_host_name","cloud_graph_host_name","msgraph_host","aud","exp","iat","auth_time","acr","nonce","preferred_username","name","tid","ver","at_hash","c_hash","email"],kerberos_endpoint:"https://login.microsoftonline.us/organizations/kerberos",tenant_region_scope:null,cloud_instance_name:"microsoftonline.us",cloud_graph_host_name:"graph.windows.net",msgraph_host:"graph.microsoft.com",rbac_url:"https://pasff.usgovcloudapi.net"}},wN={"https://login.microsoftonline.com/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/common/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/common/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/common/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/consumers/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/consumers/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/consumers/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.com/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.chinacloudapi.cn/organizations/":{tenant_discovery_endpoint:"https://login.chinacloudapi.cn/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},"https://login.microsoftonline.us/organizations/":{tenant_discovery_endpoint:"https://login.microsoftonline.us/organizations/v2.0/.well-known/openid-configuration","api-version":"1.1",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},e5=(function(a){a.AAD="AAD",a.OIDC="OIDC"}(rD=rD||{}),function(){function a(){this.expiresAt=gd.nowSeconds()+86400}return a.prototype.updateCloudDiscoveryMetadata=function(o,i){this.aliases=o.aliases,this.preferred_cache=o.preferred_cache,this.preferred_network=o.preferred_network,this.aliasesFromNetwork=i},a.prototype.updateEndpointMetadata=function(o,i){this.authorization_endpoint=o.authorization_endpoint,this.token_endpoint=o.token_endpoint,this.end_session_endpoint=o.end_session_endpoint,this.issuer=o.issuer,this.endpointsFromNetwork=i,this.jwks_uri=o.jwks_uri},a.prototype.updateCanonicalAuthority=function(o){this.canonical_authority=o},a.prototype.resetExpiresAt=function(){this.expiresAt=gd.nowSeconds()+86400},a.prototype.isExpired=function(){return this.expiresAt<=gd.nowSeconds()},a.isAuthorityMetadataEntity=function(o,i){return!!i&&0===o.indexOf("authority-metadata")&&i.hasOwnProperty("aliases")&&i.hasOwnProperty("preferred_cache")&&i.hasOwnProperty("preferred_network")&&i.hasOwnProperty("canonical_authority")&&i.hasOwnProperty("authorization_endpoint")&&i.hasOwnProperty("token_endpoint")&&i.hasOwnProperty("issuer")&&i.hasOwnProperty("aliasesFromNetwork")&&i.hasOwnProperty("endpointsFromNetwork")&&i.hasOwnProperty("expiresAt")&&i.hasOwnProperty("jwks_uri")},a}()),g7=function(){function a(o,i,l){this.networkInterface=o,this.performanceClient=i,this.correlationId=l}return a.prototype.detectRegion=function(o,i){var l,u;return Gr(this,void 0,void 0,function(){var h,g,w,T;return Kr(this,function(D){switch(D.label){case 0:if(null!=(l=this.performanceClient)&&l.addQueueMeasurement(Ct.RegionDiscoveryDetectRegion,this.correlationId),h=o)return[3,8];g=a.IMDS_OPTIONS,D.label=1;case 1:return D.trys.push([1,6,,7]),null!=(l=this.performanceClient)&&l.setPreQueueTime(Ct.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(je.IMDS_VERSION,g)];case 2:return(w=D.sent()).status===Hu.httpSuccess&&(h=w.body,i.region_source=Ah.IMDS),w.status!==Hu.httpBadRequest?[3,5]:(null!=(u=this.performanceClient)&&u.setPreQueueTime(Ct.RegionDiscoveryGetCurrentVersion,this.correlationId),[4,this.getCurrentVersion(g)]);case 3:return(w=D.sent())?(null!=(u=this.performanceClient)&&u.setPreQueueTime(Ct.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[4,this.getRegionFromIMDS(w,g)]):(i.region_source=Ah.FAILED_AUTO_DETECTION,[2,null]);case 4:(T=D.sent()).status===Hu.httpSuccess&&(h=T.body,i.region_source=Ah.IMDS),D.label=5;case 5:return[3,7];case 6:return D.sent(),i.region_source=Ah.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:i.region_source=Ah.ENVIRONMENT_VARIABLE,D.label=9;case 9:return h||(i.region_source=Ah.FAILED_AUTO_DETECTION),[2,h||null]}})})},a.prototype.getRegionFromIMDS=function(o,i){var l;return Gr(this,void 0,void 0,function(){return Kr(this,function(u){return null!=(l=this.performanceClient)&&l.addQueueMeasurement(Ct.RegionDiscoveryGetRegionFromIMDS,this.correlationId),[2,this.networkInterface.sendGetRequestAsync(je.IMDS_ENDPOINT+"?api-version="+o+"&format=text",i,je.IMDS_TIMEOUT)]})})},a.prototype.getCurrentVersion=function(o){var i;return Gr(this,void 0,void 0,function(){var l;return Kr(this,function(u){switch(u.label){case 0:null!=(i=this.performanceClient)&&i.addQueueMeasurement(Ct.RegionDiscoveryGetCurrentVersion,this.correlationId),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(je.IMDS_ENDPOINT+"?format=json",o)];case 2:return(l=u.sent()).status===Hu.httpBadRequest&&l.body&&l.body["newest-versions"]&&0<l.body["newest-versions"].length?[2,l.body["newest-versions"][0]]:[2,null];case 3:return u.sent(),[2,null];case 4:return[2]}})})},a.IMDS_OPTIONS={headers:{Metadata:"true"}},a}(),Zx=function(){function a(o,i,l,u,h,g,w){this.canonicalAuthority=o,this._canonicalAuthority.validateAsUri(),this.networkInterface=i,this.cacheManager=l,this.authorityOptions=u,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=h,this.performanceClient=g,this.correlationId=w,this.regionDiscovery=new g7(i,this.performanceClient,this.correlationId)}return a.prototype.getAuthorityType=function(o){if(o.HostNameAndPort.endsWith(je.CIAM_AUTH_URL))return su.Ciam;if((o=o.PathSegments).length)switch(o[0].toLowerCase()){case je.ADFS:return su.Adfs;case je.DSTS:return su.Dsts}return su.Default},Object.defineProperty(a.prototype,"authorityType",{get:function(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(o){this._canonicalAuthority=new Yi(o),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw Vn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw Vn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw Vn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(this.metadata.end_session_endpoint)return this.replacePath(this.metadata.end_session_endpoint);throw Vn.createLogoutNotSupportedError()}throw Vn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw Vn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"jwksUri",{get:function(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw Vn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),a.prototype.canReplaceTenant=function(o){return 1===o.PathSegments.length&&!a.reservedTenantDomains.has(o.PathSegments[0])&&this.getAuthorityType(o)===su.Default&&this.protocolMode===rD.AAD},a.prototype.replaceTenant=function(o){return o.replace(/{tenant}|{tenantid}/g,this.tenant)},a.prototype.replacePath=function(o){var i=this,l=o,u=new Yi(this.metadata.canonical_authority).getUrlComponents(),h=u.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(function(g,w){var T=h[w];0===w&&i.canReplaceTenant(u)&&T!==(w=new Yi(i.metadata.authorization_endpoint).getUrlComponents().PathSegments[0])&&(i.logger.verbose("Replacing tenant domain name "+T+" with id "+w),T=w),g!==T&&(l=l.replace("/"+T+"/","/"+g+"/"))}),this.replaceTenant(l)},Object.defineProperty(a.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===su.Adfs||this.authorityType===su.Dsts||this.protocolMode===rD.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),a.prototype.discoveryComplete=function(){return!!this.metadata},a.prototype.resolveEndpointsAsync=function(){var o;return Gr(this,void 0,void 0,function(){var i,l,u;return Kr(this,function(h){switch(h.label){case 0:return null!=(o=this.performanceClient)&&o.addQueueMeasurement(Ct.AuthorityResolveEndpointsAsync,this.correlationId),(i=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(i=new e5).updateCanonicalAuthority(this.canonicalAuthority),null!=(o=this.performanceClient)&&o.setPreQueueTime(Ct.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),[4,this.updateCloudDiscoveryMetadata(i)];case 1:return l=h.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,i.preferred_network),null!=(o=this.performanceClient)&&o.setPreQueueTime(Ct.AuthorityUpdateEndpointMetadata,this.correlationId),[4,this.updateEndpointMetadata(i)];case 2:return u=h.sent(),l!==Sh.CACHE&&u!==Sh.CACHE&&(i.resetExpiresAt(),i.updateCanonicalAuthority(this.canonicalAuthority)),u=this.cacheManager.generateAuthorityMetadataCacheKey(i.preferred_cache),this.cacheManager.setAuthorityMetadata(u,i),this.metadata=i,[2]}})})},a.prototype.updateEndpointMetadata=function(o){var i,l,u;return Gr(this,void 0,void 0,function(){var h,g;return Kr(this,function(w){switch(w.label){case 0:return null!=(i=this.performanceClient)&&i.addQueueMeasurement(Ct.AuthorityUpdateEndpointMetadata,this.correlationId),(h=this.getEndpointMetadataFromConfig())?(o.updateEndpointMetadata(h,!1),[2,Sh.CONFIG]):this.isAuthoritySameType(o)&&o.endpointsFromNetwork&&!o.isExpired()?[2,Sh.CACHE]:(null!=(i=this.performanceClient)&&i.setPreQueueTime(Ct.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),[4,this.getEndpointMetadataFromNetwork()]);case 1:return(h=w.sent())?null!=(i=this.authorityOptions.azureRegionConfiguration)&&i.azureRegion?(null!=(l=this.performanceClient)&&l.setPreQueueTime(Ct.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(h)]):[3,3]:[3,4];case 2:h=w.sent(),w.label=3;case 3:return o.updateEndpointMetadata(h,!0),[2,Sh.NETWORK];case 4:return!(g=this.getEndpointMetadataFromHardcodedValues())||this.authorityOptions.skipAuthorityMetadataCache?[3,7]:null!=(l=this.authorityOptions.azureRegionConfiguration)&&l.azureRegion?(null!=(u=this.performanceClient)&&u.setPreQueueTime(Ct.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),[4,this.updateMetadataWithRegionalInformation(g)]):[3,6];case 5:g=w.sent(),w.label=6;case 6:return o.updateEndpointMetadata(g,!1),[2,Sh.HARDCODED_VALUES];case 7:throw Vn.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}})})},a.prototype.isAuthoritySameType=function(o){return new Yi(o.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},a.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Os.createInvalidAuthorityMetadataError()}return null},a.prototype.getEndpointMetadataFromNetwork=function(){var o;return Gr(this,void 0,void 0,function(){var i,l;return Kr(this,function(u){switch(u.label){case 0:null!=(o=this.performanceClient)&&o.addQueueMeasurement(Ct.AuthorityGetEndpointMetadataFromNetwork,this.correlationId),i={},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,i)];case 2:return[2,u7((l=u.sent()).body)?l.body:null];case 3:return u.sent(),[2,null];case 4:return[2]}})})},a.prototype.getEndpointMetadataFromHardcodedValues=function(){return this.canonicalAuthority in d7?d7[this.canonicalAuthority]:null},a.prototype.updateMetadataWithRegionalInformation=function(o){var i;return Gr(this,void 0,void 0,function(){var l;return Kr(this,function(u){switch(u.label){case 0:return null!=(i=this.performanceClient)&&i.addQueueMeasurement(Ct.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId),(l=null==(i=this.authorityOptions.azureRegionConfiguration)?void 0:i.azureRegion)?l!==je.AZURE_REGION_AUTO_DISCOVER_FLAG?(this.regionDiscoveryMetadata.region_outcome=Vx.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=l,[2,a.replaceWithRegionalInformation(o,l)]):(null!=(i=this.performanceClient)&&i.setPreQueueTime(Ct.RegionDiscoveryDetectRegion,this.correlationId),[4,this.regionDiscovery.detectRegion(null==(i=this.authorityOptions.azureRegionConfiguration)?void 0:i.environmentRegion,this.regionDiscoveryMetadata)]):[3,2];case 1:if(l=u.sent())return this.regionDiscoveryMetadata.region_outcome=Vx.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=l,[2,a.replaceWithRegionalInformation(o,l)];this.regionDiscoveryMetadata.region_outcome=Vx.AUTO_DETECTION_REQUESTED_FAILED,u.label=2;case 2:return[2,o]}})})},a.prototype.updateCloudDiscoveryMetadata=function(o){var i;return Gr(this,void 0,void 0,function(){var l,u;return Kr(this,function(h){switch(h.label){case 0:return null!=(i=this.performanceClient)&&i.addQueueMeasurement(Ct.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId),this.logger.verbose("Attempting to get cloud discovery metadata in the config"),this.logger.verbosePii("Known Authorities: "+(this.authorityOptions.knownAuthorities||je.NOT_APPLICABLE)),this.logger.verbosePii("Authority Metadata: "+(this.authorityOptions.authorityMetadata||je.NOT_APPLICABLE)),this.logger.verbosePii("Canonical Authority: "+(o.canonical_authority||je.NOT_APPLICABLE)),(l=this.getCloudDiscoveryMetadataFromConfig())?(this.logger.verbose("Found cloud discovery metadata in the config."),o.updateCloudDiscoveryMetadata(l,!1),[2,Sh.CONFIG]):(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the cache."),u=o.isExpired(),this.isAuthoritySameType(o)&&o.aliasesFromNetwork&&!u?(this.logger.verbose("Found metadata in the cache."),[2,Sh.CACHE]):(u&&this.logger.verbose("The metadata entity is expired."),this.logger.verbose("Did not find cloud discovery metadata in the cache... Attempting to get cloud discovery metadata from the network."),null!=(i=this.performanceClient)&&i.setPreQueueTime(Ct.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),[4,this.getCloudDiscoveryMetadataFromNetwork()]));case 1:if(l=h.sent())return this.logger.verbose("cloud discovery metadata was successfully returned from getCloudDiscoveryMetadataFromNetwork()"),o.updateCloudDiscoveryMetadata(l,!0),[2,Sh.NETWORK];if(this.logger.verbose("Did not find cloud discovery metadata from the network... Attempting to get cloud discovery metadata from hardcoded values."),(u=this.getCloudDiscoveryMetadataFromHarcodedValues())&&!this.options.skipAuthorityMetadataCache)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),o.updateCloudDiscoveryMetadata(u,!1),[2,Sh.HARDCODED_VALUES];throw this.logger.error("Did not find cloud discovery metadata from hardcoded values... Metadata could not be obtained from config, cache, network or hardcoded values. Throwing Untrusted Authority Error."),Os.createUntrustedAuthorityError()}})})},a.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityType===su.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),a.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");var o=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),i=a.getCloudDiscoveryMetadataFromNetworkResponse(o.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),i)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),i;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Os.createInvalidCloudDiscoveryMetadataError()}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),a.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null},a.prototype.getCloudDiscoveryMetadataFromNetwork=function(){var o;return Gr(this,void 0,void 0,function(){var i,l,u,h,g,w;return Kr(this,function(T){switch(T.label){case 0:null!=(o=this.performanceClient)&&o.addQueueMeasurement(Ct.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId),i=""+je.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",l={},u=null,T.label=1;case 1:return T.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(i,l)];case 2:if(w=T.sent(),g=h=void 0,function t5(a){return a.hasOwnProperty("tenant_discovery_endpoint")&&a.hasOwnProperty("metadata")}(w.body))g=(h=w.body).metadata,this.logger.verbosePii("tenant_discovery_endpoint is: "+h.tenant_discovery_endpoint);else{if(!function p7(a){return a.hasOwnProperty("error")&&a.hasOwnProperty("error_description")}(w.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),[2,null];if(this.logger.warning("A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: "+w.status),(h=w.body).error===je.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),[2,null];this.logger.warning("The CloudInstanceDiscoveryErrorResponse error is "+h.error),this.logger.warning("The CloudInstanceDiscoveryErrorResponse error description is "+h.error_description),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),g=[]}return this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),u=a.getCloudDiscoveryMetadataFromNetworkResponse(g,this.hostnameAndPort),[3,4];case 3:return(w=T.sent())instanceof dr?this.logger.error("There was a network error while attempting to get the cloud discovery instance metadata.\nError: "+w.errorCode+"\nError Description: "+w.errorMessage):this.logger.error("A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: "+w.name+"\nError Description: "+w.message),[2,null];case 4:return u||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),u=a.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,u]}})})},a.prototype.getCloudDiscoveryMetadataFromHarcodedValues=function(){return this.canonicalAuthority in wN?wN[this.canonicalAuthority]:null},a.prototype.isInKnownAuthorities=function(){var o=this;return 0<this.authorityOptions.knownAuthorities.filter(function(i){return Yi.getDomainFromUrl(i).toLowerCase()===o.hostnameAndPort}).length},a.generateAuthority=function(o,i){var l;return i&&i.azureCloudInstance!==Bx.None&&(l=i.azureCloudInstance+"/"+(l=i.tenant||je.DEFAULT_COMMON_TENANT)+"/"),l||o},a.createCloudDiscoveryMetadataFromHost=function(o){return{preferred_network:o,preferred_cache:o,aliases:[o]}},a.getCloudDiscoveryMetadataFromNetworkResponse=function(o,i){for(var l=0;l<o.length;l++){var u=o[l];if(-1<u.aliases.indexOf(i))return u}return null},a.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw Vn.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},a.prototype.isAlias=function(o){return-1<this.metadata.aliases.indexOf(o)},a.isPublicCloudAuthority=function(o){return 0<=je.KNOWN_PUBLIC_CLOUDS.indexOf(o)},a.buildRegionalAuthorityString=function(u,i,l){var h=i+"."+((u=new Yi(u)).validateAsUri(),g=u.getUrlComponents()).HostNameAndPort,g=(this.isPublicCloudAuthority(g.HostNameAndPort)&&(h=i+"."+je.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX),Yi.constructAuthorityUriFromObject(Oo(Oo({},u.getUrlComponents()),{HostNameAndPort:h})).urlString);return l?g+"?"+l:g},a.replaceWithRegionalInformation=function(o,i){return o.authorization_endpoint=a.buildRegionalAuthorityString(o.authorization_endpoint,i),o.token_endpoint=a.buildRegionalAuthorityString(o.token_endpoint,i,je.REGIONAL_AUTH_NON_MSI_QUERY_STRING),o.end_session_endpoint&&(o.end_session_endpoint=a.buildRegionalAuthorityString(o.end_session_endpoint,i)),o},a.transformCIAMAuthority=function(l){var i=l.endsWith(je.FORWARD_SLASH)?l:""+l+je.FORWARD_SLASH;return 0===(l=new Yi(l).getUrlComponents()).PathSegments.length&&l.HostNameAndPort.endsWith(je.CIAM_AUTH_URL)?""+i+l.HostNameAndPort.split(".")[0]+je.AAD_TENANT_DOMAIN_SUFFIX:i},a.reservedTenantDomains=new Set(["{tenant}","{tenantid}",sw.COMMON,sw.CONSUMERS,sw.ORGANIZATIONS]),a}(),bN=function(){function a(){}return a.createDiscoveredInstance=function(o,i,l,u,h,g,w){return Gr(this,void 0,void 0,function(){var T,D;return Kr(this,function(P){switch(P.label){case 0:g?.addQueueMeasurement(Ct.AuthorityFactoryCreateDiscoveredInstance,w),T=Zx.transformCIAMAuthority(o),T=a.createInstance(T,i,l,u,h,g,w),P.label=1;case 1:return P.trys.push([1,3,,4]),g?.setPreQueueTime(Ct.AuthorityResolveEndpointsAsync,w),[4,T.resolveEndpointsAsync()];case 2:return P.sent(),[2,T];case 3:throw D=P.sent(),Vn.createEndpointDiscoveryIncompleteError(D);case 4:return[2]}})})},a.createInstance=function(o,i,l,u,h,g,w){if(Ln.isEmpty(o))throw Os.createUrlEmptyError();return new Zx(o,i,l,u,h,g,w)},a}(),EN=function(){function a(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return a.isServerTelemetryEntity=function(l,i){l=0===l.indexOf(Cl.CACHE_KEY);var u=!0;return i&&(u=i.hasOwnProperty("failedRequests")&&i.hasOwnProperty("errors")&&i.hasOwnProperty("cacheHits")),l&&u},a}(),y7=function(){function a(){}return a.isThrottlingEntity=function(u,i){var l=!1;return u&&(l=0===u.indexOf(JA.THROTTLING_PREFIX)),u=!0,i&&(u=i.hasOwnProperty("throttleTime")),l&&u},a}(),Hee={sendGetRequestAsync:function(){return Promise.reject(dr.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(dr.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},xN_missingKidError_code="missing_kid_error",xN_missingKidError_desc="The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",xN_missingAlgError_code="missing_alg_error",xN_missingAlgError_desc="The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided.",_7=function(a){function o(i,l){return(i=a.call(this,i,l)||this).name="JoseHeaderError",Object.setPrototypeOf(i,o.prototype),i}return ou(o,a),o.createMissingKidError=function(){return new o(xN_missingKidError_code,xN_missingKidError_desc)},o.createMissingAlgError=function(){return new o(xN_missingAlgError_code,xN_missingAlgError_desc)},o}(dr),v7=function(){function a(o){this.typ=o.typ,this.alg=o.alg,this.kid=o.kid}return a.getShrHeaderString=function(o){if(!o.kid)throw _7.createMissingKidError();if(o.alg)return o=new a({typ:o.typ||$z.Pop,kid:o.kid,alg:o.alg}),JSON.stringify(o);throw _7.createMissingAlgError()},a}(),n5=function(){function a(o,i){this.cacheOutcome=yg.NO_CACHE_HIT,this.cacheManager=i,this.apiId=o.apiId,this.correlationId=o.correlationId,this.wrapperSKU=o.wrapperSKU||je.EMPTY_STRING,this.wrapperVer=o.wrapperVer||je.EMPTY_STRING,this.telemetryCacheKey=Cl.CACHE_KEY+Tl.CACHE_KEY_SEPARATOR+o.clientId}return a.prototype.generateCurrentRequestHeaderValue=function(){var i=""+this.apiId+Cl.VALUE_SEPARATOR+this.cacheOutcome,o=[this.wrapperSKU,this.wrapperVer].join(Cl.VALUE_SEPARATOR);return i=[i,this.getRegionDiscoveryFields()].join(Cl.VALUE_SEPARATOR),[Cl.SCHEMA_VERSION,i,o].join(Cl.CATEGORY_SEPARATOR)},a.prototype.generateLastRequestHeaderValue=function(){var o=this.getLastRequests(),h=a.maxErrorsToSend(o),i=o.failedRequests.slice(0,2*h).join(Cl.VALUE_SEPARATOR),l=o.errors.slice(0,h).join(Cl.VALUE_SEPARATOR),u=o.errors.length;return h=[u,h<u?Cl.OVERFLOW_TRUE:Cl.OVERFLOW_FALSE].join(Cl.VALUE_SEPARATOR),[Cl.SCHEMA_VERSION,o.cacheHits,i,l,h].join(Cl.CATEGORY_SEPARATOR)},a.prototype.cacheFailedRequest=function(o){var i=this.getLastRequests();i.errors.length>=Cl.MAX_CACHED_ERRORS&&(i.failedRequests.shift(),i.failedRequests.shift(),i.errors.shift()),i.failedRequests.push(this.apiId,this.correlationId),Ln.isEmpty(o.subError)?Ln.isEmpty(o.errorCode)?o&&o.toString()?i.errors.push(o.toString()):i.errors.push(Cl.UNKNOWN_ERROR):i.errors.push(o.errorCode):i.errors.push(o.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,i)},a.prototype.incrementCacheHits=function(){var o=this.getLastRequests();return o.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o),o.cacheHits},a.prototype.getLastRequests=function(){var o=new EN;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||o},a.prototype.clearTelemetryCache=function(){var o,i=this.getLastRequests(),l=a.maxErrorsToSend(i);l===i.errors.length?this.cacheManager.removeItem(this.telemetryCacheKey):((o=new EN).failedRequests=i.failedRequests.slice(2*l),o.errors=i.errors.slice(l),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o))},a.maxErrorsToSend=function(o){for(var i=0,l=0,u=o.errors.length,h=0;h<u;h++){var w=o.failedRequests[2*h+1]||je.EMPTY_STRING,T=o.errors[h]||je.EMPTY_STRING;if(!((l+=(o.failedRequests[2*h]||je.EMPTY_STRING).toString().length+w.toString().length+T.length+3)<Cl.MAX_LAST_HEADER_BYTES))break;i+=1}return i},a.prototype.getRegionDiscoveryFields=function(){var o=[];return o.push(this.regionUsed||je.EMPTY_STRING),o.push(this.regionSource||je.EMPTY_STRING),o.push(this.regionOutcome||je.EMPTY_STRING),o.join(",")},a.prototype.updateRegionDiscoveryMetadata=function(o){this.regionUsed=o.region_used,this.regionSource=o.region_source,this.regionOutcome=o.region_outcome},a.prototype.setCacheOutcome=function(o){this.cacheOutcome=o},a}(),hw=function(){function a(o,i,l,u,h,g){this.authority=i,this.libraryName=u,this.libraryVersion=h,this.applicationTelemetry=g,this.clientId=o,this.logger=l,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map}return a.prototype.startPerformanceMeasurement=function(o,i){return{}},a.prototype.startPerformanceMeasuremeant=function(o,i){return{}},a.prototype.getIntFields=function(){return jee},a.prototype.getPreQueueTime=function(o,i){var l=this.preQueueTimeByCorrelationId.get(i);if(l){if(l.name===o)return l.time;this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue time found for "+o+", unable to add queue measurement")}else this.logger.trace("PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: "+i+", unable to add queue measurement")},a.prototype.calculateQueuedTime=function(o,i){return o<1?(this.logger.trace("PerformanceClient: preQueueTime should be a positive integer and not "+o),0):i<1?(this.logger.trace("PerformanceClient: currentTime should be a positive integer and not "+i),0):i<o?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):i-o},a.prototype.addQueueMeasurement=function(o,i,l,u){if(i){if(0===l)this.logger.trace("PerformanceClient.addQueueMeasurement: queue time provided for "+o+" is "+l);else if(!l)return void this.logger.trace("PerformanceClient.addQueueMeasurement: no queue time provided for "+o);l={eventName:o,queueTime:l,manuallyCompleted:u},(u=this.queueMeasurements.get(i))?(u.push(l),this.queueMeasurements.set(i,u)):(this.logger.trace("PerformanceClient.addQueueMeasurement: adding correlationId "+i+" to queue measurements"),this.queueMeasurements.set(i,[l])),this.preQueueTimeByCorrelationId.delete(i)}else this.logger.trace("PerformanceClient.addQueueMeasurement: correlationId not provided for "+o+", cannot add queue measurement")},a.prototype.startMeasurement=function(o,i){var l=this,u=i||this.generateId(),h=(i||this.logger.info("PerformanceClient: No correlation id provided for "+o+", generating",u),this.logger.trace("PerformanceClient: Performance measurement started for "+o,u),this.startPerformanceMeasuremeant(o,u)),g=(h.startMeasurement(),{eventId:this.generateId(),status:gN.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:o,startTimeMs:Date.now(),correlationId:u,appName:null==(i=this.applicationTelemetry)?void 0:i.appName,appVersion:null==(o=this.applicationTelemetry)?void 0:o.appVersion});return this.cacheEventByCorrelationId(g),{endMeasurement:function(w){return l.endMeasurement(Oo(Oo({},g),w),h)},discardMeasurement:function(){return l.discardMeasurements(g.correlationId)},addStaticFields:function(w){return l.addStaticFields(w,g.correlationId)},increment:function(w){return l.increment(w,g.correlationId)},measurement:h,event:g}},a.prototype.endMeasurement=function(o,i){var l,u,h,g,w,T=this,D=this.eventsByCorrelationId.get(o.correlationId);return D?(u={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0},(l=o.eventId===D.eventId)?(u=this.getQueueInfo(o.correlationId),this.discardCache(D.correlationId)):null!=(h=D.incompleteSubMeasurements)&&h.delete(o.eventId),i?.endMeasurement(),(h=i?.flushMeasurement())?(this.logger.trace("PerformanceClient: Performance measurement ended for "+o.name+": "+h+" ms",o.correlationId),l?(g=Oo(Oo({},D),o),w=0,null!=(i=g.incompleteSubMeasurements)&&i.forEach(function(P){T.logger.trace("PerformanceClient: Incomplete submeasurement "+P.name+" found for "+o.name,g.correlationId),w++}),g.incompleteSubMeasurements=void 0,g=Oo(Oo({},g),{durationMs:Math.round(h),queuedTimeMs:u.totalQueueTime,queuedCount:u.totalQueueCount,queuedManuallyCompletedCount:u.manuallyCompletedCount,status:gN.Completed,incompleteSubsCount:w}),this.truncateIntegralFields(g,this.getIntFields()),this.emitEvents([g],o.correlationId),g):(D[o.name+"DurationMs"]=Math.floor(h),Oo({},D))):(this.logger.trace("PerformanceClient: Performance measurement not taken",D.correlationId),null)):(this.logger.trace("PerformanceClient: Measurement not found for "+o.eventId,o.correlationId),null)},a.prototype.addStaticFields=function(o,i){this.logger.trace("PerformanceClient: Updating static fields");var l=this.eventsByCorrelationId.get(i);l?this.eventsByCorrelationId.set(i,Oo(Oo({},l),o)):this.logger.trace("PerformanceClient: Event not found for",i)},a.prototype.increment=function(o,i){this.logger.trace("PerformanceClient: Updating counters");var l=this.eventsByCorrelationId.get(i);if(l)for(var u in o)l.hasOwnProperty(u)||(l[u]=0),l[u]+=o[u];else this.logger.trace("PerformanceClient: Event not found for",i)},a.prototype.cacheEventByCorrelationId=function(o){var i=this.eventsByCorrelationId.get(o.correlationId);i?(this.logger.trace("PerformanceClient: Performance measurement for "+o.name+" added/updated",o.correlationId),i.incompleteSubMeasurements=i.incompleteSubMeasurements||new Map,i.incompleteSubMeasurements.set(o.eventId,{name:o.name,startTimeMs:o.startTimeMs})):(this.logger.trace("PerformanceClient: Performance measurement for "+o.name+" started",o.correlationId),this.eventsByCorrelationId.set(o.correlationId,Oo({},o)))},a.prototype.getQueueInfo=function(o){var i=this.queueMeasurements.get(o),l=(i||this.logger.trace("PerformanceClient: no queue measurements found for for correlationId: "+o),0),u=0,h=0;return i?.forEach(function(g){l+=g.queueTime,u++,h+=g.manuallyCompleted?1:0}),{totalQueueTime:l,totalQueueCount:u,manuallyCompletedCount:h}},a.prototype.discardMeasurements=function(o){this.logger.trace("PerformanceClient: Performance measurements discarded",o),this.eventsByCorrelationId.delete(o)},a.prototype.discardCache=function(o){this.discardMeasurements(o),this.logger.trace("PerformanceClient: QueueMeasurements discarded",o),this.queueMeasurements.delete(o),this.logger.trace("PerformanceClient: Pre-queue times discarded",o),this.preQueueTimeByCorrelationId.delete(o)},a.prototype.addPerformanceCallback=function(o){var i=this.generateId();return this.callbacks.set(i,o),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+i),i},a.prototype.removePerformanceCallback=function(o){var i=this.callbacks.delete(o);return this.logger.verbose(i?"PerformanceClient: Performance callback "+o+" removed.":"PerformanceClient: Performance callback "+o+" not removed."),i},a.prototype.emitEvents=function(o,i){var l=this;this.logger.verbose("PerformanceClient: Emitting performance events",i),this.callbacks.forEach(function(u,h){l.logger.trace("PerformanceClient: Emitting event to callback "+h,i),u.apply(null,[o])})},a.prototype.truncateIntegralFields=function(o,i){i.forEach(function(l){l in o&&"number"==typeof o[l]&&(o[l]=Math.floor(o[l]))})},a}(),TN=function(){function a(){}return a.prototype.startMeasurement=function(){},a.prototype.endMeasurement=function(){},a.prototype.flushMeasurement=function(){return null},a}(),$ee=function(a){function o(){return null!==a&&a.apply(this,arguments)||this}return ou(o,a),o.prototype.generateId=function(){return"callback-id"},o.prototype.startPerformanceMeasuremeant=function(){return new TN},o.prototype.startPerformanceMeasurement=function(){return new TN},o.prototype.calculateQueuedTime=function(i,l){return 0},o.prototype.addQueueMeasurement=function(i,l,u){},o.prototype.setPreQueueTime=function(i,l){},o}(hw),dn_pkceNotGenerated_code="pkce_not_created",dn_pkceNotGenerated_desc="The PKCE code challenge and verifier could not be generated.",dn_cryptoDoesNotExist_code="crypto_nonexistent",dn_cryptoDoesNotExist_desc="The crypto object or function is not available.",dn_httpMethodNotImplementedError_code="http_method_not_implemented",dn_httpMethodNotImplementedError_desc="The HTTP method given has not been implemented in this library.",dn_emptyNavigateUriError_code="empty_navigate_uri",dn_emptyNavigateUriError_desc="Navigation URI is empty. Please check stack trace for more info.",dn_hashEmptyError_code="hash_empty_error",dn_hashEmptyError_desc="Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. For more visit: aka.ms/msaljs/browser-errors.",dn_hashDoesNotContainStateError_code="no_state_in_hash",dn_hashDoesNotContainStateError_desc="Hash does not contain state. Please verify that the request originated from msal.",dn_hashDoesNotContainKnownPropertiesError_code="hash_does_not_contain_known_properties",dn_hashDoesNotContainKnownPropertiesError_desc="Hash does not contain known properites. Please verify that your redirectUri is not changing the hash. For more visit: aka.ms/msaljs/browser-errors.",dn_unableToParseStateError_code="unable_to_parse_state",dn_unableToParseStateError_desc="Unable to parse state. Please verify that the request originated from msal.",dn_stateInteractionTypeMismatchError_code="state_interaction_type_mismatch",dn_stateInteractionTypeMismatchError_desc="Hash contains state but the interaction type does not match the caller.",dn_interactionInProgress_code="interaction_in_progress",dn_interactionInProgress_desc="Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors.",dn_popupWindowError_code="popup_window_error",dn_popupWindowError_desc="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",dn_emptyWindowError_code="empty_window_error",dn_emptyWindowError_desc="window.open returned null or undefined window object.",dn_userCancelledError_code="user_cancelled",dn_userCancelledError_desc="User cancelled the flow.",dn_monitorPopupTimeoutError_code="monitor_window_timeout",dn_monitorPopupTimeoutError_desc="Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors.",dn_monitorIframeTimeoutError_code="monitor_window_timeout",dn_monitorIframeTimeoutError_desc="Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors.",dn_redirectInIframeError_code="redirect_in_iframe",dn_redirectInIframeError_desc="Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",dn_blockTokenRequestsInHiddenIframeError_code="block_iframe_reload",dn_blockTokenRequestsInHiddenIframeError_desc="Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors",dn_blockAcquireTokenInPopupsError_code="block_nested_popups",dn_blockAcquireTokenInPopupsError_desc="Request was blocked inside a popup because MSAL detected it was running in a popup.",dn_iframeClosedPrematurelyError_code="iframe_closed_prematurely",dn_iframeClosedPrematurelyError_desc="The iframe being monitored was closed prematurely.",dn_silentLogoutUnsupportedError_code="silent_logout_unsupported",dn_silentLogoutUnsupportedError_desc="Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",dn_noAccountError_code="no_account_error",dn_noAccountError_desc="No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",dn_silentPromptValueError_code="silent_prompt_value_error",dn_silentPromptValueError_desc="The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",dn_noTokenRequestCacheError_code="no_token_request_cache_error",dn_noTokenRequestCacheError_desc="No token request found in cache.",dn_unableToParseTokenRequestCacheError_code="unable_to_parse_token_request_cache_error",dn_unableToParseTokenRequestCacheError_desc="The cached token request could not be parsed.",dn_noCachedAuthorityError_code="no_cached_authority_error",dn_noCachedAuthorityError_desc="No cached authority found.",dn_authRequestNotSet_code="auth_request_not_set_error",dn_authRequestNotSet_desc="Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",dn_invalidCacheType_code="invalid_cache_type",dn_invalidCacheType_desc="Invalid cache type",dn_notInBrowserEnvironment_code="non_browser_environment",dn_notInBrowserEnvironment_desc="Login and token requests are not supported in non-browser environments.",dn_databaseNotOpen_code="database_not_open",dn_databaseNotOpen_desc="Database is not open!",dn_noNetworkConnectivity_code="no_network_connectivity",dn_noNetworkConnectivity_desc="No network connectivity. Check your internet connection.",dn_postRequestFailed_code="post_request_failed",dn_postRequestFailed_desc="Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",dn_getRequestFailed_code="get_request_failed",dn_getRequestFailed_desc="Network request failed. Please check the network trace to determine root cause.",dn_failedToParseNetworkResponse_code="failed_to_parse_response",dn_failedToParseNetworkResponse_desc="Failed to parse network response. Check network trace.",dn_unableToLoadTokenError_code="unable_to_load_token",dn_unableToLoadTokenError_desc="Error loading token to cache.",dn_signingKeyNotFoundInStorage_code="crypto_key_not_found",dn_signingKeyNotFoundInStorage_desc="Cryptographic Key or Keypair not found in browser storage.",dn_authCodeRequired_code="auth_code_required",dn_authCodeRequired_desc="An authorization code must be provided (as the `code` property on the request) to this flow.",dn_authCodeOrNativeAccountRequired_code="auth_code_or_nativeAccountId_required",dn_authCodeOrNativeAccountRequired_desc="An authorization code or nativeAccountId must be provided to this flow.",dn_spaCodeAndNativeAccountPresent_code="spa_code_and_nativeAccountId_present",dn_spaCodeAndNativeAccountPresent_desc="Request cannot contain both spa code and native account id.",dn_databaseUnavailable_code="database_unavailable",dn_databaseUnavailable_desc="IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",dn_unableToAcquireTokenFromNativePlatform_code="unable_to_acquire_token_from_native_platform",dn_unableToAcquireTokenFromNativePlatform_desc="Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors.",dn_nativeHandshakeTimeout_code="native_handshake_timeout",dn_nativeHandshakeTimeout_desc="Timed out while attempting to establish connection to browser extension",dn_nativeExtensionNotInstalled_code="native_extension_not_installed",dn_nativeExtensionNotInstalled_desc="Native extension is not installed. If you think this is a mistake call the initialize function.",dn_nativeConnectionNotEstablished_code="native_connection_not_established",dn_nativeConnectionNotEstablished_desc="Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors.",dn_nativeBrokerCalledBeforeInitialize_code="native_broker_called_before_initialize",dn_nativeBrokerCalledBeforeInitialize_desc="You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors.",dn_nativePromptNotSupported_code="native_prompt_not_supported",dn_nativePromptNotSupported_desc="The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",xn=function(a){function o(i,l){return i=a.call(this,i,l)||this,Object.setPrototypeOf(i,o.prototype),i.name="BrowserAuthError",i}return xl(o,a),o.createPkceNotGeneratedError=function(i){return new o(dn_pkceNotGenerated_code,dn_pkceNotGenerated_desc+" Detail:"+i)},o.createCryptoNotAvailableError=function(i){return new o(dn_cryptoDoesNotExist_code,dn_cryptoDoesNotExist_desc+" Detail:"+i)},o.createHttpMethodNotImplementedError=function(i){return new o(dn_httpMethodNotImplementedError_code,dn_httpMethodNotImplementedError_desc+" Given Method: "+i)},o.createEmptyNavigationUriError=function(){return new o(dn_emptyNavigateUriError_code,dn_emptyNavigateUriError_desc)},o.createEmptyHashError=function(i){return new o(dn_hashEmptyError_code,dn_hashEmptyError_desc+" Given Url: "+i)},o.createHashDoesNotContainStateError=function(){return new o(dn_hashDoesNotContainStateError_code,dn_hashDoesNotContainStateError_desc)},o.createHashDoesNotContainKnownPropertiesError=function(){return new o(dn_hashDoesNotContainKnownPropertiesError_code,dn_hashDoesNotContainKnownPropertiesError_desc)},o.createUnableToParseStateError=function(){return new o(dn_unableToParseStateError_code,dn_unableToParseStateError_desc)},o.createStateInteractionTypeMismatchError=function(){return new o(dn_stateInteractionTypeMismatchError_code,dn_stateInteractionTypeMismatchError_desc)},o.createInteractionInProgressError=function(){return new o(dn_interactionInProgress_code,dn_interactionInProgress_desc)},o.createPopupWindowError=function(i){var l=dn_popupWindowError_desc;return l=Ln.isEmpty(i)?l:l+" Details: "+i,new o(dn_popupWindowError_code,l)},o.createEmptyWindowCreatedError=function(){return new o(dn_emptyWindowError_code,dn_emptyWindowError_desc)},o.createUserCancelledError=function(){return new o(dn_userCancelledError_code,dn_userCancelledError_desc)},o.createMonitorPopupTimeoutError=function(){return new o(dn_monitorPopupTimeoutError_code,dn_monitorPopupTimeoutError_desc)},o.createMonitorIframeTimeoutError=function(){return new o(dn_monitorIframeTimeoutError_code,dn_monitorIframeTimeoutError_desc)},o.createRedirectInIframeError=function(i){return new o(dn_redirectInIframeError_code,dn_redirectInIframeError_desc+" (window.parent !== window) => "+i)},o.createBlockReloadInHiddenIframeError=function(){return new o(dn_blockTokenRequestsInHiddenIframeError_code,dn_blockTokenRequestsInHiddenIframeError_desc)},o.createBlockAcquireTokenInPopupsError=function(){return new o(dn_blockAcquireTokenInPopupsError_code,dn_blockAcquireTokenInPopupsError_desc)},o.createIframeClosedPrematurelyError=function(){return new o(dn_iframeClosedPrematurelyError_code,dn_iframeClosedPrematurelyError_desc)},o.createSilentLogoutUnsupportedError=function(){return new o(dn_silentLogoutUnsupportedError_code,dn_silentLogoutUnsupportedError_desc)},o.createNoAccountError=function(){return new o(dn_noAccountError_code,dn_noAccountError_desc)},o.createSilentPromptValueError=function(i){return new o(dn_silentPromptValueError_code,dn_silentPromptValueError_desc+" Given value: "+i)},o.createUnableToParseTokenRequestCacheError=function(){return new o(dn_unableToParseTokenRequestCacheError_code,dn_unableToParseTokenRequestCacheError_desc)},o.createNoTokenRequestCacheError=function(){return new o(dn_noTokenRequestCacheError_code,dn_noTokenRequestCacheError_desc)},o.createAuthRequestNotSetError=function(){return new o(dn_authRequestNotSet_code,dn_authRequestNotSet_desc)},o.createNoCachedAuthorityError=function(){return new o(dn_noCachedAuthorityError_code,dn_noCachedAuthorityError_desc)},o.createInvalidCacheTypeError=function(){return new o(dn_invalidCacheType_code,""+dn_invalidCacheType_desc)},o.createNonBrowserEnvironmentError=function(){return new o(dn_notInBrowserEnvironment_code,dn_notInBrowserEnvironment_desc)},o.createDatabaseNotOpenError=function(){return new o(dn_databaseNotOpen_code,dn_databaseNotOpen_desc)},o.createNoNetworkConnectivityError=function(){return new o(dn_noNetworkConnectivity_code,dn_noNetworkConnectivity_desc)},o.createPostRequestFailedError=function(i,l){return new o(dn_postRequestFailed_code,dn_postRequestFailed_desc+" | Network client threw: "+i+" | Attempted to reach: "+l.split("?")[0])},o.createGetRequestFailedError=function(i,l){return new o(dn_getRequestFailed_code,dn_getRequestFailed_desc+" | Network client threw: "+i+" | Attempted to reach: "+l.split("?")[0])},o.createFailedToParseNetworkResponseError=function(i){return new o(dn_failedToParseNetworkResponse_code,dn_failedToParseNetworkResponse_desc+" | Attempted to reach: "+i.split("?")[0])},o.createUnableToLoadTokenError=function(i){return new o(dn_unableToLoadTokenError_code,dn_unableToLoadTokenError_desc+" | "+i)},o.createSigningKeyNotFoundInStorageError=function(i){return new o(dn_signingKeyNotFoundInStorage_code,dn_signingKeyNotFoundInStorage_desc+" | No match found for KeyId: "+i)},o.createAuthCodeRequiredError=function(){return new o(dn_authCodeRequired_code,dn_authCodeRequired_desc)},o.createAuthCodeOrNativeAccountIdRequiredError=function(){return new o(dn_authCodeOrNativeAccountRequired_code,dn_authCodeOrNativeAccountRequired_desc)},o.createSpaCodeAndNativeAccountIdPresentError=function(){return new o(dn_spaCodeAndNativeAccountPresent_code,dn_spaCodeAndNativeAccountPresent_desc)},o.createDatabaseUnavailableError=function(){return new o(dn_databaseUnavailable_code,dn_databaseUnavailable_desc)},o.createUnableToAcquireTokenFromNativePlatformError=function(){return new o(dn_unableToAcquireTokenFromNativePlatform_code,dn_unableToAcquireTokenFromNativePlatform_desc)},o.createNativeHandshakeTimeoutError=function(){return new o(dn_nativeHandshakeTimeout_code,dn_nativeHandshakeTimeout_desc)},o.createNativeExtensionNotInstalledError=function(){return new o(dn_nativeExtensionNotInstalled_code,dn_nativeExtensionNotInstalled_desc)},o.createNativeConnectionNotEstablishedError=function(){return new o(dn_nativeConnectionNotEstablished_code,dn_nativeConnectionNotEstablished_desc)},o.createNativeBrokerCalledBeforeInitialize=function(){return new o(dn_nativeBrokerCalledBeforeInitialize_code,dn_nativeBrokerCalledBeforeInitialize_desc)},o.createNativePromptParameterNotSupportedError=function(){return new o(dn_nativePromptNotSupported_code,dn_nativePromptNotSupported_desc)},o}(dr),Qx_CHANNEL_ID="53ee284d-920a-4b59-9d30-a60315b26836",r5=(function(a){a.HandshakeRequest="Handshake",a.HandshakeResponse="HandshakeResponse",a.GetToken="GetToken",a.Response="Response"}(wg=wg||{}),function(a){a.LocalStorage="localStorage",a.SessionStorage="sessionStorage",a.MemoryStorage="memoryStorage"}(Ba=Ba||{}),function(a){a.GET="GET",a.POST="POST"}(Uf=Uf||{}),function(a){a.AUTHORITY="authority",a.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",a.SESSION_STATE="session.state",a.REQUEST_STATE="request.state",a.NONCE_IDTOKEN="nonce.id_token",a.ORIGIN_URI="request.origin",a.RENEW_STATUS="token.renew.status",a.URL_HASH="urlHash",a.REQUEST_PARAMS="request.params",a.SCOPES="scopes",a.INTERACTION_STATUS_KEY="interaction.status",a.CCS_CREDENTIAL="ccs.credential",a.CORRELATION_ID="request.correlationId",a.NATIVE_REQUEST="request.native",a.REDIRECT_CONTEXT="request.redirect.context"}(co=co||{}),function(a){a.ACCOUNT_KEYS="msal.account.keys",a.TOKEN_KEYS="msal.token.keys"}(Dh=Dh||{}),function(a){a.WRAPPER_SKU="wrapper.sku",a.WRAPPER_VER="wrapper.version"}(Yx=Yx||{}),function(a){a[a.acquireTokenRedirect=861]="acquireTokenRedirect",a[a.acquireTokenPopup=862]="acquireTokenPopup",a[a.ssoSilent=863]="ssoSilent",a[a.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",a[a.handleRedirectPromise=865]="handleRedirectPromise",a[a.acquireTokenByCode=866]="acquireTokenByCode",a[a.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",a[a.logout=961]="logout",a[a.logoutPopup=962]="logoutPopup"}(xs=xs||{}),function(a){a.Redirect="redirect",a.Popup="popup",a.Silent="silent",a.None="none"}(Jn=Jn||{}),function(a){a.Startup="startup",a.Login="login",a.Logout="logout",a.AcquireToken="acquireToken",a.SsoSilent="ssoSilent",a.HandleRedirect="handleRedirect",a.None="none"}(f7=f7||{}),{scopes:Ux}),Xx="jwk",i5=(function(a){a.React="@azure/msal-react",a.Angular="@azure/msal-angular"}(m7=m7||{}),"msal.db"),Gee=i5+".keys",sc=(function(a){a[a.Default=0]="Default",a[a.AccessToken=1]="AccessToken",a[a.AccessTokenAndRefreshToken=2]="AccessTokenAndRefreshToken",a[a.RefreshToken=3]="RefreshToken",a[a.RefreshTokenAndNetwork=4]="RefreshTokenAndNetwork",a[a.Skip=5]="Skip"}(qu=qu||{}),{redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},entropyNotProvided:{code:"entropy_not_provided",desc:"The available browser crypto interface requires entropy set via system.cryptoOptions.entropy configuration option."}}),CN=function(a){function o(i,l){return(i=a.call(this,i,l)||this).name="BrowserConfigurationAuthError",Object.setPrototypeOf(i,o.prototype),i}return xl(o,a),o.createRedirectUriEmptyError=function(){return new o(sc.redirectUriNotSet.code,sc.redirectUriNotSet.desc)},o.createPostLogoutRedirectUriEmptyError=function(){return new o(sc.postLogoutUriNotSet.code,sc.postLogoutUriNotSet.desc)},o.createStorageNotSupportedError=function(i){return new o(sc.storageNotSupportedError.code,sc.storageNotSupportedError.desc+" Given Location: "+i)},o.createRedirectCallbacksNotSetError=function(){return new o(sc.noRedirectCallbacksSet.code,sc.noRedirectCallbacksSet.desc)},o.createStubPcaInstanceCalledError=function(){return new o(sc.stubPcaInstanceCalled.code,sc.stubPcaInstanceCalled.desc)},o.createInMemoryRedirectUnavailableError=function(){return new o(sc.inMemRedirectUnavailable.code,sc.inMemRedirectUnavailable.desc)},o.createEntropyNotProvided=function(){return new o(sc.entropyNotProvided.code,sc.entropyNotProvided.desc)},o}(dr),w7=function(){function a(o){this.validateWindowStorage(o),this.windowStorage=window[o]}return a.prototype.validateWindowStorage=function(o){if(o!==Ba.LocalStorage&&o!==Ba.SessionStorage||!window[o])throw CN.createStorageNotSupportedError(o)},a.prototype.getItem=function(o){return this.windowStorage.getItem(o)},a.prototype.setItem=function(o,i){this.windowStorage.setItem(o,i)},a.prototype.removeItem=function(o){this.windowStorage.removeItem(o)},a.prototype.getKeys=function(){return Object.keys(this.windowStorage)},a.prototype.containsKey=function(o){return this.windowStorage.hasOwnProperty(o)},a}(),dw=function(){function a(){this.cache=new Map}return a.prototype.getItem=function(o){return this.cache.get(o)||null},a.prototype.setItem=function(o,i){this.cache.set(o,i)},a.prototype.removeItem=function(o){this.cache.delete(o)},a.prototype.getKeys=function(){var o=[];return this.cache.forEach(function(i,l){o.push(l)}),o},a.prototype.containsKey=function(o){return this.cache.has(o)},a.prototype.clear=function(){this.cache.clear()},a}(),o5=function(){function a(){}return a.extractBrowserRequestState=function(o,i){if(Ln.isEmpty(i))return null;try{return vg.parseRequestState(o,i).libraryState.meta}catch(l){throw Vn.createInvalidStateError(i,l)}},a.parseServerResponseFromHash=function(o){return o?(o=new Yi(o),Yi.getDeserializedHash(o.getHash())):{}},a}(),s5=function(a){function o(i,l,u,h){return(i=a.call(this,i,u,h)||this).COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=l,i.logger=h,i.internalStorage=new dw,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.temporaryCacheLocation,i.cacheConfig.cacheLocation),l.cacheMigrationEnabled&&(i.migrateCacheEntries(),i.createKeyMaps()),i}return xl(o,a),o.prototype.setupBrowserStorage=function(i){switch(i){case Ba.LocalStorage:case Ba.SessionStorage:try{return new w7(i)}catch(l){this.logger.verbose(l);break}}return this.cacheConfig.cacheLocation=Ba.MemoryStorage,new dw},o.prototype.setupTemporaryCacheStorage=function(i,l){switch(l){case Ba.LocalStorage:case Ba.SessionStorage:try{return new w7(i||Ba.SessionStorage)}catch(u){return this.logger.verbose(u),this.internalStorage}default:return this.internalStorage}},o.prototype.migrateCacheEntries=function(){var i=this,u=je.CACHE_PREFIX+"."+ol.CLIENT_INFO,h=je.CACHE_PREFIX+"."+ol.ERROR,g=je.CACHE_PREFIX+"."+ol.ERROR_DESC,w=[this.browserStorage.getItem(je.CACHE_PREFIX+"."+ol.ID_TOKEN),this.browserStorage.getItem(u),this.browserStorage.getItem(h),this.browserStorage.getItem(g)];[ol.ID_TOKEN,ol.CLIENT_INFO,ol.ERROR,ol.ERROR_DESC].forEach(function(T,D){return i.migrateCacheEntry(T,w[D])})},o.prototype.migrateCacheEntry=function(i,l){l&&this.setTemporaryCache(i,l,!0)},o.prototype.createKeyMaps=function(){var i=this,l=(this.logger.trace("BrowserCacheManager - createKeyMaps called."),this.getItem(Dh.ACCOUNT_KEYS)),u=this.getItem(Dh.TOKEN_KEYS+"."+this.clientId);l&&u?this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration."):this.browserStorage.getKeys().forEach(function(h){var g;if(i.isCredentialKey(h)&&(g=i.getItem(h))){var w,T,D=i.validateAndParseJson(g);if(D&&D.hasOwnProperty("credentialType"))switch(D.credentialType){case Mr.ID_TOKEN:if(qx.isIdTokenEntity(D))return i.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),i.logger.tracePii("BrowserCacheManager:createKeyMaps - idToken with key: "+h+" found, saving key to token key map"),T=$u.toObject(new qx,D),T=i.updateCredentialCacheKey(h,T),void i.addTokenKey(T,Mr.ID_TOKEN);i.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),i.logger.tracePii("BrowserCacheManager:createKeyMaps - failed idToken validation on key: "+h);break;case Mr.ACCESS_TOKEN:case Mr.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(g_.isAccessTokenEntity(D))return i.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),i.logger.tracePii("BrowserCacheManager:createKeyMaps - accessToken with key: "+h+" found, saving key to token key map"),w=$u.toObject(new g_,D),T=i.updateCredentialCacheKey(h,w),void i.addTokenKey(T,Mr.ACCESS_TOKEN);i.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),i.logger.tracePii("BrowserCacheManager:createKeyMaps - failed accessToken validation on key: "+h);break;case Mr.REFRESH_TOKEN:if(_g.isRefreshTokenEntity(D))return i.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),i.logger.tracePii("BrowserCacheManager:createKeyMaps - refreshToken with key: "+h+" found, saving key to token key map"),w=$u.toObject(new _g,D),T=i.updateCredentialCacheKey(h,w),void i.addTokenKey(T,Mr.REFRESH_TOKEN);i.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),i.logger.tracePii("BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: "+h)}}i.isAccountKey(h)&&(g=i.getItem(h))&&(g=i.validateAndParseJson(g))&&Ac.isAccountEntity(g)&&(i.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),i.logger.tracePii("BrowserCacheManager:createKeyMaps - account with key: "+h+" found, saving key to account key map"),i.addAccountKeyToMap(h))})},o.prototype.validateAndParseJson=function(i){try{var l=JSON.parse(i);return l&&"object"==typeof l?l:null}catch{return null}},o.prototype.getItem=function(i){return this.browserStorage.getItem(i)},o.prototype.setItem=function(i,l){this.browserStorage.setItem(i,l)},o.prototype.getAccount=function(i){this.logger.trace("BrowserCacheManager.getAccount called");var l=this.getItem(i);return(l=l&&this.validateAndParseJson(l))&&Ac.isAccountEntity(l)?$u.toObject(new Ac,l):(this.removeAccountKeyFromMap(i),null)},o.prototype.setAccount=function(i){this.logger.trace("BrowserCacheManager.setAccount called");var l=i.generateAccountKey();this.setItem(l,JSON.stringify(i)),this.addAccountKeyToMap(l)},o.prototype.getAccountKeys=function(){this.logger.trace("BrowserCacheManager.getAccountKeys called");var i=this.getItem(Dh.ACCOUNT_KEYS);return i?JSON.parse(i):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])},o.prototype.addAccountKeyToMap=function(i){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii("BrowserCacheManager.addAccountKeyToMap called with key: "+i);var l=this.getAccountKeys();-1===l.indexOf(i)?(l.push(i),this.setItem(Dh.ACCOUNT_KEYS,JSON.stringify(l)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")},o.prototype.removeAccountKeyFromMap=function(u){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii("BrowserCacheManager.removeAccountKeyFromMap called with key: "+u);var l=this.getAccountKeys();-1<(u=l.indexOf(u))?(l.splice(u,1),this.setItem(Dh.ACCOUNT_KEYS,JSON.stringify(l)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")},o.prototype.removeAccount=function(i){return jt(this,void 0,void 0,function(){return Lt(this,function(l){return a.prototype.removeAccount.call(this,i),this.removeAccountKeyFromMap(i),[2]})})},o.prototype.removeIdToken=function(i){a.prototype.removeIdToken.call(this,i),this.removeTokenKey(i,Mr.ID_TOKEN)},o.prototype.removeAccessToken=function(i){return jt(this,void 0,void 0,function(){return Lt(this,function(l){return a.prototype.removeAccessToken.call(this,i),this.removeTokenKey(i,Mr.ACCESS_TOKEN),[2]})})},o.prototype.removeRefreshToken=function(i){a.prototype.removeRefreshToken.call(this,i),this.removeTokenKey(i,Mr.REFRESH_TOKEN)},o.prototype.getTokenKeys=function(){this.logger.trace("BrowserCacheManager.getTokenKeys called");var i=this.getItem(Dh.TOKEN_KEYS+"."+this.clientId);if(i){if((i=this.validateAndParseJson(i))&&i.hasOwnProperty("idToken")&&i.hasOwnProperty("accessToken")&&i.hasOwnProperty("refreshToken"))return i;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}},o.prototype.addTokenKey=function(i,l){this.logger.trace("BrowserCacheManager addTokenKey called");var u=this.getTokenKeys();switch(l){case Mr.ID_TOKEN:-1===u.idToken.indexOf(i)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),u.idToken.push(i));break;case Mr.ACCESS_TOKEN:-1===u.accessToken.indexOf(i)&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),u.accessToken.push(i));break;case Mr.REFRESH_TOKEN:-1===u.refreshToken.indexOf(i)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),u.refreshToken.push(i));break;default:this.logger.error("BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: "+l),Vn.createUnexpectedCredentialTypeError()}this.setItem(Dh.TOKEN_KEYS+"."+this.clientId,JSON.stringify(u))},o.prototype.removeTokenKey=function(i,l){this.logger.trace("BrowserCacheManager removeTokenKey called");var u=this.getTokenKeys();switch(l){case Mr.ID_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: "+i+" from map");var h=u.idToken.indexOf(i);-1<h?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),u.idToken.splice(h,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case Mr.ACCESS_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: "+i+" from map"),-1<(h=u.accessToken.indexOf(i))?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),u.accessToken.splice(h,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case Mr.REFRESH_TOKEN:this.logger.infoPii("BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: "+i+" from map"),-1<(h=u.refreshToken.indexOf(i))?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),u.refreshToken.splice(h,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:this.logger.error("BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: "+l),Vn.createUnexpectedCredentialTypeError()}this.setItem(Dh.TOKEN_KEYS+"."+this.clientId,JSON.stringify(u))},o.prototype.getIdTokenCredential=function(i){var l=this.getItem(i);return(l=l&&this.validateAndParseJson(l))&&qx.isIdTokenEntity(l)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),$u.toObject(new qx,l)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(i,Mr.ID_TOKEN),null)},o.prototype.setIdTokenCredential=function(i){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var l=i.generateCredentialKey();this.setItem(l,JSON.stringify(i)),this.addTokenKey(l,Mr.ID_TOKEN)},o.prototype.getAccessTokenCredential=function(i){var l=this.getItem(i);return(l=l&&this.validateAndParseJson(l))&&g_.isAccessTokenEntity(l)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),$u.toObject(new g_,l)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(i,Mr.ACCESS_TOKEN),null)},o.prototype.setAccessTokenCredential=function(i){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var l=i.generateCredentialKey();this.setItem(l,JSON.stringify(i)),this.addTokenKey(l,Mr.ACCESS_TOKEN)},o.prototype.getRefreshTokenCredential=function(i){var l=this.getItem(i);return(l=l&&this.validateAndParseJson(l))&&_g.isRefreshTokenEntity(l)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),$u.toObject(new _g,l)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(i,Mr.REFRESH_TOKEN),null)},o.prototype.setRefreshTokenCredential=function(i){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var l=i.generateCredentialKey();this.setItem(l,JSON.stringify(i)),this.addTokenKey(l,Mr.REFRESH_TOKEN)},o.prototype.getAppMetadata=function(i){var l=this.getItem(i);return(l=l&&this.validateAndParseJson(l))&&Xz.isAppMetadataEntity(i,l)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),$u.toObject(new Xz,l)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},o.prototype.setAppMetadata=function(i){this.logger.trace("BrowserCacheManager.setAppMetadata called");var l=i.generateAppMetadataKey();this.setItem(l,JSON.stringify(i))},o.prototype.getServerTelemetry=function(i){var l=this.getItem(i);return(l=l&&this.validateAndParseJson(l))&&EN.isServerTelemetryEntity(i,l)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),$u.toObject(new EN,l)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},o.prototype.setServerTelemetry=function(i,l){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(i,JSON.stringify(l))},o.prototype.getAuthorityMetadata=function(i){var l=this.internalStorage.getItem(i);return l?(l=this.validateAndParseJson(l))&&e5.isAuthorityMetadataEntity(i,l)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),$u.toObject(new e5,l)):null:(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null)},o.prototype.getAuthorityMetadataKeys=function(){var i=this;return this.internalStorage.getKeys().filter(function(l){return i.isAuthorityMetadata(l)})},o.prototype.setWrapperMetadata=function(i,l){this.internalStorage.setItem(Yx.WRAPPER_SKU,i),this.internalStorage.setItem(Yx.WRAPPER_VER,l)},o.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(Yx.WRAPPER_SKU)||je.EMPTY_STRING,this.internalStorage.getItem(Yx.WRAPPER_VER)||je.EMPTY_STRING]},o.prototype.setAuthorityMetadata=function(i,l){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(i,JSON.stringify(l))},o.prototype.getActiveAccount=function(){var i=this.generateCacheKey(ol.ACTIVE_ACCOUNT_FILTERS);return(i=this.getItem(i))?(i=this.validateAndParseJson(i))?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoByFilter({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId})[0]||null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema"),i=this.generateCacheKey(ol.ACTIVE_ACCOUNT),(i=this.getItem(i))?(i=this.getAccountInfoByFilter({localAccountId:i})[0]||null)?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(i),i):null:(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null))},o.prototype.setActiveAccount=function(i){var u=this.generateCacheKey(ol.ACTIVE_ACCOUNT_FILTERS),h=this.generateCacheKey(ol.ACTIVE_ACCOUNT);i?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(u,JSON.stringify({homeAccountId:i.homeAccountId,localAccountId:i.localAccountId})),this.browserStorage.setItem(h,i.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(u),this.browserStorage.removeItem(h))},o.prototype.getAccountInfoByFilter=function(i){var l=this.getAllAccounts();return this.logger.trace("BrowserCacheManager.getAccountInfoByFilter: total "+l.length+" accounts found"),l.filter(function(u){return!(i.username&&i.username.toLowerCase()!==u.username.toLowerCase()||i.homeAccountId&&i.homeAccountId!==u.homeAccountId||i.localAccountId&&i.localAccountId!==u.localAccountId||i.tenantId&&i.tenantId!==u.tenantId||i.environment&&i.environment!==u.environment)})},o.prototype.getAccountInfoByHints=function(i,l){var u=this.getAllAccounts().filter(function(h){return l?l===(h.idTokenClaims&&h.idTokenClaims.sid):!!i&&i===h.username});if(1===u.length)return u[0];if(1<u.length)throw Vn.createMultipleMatchingAccountsInCacheError();return null},o.prototype.getThrottlingCache=function(i){var l=this.getItem(i);return(l=l&&this.validateAndParseJson(l))&&y7.isThrottlingEntity(i,l)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),$u.toObject(new y7,l)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},o.prototype.setThrottlingCache=function(i,l){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(i,JSON.stringify(l))},o.prototype.getTemporaryCache=function(i,l){return l=l?this.generateCacheKey(i):i,this.cacheConfig.storeAuthStateInCookie&&(i=this.getItemCookie(l))?(this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i):(i=this.temporaryCacheStorage.getItem(l))?(this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),i):this.cacheConfig.cacheLocation===Ba.LocalStorage&&(i=this.browserStorage.getItem(l))?(this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i):(this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null)},o.prototype.setTemporaryCache=function(i,l,u){u=u?this.generateCacheKey(i):i,this.temporaryCacheStorage.setItem(u,l),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(u,l))},o.prototype.removeItem=function(i){this.browserStorage.removeItem(i),this.temporaryCacheStorage.removeItem(i),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(i))},o.prototype.containsKey=function(i){return this.browserStorage.containsKey(i)||this.temporaryCacheStorage.containsKey(i)},o.prototype.getKeys=function(){return f_(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},o.prototype.clear=function(){return jt(this,void 0,void 0,function(){var i=this;return Lt(this,function(l){switch(l.label){case 0:return[4,this.removeAllAccounts()];case 1:return l.sent(),this.removeAppMetadata(),this.getKeys().forEach(function(u){!i.browserStorage.containsKey(u)&&!i.temporaryCacheStorage.containsKey(u)||-1===u.indexOf(je.CACHE_PREFIX)&&-1===u.indexOf(i.clientId)||i.removeItem(u)}),this.internalStorage.clear(),[2]}})})},o.prototype.clearTokensAndKeysWithClaims=function(){return jt(this,void 0,void 0,function(){var i,l,u=this;return Lt(this,function(h){switch(h.label){case 0:return this.logger.trace("BrowserCacheManager.clearTokensAndKeysWithClaims called"),i=this.getTokenKeys(),l=[],i.accessToken.forEach(function(g){var w=u.getAccessTokenCredential(g);null!=w&&w.requestedClaimsHash&&g.includes(w.requestedClaimsHash.toLowerCase())&&l.push(u.removeAccessToken(g))}),[4,Promise.all(l)];case 1:return h.sent(),0<l.length&&this.logger.warning(l.length+" access tokens with claims in the cache keys have been removed from the cache."),[2]}})})},o.prototype.setItemCookie=function(i,l,u){i=encodeURIComponent(i)+"="+encodeURIComponent(l)+";path=/;SameSite=Lax;",u&&(i+="expires="+this.getCookieExpirationTime(u)+";"),this.cacheConfig.secureCookies&&(i+="Secure;"),document.cookie=i},o.prototype.getItemCookie=function(i){for(var l=encodeURIComponent(i)+"=",u=document.cookie.split(";"),h=0;h<u.length;h++){for(var g=u[h];" "===g.charAt(0);)g=g.substring(1);if(0===g.indexOf(l))return decodeURIComponent(g.substring(l.length,g.length))}return je.EMPTY_STRING},o.prototype.clearMsalCookies=function(){var i=this,l=je.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach(function(u){for(;" "===u.charAt(0);)u=u.substring(1);var h;0===u.indexOf(l)&&(h=u.split("=")[0],i.clearItemCookie(h))})},o.prototype.clearItemCookie=function(i){this.setItemCookie(i,je.EMPTY_STRING,-1)},o.prototype.getCookieExpirationTime=function(i){return new Date((new Date).getTime()+i*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},o.prototype.getCache=function(){return this.browserStorage},o.prototype.setCache=function(){},o.prototype.generateCacheKey=function(i){return this.validateAndParseJson(i)?JSON.stringify(i):Ln.startsWith(i,je.CACHE_PREFIX)||Ln.startsWith(i,ol.ADAL_ID_TOKEN)?i:je.CACHE_PREFIX+"."+this.clientId+"."+i},o.prototype.generateAuthorityKey=function(i){return i=vg.parseRequestState(this.cryptoImpl,i).libraryState.id,this.generateCacheKey(co.AUTHORITY+"."+i)},o.prototype.generateNonceKey=function(i){return i=vg.parseRequestState(this.cryptoImpl,i).libraryState.id,this.generateCacheKey(co.NONCE_IDTOKEN+"."+i)},o.prototype.generateStateKey=function(i){return i=vg.parseRequestState(this.cryptoImpl,i).libraryState.id,this.generateCacheKey(co.REQUEST_STATE+"."+i)},o.prototype.getCachedAuthority=function(l){return l=this.generateStateKey(l),(l=this.getTemporaryCache(l))?(l=this.generateAuthorityKey(l),this.getTemporaryCache(l)):null},o.prototype.updateCacheEntries=function(i,l,u,h,g){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var w,T=this.generateStateKey(i);this.setTemporaryCache(T,i,!1),T=this.generateNonceKey(i),this.setTemporaryCache(T,l,!1),T=this.generateAuthorityKey(i),this.setTemporaryCache(T,u,!1),g?(w={credential:g.homeAccountId,type:oc.HOME_ACCOUNT_ID},this.setTemporaryCache(co.CCS_CREDENTIAL,JSON.stringify(w),!0)):Ln.isEmpty(h)||(w={credential:h,type:oc.UPN},this.setTemporaryCache(co.CCS_CREDENTIAL,JSON.stringify(w),!0))},o.prototype.resetRequestCache=function(i){var l=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),Ln.isEmpty(i)||this.getKeys().forEach(function(u){-1!==u.indexOf(i)&&l.removeItem(u)}),i&&(this.removeItem(this.generateStateKey(i)),this.removeItem(this.generateNonceKey(i)),this.removeItem(this.generateAuthorityKey(i))),this.removeItem(this.generateCacheKey(co.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(co.ORIGIN_URI)),this.removeItem(this.generateCacheKey(co.URL_HASH)),this.removeItem(this.generateCacheKey(co.CORRELATION_ID)),this.removeItem(this.generateCacheKey(co.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(co.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},o.prototype.cleanRequestByState=function(i){this.logger.trace("BrowserCacheManager.cleanRequestByState called"),i&&(i=this.generateStateKey(i),i=this.temporaryCacheStorage.getItem(i),this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+i),this.resetRequestCache(i||je.EMPTY_STRING)),this.clearMsalCookies()},o.prototype.cleanRequestByInteractionType=function(i){var l=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach(function(u){var h;-1!==u.indexOf(co.REQUEST_STATE)&&(u=l.temporaryCacheStorage.getItem(u))&&(h=o5.extractBrowserRequestState(l.cryptoImpl,u))&&h.interactionType===i&&(l.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+u),l.resetRequestCache(u))}),this.clearMsalCookies(),this.setInteractionInProgress(!1)},o.prototype.cacheCodeRequest=function(i,l){this.logger.trace("BrowserCacheManager.cacheCodeRequest called"),l=l.base64Encode(JSON.stringify(i)),this.setTemporaryCache(co.REQUEST_PARAMS,l,!0)},o.prototype.getCachedRequest=function(i,l){this.logger.trace("BrowserCacheManager.getCachedRequest called");var u=this.getTemporaryCache(co.REQUEST_PARAMS,!0);if(!u)throw xn.createNoTokenRequestCacheError();if(!(l=this.validateAndParseJson(l.base64Decode(u))))throw xn.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(co.REQUEST_PARAMS)),Ln.isEmpty(l.authority)){if(u=this.generateAuthorityKey(i),!(i=this.getTemporaryCache(u)))throw xn.createNoCachedAuthorityError();l.authority=i}return l},o.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var i=this.getTemporaryCache(co.NATIVE_REQUEST,!0);return i?this.validateAndParseJson(i)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)},o.prototype.isInteractionInProgress=function(i){var l=this.getInteractionInProgress();return i?l===this.clientId:!!l},o.prototype.getInteractionInProgress=function(){return this.getTemporaryCache(je.CACHE_PREFIX+"."+co.INTERACTION_STATUS_KEY,!1)},o.prototype.setInteractionInProgress=function(i){var l=je.CACHE_PREFIX+"."+co.INTERACTION_STATUS_KEY;if(i){if(this.getInteractionInProgress())throw xn.createInteractionInProgressError();this.setTemporaryCache(l,this.clientId,!1)}else this.getInteractionInProgress()===this.clientId&&this.removeItem(l)},o.prototype.getLegacyLoginHint=function(){var l,i=this.getTemporaryCache(ol.ADAL_ID_TOKEN);if(i&&(this.browserStorage.removeItem(ol.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved.")),(l=this.getTemporaryCache(ol.ID_TOKEN,!0))&&(this.removeItem(this.generateCacheKey(ol.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved")),l=l||i){if((i=new Bf(l,this.cryptoImpl)).claims&&i.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),i.claims.preferred_username;if(i.claims&&i.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),i.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},o.prototype.updateCredentialCacheKey=function(i,l){var u=l.generateCredentialKey();if(i!==u){var h=this.getItem(i);if(h)return this.removeItem(i),this.setItem(u,h),this.logger.verbose("Updated an outdated "+l.credentialType+" cache key"),u;this.logger.error("Attempted to update an outdated "+l.credentialType+" cache key but no item matching the outdated key was found in storage")}return i},o.prototype.getRedirectRequestContext=function(){return this.getTemporaryCache(co.REDIRECT_CONTEXT,!0)},o.prototype.setRedirectRequestContext=function(i){this.setTemporaryCache(co.REDIRECT_CONTEXT,i,!0)},o}($u),a5="@azure/msal-browser",iD="2.38.3",_d=function(){function a(){}return a.prototype.sendGetRequestAsync=function(o,i){return jt(this,void 0,void 0,function(){var l,u,h;return Lt(this,function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),[4,fetch(o,{method:Uf.GET,headers:this.getFetchHeaders(i)})];case 1:return l=g.sent(),[3,3];case 2:throw u=g.sent(),window.navigator.onLine?xn.createGetRequestFailedError(u,o):xn.createNoNetworkConnectivityError();case 3:return g.trys.push([3,5,,6]),h={headers:this.getHeaderDict(l.headers)},[4,l.json()];case 4:return[2,(h.body=g.sent(),h.status=l.status,h)];case 5:throw g.sent(),xn.createFailedToParseNetworkResponseError(o);case 6:return[2]}})})},a.prototype.sendPostRequestAsync=function(o,i){return jt(this,void 0,void 0,function(){var l,u,h,g;return Lt(this,function(w){switch(w.label){case 0:l=i&&i.body||je.EMPTY_STRING,w.label=1;case 1:return w.trys.push([1,3,,4]),[4,fetch(o,{method:Uf.POST,headers:this.getFetchHeaders(i),body:l})];case 2:return u=w.sent(),[3,4];case 3:throw h=w.sent(),window.navigator.onLine?xn.createPostRequestFailedError(h,o):xn.createNoNetworkConnectivityError();case 4:return w.trys.push([4,6,,7]),g={headers:this.getHeaderDict(u.headers)},[4,u.json()];case 5:return[2,(g.body=w.sent(),g.status=u.status,g)];case 6:throw w.sent(),xn.createFailedToParseNetworkResponseError(o);case 7:return[2]}})})},a.prototype.getFetchHeaders=function(o){var i,l=new Headers;return o&&o.headers&&(i=o.headers,Object.keys(i).forEach(function(u){l.append(u,i[u])})),l},a.prototype.getHeaderDict=function(o){var i={};return o.forEach(function(l,u){i[u]=l}),i},a}(),Wee=function(){function a(){}return a.prototype.sendGetRequestAsync=function(o,i){return jt(this,void 0,void 0,function(){return Lt(this,function(l){return[2,this.sendRequestAsync(o,Uf.GET,i)]})})},a.prototype.sendPostRequestAsync=function(o,i){return jt(this,void 0,void 0,function(){return Lt(this,function(l){return[2,this.sendRequestAsync(o,Uf.POST,i)]})})},a.prototype.sendRequestAsync=function(o,i,l){var u=this;return new Promise(function(h,g){var w=new XMLHttpRequest;if(w.open(i,o,!0),u.setXhrHeaders(w,l),w.onload=function(){(w.status<200||300<=w.status)&&g(i===Uf.POST?xn.createPostRequestFailedError("Failed with status "+w.status,o):xn.createGetRequestFailedError("Failed with status "+w.status,o));try{var T=JSON.parse(w.responseText),D={headers:u.getHeaderDict(w),body:T,status:w.status};h(D)}catch{g(xn.createFailedToParseNetworkResponseError(o))}},w.onerror=function(){window.navigator.onLine?g(i===Uf.POST?xn.createPostRequestFailedError("Failed with status "+w.status,o):xn.createGetRequestFailedError("Failed with status "+w.status,o)):g(xn.createNoNetworkConnectivityError())},i===Uf.POST&&l&&l.body)w.send(l.body);else{if(i!==Uf.GET)throw xn.createHttpMethodNotImplementedError(i);w.send()}})},a.prototype.setXhrHeaders=function(o,i){var l;i&&i.headers&&(l=i.headers,Object.keys(l).forEach(function(u){o.setRequestHeader(u,l[u])}))},a.prototype.getHeaderDict=function(i){i=i.getAllResponseHeaders().trim().split(/[\r\n]+/);var l={};return i.forEach(function(g){var h=(g=g.split(": ")).shift();g=g.join(": "),h&&g&&(l[h]=g)}),l},a}(),ea=function(){function a(){}return a.clearHash=function(o){o.location.hash=je.EMPTY_STRING,"function"==typeof o.history.replaceState&&o.history.replaceState(null,je.EMPTY_STRING,""+o.location.origin+o.location.pathname+o.location.search)},a.replaceHash=function(o){(o=o.split("#")).shift(),window.location.hash=0<o.length?o.join("#"):je.EMPTY_STRING},a.isInIframe=function(){return window.parent!==window},a.isInPopup=function(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf("msal.")},a.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},a.getHomepage=function(){var o=new Yi(window.location.href).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+"/"},a.getBrowserNetworkClient=function(){return new(window.fetch&&window.Headers?_d:Wee)},a.blockReloadInHiddenIframes=function(){if(Yi.hashContainsKnownProperties(window.location.hash)&&a.isInIframe())throw xn.createBlockReloadInHiddenIframeError()},a.blockRedirectInIframe=function(o,i){var l=a.isInIframe();if(o===Jn.Redirect&&l&&!i)throw xn.createRedirectInIframeError(l)},a.blockAcquireTokenInPopups=function(){if(a.isInPopup())throw xn.createBlockAcquireTokenInPopupsError()},a.blockNonBrowserEnvironment=function(o){if(!o)throw xn.createNonBrowserEnvironmentError()},a.blockNativeBrokerCalledBeforeInitialized=function(o,i){if(o&&!i)throw xn.createNativeBrokerCalledBeforeInitialize()},a.detectIEOrEdge=function(){var o=(l=window.navigator.userAgent).indexOf("MSIE "),i=l.indexOf("Trident/"),l=l.indexOf("Edge/");return 0<o||0<i||0<l},a}(),IN=function(){function a(o,i,l,u,h,g,w,T,D){this.config=o,this.browserStorage=i,this.browserCrypto=l,this.networkClient=this.config.system.networkClient,this.eventHandler=h,this.navigationClient=g,this.nativeMessageHandler=T,this.correlationId=D||this.browserCrypto.createNewGuid(),this.logger=u.clone("msal.js.browser",iD,this.correlationId),this.performanceClient=w}return a.prototype.clearCacheOnLogout=function(o){return jt(this,void 0,void 0,function(){return Lt(this,function(i){switch(i.label){case 0:if(!o)return[3,5];Ac.accountInfoIsEqual(o,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Ac.generateAccountCacheKey(o))];case 2:return i.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return i.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return i.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return i.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return i.sent(),[3,9];case 8:return i.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}})})},a.prototype.initializeBaseRequest=function(o,i){return jt(this,void 0,void 0,function(){var l,u,h;return Lt(this,function(g){switch(g.label){case 0:return this.performanceClient.addQueueMeasurement(Ct.InitializeBaseRequest,o.correlationId),this.logger.verbose("Initializing BaseAuthRequest"),l=o.authority||this.config.auth.authority,i?[4,this.validateRequestAuthority(l,i)]:[3,2];case 1:g.sent(),g.label=2;case 2:if(u=f_(o&&o.scopes||[]),(u=Wn(Wn({},o),{correlationId:this.correlationId,authority:l,scopes:u})).authenticationScheme){if(u.authenticationScheme===vo.SSH){if(!o.sshJwk)throw Os.createMissingSshJwkError();if(!o.sshKid)throw Os.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+u.authenticationScheme+'" as configured in Auth request')}else u.authenticationScheme=vo.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return this.config.cache.claimsBasedCachingEnabled&&o.claims&&!Ln.isEmptyObj(o.claims)?(h=u,[4,this.browserCrypto.hashString(o.claims)]):[3,4];case 3:h.requestedClaimsHash=g.sent(),g.label=4;case 4:return[2,u]}})})},a.prototype.getRedirectUri=function(o){return this.logger.verbose("getRedirectUri called"),o=o||this.config.auth.redirectUri||ea.getCurrentUri(),Yi.getAbsoluteUrl(o,ea.getCurrentUri())},a.prototype.validateRequestAuthority=function(o,i){return jt(this,void 0,void 0,function(){return Lt(this,function(l){switch(l.label){case 0:return[4,this.getDiscoveredAuthority(o)];case 1:if(l.sent().isAlias(i.environment))return[2];throw Os.createAuthorityMismatchError()}})})},a.prototype.initializeServerTelemetryManager=function(o,i){return this.logger.verbose("initializeServerTelemetryManager called"),o={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:o,forceRefresh:i||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]},new n5(o,this.browserStorage)},a.prototype.getDiscoveredAuthority=function(o){return jt(this,void 0,void 0,function(){var i;return Lt(this,function(l){switch(l.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},o?(this.logger.verbose("Creating discovered authority with request authority"),[4,bN.createDiscoveredInstance(o,this.config.system.networkClient,this.browserStorage,i,this.logger)]):[3,2];case 1:case 3:return[2,l.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,bN.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,i,this.logger)]}})})},a}(),Jx=function(a){function o(){return null!==a&&a.apply(this,arguments)||this}return xl(o,a),o.prototype.initializeAuthorizationCodeRequest=function(i){return jt(this,void 0,void 0,function(){var l,u;return Lt(this,function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement(Ct.StandardInteractionClientInitializeAuthorizationCodeRequest,i.correlationId),this.logger.verbose("initializeAuthorizationRequest called",i.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return l=h.sent(),u=Wn(Wn({},i),{redirectUri:i.redirectUri,code:je.EMPTY_STRING,codeVerifier:l.verifier}),i.codeChallenge=l.challenge,i.codeChallengeMethod=je.S256_CODE_CHALLENGE_METHOD,[2,u]}})})},o.prototype.initializeLogoutRequest=function(i){this.logger.verbose("initializeLogoutRequest called",i?.correlationId);var l,u=Wn({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},i);return i?i.logoutHint?this.logger.verbose("logoutHint has already been set in logoutRequest"):i.account?(l=this.getLogoutHintFromIdTokenClaims(i.account))&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),u.logoutHint=l):this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set"):this.logger.verbose("logoutHint will not be set since no logout request was configured"),i&&null===i.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",u.correlationId):i&&i.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",u.correlationId),u.postLogoutRedirectUri=Yi.getAbsoluteUrl(i.postLogoutRedirectUri,ea.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",u.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",u.correlationId),u.postLogoutRedirectUri=Yi.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,ea.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",u.correlationId),u.postLogoutRedirectUri=Yi.getAbsoluteUrl(ea.getCurrentUri(),ea.getCurrentUri())),u},o.prototype.getLogoutHintFromIdTokenClaims=function(i){if(i=i.idTokenClaims){if(i.login_hint)return i.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},o.prototype.createAuthCodeClient=function(i,l,u){return jt(this,void 0,void 0,function(){var h;return Lt(this,function(g){switch(g.label){case 0:return this.performanceClient.addQueueMeasurement(Ct.StandardInteractionClientCreateAuthCodeClient,this.correlationId),this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(i,l,u)];case 1:return h=g.sent(),[2,new nD(h,this.performanceClient)]}})})},o.prototype.getClientConfiguration=function(i,l,u){return jt(this,void 0,void 0,function(){var h,g;return Lt(this,function(w){switch(w.label){case 0:return this.performanceClient.addQueueMeasurement(Ct.StandardInteractionClientGetClientConfiguration,this.correlationId),this.logger.verbose("getClientConfiguration called",this.correlationId),this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),[4,this.getDiscoveredAuthority(l,u)];case 1:return h=w.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:h,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:(g=this.config.system.loggerOptions).loggerCallback,piiLoggingEnabled:g.piiLoggingEnabled,logLevel:g.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:i,libraryInfo:{sku:"msal.js.browser",version:iD,cpu:je.EMPTY_STRING,os:je.EMPTY_STRING},telemetry:this.config.telemetry}]}})})},o.prototype.validateAndExtractStateFromHash=function(i,l,u){if(this.logger.verbose("validateAndExtractStateFromHash called",u),!i.state)throw xn.createHashDoesNotContainStateError();var h=o5.extractBrowserRequestState(this.browserCrypto,i.state);if(!h)throw xn.createUnableToParseStateError();if(h.interactionType!==l)throw xn.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",u),i.state},o.prototype.getDiscoveredAuthority=function(i,l){var u;return jt(this,void 0,void 0,function(){var h,g,w;return Lt(this,function(T){switch(T.label){case 0:return this.performanceClient.addQueueMeasurement(Ct.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),this.logger.verbose("getDiscoveredAuthority called",this.correlationId),h=null==(u=this.performanceClient)?void 0:u.startMeasurement(Ct.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),g={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},w=Zx.generateAuthority(w=i||this.config.auth.authority,l||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),this.performanceClient.setPreQueueTime(Ct.AuthorityFactoryCreateDiscoveredInstance,this.correlationId),[4,bN.createDiscoveredInstance(w,this.config.system.networkClient,this.browserStorage,g,this.logger,this.performanceClient,this.correlationId).then(function(D){return h.endMeasurement({success:!0}),D}).catch(function(D){throw h.endMeasurement({errorCode:D.errorCode,subErrorCode:D.subError,success:!1}),D})];case 1:return[2,T.sent()]}})})},o.prototype.initializeAuthorizationRequest=function(i,l){return jt(this,void 0,void 0,function(){var u,h,g,w,T;return Lt(this,function(D){switch(D.label){case 0:return this.performanceClient.addQueueMeasurement(Ct.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId),this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),u=this.getRedirectUri(i.redirectUri),h=vg.setRequestState(this.browserCrypto,i&&i.state||je.EMPTY_STRING,h={interactionType:l}),this.performanceClient.setPreQueueTime(Ct.InitializeBaseRequest,this.correlationId),w=[{}],[4,this.initializeBaseRequest(i)];case 1:return g=Wn.apply(void 0,[Wn.apply(void 0,w.concat([D.sent()])),{redirectUri:u,state:h,nonce:i.nonce||this.browserCrypto.createNewGuid(),responseMode:ZA.FRAGMENT}]),(T=i.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+T.homeAccountId,this.correlationId),g.account=T),Ln.isEmpty(g.loginHint)&&!T&&(T=this.browserStorage.getLegacyLoginHint())&&(g.loginHint=T),[2,g]}})})},o}(IN),l5=function(){function a(o,i,l,u,h){this.authModule=o,this.browserStorage=i,this.authCodeRequest=l,this.logger=u,this.performanceClient=h}return a.prototype.handleCodeResponseFromHash=function(o,i,l,u){return jt(this,void 0,void 0,function(){var h,g;return Lt(this,function(w){if(this.performanceClient.addQueueMeasurement(Ct.HandleCodeResponseFromHash,this.authCodeRequest.correlationId),this.logger.verbose("InteractionHandler.handleCodeResponse called"),Ln.isEmpty(o))throw xn.createEmptyHashError(o);if(h=this.browserStorage.generateStateKey(i),!(h=this.browserStorage.getTemporaryCache(h)))throw Vn.createStateNotFoundError("Cached State");try{g=this.authModule.handleFragmentResponse(o,h)}catch(T){throw T instanceof bp&&T.subError===dn_userCancelledError_code?xn.createUserCancelledError():T}return this.performanceClient.setPreQueueTime(Ct.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),[2,this.handleCodeResponseFromServer(g,i,l,u)]})})},a.prototype.handleCodeResponseFromServer=function(o,i,l,u,h){return void 0===h&&(h=!0),jt(this,void 0,void 0,function(){var g,w,T;return Lt(this,function(D){switch(D.label){case 0:if(this.performanceClient.addQueueMeasurement(Ct.HandleCodeResponseFromServer,this.authCodeRequest.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),g=this.browserStorage.generateStateKey(i),g=this.browserStorage.getTemporaryCache(g))return w=this.browserStorage.generateNonceKey(g),w=this.browserStorage.getTemporaryCache(w),this.authCodeRequest.code=o.code,o.cloud_instance_host_name?(this.performanceClient.setPreQueueTime(Ct.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,this.updateTokenEndpointAuthority(o.cloud_instance_host_name,l,u)]):[3,2];throw Vn.createStateNotFoundError("Cached State");case 1:D.sent(),D.label=2;case 2:return h&&(o.nonce=w||void 0),o.state=g,o.client_info?this.authCodeRequest.clientInfo=o.client_info:(T=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=T),this.performanceClient.setPreQueueTime(Ct.AuthClientAcquireToken,this.authCodeRequest.correlationId),[4,this.authModule.acquireToken(this.authCodeRequest,o)];case 3:return T=D.sent(),this.browserStorage.cleanRequestByState(i),[2,T]}})})},a.prototype.updateTokenEndpointAuthority=function(o,i,l){return jt(this,void 0,void 0,function(){var u;return Lt(this,function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement(Ct.UpdateTokenEndpointAuthority,this.authCodeRequest.correlationId),[4,bN.createDiscoveredInstance(u="https://"+o+"/"+i.tenant+"/",l,this.browserStorage,i.options,this.logger,this.performanceClient,this.authCodeRequest.correlationId)];case 1:return u=h.sent(),this.authModule.updateAuthority(u),[2]}})})},a.prototype.checkCcsCredentials=function(){var o=this.browserStorage.getTemporaryCache(co.CCS_CREDENTIAL,!0);if(o)try{return JSON.parse(o)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+o)}return null},a}(),c5=function(a){function o(i,l,u,h,g,w){return(i=a.call(this,i,l,u,h,w)||this).browserCrypto=g,i}return xl(o,a),o.prototype.initiateAuthRequest=function(i,l){return jt(this,void 0,void 0,function(){var u;return Lt(this,function(h){switch(h.label){case 0:return this.logger.verbose("RedirectHandler.initiateAuthRequest called"),Ln.isEmpty(i)?[3,7]:(l.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(co.ORIGIN_URI,l.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(co.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.logger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+i),u={apiId:xs.acquireTokenRedirect,timeout:l.redirectTimeout,noHistory:!1},"function"!=typeof l.onRedirectNavigate?[3,4]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===l.onRedirectNavigate(i)?[3,2]:(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,l.navigationClient.navigateExternal(i,u)])));case 1:case 5:return h.sent(),[2];case 2:return this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,l.navigationClient.navigateExternal(i,u)];case 6:return[3,8];case 7:throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),xn.createEmptyNavigationUriError();case 8:return[2]}})})},o.prototype.handleCodeResponseFromHash=function(i,l,u,h){return jt(this,void 0,void 0,function(){var g,w,T,D;return Lt(this,function(P){switch(P.label){case 0:if(this.logger.verbose("RedirectHandler.handleCodeResponse called"),Ln.isEmpty(i))throw xn.createEmptyHashError(i);if(this.browserStorage.setInteractionInProgress(!1),g=this.browserStorage.generateStateKey(l),!(g=this.browserStorage.getTemporaryCache(g)))throw Vn.createStateNotFoundError("Cached State");try{w=this.authModule.handleFragmentResponse(i,g)}catch(N){throw N instanceof bp&&N.subError===dn_userCancelledError_code?xn.createUserCancelledError():N}return T=this.browserStorage.generateNonceKey(g),T=this.browserStorage.getTemporaryCache(T),this.authCodeRequest.code=w.code,w.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(w.cloud_instance_host_name,u,h)]:[3,2];case 1:P.sent(),P.label=2;case 2:return w.nonce=T||void 0,w.state=g,w.client_info?this.authCodeRequest.clientInfo=w.client_info:(D=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=D),[4,this.authModule.acquireToken(this.authCodeRequest,w)];case 3:return D=P.sent(),this.browserStorage.cleanRequestByState(l),[2,D]}})})},o}(l5),SN=(function(a){a.INITIALIZE_START="msal:initializeStart",a.INITIALIZE_END="msal:initializeEnd",a.ACCOUNT_ADDED="msal:accountAdded",a.ACCOUNT_REMOVED="msal:accountRemoved",a.LOGIN_START="msal:loginStart",a.LOGIN_SUCCESS="msal:loginSuccess",a.LOGIN_FAILURE="msal:loginFailure",a.ACQUIRE_TOKEN_START="msal:acquireTokenStart",a.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",a.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",a.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",a.SSO_SILENT_START="msal:ssoSilentStart",a.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",a.SSO_SILENT_FAILURE="msal:ssoSilentFailure",a.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",a.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",a.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",a.HANDLE_REDIRECT_START="msal:handleRedirectStart",a.HANDLE_REDIRECT_END="msal:handleRedirectEnd",a.POPUP_OPENED="msal:popupOpened",a.LOGOUT_START="msal:logoutStart",a.LOGOUT_SUCCESS="msal:logoutSuccess",a.LOGOUT_FAILURE="msal:logoutFailure",a.LOGOUT_END="msal:logoutEnd",a.RESTORE_FROM_BFCACHE="msal:restoreFromBFCache"}(zr=zr||{}),function(a){a.USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",a.USER_CANCEL="USER_CANCEL",a.NO_NETWORK="NO_NETWORK",a.TRANSIENT_ERROR="TRANSIENT_ERROR",a.PERSISTENT_ERROR="PERSISTENT_ERROR",a.DISABLED="DISABLED",a.ACCOUNT_UNAVAILABLE="ACCOUNT_UNAVAILABLE"}(uw=uw||{}),{extensionError:{code:"ContentError"},userSwitch:{code:"user_switch",desc:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},tokensNotFoundInCache:{code:"tokens_not_found_in_internal_memory_cache",desc:"Tokens not cached in MSAL JS internal memory, please make the WAM request"}}),bg=function(a){function o(i,l,u){return i=a.call(this,i,l)||this,Object.setPrototypeOf(i,o.prototype),i.name="NativeAuthError",i.ext=u,i}return xl(o,a),o.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==uw.PERSISTENT_ERROR&&this.ext.status!==uw.DISABLED)||this.errorCode===SN.extensionError.code},o.createError=function(i,l,u){if(u&&u.status)switch(u.status){case uw.ACCOUNT_UNAVAILABLE:return yd.createNativeAccountUnavailableError();case uw.USER_INTERACTION_REQUIRED:return new yd(i,l);case uw.USER_CANCEL:return xn.createUserCancelledError();case uw.NO_NETWORK:return xn.createNoNetworkConnectivityError()}return new o(i,l,u)},o.createUserSwitchError=function(){return new o(SN.userSwitch.code,SN.userSwitch.desc)},o.createTokensNotFoundInCacheError=function(){return new o(SN.tokensNotFoundInCache.code,SN.tokensNotFoundInCache.desc)},o}(dr),b7=function(a){function o(){return null!==a&&a.apply(this,arguments)||this}return xl(o,a),o.prototype.acquireToken=function(i){return jt(this,void 0,void 0,function(){var l,u,h,g;return Lt(this,function(w){switch(w.label){case 0:return l=this.performanceClient.startMeasurement(Ct.SilentCacheClientAcquireToken,i.correlationId),h=this.initializeServerTelemetryManager(xs.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(h,i.authority,i.azureCloudOptions)];case 1:u=w.sent(),this.logger.verbose("Silent auth client created"),w.label=2;case 2:return w.trys.push([2,4,,5]),[4,u.acquireCachedToken(i)];case 3:return h=w.sent(),l.endMeasurement({success:!0,fromCache:!0}),[2,h];case 4:throw(g=w.sent())instanceof xn&&g.errorCode===dn_signingKeyNotFoundInStorage_code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),l.endMeasurement({errorCode:g instanceof dr&&g.errorCode||void 0,subErrorCode:g instanceof dr&&g.subError||void 0,success:!1}),g;case 5:return[2]}})})},o.prototype.logout=function(){return Promise.reject(xn.createSilentLogoutUnsupportedError())},o.prototype.createSilentFlowClient=function(i,l,u){return jt(this,void 0,void 0,function(){var h;return Lt(this,function(g){switch(g.label){case 0:return this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(i,l,u)];case 1:return h=g.sent(),[2,new Wx(h,this.performanceClient)]}})})},o.prototype.initializeSilentRequest=function(i,l){return jt(this,void 0,void 0,function(){var u;return Lt(this,function(h){switch(h.label){case 0:return this.performanceClient.addQueueMeasurement(Ct.InitializeSilentRequest,this.correlationId),this.performanceClient.setPreQueueTime(Ct.InitializeBaseRequest,this.correlationId),u=[Wn({},i)],[4,this.initializeBaseRequest(i,l)];case 1:return[2,Wn.apply(void 0,[Wn.apply(void 0,u.concat([h.sent()])),{account:l,forceRefresh:i.forceRefresh||!1}])]}})})},o}(Jx),y_=function(a){function o(i,l,u,h,g,w,T,D,P,N,z,W){return(l=a.call(this,i,l,u,h,g,w,D,P,W)||this).apiId=T,l.accountId=N,l.nativeMessageHandler=P,l.nativeStorageManager=z,l.silentCacheClient=new b7(i,l.nativeStorageManager,u,h,g,w,D,P,W),l}return xl(o,a),o.prototype.acquireToken=function(i){return jt(this,void 0,void 0,function(){var l,u,h,g,w;return Lt(this,function(T){switch(T.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),l=this.performanceClient.startMeasurement(Ct.NativeInteractionClientAcquireToken,i.correlationId),u=gd.nowSeconds(),[4,this.initializeNativeRequest(i)];case 1:h=T.sent(),T.label=2;case 2:return T.trys.push([2,4,,5]),[4,this.acquireTokensFromCache(this.accountId,h)];case 3:return g=T.sent(),l.endMeasurement({success:!0,isNativeBroker:!1,fromCache:!0}),[2,g];case 4:return T.sent(),this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call"),[3,5];case 5:return[4,this.nativeMessageHandler.sendMessage(g={method:wg.GetToken,request:h})];case 6:return w=T.sent(),w=this.validateNativeResponse(w),[2,this.handleNativeResponse(w,h,u).then(function(D){return l.endMeasurement({success:!0,isNativeBroker:!0,requestId:D.requestId}),D}).catch(function(D){throw l.endMeasurement({success:!1,errorCode:D.errorCode,subErrorCode:D.subError,isNativeBroker:!0}),D})]}})})},o.prototype.createSilentCacheRequest=function(i,l){return{authority:i.authority,correlationId:this.correlationId,scopes:au.fromString(i.scope).asArray(),account:l,forceRefresh:!1}},o.prototype.acquireTokensFromCache=function(i,l){return jt(this,void 0,void 0,function(){var u,h;return Lt(this,function(g){switch(g.label){case 0:if(!i)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),Vn.createNoAccountFoundError();if(!(u=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:i})))throw Vn.createNoAccountFoundError();g.label=1;case 1:return g.trys.push([1,3,,4]),h=this.createSilentCacheRequest(l,u),[4,this.silentCacheClient.acquireToken(h)];case 2:return[2,g.sent()];case 3:throw g.sent();case 4:return[2]}})})},o.prototype.acquireTokenRedirect=function(i){return jt(this,void 0,void 0,function(){var l,u,h,g,w;return Lt(this,function(T){switch(T.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(i)];case 1:l=T.sent(),u={method:wg.GetToken,request:l},T.label=2;case 2:return T.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(u)];case 3:return h=T.sent(),this.validateNativeResponse(h),[3,5];case 4:if((h=T.sent())instanceof bg&&h.isFatal())throw h;return[3,5];case 5:return this.browserStorage.setTemporaryCache(co.NATIVE_REQUEST,JSON.stringify(l),!0),g={apiId:xs.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},w=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(i.redirectUri),[4,this.navigationClient.navigateExternal(w,g)];case 6:return T.sent(),[2]}})})},o.prototype.handleRedirectPromise=function(){return jt(this,void 0,void 0,function(){var i,l,u,h;return Lt(this,function(g){switch(g.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(i=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];l=i.prompt,i=_p(i,["prompt"]),l&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(co.NATIVE_REQUEST)),l={method:wg.GetToken,request:i},u=gd.nowSeconds(),g.label=1;case 1:return g.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(l)];case 2:return h=g.sent(),this.validateNativeResponse(h),h=this.handleNativeResponse(h,i,u),this.browserStorage.setInteractionInProgress(!1),[2,h];case 3:throw h=g.sent(),this.browserStorage.setInteractionInProgress(!1),h;case 4:return[2]}})})},o.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},o.prototype.handleNativeResponse=function(i,l,u){return jt(this,void 0,void 0,function(){var h,g,w,T;return Lt(this,function(D){switch(D.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),i.account.id!==l.accountId)throw bg.createUserSwitchError();return[4,this.getDiscoveredAuthority(l.authority)];case 1:return T=D.sent(),w=T.getPreferredCache(),h=this.createIdTokenObj(i),g=this.createHomeAccountIdentifier(i,h),w=this.createAccountEntity(i,g,h,w),[4,this.generateAuthenticationResult(i,l,h,w,T.canonicalAuthority,u)];case 2:return T=D.sent(),this.cacheAccount(w),this.cacheNativeTokens(i,l,g,w,h,T.accessToken,T.tenantId,u),[2,T]}})})},o.prototype.createIdTokenObj=function(i){return new Bf(i.id_token||je.EMPTY_STRING,this.browserCrypto)},o.prototype.createHomeAccountIdentifier=function(i,l){return Ac.generateHomeAccountId(i.client_info||je.EMPTY_STRING,su.Default,this.logger,this.browserCrypto,l)},o.prototype.createAccountEntity=function(i,l,u,h){return Ac.createAccount(i.client_info,l,u,void 0,void 0,void 0,h,i.account.id)},o.prototype.generateScopes=function(i,l){return au.fromString(i.scope?i.scope:l.scope)},o.prototype.generatePopAccessToken=function(i,l){return jt(this,void 0,void 0,function(){var u,h;return Lt(this,function(g){switch(g.label){case 0:if(l.tokenType!==vo.POP)return[3,2];if(i.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),[2,i.shr];if(u=new Kx(this.browserCrypto),h={resourceRequestMethod:l.resourceRequestMethod,resourceRequestUri:l.resourceRequestUri,shrClaims:l.shrClaims,shrNonce:l.shrNonce},l.keyId)return[4,u.signPopToken(i.access_token,l.keyId,h)];throw Vn.createKeyIdMissingError();case 1:return[2,g.sent()];case 2:return[2,i.access_token]}})})},o.prototype.generateAuthenticationResult=function(i,l,u,h,g,w){return jt(this,void 0,void 0,function(){var T,D,P,N,z,W;return Lt(this,function(ue){switch(ue.label){case 0:return T=this.addTelemetryFromNativeResponse(i),D=au.fromString(i.scope?i.scope:l.scope),P=(N=i.account.properties||{}).UID||u.claims.oid||u.claims.sub||je.EMPTY_STRING,N=N.TenantId||u.claims.tid||je.EMPTY_STRING,[4,this.generatePopAccessToken(i,l)];case 1:return z=ue.sent(),W=l.tokenType===vo.POP?vo.POP:vo.BEARER,[2,{authority:g,uniqueId:P,tenantId:N,scopes:D.asArray(),account:h.getAccountInfo(),idToken:i.id_token,idTokenClaims:u.claims,accessToken:z,fromCache:!!T&&this.isResponseFromCache(T),expiresOn:new Date(1e3*Number(w+i.expires_in)),tokenType:W,correlationId:this.correlationId,state:i.state,fromNativeBroker:!0}]}})})},o.prototype.cacheAccount=function(i){var l=this;this.browserStorage.setAccount(i),this.browserStorage.removeAccountContext(i).catch(function(u){l.logger.error("Error occurred while removing account context from browser storage. "+u)})},o.prototype.cacheNativeTokens=function(z,l,W,h,g,ue,T,N){var P=qx.createIdTokenEntity(W,l.authority,z.id_token||je.EMPTY_STRING,l.clientId,g.claims.tid||je.EMPTY_STRING);N+=l.tokenType===vo.POP?je.SHR_NONCE_VALIDITY:("string"==typeof z.expires_in?parseInt(z.expires_in,10):z.expires_in)||0,z=this.generateScopes(z,l),W=g_.createAccessTokenEntity(W,l.authority,ue,l.clientId,g?g.claims.tid||je.EMPTY_STRING:T,z.printScopes(),N,0,this.browserCrypto),ue=new _N(h,P,W),this.nativeStorageManager.saveCacheRecord(ue)},o.prototype.addTelemetryFromNativeResponse=function(i){return(i=this.getMATSFromResponse(i))?(this.performanceClient.addStaticFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:i.broker_version,matsAccountJoinOnStart:i.account_join_on_start,matsAccountJoinOnEnd:i.account_join_on_end,matsDeviceJoin:i.device_join,matsPromptBehavior:i.prompt_behavior,matsApiErrorCode:i.api_error_code,matsUiVisible:i.ui_visible,matsSilentCode:i.silent_code,matsSilentBiSubCode:i.silent_bi_sub_code,matsSilentMessage:i.silent_message,matsSilentStatus:i.silent_status,matsHttpStatus:i.http_status,matsHttpEventCount:i.http_event_count},this.correlationId),i):null},o.prototype.validateNativeResponse=function(i){if(i.hasOwnProperty("access_token")&&i.hasOwnProperty("id_token")&&i.hasOwnProperty("client_info")&&i.hasOwnProperty("account")&&i.hasOwnProperty("scope")&&i.hasOwnProperty("expires_in"))return i;throw bg.createUnexpectedError("Response missing expected properties.")},o.prototype.getMATSFromResponse=function(i){if(i.properties.MATS)try{return JSON.parse(i.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null},o.prototype.isResponseFromCache=function(i){return void 0===i.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!i.is_cached},o.prototype.initializeNativeRequest=function(i){return jt(this,void 0,void 0,function(){var l,u,h,g,w,T=this;return Lt(this,function(D){switch(D.label){case 0:return this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),l=i.authority||this.config.auth.authority,i.account?[4,this.validateRequestAuthority(l,i.account)]:[3,2];case 1:D.sent(),D.label=2;case 2:return(g=new Yi(l)).validateAsUri(),w=i.scopes,h=_p(i,["scopes"]),(w=new au(w||[])).appendScopes(Ux),u=function(){switch(T.apiId){case xs.ssoSilent:case xs.acquireTokenSilent_silentFlow:return T.logger.trace("initializeNativeRequest: silent request sets prompt to none"),ic.NONE}if(i.prompt)switch(i.prompt){case ic.NONE:case ic.CONSENT:case ic.LOGIN:return T.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),i.prompt;default:throw T.logger.trace("initializeNativeRequest: prompt = "+i.prompt+" is not compatible with native flow"),xn.createNativePromptParameterNotSupportedError()}else T.logger.trace("initializeNativeRequest: prompt was not provided")},h=Wn(Wn({},h),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:g.urlString,scope:w.printScopes(),redirectUri:this.getRedirectUri(i.redirectUri),prompt:u(),correlationId:this.correlationId,tokenType:i.authenticationScheme,windowTitleSubstring:document.title,extraParameters:Wn(Wn(Wn({},i.extraQueryParameters),i.tokenQueryParameters),{telemetry:"MATS"}),extendedExpiryToken:!1}),i.authenticationScheme!==vo.POP?[3,4]:(g={resourceRequestUri:i.resourceRequestUri,resourceRequestMethod:i.resourceRequestMethod,shrClaims:i.shrClaims,shrNonce:i.shrNonce},[4,new Kx(this.browserCrypto).generateCnf(g)]);case 3:w=D.sent(),h.reqCnf=w.reqCnfString,h.keyId=w.kid,D.label=4;case 4:return[2,h]}})})},o}(IN),__=function(){function a(o,i,l,u){this.logger=o,this.handshakeTimeoutMs=i,this.extensionId=u,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=l,this.handshakeEvent=l.startMeasurement(Ct.NativeMessageHandlerHandshake)}return a.prototype.sendMessage=function(o){return jt(this,void 0,void 0,function(){var i,l=this;return Lt(this,function(u){return this.logger.trace("NativeMessageHandler - sendMessage called."),i={channel:Qx_CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:o},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(i)),this.messageChannel.port1.postMessage(i),[2,new Promise(function(h,g){l.resolvers.set(i.responseId,{resolve:h,reject:g})})]})})},a.createProvider=function(o,i,l){return jt(this,void 0,void 0,function(){var u,h;return Lt(this,function(g){switch(g.label){case 0:o.trace("NativeMessageHandler - createProvider called."),g.label=1;case 1:return g.trys.push([1,3,,5]),[4,(u=new a(o,i,l,"ppnbnpeolgkicgegkbkbjmhlideopiji")).sendHandshakeRequest()];case 2:return g.sent(),[2,u];case 3:return g.sent(),[4,(h=new a(o,i,l)).sendHandshakeRequest()];case 4:return g.sent(),[2,h];case 5:return[2]}})})},a.prototype.sendHandshakeRequest=function(){return jt(this,void 0,void 0,function(){var o,i=this;return Lt(this,function(l){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),o={channel:Qx_CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:{method:wg.HandshakeRequest}},this.handshakeEvent.addStaticFields({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=function(u){i.onChannelMessage(u)},window.postMessage(o,window.origin,[this.messageChannel.port2]),[2,new Promise(function(u,h){i.handshakeResolvers.set(o.responseId,{resolve:u,reject:h}),i.timeoutId=window.setTimeout(function(){window.removeEventListener("message",i.windowListener,!1),i.messageChannel.port1.close(),i.messageChannel.port2.close(),i.handshakeEvent.endMeasurement({extensionHandshakeTimedOut:!0,success:!1}),h(xn.createNativeHandshakeTimeoutError()),i.handshakeResolvers.delete(o.responseId)},i.handshakeTimeoutMs)})]})})},a.prototype.onWindowMessage=function(o){this.logger.trace("NativeMessageHandler - onWindowMessage called"),o.source!==window||!(o=o.data).channel||o.channel!==Qx_CHANNEL_ID||o.extensionId&&o.extensionId!==this.extensionId||o.body.method===wg.HandshakeRequest&&(this.logger.verbose(o.extensionId?"Extension with id: "+o.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),o=this.handshakeResolvers.get(o.responseId))&&(this.handshakeEvent.endMeasurement({success:!1,extensionInstalled:!1}),o.reject(xn.createNativeExtensionNotInstalledError()))},a.prototype.onChannelMessage=function(o){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var i=o.data,l=this.resolvers.get(i.responseId),u=this.handshakeResolvers.get(i.responseId);try{var h=i.body.method;if(h===wg.Response){if(l){var g=i.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(g)),"Success"!==g.status)l.reject(bg.createError(g.code,g.description,g.ext));else{if(!g.result)throw dr.createUnexpectedError("Event does not contain result.");g.result.code&&g.result.description?l.reject(bg.createError(g.result.code,g.result.description,g.result.ext)):l.resolve(g.result)}this.resolvers.delete(i.responseId)}}else h===wg.HandshakeResponse&&u&&(clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=i.extensionId,this.extensionVersion=i.body.version,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),this.handshakeEvent.endMeasurement({extensionInstalled:!0,success:!0}),u.resolve(),this.handshakeResolvers.delete(i.responseId))}catch(w){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+w.toString()),this.logger.errorPii("Unable to parse "+o),l?l.reject(w):u&&u.reject(w)}},a.prototype.getExtensionId=function(){return this.extensionId},a.prototype.getExtensionVersion=function(){return this.extensionVersion},a.isNativeAvailable=function(o,i,l,u){if(i.trace("isNativeAvailable called"),!o.system.allowNativeBroker)return i.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!l)return i.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(u)switch(u){case vo.BEARER:case vo.POP:return i.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return i.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},a}(),pae=function(a){function o(i,l,u,h,g,w,T,D,P,N){return(i=a.call(this,i,l,u,h,g,w,T,P,N)||this).nativeStorage=D,i}return xl(o,a),o.prototype.acquireToken=function(i){return jt(this,void 0,void 0,function(){var l,u,h,g,w,T,D,P=this;return Lt(this,function(N){switch(N.label){case 0:return this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientInitializeAuthorizationRequest,i.correlationId),[4,this.initializeAuthorizationRequest(i,Jn.Redirect)];case 1:l=N.sent(),this.browserStorage.updateCacheEntries(l.state,l.nonce,l.authority,l.loginHint||je.EMPTY_STRING,l.account||null),u=this.initializeServerTelemetryManager(xs.acquireTokenRedirect),h=function(z){z.persisted&&(P.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),P.browserStorage.cleanRequestByState(l.state),P.eventHandler.emitEvent(zr.RESTORE_FROM_BFCACHE,Jn.Redirect))},N.label=2;case 2:return N.trys.push([2,7,,8]),this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientInitializeAuthorizationCodeRequest,i.correlationId),[4,this.initializeAuthorizationCodeRequest(l)];case 3:return g=N.sent(),this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientCreateAuthCodeClient,i.correlationId),[4,this.createAuthCodeClient(u,l.authority,l.azureCloudOptions)];case 4:return T=N.sent(),this.logger.verbose("Auth code client created"),w=new c5(T,this.browserStorage,g,this.logger,this.browserCrypto,this.performanceClient),[4,T.getAuthCodeUrl(Wn(Wn({},l),{nativeBroker:__.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,i.authenticationScheme)}))];case 5:return T=N.sent(),D=this.getRedirectStartPage(i.redirectStartPage),this.logger.verbosePii("Redirect start page: "+D),window.addEventListener("pageshow",h),[4,w.initiateAuthRequest(T,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:D,onRedirectNavigate:i.onRedirectNavigate})];case 6:return[2,N.sent()];case 7:throw(D=N.sent())instanceof dr&&D.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",h),u.cacheFailedRequest(D),this.browserStorage.cleanRequestByState(l.state),D;case 8:return[2]}})})},o.prototype.handleRedirectPromise=function(i){return jt(this,void 0,void 0,function(){var l,u,h,g,w,T,D,P,N,z;return Lt(this,function(W){switch(W.label){case 0:l=this.initializeServerTelemetryManager(xs.handleRedirectPromise),W.label=1;case 1:if(W.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(u=this.getRedirectResponseHash(i||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Jn.Redirect),[2,null];h=void 0;try{g=Yi.getDeserializedHash(u),h=this.validateAndExtractStateFromHash(g,Jn.Redirect),this.logger.verbose("State extracted from hash")}catch(ue){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+ue),this.browserStorage.cleanRequestByInteractionType(Jn.Redirect),[2,null]}return w=this.browserStorage.getTemporaryCache(co.ORIGIN_URI,!0)||je.EMPTY_STRING,T=Yi.removeHashFromUrl(w),N=Yi.removeHashFromUrl(window.location.href),T===N&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(u,h,l)]):[3,3];case 2:return T=W.sent(),-1<w.indexOf("#")&&ea.replaceHash(w),[2,T];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(u,h,l)]);case 4:return ea.isInIframe()&&!this.config.system.allowRedirectInIframe?[3,9]:(this.browserStorage.setTemporaryCache(co.URL_HASH,u,!0),D={apiId:xs.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},P=!0,w&&"null"!==w?[3,6]:(N=ea.getHomepage(),this.browserStorage.setTemporaryCache(co.ORIGIN_URI,N,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(N,D)]));case 5:return P=W.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+w),[4,this.navigationClient.navigateInternal(w,D)];case 7:P=W.sent(),W.label=8;case 8:if(!P)return[2,this.handleHash(u,h,l)];W.label=9;case 9:return[2,null];case 10:throw(z=W.sent())instanceof dr&&z.setCorrelationId(this.correlationId),l.cacheFailedRequest(z),this.browserStorage.cleanRequestByInteractionType(Jn.Redirect),z;case 11:return[2]}})})},o.prototype.getRedirectResponseHash=function(i){return this.logger.verbose("getRedirectResponseHash called"),Yi.hashContainsKnownProperties(i)?(ea.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash")):(i=this.browserStorage.getTemporaryCache(co.URL_HASH,!0),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(co.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash")),i},o.prototype.handleHash=function(i,l,u){return jt(this,void 0,void 0,function(){var h,g,w,T=this;return Lt(this,function(D){switch(D.label){case 0:if(h=this.browserStorage.getCachedRequest(l,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(g=Yi.getDeserializedHash(i)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),this.nativeMessageHandler)return g=new y_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,xs.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,g.accountId,this.nativeStorage,h.correlationId),w=vg.parseRequestState(this.browserCrypto,l).userRequestState,[2,g.acquireToken(Wn(Wn({},h),{state:w,prompt:void 0})).finally(function(){T.browserStorage.cleanRequestByState(l)})];throw xn.createNativeConnectionNotEstablishedError()}if(g=this.browserStorage.getCachedAuthority(l))return this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientCreateAuthCodeClient,h.correlationId),[4,this.createAuthCodeClient(u,g)];throw xn.createNoCachedAuthorityError();case 1:return w=D.sent(),this.logger.verbose("Auth code client created"),yN.removeThrottle(this.browserStorage,this.config.auth.clientId,h),[4,new c5(w,this.browserStorage,h,this.logger,this.browserCrypto,this.performanceClient).handleCodeResponseFromHash(i,l,w.authority,this.networkClient)];case 2:return[2,D.sent()]}})})},o.prototype.logout=function(i){return jt(this,void 0,void 0,function(){var l,u,h,g,w;return Lt(this,function(T){switch(T.label){case 0:this.logger.verbose("logoutRedirect called"),l=this.initializeLogoutRequest(i),u=this.initializeServerTelemetryManager(xs.logout),T.label=1;case 1:return T.trys.push([1,10,,11]),this.eventHandler.emitEvent(zr.LOGOUT_START,Jn.Redirect,i),[4,this.clearCacheOnLogout(l.account)];case 2:return T.sent(),h={apiId:xs.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientCreateAuthCodeClient,l.correlationId),[4,this.createAuthCodeClient(u,i&&i.authority)];case 3:return g=T.sent(),this.logger.verbose("Auth code client created"),g=g.getLogoutUri(l),this.eventHandler.emitEvent(zr.LOGOUT_SUCCESS,Jn.Redirect,l),i&&"function"==typeof i.onRedirectNavigate?!1===i.onRedirectNavigate(g)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(g,h)]):[3,7];case 4:return T.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),T.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(g,h)];case 8:return T.sent(),[2];case 9:return[3,11];case 10:throw(w=T.sent())instanceof dr&&w.setCorrelationId(this.correlationId),u.cacheFailedRequest(w),this.eventHandler.emitEvent(zr.LOGOUT_FAILURE,Jn.Redirect,null,w),this.eventHandler.emitEvent(zr.LOGOUT_END,Jn.Redirect),w;case 11:return this.eventHandler.emitEvent(zr.LOGOUT_END,Jn.Redirect),[2]}})})},o.prototype.getRedirectStartPage=function(i){return i=i||window.location.href,Yi.getAbsoluteUrl(i,ea.getCurrentUri())},o}(Jx),E7=function(a){function o(i,l,u,h,g,w,T,D,P,N){return(i=a.call(this,i,l,u,h,g,w,T,P,N)||this).unloadWindow=i.unloadWindow.bind(i),i.nativeStorage=D,i}return xl(o,a),o.prototype.acquireToken=function(i){try{var l,u=this.generatePopupName(i.scopes||Ux,i.authority||this.config.auth.authority),h=i.popupWindowAttributes||{};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(i,u,h)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),l=this.openSizedPopup("about:blank",u,h),this.acquireTokenPopupAsync(i,u,h,l))}catch(g){return Promise.reject(g)}},o.prototype.logout=function(i){try{this.logger.verbose("logoutPopup called");var l,u=this.initializeLogoutRequest(i),h=this.generateLogoutPopupName(u),g=i&&i.authority,w=i&&i.mainWindowRedirectUri,T=i?.popupWindowAttributes||{};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(u,h,T,g,void 0,w)):(this.logger.verbose("asyncPopup set to false, opening popup"),l=this.openSizedPopup("about:blank",h,T),this.logoutPopupAsync(u,h,T,g,l,w))}catch(D){return Promise.reject(D)}},o.prototype.acquireTokenPopupAsync=function(i,l,u,h){return jt(this,void 0,void 0,function(){var g,w,T,D,P,N,z,W,ue,ge,we,Re=this;return Lt(this,function(et){switch(et.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),g=this.initializeServerTelemetryManager(xs.acquireTokenPopup),this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientInitializeAuthorizationRequest,i.correlationId),[4,this.initializeAuthorizationRequest(i,Jn.Popup)];case 1:w=et.sent(),this.browserStorage.updateCacheEntries(w.state,w.nonce,w.authority,w.loginHint||je.EMPTY_STRING,w.account||null),et.label=2;case 2:return et.trys.push([2,8,,9]),this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientInitializeAuthorizationCodeRequest,i.correlationId),[4,this.initializeAuthorizationCodeRequest(w)];case 3:return T=et.sent(),this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientCreateAuthCodeClient,i.correlationId),[4,this.createAuthCodeClient(g,w.authority,w.azureCloudOptions)];case 4:return D=et.sent(),this.logger.verbose("Auth code client created"),N=__.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,i.authenticationScheme),P=void 0,N&&(P=this.performanceClient.startMeasurement(Ct.FetchAccountIdWithNativeBroker,i.correlationId)),[4,D.getAuthCodeUrl(Wn(Wn({},w),{nativeBroker:N}))];case 5:return N=et.sent(),z=new l5(D,this.browserStorage,T,this.logger,this.performanceClient),W=this.initiateAuthRequest(N,W={popup:h,popupName:l,popupWindowAttributes:u}),this.eventHandler.emitEvent(zr.POPUP_OPENED,Jn.Popup,{popupWindow:W},null),[4,this.monitorPopupForHash(W)];case 6:if(W=et.sent(),we=Yi.getDeserializedHash(W),ue=this.validateAndExtractStateFromHash(we,Jn.Popup,w.correlationId),yN.removeThrottle(this.browserStorage,this.config.auth.clientId,T),we.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),P&&P.endMeasurement({success:!0,isNativeBroker:!0}),this.nativeMessageHandler)return we=new y_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,xs.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,we.accountId,this.nativeStorage,w.correlationId),ge=vg.parseRequestState(this.browserCrypto,ue).userRequestState,[2,we.acquireToken(Wn(Wn({},w),{state:ge,prompt:void 0})).finally(function(){Re.browserStorage.cleanRequestByState(ue)})];throw xn.createNativeConnectionNotEstablishedError()}return[4,z.handleCodeResponseFromHash(W,ue,D.authority,this.networkClient)];case 7:return[2,et.sent()];case 8:throw we=et.sent(),h&&h.close(),we instanceof dr&&we.setCorrelationId(this.correlationId),g.cacheFailedRequest(we),this.browserStorage.cleanRequestByState(w.state),we;case 9:return[2]}})})},o.prototype.logoutPopupAsync=function(i,l,u,h,g,w){return jt(this,void 0,void 0,function(){var T,D,P;return Lt(this,function(N){switch(N.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(zr.LOGOUT_START,Jn.Popup,i),T=this.initializeServerTelemetryManager(xs.logoutPopup),N.label=1;case 1:return N.trys.push([1,5,,6]),[4,this.clearCacheOnLogout(i.account)];case 2:return N.sent(),this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientCreateAuthCodeClient,i.correlationId),[4,this.createAuthCodeClient(T,h)];case 3:return D=N.sent(),this.logger.verbose("Auth code client created"),D=D.getLogoutUri(i),this.eventHandler.emitEvent(zr.LOGOUT_SUCCESS,Jn.Popup,i),D=this.openPopup(D,{popupName:l,popupWindowAttributes:u,popup:g}),this.eventHandler.emitEvent(zr.POPUP_OPENED,Jn.Popup,{popupWindow:D},null),[4,this.waitForLogoutPopup(D)];case 4:return N.sent(),w?(D={apiId:xs.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},P=Yi.getAbsoluteUrl(w,ea.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+P),this.navigationClient.navigateInternal(P,D)):this.logger.verbose("No main window navigation requested"),[3,6];case 5:throw P=N.sent(),g&&g.close(),P instanceof dr&&P.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(zr.LOGOUT_FAILURE,Jn.Popup,null,P),this.eventHandler.emitEvent(zr.LOGOUT_END,Jn.Popup),T.cacheFailedRequest(P),P;case 6:return this.eventHandler.emitEvent(zr.LOGOUT_END,Jn.Popup),[2]}})})},o.prototype.initiateAuthRequest=function(i,l){if(Ln.isEmpty(i))throw this.logger.error("Navigate url is empty"),xn.createEmptyNavigationUriError();return this.logger.infoPii("Navigate to: "+i),this.openPopup(i,l)},o.prototype.monitorPopupForHash=function(i){var l=this;return new Promise(function(u,h){var g=l.config.system.windowHashTimeout/l.config.system.pollIntervalMilliseconds,w=0,T=(l.logger.verbose("PopupHandler.monitorPopupForHash - polling started"),setInterval(function(){if(i.closed)l.logger.error("PopupHandler.monitorPopupForHash - window closed"),l.cleanPopup(),clearInterval(T),h(xn.createUserCancelledError());else{var D=je.EMPTY_STRING,P=je.EMPTY_STRING;try{D=i.location.href,P=i.location.hash}catch{}Ln.isEmpty(D)||"about:blank"===D||(l.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),w++,P?(l.logger.verbose("PopupHandler.monitorPopupForHash - found hash in url"),clearInterval(T),l.cleanPopup(i),Yi.hashContainsKnownProperties(P)?(l.logger.verbose("PopupHandler.monitorPopupForHash - hash contains known properties, returning."),u(P)):(l.logger.error("PopupHandler.monitorPopupForHash - found hash in url but it does not contain known properties. Check that your router is not changing the hash prematurely."),l.logger.errorPii("PopupHandler.monitorPopupForHash - hash found: "+P),h(xn.createHashDoesNotContainKnownPropertiesError()))):g<w&&(l.logger.error("PopupHandler.monitorPopupForHash - unable to find hash in url, timing out"),clearInterval(T),h(xn.createMonitorPopupTimeoutError())))}},l.config.system.pollIntervalMilliseconds))})},o.prototype.waitForLogoutPopup=function(i){var l=this;return new Promise(function(u){l.logger.verbose("PopupHandler.waitForLogoutPopup - polling started");var h=setInterval(function(){i.closed&&(l.logger.error("PopupHandler.waitForLogoutPopup - window closed"),l.cleanPopup(),clearInterval(h),u());var g=je.EMPTY_STRING;try{g=i.location.href}catch{}Ln.isEmpty(g)||"about:blank"===g||(l.logger.verbose("PopupHandler.waitForLogoutPopup - popup window is on same origin as caller, closing."),clearInterval(h),l.cleanPopup(i),u())},l.config.system.pollIntervalMilliseconds)})},o.prototype.openPopup=function(i,l){try{var u=void 0;if(l.popup?(u=l.popup,this.logger.verbosePii("Navigating popup window to: "+i),u.location.assign(i)):void 0===l.popup&&(this.logger.verbosePii("Opening popup window to: "+i),u=this.openSizedPopup(i,l.popupName,l.popupWindowAttributes)),u)return u.focus&&u.focus(),this.currentWindow=u,window.addEventListener("beforeunload",this.unloadWindow),u;throw xn.createEmptyWindowCreatedError()}catch(h){throw this.logger.error("error opening popup "+h.message),this.browserStorage.setInteractionInProgress(!1),xn.createPopupWindowError(h.toString())}},o.prototype.openSizedPopup=function(i,l,z){var h=window.screenLeft||window.screenX,g=window.screenTop||window.screenY,w=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,T=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,D=null==(D=z.popupSize)?void 0:D.width,P=null==(P=z.popupSize)?void 0:P.height,N=null==(N=z.popupPosition)?void 0:N.top;return z=null==(z=z.popupPosition)?void 0:z.left,(!D||D<0||w<D)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),D=483),(!P||P<0||T<P)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),P=600),(!N||N<0||T<N)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),N=Math.max(0,T/2-300+g)),(!z||z<0||w<z)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),z=Math.max(0,w/2-241.5+h)),window.open(i,l,"width="+D+", height="+P+", top="+N+", left="+z+", scrollbars=yes")},o.prototype.unloadWindow=function(i){this.browserStorage.cleanRequestByInteractionType(Jn.Popup),this.currentWindow&&this.currentWindow.close(),i.preventDefault()},o.prototype.cleanPopup=function(i){i&&i.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},o.prototype.generatePopupName=function(i,l){return"msal."+this.config.auth.clientId+"."+i.join("-")+"."+l+"."+this.correlationId},o.prototype.generateLogoutPopupName=function(i){return"msal."+this.config.auth.clientId+"."+(i=i.account&&i.account.homeAccountId)+"."+this.correlationId},o}(Jx),Eg=function(){function a(){}return a.prototype.navigateInternal=function(o,i){return a.defaultNavigateWindow(o,i)},a.prototype.navigateExternal=function(o,i){return a.defaultNavigateWindow(o,i)},a.defaultNavigateWindow=function(o,i){return i.noHistory?window.location.replace(o):window.location.assign(o),new Promise(function(l){setTimeout(function(){l(!0)},i.timeout)})},a}(),AN=function(a){function o(i,l,u,h,g,w){return(i=a.call(this,i,l,u,h,w)||this).navigateFrameWait=g.navigateFrameWait,i.pollIntervalMilliseconds=g.pollIntervalMilliseconds,i}return xl(o,a),o.prototype.initiateAuthRequest=function(i){return jt(this,void 0,void 0,function(){return Lt(this,function(l){switch(l.label){case 0:if(this.performanceClient.addQueueMeasurement(Ct.SilentHandlerInitiateAuthRequest,this.authCodeRequest.correlationId),Ln.isEmpty(i))throw this.logger.info("Navigate url is empty"),xn.createEmptyNavigationUriError();return this.navigateFrameWait?(this.performanceClient.setPreQueueTime(Ct.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),[4,this.loadFrame(i)]):[3,2];case 1:return[2,l.sent()];case 2:return[2,this.loadFrameSync(i)]}})})},o.prototype.monitorIframeForHash=function(i,l){var u=this;return this.performanceClient.addQueueMeasurement(Ct.SilentHandlerMonitorIframeForHash,this.authCodeRequest.correlationId),new Promise(function(h,g){l<6e3&&u.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+l+"ms) than the default (6000ms). This may result in timeouts.");var w=window.performance.now()+l,T=setInterval(function(){if(window.performance.now()>w)u.removeHiddenIframe(i),clearInterval(T),g(xn.createMonitorIframeTimeoutError());else{var D=je.EMPTY_STRING,P=i.contentWindow;try{D=P?P.location.href:je.EMPTY_STRING}catch{}Ln.isEmpty(D)||Yi.hashContainsKnownProperties(D=P?P.location.hash:je.EMPTY_STRING)&&(u.removeHiddenIframe(i),clearInterval(T),h(D))}},u.pollIntervalMilliseconds)})},o.prototype.loadFrame=function(i){var l=this;return this.performanceClient.addQueueMeasurement(Ct.SilentHandlerLoadFrame,this.authCodeRequest.correlationId),new Promise(function(u,h){var g=l.createHiddenIframe();setTimeout(function(){g?(g.src=i,u(g)):h("Unable to load iframe")},l.navigateFrameWait)})},o.prototype.loadFrameSync=function(i){var l=this.createHiddenIframe();return l.src=i,l},o.prototype.createHiddenIframe=function(){var i=document.createElement("iframe");return i.style.visibility="hidden",i.style.position="absolute",i.style.width=i.style.height="0",i.style.border="0",i.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(i),i},o.prototype.removeHiddenIframe=function(i){document.body===i.parentNode&&document.body.removeChild(i)},o}(l5),Zee=function(a){function o(i,l,u,h,g,w,T,D,P,N,z){return(i=a.call(this,i,l,u,h,g,w,D,N,z)||this).apiId=T,i.nativeStorage=P,i}return xl(o,a),o.prototype.acquireToken=function(i){return jt(this,void 0,void 0,function(){var l,u,h,g;return Lt(this,function(w){switch(w.label){case 0:if(this.performanceClient.addQueueMeasurement(Ct.SilentIframeClientAcquireToken,i.correlationId),this.logger.verbose("acquireTokenByIframe called"),l=this.performanceClient.startMeasurement(Ct.SilentIframeClientAcquireToken,i.correlationId),Ln.isEmpty(i.loginHint)&&Ln.isEmpty(i.sid)&&(!i.account||Ln.isEmpty(i.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),i.prompt&&i.prompt!==ic.NONE&&i.prompt!==ic.NO_SESSION)throw l.endMeasurement({success:!1}),xn.createSilentPromptValueError(i.prompt);return this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientInitializeAuthorizationRequest,i.correlationId),[4,this.initializeAuthorizationRequest(Wn(Wn({},i),{prompt:i.prompt||ic.NONE}),Jn.Silent)];case 1:u=w.sent(),this.browserStorage.updateCacheEntries(u.state,u.nonce,u.authority,u.loginHint||je.EMPTY_STRING,u.account||null),h=this.initializeServerTelemetryManager(this.apiId),w.label=2;case 2:return w.trys.push([2,5,,6]),this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientCreateAuthCodeClient,i.correlationId),[4,this.createAuthCodeClient(h,u.authority,u.azureCloudOptions)];case 3:return g=w.sent(),this.logger.verbose("Auth code client created"),this.performanceClient.setPreQueueTime(Ct.SilentIframeClientTokenHelper,i.correlationId),[4,this.silentTokenHelper(g,u).then(function(T){return l.endMeasurement({success:!0,fromCache:!1,requestId:T.requestId}),T})];case 4:return[2,w.sent()];case 5:throw(g=w.sent())instanceof dr&&g.setCorrelationId(this.correlationId),h.cacheFailedRequest(g),this.browserStorage.cleanRequestByState(u.state),l.endMeasurement({errorCode:g instanceof dr&&g.errorCode||void 0,subErrorCode:g instanceof dr&&g.subError||void 0,success:!1}),g;case 6:return[2]}})})},o.prototype.logout=function(){return Promise.reject(xn.createSilentLogoutUnsupportedError())},o.prototype.silentTokenHelper=function(i,l){return jt(this,void 0,void 0,function(){var u,h,g,w,T,D,P,N=this;return Lt(this,function(z){switch(z.label){case 0:return this.performanceClient.addQueueMeasurement(Ct.SilentIframeClientTokenHelper,l.correlationId),this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientInitializeAuthorizationCodeRequest,l.correlationId),[4,this.initializeAuthorizationCodeRequest(l)];case 1:return u=z.sent(),this.performanceClient.setPreQueueTime(Ct.GetAuthCodeUrl,l.correlationId),[4,i.getAuthCodeUrl(Wn(Wn({},l),{nativeBroker:__.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,l.authenticationScheme)}))];case 2:return g=z.sent(),h=new AN(i,this.browserStorage,u,this.logger,this.config.system,this.performanceClient),this.performanceClient.setPreQueueTime(Ct.SilentHandlerInitiateAuthRequest,l.correlationId),[4,h.initiateAuthRequest(g)];case 3:return g=z.sent(),this.performanceClient.setPreQueueTime(Ct.SilentHandlerMonitorIframeForHash,l.correlationId),[4,h.monitorIframeForHash(g,this.config.system.iframeHashTimeout)];case 4:if(w=z.sent(),D=Yi.getDeserializedHash(w),T=this.validateAndExtractStateFromHash(D,Jn.Silent,u.correlationId),D.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),this.nativeMessageHandler)return D=new y_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,D.accountId,this.browserStorage,this.correlationId),P=vg.parseRequestState(this.browserCrypto,T).userRequestState,[2,D.acquireToken(Wn(Wn({},l),{state:P,prompt:l.prompt||ic.NONE})).finally(function(){N.browserStorage.cleanRequestByState(T)})];throw xn.createNativeConnectionNotEstablishedError()}return this.performanceClient.setPreQueueTime(Ct.HandleCodeResponseFromHash,l.correlationId),[2,h.handleCodeResponseFromHash(w,T,i.authority,this.networkClient)]}})})},o}(Jx),Qee=function(a){function o(){return null!==a&&a.apply(this,arguments)||this}return xl(o,a),o.prototype.acquireToken=function(i){return jt(this,void 0,void 0,function(){var l,u,h,g,w,T=this;return Lt(this,function(D){switch(D.label){case 0:return this.performanceClient.addQueueMeasurement(Ct.SilentRefreshClientAcquireToken,i.correlationId),this.performanceClient.setPreQueueTime(Ct.InitializeBaseRequest,i.correlationId),u=[Wn({},i)],[4,this.initializeBaseRequest(i,i.account)];case 1:return l=Wn.apply(void 0,u.concat([D.sent()])),h=this.performanceClient.startMeasurement(Ct.SilentRefreshClientAcquireToken,l.correlationId),g=this.initializeServerTelemetryManager(xs.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(g,l.authority,l.azureCloudOptions)];case 2:return w=D.sent(),this.logger.verbose("Refresh token client created"),this.performanceClient.setPreQueueTime(Ct.RefreshTokenClientAcquireTokenByRefreshToken,i.correlationId),[2,w.acquireTokenByRefreshToken(l).then(function(P){return h.endMeasurement({success:!0,fromCache:P.fromCache,requestId:P.requestId}),P}).catch(function(P){throw P instanceof dr&&P.setCorrelationId(T.correlationId),g.cacheFailedRequest(P),h.endMeasurement({errorCode:P.errorCode,subErrorCode:P.subError,success:!1}),P})]}})})},o.prototype.logout=function(){return Promise.reject(xn.createSilentLogoutUnsupportedError())},o.prototype.createRefreshTokenClient=function(i,l,u){return jt(this,void 0,void 0,function(){var h;return Lt(this,function(g){switch(g.label){case 0:return this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientGetClientConfiguration,this.correlationId),[4,this.getClientConfiguration(i,l,u)];case 1:return h=g.sent(),[2,new Jz(h,this.performanceClient)]}})})},o}(Jx),gae=function(){function a(o,i){this.eventCallbacks=new Map,this.logger=o,this.browserCrypto=i,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return a.prototype.addEventCallback=function(o){var i;return typeof window<"u"?(i=this.browserCrypto.createNewGuid(),this.eventCallbacks.set(i,o),this.logger.verbose("Event callback registered with id: "+i),i):null},a.prototype.removeEventCallback=function(o){this.eventCallbacks.delete(o),this.logger.verbose("Event callback "+o+" removed.")},a.prototype.enableAccountStorageEvents=function(){typeof window<"u"&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},a.prototype.disableAccountStorageEvents=function(){typeof window<"u"&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},a.prototype.emitEvent=function(o,i,l,u){var h,g=this;typeof window<"u"&&(h={eventType:o,interactionType:i||null,payload:l||null,error:u||null,timestamp:Date.now()},this.logger.info("Emitting event: "+o),this.eventCallbacks.forEach(function(w,T){g.logger.verbose("Emitting event to callback "+T+": "+o),w.apply(null,[h])}))},a.prototype.handleAccountCacheChange=function(o){try{var i,l,u=o.newValue||o.oldValue;u&&"object"==typeof(i=JSON.parse(u))&&Ac.isAccountEntity(i)&&(l=$u.toObject(new Ac,i).getAccountInfo(),!o.oldValue&&o.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(zr.ACCOUNT_ADDED,void 0,l)):!o.newValue&&o.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(zr.ACCOUNT_REMOVED,void 0,l)))}catch{}},a}(),ac=function(){function a(){}return a.decimalToHex=function(o){for(var i=o.toString(16);i.length<2;)i="0"+i;return i},a}(),C7=function(){function a(o){this.cryptoObj=o}return a.prototype.generateGuid=function(){try{var o=new Uint8Array(16);return this.cryptoObj.getRandomValues(o),o[6]|=64,o[6]&=79,o[8]|=128,o[8]&=191,ac.decimalToHex(o[0])+ac.decimalToHex(o[1])+ac.decimalToHex(o[2])+ac.decimalToHex(o[3])+"-"+ac.decimalToHex(o[4])+ac.decimalToHex(o[5])+"-"+ac.decimalToHex(o[6])+ac.decimalToHex(o[7])+"-"+ac.decimalToHex(o[8])+ac.decimalToHex(o[9])+"-"+ac.decimalToHex(o[10])+ac.decimalToHex(o[11])+ac.decimalToHex(o[12])+ac.decimalToHex(o[13])+ac.decimalToHex(o[14])+ac.decimalToHex(o[15])}catch{for(var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",l="0123456789abcdef",u=0,h=je.EMPTY_STRING,g=0;g<36;g++)"-"!==i[g]&&"4"!==i[g]&&(u=16*Math.random()|0),h+="x"===i[g]?l[u]:"y"===i[g]?l[u=3&u|8]:i[g];return h}},a.prototype.isGuid=function(o){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o)},a}(),v_=function(){function a(){}return a.stringToUtf8Arr=function(o){for(var i,l=0,u=o.length,h=0;h<u;h++)l+=(i=o.charCodeAt(h))<128?1:i<2048?2:i<65536?3:i<2097152?4:i<67108864?5:6;for(var g=new Uint8Array(l),w=0,T=0;w<l;T++)(i=o.charCodeAt(T))<128?g[w++]=i:(i<2048?g[w++]=192+(i>>>6):(i<65536?g[w++]=224+(i>>>12):(i<2097152?g[w++]=240+(i>>>18):(i<67108864?g[w++]=248+(i>>>24):(g[w++]=252+(i>>>30),g[w++]=128+(i>>>24&63)),g[w++]=128+(i>>>18&63)),g[w++]=128+(i>>>12&63)),g[w++]=128+(i>>>6&63)),g[w++]=128+(63&i));return g},a.stringToArrayBuffer=function(o){for(var i=new ArrayBuffer(o.length),l=new Uint8Array(i),u=0;u<o.length;u++)l[u]=o.charCodeAt(u);return i},a.utf8ArrToString=function(o){for(var i,l=je.EMPTY_STRING,u=o.length,h=0;h<u;h++)i=o[h],l+=String.fromCharCode(251<i&&i<254&&h+5<u?1073741824*(i-252)+(o[++h]-128<<24)+(o[++h]-128<<18)+(o[++h]-128<<12)+(o[++h]-128<<6)+o[++h]-128:247<i&&i<252&&h+4<u?(i-248<<24)+(o[++h]-128<<18)+(o[++h]-128<<12)+(o[++h]-128<<6)+o[++h]-128:239<i&&i<248&&h+3<u?(i-240<<18)+(o[++h]-128<<12)+(o[++h]-128<<6)+o[++h]-128:223<i&&i<240&&h+2<u?(i-224<<12)+(o[++h]-128<<6)+o[++h]-128:191<i&&i<224&&h+1<u?(i-192<<6)+o[++h]-128:i);return l},a.getSortedObjectString=function(o){return JSON.stringify(o,Object.keys(o).sort())},a}(),Xee=function(){function a(){}return a.prototype.urlEncode=function(o){return encodeURIComponent(this.encode(o).replace(/=/g,je.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},a.prototype.urlEncodeArr=function(o){return this.base64EncArr(o).replace(/=/g,je.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},a.prototype.encode=function(o){return o=v_.stringToUtf8Arr(o),this.base64EncArr(o)},a.prototype.base64EncArr=function(o){for(var i,l=(3-o.length%3)%3,u=je.EMPTY_STRING,h=o.length,g=0,w=0;w<h;w++)g|=o[w]<<(16>>>(i=w%3)&24),2!=i&&o.length-w!=1||(u+=String.fromCharCode(this.uint6ToB64(g>>>18&63),this.uint6ToB64(g>>>12&63),this.uint6ToB64(g>>>6&63),this.uint6ToB64(63&g)),g=0);return 0==l?u:u.substring(0,u.length-l)+(1==l?"=":"==")},a.prototype.uint6ToB64=function(o){return o<26?o+65:o<52?o+71:o<62?o-4:62===o?43:63===o?47:65},a}(),yae=function(){function a(){}return a.prototype.decode=function(o){var i=o.replace(/-/g,"+").replace(/_/g,"/");switch(i.length%4){case 0:break;case 2:i+="==";break;case 3:i+="=";break;default:throw new Error("Invalid base64 string")}return o=this.base64DecToArr(i),v_.utf8ArrToString(o)},a.prototype.base64DecToArr=function(o,i){for(var l,u=o.replace(/[^A-Za-z0-9\+\/]/g,je.EMPTY_STRING),h=u.length,g=i?Math.ceil((3*h+1>>>2)/i)*i:3*h+1>>>2,w=new Uint8Array(g),T=void 0,D=0,P=0,N=0;N<h;N++)if(l=3&N,D|=this.b64ToUint6(u.charCodeAt(N))<<18-6*l,3==l||h-N==1){for(T=0;T<3&&P<g;T++,P++)w[P]=D>>>(16>>>T&24)&255;D=0}return w},a.prototype.b64ToUint6=function(o){return 64<o&&o<91?o-65:96<o&&o<123?o-71:47<o&&o<58?o+4:43===o?62:47===o?63:0},a}(),_ae=function(){function a(o){this.base64Encode=new Xee,this.cryptoObj=o}return a.prototype.generateCodes=function(){return jt(this,void 0,void 0,function(){var o,i;return Lt(this,function(l){switch(l.label){case 0:return o=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(o)];case 1:return i=l.sent(),[2,{verifier:o,challenge:i}]}})})},a.prototype.generateCodeVerifier=function(){try{var o=new Uint8Array(32);return this.cryptoObj.getRandomValues(o),this.base64Encode.urlEncodeArr(o)}catch(i){throw xn.createPkceNotGeneratedError(i)}},a.prototype.generateCodeChallengeFromVerifier=function(o){return jt(this,void 0,void 0,function(){var i;return Lt(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(o)];case 1:return i=l.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(i))];case 2:throw i=l.sent(),xn.createPkceNotGeneratedError(i);case 3:return[2]}})})},a}(),I7=function(){function a(){}return a.prototype.getRandomValues=function(o){return window.crypto.getRandomValues(o)},a.prototype.generateKey=function(o,i,l){return jt(this,void 0,void 0,function(){return Lt(this,function(u){return[2,window.crypto.subtle.generateKey(o,i,l)]})})},a.prototype.exportKey=function(o){return jt(this,void 0,void 0,function(){return Lt(this,function(i){return[2,window.crypto.subtle.exportKey(Xx,o)]})})},a.prototype.importKey=function(o,i,l,u){return jt(this,void 0,void 0,function(){return Lt(this,function(h){return[2,window.crypto.subtle.importKey(Xx,o,i,l,u)]})})},a.prototype.sign=function(o,i,l){return jt(this,void 0,void 0,function(){return Lt(this,function(u){return[2,window.crypto.subtle.sign(o,i,l)]})})},a.prototype.digest=function(o,i){return jt(this,void 0,void 0,function(){return Lt(this,function(l){return[2,window.crypto.subtle.digest(o,i)]})})},a}(),ete=function(){function a(){}return a.prototype.initPrng=function(o){return window.msrCrypto.initPrng(f_(o))},a.prototype.getRandomValues=function(o){return window.msrCrypto.getRandomValues(o)},a.prototype.generateKey=function(o,i,l){return jt(this,void 0,void 0,function(){return Lt(this,function(u){return[2,window.msrCrypto.subtle.generateKey(o,i,l)]})})},a.prototype.exportKey=function(o){return jt(this,void 0,void 0,function(){return Lt(this,function(i){return[2,window.msrCrypto.subtle.exportKey(Xx,o)]})})},a.prototype.importKey=function(o,i,l,u){return jt(this,void 0,void 0,function(){return Lt(this,function(h){return[2,window.msrCrypto.subtle.importKey(Xx,o,i,l,u)]})})},a.prototype.sign=function(o,i,l){return jt(this,void 0,void 0,function(){return Lt(this,function(u){return[2,window.msrCrypto.subtle.sign(o,i,l)]})})},a.prototype.digest=function(o,i){return jt(this,void 0,void 0,function(){return Lt(this,function(l){return[2,window.msrCrypto.subtle.digest(o,i)]})})},a}(),tte=function(){function a(){}return a.prototype.getRandomValues=function(o){return window.msCrypto.getRandomValues(o)},a.prototype.generateKey=function(o,i,l){return jt(this,void 0,void 0,function(){return Lt(this,function(u){return[2,new Promise(function(h,g){var w=window.msCrypto.subtle.generateKey(o,i,l);w.addEventListener("complete",function(T){h(T.target.result)}),w.addEventListener("error",function(T){g(T)})})]})})},a.prototype.exportKey=function(o){return jt(this,void 0,void 0,function(){return Lt(this,function(i){return[2,new Promise(function(l,u){var h=window.msCrypto.subtle.exportKey(Xx,o);h.addEventListener("complete",function(g){var w=g.target.result;w=v_.utf8ArrToString(new Uint8Array(w)).replace(/\r/g,je.EMPTY_STRING).replace(/\n/g,je.EMPTY_STRING).replace(/\t/g,je.EMPTY_STRING).split(" ").join(je.EMPTY_STRING).replace("\0",je.EMPTY_STRING);try{l(JSON.parse(w))}catch(T){u(T)}}),h.addEventListener("error",function(g){u(g)})})]})})},a.prototype.importKey=function(o,i,l,u){return jt(this,void 0,void 0,function(){var h,g;return Lt(this,function(w){return h=v_.getSortedObjectString(o),g=v_.stringToArrayBuffer(h),[2,new Promise(function(T,D){var P=window.msCrypto.subtle.importKey(Xx,g,i,l,u);P.addEventListener("complete",function(N){T(N.target.result)}),P.addEventListener("error",function(N){D(N)})})]})})},a.prototype.sign=function(o,i,l){return jt(this,void 0,void 0,function(){return Lt(this,function(u){return[2,new Promise(function(h,g){var w=window.msCrypto.subtle.sign(o,i,l);w.addEventListener("complete",function(T){h(T.target.result)}),w.addEventListener("error",function(T){g(T)})})]})})},a.prototype.digest=function(o,i){return jt(this,void 0,void 0,function(){return Lt(this,function(l){return[2,new Promise(function(u,h){var g=window.msCrypto.subtle.digest(o,i.buffer);g.addEventListener("complete",function(w){u(w.target.result)}),g.addEventListener("error",function(w){h(w)})})]})})},a}(),A7="SHA-256",rte=new Uint8Array([1,0,1]),D7=function(){function a(o,i){if(this.logger=o,this.cryptoOptions=i,this.hasBrowserCrypto())this.logger.verbose("BrowserCrypto: modern crypto interface available"),this.subtleCrypto=new I7;else if(this.hasIECrypto())this.logger.verbose("BrowserCrypto: MS crypto interface available"),this.subtleCrypto=new tte;else{if(!this.hasMsrCrypto()||null==(o=this.cryptoOptions)||!o.useMsrCrypto)throw this.hasMsrCrypto()&&this.logger.info("BrowserCrypto: MSR Crypto interface available but system.cryptoOptions.useMsrCrypto not enabled"),this.logger.error("BrowserCrypto: No crypto interfaces available."),xn.createCryptoNotAvailableError("Browser crypto, msCrypto, or msrCrypto interfaces not available.");this.logger.verbose("BrowserCrypto: MSR crypto interface available"),this.subtleCrypto=new ete}if(this.subtleCrypto.initPrng){if(this.logger.verbose("BrowserCrypto: Interface requires entropy"),null==(i=this.cryptoOptions)||!i.entropy)throw this.logger.error("BrowserCrypto: Interface requires entropy but none provided."),CN.createEntropyNotProvided();this.logger.verbose("BrowserCrypto: Entropy provided"),this.subtleCrypto.initPrng(this.cryptoOptions.entropy)}this.keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:A7,modulusLength:2048,publicExponent:rte}}return a.prototype.hasIECrypto=function(){return"msCrypto"in window},a.prototype.hasBrowserCrypto=function(){return"crypto"in window},a.prototype.hasMsrCrypto=function(){return"msrCrypto"in window},a.prototype.sha256Digest=function(o){return jt(this,void 0,void 0,function(){var i;return Lt(this,function(l){return i=v_.stringToUtf8Arr(o),[2,this.subtleCrypto.digest({name:A7},i)]})})},a.prototype.getRandomValues=function(o){return this.subtleCrypto.getRandomValues(o)},a.prototype.generateKeyPair=function(o,i){return jt(this,void 0,void 0,function(){return Lt(this,function(l){return[2,this.subtleCrypto.generateKey(this.keygenAlgorithmOptions,o,i)]})})},a.prototype.exportJwk=function(o){return jt(this,void 0,void 0,function(){return Lt(this,function(i){return[2,this.subtleCrypto.exportKey(o)]})})},a.prototype.importJwk=function(o,i,l){return jt(this,void 0,void 0,function(){return Lt(this,function(u){return[2,this.subtleCrypto.importKey(o,this.keygenAlgorithmOptions,i,l)]})})},a.prototype.sign=function(o,i){return jt(this,void 0,void 0,function(){return Lt(this,function(l){return[2,this.subtleCrypto.sign(this.keygenAlgorithmOptions,o,i)]})})},a}(),ite=function(){function a(){this.dbName=i5,this.version=1,this.tableName=Gee,this.dbOpen=!1}return a.prototype.open=function(){return jt(this,void 0,void 0,function(){var o=this;return Lt(this,function(i){return[2,new Promise(function(l,u){var h=window.indexedDB.open(o.dbName,o.version);h.addEventListener("upgradeneeded",function(g){g.target.result.createObjectStore(o.tableName)}),h.addEventListener("success",function(g){o.db=g.target.result,o.dbOpen=!0,l()}),h.addEventListener("error",function(){return u(xn.createDatabaseUnavailableError())})})]})})},a.prototype.closeConnection=function(){var o=this.db;o&&this.dbOpen&&(o.close(),this.dbOpen=!1)},a.prototype.validateDbIsOpen=function(){return jt(this,void 0,void 0,function(){return Lt(this,function(o){switch(o.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,o.sent()];case 2:return[2]}})})},a.prototype.getItem=function(o){return jt(this,void 0,void 0,function(){var i=this;return Lt(this,function(l){switch(l.label){case 0:return[4,this.validateDbIsOpen()];case 1:return l.sent(),[2,new Promise(function(u,h){if(!i.db)return h(xn.createDatabaseNotOpenError());var g=i.db.transaction([i.tableName],"readonly").objectStore(i.tableName).get(o);g.addEventListener("success",function(w){i.closeConnection(),u(w.target.result)}),g.addEventListener("error",function(w){i.closeConnection(),h(w)})})]}})})},a.prototype.setItem=function(o,i){return jt(this,void 0,void 0,function(){var l=this;return Lt(this,function(u){switch(u.label){case 0:return[4,this.validateDbIsOpen()];case 1:return u.sent(),[2,new Promise(function(h,g){if(!l.db)return g(xn.createDatabaseNotOpenError());var w=l.db.transaction([l.tableName],"readwrite").objectStore(l.tableName).put(i,o);w.addEventListener("success",function(){l.closeConnection(),h()}),w.addEventListener("error",function(T){l.closeConnection(),g(T)})})]}})})},a.prototype.removeItem=function(o){return jt(this,void 0,void 0,function(){var i=this;return Lt(this,function(l){switch(l.label){case 0:return[4,this.validateDbIsOpen()];case 1:return l.sent(),[2,new Promise(function(u,h){if(!i.db)return h(xn.createDatabaseNotOpenError());var g=i.db.transaction([i.tableName],"readwrite").objectStore(i.tableName).delete(o);g.addEventListener("success",function(){i.closeConnection(),u()}),g.addEventListener("error",function(w){i.closeConnection(),h(w)})})]}})})},a.prototype.getKeys=function(){return jt(this,void 0,void 0,function(){var o=this;return Lt(this,function(i){switch(i.label){case 0:return[4,this.validateDbIsOpen()];case 1:return i.sent(),[2,new Promise(function(l,u){if(!o.db)return u(xn.createDatabaseNotOpenError());var h=o.db.transaction([o.tableName],"readonly").objectStore(o.tableName).getAllKeys();h.addEventListener("success",function(g){o.closeConnection(),l(g.target.result)}),h.addEventListener("error",function(g){o.closeConnection(),u(g)})})]}})})},a.prototype.containsKey=function(o){return jt(this,void 0,void 0,function(){var i=this;return Lt(this,function(l){switch(l.label){case 0:return[4,this.validateDbIsOpen()];case 1:return l.sent(),[2,new Promise(function(u,h){if(!i.db)return h(xn.createDatabaseNotOpenError());var g=i.db.transaction([i.tableName],"readonly").objectStore(i.tableName).count(o);g.addEventListener("success",function(w){i.closeConnection(),u(1===w.target.result)}),g.addEventListener("error",function(w){i.closeConnection(),h(w)})})]}})})},a.prototype.deleteDatabase=function(){return jt(this,void 0,void 0,function(){return Lt(this,function(o){return this.db&&this.dbOpen&&this.closeConnection(),[2,new Promise(function(i,l){var u=window.indexedDB.deleteDatabase(i5);u.addEventListener("success",function(){return i(!0)}),u.addEventListener("blocked",function(){return i(!0)}),u.addEventListener("error",function(){return l(!1)})})]})})},a}(),u5=function(){function a(o,i){this.inMemoryCache=new dw,this.indexedDBCache=new ite,this.logger=o,this.storeName=i}return a.prototype.handleDatabaseAccessError=function(o){if(!(o instanceof xn&&o.errorCode===dn_databaseUnavailable_code))throw o;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},a.prototype.getItem=function(o){return jt(this,void 0,void 0,function(){var i,l;return Lt(this,function(u){switch(u.label){case 0:if(i=this.inMemoryCache.getItem(o))return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(o)];case 2:return[2,u.sent()];case 3:return l=u.sent(),this.handleDatabaseAccessError(l),[3,4];case 4:return[2,i]}})})},a.prototype.setItem=function(o,i){return jt(this,void 0,void 0,function(){var l;return Lt(this,function(u){switch(u.label){case 0:this.inMemoryCache.setItem(o,i),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(o,i)];case 2:return u.sent(),[3,4];case 3:return l=u.sent(),this.handleDatabaseAccessError(l),[3,4];case 4:return[2]}})})},a.prototype.removeItem=function(o){return jt(this,void 0,void 0,function(){var i;return Lt(this,function(l){switch(l.label){case 0:this.inMemoryCache.removeItem(o),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(o)];case 2:return l.sent(),[3,4];case 3:return i=l.sent(),this.handleDatabaseAccessError(i),[3,4];case 4:return[2]}})})},a.prototype.getKeys=function(){return jt(this,void 0,void 0,function(){var o,i;return Lt(this,function(l){switch(l.label){case 0:if(0!==(o=this.inMemoryCache.getKeys()).length)return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,l.sent()];case 3:return i=l.sent(),this.handleDatabaseAccessError(i),[3,4];case 4:return[2,o]}})})},a.prototype.containsKey=function(o){return jt(this,void 0,void 0,function(){var i,l;return Lt(this,function(u){switch(u.label){case 0:if(i=this.inMemoryCache.containsKey(o))return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(o)];case 2:return[2,u.sent()];case 3:return l=u.sent(),this.handleDatabaseAccessError(l),[3,4];case 4:return[2,i]}})})},a.prototype.clearInMemory=function(){this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted")},a.prototype.clearPersistent=function(){return jt(this,void 0,void 0,function(){var o;return Lt(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),this.logger.verbose("Deleting persistent keystore"),[4,this.indexedDBCache.deleteDatabase()];case 1:return(o=i.sent())&&this.logger.verbose("Persistent keystore deleted"),[2,o];case 2:return o=i.sent(),this.handleDatabaseAccessError(o),[2,!1];case 3:return[2]}})})},a}(),ote=(function(a){a.asymmetricKeys="asymmetricKeys",a.symmetricKeys="symmetricKeys"}(oD=oD||{}),function(){function a(o){this.logger=o,this.asymmetricKeys=new u5(this.logger,oD.asymmetricKeys),this.symmetricKeys=new u5(this.logger,oD.symmetricKeys)}return a.prototype.clear=function(){return jt(this,void 0,void 0,function(){var o;return Lt(this,function(i){switch(i.label){case 0:this.asymmetricKeys.clearInMemory(),this.symmetricKeys.clearInMemory(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.asymmetricKeys.clearPersistent()];case 2:return i.sent(),[2,!0];case 3:return(o=i.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+o.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}})})},a}()),vae=function(){function a(o,i,l){this.logger=o,this.browserCrypto=new D7(this.logger,l),this.b64Encode=new Xee,this.b64Decode=new yae,this.guidGenerator=new C7(this.browserCrypto),this.pkceGenerator=new _ae(this.browserCrypto),this.cache=new ote(this.logger),this.performanceClient=i}return a.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},a.prototype.base64Encode=function(o){return this.b64Encode.encode(o)},a.prototype.base64Decode=function(o){return this.b64Decode.decode(o)},a.prototype.generatePkceCodes=function(){return jt(this,void 0,void 0,function(){return Lt(this,function(o){return[2,this.pkceGenerator.generateCodes()]})})},a.prototype.getPublicKeyThumbprint=function(o){var i;return jt(this,void 0,void 0,function(){var l,u,h,g,w;return Lt(this,function(T){switch(T.label){case 0:return l=null==(i=this.performanceClient)?void 0:i.startMeasurement(Ct.CryptoOptsGetPublicKeyThumbprint,o.correlationId),[4,this.browserCrypto.generateKeyPair(a.EXTRACTABLE,a.POP_KEY_USAGES)];case 1:return u=T.sent(),[4,this.browserCrypto.exportJwk(u.publicKey)];case 2:return g=T.sent(),g=v_.getSortedObjectString(g={e:g.e,kty:g.kty,n:g.n}),[4,this.hashString(g)];case 3:return h=T.sent(),[4,this.browserCrypto.exportJwk(u.privateKey)];case 4:return g=T.sent(),[4,this.browserCrypto.importJwk(g,!1,["sign"])];case 5:return w=T.sent(),[4,this.cache.asymmetricKeys.setItem(h,{privateKey:w,publicKey:u.publicKey,requestMethod:o.resourceRequestMethod,requestUri:o.resourceRequestUri})];case 6:return T.sent(),l&&l.endMeasurement({success:!0}),[2,h]}})})},a.prototype.removeTokenBindingKey=function(o){return jt(this,void 0,void 0,function(){return Lt(this,function(i){switch(i.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(o)];case 1:return i.sent(),[4,this.cache.asymmetricKeys.containsKey(o)];case 2:return[2,!i.sent()]}})})},a.prototype.clearKeystore=function(){return jt(this,void 0,void 0,function(){return Lt(this,function(o){switch(o.label){case 0:return[4,this.cache.clear()];case 1:return[2,o.sent()]}})})},a.prototype.signJwt=function(o,i,l){var u;return jt(this,void 0,void 0,function(){var h,g,w,T,D,P;return Lt(this,function(N){switch(N.label){case 0:return h=null==(u=this.performanceClient)?void 0:u.startMeasurement(Ct.CryptoOptsSignJwt,l),[4,this.cache.asymmetricKeys.getItem(i)];case 1:if(g=N.sent())return[4,this.browserCrypto.exportJwk(g.publicKey)];throw xn.createSigningKeyNotFoundInStorageError(i);case 2:return D=N.sent(),w=v_.getSortedObjectString(D),T=this.b64Encode.urlEncode(JSON.stringify({kid:i})),T=v7.getShrHeaderString({kid:T,alg:D.alg}),D=this.b64Encode.urlEncode(T),o.cnf={jwk:JSON.parse(w)},T=this.b64Encode.urlEncode(JSON.stringify(o)),D=v_.stringToArrayBuffer(w=D+"."+T),[4,this.browserCrypto.sign(g.privateKey,D)];case 3:return T=N.sent(),D=this.b64Encode.urlEncodeArr(new Uint8Array(T)),P=w+"."+D,h&&h.endMeasurement({success:!0}),[2,P]}})})},a.prototype.hashString=function(o){return jt(this,void 0,void 0,function(){var i;return Lt(this,function(l){switch(l.label){case 0:return[4,this.browserCrypto.sha256Digest(o)];case 1:return i=l.sent(),i=new Uint8Array(i),[2,this.b64Encode.urlEncodeArr(i)]}})})},a.POP_KEY_USAGES=["sign","verify"],a.EXTRACTABLE=!0,a}(),ste=function(){function a(o,i){this.correlationId=i,this.measureName=a.makeMeasureName(o,i),this.startMark=a.makeStartMark(o,i),this.endMark=a.makeEndMark(o,i)}return a.makeMeasureName=function(o,i){return"msal.measure."+o+"."+i},a.makeStartMark=function(o,i){return"msal.start."+o+"."+i},a.makeEndMark=function(o,i){return"msal.end."+o+"."+i},a.supportsBrowserPerformance=function(){return typeof window<"u"&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},a.flushMeasurements=function(o,i){if(a.supportsBrowserPerformance())try{i.forEach(function(l){l=a.makeMeasureName(l.name,o),0<window.performance.getEntriesByName(l,"measure").length&&(window.performance.clearMeasures(l),window.performance.clearMarks(a.makeStartMark(l,o)),window.performance.clearMarks(a.makeEndMark(l,o)))})}catch{}},a.prototype.startMeasurement=function(){if(a.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch{}},a.prototype.endMeasurement=function(){if(a.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch{}},a.prototype.flushMeasurement=function(){if(a.supportsBrowserPerformance())try{var o,i=window.performance.getEntriesByName(this.measureName,"measure");if(0<i.length)return o=i[0].duration,window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),o}catch{}return null},a}(),wae=function(a){function o(i,l,u,h,g,w,T){return(i=a.call(this,i,l,u,h,g,w)||this).browserCrypto=new D7(i.logger,T),i.guidGenerator=new C7(i.browserCrypto),i}return xl(o,a),o.prototype.startPerformanceMeasuremeant=function(i,l){return new ste(i,l)},o.prototype.generateId=function(){return this.guidGenerator.generateGuid()},o.prototype.getPageVisibility=function(){var i;return(null==(i=document.visibilityState)?void 0:i.toString())||null},o.prototype.deleteIncompleteSubMeasurements=function(i){var l=this.eventsByCorrelationId.get(i.event.correlationId),h=[];l&&l.eventId===i.event.eventId&&null!=l&&l.incompleteSubMeasurements&&l.incompleteSubMeasurements.forEach(function(g){h.push(Wn({},g))}),0<h.length&&ste.flushMeasurements(i.event.correlationId,h)},o.prototype.supportsBrowserPerformanceNow=function(){return typeof window<"u"&&void 0!==window.performance&&"function"==typeof window.performance.now},o.prototype.startMeasurement=function(i,l){var u=this,h=this.getPageVisibility(),g=a.prototype.startMeasurement.call(this,i,l);return Wn(Wn({},g),{endMeasurement:function(w){return w=g.endMeasurement(Wn({startPageVisibility:h,endPageVisibility:u.getPageVisibility()},w)),u.deleteIncompleteSubMeasurements(g),w},discardMeasurement:function(){g.discardMeasurement(),u.deleteIncompleteSubMeasurements(g),g.measurement.flushMeasurement()}})},o.prototype.setPreQueueTime=function(i,l){var u;this.supportsBrowserPerformanceNow()?l?((u=this.preQueueTimeByCorrelationId.get(l))&&(this.logger.trace("BrowserPerformanceClient: Incomplete pre-queue "+u.name+" found",l),this.addQueueMeasurement(u.name,l,void 0,!0)),this.preQueueTimeByCorrelationId.set(l,{name:i,time:window.performance.now()})):this.logger.trace("BrowserPerformanceClient: correlationId for "+i+" not provided, unable to set telemetry queue time"):this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for "+i)},o.prototype.addQueueMeasurement=function(i,l,u,h){if(this.supportsBrowserPerformanceNow())if(l){var g,w=a.prototype.getPreQueueTime.call(this,i,l);if(w)return g=window.performance.now(),u=u||a.prototype.calculateQueuedTime.call(this,w,g),a.prototype.addQueueMeasurement.call(this,i,l,u,h)}else this.logger.trace("BrowserPerformanceClient: correlationId for "+i+" not provided, unable to add queue measurement");else this.logger.trace("BrowserPerformanceClient: window performance API not available, unable to add queue measurement for "+i)},o}(hw),bae=function(){function a(o,i,l,u){this.isBrowserEnvironment=typeof window<"u",this.config=o,this.storage=i,this.logger=l,this.cryptoObj=u}return a.prototype.loadExternalTokens=function(o,i,l){if(this.logger.info("TokenCache - loadExternalTokens called"),!i.id_token)throw xn.createUnableToLoadTokenError("Please ensure server response includes id token.");var u=new Bf(i.id_token,this.cryptoObj);if(o.account)var h=this.loadAccount(u,o.account.environment,void 0,void 0,o.account.homeAccountId),g=new _N(h,this.loadIdToken(u,h.homeAccountId,o.account.environment,o.account.tenantId),this.loadAccessToken(o,i,h.homeAccountId,o.account.environment,o.account.tenantId,l),this.loadRefreshToken(o,i,h.homeAccountId,o.account.environment));else{if(!o.authority)throw xn.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var T=Zx.generateAuthority(o.authority,o.azureCloudOptions);if(T=new Zx(T,this.config.system.networkClient,this.storage,{protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},this.logger),l.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),h=this.loadAccount(u,T.hostnameAndPort,l.clientInfo,T.authorityType);else{if(!i.client_info)throw xn.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response"),h=this.loadAccount(u,T.hostnameAndPort,i.client_info,T.authorityType)}g=new _N(h,this.loadIdToken(u,h.homeAccountId,T.hostnameAndPort,T.tenant),this.loadAccessToken(o,i,h.homeAccountId,T.hostnameAndPort,T.tenant,l),this.loadRefreshToken(o,i,h.homeAccountId,T.hostnameAndPort))}return this.generateAuthenticationResult(o,u,g,T)},a.prototype.loadAccount=function(o,i,l,u,h){var g;if(h?g=h:void 0!==u&&l&&(g=Ac.generateHomeAccountId(l,u,this.logger,this.cryptoObj,o)),!g)throw xn.createUnableToLoadTokenError("Unexpected missing homeAccountId");if(h=l?Ac.createAccount(l,g,o,void 0,void 0,void 0,i):Ac.createGenericAccount(g,o,void 0,void 0,void 0,i),this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading account"),this.storage.setAccount(h),h;throw xn.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},a.prototype.loadIdToken=function(o,i,l,u){if(i=qx.createIdTokenEntity(i,l,o.rawToken,this.config.auth.clientId,u),this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading id token"),this.storage.setIdTokenCredential(i),i;throw xn.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},a.prototype.loadAccessToken=function(w,i,P,u,h,D){if(!i.access_token)return this.logger.verbose("TokenCache - No access token provided for caching"),null;if(!i.expires_in)throw xn.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!D.extendedExpiresOn)throw xn.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");w=new au(w.scopes).printScopes();var T=D.expiresOn||i.expires_in+(new Date).getTime()/1e3;if(P=g_.createAccessTokenEntity(P,u,i.access_token,this.config.auth.clientId,h,w,T,D=D.extendedExpiresOn,this.cryptoObj),this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(P),P;throw xn.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},a.prototype.loadRefreshToken=function(o,i,l,u){if(!i.refresh_token)return this.logger.verbose("TokenCache - No refresh token provided for caching"),null;if(l=_g.createRefreshTokenEntity(l,u,i.refresh_token,this.config.auth.clientId),this.isBrowserEnvironment)return this.logger.verbose("TokenCache - loading refresh token"),this.storage.setRefreshTokenCredential(l),l;throw xn.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.")},a.prototype.generateAuthenticationResult=function(o,i,l,u){var h,g=je.EMPTY_STRING,w=[],T=null,D=(null!=l&&l.accessToken&&(g=l.accessToken.secret,w=au.fromString(l.accessToken.target).asArray(),T=new Date(1e3*Number(l.accessToken.expiresOn)),h=new Date(1e3*Number(l.accessToken.extendedExpiresOn))),i?.claims.oid||i?.claims.sub||je.EMPTY_STRING),P=i?.claims.tid||je.EMPTY_STRING;return{authority:u?u.canonicalAuthority:je.EMPTY_STRING,uniqueId:D,tenantId:P,scopes:w,account:null!=l&&l.account?l.account.getAccountInfo():null,idToken:i?i.rawToken:je.EMPTY_STRING,idTokenClaims:i?i.claims:{},accessToken:g,fromCache:!0,expiresOn:T,correlationId:o.correlationId||je.EMPTY_STRING,requestId:je.EMPTY_STRING,extExpiresOn:h,familyId:je.EMPTY_STRING,tokenType:(null==(u=l?.accessToken)?void 0:u.tokenType)||je.EMPTY_STRING,state:je.EMPTY_STRING,cloudGraphHostName:(null==(D=l?.account)?void 0:D.cloudGraphHostName)||je.EMPTY_STRING,msGraphHost:(null==(P=l?.account)?void 0:P.msGraphHost)||je.EMPTY_STRING,code:void 0,fromNativeBroker:!1}},a}(),Eae=function(a){function o(i){return(i=a.call(this,i)||this).includeRedirectUri=!1,i}return xl(o,a),o}(nD),xae=function(a){function o(i,l,u,h,g,w,T,D,P,N){return(i=a.call(this,i,l,u,h,g,w,D,P,N)||this).apiId=T,i}return xl(o,a),o.prototype.acquireToken=function(i){return jt(this,void 0,void 0,function(){var l,u,h,g;return Lt(this,function(w){switch(w.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),i.code)return this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientInitializeAuthorizationRequest,i.correlationId),[4,this.initializeAuthorizationRequest(i,Jn.Silent)];throw xn.createAuthCodeRequiredError();case 1:l=w.sent(),this.browserStorage.updateCacheEntries(l.state,l.nonce,l.authority,l.loginHint||je.EMPTY_STRING,l.account||null),u=this.initializeServerTelemetryManager(this.apiId),w.label=2;case 2:return w.trys.push([2,4,,5]),h=Wn(Wn({},l),{code:i.code}),this.performanceClient.setPreQueueTime(Ct.StandardInteractionClientGetClientConfiguration,i.correlationId),[4,this.getClientConfiguration(u,l.authority)];case 3:return g=w.sent(),g=new Eae(g),this.logger.verbose("Auth code client created"),[2,new AN(g,this.browserStorage,h,this.logger,this.config.system,this.performanceClient).handleCodeResponseFromServer({code:i.code,msgraph_host:i.msGraphHost,cloud_graph_host_name:i.cloudGraphHostName,cloud_instance_host_name:i.cloudInstanceHostName},l.state,g.authority,this.networkClient,!1)];case 4:throw(g=w.sent())instanceof dr&&g.setCorrelationId(this.correlationId),u.cacheFailedRequest(g),this.browserStorage.cleanRequestByState(l.state),g;case 5:return[2]}})})},o.prototype.logout=function(){return Promise.reject(xn.createSilentLogoutUnsupportedError())},o}(Jx),Ns=function(){function a(o){this.isBrowserEnvironment=typeof window<"u",this.config=function T7(u,w){var i=u.auth,l=u.cache,T=u.system,h=(u=u.telemetry,{clientId:je.EMPTY_STRING,authority:""+je.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:je.EMPTY_STRING,authorityMetadata:je.EMPTY_STRING,redirectUri:je.EMPTY_STRING,postLogoutRedirectUri:je.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:rD.AAD,azureCloudOptions:{azureCloudInstance:Bx.None,tenant:je.EMPTY_STRING},skipAuthorityMetadataCache:!1}),g={cacheLocation:Ba.SessionStorage,temporaryCacheLocation:Ba.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!l||l.cacheLocation!==Ba.LocalStorage),claimsBasedCachingEnabled:!0},D={loggerCallback:function(){},logLevel:Js.Info,piiLoggingEnabled:!1};return w=Wn(Wn({},a7),{loggerOptions:D,networkClient:w?ea.getBrowserNetworkClient():Hee,navigationClient:new Eg,loadFrameTimeout:0,windowHashTimeout:T?.loadFrameTimeout||6e4,iframeHashTimeout:T?.loadFrameTimeout||6e3,navigateFrameWait:w&&ea.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:T?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:30,cryptoOptions:{useMsrCrypto:!1,entropy:void 0}}),T=Wn(Wn({},T),{loggerOptions:T?.loggerOptions||D}),D={application:{appName:je.EMPTY_STRING,appVersion:je.EMPTY_STRING}},{auth:Wn(Wn({},h),i),cache:Wn(Wn({},g),l),system:Wn(Wn({},w),T),telemetry:Wn(Wn({},D),u)}}(o,this.isBrowserEnvironment),this.initialized=!1,this.logger=new fN(this.config.system.loggerOptions,a5,iD),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new wae(this.config.auth.clientId,this.config.auth.authority,this.logger,a5,iD,this.config.telemetry.application,this.config.system.cryptoOptions):new $ee(this.config.auth.clientId,this.config.auth.authority,this.logger,a5,iD,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new vae(this.logger,this.performanceClient,this.config.system.cryptoOptions):jx,this.eventHandler=new gae(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new s5(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):function(a,o){return new s5(a,{cacheLocation:Ba.MemoryStorage,temporaryCacheLocation:Ba.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0},jx,o)}(this.config.auth.clientId,this.logger),this.nativeInternalStorage=new s5(this.config.auth.clientId,o={cacheLocation:Ba.MemoryStorage,temporaryCacheLocation:Ba.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!0},this.browserCrypto,this.logger),this.tokenCache=new bae(this.config,this.browserStorage,this.logger,this.browserCrypto),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}return a.prototype.initialize=function(){return jt(this,void 0,void 0,function(){var o,i,l,u,h;return Lt(this,function(g){switch(g.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.info("initialize has already been called, exiting early."),[2];if(o=this.config.system.allowNativeBroker,i=this.performanceClient.startMeasurement(Ct.InitializeClientApplication),this.eventHandler.emitEvent(zr.INITIALIZE_START),!o)return[3,4];g.label=1;case 1:return g.trys.push([1,3,,4]),l=this,[4,__.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)];case 2:return l.nativeExtensionProvider=g.sent(),[3,4];case 3:return u=g.sent(),this.logger.verbose(u),[3,4];case 4:return this.config.cache.claimsBasedCachingEnabled?[3,6]:(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),h=this.performanceClient.startMeasurement(Ct.ClearTokensAndKeysWithClaims),[4,this.browserStorage.clearTokensAndKeysWithClaims()]);case 5:g.sent(),h.endMeasurement({success:!0}),g.label=6;case 6:return this.initialized=!0,this.eventHandler.emitEvent(zr.INITIALIZE_END),i.endMeasurement({allowNativeBroker:o,success:!0}),[2]}})})},a.prototype.handleRedirectPromise=function(o){return jt(this,void 0,void 0,function(){var i,l,u,h,g,w=this;return Lt(this,function(T){return this.logger.verbose("handleRedirectPromise called"),ea.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),i=this.getAllAccounts(),this.isBrowserEnvironment?(void 0===(u=this.redirectResponse.get(l=o||je.EMPTY_STRING))?(this.eventHandler.emitEvent(zr.HANDLE_REDIRECT_START,Jn.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),g=this.browserStorage.getCachedNativeRequest(),h=void 0,h=g&&__.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!o?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),new y_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,xs.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,g.accountId,this.nativeInternalStorage,g.correlationId).handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),g=this.browserStorage.getTemporaryCache(co.CORRELATION_ID,!0)||je.EMPTY_STRING,this.createRedirectClient(g).handleRedirectPromise(o)),u=h.then(function(D){return D&&(i.length<w.getAllAccounts().length?(w.eventHandler.emitEvent(zr.LOGIN_SUCCESS,Jn.Redirect,D),w.logger.verbose("handleRedirectResponse returned result, login success")):(w.eventHandler.emitEvent(zr.ACQUIRE_TOKEN_SUCCESS,Jn.Redirect,D),w.logger.verbose("handleRedirectResponse returned result, acquire token success"))),w.eventHandler.emitEvent(zr.HANDLE_REDIRECT_END,Jn.Redirect),D}).catch(function(D){throw w.eventHandler.emitEvent(0<i.length?zr.ACQUIRE_TOKEN_FAILURE:zr.LOGIN_FAILURE,Jn.Redirect,null,D),w.eventHandler.emitEvent(zr.HANDLE_REDIRECT_END,Jn.Redirect),D}),this.redirectResponse.set(l,u)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,u]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])})})},a.prototype.acquireTokenRedirect=function(o){return jt(this,void 0,void 0,function(){var i,l,u=this;return Lt(this,function(h){return i=this.getRequestCorrelationId(o),this.logger.verbose("acquireTokenRedirect called",i),this.preflightBrowserEnvironmentCheck(Jn.Redirect),(l=0<this.getAllAccounts().length)?this.eventHandler.emitEvent(zr.ACQUIRE_TOKEN_START,Jn.Redirect,o):this.eventHandler.emitEvent(zr.LOGIN_START,Jn.Redirect,o),[2,(this.nativeExtensionProvider&&this.canUseNative(o)?new y_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,xs.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(o),this.nativeInternalStorage,o.correlationId).acquireTokenRedirect(o).catch(function(g){if(g instanceof bg&&g.isFatal())return u.nativeExtensionProvider=void 0,u.createRedirectClient(o.correlationId).acquireToken(o);if(g instanceof yd)return u.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),u.createRedirectClient(o.correlationId).acquireToken(o);throw u.browserStorage.setInteractionInProgress(!1),g}):this.createRedirectClient(o.correlationId).acquireToken(o)).catch(function(g){throw u.eventHandler.emitEvent(l?zr.ACQUIRE_TOKEN_FAILURE:zr.LOGIN_FAILURE,Jn.Redirect,null,g),g})]})})},a.prototype.acquireTokenPopup=function(o){var i=this,l=this.getRequestCorrelationId(o),u=this.performanceClient.startMeasurement(Ct.AcquireTokenPopup,l);try{this.logger.verbose("acquireTokenPopup called",l),this.preflightBrowserEnvironmentCheck(Jn.Popup)}catch(g){return Promise.reject(g)}var h=this.getAllAccounts();return this.eventHandler.emitEvent(0<h.length?zr.ACQUIRE_TOKEN_START:zr.LOGIN_START,Jn.Popup,o),(this.canUseNative(o)?this.acquireTokenNative(o,xs.acquireTokenPopup).then(function(g){return i.browserStorage.setInteractionInProgress(!1),u.endMeasurement({success:!0,isNativeBroker:!0,requestId:g.requestId}),g}).catch(function(g){if(g instanceof bg&&g.isFatal())return i.nativeExtensionProvider=void 0,i.createPopupClient(o.correlationId).acquireToken(o);if(g instanceof yd)return i.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),i.createPopupClient(o.correlationId).acquireToken(o);throw i.browserStorage.setInteractionInProgress(!1),g}):this.createPopupClient(o.correlationId).acquireToken(o)).then(function(g){return h.length<i.getAllAccounts().length?i.eventHandler.emitEvent(zr.LOGIN_SUCCESS,Jn.Popup,g):i.eventHandler.emitEvent(zr.ACQUIRE_TOKEN_SUCCESS,Jn.Popup,g),u.addStaticFields({accessTokenSize:g.accessToken.length,idTokenSize:g.idToken.length}),u.endMeasurement({success:!0,requestId:g.requestId}),g}).catch(function(g){return i.eventHandler.emitEvent(0<h.length?zr.ACQUIRE_TOKEN_FAILURE:zr.LOGIN_FAILURE,Jn.Popup,null,g),u.endMeasurement({errorCode:g.errorCode,subErrorCode:g.subError,success:!1}),Promise.reject(g)})},a.prototype.trackPageVisibilityWithMeasurement=function(){var o=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;o&&(this.logger.info("Perf: Visibility change detected in ",o.event.name),o.increment({visibilityChangeCount:1}))},a.prototype.ssoSilent=function(o){var i;return jt(this,void 0,void 0,function(){var l,u,h=this;return Lt(this,function(g){return l=this.getRequestCorrelationId(o),u=Wn(Wn({},o),{prompt:o.prompt,correlationId:l}),this.preflightBrowserEnvironmentCheck(Jn.Silent),this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Ct.SsoSilent,l),null!=(i=this.ssoSilentMeasurement)&&i.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",l),this.eventHandler.emitEvent(zr.SSO_SILENT_START,Jn.Silent,u),[2,(this.canUseNative(u)?this.acquireTokenNative(u,xs.ssoSilent).catch(function(w){if(w instanceof bg&&w.isFatal())return h.nativeExtensionProvider=void 0,h.createSilentIframeClient(u.correlationId).acquireToken(u);throw w}):this.createSilentIframeClient(u.correlationId).acquireToken(u)).then(function(w){var T;return h.eventHandler.emitEvent(zr.SSO_SILENT_SUCCESS,Jn.Silent,w),null!=(T=h.ssoSilentMeasurement)&&T.addStaticFields({accessTokenSize:w.accessToken.length,idTokenSize:w.idToken.length}),null!=(T=h.ssoSilentMeasurement)&&T.endMeasurement({success:!0,isNativeBroker:w.fromNativeBroker,requestId:w.requestId}),w}).catch(function(w){var T;throw h.eventHandler.emitEvent(zr.SSO_SILENT_FAILURE,Jn.Silent,null,w),null!=(T=h.ssoSilentMeasurement)&&T.endMeasurement({errorCode:w.errorCode,subErrorCode:w.subError,success:!1}),w}).finally(function(){document.removeEventListener("visibilitychange",h.trackPageVisibilityWithMeasurement)})]})})},a.prototype.acquireTokenByCode=function(o){return jt(this,void 0,void 0,function(){var i,l,u,h,g=this;return Lt(this,function(w){i=this.getRequestCorrelationId(o),this.preflightBrowserEnvironmentCheck(Jn.Silent),this.logger.trace("acquireTokenByCode called",i),this.eventHandler.emitEvent(zr.ACQUIRE_TOKEN_BY_CODE_START,Jn.Silent,o),l=this.performanceClient.startMeasurement(Ct.AcquireTokenByCode,o.correlationId);try{if(o.code&&o.nativeAccountId)throw xn.createSpaCodeAndNativeAccountIdPresentError();if(o.code)return(h=this.hybridAuthCodeResponses.get(u=o.code))?(this.logger.verbose("Existing acquireTokenByCode request found",o.correlationId),l.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",i),h=this.acquireTokenByCodeAsync(Wn(Wn({},o),{correlationId:i})).then(function(T){return g.eventHandler.emitEvent(zr.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Jn.Silent,T),g.hybridAuthCodeResponses.delete(u),l.addStaticFields({accessTokenSize:T.accessToken.length,idTokenSize:T.idToken.length}),l.endMeasurement({success:!0,isNativeBroker:T.fromNativeBroker,requestId:T.requestId}),T}).catch(function(T){throw g.hybridAuthCodeResponses.delete(u),g.eventHandler.emitEvent(zr.ACQUIRE_TOKEN_BY_CODE_FAILURE,Jn.Silent,null,T),l.endMeasurement({errorCode:T.errorCode,subErrorCode:T.subError,success:!1}),T}),this.hybridAuthCodeResponses.set(u,h)),[2,h];if(o.nativeAccountId){if(this.canUseNative(o,o.nativeAccountId))return[2,this.acquireTokenNative(o,xs.acquireTokenByCode,o.nativeAccountId).catch(function(T){throw T instanceof bg&&T.isFatal()&&(g.nativeExtensionProvider=void 0),T})];throw xn.createUnableToAcquireTokenFromNativePlatformError()}throw xn.createAuthCodeOrNativeAccountIdRequiredError()}catch(T){throw this.eventHandler.emitEvent(zr.ACQUIRE_TOKEN_BY_CODE_FAILURE,Jn.Silent,null,T),l.endMeasurement({errorCode:T instanceof dr&&T.errorCode||void 0,subErrorCode:T instanceof dr&&T.subError||void 0,success:!1}),T}return[2]})})},a.prototype.acquireTokenByCodeAsync=function(o){var i;return jt(this,void 0,void 0,function(){var l=this;return Lt(this,function(u){switch(u.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",o.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Ct.AcquireTokenByCodeAsync,o.correlationId),null!=(i=this.acquireTokenByCodeAsyncMeasurement)&&i.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),[4,this.createSilentAuthCodeClient(o.correlationId).acquireToken(o).then(function(h){var g;return null!=(g=l.acquireTokenByCodeAsyncMeasurement)&&g.endMeasurement({success:!0,fromCache:h.fromCache,isNativeBroker:h.fromNativeBroker,requestId:h.requestId}),h}).catch(function(h){var g;throw null!=(g=l.acquireTokenByCodeAsyncMeasurement)&&g.endMeasurement({errorCode:h.errorCode,subErrorCode:h.subError,success:!1}),h}).finally(function(){document.removeEventListener("visibilitychange",l.trackPageVisibilityWithMeasurement)})];case 1:return[2,u.sent()]}})})},a.prototype.acquireTokenFromCache=function(o,i,l){return jt(this,void 0,void 0,function(){return Lt(this,function(u){switch(this.performanceClient.addQueueMeasurement(Ct.AcquireTokenFromCache,i.correlationId),l.cacheLookupPolicy){case qu.Default:case qu.AccessToken:case qu.AccessTokenAndRefreshToken:return[2,o.acquireToken(i)];default:throw Vn.createRefreshRequiredError()}return[2]})})},a.prototype.acquireTokenByRefreshToken=function(o,i){return jt(this,void 0,void 0,function(){var l;return Lt(this,function(u){switch(this.performanceClient.addQueueMeasurement(Ct.AcquireTokenByRefreshToken,o.correlationId),i.cacheLookupPolicy){case qu.Default:case qu.AccessTokenAndRefreshToken:case qu.RefreshToken:case qu.RefreshTokenAndNetwork:return l=this.createSilentRefreshClient(o.correlationId),this.performanceClient.setPreQueueTime(Ct.SilentRefreshClientAcquireToken,o.correlationId),[2,l.acquireToken(o)];default:throw Vn.createRefreshRequiredError()}return[2]})})},a.prototype.acquireTokenBySilentIframe=function(o){return jt(this,void 0,void 0,function(){var i;return Lt(this,function(l){return this.performanceClient.addQueueMeasurement(Ct.AcquireTokenBySilentIframe,o.correlationId),i=this.createSilentIframeClient(o.correlationId),this.performanceClient.setPreQueueTime(Ct.SilentIframeClientAcquireToken,o.correlationId),[2,i.acquireToken(o)]})})},a.prototype.logout=function(o){return jt(this,void 0,void 0,function(){var i;return Lt(this,function(l){return i=this.getRequestCorrelationId(o),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",i),[2,this.logoutRedirect(Wn({correlationId:i},o))]})})},a.prototype.logoutRedirect=function(o){return jt(this,void 0,void 0,function(){var i;return Lt(this,function(l){return i=this.getRequestCorrelationId(o),this.preflightBrowserEnvironmentCheck(Jn.Redirect),[2,this.createRedirectClient(i).logout(o)]})})},a.prototype.logoutPopup=function(o){try{var i=this.getRequestCorrelationId(o);return this.preflightBrowserEnvironmentCheck(Jn.Popup),this.createPopupClient(i).logout(o)}catch(l){return Promise.reject(l)}},a.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},a.prototype.getAccountByUsername=function(o){var i;return this.logger.trace("getAccountByUsername called"),o?(i=this.browserStorage.getAccountInfoFilteredBy({username:o}))?(this.logger.verbose("getAccountByUsername: Account matching username found, returning"),this.logger.verbosePii("getAccountByUsername: Returning signed-in accounts matching username: "+o),i):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null):(this.logger.warning("getAccountByUsername: No username provided"),null)},a.prototype.getAccountByHomeId=function(o){var i;return this.logger.trace("getAccountByHomeId called"),o?(i=this.browserStorage.getAccountInfoFilteredBy({homeAccountId:o}))?(this.logger.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),this.logger.verbosePii("getAccountByHomeId: Returning signed-in accounts matching homeAccountId: "+o),i):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null):(this.logger.warning("getAccountByHomeId: No homeAccountId provided"),null)},a.prototype.getAccountByLocalId=function(o){var i;return this.logger.trace("getAccountByLocalId called"),o?(i=this.browserStorage.getAccountInfoFilteredBy({localAccountId:o}))?(this.logger.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),this.logger.verbosePii("getAccountByLocalId: Returning signed-in accounts matching localAccountId: "+o),i):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null):(this.logger.warning("getAccountByLocalId: No localAccountId provided"),null)},a.prototype.setActiveAccount=function(o){this.browserStorage.setActiveAccount(o)},a.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},a.prototype.preflightBrowserEnvironmentCheck=function(o,i){if(void 0===i&&(i=!0),this.logger.verbose("preflightBrowserEnvironmentCheck started"),ea.blockNonBrowserEnvironment(this.isBrowserEnvironment),ea.blockRedirectInIframe(o,this.config.system.allowRedirectInIframe),ea.blockReloadInHiddenIframes(),ea.blockAcquireTokenInPopups(),ea.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),o===Jn.Redirect&&this.config.cache.cacheLocation===Ba.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw CN.createInMemoryRedirectUnavailableError();o!==Jn.Redirect&&o!==Jn.Popup||this.preflightInteractiveRequest(i)},a.prototype.preflightInteractiveRequest=function(o){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),ea.blockReloadInHiddenIframes(),o&&this.browserStorage.setInteractionInProgress(!0)},a.prototype.acquireTokenNative=function(o,i,l){return jt(this,void 0,void 0,function(){return Lt(this,function(u){if(this.logger.trace("acquireTokenNative called"),this.nativeExtensionProvider)return[2,new y_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,i,this.performanceClient,this.nativeExtensionProvider,l||this.getNativeAccountId(o),this.nativeInternalStorage,o.correlationId).acquireToken(o)];throw xn.createNativeConnectionNotEstablishedError()})})},a.prototype.canUseNative=function(o,i){if(this.logger.trace("canUseNative called"),!__.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,o.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(o.prompt)switch(o.prompt){case ic.NONE:case ic.CONSENT:case ic.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+o.prompt+" is not compatible with native flow, returning false"),!1}return!(!i&&!this.getNativeAccountId(o)&&(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),1))},a.prototype.getNativeAccountId=function(o){return(o=o.account||this.browserStorage.getAccountInfoByHints(o.loginHint,o.sid)||this.getActiveAccount())&&o.nativeAccountId||""},a.prototype.createPopupClient=function(o){return new E7(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,o)},a.prototype.createRedirectClient=function(o){return new pae(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,o)},a.prototype.createSilentIframeClient=function(o){return new Zee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,xs.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,o)},a.prototype.createSilentCacheClient=function(o){return new b7(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,o)},a.prototype.createSilentRefreshClient=function(o){return new Qee(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,o)},a.prototype.createSilentAuthCodeClient=function(o){return new xae(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,xs.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,o)},a.prototype.addEventCallback=function(o){return this.eventHandler.addEventCallback(o)},a.prototype.removeEventCallback=function(o){this.eventHandler.removeEventCallback(o)},a.prototype.addPerformanceCallback=function(o){return this.performanceClient.addPerformanceCallback(o)},a.prototype.removePerformanceCallback=function(o){return this.performanceClient.removePerformanceCallback(o)},a.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},a.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},a.prototype.getTokenCache=function(){return this.tokenCache},a.prototype.getLogger=function(){return this.logger},a.prototype.setLogger=function(o){this.logger=o},a.prototype.initializeWrapperLibrary=function(o,i){this.browserStorage.setWrapperMetadata(o,i)},a.prototype.setNavigationClient=function(o){this.navigationClient=o},a.prototype.getConfiguration=function(){return this.config},a.prototype.getRequestCorrelationId=function(o){return null!=o&&o.correlationId?o.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():je.EMPTY_STRING},a}(),P7=function(a){function o(i){return(i=a.call(this,i)||this).astsAsyncMeasurement=void 0,i.activeSilentTokenRequests=new Map,i.trackPageVisibility=i.trackPageVisibility.bind(i),i}return xl(o,a),o.prototype.loginRedirect=function(i){return jt(this,void 0,void 0,function(){var l;return Lt(this,function(u){return l=this.getRequestCorrelationId(i),this.logger.verbose("loginRedirect called",l),[2,this.acquireTokenRedirect(Wn({correlationId:l},i||r5))]})})},o.prototype.loginPopup=function(i){var l=this.getRequestCorrelationId(i);return this.logger.verbose("loginPopup called",l),this.acquireTokenPopup(Wn({correlationId:l},i||r5))},o.prototype.acquireTokenSilent=function(i){return jt(this,void 0,void 0,function(){var l,u,h,g,w,T=this;return Lt(this,function(D){if(l=this.getRequestCorrelationId(i),(u=this.performanceClient.startMeasurement(Ct.AcquireTokenSilent,l)).addStaticFields({cacheLookupPolicy:i.cacheLookupPolicy}),this.preflightBrowserEnvironmentCheck(Jn.Silent),this.logger.verbose("acquireTokenSilent called",l),w=i.account||this.getActiveAccount())return g={clientId:this.config.auth.clientId,authority:i.authority||je.EMPTY_STRING,scopes:i.scopes,homeAccountIdentifier:w.homeAccountId,claims:i.claims,authenticationScheme:i.authenticationScheme,resourceRequestMethod:i.resourceRequestMethod,resourceRequestUri:i.resourceRequestUri,shrClaims:i.shrClaims,sshKid:i.sshKid},h=JSON.stringify(g),void 0===(g=this.activeSilentTokenRequests.get(h))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",l),this.performanceClient.setPreQueueTime(Ct.AcquireTokenSilentAsync,l),w=this.acquireTokenSilentAsync(Wn(Wn({},i),{correlationId:l}),w).then(function(P){return T.activeSilentTokenRequests.delete(h),u.addStaticFields({accessTokenSize:P.accessToken.length,idTokenSize:P.idToken.length}),u.endMeasurement({success:!0,fromCache:P.fromCache,isNativeBroker:P.fromNativeBroker,cacheLookupPolicy:i.cacheLookupPolicy,requestId:P.requestId}),P}).catch(function(P){throw T.activeSilentTokenRequests.delete(h),u.endMeasurement({errorCode:P.errorCode,subErrorCode:P.subError,success:!1}),P}),this.activeSilentTokenRequests.set(h,w),[2,w]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",l),u.discardMeasurement(),[2,g]);throw xn.createNoAccountError()})})},o.prototype.trackPageVisibility=function(){this.astsAsyncMeasurement&&(this.logger.info("Perf: Visibility change detected"),this.astsAsyncMeasurement.increment({visibilityChangeCount:1}))},o.prototype.acquireTokenSilentAsync=function(i,l){var u;return jt(this,void 0,void 0,function(){var h,g,w,T,D=this;return Lt(this,function(P){switch(P.label){case 0:return this.performanceClient.addQueueMeasurement(Ct.AcquireTokenSilentAsync,i.correlationId),this.eventHandler.emitEvent(zr.ACQUIRE_TOKEN_START,Jn.Silent,i),this.astsAsyncMeasurement=this.performanceClient.startMeasurement(Ct.AcquireTokenSilentAsync,i.correlationId),null!=(u=this.astsAsyncMeasurement)&&u.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibility),__.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,i.authenticationScheme)&&l.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),h=Wn(Wn({},i),{account:l}),h=this.acquireTokenNative(h,xs.acquireTokenSilent_silentFlow).catch(function(N){return jt(D,void 0,void 0,function(){return Lt(this,function(z){if(N instanceof bg&&N.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(i.correlationId).acquireToken(i)];throw N})})}),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),g=this.createSilentCacheClient(i.correlationId),this.performanceClient.setPreQueueTime(Ct.InitializeSilentRequest,i.correlationId),[4,g.initializeSilentRequest(i,l)];case 2:w=P.sent(),T=Wn(Wn({},i),{cacheLookupPolicy:i.cacheLookupPolicy||qu.Default}),this.performanceClient.setPreQueueTime(Ct.AcquireTokenFromCache,w.correlationId),h=this.acquireTokenFromCache(g,w,T).catch(function(N){if(T.cacheLookupPolicy===qu.AccessToken)throw N;return ea.blockReloadInHiddenIframes(),D.eventHandler.emitEvent(zr.ACQUIRE_TOKEN_NETWORK_START,Jn.Silent,w),D.performanceClient.setPreQueueTime(Ct.AcquireTokenByRefreshToken,w.correlationId),D.acquireTokenByRefreshToken(w,T).catch(function(z){if(z instanceof bp&&"invalid_grant"===z.errorCode&&!(z instanceof yd)&&T.cacheLookupPolicy!==qu.AccessTokenAndRefreshToken&&T.cacheLookupPolicy!==qu.RefreshToken||T.cacheLookupPolicy===qu.Skip||z.errorCode===Gx_noTokensFoundError_code)return D.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",i.correlationId),D.performanceClient.setPreQueueTime(Ct.AcquireTokenBySilentIframe,w.correlationId),D.acquireTokenBySilentIframe(w);throw z})}),P.label=3;case 3:return[2,h.then(function(N){var z;return D.eventHandler.emitEvent(zr.ACQUIRE_TOKEN_SUCCESS,Jn.Silent,N),null!=(z=D.astsAsyncMeasurement)&&z.endMeasurement({success:!0,fromCache:N.fromCache,isNativeBroker:N.fromNativeBroker,requestId:N.requestId}),N}).catch(function(N){var z;throw D.eventHandler.emitEvent(zr.ACQUIRE_TOKEN_FAILURE,Jn.Silent,null,N),null!=(z=D.astsAsyncMeasurement)&&z.endMeasurement({errorCode:N.errorCode,subErrorCode:N.subError,success:!1}),N}).finally(function(){document.removeEventListener("visibilitychange",D.trackPageVisibility)})]}})})},o}(Ns);function DN(a){this.message=a}(DN.prototype=new Error).name="InvalidCharacterError";var Ze=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(a){var o=String(a).replace(/=+$/,"");if(o.length%4==1)throw new DN("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,l,u=0,h=0,g="";l=o.charAt(h++);~l&&(i=u%4?64*i+l:l,u++%4)&&(g+=String.fromCharCode(255&i>>(-2*u&6))))l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(l);return g};function PN(a){this.message=a}(PN.prototype=new Error).name="InvalidTokenError";var R7=function(){function a(o){var i=this,l=(this.fallbackStorage={},this._triggerTokenFetch=function(u){return void 0===u&&(u=!1),new Promise(function(h,g){"function"!=typeof i.options.getToken?g(new Error("Token cannot be ".concat(u?"fetched":"renewed"," because getToken was not set or is not a function."))):i.options.getToken(function(w){try{var T=i._getTokenExpiry(w)-a.constants.tokenRefreshClockSkew;i._storeToken(w),i._setTimeoutTokenFetch(T),h()}catch{g(new Error("Invalid token returned by getToken function"))}},function(w){g(w)},i.map)})},this._setTimeoutTokenFetch=function(u){clearTimeout(i.tokenTimeOutHandle),i.tokenTimeOutHandle=setTimeout(i._triggerTokenFetch,Math.min(1e3*u,2147483647))},o.getServiceOptions());this.options=l.authOptions,this.sessionId=l.sessionId,this.map=o}return a.prototype.initialize=function(){var o=this;return this.initPromise||(this.initPromise=new Promise(function(i,l){if(o.options.authType===so.subscriptionKey)i();else if(o.options.authType===so.aad)o.options.authContext=o.options.authContext||a.getDefaultAuthContext(o.options),o.options.authContext.handleRedirectPromise().then(function(){setTimeout(function(){return o._loginAndAcquireTokenForAAD(i,l)})}).catch(function(h){l(new Error("Error logging in the AAD users: "+h))});else if(o.options.authType===so.anonymous)i(o._triggerTokenFetch(!0));else if(o.options.authType===so.sas){if(o.options.sasToken){var u=-1;try{u=o._getTokenExpiry(o.options.sasToken)}catch{return void l(new Error("An invalid sasToken was provided."))}if(u>a.constants.tokenRefreshClockSkew)return o._storeToken(o.options.sasToken),o._setTimeoutTokenFetch(u-a.constants.tokenRefreshClockSkew),void i()}i(o._triggerTokenFetch())}else l(new Error("An invalid authentication type was specified."))})),this.initPromise},a.prototype.dispose=function(){this.tokenTimeOutHandle&&(clearTimeout(this.tokenTimeOutHandle),this.tokenTimeOutHandle=null)},a.getDefaultAuthContext=function(o){if(!o.aadAppId)throw new Error("No AAD app ID was specified.");if(o.aadTenant)return this.defaultAuthContext||(this.defaultAuthContext=new P7({auth:{authority:"".concat(o.aadInstance||mc.aadInstance).concat(o.aadTenant),clientId:o.aadAppId},cache:{cacheLocation:this.constants.preferredCacheLocation}})),this.defaultAuthContext;throw new Error("No AAD tenant was specified.")},a.prototype._loginAndAcquireTokenForAAD=function(o,i){var l=(null==(l=this.options.authContext)?void 0:l.getAllAccounts())||[];0===l.length?(this.options.authContext.loginRedirect(),o()):(this.options.authContext.setActiveAccount(l[0]),this._acquireTokenForAAD(o,i))},a.prototype._acquireTokenForAAD=function(o,i){var l=this,u={scopes:["https://atlas.microsoft.com/.default"]};this.options.authContext.acquireTokenSilent(u).then(function(h){l._saveItem(a.constants.storage.tokenKey,h.accessToken);var g=(l.map.events.invoke(a.constants.events.tokenAcquired,g={map:l.map,type:a.constants.events.tokenAcquired}),clearTimeout(l.tokenTimeOutHandle),new Date(h.expiresOn).getTime()-Date.now());l.tokenTimeOutHandle=setTimeout(function(){return l._acquireTokenForAAD()},g),o?.()}).catch(function(h){if(h instanceof yd)return l.options.authContext.acquireTokenRedirect(u),o?.();i?.(h)})},a.prototype.getAuthType=function(){return this.options.authType},a.prototype.getClientId=function(){return this.options.clientId},a.prototype.getToken=function(){if(this.options.authType===so.aad)return this._getItem(a.constants.storage.tokenKey);if(this.options.authType!==so.anonymous&&this.options.authType!==so.sas)return this.options.authType===so.subscriptionKey?this.options.subscriptionKey:void 0;var o=this._getItem(a.constants.storage.tokenKey);if(o){var i=this._getTokenExpiry(o);if(i<300&&0<i)this._triggerTokenFetch();else if(i<=0)throw this._saveItem(a.constants.storage.tokenKey,""),new Error(a.constants.errors.tokenExpired)}else this._triggerTokenFetch();return o},a.prototype._getTokenExpiry=function(i){i=function ate(a,o){if("string"!=typeof a)throw new PN("Invalid token specified");o=!0===(o=o||{}).header?0:1;try{return JSON.parse(function h5(a){var o=a.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(Ze(o).replace(/(.)/g,function(i,l){return"%"+((l=l.charCodeAt(0).toString(16).toUpperCase()).length<2?"0"+l:l)}))}catch{return Ze(o)}}(a.split(".")[o]))}catch(i){throw new PN("Invalid token specified: "+i.message)}}(i).exp;var l=this._getCurrentTime();return 0<i-l?i-l:-1},a.prototype._storeToken=function(o){this._saveItem(a.constants.storage.tokenKey,o),this.map.events.invoke(a.constants.events.tokenAcquired,o={map:this.map,type:a.constants.events.tokenAcquired})},a.prototype._saveItem=function(o,i){return this._supportsLocalStorage()?localStorage.setItem(o,i):this._supportsSessionStorage()?sessionStorage.setItem(o,i):this.fallbackStorage[o]=i,!0},a.prototype._getItem=function(o){return this._supportsLocalStorage()?localStorage.getItem(o):this._supportsSessionStorage()?sessionStorage.getItem(o):o in this.fallbackStorage?this.fallbackStorage[o]:null},a.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem(a.constants.storage.testStorageKey,"A"),"A"===window.localStorage.getItem(a.constants.storage.testStorageKey)&&(window.localStorage.removeItem(a.constants.storage.testStorageKey),!window.localStorage.getItem(a.constants.storage.testStorageKey)))}catch{return!1}},a.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem(a.constants.storage.testStorageKey,"A"),"A"===window.sessionStorage.getItem(a.constants.storage.testStorageKey)&&(window.sessionStorage.removeItem(a.constants.storage.testStorageKey),!window.sessionStorage.getItem(a.constants.storage.testStorageKey)))}catch{return!1}},a.prototype._getCurrentTime=function(){return Math.round((new Date).getTime()/1e3)},a.prototype.signRequest=function(o){o.headers=o.headers||{},o.headers["Session-Id"]=this.sessionId,o.headers["Ms-Am-Request-Origin"]="MapControl",o.headers["Map-Agent"]="MapControl/".concat(Yp," (Web)");var i=this.getToken();switch(this.options.authType){case so.aad:case so.anonymous:o.headers["x-ms-client-id"]=this.options.clientId,o.headers.Authorization="Bearer "+i;break;case so.sas:o.headers.Authorization="jwt-sas "+i;break;case so.subscriptionKey:o.headers["subscription-key"]=i;break;default:throw new Error("An invalid authentication type was specified")}return o},a.constants={preferredCacheLocation:"localStorage",storage:{tokenKey:"access.token.key",testStorageKey:"testStorage"},events:{tokenAcquired:"tokenacquired"},tokenExpiresIn:3599,tokenRefreshClockSkew:300,errors:{tokenExpired:"Token Expired, Try again"}},a}(),M7=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},k7=function(){function a(o){for(var i in this.map=o,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("atlas-control-container"),Ll){var l;Ll.hasOwnProperty(i)&&((l=document.createElement("div")).classList.add(Ll[i]),l.classList.add("subcontrol-container"),this.controlContainer.appendChild(l))}this.map.getMapContainer().appendChild(this.controlContainer),this.controls=new Set}return a.prototype.add=function(o,i){var l,u;if(Array.isArray(o))try{for(var h=M7(o),g=h.next();!g.done;g=h.next())this._add(g.value,i)}catch(T){l={error:T}}finally{try{g&&!g.done&&(u=h.return)&&u.call(h)}finally{if(l)throw l.error}}else this._add(o,i)},a.prototype.getControls=function(){return Array.from(this.controls)},a.prototype.remove=function(o){var i,l;if(Array.isArray(o))try{for(var u=M7(o),h=u.next();!h.done;h=u.next())this._remove(h.value)}catch(w){i={error:w}}finally{try{h&&!h.done&&(l=u.return)&&l.call(u)}finally{if(i)throw i.error}}else this._remove(o)},a.prototype._add=function(u,h){this.controls.add(u);var l=(new Sr).merge(h);if(u=u.onAdd(this.map,h),!(0<(h=this.controlContainer.getElementsByClassName(l.position)).length))throw new Error("Control position ".concat(l.position," does not exist."));h.item(0).appendChild(u)},a.prototype._remove=function(o){o.onRemove(),this.controls.delete(o)},a}(),eT=window&&window.__assign||function(){return(eT=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)},lte=function(){function a(o){this.callbacks=new Fl,this.map=o}return a.prototype.addCallback=function(o,i,l,u,h){var g,w,T=this;if(u)g=function(W){var P=W.lngLat?new Kl(W.lngLat.lng,W.lngLat.lat):void 0,N=W.point?[W.point.x,W.point.y]:void 0,z=W.features?W.features.map(function(ue){return new Rr(ue.geometry,ue.properties,ue.id)}):[];l(W={type:W.type,originalEvent:W.originalEvent,position:P,coordinate:N,features:z})};else switch(o){case"data":case"sourcedata":case"styledata":g=function(D){D=eT(eT({dataType:D.dataType},"source"===D.dataType&&eT(eT(eT({isSourceLoaded:D.isSourceLoaded},D.sourceDataType&&{sourceDataType:D.sourceDataType}),{source:T.map.sources.getById(D.sourceId)}),D.tile&&{tile:{id:{x:D.tile.tileID.canonical.x,y:D.tile.tileID.canonical.y,z:D.tile.tileID.canonical.z},size:D.tile.tileSize,state:D.tile.state}})),{map:T.map,type:D.type}),h&&T.map.events._removeListener(o,i,l),l(D)};break;case"error":g=function(D){D={error:D.error,map:T.map,type:D.type},h&&T.map.events._removeListener(o,i,l),l(D)};break;case"touchstart":case"touchend":case"touchmove":case"touchcancel":g=function(D){if(D.originalEvent){if(D.originalEvent===w)return;w=D.originalEvent}var ue=D.point?new _l(D.point.x,D.point.y):void 0,P=D.points?D.points.map(function(ge){return new _l(ge.x,ge.y)}):[],N=D.lngLat?new Kl(D.lngLat.lng,D.lngLat.lat):void 0,z=D.lngLats?D.lngLats.map(function(ge){return new Kl(ge.lng,ge.lat)}):[],W=N?T.map.layers.getRenderedShapes(new mf(N),i?[i]:void 0):[];ue={map:T.map,originalEvent:D.originalEvent,pixel:ue,pixels:P,position:N,positions:z,shapes:W,layerId:i||void 0,preventDefault:function(){return D.preventDefault()},type:D.type},h&&T.map.events._removeListener(o,i,l),l(ue)};break;case"mousedown":case"mouseup":case"mouseover":case"mousemove":case"click":case"dblclick":case"mouseout":case"mouseenter":case"mouseleave":case"contextmenu":g=function(D){if(D.originalEvent){if(D.originalEvent===w)return;w=D.originalEvent}var z=D.lngLat?new Kl(D.lngLat.lng,D.lngLat.lat):void 0,P=D.point?new _l(D.point.x,D.point.y):void 0,N=z?T.map.layers.getRenderedShapes(new mf(z),i?[i]:void 0):[];z={map:T.map,originalEvent:D.originalEvent,position:z,pixel:P,preventDefault:function(){return D.preventDefault()},shapes:N,layerId:i||void 0,type:D.type},h&&T.map.events._removeListener(o,i,l),l(z)};break;case"styleimagemissing":g=function(D){h&&T.map.events._removeListener(o,i,l),l(D.id)};break;case"wheel":g=function(D){if(D.originalEvent){if(D.originalEvent===w)return;w=D.originalEvent}var P={map:T.map,originalEvent:D.originalEvent,preventDefault:function(){return D.preventDefault()},type:D.type};h&&T.map.events._removeListener(o,i,l),l(P)};break;case"resize":g=function(D){var P,N={map:T.map,type:D.type};for(P in D)"type"!==P&&"target"!==P&&(N[P]=D[P]);h&&T.map.events._removeListener(o,i,l),l(N)};break;default:g=function(D){var P={map:T.map,type:D.type};D.originalEvent&&(P.originalEvent=D.originalEvent),h&&T.map.events._removeListener(o,i,l),l(P)}}this.callbacks.has(i)||this.callbacks.set(i,new Fl),this.callbacks.get(i).has(o)||this.callbacks.get(i).set(o,new Map),this.callbacks.get(i).get(o).set(l,[g,h])},a.prototype.removeCallback=function(o,i,l){this.callbacks.has(i)&&this.callbacks.get(i).has(o)&&this.callbacks.get(i).get(o).has(l)&&this.callbacks.get(i).get(o).delete(l)},a.prototype.getModifiedCallback=function(o,i,l){if(this.callbacks.has(i)&&this.callbacks.get(i).has(o)&&this.callbacks.get(i).get(o).has(l))return this.callbacks.get(i).get(o).get(l)[0]},a.prototype.getLayerCallbacks=function(o){if(this.callbacks.has(o))return this.callbacks.get(o)},a.prototype.getEventCallbacks=function(o,i){if(this.callbacks.has(i)&&(i=this.callbacks.get(i)).has(o))return i.get(o)},a}(),zf=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},tT=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},cte=["maxzoomchanged","minzoomchanged","mapconfigurationchanged"],O7=function(){function a(o){this.map=o,this.mapCallbackHandler=new lte(this.map)}return a.prototype.add=function(o,i,l){var u,h;if("function"==typeof i)this._addGlobalListener(o,i,!1,!1);else{i=Array.isArray(i)?i:[i];try{for(var g=zf(i),w=g.next();!w.done;w=g.next()){var T=w.value;T instanceof Ps&&Ps._isMBoxEvent(o)?this._addLayerListener(o,T,l,!1,!1):T._addEventListener(o,l,!1)}}catch(D){u={error:D}}finally{try{w&&!w.done&&(h=g.return)&&h.call(g)}finally{if(u)throw u.error}}}},a.prototype.addOnce=function(o,i,l){"function"==typeof i?this._addGlobalListener(o,i,!1,!0):i instanceof Ps&&Ps._isMBoxEvent(o)?this._addLayerListener(o,i,l,!1,!0):i._addEventListener(o,l,!0)},a.prototype._addLegacy=function(o,i,l){"function"==typeof i?this._addGlobalListener(o,i,!0,!1):this._addLayerListener(o,i,l,!0,!1)},a.prototype._addLayerListener=function(o,P,l,u,h){P=P instanceof Ps?P.getId():P;var g,w,T,D,N=this.map.layers.getLayerById(P),z=this.mapCallbackHandler.getModifiedCallback(o,P,l);if(z&&N)try{for(var W=zf(N._getLayerIds()),ue=W.next();!ue.done;ue=W.next()){var ge=ue.value;this.map._getMap().off(o,ge,z)}}catch(et){g={error:et}}finally{try{ue&&!ue.done&&(w=W.return)&&w.call(W)}finally{if(g)throw g.error}}if(this.mapCallbackHandler.addCallback(o,P,l,u,h),N){z=this.mapCallbackHandler.getModifiedCallback(o,P,l);try{for(var we=zf(N._getLayerIds()),Re=we.next();!Re.done;Re=we.next())ge=Re.value,this.map._getMap().on(o,ge,z)}catch(et){T={error:et}}finally{try{Re&&!Re.done&&(D=we.return)&&D.call(we)}finally{if(T)throw T.error}}}},a.prototype._addGlobalListener=function(o,i,l,u){var h,g,w,T;cte.includes(o)?this.map._addEventListener(o,i,u):(h=this.mapCallbackHandler.getModifiedCallback(o,"",i),this.mapCallbackHandler.addCallback(o,"",i,l,u),g=this.mapCallbackHandler.getModifiedCallback(o,"",i),"load"===o&&this.map._isLoaded()?(w={type:"load",map:this.map},setTimeout(function(){return g(w)})):"ready"===o?this.map._isReady()&&(T={type:"ready",map:this.map},setTimeout(function(){return g(T)})):(h&&this.map._getMap().off(o,h),this.map._getMap().on(o,g)))},a.prototype.invoke=function(o,i,l){if(void 0===l)this._invokeListeners(o,"",i);else if(i instanceof Ps&&Ps._isMBoxEvent(o))this._invokeListeners(o,i.getId(),l);else{if(!(i instanceof Pa))throw new Error("The invoke target is invalid.");i._invokeEvent(o,l)}},a.prototype._invokeListeners=function(o,i,l){var u=this,h=new Fl(this.mapCallbackHandler.getEventCallbacks(o,i));h?h.forEach(function(g,w){(g=tT(g,2))[1]&&u._removeListener(o,i,w),w(l)}):"error"===o&&console.error("error"in l?l.error:l)},a.prototype.remove=function(o,i,l){var u,h;if("function"==typeof i)this._removeListener(o,"",i);else{i=Array.isArray(i)?i:[i];try{for(var g=zf(i),w=g.next();!w.done;w=g.next()){var T=w.value;T instanceof Ps&&Ps._isMBoxEvent(o)?this._removeListener(o,T,l):T?._removeEventListener(o,l)}}catch(D){u={error:D}}finally{try{w&&!w.done&&(h=g.return)&&h.call(g)}finally{if(u)throw u.error}}}},a.prototype._removeLegacy=function(o,i,l){"function"==typeof i?this._removeListener(o,"",i):this._removeListener(o,i,l)},a.prototype._removeListener=function(o,i,l){var u,h;if(cte.includes(o))this.map._removeEventListener(o,l);else{i=i instanceof Ps?i.getId():i;var g=this.mapCallbackHandler.getModifiedCallback(o,i,l);if(g)if(i){var w=this.map.layers.getLayerById(i);if(w)try{for(var T=zf(w._getLayerIds()),D=T.next();!D.done;D=T.next()){var P=D.value;this.map._getMap().off(o,P,g)}}catch(z){u={error:z}}finally{try{D&&!D.done&&(h=T.return)&&h.call(T)}finally{if(u)throw u.error}}}else this.map._getMap().off(o,g);this.mapCallbackHandler.removeCallback(o,i,l)}},a.prototype._enableLayerEvents=function(o){var i=this,l=this.mapCallbackHandler.getLayerCallbacks(o.getId());l&&l.forEach(function(u,h){u.forEach(function(g){var w,T,D=tT(g,1)[0];try{for(var P=zf(o._getLayerIds()),N=P.next();!N.done;N=P.next()){var z=N.value;i.map._getMap().on(h,z,D)}}catch(W){w={error:W}}finally{try{N&&!N.done&&(T=P.return)&&T.call(P)}finally{if(w)throw w.error}}})})},a.prototype._disableLayerEvents=function(o){var i=this,l=this.mapCallbackHandler.getLayerCallbacks(o.getId());l&&l.forEach(function(u,h){u.forEach(function(g){var w,T,D=tT(g,1)[0];try{for(var P=zf(o._getLayerIds()),N=P.next();!N.done;N=P.next()){var z=N.value;i.map._getMap().off(h,z,D)}}catch(W){w={error:W}}finally{try{N&&!N.done&&(T=P.return)&&T.call(P)}finally{if(w)throw w.error}}})})},a}(),N7=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},ute=function(){function a(o){this.markers=new Set,this.map=o}return a.prototype.add=function(o,i){var l,u;if(Array.isArray(o))try{for(var h=N7(o),g=h.next();!g.done;g=h.next())this._addMarker(g.value,i)}catch(T){l={error:T}}finally{try{g&&!g.done&&(u=h.return)&&u.call(h)}finally{if(l)throw l.error}}else this._addMarker(o,i)},a.prototype._addMarker=function(o,i){o._addToMap(this.map,i),this.markers.add(o)},a.prototype.getMarkers=function(){return Array.from(this.markers)},a.prototype.remove=function(o){var i,l;if(Array.isArray(o))try{for(var u=N7(o),h=u.next();!h.done;h=u.next())this._removeMarker(h.value)}catch(w){i={error:w}}finally{try{h&&!h.done&&(l=u.return)&&l.call(u)}finally{if(i)throw i.error}}else this._removeMarker(o)},a.prototype._removeMarker=function(o){var i=this;o instanceof f2?(o._removeFromMap(),this.markers.delete(o)):this.markers.forEach(function(l){l._getId()===o&&(l._removeFromMap(),i.markers.delete(l))})},a.prototype.clear=function(){var o=this;this.markers.forEach(function(i){i._removeFromMap(),o.markers.delete(i)})},a}(),hte=function(){function a(o){this.userImages=new Fl,this.imageLoadTimeout=5e3,this.map=o}return a.prototype.add=function(o,i,l){var u=this;return new Promise(function(h,g){var w,T,D;u.userImages.has(o)?h():i instanceof HTMLImageElement||i instanceof ImageData?(u.map._getMap().addImage(o,i,l),u.userImages.set(o,{image:i,meta:l}),h()):"string"==typeof i&&(T=/<svg/i.test(i)&&!/^data:/i.test(i)?"data:image/svg+xml;base64,"+window.btoa(i):i,D=!1,u.map._sendRequest(T,"Image").then(function(P){return D?void 0:P.blob()}).then(function(P){var N;!D&&P&&(clearTimeout(w),(N=new Image).onload=function(){u.map._getMap().addImage(o,N,l),u.userImages.set(o,{image:N,meta:l}),h()},N.onerror=N.onabort=function(){g("Failed to load image into HTML element.")},N.src=URL.createObjectURL(P))}).catch(function(){D||(clearTimeout(w),g("Failed to load image into HTML element."))}),w=setTimeout(function(){D=!0,g("Failed to load image within specified timeout: ".concat(u.imageLoadTimeout," ms."))},u.imageLoadTimeout))})},a.prototype.clear=function(){var o=this;this.userImages.forEach(function(i,l){o.map._getMap().removeImage(l)}),this.userImages.clear()},a.prototype.getImageIds=function(){var o=[];return this.userImages.forEach(function(i,l){o.push(l)}),o},a.prototype.createFromTemplate=function(o,i,l,u,h){return l=l||"#1A73AA",u=u||"#fff",i=(i=zC(i,h)).replace(/{color}/g,l).replace(/{secondaryColor}/g,u).replace(/{text}/g,""),this.add(o,i)},a.prototype.hasImage=function(o){return this.userImages.has(o)},a.prototype.remove=function(o){this.map._getMap().removeImage(o),this.userImages.delete(o)},a.prototype._restoreImages=function(){var o=this;this.userImages.forEach(function(i,l){o.map._getMap().hasImage(l)||o.map._getMap().addImage(l,i.image,i.meta)})},a}(),dte=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),pte=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},Ep=function(a){function o(i,l){return(l=a.call(this,l)||this).layers=i,l}return dte(o,a),o.prototype.getOptions=function(){return{}},o.prototype.setOptions=function(i){},o.prototype._buildLayers=function(){return this.layers},o.prototype._getLayerIds=function(){return this.layers.map(function(i){return i.id})},o.prototype._getSourceIds=function(){var i,l,u=new Set;try{for(var h=pte(this.layers),g=h.next();!g.done;g=h.next()){var w=g.value;"source"in w&&"string"==typeof w.source?u.add(w.source):"source"in w&&w.source&&u.add(w.id)}}catch(T){i={error:T}}finally{try{g&&!g.done&&(l=h.return)&&l.call(h)}finally{if(i)throw i.error}}return u},o.prototype._updateLayoutProperty=function(i,l,u,h){var g;Gl(l,u)||(g=this.map._getMap(),this.layers.forEach(function(w){g.getLayer(w.id)?g.setLayoutProperty(w.id,i,h||l):console.warn("Could not update layout property ".concat(i," for layer ").concat(w.id," to ").concat(h||l))}))},o}(Ps),jf=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},L7=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},F7=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},V7=function(){function a(o){this.layerIndex=[],this.userLayers=[],this.map=o}return a.prototype.add=function(o,i){var l,u,h=i instanceof Ps?i.getId():i;if(Array.isArray(o))try{for(var g=jf(o),w=g.next();!w.done;w=g.next())this._addLayer(w.value,h)}catch(D){l={error:D}}finally{try{w&&!w.done&&(u=g.return)&&u.call(g)}finally{if(l)throw l.error}}else this._addLayer(o,h)},a.prototype._addLayer=function(o,i){if(!(this.map._isReady()||o instanceof Ep))throw new Error("The layer '".concat(o.getId(),"' could not be added to the map because ")+"the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a layer to it.");var l,u,h,g;i!==o.getId()&&this.layerIndex.find(function(w){return i===w.getId()})?this._getMapboxLayerExists(o)?(u=this.layerIndex.findIndex(function(w){return w.getId()===o.getId()}),h=this.userLayers.findIndex(function(w){return w.layer.getId()===o.getId()}),this._removeMapboxLayers(o),this._addMapboxLayers(o,i),(g=this.layerIndex[u])&&this.map.events._disableLayerEvents(g),this.map.events._enableLayerEvents(o),this.layerIndex.splice(u,1),l=this.layerIndex.findIndex(function(w){return w.getId()===i}),this.layerIndex.splice(l,0,o),o instanceof Ep||(this.userLayers[h]={layer:o,before:i}),g&&g.onRemove()):(this._addMapboxLayers(o,i),this.map.events._enableLayerEvents(o),l=this.layerIndex.findIndex(function(w){return w.getId()===i}),this.layerIndex.splice(l,0,o),o instanceof Ep||this.userLayers.push({layer:o,before:i})):(u=this.layerIndex.findIndex(function(w){return w.getId()===o.getId()}),h=this.userLayers.findIndex(function(w){return w.layer.getId()===o.getId()}),0<=u&&0<=h?(this._removeMapboxLayers(g=this.layerIndex[u]),this._addMapboxLayers(o,u+1),this.map.events._disableLayerEvents(g),this.map.events._enableLayerEvents(o),(this.layerIndex[u]=o)instanceof Ep||(this.userLayers[h]={layer:o,before:void 0}),g.onRemove()):(this._addMapboxLayers(o),this.map.events._enableLayerEvents(o),this.layerIndex.push(o),o instanceof Ep||this.userLayers.push({layer:o,before:i}))),o.onAdd(this.map)},a.prototype._addMapboxLayers=function(o,i){var l,u;if(!(o instanceof D4)||o.getOptions().tileUrl){if(!(o instanceof Ep)){o instanceof U1&&(this.map._getMap().addSource(o._getSourceId(),o._buildSource()),this.map.sources.setSourceState(o._getSourceWrapper()));var h=this._getMapboxBefore(i);try{for(var g=jf(o._buildLayers()),w=g.next();!w.done;w=g.next()){var T=w.value;this.map._getMap().addLayer(T,h)}}catch(D){l={error:D}}finally{try{w&&!w.done&&(u=g.return)&&u.call(g)}finally{if(l)throw l.error}}}this.map.events._enableLayerEvents(o)}},a.prototype._removeMapboxLayers=function(o,i){var l,u;if(o instanceof Ep&&!i)this.map.events._disableLayerEvents(o);else{try{for(var h=jf(o._getLayerIds()),g=h.next();!g.done;g=h.next()){var w=g.value;this.map._getMap().getLayer(w)&&this.map._getMap().removeLayer(w)}}catch(T){l={error:T}}finally{try{g&&!g.done&&(u=h.return)&&u.call(h)}finally{if(l)throw l.error}}this.map.events._disableLayerEvents(o),o instanceof U1&&this.map._getMap().getSource(o._getSourceId())&&this.map._getMap().removeSource(o._getSourceId())}},a.prototype._getMapboxLayerExists=function(o){var i=this,l=!1;return"string"==typeof o?!!(o=this.layerIndex.find(function(u){return u.getId()===o})):(o._getLayerIds().forEach(function(u){i.map._getMap().getLayer(u)&&(l=!0)}),l)},a.prototype._getMapboxBefore=function(o){var i,l,u,h;if("string"==typeof o){var g=this.layerIndex.find(function(W){return W.getId()===o});if(!g)return;try{for(var w=jf(g._getLayerIds()),T=w.next();!T.done;T=w.next()){var D=T.value;if(this.map._getMap().getLayer(D))return D}}catch(W){i={error:W}}finally{try{T&&!T.done&&(l=w.return)&&l.call(w)}finally{if(i)throw i.error}}o=this.layerIndex.findIndex(function(W){return W.getId()===o})+1}for(var P=o;P<this.layerIndex.length;P++)try{u=void 0;for(var N=jf(this.layerIndex[P]._getLayerIds()),z=N.next();!z.done;z=N.next())if(D=z.value,this.map._getMap().getLayer(D))return D}catch(W){u={error:W}}finally{try{z&&!z.done&&(h=N.return)&&h.call(N)}finally{if(u)throw u.error}}},a.prototype.clear=function(){for(var o=this.layerIndex.length-1;0<=o;o--){var i=this.layerIndex[o];i&&(this._removeMapboxLayers(i,!0),this.layerIndex.splice(o,1),i.onRemove())}this.userLayers=[]},a.prototype.getLayerById=function(o){var i=this.layerIndex.find(function(l){return l.getId()===o});if(i)return i},a.prototype.getLayers=function(){return this.layerIndex.slice(0)},a.prototype._getSourceIds=function(){var o,i,l=new Set;try{for(var u=jf(this.layerIndex),h=u.next();!h.done;h=u.next())h.value._getSourceIds().forEach(function(g){return l.add(g)})}catch(g){o={error:g}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return l},a.prototype._getUserLayers=function(){return Array.from(this.userLayers)},a.prototype.move=function(o,i){var l=o instanceof Ps?o.getId():o,u=i instanceof Ps?i.getId():i;if(!this.layerIndex.find(function(h){return h.getId()===l}))throw new Error("The layer '".concat(l,"' has not been added to the map and cannot be moved."));i=this.layerIndex.findIndex(function(h){return h.getId()===l}),this._moveMapboxLayers(this.layerIndex[i],u),o=this.layerIndex[i],this.layerIndex.splice(i,1),-1<(i=this.layerIndex.findIndex(function(h){return h.getId()===u}))?this.layerIndex.splice(i,0,o):this.layerIndex.push(o),(i=this.userLayers.find(function(h){return h.layer.getId()===l}))&&(i.before=u)},a.prototype._moveMapboxLayers=function(o,i){var l,u,h=this._getMapboxBefore(i);try{for(var g=jf(o._getLayerIds()),w=g.next();!w.done;w=g.next()){var T=w.value;this.map._getMap().moveLayer(T,h)}}catch(D){l={error:D}}finally{try{w&&!w.done&&(u=g.return)&&u.call(g)}finally{if(l)throw l.error}}},a.prototype.getRenderedShapes=function(o,i,l){var u,h,g,w=this;if(o=o||[-180,-85.0511,180,85.0511],Array.isArray(o)?4===o.length||6===o.length?g=this.map.positionsToPixels([gi.getSouthWest(o),gi.getNorthEast(o)]):2!==o.length&&3!==o.length||(g=this.map.positionsToPixels([o])[0]):g=this.map.positionsToPixels([o.coordinates])[0],i){i=Array.isArray(i)?i:[i];var T=[],D=this;try{for(var P=jf(i),N=P.next();!N.done;N=P.next())!function(ue){var W=ue instanceof Ps?ue.getId():ue;if(!(-1<(ue=D.layerIndex.findIndex(function(ge){return ge.getId()===W}))))throw new Error("The layer '".concat(W,"' has not been added to the map ")+"and its rendered features cannot be retrieved.");T.push.apply(T,F7([],L7(D.layerIndex[ue]._getLayerIds().filter(function(ge){return!!w.map._getMap().getLayer(ge)})),!1))}(N.value)}catch(z){u={error:z}}finally{try{N&&!N.done&&(h=P.return)&&h.call(P)}finally{if(u)throw u.error}}}return o=this.map._getMap().queryRenderedFeatures(g,{layers:T,filter:l}),this.map.sources._mapFeaturesToShapes(o)},a.prototype.remove=function(o){var i,l;if(Array.isArray(o))try{for(var u=jf(o),h=u.next();!h.done;h=u.next())this._removeLayer(h.value)}catch(w){i={error:w}}finally{try{h&&!h.done&&(l=u.return)&&l.call(u)}finally{if(i)throw i.error}}else this._removeLayer(o)},a.prototype._removeLayer=function(o){var i=o instanceof Ps?o.getId():o;if(-1==(u=this.layerIndex.findIndex(function(h){return h.getId()===i})))throw new Error("The layer '".concat(i,"' has not been added to the map and cannot be removed."));var u,l=this.layerIndex[u];-1!=(this._removeMapboxLayers(l),this.layerIndex.splice(u,1),u=this.userLayers.findIndex(function(h){return h.layer.getId()===i}))&&this.userLayers.splice(u,1),o instanceof U1&&this.map.sources.unsetSourceState(o._getSourceId()),l.onRemove()},a}(),d5=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},B7=function(){function a(o){var i=this;this._onDrag=function(l){var u,h;"mousemove"===l.type?(u=l.clientX,h=l.clientY):"touchmove"===l.type&&(u=l.touches[0].clientX,h=l.touches[0].clientY),i.draggedPopups.forEach(function(g){g._dragToPixel([u,h])})},this._onUp=function(){i.map.getMapContainer().removeEventListener("mousemove",i._onDrag),i.map.getMapContainer().removeEventListener("touchmove",i._onDrag),i.map.getMapContainer().removeEventListener("mouseup",i._onUp),i.map.getMapContainer().removeEventListener("touchend",i._onUp),i.draggedPopups.forEach(function(l){i.draggedPopups.delete(l),l._onUp()})},this.map=o,this.popups=new Set,this.draggedPopups=new Set}return a.prototype.add=function(o){var i,l;o=Array.isArray(o)?o:[o];try{for(var u=d5(o),h=u.next();!h.done;h=u.next()){var g=h.value;this.popups.has(g)||(this.popups.add(g),g.attach(this.map))}}catch(w){i={error:w}}finally{try{h&&!h.done&&(l=u.return)&&l.call(u)}finally{if(i)throw i.error}}},a.prototype.clear=function(){var o=this;this.popups.forEach(function(i){o.popups.delete(i),i.remove()})},a.prototype.remove=function(o){var i,l;o=Array.isArray(o)?o:[o];try{for(var u=d5(o),h=u.next();!h.done;h=u.next()){var g=h.value;this.popups.has(g)&&(this.popups.delete(g),g.remove())}}catch(w){i={error:w}}finally{try{h&&!h.done&&(l=u.return)&&l.call(u)}finally{if(i)throw i.error}}},a.prototype.getPopups=function(){return Array.from(this.popups)},a.prototype._getCollectionDiv=function(){var o=this.map.getMapContainer().querySelector(".".concat(a.Css.collection));return o||((o=document.createElement("div")).classList.add(a.Css.collection),o.setAttribute("aria-label","Map Information"),this.map.getMapContainer().appendChild(o)),o},a.prototype._addDraggedPopup=function(o){0===this.draggedPopups.size&&(this.map.getMapContainer().addEventListener("mousemove",this._onDrag),this.map.getMapContainer().addEventListener("touchmove",this._onDrag),this.map.getMapContainer().addEventListener("mouseup",this._onUp),this.map.getMapContainer().addEventListener("touchend",this._onUp)),this.draggedPopups.add(o)},a.Css={collection:"popup-collection-container"},a}(),zs=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},fte=function(){function a(o){this.map=o,this.sources=new Fl}return a.prototype.add=function(o,i){var l,u;if(void 0===i&&(i=!0),Array.isArray(o))try{for(var h=zs(o),g=h.next();!g.done;g=h.next())this._addSource(g.value,i)}catch(T){l={error:T}}finally{try{g&&!g.done&&(u=h.return)&&u.call(h)}finally{if(l)throw l.error}}else this._addSource(o,i)},a.prototype.getRenderedShapes=function(o,i,l){return o="string"==typeof o?o:o.getId(),l=this.map._getMap().querySourceFeatures(o,{sourceLayer:l,filter:i}),this.map.sources._mapFeaturesToShapes(l,!0,this.sources.get(o))},a.prototype.getFeatureState=function(o,i,l){return o="string"==typeof o?o:o instanceof ws?o.getId():o.id,i="string"==typeof i?i:i.getId(),this.map._getMap().getFeatureState({id:o,source:i,sourceLayer:l})},a.prototype.removeFeatureState=function(o,i,l,u){o="string"==typeof o?o:o instanceof ws?o.getId():o.id,i="string"==typeof i?i:i.getId(),this.map._getMap().removeFeatureState({id:o,source:i,sourceLayer:l},u)},a.prototype.setFeatureState=function(o,i,l,u){o="string"==typeof o?o:o instanceof ws?o.getId():o.id,i="string"==typeof i?i:i.getId(),this.map._getMap().setFeatureState({id:o,source:i,sourceLayer:u},l)},a.prototype._buildSources=function(){var o={};return this.sources.forEach(function(i){o[i.getId()]=i._buildSource()}),o},a.prototype.clear=function(){var o=this;this.sources.forEach(function(i){o.remove(i)})},a.prototype.getById=function(o){return this.sources.get(o)},a.prototype.getSources=function(){return Array.from(this.sources.values())},a.prototype.isSourceLoaded=function(o){return o=o instanceof us?o.getId():o,this.map._getMap().isSourceLoaded(o)},a.prototype.remove=function(o,i){var l,u;if(void 0===i&&(i=!0),Array.isArray(o))try{for(var h=zs(o),g=h.next();!g.done;g=h.next())this._removeSource(g.value,i)}catch(T){l={error:T}}finally{try{g&&!g.done&&(u=h.return)&&u.call(h)}finally{if(l)throw l.error}}else this._removeSource(o,i)},a.prototype.setSourceState=function(o,i){void 0===i&&(i=!0),this.sources.set(o.getId(),o),o._setMap(this.map,i)},a.prototype.unsetSourceState=function(o){this.sources.has(o)&&(this.sources.get(o)._setMap(null),this.sources.delete(o))},a.prototype._removeSource=function(o,i){if(o=o instanceof us?o.getId():o,!this.sources.has(o))throw new Error("'".concat(o,"' is not added to the map"));if(this.map._getMap().getSource(o)&&i&&this.map._getMap().removeSource(o),this.map._getMap().getSource(o)&&i)throw new Error("One or more layers have a dependency on the source '".concat(o,"'"));this.unsetSourceState(o)},a.prototype._addSource=function(o,i){if(this.sources.has(o.getId())){if(i)throw new Error("'".concat(o.getId(),"' is already added to the map"));this.unsetSourceState(o.getId())}if(i){if(!this.map._isReady())throw new Error("The source '".concat(o.getId(),"' could not be added to the map because ")+"the map is not ready. Please use a ready event listener to guarantee the map is ready before adding a source to it.");this.map._getMap().addSource(o.getId(),o._buildSource())}this.setSourceState(o)},a.prototype._mapFeaturesToShapes=function(o,i,l){var u,h,g=[];try{for(var w=zs(o),T=w.next();!T.done;T=w.next()){var D=T.value;if((l||"string"==typeof D.source)&&"string"==typeof D.properties[ws._shapeIdPropName]){var P=l||this.sources.get(D.source);if(P instanceof Wl){var N=P.getShapeById(D.properties[ws._shapeIdPropName]);if(N instanceof ws){g.push(N);continue}}}i||g.push(D)}}catch(z){u={error:z}}finally{try{T&&!T.done&&(h=w.return)&&h.call(w)}finally{if(u)throw u.error}}return g},a.prototype._syncSources=function(o){var i=this;o?(Object.keys(o).map(function(l){var u,h=o[l];switch(h.type){case"vector":case"raster":case"raster-dem":u=new A4(l,{name:l,tiles:h.tiles,type:h.type,url:h.url,tileSize:"tileSize"in h?h.tileSize:void 0});break;case"canvas":u=new T4(l,h);break;case"geojson":var g=new Wl(l,{maxZoom:h.maxzoom,cluster:h.cluster,clusterRadius:h.clusterRadius,tolerance:h.tolerance,lineMetrics:h.lineMetrics,clusterProperties:h.clusterProperties,buffer:h.buffer,clusterMinPoints:h.clusterMinPoints,generateId:h.generateId,promoteId:h.promoteId,filter:h.filter});"string"!=typeof h.data&&void 0!==h.data&&g._addNoUpdate(h.data),u=g;break;case"image":u=new u2(l,h);break;case"video":u=new W$(l,h);break;default:u=new G$(l,h)}return u}).forEach(function(l){var u=i.sources.get(l.getId()),h=u&&l._isDeepEqual(u);!h&&u&&i.unsetSourceState(u.getId()),i.setSourceState(l,!h)}),Array.from(this.sources.keys()).filter(function(l){return!(l in o)}).forEach(function(l){return i.unsetSourceState(l)})):console.warn("syncSources called with no style sources which is unexpected.")},a}(),mte=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Tae=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.duration=1e3,i.type="jump",i}return mte(o,a),o}(To),gte=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),yte=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.bottom=0,i.left=0,i.right=0,i.top=0,i}return gte(o,a),o}(To),Cae=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),_te=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},Iae=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},Sae=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},vte=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.bounds=[-180,-89,180,90],i.maxBounds=void 0,i.maxZoom=20,i.offset=new _l(0,0),i.padding=new yte,i}return Cae(o,a),o.prototype.merge=function(){for(var i,l,u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];try{for(var g=_te(u),w=g.next();!w.done;w=g.next()){var T=w.value;T&&"number"==typeof T.padding&&(T.padding={top:T.padding,bottom:T.padding,left:T.padding,right:T.padding})}}catch(D){i={error:D}}finally{try{w&&!w.done&&(l=g.return)&&l.call(g)}finally{if(i)throw i.error}}return a.prototype.merge.apply(this,Sae([],Iae(u),!1))},o}(To),U7=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),wte=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.zoom=1,i.center=new Kl(0,0),i.centerOffset=new _l(0,0),i.bearing=0,i.pitch=0,i.minZoom=1,i.maxZoom=20,i.minPitch=0,i.maxPitch=60,i.maxBounds=void 0,i}return U7(o,a),o}(To),Aae=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),sD=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.name=void 0,i.before=void 0,i.minZoom=1,i.maxZoom=20,i.overwrite=!1,i.opacity=1,i}return Aae(o,a),o}(To),Hf=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),aD=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.color="rgba(0,0,0,.5)",i.outlineColor="#000",i.radius=1,i.outlineWidth=5,i.name="default-circles",i}return Hf(o,a),o}(sD),bte=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Ete=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.cap="butt",i.join="miter",i.name="default-linestrings",i.color="#000",i.width=1,i}return bte(o,a),o}(sD),z7=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Dae=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.iconSize=1,i.fontSize=14,i.fontColor="#000",i.textFont="SegoeUi-Regular",i.cluster=!0,i.clusterIcon=void 0,i.textOffset=[0,0],i.name="default-pins",i.icon="pin-darkblue",i.title="",i}return z7(o,a),o}(sD),RN=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Pae=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.color="rgba(0,0,0,.5)",i.outlineColor="#000",i.name="default-polygons",i}return RN(o,a),o}(sD),Rae=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Mae=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.name="default-raster",i}return Rae(o,a),o}(sD),kae=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Oae=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.anchor="map",i.color="#FFFFFF",i.intensity=.5,i.position=[1.15,210,30],i}return kae(o,a),o}(To),Nae=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),xte=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},Lae=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},MN=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},p5=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.antialias=void 0,i.autoResize=!0,i.language=RC(),i.light=new Oae,i.preserveDrawingBuffer=!1,i.progressiveLoading=!1,i.progressiveLoadingInitialLayerGroups=["base"],i.renderWorldCopies=!0,i.showBuildingModels=!1,i.showFeedbackLink=!0,i.showLogo=!0,i.showLabels=!0,i.customAttribution=void 0,i.showTileBoundaries=!1,i.style=void 0,i.view=bb(),i.userRegion=i.view,i.customStyleTransform=void 0,i}return Nae(o,a),o.prototype.merge=function(){for(var i,l,u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];try{for(var g=xte(u),w=g.next();!w.done;w=g.next()){var T=w.value;T&&(T.hasOwnProperty("view")?T.userRegion=T.view:T.hasOwnProperty("userRegion")&&(T.view=T.userRegion),"string"==typeof T.language)&&(T.language=EC.getCode(T.language))}}catch(D){i={error:D}}finally{try{w&&!w.done&&(l=g.return)&&l.call(g)}finally{if(i)throw i.error}}return a.prototype.merge.apply(this,MN([],Lae(u),!1))},o}(To),Fae=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),xg=window&&window.__assign||function(){return(xg=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)},Vae=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},kN=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},ON=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},f5=function(a){return 0==a.length?void 0:a.slice(1).reduce(function(o,i){return function(l,u){return l=o(l,u),xg(xg({},l),i(l.url,u))}},a[0])},m5=function(a){function o(){var i=null!==a&&a.apply(this,arguments)||this;return i.authOptions=IC(),i.disableTelemetry="atlas.azure.us"===Yg(),i["disable-telemetry"]=i.disableTelemetry,i.domain=Yg(),i.staticAssetsDomain=SC(),i.styleDefinitionsPath=AC(),i.styleDefinitionsVersion=Zg(),i.styleAPIVersion=DC(),i.mapConfiguration=void 0,i.styleSet=void 0,i.enableAccessibility=!0,i["enable-accessibility"]=i.enableAccessibility,i.enableAccessibilityLocationFallback=!0,i.maxParallelImageRequests=PC(),i.refreshExpiredTiles=!0,i.subscriptionKey=qP(),i["subscription-key"]=i.subscriptionKey,i.sessionId=MC(),i["session-id"]=i.sessionId,i._transformers=[],i.transformRequest=void 0,i.workerCount=mm(),i.fadeDuration=300,i.localIdeographFontFamily="sans-serif",i.validateStyle=!1,i}return Fae(o,a),o.prototype.merge=function(){for(var i=[],l=0;l<arguments.length;l++)i[l]=arguments[l];var u=this.styleDefinitionsVersion;try{for(var h=Vae(i),g=h.next();!g.done;g=h.next()){var w=g.value;w&&(w.authOptions?"string"==typeof w.authOptions.subscriptionKey&&(w.subscriptionKey=w["subscription-key"]=w.authOptions.subscriptionKey):"string"==typeof w.subscriptionKey?(w["subscription-key"]=w.subscriptionKey,w.authOptions={authType:so.subscriptionKey,subscriptionKey:w.subscriptionKey}):"string"==typeof w["subscription-key"]&&(w.subscriptionKey=w["subscription-key"],w.authOptions={authType:so.subscriptionKey,subscriptionKey:w["subscription-key"]}),"string"==typeof w.sessionId?w["session-id"]=w.sessionId:"string"==typeof w["session-id"]&&(w.sessionId=w["session-id"]),"boolean"==typeof w.disableTelemetry?w["disable-telemetry"]=w.disableTelemetry:"boolean"==typeof w["disable-telemetry"]&&(w.disableTelemetry=w["disable-telemetry"]),"boolean"==typeof w.enableAccessibility?w["enable-accessibility"]=w.enableAccessibility:"boolean"==typeof w["enable-accessibility"]&&(w.enableAccessibility=w["enable-accessibility"]))}}catch(z){D={error:z}}finally{try{g&&!g.done&&(P=h.return)&&P.call(h)}finally{if(D)throw D.error}}var T=this._transformers,P=i?i.filter(function(z){return void 0!==z}).reduce(function(z,W){return ON(ON([],kN(z),!1),kN(W._transformers||[]),!1)},[]):[],D=a.prototype.merge.apply(this,ON([],kN(i),!1)),N=(D.authOptions.authType!==so.subscriptionKey&&(D["subscription-key"]=D.subscriptionKey=void 0),void 0!==D.styleSet&&void 0===D.mapConfiguration&&(D.mapConfiguration=D.styleSet),D.mapConfiguration&&"string"!=typeof D.mapConfiguration&&(D.mapConfiguration=xg(xg({},D.mapConfiguration),{defaultConfiguration:D.mapConfiguration.defaultConfiguration||D.mapConfiguration.defaultStyle,configurations:D.mapConfiguration.configurations||D.mapConfiguration.styles})),this._transformers=ON(ON([],kN(T||[]),!1),kN(P.filter(function(z){return!T.includes(z)})),!1),this.transformRequest&&!this._transformers.includes(this.transformRequest)&&this._transformers.push(this.transformRequest),P=new Date(Date.UTC(2023,0)),new Date(this.styleDefinitionsVersion));return(isNaN(N.getTime())||N.getTime()<P.getTime())&&(console.warn("Style definition version ".concat(this.styleDefinitionsVersion," is invalid or deprecated, style definition version is unchanged (").concat(u,")")),this.styleDefinitionsVersion=u),this.transformRequest=f5(this._transformers),D},o.prototype.addTransformer=function(i){this._transformers||(this._transformers=[]),this._transformers.push(i),this.transformRequest=f5(this._transformers)},o.prototype.removeTransformer=function(i){this._transformers&&(this._transformers=this._transformers.filter(function(l){return i!==l}),this.transformRequest=f5(this._transformers))},o._cloneCustomizer=function(i){if("object"==typeof i)return Object.assign({},i)},o}(To),Bae=function(){function a(){}return a.getLayerGroup=function(o){return"string"!=typeof o&&o.metadata&&o.metadata["microsoft.maps:layerGroup"]?o.metadata["microsoft.maps:layerGroup"]:(o="string"!=typeof o?o.id:o).startsWith("microsoft.")&&4<=(o=o.split(".")).length?o[3]:void 0},a}(),NN=function(){function a(o){var i=this;this.isHijacked=function(){return void 0!==i._hijackedToResolve||void 0!==i._hijackedToReject},this.isResolved=function(){return void 0!==i._hijackedToResolve||void 0!==i._toResolve},this.isRejected=function(){return void 0!==i._hijackedToReject||void 0!==i._toReject},this.resultIfResolved=function(){return i._hijackedToResolve||i._toResolve},this.errorIfRejected=function(){return i._hijackedToReject||i._toReject},this._thenResolver=function(l,u){var h;i._hijackedToResolve?l(i._hijackedToResolve):i._hijackedToReject?u(i._hijackedToReject):(h=i.origin,i.origin.then(function(g){i.isHijacked()||(h!==i.origin?i._thenResolver(l,u):(i._toResolve=g,l(g)))}).catch(function(g){i.isHijacked()||(h!==i.origin?i._thenResolver(l,u):(i._toReject=g,u(g)))}))},this.origin=o,this[Symbol.toStringTag]=this.origin[Symbol.toStringTag]}return a.resolve=function(o){return new a(Promise.resolve(o))},a.reject=function(o){return new a(Promise.reject(o))},a.prototype.then=function(o,i){var l=this;return new Promise(function(u,h){l._resolve=u,l._reject=h,l._thenResolver(u,h)}).then(o,i)},a.prototype.catch=function(o){var i=this;return new Promise(function(l,u){i._resolve=l,i._reject=u,i._thenResolver(l,u)}).catch(o)},a.prototype.finally=function(o){var i=this;return new Promise(function(l,u){i._resolve=l,i._reject=u,i._thenResolver(l,u)}).finally(o)},a.prototype.hijackAndResolve=function(o){this._hijackedToResolve=o,this._resolve&&this._resolve(o)},a.prototype.hijackAndReject=function(o){this._hijackedToReject=o,this._reject&&this._reject(o)},a.prototype.switchWith=function(o){this.origin=o,this._toResolve=void 0,this._toReject=void 0},a}(),LN={road:"Road",satellite:"Satellite",satellite_road_labels:"Hybrid",grayscale_dark:"Grayscale (Dark)",grayscale_light:"Grayscale (Light)",night:"Night",road_shaded_relief:"Terra",blank:"Blank",blank_accessible:"Blank (Accessible)",high_contrast_dark:"High contrast (Dark)",high_contrast_light:"High contrast (Light)"},$f=window&&window.__assign||function(){return($f=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)},lD=window&&window.__awaiter||function(a,o,i,l){return new(i=i||Promise)(function(u,h){function g(D){try{T(l.next(D))}catch(P){h(P)}}function w(D){try{T(l.throw(D))}catch(P){h(P)}}function T(D){var P;D.done?u(D.value):((P=D.value)instanceof i?P:new i(function(N){N(P)})).then(g,w)}T((l=l.apply(a,o||[])).next())})},j7=window&&window.__generator||function(a,o){var i,l,u,h={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},g={next:w(0),throw:w(1),return:w(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function w(T){return function(D){var P=[T,D];if(i)throw new TypeError("Generator is already executing.");for(;h=g&&P[g=0]?0:h;)try{if(i=1,l&&(u=2&P[0]?l.return:P[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,P[1])).done)return u;switch(l=0,(P=u?[2&P[0],u.value]:P)[0]){case 0:case 1:u=P;break;case 4:return h.label++,{value:P[1],done:!1};case 5:h.label++,l=P[1],P=[0];continue;case 7:P=h.ops.pop(),h.trys.pop();continue;default:if(!(u=0<(u=h.trys).length&&u[u.length-1])&&(6===P[0]||2===P[0])){h=0;continue}if(3===P[0]&&(!u||P[1]>u[0]&&P[1]<u[3]))h.label=P[1];else if(6===P[0]&&h.label<u[1])h.label=u[1],u=P;else{if(!(u&&h.label<u[2])){u[2]&&h.ops.pop(),h.trys.pop();continue}h.label=u[2],h.ops.push(P)}}P=o.call(a,h)}catch(N){P=[6,N],l=0}finally{i=u=0}if(5&P[0])throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}},cD=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},H7=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},Uae=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},zae=function(){function a(o,i){var l=this;this.definitions=function(){return l.initPromise||l.initStyleset()},this.indoorState=void 0,this.preservedPreindoorMapConfiguration=void 0,this._progressiveLoadingState={mapStyle:void 0,pendingVisibilityChange:void 0},this._deferLayerGroupVisibilities=function(u,h){var g,w,T,D,P=h.filter(function(N){return N in u});0!==P.length&&(g=l.map._getMap(),w=g.getZoom(),T=l.map.getStyle().style,l._progressiveLoadingState.pendingVisibilityChange&&(l.map.events.remove("load",l._progressiveLoadingState.pendingVisibilityChange),l._progressiveLoadingState.pendingVisibilityChange=null),l._progressiveLoadingState.mapStyle=T,(D=Object.entries(u).reduce(function(N,ue){var W=(ue=cD(ue,2))[0],ge=(ue=ue[1],P.includes(W));return H7(H7([],cD(N),!1),cD(ue.filter(function(we){if("custom"===we.type)return!1;if(ge)if("number"==typeof we.maxzoom&&"number"==typeof we.minzoom){if(w<=we.maxzoom&&w>=we.minzoom)return!1}else if("number"==typeof we.minzoom){if(w>=we.minzoom)return!1}else if("number"!=typeof we.maxzoom||w<=we.maxzoom)return!1;return"none"!==(null==(we=we.layout)?void 0:we.visibility)})),!1)},[])).forEach(function(N){N.layout=N.layout||{},N.layout.visibility="none"}),l._progressiveLoadingState.pendingVisibilityChange=function(){l._progressiveLoadingState.pendingVisibilityChange=null;var N=l.map.getStyle().style;T===N&&(D.forEach(function(z){z.layout.visibility="visible",g.setLayoutProperty(z.id,"visibility","visible")}),null!=(N=l.map.copyrightDelegate))&&N.reloadAttribution()},l.map.events.addOnce("load",l._progressiveLoadingState.pendingVisibilityChange))},this._onStyleData=function(u){l.map.events.invoke("stylechanged",{style:u.name,map:l.map,type:"stylechanged"})},this._lookUp=function(u){var h,g,w=(D=l.definitions()).errorIfRejected(),T=D.resultIfResolved();if(w||!T)return null;var D=T.configurations,P=void 0;try{for(var N=Uae(D),z=N.next();!z.done;z=N.next()){var W=z.value;if(W.name===u.style)return W;W.name===T.defaultConfiguration&&(P=P||W)}}catch(ue){h={error:ue}}finally{try{z&&!z.done&&(g=N.return)&&g.call(N)}finally{if(h)throw h.error}}return P||D[0]},this._lookUpAsync=function(u){return lD(l,void 0,void 0,function(){var h;return j7(this,function(g){switch(g.label){case 0:return[4,this.definitions()];case 1:return[2,(h=g.sent()).configurations.find(function(w){return w.name===(u.style||h.defaultConfiguration)})||h.configurations.find(function(w){return w.name===h.defaultConfiguration})||h.configurations[0]]}})})},this.map=o,this.serviceOptions=i}return a.prototype.updateIndoorState=function(o,i){var l,u,h=this,g=this.map.styles.getMapConfiguration();g?(this.preservedPreindoorMapConfiguration=g,l=this.map.getStyle().style?"".concat(this.map.getStyle().style,"_indoor").concat("dark"===o?"_dark":"","_tileset_").concat(i):void 0,this.map.styles.setMapConfiguration("defaultIndoor_".concat(i),"microsoft-maps:default"===g?l:void 0)):(u=(null==(g=this.indoorState)?void 0:g.tilesetId)!==i,this.indoorState={tilesetId:i,theme:o},this.initStyleset(),this.definitions().then(function(w){var D=(h.map.getStyle().style||w.defaultConfiguration).replace("_indoor_dark","").replace("_indoor",""),T="".concat(D,"_indoor");(D=w.configurations.find(function(P){return P.name.startsWith(T)}))&&h.map.setStyle({style:D.name},!u)}))},a.prototype.unsetIndoorState=function(){var o=this,i=this.preservedPreindoorMapConfiguration;i?this.map.styles.setMapConfiguration(i):(this.indoorState=void 0,this.initStyleset(),this.definitions().then(function(l){var u=o.map.getStyle().style;u.includes("_indoor")&&u.split("_indoor")[0]?o.map.setStyle({style:u.split("_indoor")[0]}):o.map.setStyle({style:void 0})}))},a.prototype.initStyleset=function(){var o,i=this;return o=this.serviceOptions.mapConfiguration?"string"==typeof this.serviceOptions.mapConfiguration?(o=this.map.authentication?this.map.authentication.initialize():Promise.resolve(),new NN(o.then(function(){return i._request(i.serviceOptions.domain,"".concat("styles","/mapconfigurations/metadata/").concat(i.serviceOptions.mapConfiguration),"StyleDefinitions").then(function(l){return $f($f({},l),{defaultConfiguration:l.defaultConfiguration||l.defaultStyle,configurations:l.configurations||l.styles})})}))):NN.resolve(this.serviceOptions.mapConfiguration):(o=this.map.authentication?this.map.authentication.initialize():Promise.resolve(),new NN(o.then(function(){return i._request(i.serviceOptions.staticAssetsDomain,"".concat("styling","/").concat("styles"),"StyleDefinitions",{version:i.serviceOptions.styleDefinitionsVersion,mcv:Yp.replace(/\./g,"")}).then(function(l){return{version:isNaN(l.version)?0:parseFloat(l.version),defaultConfiguration:l.defaultStyle,configurations:l.styles.filter(function(u){return i.indoorState?u.name.endsWith("auto"===i.indoorState.theme?"dark"===u.theme?"_indoor_dark":"_indoor":"dark"===i.indoorState.theme?"_indoor_dark":"_indoor"):!u.name.includes("indoor")}).map(function(u){return{copyright:u.copyright.join(" "),name:u.name,displayName:(h=u.name,(h=i.indoorState&&h.includes("_indoor")?h.split("_indoor")[0]:h)in LN?LN[h]:h),theme:u.theme,thumbnail:new vu({domain:i.serviceOptions.staticAssetsDomain,path:u.thumbnail,protocol:"https"}).toString(),url:new vu({domain:i.serviceOptions.staticAssetsDomain,path:"".concat("styling","/").concat("styles","/").concat(u.name),queryParams:{styleVersion:null!=l.version?l.version:i.serviceOptions.styleDefinitionsVersion,mcv:Yp.replace(/\./g,"")},protocol:"https"}).toString()};var h})}})}))),this.initPromise&&this.initPromise.switchWith(o),this.initPromise=o,this.initPromise.then(function(l){return i.map._invokeEvent("mapconfigurationchanged",l)}),this.initPromise},a.prototype.getStyle=function(o){if(!(o=this._lookUp(o)))throw Error("Style definition is not available.");if(o.url)return o.url;if(o.style)return o.style;throw Error("Style definition neither contains URL nor style object.")},a.prototype.deriveNewStyleAndLayerGroups=function(o,i){for(var l,u,h=this.map.getStyle(),g=this.map.getTraffic(),w={},T=0;T<i.layers.length;T++){var D=i.layers[T],P=Bae.getLayerGroup(D);P?(w[P]||(w[P]=[]),w[P].push(D),h.showBuildingModels||"fill-extrusion"!==D.type?"fill-extrusion"===D.type&&(D.layout=null!=(l=D.layout)?l:{},D.layout.visibility="visible"):(D.layout=null!=(l=D.layout)?l:{},D.layout.visibility="none"),"none"!==g.flow&&P&&P==="traffic_".concat(g.flow)&&"line"==D.type&&(D.layout=null!=(u=D.layout)?u:{},D.layout.visibility="visible"),"labels"!==P&&"labels_places"!==P&&"labels_indoor"!==P||"symbol"!==D.type||(h.showLabels&&"none"!==(null==(u=D.layout)?void 0:u.visibility)?(D.layout=null!=(P=D.layout)?P:{},D.layout.visibility="visible"):(D.layout=null!=(P=D.layout)?P:{},D.layout.visibility="none"))):w[D.id]=[D]}return[i,w]},a.prototype.injectUserLayersIntoStyle=function(o,i,l){return o?this.map.layers._getUserLayers().reduce(function(u,h){var g,w,T,D;return h.layer instanceof pQ||(g=(null==(w=null==(w=l?.[h.before])?void 0:w[0])?void 0:w.id)||h.before,w=o.layers.find(function(P){return P.id===h.layer.getId()}),-1<(T=i.layers.findIndex(function(P){return P.id===h.layer.getId()}))&&i.layers.splice(T,1),w&&(T=new Set(Array.from(h.layer._getSourceIds()).map(function(P){var N;return!u.sources[P]&&(N=o.sources[P])?{source:N,id:P}:void 0}).filter(function(P){return void 0!==P})),-1<(D=g?u.layers.findIndex(function(P){return P.id===g}):-1)?u.layers.splice(D,0,w):u.layers.push(w),T.forEach(function(z){var N=z.source;u.sources[z=z.id]=N}))),u},$f({},i)):i},a.prototype.setStyle=function(o,i){var l=this,u=(void 0===i&&(i=!0),this._lookUp(o));if(!u)throw Error("Style definition ".concat(o.style," is not available."));if(!u.url&&!u.style)throw Error("Style definition neither contains URL nor style object.");var h=function(){return l._onStyleData(u)},g=function(){l.map.events.remove("styledata",h),l.map.events.addOnce("styledata",h)},w=o&&o.customStyleTransform?function(T,D){return T=o.customStyleTransform(T,D),g(),T}:function(z,P){var W=$f($f({},P),{layers:H7([],cD(P.layers),!1),sources:$f({},P.sources)}),N=(W=((N=o.progressiveLoading&&!l.map._isLoaded())&&Array.isArray(P?.layers)&&((W=$f({},P)).layers=W.layers.map(function(ue){var ge=$f({},ue);return ue.layout&&(ge.layout=$f({},ue.layout)),ge})),P=cD(l.deriveNewStyleAndLayerGroups(z,W),2))[0],P=P[1],N&&(N=o.progressiveLoadingInitialLayerGroups,Array.isArray(N))&&0<N.length&&l._deferLayerGroupVisibilities(P,N),l.injectUserLayersIntoStyle(z,W,P));return z=Object.entries(P).map(function(we){var ge=(we=cD(we,2))[0];return l._buildFundamentalLayerFrom(we=we[1],ge)}),W=l.map.layers._getUserLayers().reduce(function(ue,ge){var we=ge.before?ue.findIndex(function(Re){return Re.getId()===ge.before}):-1;return-1<we?ue.splice(we,0,ge.layer):ue.push(ge.layer),ue},z),l.map.layers.layerIndex=W,l.map.sources._syncSources(N.sources),g(),N};this.map._getMap().setStyle(u.url||u.style,{diff:i,validate:this.serviceOptions.validateStyle,transformStyle:w})},a.prototype.getTheme=function(o){if(o=this._lookUp(o))return o.theme.toLowerCase()},a.prototype.getThemeAsync=function(o){return lD(this,void 0,void 0,function(){return j7(this,function(i){switch(i.label){case 0:return[4,this._lookUpAsync(o)];case 1:return[2,i.sent().theme]}})})},a.prototype.setMapConfiguration=function(o,i){var l=this;"string"==typeof(this.serviceOptions.mapConfiguration=o)?this.initStyleset():this.initPromise?this.initPromise.hijackAndResolve(o):this.initPromise=NN.resolve(o),this.definitions().then(function(u){var h=u.defaultConfiguration;u.configurations.find(function(g){return g.name===i})&&(h=i),l.map.setStyle({style:h})})},a.prototype.getMapConfiguration=function(){return this.serviceOptions.mapConfiguration},a.prototype.setStyleSet=function(o){this.updateIndoorState("indoor_dark"===o?"dark":"light",null)},a.prototype.getStyleSet=function(){return void 0!==this.indoorState?"dark"===this.indoorState.theme?"indoor_dark":"indoor":"base"},a.prototype.clearStyleSet=function(){this.unsetIndoorState()},a.prototype._buildFundamentalLayerFrom=function(o,i){if(o&&0<o.length)return(o=new Ep(o,i)).onAdd(this.map),o;throw new Error("Unable to construct fundamental map layer for ID: ".concat(i,"."))},a.prototype._transformStyleRequest=function(o,i){o.includes("{{azMapsDomain}}")&&(i.url=i.url.replace("{{azMapsDomain}}",this.serviceOptions.domain)),o.includes("{{azMapsStylingPath}}")&&(i.url=i.url.replace("{{azMapsStylingPath}}","styling")),o.includes("{{azMapsStylePath}}")&&(i.url=i.url.replace("{{azMapsStylePath}}","styles")),(i.url.toLocaleLowerCase().includes(this.serviceOptions.domain.toLocaleLowerCase())||i.url.toLocaleLowerCase().includes(this.serviceOptions.staticAssetsDomain.toLocaleLowerCase()))&&((o=new URL(i.url)).searchParams.get("api-version")||(o.searchParams.set("api-version",this.serviceOptions.styleAPIVersion),i.url=o.href),null!=(o=this.map.authentication)&&o.signRequest(i),this._deleteAuthTokenForStaticAssets(i))},a.prototype._request=function(o,i,l,u){var h;return void 0===u&&(u={}),lD(this,void 0,void 0,function(){var g,w;return j7(this,function(T){switch(T.label){case 0:return w={url:new vu({protocol:"https",domain:o,path:i,queryParams:$f(((w={})["api-version"]=this.serviceOptions.styleAPIVersion,w),u)}).toString()},"function"==typeof this.serviceOptions.transformRequest&&l&&(w=this.serviceOptions.transformRequest(w.url,l)),null!=(h=this.map.authentication)&&h.signRequest(w),this._deleteAuthTokenForStaticAssets(w),g={method:"GET",mode:"cors"},w.credentials&&(g.credentials=w.credentials),w.headers&&(g.headers=w.headers),[4,fetch(w.url,g).then(function(D){if(D.ok)return D.json();throw new Error("HTTP ".concat(D.status,": ").concat(D.statusText," "))})];case 1:return[2,T.sent()]}})})},a.prototype._deleteAuthTokenForStaticAssets=function(o){o.url.startsWith("https://".concat(this.serviceOptions.staticAssetsDomain,"/").concat("styling"))&&(delete o.headers["x-ms-client-id"],delete o.headers.Authorization)},a}(),$7=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},Tte=function(){function a(o){this.map=o,this.indicators=new Set}return a.prototype.add=function(o){var i,l;o=Array.isArray(o)?o:[o];try{for(var u=$7(o),h=u.next();!h.done;h=u.next()){var g=h.value;this.indicators.has(g)||(this.indicators.add(g),g.attach(this.map))}}catch(w){i={error:w}}finally{try{h&&!h.done&&(l=u.return)&&l.call(u)}finally{if(i)throw i.error}}},a.prototype.clear=function(){var o=this;this.indicators.forEach(function(i){o.indicators.delete(i),i.remove()})},a.prototype.remove=function(o){var i,l;o=Array.isArray(o)?o:[o];try{for(var u=$7(o),h=u.next();!h.done;h=u.next()){var g=h.value;this.indicators.has(g)&&(this.indicators.delete(g),g.remove())}}catch(w){i={error:w}}finally{try{h&&!h.done&&(l=u.return)&&l.call(u)}finally{if(i)throw i.error}}},a.prototype.getIndicators=function(){return Array.from(this.indicators)},a.prototype._getCollectionDiv=function(){var o=this.map.getMapContainer().querySelector(".".concat(a.Css.collection));return o||((o=document.createElement("div")).setAttribute("aria-label","map data"),o.setAttribute("role","listbox"),o.classList.add(a.Css.collection),this.map.getMapContainer().appendChild(o)),o},a.Css={collection:"accessible-indicator-collection-container"},a}(),Cte=window&&window.__extends||function(){var a=function(o,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,u){l.__proto__=u}:function(l,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(l[h]=u[h])}))(o,i)};return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function l(){this.constructor=o}a(o,i),o.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}(),Tg=window&&window.__assign||function(){return(Tg=Object.assign||function(a){for(var o,i=1,l=arguments.length;i<l;i++)for(var u in o=arguments[i])Object.prototype.hasOwnProperty.call(o,u)&&(a[u]=o[u]);return a}).apply(this,arguments)},Hae=window&&window.__awaiter||function(a,o,i,l){return new(i=i||Promise)(function(u,h){function g(D){try{T(l.next(D))}catch(P){h(P)}}function w(D){try{T(l.throw(D))}catch(P){h(P)}}function T(D){var P;D.done?u(D.value):((P=D.value)instanceof i?P:new i(function(N){N(P)})).then(g,w)}T((l=l.apply(a,o||[])).next())})},$ae=window&&window.__generator||function(a,o){var i,l,u,h={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},g={next:w(0),throw:w(1),return:w(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function w(T){return function(D){var P=[T,D];if(i)throw new TypeError("Generator is already executing.");for(;h=g&&P[g=0]?0:h;)try{if(i=1,l&&(u=2&P[0]?l.return:P[0]?l.throw||((u=l.return)&&u.call(l),0):l.next)&&!(u=u.call(l,P[1])).done)return u;switch(l=0,(P=u?[2&P[0],u.value]:P)[0]){case 0:case 1:u=P;break;case 4:return h.label++,{value:P[1],done:!1};case 5:h.label++,l=P[1],P=[0];continue;case 7:P=h.ops.pop(),h.trys.pop();continue;default:if(!(u=0<(u=h.trys).length&&u[u.length-1])&&(6===P[0]||2===P[0])){h=0;continue}if(3===P[0]&&(!u||P[1]>u[0]&&P[1]<u[3]))h.label=P[1];else if(6===P[0]&&h.label<u[1])h.label=u[1],u=P;else{if(!(u&&h.label<u[2])){u[2]&&h.ops.pop(),h.trys.pop();continue}h.label=u[2],h.ops.push(P)}}P=o.call(a,h)}catch(N){P=[6,N],l=0}finally{i=u=0}if(5&P[0])throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}}},Ite=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},xp=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},Tp=window&&window.__values||function(a){var o="function"==typeof Symbol&&Symbol.iterator,i=o&&a[o],l=0;if(i)return i.call(a);if(a&&"number"==typeof a.length)return{next:function(){return{value:(a=a&&l>=a.length?void 0:a)&&a[l++],done:!a}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},Cg=function(a){function o(i,l){var u,h,g=a.call(this)||this,w=(g.removed=!1,g.loaded=!1,g.ready=!1,g._resizeCallback=function(){return g.resize()},!0);g._updateGlobalDefaults(l),g.serviceOptions=(new m5).merge(l),g.styleOptions=(new p5).merge(l),g.trafficOptions=new $M,g.styles=new zae(g,g.serviceOptions),g.insights=new Dx(g.serviceOptions),g.serviceOptions.authOptions.subscriptionKey&&(g.serviceOptions.authOptions.subscriptionKey=encodeURIComponent(g.serviceOptions.authOptions.subscriptionKey)),u=g.serviceOptions.authOptions.clientId||(g.serviceOptions.authOptions.subscriptionKey?g.serviceOptions.authOptions.subscriptionKey.replace(/.(?=.{3,}$)/g,"*"):"invalid-setting"),g.insights&&g.insights.setAuthenticatedUserContext(g.serviceOptions.sessionId,u),arguments[2]&&"ENVIRONMENT"in window&&window.ENVIRONMENT.hmr?(h=arguments[2],g.ready=!0,g.loaded=!0):h=new Ka.Map(u={antialias:g.styleOptions.antialias,attributionControl:!1,container:i,fadeDuration:g.serviceOptions.fadeDuration,localIdeographFontFamily:g.serviceOptions.localIdeographFontFamily,preserveDrawingBuffer:g.styleOptions.preserveDrawingBuffer,refreshExpiredTiles:g.serviceOptions.refreshExpiredTiles,renderWorldCopies:g.styleOptions.renderWorldCopies,trackResize:!1,transformRequest:function(N,z){var W={url:N};return"Tile"===z||"Source"===z?(N.includes("{azMapsDomain}")&&g.insights&&g.insights.trackEvent({name:"TileLoad"}),g._substituteDomainLanguageViewAndSignInRequest(N,W)):"Style"!==z&&"SpriteJSON"!==z&&"SpriteImage"!==z&&"Glyphs"!==z||g.styles._transformStyleRequest(N,W),g.serviceOptions.transformRequest&&ZH(W,g.serviceOptions.transformRequest(W.url,z)),W}});try{g.map=h,g.authentication=new R7(g),g.controls=new k7(g),g.events=new O7(g),g.imageSprite=new hte(g),g.layers=new V7(g),g.markers=new ute(g),g.sources=new fte(g),g.popups=new B7(g),g.indicators=new Tte(g),g.map.getContainer().classList.add(o.Css.container),g.map.getCanvasContainer().classList.add(o.Css.canvasContainer),g.map.getCanvas().classList.add(o.Css.canvas),g._detectHighContrast(),g.copyrightControl=new rw({showFeedbackLink:g.styleOptions.showFeedbackLink,showLogo:g.styleOptions.showLogo,customAttribution:g.styleOptions.customAttribution}),g.controls.add(g.copyrightControl,{position:Ll.NonFixed}),g.logoControl=new xee({showLogo:g.styleOptions.showLogo}),g.controls.add(g.logoControl,{position:Ll.BottomLeft});var T=g.authentication?g.authentication.initialize():Promise.resolve();if(g.removed)return g;var D=function(){g.loaded=!0,g.map.off("load",D)},P=(g.map.on("load",D),function(){g.ready=!0,g.map.off("styledata",P),g.events.invoke("ready",{map:g,type:"ready"})});g.map.on("styledata",P),g._setAutoResize(g.styleOptions.autoResize),g.map.showTileBoundaries=g.styleOptions.showTileBoundaries,g.localizedStringsPromise=EC.getStrings(g.styleOptions.language),T.then(function(){return g.styles.definitions()}).then(function(N){if(!g.removed){if(g.authentication&&!g.authentication.getToken())throw new Error("AuthenticationManager finished initializing, but no token is available");g.serviceOptions["enable-accessibility"]&&g.accessibleMapDelegate.addToMap(),g._setStyleComponents(g.styleOptions),g.copyrightDelegate&&g.copyrightDelegate.addToMap()}}).catch(function(N){N=N instanceof Error?N:new Error(N),g.insights.trackException({error:N}),g.events.invoke("error",N={map:g,type:"error",error:N})}),g.setCamera(Tg(Tg({minZoom:1},l),{type:"jump",duration:0})),g.incidentDelegate=new Dee(g),g.flowDelegate=new Cee(g),g.accessibleMapDelegate=new Tee(g),g.userInteractionDelegate=new r7(g,l),g.userInteractionDelegate.addToMap(),g.copyrightDelegate=new Nee(g,g.copyrightControl,g.styleOptions)}catch(N){throw w=!1,g.insights.trackException({error:N instanceof Error?N:new Error(N)}),N}finally{g.insights.trackEvent({name:"MapLoad"},{success:w,supported:pb(),supportedWithPerformance:pb({failIfMajorPerformanceCaveat:!0})}),g.insights.flush()}return g}return Cte(o,a),Object.defineProperty(o.prototype,"isDisposed",{get:function(){return this.removed},enumerable:!1,configurable:!0}),o.prototype.getCanvas=function(){return this.map.getCanvas()},o.prototype.getCanvasContainer=function(){return this.map.getCanvasContainer()},o.prototype.getMapContainer=function(){return this.map.getContainer()},o.prototype.getServiceOptions=function(){return ai(this.serviceOptions,m5._cloneCustomizer)},o.prototype.setServiceOptions=function(i){this.serviceOptions=(new m5).merge(this.serviceOptions,i),this.serviceOptions["enable-accessibility"]?this.accessibleMapDelegate.addToMap():this.accessibleMapDelegate.removeFromMap(),i=this.styles.serviceOptions.mapConfiguration!==this.serviceOptions.mapConfiguration||this.styles.serviceOptions.staticAssetsDomain!==this.serviceOptions.staticAssetsDomain||this.styles.serviceOptions.styleDefinitionsVersion!==this.serviceOptions.styleDefinitionsVersion||this.styles.serviceOptions.domain!==this.serviceOptions.domain||this.styles.serviceOptions.styleAPIVersion!==this.serviceOptions.styleAPIVersion,this.styles.serviceOptions=this.serviceOptions,i&&(this.styles.initPromise=null,this.setStyle({}))},o.prototype.addRequestTransformer=function(i){this.serviceOptions.addTransformer(i)},o.prototype.removeRequestTransformer=function(i){this.serviceOptions.removeTransformer(i)},o.prototype.setCamera=function(i,l){if(void 0===l&&(l=!1),"padding"in i||"offset"in i||"bounds"in i){var u,w=(new vte).merge({maxZoom:this.getCamera().maxZoom},i),h=this._generateSafeBounds(w.bounds);if(!(u=this.map.cameraForBounds(h,T={padding:w.padding,offset:w.offset,maxZoom:w.maxZoom})))throw g={message:"The map cannot be fit to the current canvas with the given CameraBoundsOptions.",containerWidth:null==(g=null==(g=this.map)?void 0:g.getContainer())?void 0:g.clientWidth,containerHeight:g?.clientHeight,safeBounds:h,cameraForBoundsOptions:T},new Error(JSON.stringify(g));"pitch"in i&&(u.pitch=i.pitch),"bearing"in i&&(u.bearing=i.bearing),"minPitch"in i&&this.map.setMinPitch(i.minPitch),"maxPitch"in i&&this.map.setMaxPitch(i.maxPitch),"minZoom"in i&&this.map.setMinZoom(i.minZoom),h=this._generateSafeBounds(w.maxBounds)}else(T=(new wte).merge(this.getCamera(),i)).centerOffset&&2<=T.centerOffset.length&&(g=T.centerOffset,(w=Ur([T.center],T.zoom))[0][0]+=g[0],w[0][1]+=g[1],T.center=r2(w,T.zoom)[0]),u={center:T.center,zoom:T.zoom,bearing:T.bearing,pitch:T.pitch,around:void 0},T.minZoom<1&&console.warn("Setting minZoom below 1 may result in an empty map when the zoom level is less than 1."),this.map.setMinZoom(T.minZoom),this.map.setMaxZoom(T.maxZoom),T.minPitch&&this.map.setMinPitch(T.minPitch),T.maxPitch&&this.map.setMaxPitch(T.maxPitch),this._invokeEvent("minzoomchanged",this.map.getMinZoom()),this._invokeEvent("maxzoomchanged",this.map.getMaxZoom()),h=this._generateSafeBounds(T.maxBounds);this.map.setMaxBounds(h||null);var g=(new Tae).merge(i),T=(w={duration:g.duration,easing:function(D){return D},offset:[0,0],animate:!0},{fromControl:l});"jump"===g.type?this.map.jumpTo(u,T):"ease"===g.type?this.map.easeTo(Tg(Tg({},u),w),T):"fly"===g.type&&this.map.flyTo(Tg(Tg({},u),w),T)},o.prototype.setCameraBounds=function(i){this.setCamera(i)},o.prototype.getCamera=function(){var i=this.map.getBounds().getSouthWest().toArray(),l=this.map.getBounds().getNorthEast().toArray();return{zoom:this.map.getZoom(),center:this.map.getCenter().toArray(),bearing:this.map.getBearing(),pitch:this.map.getPitch(),bounds:new gi(i,l),minZoom:this.map.getMinZoom(),maxZoom:this.map.getMaxZoom()}},o.prototype.setStyle=function(i,l){void 0===l&&(l=!0),delete i.preserveDrawingBuffer,(i=(new p5).merge(this.styleOptions,i)).autoResize!==this.styleOptions.autoResize&&this._setAutoResize(i.autoResize),i.language!==this.styleOptions.language&&(this.localizedStringsPromise=EC.getStrings(i.language)),i.renderWorldCopies!==this.styleOptions.renderWorldCopies&&this.map.setRenderWorldCopies(i.renderWorldCopies),i.showFeedbackLink!==this.styleOptions.showFeedbackLink&&this.copyrightControl.setOptions({showFeedbackLink:i.showFeedbackLink}),i.customAttribution!==this.styleOptions.customAttribution&&this.copyrightControl.setOptions({customAttribution:i.customAttribution}),i.showLogo!==this.styleOptions.showLogo&&(this.copyrightControl.setOptions({showLogo:i.showLogo}),this.logoControl.setOptions({showLogo:i.showLogo})),i.showTileBoundaries!==this.styleOptions.showTileBoundaries&&(this.map.showTileBoundaries=i.showTileBoundaries),i.showBuildingModels&&console.warn("showBuildingModels is deprecated."),l=l&&this.styleOptions.language===i.language&&this.styleOptions.view===i.view,this.styleOptions=i,this._setStyleComponents(i,l)},o.prototype.getStyle=function(){return Ki(this.styleOptions)},o.prototype.addIcon=function(i,l){this.imageSprite.add(i,l)},o.prototype.addPins=function(i,u){u=(new Dae).merge(u);var h=this.layers.getLayerById(u.name),g=!1;if(h||(g=!0,h=new ES("".concat(u.name,"-source"),u.name,{source:"".concat(u.name,"-source"),minZoom:u.minZoom,maxZoom:u.maxZoom,iconOptions:{anchor:"center",size:u.iconSize,image:["case",["has","icon"],["get","icon"],u.icon],ignorePlacement:!u.cluster,opacity:u.opacity},textOptions:{anchor:"center",textField:["case",["has","point_count"],["to-string",["get","point_count"]],["has","title"],["to-string",["get","title"]],u.title],font:["case",["has","point_count"],["literal",["StandardFontCondensed-Bold"]],["literal",[u.textFont]]],size:["case",["has","point_count"],20,u.fontSize],ignorePlacement:!u.cluster,opacity:u.opacity,offset:["case",["has","point_count"],["literal",[.5,-.45]],["literal",[u.textOffset[0]/16,u.textOffset[1]/16]]],color:u.fontColor}})),!(h instanceof ES))throw new Error("A layer with name '".concat(u.name,"' already exists but it is not a SymbolLayer.")+"A SymbolLayer should be used for rendering pins.");var w=h.getSource(),T=("string"==typeof w?w=this.sources.getById(D=w):D=w.getId(),!1);if(w||(T=!0,w=new Wl(D,{cluster:u.cluster})),!(w instanceof Wl))throw new Error("The source with name '".concat(D,"' already exists but it is not a DataSource.")+"New data can only be added to a DataSource.");T&&this.sources.add(w),g&&this.layers.add(h,u.before);var D=new Zv(i);u.overwrite?w.setShapes(D):w.add(D)},o.prototype.addCircles=function(i,u){u=(new aD).merge(u);var h=this.layers.getLayerById(u.name),g=!1;if(h||(g=!0,h=new C4("".concat(u.name,"-source"),u.name,{source:"".concat(u.name,"-source"),minZoom:u.minZoom,maxZoom:u.maxZoom,opacity:u.opacity,radius:["case",["has","radius"],["get","radius"],u.radius],color:["case",["has","color"],["get","color"],u.color],strokeColor:["case",["has","outlineColor"],["get","outlineColor"],u.outlineColor],strokeWidth:["case",["has","outlineWidth"],["get","outlineWidth"],u.outlineWidth]})),!(h instanceof C4))throw new Error("A layer with name '".concat(u.name,"' already exists but it is not a BubbleLayer.")+"A BubbleLayer should be used for rendering circles.");var w=h.getSource(),T=("string"==typeof w?w=this.sources.getById(D=w):D=w.getId(),!1);if(w||(T=!0,w=new Wl(D)),!(w instanceof Wl))throw new Error("The source with name '".concat(D,"' already exists but it is not a DataSource.")+"New data can only be added to a DataSource.");T&&this.sources.add(w),g&&this.layers.add(h,u.before);var D=new Zv(i);u.overwrite?w.setShapes(D):w.add(D)},o.prototype.addLinestrings=function(i,u){u=(new Ete).merge(u);var h=this.layers.getLayerById(u.name),g=!1;if(h||(g=!0,h=new Xh("".concat(u.name,"-source"),u.name,{source:"".concat(u.name,"-source"),minZoom:u.minZoom,maxZoom:u.maxZoom,lineCap:u.cap,lineJoin:u.join,strokeOpacity:u.opacity,strokeColor:["case",["has","color"],["get","color"],u.color],strokeWidth:["case",["has","width"],["get","width"],u.width]})),!(h instanceof Xh))throw new Error("A layer with name '".concat(u.name,"' already exists but it is not a LineLayer.")+"A LineLayer should be used for rendering linestrings.");var w=h.getSource(),T=("string"==typeof w?w=this.sources.getById(D=w):D=w.getId(),!1);if(w||(T=!0,w=new Wl(D)),!(w instanceof Wl))throw new Error("The source with name '".concat(D,"' already exists but it is not a DataSource.")+"New data can only be added to a DataSource.");T&&this.sources.add(w),g&&this.layers.add(h,u.before);var D=new Zv(i);u.overwrite?w.setShapes(D):w.add(D)},o.prototype.addPolygons=function(i,u){u=(new Pae).merge(u);var h=this.layers.getLayerById(u.name),g=!1;if(h||(g=!0,h=new Ty("".concat(u.name,"-source"),u.name,{source:"".concat(u.name,"-source"),minZoom:u.minZoom,maxZoom:u.maxZoom,fillOpacity:u.opacity,fillColor:["case",["has","color"],["get","color"],u.color]})),!(h instanceof Ty))throw new Error("A layer with name '".concat(u.name,"' already exists but it is not a PolygonLayer.")+"A PolygonLayer should be used for rendering linestrings.");var w=h.getSource(),T=("string"==typeof w?w=this.sources.getById(D=w):D=w.getId(),!1);if(w||(T=!0,w=new Wl(D)),!(w instanceof Wl))throw new Error("The source with name '".concat(D,"' already exists but it is not a DataSource.")+"New data can only be added to a DataSource.");T&&this.sources.add(w),g&&this.layers.add(h,u.before);var D=new Zv(i);u.overwrite?w.setShapes(D):w.add(D)},o.prototype.addRaster=function(i,h){h=(new Mae).merge(h);var u,g=this.layers.getLayerById(h.name);if(!((g=g||new D4({maxZoom:h.maxZoom,minZoom:h.minZoom,opacity:h.opacity,tileSize:256,tileUrl:"{subdomain}"},h.name))instanceof D4))throw new Error("A layer with name '".concat(h.name,"' already exists but it is not a TileLayer.")+"A TileLayer should be used for rendering raster images.");if("{subdomain}"!==g.getOptions().tileUrl)throw new Error("A TileLayer with name '".concat(h.name,"' already exists but was configured ")+"for a single tile url [default for new TileLayer(...)].");(u=!h.overwrite&&g.getOptions().subdomains||[]).push.apply(u,xp([],Ite(i),!1)),g._setOptionsNoUpdate({subdomains:u}),this.layers.add(g,h.before)},o.prototype.getLayers=function(){return this.layers.getLayers().map(function(i){return i.getId()})},o.prototype.removeLayers=function(i){var l,u;try{for(var h=Tp(i),g=h.next();!g.done;g=h.next()){var w,T=g.value;this.layers.getLayerById(T)&&(this.layers.remove(T),w="".concat(T,"-source"),this.sources.getById(w))&&this.sources.remove(w)}}catch(D){l={error:D}}finally{try{g&&!g.done&&(u=h.return)&&u.call(h)}finally{if(l)throw l.error}}},o.prototype.addHtml=function(i,l){i.id||(i.id="marker_".concat(dm()));var u=new f2({htmlContent:i});return this.markers.add(u,l),i.id},o.prototype.removeHtml=function(i){this.markers.remove(i)},o.prototype.addEventListener=function(i,l,u){this.events._addLegacy(i,l,u)},o.prototype.removeEventListener=function(i,l,u){this.events._removeLegacy(i,l,u)},o.prototype.setUserInteraction=function(i){this.userInteractionDelegate.setOptions(i)},o.prototype.getUserInteraction=function(){return this.userInteractionDelegate.getOptions()},o.prototype.addControl=function(i,l){this.controls.add(i,l)},o.prototype.removeControl=function(i){this.controls.remove(i)},o.prototype.setTraffic=function(i){var l=this.trafficOptions.incidents,u=this.trafficOptions.flow;if(this.trafficOptions=(new $M).merge(this.trafficOptions,i),this.controls.getControls().filter(function(h){return h instanceof XH}).forEach(function(h){return h.updateButtonState()}),this.incidentDelegate&&(this.trafficOptions.incidents?l||this.incidentDelegate.addToMap():this.incidentDelegate.removeFromMap()),this.trafficOptions.flow&&"none"!==this.trafficOptions.flow){["absolute","relative-delay"].includes(this.trafficOptions.flow)&&console.warn("The 'absolute' and 'relative-delay' flow options are deprecated. Please use 'relative' instead.");try{this.trafficOptions.flow!==u&&this.flowDelegate.addToMap()}catch(h){throw this.trafficOptions.flow=u,h}}else this.flowDelegate.removeFromMap()},o.prototype.getTraffic=function(){return Ki(this.trafficOptions)},o.prototype.remove=function(){this.dispose()},o.prototype.clear=function(){this.popups.clear(),this.layers.clear(),this.sources.clear(),this.markers.clear(),this.indicators.clear()},o.prototype.dispose=function(){var i;for(this.clear(),this.map.remove(),null!=(i=this.authentication)&&i.dispose(),this.removed=!0,null!=(i=this.resizeObserver)&&i.disconnect(),this.resizeObserver=null;this.getMapContainer().firstChild;){var l=this.getMapContainer().firstChild;this.getMapContainer().removeChild(l)}},o.prototype.resize=function(i,l,u){"number"!=typeof i&&"string"!=typeof i||"number"!=typeof l&&"string"!=typeof l?u=i:(this.getMapContainer().style.height="number"==typeof i?"".concat(i,"px"):i,this.getMapContainer().style.width="number"==typeof l?"".concat(l,"px"):l),i=this.getMapContainer().style.overflow,this.getMapContainer().style.overflow="hidden",this.map.resize(u),this.getMapContainer().style.overflow=i},o.prototype.pixelsToPositions=function(i){var l,u,h=[];try{for(var g=Tp(i),w=g.next();!w.done;w=g.next()){var D=this.map.unproject(w.value);h.push(new Kl(D.lng,D.lat))}}catch(P){l={error:P}}finally{try{w&&!w.done&&(u=g.return)&&u.call(g)}finally{if(l)throw l.error}}return h},o.prototype.positionsToPixels=function(i){var l,u,h=[];try{for(var g=Tp(i),w=g.next();!w.done;w=g.next()){var D=this.map.project(w.value);h.push(new _l(D.x,D.y))}}catch(P){l={error:P}}finally{try{w&&!w.done&&(u=g.return)&&u.call(g)}finally{if(l)throw l.error}}return h},o.prototype.areTilesLoaded=function(){return this.map.areTilesLoaded()},o.prototype.stop=function(){this.map.stop()},o.prototype.triggerRepaint=function(){this.map.triggerRepaint()},o.prototype.enableElevation=function(i,l){this.map.setTerrain("string"==typeof i?{source:i,exaggeration:l}:{source:i.getId(),exaggeration:l})},o.prototype.disableElevation=function(){this.map.setTerrain(null)},o.prototype._getMap=function(){return this.map},o.prototype._rebuildStyle=function(i){return void 0===i&&(i=!0),Hae(this,void 0,void 0,function(){return $ae(this,function(l){return this.styles.setStyle(this.styleOptions,i),this.imageSprite._restoreImages(),[2]})})},o.prototype._isLoaded=function(){return this.loaded},o.prototype._isReady=function(){return this.ready},o.prototype._getLocalizedStrings=function(){return this.localizedStringsPromise},o.prototype._sendRequest=function(i,l,u){var h;return(h="function"==typeof this.serviceOptions.transformRequest?this.serviceOptions.transformRequest(i,l):h)?fetch(h.url||i,{credentials:h.credentials,headers:Tg(Tg({},u),h.headers),method:"GET",mode:"cors"}):fetch(i,{headers:u,method:"GET",mode:"cors"})},o.prototype._substituteDomainLanguageViewAndSignInRequest=function(i,l){var u;(i.includes("{azMapsDomain}")||i.includes("{{azMapsDomain}}"))&&(u=new RegExp("[^{]".concat("{azMapsDomain}","[^}]")),i.match(u)&&(l.url=l.url.replace("{azMapsDomain}","{{azMapsDomain}}")),vu.protoRegEx.test(this.serviceOptions.domain)?(u=l.url.indexOf("{{azMapsDomain}}"),l.url=this.serviceOptions.domain+l.url.substring(u+16)):l.url=l.url.replace("{{azMapsDomain}}",this.serviceOptions.domain)),(l.url.toLocaleLowerCase().includes(this.serviceOptions.domain.toLocaleLowerCase())||l.url.toLocaleLowerCase().includes(this.serviceOptions.staticAssetsDomain.toLocaleLowerCase()))&&null!=(u=this.authentication)&&u.signRequest(l),i.includes("{{azMapsLanguage}}")&&(l.url=l.url.replace("{{azMapsLanguage}}",this.styleOptions.language)),i.includes("{{azMapsView}}")&&(l.url=this.styleOptions.view?l.url.replace("{{azMapsView}}",this.styleOptions.view):l.url.replace("{{azMapsView}}","").replace("&".concat("view","="),""))},o.prototype._setAutoResize=function(i){i?(this.resizeObserver||(this.resizeObserver=new ResizeObserver(this._resizeCallback)),this.resizeObserver.observe(this.map.getContainer())):this.resizeObserver&&this.resizeObserver.unobserve(this.map.getContainer())},o.prototype._setStyleComponents=function(i,l){var u=this;void 0===l&&(l=!0),this.removed||this.styles.definitions().then(function(h){var g,w,T=!0;if(u.styleOptions.style)try{for(var D=Tp(h.configurations),P=D.next();!P.done;P=D.next())if(u.styleOptions.style===P.value.name){T=!1;break}}catch(z){g={error:z}}finally{try{P&&!P.done&&(w=D.return)&&w.call(D)}finally{if(g)throw g.error}}T&&(u.styleOptions.style=h.defaultConfiguration),u.styleOptions=i,u._rebuildStyle(l)})},o.prototype._updateGlobalDefaults=function(i){i&&(i.authOptions&&!jC()&&OC(i.authOptions),i.domain&&!HC()&&NC(i.domain),i.styleDefinitionsPath&&!Ib()&&LC(i.styleDefinitionsPath),i.workerCount&&!$C()&&Tb(i.workerCount),i.maxParallelImageRequests&&!ym()&&Wa(i.maxParallelImageRequests),!i.subscriptionKey&&!i["subscription-key"]||jC()||BC(i.subscriptionKey||i["subscription-key"]),!i.sessionId&&!i["session-id"]||Ab()||VC(i.sessionId||i["session-id"]),i.language&&!WP()&&FC(i.language),!i.userRegion&&!i.view||Db()||Cb(i.userRegion||i.view))},o.prototype._generateSafeBounds=function(i){if(i){var l=gi.getSouth(i),u=gi.getWest(i),h=gi.getNorth(i),g=gi.getEast(i);if(!(isFinite(l)&&isFinite(u)&&isFinite(h)&&isFinite(g)))throw new Error("The bounds specified are invalid: [".concat(i,"]"));for(;g<u;)g+=360;return new gi([u,l,g,h])}return i},o.prototype._detectHighContrast=function(){var i,l;switch(vQ.getHighContrastMode()){case"invert":case"light":i=o.Css.hcLight,l="high_contrast_light";break;case"dark":i=o.Css.hcDark,l="high_contrast_dark"}i&&this.map.getContainer().classList.add(i),l&&"road"===this.styleOptions.style&&(this.styleOptions.style=l)},o.Css={canvasContainer:"atlas-map-canvas-container",canvas:"atlas-map-canvas",container:"atlas-map",hcDark:"high-contrast-dark",hcLight:"high-contrast-light"},o}(Pa),Ste=window&&window.__read||function(a,o){var i="function"==typeof Symbol&&a[Symbol.iterator];if(!i)return a;var l,u,h=i.call(a),g=[];try{for(;(void 0===o||0<o--)&&!(l=h.next()).done;)g.push(l.value)}catch(w){u={error:w}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(u)throw u.error}}return g},Ate=window&&window.__spreadArray||function(a,o,i){if(i||2===arguments.length)for(var l,u=0,h=o.length;u<h;u++)!l&&u in o||((l=l||Array.prototype.slice.call(o,0,u))[u]=o[u]);return a.concat(l||Array.prototype.slice.call(o))},q7=function(){function a(){this.detectHyperlinks=!0,this.parsePropertyPaths=!0}return a.applyTemplate=function(o,i){var l,u,h,g=this,w=document.createElement("div");return w.classList.add(a.Css.template),o&&("boolean"!=typeof(i=i||{}).singleDescription&&(i.singleDescription=!0),i.sandboxContent="boolean"!=typeof i.sandboxContent||i.sandboxContent,i.title&&"string"==typeof i.content&&(i.content.includes("{title}")||i.content.includes("{name}"))||(o.title?i.title="{title}":o.name&&(i.title="{name}")),"boolean"!=typeof i.detectHyperlinks&&(i.detectHyperlinks=!0),"boolean"!=typeof i.parsePropertyPaths&&(i.parsePropertyPaths=!0),i.textColor&&(w.style.color=i.textColor),i.fillColor&&(w.style.backgroundColor=i.fillColor),i.title&&((h=this._applyStringTemplate(o,i.title,i)).innerText=h.textContent||h.innerText||"",this._appendChild(w,h,a.Css.title)),(l=document.createElement("div")).classList.add(a.Css.content),Array.isArray(i.content)?0<i.content.length&&i.content[0].propertyPath?this._appendChild(l,this._generateContent(o,i.content,i),a.Css.item):i.content.forEach(function(T){g._appendChild(l,g._generateContent(o,T,i),a.Css.item)}):(u=0,h=void(o.description&&Object.keys(o).forEach(function(T){g._ignoreProperty(T,o[T])||u++})),1===u||i.singleDescription&&o.description||2===u&&o.Snippet?(h=document.createElement("div")).innerHTML=o.description:h=this._generateContent(o,i.content,i),this._appendChild(l,h,a.Css.item)),""!==l.innerHTML)&&w.appendChild(i.sandboxContent?a._createSandboxedIframe(l,i):l),w},a._createSandboxedIframe=function(u,i){var l=document.createElement("iframe"),h=(l.sandbox.add("allow-popups"),u=u.innerHTML,!1),N=100,g=550,w=10,P=(document.body.scrollWidth<=340&&(g=300,N=50),u.split(/<(tr|div|br|li|h[0-9]|p>)/)),D=Math.max.apply(Math,Ate([],Ste(P.map(function(z){return z.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length})),!1))-1,T=Math.ceil(3.5*D);return T<g&&(g=T,N=D),u.includes("<img")||u.includes("<video")?(h=!0,l.width="550px"):(T=-1<u.indexOf(a.Css.table)?25:20,w+=Math.max(.5*P.length*T,Math.ceil(u.replace(/<[a-zA-Z0-9\s=\/]+>/g,"").length/N)*T)),l.width=g+"px",l.height=h||280<w?"280px":w+"px",D=i.textColor?"color:".concat(i.textColor,";"):"",P=i.fillColor?"background-color:".concat(i.fillColor,";"):"",N='<html><head><title></title><meta charset="utf-8" /><meta http-equiv="x-ua-compatible" content="IE=Edge" />'+'<link rel="stylesheet" href="'.concat(a._cssUrl,'" type="text/css"/>')+"<style>html, body{margin:0;padding:0;".concat(D).concat(P,"}</style></head>")+'<body><div class="'.concat(a.Css.template,'" style="padding:0;width:').concat(g-20,'px">').concat(u,"</div></body></html>"),void 0===l.srcdoc?l.src="data:text/html;charset=utf-8,"+encodeURI(N):l.srcdoc=N,l},a._appendChild=function(o,i,l){i&&(l&&(i.className=(i.className?i.className+" ":"")+l),o.appendChild(i))},a._generateContent=function(o,i,l){return i?Array.isArray(i)?this._generatePropertyInfoTable(o,i,l):this._applyStringTemplate(o,i,l):(i=this._generateDynamicTableHtml(o,null,l))?((o=document.createElement("div")).innerHTML=i,o):null},a._applyStringTemplate=function(o,i,l){if(i){for(var u,h,g=i,w=this._placeholderRx.exec(i);w;)2<=w.length&&(u=this._getPropertyValue(o,w[1],l),g=g.replace(w[0],u)),w=this._placeholderRx.exec(i);if(g)return(g=g.trim()).includes("<")&&(g=g.replace(/[\r\n]+/g,"<br/>")),(h=document.createElement("div")).innerHTML=g,h}return null},a._getPropertyValue=function(o,i,l,u){var h=l.parsePropertyPaths?i.split("/"):[i],g=h.length;if(0<g&&o){var w=h[0],T=o[w];if(l.detectHyperlinks&&"link"===i&&(!u||u.hyperlinkFormat)){var D,P,N,z=[];if(Array.isArray(T)?T.forEach(function(Re){Re.href?z.push(Re):"string"==typeof Re&&z.push({href:Re})}):T.href&&z.push(T),0<z.length)return u&&u.hyperlinkFormat?D=u.hyperlinkFormat:l&&l.hyperlinkFormat&&(D=l.hyperlinkFormat),P=D&&D.target?D.target:"_blank",N=[],z.forEach(function(Re){Re.title||D&&D.label||!Re.rel||N.push(Re.rel," - "),N.push('<a href="',Re.href,'" target="',P,'">'),N.push(Re.title?Re.title:D&&D.label?D.label:Re.href),N.push("</a>","<br/>")}),N.pop(),N.join("")}if(null!=T){var W=void 0;for(W=1;W<g&&(w=h[W],null!=(T=T[h[W]]));W++);if(W===g&&null!=T){if(o=void 0,(o=void 0!==T.value?T.value:T)instanceof Date)return u&&u.dateFormat?o.toLocaleString(void 0,u.dateFormat):l.dateFormat?o.toLocaleString(void 0,l.dateFormat):o.toISOString();if("object"==typeof o)return(ue=this._generateDynamicTableHtml(o,h.slice(1),l))||"";if("number"==typeof o){if(u){if(u.dateFormat)return new Date(o).toLocaleString(void 0,u.dateFormat);if(u.numberFormat)return o.toLocaleString(void 0,u.numberFormat)}else if(/(timestamp|date)/gi.test(w))return new Date(o).toISOString();return o.toLocaleString(void 0,l.numberFormat)}if("string"==typeof o&&""!==o&&!/[\n\r<>\s]/g.test(o)&&(l.detectHyperlinks||u&&u.hyperlinkFormat)){o=o.trim(),i=this._isUrlRx.test(o)||u&&u.hyperlinkFormat;var ue,ge=this._isImageUrlRx.test(o)&&(i||o.startsWith("data:image")),we=this._emailRx.test(o);if(i||ge||we)return i=void 0,ue=void(u&&u.hyperlinkFormat?i=u.hyperlinkFormat:l&&l.hyperlinkFormat&&(i=l.hyperlinkFormat)),ue=i&&i.target?' target="'.concat(i.target,'"'):' target="_blank"',u="".concat(i&&i.label?i.label:o),i&&i.scheme?o=i.scheme+o:we&&(o="mailto:"+o),l=i&&i.label?' alt="'.concat(i.label,'"'):"",(i&&i.isImage||ge)&&(u='<img src="'.concat(o,'" style="max-width:100%"').concat(l,'"/>')),'<a href="'.concat(o,'"').concat(ue,">").concat(u,"</a>")}return o.toString()}}}return""},a._generatePropertyInfoTable=function(o,i,l){var u,h;return o&&i&&0<i.length?((u=[]).push('<table class="'.concat((h=this).Css.table,'">')),i.forEach(function(g){var w=h._getPropertyValue(o,g.propertyPath,l,g);g.hideLabel?u.push('<tr><td colspan="2">',w,"</td></tr>"):(g=g.label||g.propertyPath.split("/")[0],u.push("<tr><th>",g,"</th><td>",w,"</td></tr>"))}),u.push("</table>"),(i=document.createElement("div")).innerHTML=u.join(""),i):null},a._generateDynamicTableHtml=function(o,i,l){var u,h,g,w,T=this;return o&&((u=[]).push('<table class="'.concat((h=this).Css.table,'">')),g=i&&0<i.length?i.join("/")+"/":"",w=0,Object.keys(o).forEach(function(D){T._ignoreProperty(D,o[D])||(u.push("<tr><th>",D,"</th><td>",h._getPropertyValue(o,g+D,l),"</td></tr>"),w++)}),0!==w)?(u.push("</table>"),u.join("")):null},a._ignoreProperty=function(o,i){switch(o){case"title":case"name":case"base":case"popupTemplate":case"anchor":case"icon":case"image":case"imageUrl":case"rotation":case"color":case"size":case"offset":case"strokeColor":case"strokeWidth":case"strokeOpacity":case"subType":case"fillColor":case"fillOpacity":case"visibility":case"visible":return!0;default:if(0===o.indexOf("_")||null==i||""===i)return!0}return!1},a._placeholderRx=/\{([a-zA-Z0-9_\/\s]+)\}/gi,a._isUrlRx=/^(http|https|ftp|tel|mailto):\/\//i,a._isImageUrlRx=/(^data:image|.png$|.jpg$|.jpeg$|.gif$|.bmp$|.svg|.tif|.tiff$)/i,a._emailRx=/^[^\.\s@:](?:[^\s@:]*[^\s@:\.])?@[^\.\s@]+(?:\.[^\.\s@]+)*$/,a._cssUrl=new vu({domain:mc.staticAssetsDomain,path:"sdk/javascript/mapcontrol/".concat(fv.getEndpointVersion(),"/atlas.min.css")}).toString(),a.Css={template:"azure-maps-control-popup-template",title:"azure-maps-control-popup-template-title",content:"azure-maps-control-popup-template-content",item:"azure-maps-control-popup-template-content-item",table:"azure-maps-control-popup-template-table"},a}(),Dte=(ZP(),Object.freeze({__proto__:null,get AuthenticationType(){return so},get ControlPosition(){return Ll},get ControlStyle(){return ya},HtmlMarker:f2,Map:Cg,Pixel:_l,Popup:Q1,PopupTemplate:q7,Shape:ws,_enableRTLTextPlugin:ZP,_getAssetDomain:YP,_getDomain:Jp,_hasMaxParallelImageRequests:ym,_hasSetAuthenticationOptions:jC,_hasSetDomain:HC,_hasSetLanguage:WP,_hasSetSessionId:Ab,_hasSetStyleDefinitionsPath:Ib,_hasSetStyleDefinitionsVersion:Sb,_hasSetView:Db,_hasWorkerCount:$C,addImageTemplate:GP,addProtocol:gm,clearPrewarmedResources:la,control:KZ,data:O$,getAllImageTemplateNames:$h,getAuthenticationOptions:IC,getDomain:Yg,getImageTemplate:zC,getLanguage:RC,getMaxParallelImageRequests:PC,getSessionId:MC,getStaticAssetsDomain:SC,getStyleAPIVersion:DC,getStyleDefinitionsPath:AC,getStyleDefinitionsVersion:Zg,getSubscriptionKey:qP,getUserRegion:wb,getVersion:kC,getView:bb,getWorkerCount:mm,internal:JP,isSupported:Eb,layer:a8,math:N$,prewarm:KP,removeProtocol:sh,setAuthenticationOptions:OC,setDomain:NC,setLanguage:FC,setMaxParallelImageRequests:Wa,setSessionId:VC,setStyleAPIVersion:xb,setStyleDefinitionsPath:LC,setStyleDefinitionsVersion:gv,setSubscriptionKey:BC,setUserRegion:Cb,setView:UC,setWorkerCount:Tb,source:X$}))},597:(CF,ub,hb)=>{var Nl=hb(155),pn=function bC(j){var G=Object.create(null);return j&&Object.keys(j).forEach(function(Z){var te;"default"!==Z&&(te=Object.getOwnPropertyDescriptor(j,Z),Object.defineProperty(G,Z,te.get?te:{enumerable:!0,get:function(){return j[Z]}}))}),G.default=j,Object.freeze(G)}(Nl),aa=function(){return(aa=Object.assign||function(j){for(var G,Z=1,te=arguments.length;Z<te;Z++)for(var xe in G=arguments[Z])Object.prototype.hasOwnProperty.call(G,xe)&&(j[xe]=G[xe]);return j}).apply(this,arguments)},Ka=function(){function j(){}return j.merge=function(G,Z){for(var te=window||global,xe=0,Te=G.split(".");xe<Te.length;xe++){var nt=Te[xe];if(!te[nt])return Z;te=te[nt]}return aa(aa({},te),Z)},j}(),dv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function so(j){return j&&j.__esModule&&Object.prototype.hasOwnProperty.call(j,"default")?j.default:j}var Kg=function kP(j,G){return j===G||j!=j&&G!=G},IF=Kg,mc=function dm(j,G){for(var Z=j.length;Z--;)if(IF(j[Z][0],G))return Z;return-1},Pr=mc,To=Array.prototype.splice,AF=mc,wu=mc,xC=mc;function Qp(j){var G=-1,Z=null==j?0:j.length;for(this.clear();++G<Z;){var te=j[G];this.set(te[0],te[1])}}Qp.prototype.clear=function Wp(){this.__data__=[],this.size=0},Qp.prototype.delete=function SF(Z){var G=this.__data__;return!((Z=Pr(G,Z))<0||(Z==G.length-1?G.pop():To.call(G,Z,1),--this.size,0))},Qp.prototype.get=function vu(Z){var G=this.__data__;return(Z=AF(G,Z))<0?void 0:G[Z][1]},Qp.prototype.has=function pv(j){return-1<wu(this.__data__,j)},Qp.prototype.set=function Yp(j,G){var Z=this.__data__,te=xC(Z,j);return te<0?(++this.size,Z.push([j,G])):Z[te][1]=G,this};var j,fb=Qp,RF=fb,Wg="object"==typeof dv&&dv&&dv.Object===Object&&dv,kF="object"==typeof self&&self&&self.Object===Object&&self,Nd=Wg||kF||Function("return this")(),fm=Nd.Symbol,yb=Object.prototype,BP=yb.hasOwnProperty,_b=yb.toString,Hh=fm?fm.toStringTag:void 0,zP=Object.prototype.toString,$P=function mv(j){var G=BP.call(j,Hh),Z=j[Hh];try{var te=!(j[Hh]=void 0)}catch{}var xe=_b.call(j);return te&&(G?j[Hh]=Z:delete j[Hh]),xe},vb=function jP(j){return zP.call(j)},Yg=fm?fm.toStringTag:void 0,Zg=function AC(j){return null==j?void 0===j?"[object Undefined]":"[object Null]":(Yg&&Yg in Object(j)?$P:vb)(j)},mm=function DC(j){var G=typeof j;return null!=j&&("object"==G||"function"==G)},PC=Zg,RC=mm,Eb=function kC(j){return!!RC(j)&&("[object Function]"==(j=PC(j))||"[object GeneratorFunction]"==j||"[object AsyncFunction]"==j||"[object Proxy]"==j)},NC=Nd["__core-js_shared__"],xb=(j=/[^.]+$/.exec(NC&&NC.keys&&NC.keys.IE_PROTO||""))?"Symbol(src)_1."+j:"",VC=Function.prototype.toString,Cb=function BC(j){if(null!=j){try{return VC.call(j)}catch{}try{return j+""}catch{}}return""},UC=Eb,GP=function Tb(j){return!!xb&&xb in j},zC=mm,$h=Cb,la=/^\[object .+?Constructor\]$/,Ib=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Jp=function YP(j,G){return G=function ym(j,G){return j?.[G]}(j,G),function Sb(j){return!(!zC(j)||GP(j))&&(UC(j)?Ib:la).test($h(j))}(G)?G:void 0},_m=Jp(Nd,"Map"),ki=Jp(Object,"create"),pl=ki,JP=ki,Pb=Object.prototype.hasOwnProperty,eR=ki,Vr=Object.prototype.hasOwnProperty,Tj=ki,$i=function Fl(j){return j=this.has(j)&&delete this.__data__[j],this.size-=j?1:0,j},FF=function _a(j){var G=this.__data__;if(JP){var Z=G[j];return"__lodash_hash_undefined__"===Z?void 0:Z}return Pb.call(G,j)?G[j]:void 0};function ef(j){var G=-1,Z=null==j?0:j.length;for(this.clear();++G<Z;){var te=j[G];this.set(te[0],te[1])}}ef.prototype.clear=function Sr(){this.__data__=pl?pl(null):{},this.size=0},ef.prototype.delete=$i,ef.prototype.get=FF,ef.prototype.has=function GC(j){var G=this.__data__;return eR?void 0!==G[j]:Vr.call(G,j)},ef.prototype.set=function Gt(j,G){var Z=this.__data__;return this.size+=this.has(j)?0:1,Z[j]=Tj&&void 0===G?"__lodash_hash_undefined__":G,this};var VF=ef,BF=fb,SY=_m;function WC(j,G){return j=j.__data__,function DY(j){var G=typeof j;return"string"==G||"number"==G||"symbol"==G||"boolean"==G?"__proto__"!==j:null===j}(G)?j["string"==typeof G?"string":"hash"]:j.map}var UF=WC,Nr=WC,Aj=WC,cs=WC;function wm(j){var G=-1,Z=null==j?0:j.length;for(this.clear();++G<Z;){var te=j[G];this.set(te[0],te[1])}}wm.prototype.clear=function vm(){this.size=0,this.__data__={hash:new VF,map:new(SY||BF),string:new VF}},wm.prototype.delete=function MY(j){return j=UF(this,j).delete(j),this.size-=j?1:0,j},wm.prototype.get=function Sj(j){return Nr(this,j).get(j)},wm.prototype.has=function jn(j){return Aj(this,j).has(j)},wm.prototype.set=function Mb(j,G){var Z=cs(this,j),te=Z.size;return Z.set(j,G),this.size+=Z.size==te?0:1,this};var oR=wm,mi=fb,ZC=_m,sR=oR,Zo=fb,jF=function FP(Z){var G=this.__data__;return Z=G.delete(Z),this.size=G.size,Z},Xn=function Bs(j){return this.__data__.get(j)},QC=function go(j){return this.__data__.has(j)};function ch(j){j=this.__data__=new Zo(j),this.size=j.size}ch.prototype.clear=function bu(){this.__data__=new RF,this.size=0},ch.prototype.delete=jF,ch.prototype.get=Xn,ch.prototype.has=QC,ch.prototype.set=function lh(j,G){var Z=this.__data__;if(Z instanceof mi){var te=Z.__data__;if(!ZC||te.length<199)return te.push([j,G]),this.size=++Z.size,this;Z=this.__data__=new sR(te)}return Z.set(j,G),this.size=Z.size,this};var Nb=ch,Pj=Jp,Rj=function(){try{var j=Pj(Object,"defineProperty");return j({},"",{}),j}catch{}}(),Mj=Rj,Xg=function kj(j,G,Z){"__proto__"==G&&Mj?Mj(j,G,{configurable:!0,enumerable:!0,value:Z,writable:!0}):j[G]=Z},eI=Xg,Lb=Kg,$F=Object.prototype.hasOwnProperty,tI=function yv(j,G,Z){var te=j[G];$F.call(j,G)&&Lb(te,Z)&&(void 0!==Z||G in j)||eI(j,G,Z)},$c=tI,qF=Xg,Fb=function tf(j,G,Z,te){var xe=!Z;Z=Z||{};for(var Te=-1,nt=G.length;++Te<nt;){var it=G[Te],at=te?te(Z[it],j[it],it,Z,j):void 0;void 0===at&&(at=j[it]),(xe?qF:$c)(Z,it,at)}return Z},Ld=function Kn(j){return null!=j&&"object"==typeof j},_v=Zg,Vb=Ld,uh=function Oj(j){return Vb(j)&&"[object Arguments]"==_v(j)},Bb=Ld,xu=Object.prototype,qh=xu.hasOwnProperty,Xi=xu.propertyIsEnumerable,Ub=uh(function(){return arguments}())?uh:function(j){return Bb(j)&&qh.call(j,"callee")&&!Xi.call(j,"callee")},zb=Ub,vv=Array.isArray,Tu={exports:{}},uR=function wv(){return!1};!function(j,Z){var te;j.exports=(te=(te=(Z=(te=Z&&!Z.nodeType&&Z)&&j&&!j.nodeType&&j)&&Z.exports===te?Nd.Buffer:void 0)?te.isBuffer:void 0)||uR}(Tu,Tu.exports);var jb=Tu.exports,hR=/^(?:0|[1-9]\d*)$/,KF=function fR(j){return"number"==typeof j&&-1<j&&j%1==0&&j<=9007199254740991},mR=Zg,Nj=KF,WF=Ld,Ai={};Ai["[object Float32Array]"]=Ai["[object Float64Array]"]=Ai["[object Int8Array]"]=Ai["[object Int16Array]"]=Ai["[object Int32Array]"]=Ai["[object Uint8Array]"]=Ai["[object Uint8ClampedArray]"]=Ai["[object Uint16Array]"]=Ai["[object Uint32Array]"]=!0,Ai["[object Arguments]"]=Ai["[object Array]"]=Ai["[object ArrayBuffer]"]=Ai["[object Boolean]"]=Ai["[object DataView]"]=Ai["[object Date]"]=Ai["[object Error]"]=Ai["[object Function]"]=Ai["[object Map]"]=Ai["[object Number]"]=Ai["[object Object]"]=Ai["[object RegExp]"]=Ai["[object Set]"]=Ai["[object String]"]=Ai["[object WeakMap]"]=!1;var oI=function $b(j){return function(G){return j(G)}},sI={exports:{}};!function(j,xe){var Z=(xe=xe&&!xe.nodeType&&xe)&&j&&!j.nodeType&&j,te=Z&&Z.exports===xe&&Wg.process;xe=function(){try{return Z&&Z.require&&Z.require("util").types||te&&te.binding&&te.binding("util")}catch{}}(),j.exports=xe}(sI,sI.exports);var Bo=sI.exports,On=function rV(j){return WF(j)&&Nj(j.length)&&!!Ai[mR(j)]},Cu=Bo&&Bo.isTypedArray,fl=Cu?oI(Cu):On,bm=function hr(j,G){for(var Z=-1,te=Array(j);++Z<j;)te[Z]=G(Z);return te},Ys=zb,rf=vv,ey=jb,Hr=function dR(j,G){var Z=typeof j;return!!(G=G??9007199254740991)&&("number"==Z||"symbol"!=Z&&hR.test(j))&&-1<j&&j%1==0&&j<G},Ev=fl,ty=Object.prototype.hasOwnProperty,xv=function vs(j,G){var Z,te=rf(j),xe=!te&&Ys(j),Te=!te&&!xe&&ey(j),nt=!te&&!xe&&!Te&&Ev(j),it=te||xe||Te||nt,at=it?bm(j.length,String):[],fr=at.length;for(Z in j)!G&&!ty.call(j,Z)||it&&("length"==Z||Te&&("offset"==Z||"parent"==Z)||nt&&("buffer"==Z||"byteLength"==Z||"byteOffset"==Z)||Hr(Z,fr))||at.push(Z);return at},ny=Object.prototype,ry=function Kh(j){var G=j&&j.constructor;return j===("function"==typeof G&&G.prototype||ny)},Fd=function vR(j,G){return function(Z){return j(G(Z))}},Tv=Fd(Object.keys,Object),Oi=ry,Vj=Tv,oV=Object.prototype.hasOwnProperty,iy=Eb,Cv=KF,oy=function Za(j){return null!=j&&Cv(j.length)&&!iy(j)},Bl=xv,Ul=function Wh(j){if(!Oi(j))return Vj(j);var G,Z=[];for(G in Object(j))oV.call(j,G)&&"constructor"!=G&&Z.push(G);return Z},cI=oy,sy=function xm(j){return(cI(j)?Bl:Ul)(j)},dh=Fb,wR=sy,lV=mm,zj=ry,jj=Object.prototype.hasOwnProperty,$j=xv,cV=function Hj(j){if(!lV(j))return function Bj(j){var G=[];if(null!=j)for(var Z in Object(j))G.push(Z);return G}(j);var G,Z=zj(j),te=[];for(G in j)("constructor"!=G||!Z&&jj.call(j,G))&&te.push(G);return te},uV=oy,Gb=function qj(j){return uV(j)?$j(j,!0):cV(j)},Gj=Fb,ER=Gb,uI={exports:{}};!function(j,Z){var te,xe=(te=(Z=(te=Z&&!Z.nodeType&&Z)&&j&&!j.nodeType&&j)&&Z.exports===te?Nd.Buffer:void 0)?te.allocUnsafe:void 0;j.exports=function(Te,nt){return nt?Te.slice():(nt=Te.length,nt=xe?xe(nt):new Te.constructor(nt),Te.copy(nt),nt)}}(uI,uI.exports);var hV=uI.exports,Sv=function Qa(){return[]},CR=Object.prototype.propertyIsEnumerable,dI=Object.getOwnPropertySymbols,pI=dI?function(j){return null==j?[]:(j=Object(j),function Wj(j,G){for(var Z=-1,te=null==j?0:j.length,xe=0,Te=[];++Z<te;){var nt=j[Z];G(nt,Z,j)&&(Te[xe++]=nt)}return Te}(dI(j),function(G){return CR.call(j,G)}))}:Sv,fI=pI,Kb=Fb,mI=fI,Av=function SR(j,G){for(var Z=-1,te=G.length,xe=j.length;++Z<te;)j[xe+Z]=G[Z];return j},Cm=Fd(Object.getPrototypeOf,Object),yI=Av,Yj=Cm,Zj=fI,pV=Object.getOwnPropertySymbols?function(j){for(var G=[];j;)yI(G,Zj(j)),j=Yj(j);return G}:Sv,Yb=Fb,mV=pV,Qj=Av,yV=vv;function vI(j,G,Z){return G=G(j),yV(j)?G:Qj(G,Z(j))}var vV=vI,wV=fI,bV=sy,DR=function AR(j){return vV(j,bV,wV)},PR=vI,EV=pV,Xj=Gb,Zb=Jp(Nd,"DataView"),Zh=_m,Ma=Jp(Nd,"Promise"),af=Jp(Nd,"Set"),bI=Jp(Nd,"WeakMap"),OR=Zg,Su=Cb,Qb="[object Map]",Pv="[object Promise]",EI="[object Set]",xI="[object WeakMap]",NR="[object DataView]",Lr=Su(Zb),LR=Su(Zh),nH=Su(Ma),PV=Su(af),RV=Su(bI),Im=OR,ly=Im=Zb&&Im(new Zb(new ArrayBuffer(1)))!=NR||Zh&&Im(new Zh)!=Qb||Ma&&Im(Ma.resolve())!=Pv||af&&Im(new af)!=EI||bI&&Im(new bI)!=xI?function(Z){var G=OR(Z);if(Z=(Z="[object Object]"==G?Z.constructor:void 0)?Su(Z):"")switch(Z){case Lr:return NR;case LR:return Qb;case nH:return Pv;case PV:return EI;case RV:return xI}return G}:Im,MV=Object.prototype.hasOwnProperty,Bt=Nd.Uint8Array,Gi=Bt,Zs=function va(j){var G=new j.constructor(j.byteLength);return new Gi(G).set(new Gi(j)),G},Xa=Zs,Bd=/\w*$/,Xb=fm?fm.prototype:void 0,SI=Xb?Xb.valueOf:void 0,VR=Zs,NV=Zs,BR=function FR(j,G){return G=G?Xa(j.buffer):j.buffer,new j.constructor(G,j.byteOffset,j.byteLength)},LV=function CI(j){var G=new j.constructor(j.source,Bd.exec(j));return G.lastIndex=j.lastIndex,G},jV=mm,kv=Object.create,Ud=function(){function j(){}return function(G){return jV(G)?kv?kv(G):(j.prototype=G,G=new j,j.prototype=void 0,G):{}}}(),Jb=Ud,e1=Cm,t1=ry,r1=ly,HV=Ld,ZR=Bo&&Bo.isMap,lH=ZR?oI(ZR):function Ov(j){return HV(j)&&"[object Map]"==r1(j)},cH=ly,kI=Ld,OI=Bo&&Bo.isSet,XR=OI?oI(OI):function $V(j){return kI(j)&&"[object Set]"==cH(j)},Qh=Nb,JR=function HF(j,G){for(var Z=-1,te=null==j?0:j.length;++Z<te&&!1!==G(j[Z],Z,j););return j},NI=tI,LI=function sV(j,G){return j&&dh(G,wR(G),j)},eM=function xR(j,G){return j&&Gj(G,ER(G),j)},a1=hV,FI=function Tm(j,G){var Z=-1,te=j.length;for(G=G||Array(te);++Z<te;)G[Z]=j[Z];return G},tM=function gI(j,G){return Kb(j,mI(j),G)},nM=function _I(j,G){return Yb(j,mV(j),G)},rM=DR,iM=function xV(j){return PR(j,Xj,EV)},oM=ly,qV=function TI(j){var G=j.length,Z=new j.constructor(G);return G&&"string"==typeof j[0]&&MV.call(j,"index")&&(Z.index=j.index,Z.input=j.input),Z},VI=function KR(j,G,Z){var te=j.constructor;switch(G){case"[object ArrayBuffer]":return NV(j);case"[object Boolean]":case"[object Date]":return new te(+j);case"[object DataView]":return BR(j,Z);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function cf(j,G){return G=G?VR(j.buffer):j.buffer,new j.constructor(G,j.byteOffset,j.length)}(j,Z);case"[object Map]":case"[object Set]":return new te;case"[object Number]":case"[object String]":return new te(j);case"[object RegExp]":return LV(j);case"[object Symbol]":return function zl(j){return SI?Object(SI.call(j)):{}}(j)}},hy=function n1(j){return"function"!=typeof j.constructor||t1(j)?{}:Jb(e1(j))},GV=vv,sM=jb,KV=lH,l1=mm,WV=XR,Hl=sy,hH=Gb,aM="[object Arguments]",Vv="[object Function]",zI="[object Object]",Co={};Co[aM]=Co["[object Array]"]=Co["[object ArrayBuffer]"]=Co["[object DataView]"]=Co["[object Boolean]"]=Co["[object Date]"]=Co["[object Float32Array]"]=Co["[object Float64Array]"]=Co["[object Int8Array]"]=Co["[object Int16Array]"]=Co["[object Int32Array]"]=Co["[object Map]"]=Co["[object Number]"]=Co[zI]=Co["[object RegExp]"]=Co["[object Set]"]=Co["[object String]"]=Co["[object Symbol]"]=Co["[object Uint8Array]"]=Co["[object Uint8ClampedArray]"]=Co["[object Uint16Array]"]=Co["[object Uint32Array]"]=!0,Co["[object Error]"]=Co[Vv]=Co["[object WeakMap]"]=!1;var r3=function pf(j,G,Z,te,xe,Te){var nt,it=1&G,at=2&G,fr=4&G;if(void 0!==(nt=Z?xe?Z(j,te,xe,Te):Z(j):nt))return nt;if(!l1(j))return j;var Er=GV(j);if(Er){if(nt=qV(j),!it)return FI(j,nt)}else{var Qr=oM(j);if(te=Qr==Vv||"[object GeneratorFunction]"==Qr,sM(j))return a1(j,it);if(Qr==zI||Qr==aM||te&&!xe){if(nt=at||te?{}:hy(j),!it)return at?nM(j,eM(nt,j)):tM(j,LI(nt,j))}else{if(!Co[Qr])return xe?j:{};nt=VI(j,Qr,it)}}if(it=(Te=Te||new Qh).get(j))return it;Te.set(j,nt),WV(j)?j.forEach(function(zo){nt.add(pf(zo,G,Z,zo,j,Te))}):KV(j)&&j.forEach(function(zo,Xo){nt.set(Xo,pf(zo,G,Z,Xo,j,Te))});var yo=Er?void 0:(fr?at?iM:rM:at?hH:Hl)(j);return JR(yo||j,function(zo,Xo){yo&&(zo=j[Xo=zo]),NI(nt,Xo,pf(zo,G,Z,Xo,j,Te))}),nt},pH=r3,ff=so(function qc(j){return pH(j,5)}),yH=oR;function fy(j){var G=-1,Z=null==j?0:j.length;for(this.__data__=new yH;++G<Z;)this.add(j[G])}fy.prototype.add=fy.prototype.push=function hM(j){return this.__data__.set(j,"__lodash_hash_undefined__"),this},fy.prototype.has=function s3(j){return this.__data__.has(j)};var ir,l3=fy,gM=function a3(j,G){for(var Z=-1,te=null==j?0:j.length;++Z<te;)if(G(j[Z],Z,j))return!0;return!1},jI=function mM(j,G){return j.has(G)},_M=function c3(j,G,Z,te,xe,Te){var nt=1&Z,it=j.length;if(it!=(fr=G.length)&&!(nt&&it<fr))return!1;var at=Te.get(j),fr=Te.get(G);if(at&&fr)return at==G&&fr==j;var Er=-1,Qr=!0,yo=2&Z?new l3:void 0;for(Te.set(j,G),Te.set(G,j);++Er<it;){var zo,Xo=j[Er],Gc=G[Er];if(void 0!==(zo=te?nt?te(Gc,Xo,Er,G,j,Te):te(Xo,Gc,Er,j,G,Te):zo)){if(zo)continue;Qr=!1;break}if(yo){if(!gM(G,function(Ki,ph){if(!jI(yo,ph)&&(Xo===Ki||xe(Xo,Ki,Z,te,Te)))return yo.push(ph)})){Qr=!1;break}}else if(Xo!==Gc&&!xe(Xo,Gc,Z,te,Te)){Qr=!1;break}}return Te.delete(j),Te.delete(G),Qr},vM=Bt,_H=Kg,d3=_M,p3=function my(j){var G=-1,Z=Array(j.size);return j.forEach(function(te,xe){Z[++G]=[xe,te]}),Z},f3=function u3(j){var G=-1,Z=Array(j.size);return j.forEach(function(te){Z[++G]=te}),Z},_3=fm?fm.prototype:void 0,xM=_3?_3.valueOf:void 0,w3=DR,m1=Object.prototype.hasOwnProperty,g1=Nb,jv=_M,$I=function EH(j,G,Z,te,xe,Te,nt){switch(Z){case"[object DataView]":if(j.byteLength!=G.byteLength||j.byteOffset!=G.byteOffset)return!1;j=j.buffer,G=G.buffer;case"[object ArrayBuffer]":return!(j.byteLength!=G.byteLength||!Te(new vM(j),new vM(G)));case"[object Boolean]":case"[object Date]":case"[object Number]":return _H(+j,+G);case"[object Error]":return j.name==G.name&&j.message==G.message;case"[object RegExp]":case"[object String]":return j==G+"";case"[object Map]":var it=p3;case"[object Set]":if(it=it||f3,j.size!=G.size&&!(1&te))return!1;var at=nt.get(j);return at?at==G:(te|=2,nt.set(j,G),it=d3(it(j),it(G),te,xe,Te,nt),nt.delete(j),it);case"[object Symbol]":if(xM)return xM.call(j)==xM.call(G)}return!1},Hv=ly,$v=vv,Hd=jb,T3=fl,I3="[object Arguments]",qI="[object Array]",gy="[object Object]",GI=Object.prototype.hasOwnProperty,A3=function S3(j,G,Z,te,xe,Te){var nt=$v(j),fr=$v(G),it=nt?qI:Hv(j),Er=fr?qI:Hv(G),at=(it=it==I3?gy:it)==gy;if(fr=(Er=Er==I3?gy:Er)==gy,(Er=it==Er)&&Hd(j)){if(!Hd(G))return!1;at=!(nt=!0)}return Er&&!at?(Te=Te||new g1,nt||T3(j)?jv(j,G,Z,te,xe,Te):$I(j,G,it,Z,te,xe,Te)):1&Z||(at=at&&GI.call(j,"__wrapped__"),fr=fr&&GI.call(G,"__wrapped__"),!at&&!fr)?!!Er&&function E3(j,G,Z,te,xe,Te){var nt=1&Z,it=w3(j),at=it.length;if(at!=w3(G).length&&!nt)return!1;for(var fr=at;fr--;){var Er=it[fr];if(!(nt?Er in G:m1.call(G,Er)))return!1}var Qr=Te.get(j),yo=Te.get(G);if(Qr&&yo)return Qr==G&&yo==j;var zo=!0;Te.set(j,G),Te.set(G,j);for(var Xo=nt;++fr<at;){var Gc,Ki=j[Er=it[fr]],ph=G[Er];if(!(void 0===(Gc=te?nt?te(ph,Ki,Er,G,j,Te):te(Ki,ph,Er,j,G,Te):Gc)?Ki===ph||xe(Ki,ph,Z,te,Te):Gc)){zo=!1;break}Xo=Xo||"constructor"==Er}return!zo||Xo||(Qr=j.constructor)!=(yo=G.constructor)&&"constructor"in j&&"constructor"in G&&!("function"==typeof Qr&&Qr instanceof Qr&&"function"==typeof yo&&yo instanceof yo)&&(zo=!1),Te.delete(j),Te.delete(G),zo}(j,G,Z,te,xe,Te=Te||new g1):xe(at?j.value():j,fr?G.value():G,Z,te,Te=Te||new g1)},CM=Ld,SM=function ql(j,G,Z,te,xe){return j===G||(null==j||null==G||!CM(j)&&!CM(G)?j!=j&&G!=G:A3(j,G,Z,te,ql,xe))},AM=so(function KI(j,G){return SM(j,G)});!function(j){j.drawPoint="draw-point",j.drawLine="draw-line",j.drawPolygon="draw-polygon",j.drawCircle="draw-circle",j.drawRectangle="draw-rectangle",j.editGeometry="edit-geometry",j.eraseGeometry="erase-geometry",j.idle="idle"}(ir=ir||{});var Ja,_1=function(){return(_1=Object.assign||function(j){for(var G,Z=1,te=arguments.length;Z<te;Z++)for(var xe in G=arguments[Z])Object.prototype.hasOwnProperty.call(G,xe)&&(j[xe]=G[xe]);return j}).apply(this,arguments)},WI=function(){function j(){}return j.prototype.merge=function(){for(var G,Z=[],te=0;te<arguments.length;te++)Z[te]=arguments[te];for(var xe=0,Te=Z;xe<Te.length;xe++){var nt=Te[xe];if(nt)for(var it in nt)nt.hasOwnProperty(it)&&this.hasOwnProperty(it)&&(void 0!==nt[it]&&null!=nt[it]?this[it]instanceof j?this[it].merge(nt[it]):this[it]="dragHandleStyle"===it||"secondaryDragHandleStyle"===it?_1(_1({},this[it]),nt[it]):nt[it]:(G=G||new(Object.getPrototypeOf(this).constructor),this[it]=G[it]))}return this},j}(),DM=function(){var j=function(G,Z){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,xe){te.__proto__=xe}||function(te,xe){for(var Te in xe)Object.prototype.hasOwnProperty.call(xe,Te)&&(te[Te]=xe[Te])})(G,Z)};return function(G,Z){if("function"!=typeof Z&&null!==Z)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");function te(){this.constructor=G}j(G,Z),G.prototype=null===Z?Object.create(Z):(te.prototype=Z.prototype,new te)}}(),PM=function(j){function G(){var Z=null!==j&&j.apply(this,arguments)||this;return Z.containerId=void 0,Z.position=pn.ControlPosition.NonFixed,Z.buttons=[ir.drawPoint,ir.drawLine,ir.drawPolygon,ir.drawCircle,ir.drawRectangle,ir.editGeometry,ir.eraseGeometry],Z.numColumns=1/0,Z.style="light",Z.visible=!0,Z}return DM(G,j),G}(WI),YI=function(){function j(G){var Z=this;this._updateStyle=function(){Z._setStyle(Z.options)},this._updateMode=function(te){for(var xe=0;xe<Z.toolbar.children.length;xe++){var Te=Z.toolbar.children.item(xe);Te.dataset.mode===te?Te.classList.add(j.Css.active):Te.classList.remove(j.Css.active)}},this.options=(new PM).merge(ff(G))}return j.prototype.getOptions=function(){return ff(this.options)},j.prototype.setOptions=function(G){var Z=(new PM).merge(this.options,ff(G));if(this.toolbar){if(Z.visible!==this.options.visible&&(Z.visible?this.toolbar.classList.remove(j.Css.hide):this.toolbar.classList.add(j.Css.hide)),Z.containerId!==this.options.containerId)if(Z.containerId){if(!(G=document.getElementById(Z.containerId)))throw new Error("There is no container with ID '".concat(this.options.containerId," ")+"to add the toolbar to.");this.map.controls.remove(this),G.appendChild(this.toolbar)}else this.toolbar.remove(),Z.position!==pn.ControlPosition.NonFixed&&this._constructControl(),this.map.controls.add(this,{position:Z.position});else Z.containerId||Z.position===this.options.position||(this.map.controls.remove(this),Z.position!==pn.ControlPosition.NonFixed&&this._constructControl(),this.map.controls.add(this,{position:Z.position}));if(Z.style!==this.options.style&&(this._setStyle(Z),"auto"===Z.style?this.map.events.add("styledata",this._updateStyle):this.map.events.remove("styledata",this._updateStyle)),AM(Z.buttons,this.options.buttons)){if(Z.numColumns!==this.options.numColumns)for(var te=this.toolbar.children,xe=0;xe<te.length;xe++){te.item(xe).style.cssFloat=(xe+1)%Z.numColumns!=0?"left":null}}else{for(;this.toolbar.firstChild;)this.toolbar.removeChild(this.toolbar.firstChild);this._addButtons(this.drawMgr,Z)}}this.options=Z},j.prototype.onAdd=function(){if(!this.toolbar)throw new Error("The toolbar cannot be added directly to the map, it must be passed to a DrawingManager");return this.control||this.toolbar},j.prototype.onRemove=function(){(this.control||this.toolbar).remove(),delete this.control},j.prototype._open=function(G,Z){if(this.toolbar)throw new Error("The toolbar is already opened, it cannot be opened again.");if(this.map=Z,this.drawMgr=G,this.options.containerId){var te=document.getElementById(this.options.containerId);if(!te)throw new Error("There is no container with ID '".concat(this.options.containerId," to add the toolbar to."));this._constructToolbar(G,Z),te.appendChild(this.toolbar)}else this._constructToolbar(G,Z),this.options.position!==pn.ControlPosition.NonFixed&&this._constructControl(),Z.controls.add(this,{position:this.options.position})},j.prototype._close=function(){if(!this.toolbar)throw new Error("Cannot close the toolbar, it has not been opened yet.");this.options.containerId?this.toolbar.remove():this.map.controls.remove(this),this.map.events.remove("drawingmodechanged",this.drawMgr,this._updateMode),this.map.events.remove("styledata",this._updateStyle),delete this.toolbar,delete this.drawMgr,delete this.map},j.prototype._isOpen=function(){return!!this.toolbar},j.prototype._dispose=function(){this._close()},j.prototype._constructToolbar=function(G,Z){this.toolbar=document.createElement("div"),this.toolbar.classList.add(j.Css.toolbar),this._setStyle(this.options),"auto"===this.options.style&&Z.events.add("styledata",this._updateStyle),this.options.visible||this.toolbar.classList.add(j.Css.hide),Z.events.add("drawingmodechanged",G,this._updateMode),this._addButtons(G,this.options)},j.prototype._addButtons=function(G,Z){for(var te=G.getOptions().mode,xe=0;xe<Z.buttons.length;xe++){var Te=Z.buttons[xe],nt=document.createElement("button");nt.type="button",nt.dataset.mode=Te,nt.setAttribute("aria-label",Te),nt.setAttribute("title",Te),nt.classList.add(j.Css.button,Te),nt.addEventListener("click",this._getBtnCallback(nt,G)),(xe+1)%Z.numColumns!=0&&(nt.style.cssFloat="left"),te===Te&&nt.classList.add(j.Css.active),this.toolbar.appendChild(nt)}},j.prototype._getBtnCallback=function(G,Z){switch(G.dataset.mode){case ir.drawPoint:case ir.drawLine:case ir.drawPolygon:case ir.drawCircle:case ir.drawRectangle:case ir.editGeometry:case ir.eraseGeometry:return function(){var te=Z.getOptions().mode;Z.setOptions(G.dataset.mode===te?{mode:ir.idle}:{mode:G.dataset.mode})};default:throw new Error("Invalid button type specified '".concat(G.dataset.mode,"'."))}},j.prototype._constructControl=function(){this.control=document.createElement("div"),this.control.classList.add(j.Css.control),this.control.appendChild(this.toolbar)},j.prototype._setStyle=function(G){for(var Z=0,te=Object.keys(j.Css.styles);Z<te.length;Z++)this.toolbar.classList.remove(j.Css.styles[te[Z]]);if("auto"===G.style)this.toolbar.classList.add(j.Css.styles.light);else{if(!j.Css.styles.hasOwnProperty(G.style))throw new Error("An invalid style '".concat(G.style,"' was specified for the toolbar."));this.toolbar.classList.add(j.Css.styles[G.style])}},j.Css={active:"active",button:"azure-maps-drawtoolbar-button",container:"azure-maps-drawtoolbar-container",control:"azure-maps-control-container",hide:"hidden-accessible-element",styles:{dark:"dark",light:"light"},toolbar:"azure-maps-drawtoolbar"},j}(),D3=Object.freeze({__proto__:null,DrawingToolbar:YI}),RM=r3,yy=so(function ZI(j,G){return RM(j,5,G="function"==typeof G?G:void 0)}),MM=function(){},M3=function(){var j=function(G,Z){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,xe){te.__proto__=xe}||function(te,xe){for(var Te in xe)Object.prototype.hasOwnProperty.call(xe,Te)&&(te[Te]=xe[Te])})(G,Z)};return function(G,Z){if("function"!=typeof Z&&null!==Z)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");function te(){this.constructor=G}j(G,Z),G.prototype=null===Z?Object.create(Z):(te.prototype=Z.prototype,new te)}}(),QI=function(j){function G(){var Z=null!==j&&j.apply(this,arguments)||this;return Z.container=void 0,Z.backgroundColor="rgba(0, 0, 0, 0.3)",Z.style="light",Z}return M3(G,j),G}(WI),XI=function(){function j(G){this.options=(new QI).merge(Object.assign({},G)),this._constructDialog(this.options)}return j.prototype.close=function(){},j.prototype.edit=function(G){if(this.shape!==G){this._clearProps(),this.shape=G,this.tempProps=G.getProperties();for(var Z=0,te=Object.keys(this.tempProps);Z<te.length;Z++){var xe=te[Z];xe.startsWith("_azureMaps")||this._addProp(xe,this.tempProps[xe])}}if(!this.container.parentElement&&"string"==typeof this.options.container){if(!(G=document.getElementById(this.options.container)))throw new Error("There is no element with ID '".concat(this.options.container," to add the editor to."));G.appendChild(this.container)}},j.prototype.getOptions=function(){return Object.assign({},this.options)},j.prototype.save=function(){this.close()},j.prototype.setOptions=function(G){G=(new QI).merge(this.options,Object.assign({},G)),this.options=G},j.prototype._constructDialog=function(G){var Z=this;this.container=document.createElement("div"),this.container.classList.add(j.Css.container),this.container.style.backgroundColor=G.backgroundColor,this.dialog=document.createElement("div"),this.dialog.classList.add(j.Css.dialog),this._updateStyle(G),this.container.appendChild(this.dialog);var te=document.createElement("label");te.classList.add(j.Css.labels.base,j.Css.labels.property),te.innerHTML="Property",this.dialog.appendChild(te),(G=document.createElement("label")).classList.add(j.Css.labels.base,j.Css.labels.type),G.innerHTML="Type",this.dialog.appendChild(G),(te=document.createElement("label")).classList.add(j.Css.labels.base,j.Css.labels.value),te.innerHTML="Value",this.dialog.appendChild(te),(G=document.createElement("hr")).classList.add(j.Css.labels.base,j.Css.labels.bar),this.dialog.appendChild(G),this.propsList=document.createElement("ul"),this.propsList.classList.add(j.Css.table.base,j.Css.table.list),this.dialog.appendChild(this.propsList),(te=document.createElement("button")).classList.add(j.Css.buttons.base,j.Css.buttons.add),te.addEventListener("click",function(){return Z._addProp()}),this.dialog.appendChild(te),G=document.createElement("div"),te.appendChild(G),this.addPropLbl=document.createElement("label"),te.appendChild(this.addPropLbl),this.cancelBtn=document.createElement("button"),this.cancelBtn.classList.add(j.Css.buttons.base,j.Css.buttons.cancel),this.cancelBtn.addEventListener("click",function(){return Z.close()}),this.dialog.appendChild(this.cancelBtn),this.saveBtn=document.createElement("button"),this.saveBtn.classList.add(j.Css.buttons.base,j.Css.buttons.save),this.saveBtn.addEventListener("click",function(){return Z.save()}),this.dialog.appendChild(this.saveBtn),this._setLocalizedText()},j.prototype._addProp=function(G,Z){var te=this,xe=document.createElement("div");xe.classList.add(j.Css.table.base,j.Css.table.row),this.propsList.appendChild(xe);var Te=document.createElement("input");Te.classList.add(j.Css.table.base,j.Css.table.name),Te.type="text",Te.value=G||"",xe.appendChild(Te);var nt=document.createElement("select");nt.classList.add(j.Css.table.base,j.Css.table.type),xe.appendChild(nt);for(var it=0,at=j.Types;it<at.length;it++){var fr=at[it],Er=document.createElement("option");Er.value=fr,Er.innerText=fr,nt.add(Er),(Z&&typeof Z===fr||!Z&&"string"===fr)&&(Er.selected=!0)}var Qr=document.createElement("div");Qr.classList.add(j.Css.table.base,j.Css.table.value),Qr.addEventListener("keydown",function(yo){return te._constrainSize(nt,Qr,yo)}),Qr.innerText=Z?JSON.stringify(Z,null,2):"",Qr.contentEditable="true",xe.appendChild(Qr),(Te=document.createElement("button")).classList.add(j.Css.table.base,j.Css.table.delete),Te.addEventListener("click",function(){return te.propsList.removeChild(xe)}),xe.appendChild(Te)},j.prototype._clearProps=function(){for(delete this.tempProps;this.propsList.firstChild;)this.propsList.removeChild(this.propsList.firstChild)},j.prototype._constrainSize=function(G,Z,te){"object"!==G.value&&13===te.keyCode&&te.preventDefault()},j.prototype._updateStyle=function(G){for(var Z=0,te=Object.keys(j.Css.styles);Z<te.length;Z++)this.dialog.classList.remove(j.Css.styles[te[Z]]);if("auto"===G.style)this.dialog.classList.add(j.Css.styles.light);else{if(!j.Css.styles.hasOwnProperty(G.style))throw new Error("An invalid style '".concat(G.style,"' was specified for the editor."));this.dialog.classList.add(j.Css.styles[G.style])}},j.prototype._setLocalizedText=function(){this.saveBtn.innerText="Save",this.cancelBtn.innerText="Cancel",this.addPropLbl.innerText="Add property"},j._countLines=function(G){return(G=G.match(this.LineCountRegEx))?G.length+1:1},j.Css={buttons:{add:"add",base:"azure-maps-propedit-button",cancel:"cancel",save:"save"},container:"azure-maps-propedit-container",dialog:"azure-maps-propedit-dialog",hide:"hidden-accessible-element",labels:{bar:"bar",base:"azure-maps-propedit-label",property:"prop",type:"type",value:"value"},styles:{dark:"dark",light:"light"},table:{base:"azure-maps-propedit-table",delete:"delete",list:"list",name:"name",row:"row",type:"type",value:"value"}},j.Types=["boolean","number","object","string"],j.LineCountRegEx=new RegExp("\r*\n","g"),j.Render=document.createElement("canvas").getContext("2d"),j}();!function(j){j.hybrid="hybrid",j.freehand="freehand",j.click="click"}(Ja=Ja||{});var el,_y=function(){var j=function(G,Z){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,xe){te.__proto__=xe}||function(te,xe){for(var Te in xe)Object.prototype.hasOwnProperty.call(xe,Te)&&(te[Te]=xe[Te])})(G,Z)};return function(G,Z){if("function"!=typeof Z&&null!==Z)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");function te(){this.constructor=G}j(G,Z),G.prototype=null===Z?Object.create(Z):(te.prototype=Z.prototype,new te)}}(),Pm=function(j){function G(){var Z=null!==j&&j.apply(this,arguments)||this;return Z.dragHandleStyle={anchor:"center",draggable:!0,htmlContent:"<svg width='12' height='12' viewBox='0 0 12 12' fill='none' xmlns='http://www.w3.org/2000/svg'> <circle class='dragHandleCircle' cx = '6' cy = '6' r = '5.5' fill='#FFFFFF' stroke='#4E4C4C'/> </svg>"},Z.freehandInterval=3,Z.interactionType=Ja.hybrid,Z.mode=ir.idle,Z.secondaryDragHandleStyle={anchor:"center",draggable:!0,htmlContent:"<svg width='12' height='12' viewBox='0 0 12 12' fill='none' xmlns='http://www.w3.org/2000/svg'> <circle class='dragHandleCircle' cx = '6' cy = '6' r = '5.5' fill='#A6A6A6' stroke='#4E4C4C'/> </svg>"},Z.shapeDraggingEnabled=!0,Z.shapeRotationEnabled=!0,Z.source=void 0,Z.toolbar=void 0,Z}return _y(G,j),G._cloneCustomizer=function(Z){if(Z instanceof YI||Z instanceof pn.source.DataSource||Z instanceof XI)return Z},G}(WI),JI=function(j,G,Z){if(Z||2===arguments.length)for(var te,xe=0,Te=G.length;xe<Te;xe++)!te&&xe in G||((te=te||Array.prototype.slice.call(G,0,xe))[xe]=G[xe]);return j.concat(te||Array.prototype.slice.call(G))},v1=function(){function j(G,Z){var te=this;this.options={},this.strokeColor="#2266E3",this.parentIdProp="parent_id",this.outlineProp="outline",this.addCoord=function(xe,Te){te.options.mode===ir.drawPoint&&(te.finalShape=new pn.Shape(new pn.data.Point([])),te.activeShape=new pn.Shape(new pn.data.Point(xe.position)),te.activeShape.addProperty(te.parentIdProp,te.finalShape.getId()),te.drawMgr._invokeEvent("drawingstarted",null),te.finish()),te.options.mode!==ir.drawLine&&te.options.mode!==ir.drawPolygon||("click"!==xe.type&&!Te||te.options.interactionType!==Ja.click&&te.options.interactionType!==Ja.hybrid?!te.isMouseDown||"mousemove"!==xe.type&&"touchmove"!==xe.type||te.options.interactionType!==Ja.freehand&&te.options.interactionType!==Ja.hybrid||(te.previewShape&&(te.previewSource.remove(te.previewShape),te.previewShape=null,te.previewShapeCoordinates=[]),te.activeShape||(te.activeShape=new pn.Shape(new pn.data.LineString([])),te.options.mode===ir.drawPolygon?(te.finalShape=new pn.Shape(new pn.data.Polygon([])),te.activeShape.addProperty(te.outlineProp,!0)):te.finalShape=new pn.Shape(new pn.data.LineString([])),te.activeShape.addProperty(te.parentIdProp,te.finalShape.getId()),te.options.source.add(te.activeShape)),Te=te.map.positionsToPixels(te.activeShapeCoordinates)[0],(0===te.activeShapeCoordinates.length||te.pixelDifference(Te,xe.pixel)>te.options.freehandInterval)&&te.updateActiveShape(xe)):(te.activeShape||(te.activeShape=new pn.Shape(new pn.data.LineString([])),te.options.mode===ir.drawPolygon?(te.finalShape=new pn.Shape(new pn.data.Polygon([])),te.activeShape.addProperty(te.outlineProp,!0)):te.finalShape=new pn.Shape(new pn.data.LineString([])),te.activeShape.addProperty(te.parentIdProp,te.finalShape.getId()),te.options.source.add(te.activeShape)),te.previewShape||te.updateActiveShape(xe),te.previewShape&&(te.activeShapeCoordinates.push(xe.position),te.activeShape.setCoordinates(te.activeShapeCoordinates),te.drawMgr._invokeEvent("drawingchanged",te.activeShape),te.previewSource.remove(te.previewShape),te.previewShape=null,te.previewShapeCoordinates=[]))),te.options.mode===ir.drawRectangle&&(!te.isMouseDown||"mousemove"!==xe.type&&"touchmove"!==xe.type||(te.activeShape?(te.activeShapeCoordinates=[te.firstRectangleCorner,[xe.position[0],te.firstRectangleCorner[1]],xe.position,[te.firstRectangleCorner[0],xe.position[1]],te.firstRectangleCorner],te.activeShape.setCoordinates(te.activeShapeCoordinates),te.drawMgr._invokeEvent("drawingchanging",te.activeShape)):(te.finalShape=new pn.Shape(new pn.data.Polygon([])),te.activeShape=new pn.Shape(new pn.data.Polygon([])),te.activeShape.addProperty(te.parentIdProp,te.finalShape.getId()),te.activeShape.addProperty("subType","Rectangle"),te.options.source.add(te.activeShape),te.firstRectangleCorner=xe.position,te.drawMgr._invokeEvent("drawingstarted",null)))),te.options.mode===ir.drawCircle&&(!te.isMouseDown||"mousemove"!==xe.type&&"touchmove"!==xe.type||(te.activeShape?(te.activeShape.addProperty("radius",pn.math.getDistanceTo(te.circleCenterPosition,xe.position)),te.drawMgr._invokeEvent("drawingchanging",te.activeShape)):(te.finalShape=new pn.Shape(new pn.data.Point([])),te.activeShape=new pn.Shape(new pn.data.Point(xe.position)),te.activeShape.addProperty(te.parentIdProp,te.finalShape.getId()),te.activeShape.addProperty("subType","Circle"),te.activeShape.addProperty("radius",1),te.options.source.add(te.activeShape),te.circleCenterPosition=xe.position,te.drawMgr._invokeEvent("drawingstarted",null))))},this.previewCoord=function(xe){te.isMouseDown||!te.activeShape||te.options.mode!==ir.drawLine&&te.options.mode!==ir.drawPolygon||te.options.interactionType!==Ja.click&&te.options.interactionType!==Ja.hybrid||(te.previewShape||(te.previewShapeCoordinates=[te.activeShapeCoordinates[te.activeShapeCoordinates.length-1]],te.previewShape=new pn.Shape(new pn.data.LineString(te.previewShapeCoordinates)),te.previewSource.add(te.previewShape)),te.previewShapeCoordinates[1]=xe.position,te.previewShape.setCoordinates(te.previewShapeCoordinates),xe=JI(JI([],te.activeShapeCoordinates,!0),[xe.position],!1),(xe=new pn.Shape(new pn.data.LineString(xe))).addProperty(te.parentIdProp,te.finalShape.getId()),te.drawMgr._invokeEvent("drawingchanging",xe))},this.finish=function(xe){xe&&xe.preventDefault();var Te=!1;te.activeShape&&(te.options.mode!==ir.drawCircle&&te.options.mode!==ir.drawRectangle||te.drawMgr._invokeEvent("drawingchanged",te.activeShape),te.options.mode===ir.drawPolygon?0<te.activeShapeCoordinates.length&&(te.activeShapeCoordinates.push(te.activeShapeCoordinates[0]),te.finalShape.setCoordinates(te.activeShapeCoordinates)):te.finalShape.setCoordinates(te.activeShape.getCoordinates()),delete(xe=te.activeShape.getProperties())[te.parentIdProp],delete xe[te.outlineProp],te.options.source.getShapeById(te.activeShape.getId())&&te.options.source.remove(te.activeShape),te.finalShape.setProperties(xe),te.options.source.add(te.finalShape),Te=!(te.activeShape=null)),te.activeShapeCoordinates=[],te.previewShape&&te.previewSource.remove(te.previewShape),te.previewShapeCoordinates=[],te.previewShape=null,te.isMouseDown=!1,Te&&(Te=!1,te.drawMgr._invokeEvent("drawingcomplete",te.finalShape))},this.cancel=function(){te.activeShape&&(te.options.source.remove(te.activeShape),te.activeShapeCoordinates=[],te.activeShape=null,te.previewShape&&(te.previewSource.remove(te.previewShape),te.previewShapeCoordinates=[],te.previewShape=null),te.isMouseDown=!1)},this.setMouseDown=function(){te.isMouseDown=!0},this.setMouseUp=function(){te.isMouseDown=!1,te.options.interactionType===Ja.freehand&&te.finish()},this.getPreviewLayers=function(){return te.previewLayers},this.drawMgr=Z,this.map=G,this.previewLayers=new MM,this.previewSource=new pn.source.DataSource,this.map.sources.add(this.previewSource),this.previewLayers.pointLayer=new pn.layer.SymbolLayer(this.previewSource,null,{filter:["==",["geometry-type"],"Point"]}),this.previewLayers.lineLayer=new pn.layer.LineLayer(this.previewSource,null,{filter:["all",["==",["geometry-type"],"LineString"],["!",["has",this.outlineProp]]],strokeColor:this.strokeColor}),this.previewLayers.polygonLayer=new pn.layer.PolygonLayer(this.previewSource,null,{filter:["==",["geometry-type"],"Polygon"],strokeColor:this.strokeColor}),this.previewLayers.polygonOutlineLayer=new pn.layer.LineLayer(this.previewSource,null,{filter:["all",["==",["geometry-type"],"LineString"],["has",this.outlineProp]],strokeColor:this.strokeColor}),this.map.layers.add([this.previewLayers.polygonLayer,this.previewLayers.polygonOutlineLayer,this.previewLayers.lineLayer,this.previewLayers.pointLayer]),this.activeShapeCoordinates=[],this.previewShapeCoordinates=[]}return j.prototype.dispose=function(){this.previewLayers&&(this.map.layers.remove(this.previewLayers.lineLayer),this.map.layers.remove(this.previewLayers.polygonLayer),this.map.layers.remove(this.previewLayers.polygonOutlineLayer),this.map.layers.remove(this.previewLayers.pointLayer)),this.map=null,this.options=null,this.previewLayers=null},j.prototype.setOptions=function(G){this.options.mode!==G.mode&&this.finish(),this.options=G},j.prototype.pixelDifference=function(G,xe){var te=G[0]-xe[0];return xe=G[1]-xe[1],Math.sqrt(te*te+xe*xe)},j.prototype.updateActiveShape=function(G){var Z=this.activeShapeCoordinates[this.activeShapeCoordinates.length-1];0<this.activeShapeCoordinates.length?Z[0]===G.position[0]&&Z[1]===G.position[1]||(this.activeShapeCoordinates.push(G.position),this.activeShape.setCoordinates(this.activeShapeCoordinates),this.drawMgr._invokeEvent("drawingchanged",this.activeShape)):(this.activeShapeCoordinates.push(G.position),this.activeShape.setCoordinates(this.activeShapeCoordinates),this.drawMgr._invokeEvent("drawingstarted",null))},j}();!function(j){j.primary="primary",j.secondary="secondary",j.rotational="rotational"}(el=el||{});var w1=function(){var j=function(G,Z){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,xe){te.__proto__=xe}||function(te,xe){for(var Te in xe)Object.prototype.hasOwnProperty.call(xe,Te)&&(te[Te]=xe[Te])})(G,Z)};return function(G,Z){if("function"!=typeof Z&&null!==Z)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");function te(){this.constructor=G}j(G,Z),G.prototype=null===Z?Object.create(Z):(te.prototype=Z.prototype,new te)}}(),qv=function(j){function G(Z,te,xe,Te,nt,it){var at=j.call(this,Z)||this;return at.promoteHandle=function(fr){at.getHandleType()===el.secondary&&at.editHelper.promoteHandle(at,at.index,fr)},at.moveHandle=function(){at.editHelper.moveHandle(at,at.index)},at.showHandles=function(){at.getHandleType()===el.primary&&at.editHelper.showHandles(at,at.index)},at.primaryHtmlContent=it.dragHandleStyle.htmlContent,at.secondaryHtmlContent=it.secondaryDragHandleStyle.htmlContent,at.mp=te,at.editHelper=xe,at.handleType=Te,at.index=nt,at.mp.events.add("dragend",at,at.promoteHandle),at.mp.events.add("dragend",at,at.showHandles),at.mp.events.add("drag",at,at.moveHandle),at}return w1(G,j),G.prototype.setStyle=function(Z){this.style=Z,this.setOptions(this.style)},G.prototype.setState=function(Z){this.handleType=Z,this.handleType===el.primary?this.setOptions({htmlContent:this.primaryHtmlContent}):this.handleType===el.secondary&&this.setOptions({htmlContent:this.secondaryHtmlContent})},G.prototype.setIndex=function(Z){this.index=Z},G.prototype.setPosition=function(Z){this.setOptions({position:Z})},G.prototype.getPosition=function(){return this.getOptions().position},G.prototype.getHandleType=function(){return this.handleType},G.prototype.getIndex=function(){return this.index},G}(Nl.HtmlMarker),b1=function(){function j(G,Z,te,xe,Te){var nt=this;this.options={},this.trackMousePosition=function(it){nt.mouseEvent=it},this.fKeyPressed=function(it){70!==it.keyCode&&102!==it.keyCode||nt.drawingHelper.addCoord(nt.mouseEvent,!0)},this.cKeyPressed=function(it){67!==it.keyCode&&99!==it.keyCode||(nt.drawingHelper.finish(),nt.editHelper.finish())},this.deleteKeyPressed=function(it){46!==it.keyCode&&8!==it.keyCode||nt.editHelper.erase()},this.escKeyPressed=function(it){27===it.keyCode&&(nt.drawingHelper.cancel(),nt.editHelper.finish())},this.setMouseCursorToMove=function(){nt.map.getCanvas().style.cursor="move"},this.setMouseCursorToPointer=function(){nt.map.getCanvas().style.cursor="default"},this.setMouseCursorToCrossHair=function(){nt.map.getCanvas().style.cursor="crosshair"},this.setMouseCursorToGrab=function(){nt.map.getCanvas().style.cursor="grab"},this.map=G,this.layers=te,this.editHelper=Te,this.drawingHelper=xe,this.setOptions(this.options)}return j.prototype.setOptions=function(G){if(this.options.mode!==G.mode||this.options.freehandInterval!==G.freehandInterval||this.options.interactionType!==G.interactionType)switch(this.options=G,this.options.mode===ir.editGeometry&&this.options.shapeDraggingEnabled?(this.map.events.remove("mouseover",Object.values(this.layers),this.setMouseCursorToPointer),this.map.events.remove("mouseout",Object.values(this.layers),this.setMouseCursorToGrab),this.map.events.add("mouseover",Object.values(this.layers),this.setMouseCursorToMove),this.map.events.add("mouseout",Object.values(this.layers),this.setMouseCursorToGrab)):this.options.mode===ir.eraseGeometry?(this.map.events.remove("mouseover",Object.values(this.layers),this.setMouseCursorToMove),this.map.events.remove("mouseout",Object.values(this.layers),this.setMouseCursorToGrab),this.map.events.add("mouseover",Object.values(this.layers),this.setMouseCursorToPointer),this.map.events.add("mouseout",Object.values(this.layers),this.setMouseCursorToGrab)):(this.map.events.remove("mouseover",Object.values(this.layers),this.setMouseCursorToMove),this.map.events.remove("mouseover",Object.values(this.layers),this.setMouseCursorToPointer),this.map.events.remove("mouseout",Object.values(this.layers),this.setMouseCursorToGrab),this.options.mode===ir.idle?this.setMouseCursorToGrab():this.setMouseCursorToCrossHair()),this.options.mode){case ir.drawPoint:this._clear(),this.map.events.add("click",this.drawingHelper.addCoord),this.map.events.add("touchstart",this.drawingHelper.addCoord),this.map.events.add("mousemove",this.trackMousePosition),this.map.getMapContainer().addEventListener("keypress",this.fKeyPressed),this.map.getMapContainer().addEventListener("keypress",this.cKeyPressed),this.map.getMapContainer().addEventListener("keydown",this.escKeyPressed);break;case ir.drawLine:case ir.drawPolygon:this._clear(),j.lockMap(this.map),this.options.interactionType!==Ja.click&&this.options.interactionType!==Ja.hybrid||(this.map.events.add("click",this.drawingHelper.addCoord),this.map.events.add("mousemove",this.drawingHelper.previewCoord)),this.options.interactionType!==Ja.freehand&&this.options.interactionType!==Ja.hybrid||(this.map.events.add("mousedown",this.drawingHelper.setMouseDown),this.map.events.add("mousemove",this.drawingHelper.addCoord),this.map.events.add("mouseup",this.drawingHelper.setMouseUp),this.map.events.add("touchstart",this.drawingHelper.setMouseDown),this.map.events.add("touchmove",this.drawingHelper.addCoord),this.map.events.add("touchend",this.drawingHelper.finish)),this.map.events.add("dblclick",this.drawingHelper.finish),this.map.events.add("mousemove",this.trackMousePosition),this.map.getMapContainer().addEventListener("keypress",this.fKeyPressed),this.map.getMapContainer().addEventListener("keypress",this.cKeyPressed),this.map.getMapContainer().addEventListener("keydown",this.escKeyPressed);break;case ir.drawCircle:case ir.drawRectangle:this._clear(),j.lockMap(this.map),this.map.events.add("mousedown",this.drawingHelper.setMouseDown),this.map.events.add("mousemove",this.drawingHelper.addCoord),this.map.events.add("mouseup",this.drawingHelper.finish),this.map.events.add("touchstart",this.drawingHelper.setMouseDown),this.map.events.add("touchmove",this.drawingHelper.addCoord),this.map.events.add("touchend",this.drawingHelper.finish),this.map.events.add("mousemove",this.trackMousePosition),this.map.getMapContainer().addEventListener("keypress",this.fKeyPressed),this.map.getMapContainer().addEventListener("keypress",this.cKeyPressed),this.map.getMapContainer().addEventListener("keydown",this.escKeyPressed);break;case ir.editGeometry:j.unLockMap(this.map),this.map.events.add("click",this.editHelper.selectShape),this.map.events.add("touchstart",this.editHelper.selectShape),this.map.events.add("mousedown",this.editHelper.setMouseDown),this.map.events.add("mouseup",this.editHelper.setMouseUp),this.map.events.add("touchstart",this.editHelper.setMouseDown),this.map.events.add("touchend",this.editHelper.setMouseUp),this.map.getMapContainer().addEventListener("keydown",this.escKeyPressed),this.map.getMapContainer().addEventListener("keydown",this.deleteKeyPressed);break;case ir.eraseGeometry:j.unLockMap(this.map),this.map.events.add("click",this.editHelper.selectShape),this.map.events.add("touchstart",this.editHelper.selectShape),this.map.events.add("mousedown",this.editHelper.setMouseDown),this.map.events.add("mouseup",this.editHelper.setMouseUp),this.map.events.add("touchstart",this.editHelper.setMouseDown),this.map.events.add("touchend",this.editHelper.setMouseUp),this.map.getMapContainer().addEventListener("keydown",this.deleteKeyPressed);break;default:j.unLockMap(this.map),this._clear()}},j.prototype._clear=function(){this.drawingHelper.finish(),this.editHelper.finish(),this.map.events.remove("click",this.drawingHelper.addCoord),this.map.events.remove("touchstart",this.drawingHelper.addCoord),this.map.events.remove("drag",this.drawingHelper.addCoord),this.map.events.remove("mousemove",this.drawingHelper.previewCoord),this.map.events.remove("mousemove",this.drawingHelper.addCoord),this.map.events.remove("mouseup",this.drawingHelper.finish),this.map.events.remove("mouseup",this.drawingHelper.addCoord),this.map.events.remove("mouseup",this.drawingHelper.setMouseUp),this.map.events.remove("mousedown",this.drawingHelper.setMouseDown),this.map.events.remove("dblclick",this.drawingHelper.finish),this.map.events.remove("mousemove",this.trackMousePosition),this.map.events.remove("touchstart",this.drawingHelper.setMouseDown),this.map.events.remove("touchmove",this.drawingHelper.addCoord),this.map.events.remove("touchend",this.drawingHelper.finish),this.map.events.remove("click",this.editHelper.selectShape),this.map.events.remove("touchstart",this.editHelper.selectShape),this.map.events.remove("mousedown",this.editHelper.setMouseDown),this.map.events.remove("mouseup",this.editHelper.setMouseUp),this.map.events.remove("touchstart",this.editHelper.setMouseDown),this.map.events.remove("touchend",this.editHelper.setMouseUp),this.map.getMapContainer().removeEventListener("keypress",this.fKeyPressed),this.map.getMapContainer().removeEventListener("keypress",this.cKeyPressed),this.map.getMapContainer().removeEventListener("keydown",this.deleteKeyPressed),this.map.getMapContainer().removeEventListener("keydown",this.escKeyPressed)},j.lockMap=function(G){G.setUserInteraction({dblClickZoomInteraction:!1,dragPanInteraction:!1}),G.getMapContainer().style.touchAction="none"},j.unLockMap=function(G){G.setUserInteraction({dblClickZoomInteraction:!0,dragPanInteraction:!0}),G.getMapContainer().style.touchAction=null},j}(),kM=function(){function j(G,Z,te,xe){var Te=this;this.editedPointStyle="marker-blue",this.isDragging=!1,this.erase=function(){Te.shape&&(Te.options.source.remove(Te.shape),Te.selectedShapeCoordinates=[],Te._clearHandlesAndListeners(),Te.drawMgr._invokeEvent("drawingerased",Te.shape),Te.shape=null,Te.isMouseDown=!1)},this.selectShape=function(nt){var it,at;nt.originalEvent.target===Te.map.getCanvas()&&(at=[nt.pixel[0]+3,nt.pixel[1]-3],it=Te.map.pixelsToPositions([it=[nt.pixel[0]-3,nt.pixel[1]+3]])[0],at=Te.map.pixelsToPositions([at])[0],at=new pn.data.BoundingBox(it,at),(at=Te.map.layers.getRenderedShapes(at,Object.values(Te.layers)))&&0<at.length&&(at=at[0])&&(Te.options.mode===ir.eraseGeometry?(Te.shape=at,Te.erase(),Te.drawMgr.setOptions({mode:ir.idle})):Te.edit(at)),nt.originalEvent.stopImmediatePropagation())},this.setMouseDown=function(){Te.isMouseDown=!0},this.setMouseUp=function(){Te.isMouseDown=!1},this._startDragAndRotate=function(nt){Te.isEventShapeSameAsSelectedShape(nt)&&(Te.options.shapeDraggingEnabled&&(Te.rotateHandle&&Te.rotateHandle.setOptions({visible:!1}),Te.isDragging=!0),Te._freezeMap(Te.shape,nt))},this._dragAndRotate=function(nt){if(Te.shape&&Te.isMouseDown){if(Te.isDragging){var it=pn.Pixel.getX(Te.currentReferencedPixel)-pn.Pixel.getX(nt.pixel),at=pn.Pixel.getY(Te.currentReferencedPixel)-pn.Pixel.getY(nt.pixel);if(it*it+at*at<=25)return;Te.map.markers.remove(Te.primaryHandles),Te.map.markers.remove(Te.secondaryHandles),Te.primaryHandles=[],Te.secondaryHandles=[],Te._pixelAccurateUpdate(nt)}Te.isRotating&&(nt=Te.map.positionsToPixels([Te.initCentroid,nt.position]),nt=Nl.Pixel.getHeading(nt[0],nt[1])-Te.initHeading+180,Te._showOrHideDragHandles(!1),Te.rotateShape(Te.shape,Te.initCoordinates,Te.initCentroid,nt))}},this._endDragAndRotate=function(nt){var it;b1.unLockMap(Te.map),Te.isDragging&&(Te.isDragging=!1,Te.shape&&"Point"===Te.shape.getType()&&!Te.shape.isCircle()&&(delete(it=Te.shape.getProperties())._azureMapsMarker,Te.shape.setProperties(it)),Te.rotateHandle&&Te.rotateHandle.setOptions({visible:!0})),Te.isRotating&&(Te.isRotating=!1,Te._showOrHideDragHandles(!0)),Te.edit(Te.shape)},this._handleMouseDownOnRotateHandle=function(nt){var it=Te.map.positionsToPixels([Te.rotateInitHandlePosition,Te.initCentroid]);Te.initHeading=Nl.Pixel.getHeading(it[0],it[1]),Te.map.setUserInteraction({dragPanInteraction:!1}),Te.isRotating=!0},this._startRotate=function(nt){Te._freezeMap(Te.shape,nt)},this.removeRotateHandle=function(){Te.rotateHandle&&(Te.map.events.remove("mousedown",Te.rotateHandle,Te._handleMouseDownOnRotateHandle),Te.map.markers.remove(Te.rotateHandle),Te.rotateHandle=null)},this.map=G,this.options=Z,this.primaryHandles=[],this.secondaryHandles=[],this.layers=te,this.drawMgr=xe,this.defaultPointStyle=this.layers.pointLayer?this.layers.pointLayer.getOptions().iconOptions.image:"marker-black"}return j.prototype.setOptions=function(G){this.finish(),this.options=G},j.prototype.finish=function(){this._clearHandlesAndListeners();var G=this.shape;this.shape=null,G&&this.drawMgr._invokeEvent("drawingcomplete",G),this.currentReferencedPixel=null,b1.unLockMap(this.map)},j.prototype.edit=function(G){this.shape&&this.drawMgr._invokeEvent("drawingcomplete",this.shape),this.drawMgr._invokeEvent("drawingstarted",G),this._disableShapeDragAndRotate(),this._clearHandlesAndListeners(),this.shape=G,this.selectedShapeCoordinates=this.shape.getCoordinates(),"Point"!==this.shape.getType()||this.shape.isCircle()?0===this.primaryHandles.length&&(this.shape.isCircle()?this._generateDragHandles(this.selectedShapeCoordinates):this.shape.isRectangle()?this._generateDragHandles(this.selectedShapeCoordinates[0]):"LineString"===this.shape.getType()?this._generateDragHandles(this.selectedShapeCoordinates):"Polygon"===this.shape.getType()&&this._generateDragHandles(this.selectedShapeCoordinates[0])):this.shape.addProperty("_azureMapsMarker",this.editedPointStyle),this._enableShapeDragAndRotate()},j.prototype.promoteHandle=function(G,Z,te){this.isSecondaryHandleMoving=!1,G.setOptions({visible:!0});var it=G.getPosition(),nt=this.primaryHandles.length;"LineString"===this.shape.getType()?Te=(at=Z)+1:"Polygon"===this.shape.getType()&&(at=0===Z?nt-1:Z-1,Te=Z===nt-1?0:Z+1),nt=this.primaryHandles[at];var xe,at=this.primaryHandles[Te],Te=this._getMidPosition(it,nt.getPosition());for(nt=this._getMidPosition(it,at.getPosition()),it=new qv(this.options.secondaryDragHandleStyle,this.map,this,el.secondary,Z,this.options),at=new qv(this.options.secondaryDragHandleStyle,this.map,this,el.secondary,Z+1,this.options),it.setPosition(Te),at.setPosition(nt),G.setState(el.primary),G.setIndex(Z+1),G.setStyle(this.options.dragHandleStyle),this.secondaryHandles[Z]=it,this.secondaryHandles.splice(Z+1,0,at),this.primaryHandles.splice(Z+1,0,G),xe=Z+2;xe<this.secondaryHandles.length;xe++)this.primaryHandles[xe].setIndex(xe),this.secondaryHandles[xe].setIndex(xe);"LineString"===this.shape.getType()&&this.primaryHandles[xe].setIndex(xe),this.map.markers.add([it,at])},j.prototype.moveHandle=function(G,Z){this.drawMgr._invokeEvent("drawingchanged",this.shape),this._disableShapeDragAndRotate();var te,xe,Te,nt,it,at=G.getPosition();this.shape.isCircle()?(this.shape.setProperties({radius:pn.math.getDistanceTo(nt=this.selectedShapeCoordinates,G.getPosition()),subType:"Circle"}),this.primaryHandles.forEach(function(fr){fr.setOptions({visible:!1})})):this.shape.isRectangle()?(G.setOptions({visible:!1}),te=void 0,(it=this.selectedShapeCoordinates[0])[Z]=at,xe=0===Z?(te=this.primaryHandles.length-1,Z+1):(te=Z-1,Z===this.primaryHandles.length-1?0:Z+1),Te=this.primaryHandles[te],nt=this.primaryHandles[xe],0===Z||2===Z?(it[te][0]=at[0],it[xe][1]=at[1]):1!==Z&&3!==Z||(it[te][1]=at[1],it[xe][0]=at[0]),Te.setPosition(it[te]),nt.setPosition(it[xe]),Te.setOptions({visible:!1}),nt.setOptions({visible:!1}),it[it.length-1]=it[0],this.shape.setCoordinates([it])):"LineString"===this.shape.getType()?(G.setOptions({visible:!1}),G.getHandleType()===el.primary&&((it=this.selectedShapeCoordinates)[Z]=at,this.shape.setCoordinates(it),0<Z&&this.secondaryHandles[Z-1].setOptions({visible:!1}),Z<this.primaryHandles.length-1&&this.secondaryHandles[Z].setOptions({visible:!1})),G.getHandleType()===el.secondary&&(it=this.selectedShapeCoordinates,this.isSecondaryHandleMoving?it[Z+1]=at:(it.splice(Z+1,0,at),this.isSecondaryHandleMoving=!0),this.shape.setCoordinates(it))):"Polygon"===this.shape.getType()&&(G.setOptions({visible:!1}),G.getHandleType()===el.primary&&((it=this.selectedShapeCoordinates[0])[Z]=at,0===Z?(this.secondaryHandles[Z].setOptions({visible:!1}),this.secondaryHandles[this.secondaryHandles.length-1].setOptions({visible:!1})):(0<Z&&this.secondaryHandles[Z-1].setOptions({visible:!1}),Z<this.primaryHandles.length&&this.secondaryHandles[Z].setOptions({visible:!1})),it[it.length-1]=it[0],this.shape.setCoordinates([it])),G.getHandleType()===el.secondary&&(it=this.selectedShapeCoordinates[0],this.isSecondaryHandleMoving?it[Z+1]=at:(it.splice(Z+1,0,at),this.isSecondaryHandleMoving=!0),this.shape.setCoordinates([it])))},j.prototype.showHandles=function(G,Z){var te,xe,Te,nt,it,at,fr,Er,Qr;this.shape.isCircle()?(te=this.selectedShapeCoordinates,xe=this.shape.getProperties().radius,Te=0,this.primaryHandles.forEach(function(yo){yo.setPosition(pn.math.getDestination(te,Te+=90,xe)),yo.setOptions({visible:!0})})):(nt=G.getPosition(),it=this.primaryHandles.length,Qr=fr=Er=at=void 0,"LineString"===this.shape.getType()?(at=0<Z?Z-1:null,Er=Z<it-1?Z+1:null,fr=Z-1,Qr=Z):"Polygon"===this.shape.getType()&&(Er=Z===it-1?0:Z+1,fr=at=0===Z?it-1:Z-1,Qr=Z),null!=at&&(at=this.primaryHandles[at],this.shape.isRectangle()?at.setOptions({visible:!0}):(at=this._getMidPosition(nt,at.getPosition()),(fr=this.secondaryHandles[fr]).setPosition(at),this.map.markers.add(fr),fr.setOptions({visible:!0}))),null!=Er&&(Er=this.primaryHandles[Er],this.shape.isRectangle()?Er.setOptions({visible:!0}):(Er=this._getMidPosition(nt,Er.getPosition()),(Qr=this.secondaryHandles[Qr]).setPosition(Er),this.map.markers.add(Qr),Qr.setOptions({visible:!0})))),G.setOptions({visible:!0}),this._enableShapeDragAndRotate()},j.prototype._generateDragHandles=function(G){if(this.shape.isCircle())for(var Z=G,te=this.shape.getProperties().radius,xe=0,Te=0;Te<4;Te++){var nt=pn.math.getDestination(Z,xe+=90,te);(it=new qv(this.options.dragHandleStyle,this.map,this,el.primary,Te,this.options)).setPosition(nt),this.map.markers.add(it),this.primaryHandles.push(it)}else{var it,at,fr;for(Te=0;Te<G.length;Te++)(it=new qv(this.options.dragHandleStyle,this.map,this,el.primary,Te,this.options)).setPosition(G[Te]),this.primaryHandles.push(it),this.map.markers.add(it),this.shape.isRectangle()||Te<G.length-1&&(at=this._getMidPosition(G[Te],G[Te+1]),(fr=new qv(this.options.secondaryDragHandleStyle,this.map,this,el.secondary,Te,this.options)).setPosition(at),this.map.markers.add(fr),this.secondaryHandles.push(fr));"Polygon"===this.shape.getType()&&this.map.markers.remove(this.primaryHandles.pop())}},j.prototype._getMidPosition=function(G,Z){return G=this.map.positionsToPixels([G])[0],Z=this.map.positionsToPixels([Z])[0],this.map.pixelsToPositions([Z=[(G[0]+Z[0])/2,(G[1]+Z[1])/2]])[0]},j.prototype._clearHandlesAndListeners=function(){this.map.markers.remove(this.primaryHandles),this.map.markers.remove(this.secondaryHandles),this.primaryHandles=[],this.secondaryHandles=[],this._disableShapeDragAndRotate(),this.removeRotateHandle(),this.shape&&"Point"===this.shape.getType()&&!this.shape.isCircle()&&this.shape.addProperty("_azureMapsMarker",this.defaultPointStyle)},j.prototype._enableShapeDragAndRotate=function(){this._dragOrRotateEnabled()&&(this.map.events.add("mousedown",this._startDragAndRotate),this.map.events.add("mousemove",this._dragAndRotate),this.map.events.add("mouseup",this._endDragAndRotate),this._shouldRotate()&&(this._unselectShapeForRotate(),this.initCentroid=Nl.data.BoundingBox.getCenter(Nl.data.BoundingBox.fromData(this.shape)),this.initCoordinates=this.shape.getCoordinates(),this.initHeading=null,this.rotateInitHandlePosition=this.getInitHandlePosition(this.shape),this.rotateHandle=new pn.HtmlMarker({position:this.rotateInitHandlePosition,htmlContent:'<div class="rotateHandleIcon" />'}),this.map.markers.add(this.rotateHandle),this.map.events.add("mousedown",this.rotateHandle,this._handleMouseDownOnRotateHandle)))},j.prototype._dragOrRotateEnabled=function(){return this.options&&(this.options.shapeDraggingEnabled||this.options.shapeRotationEnabled)},j.prototype._shouldRotate=function(){return this.options&&this.options.shapeRotationEnabled&&"Point"!==this.shape.getType()&&!this.shape.isCircle()},j.prototype._disableShapeDragAndRotate=function(){this._dragOrRotateEnabled()&&(this.map.events.remove("mousedown",this._startDragAndRotate),this.map.events.remove("mousemove",this._dragAndRotate),this.map.events.remove("mouseup",this._endDragAndRotate))},j.prototype.isEventShapeSameAsSelectedShape=function(te){var Z;return(Z=(te=te.shapes&&te.shapes.filter(function(xe){return xe&&xe.getProperties}))&&0<te.length?te[0]:Z)&&this.shape&&this.shape.getId()===Z.getId()},j.prototype._freezeMap=function(G,Z){this.shape=G,b1.lockMap(this.map),this.currentReferencedPixel=Z.pixel},j.prototype._pixelAccurateUpdate=function(G){var Z=pn.Pixel.getX(this.currentReferencedPixel)-pn.Pixel.getX(G.pixel),te=pn.Pixel.getY(this.currentReferencedPixel)-pn.Pixel.getY(G.pixel);if("Point"===this.shape.getType()){var xe=this.shape.getCoordinates();this.shape.setCoordinates(this._pixelShiftLocations(xe,Z,te))}else{var Te=void 0;"Polygon"===this.shape.getType()?Te=this.shape.getCoordinates()[0]:"LineString"===this.shape.getType()&&(Te=this.shape.getCoordinates());for(var nt=0,it=Te.length;nt<it;nt++)Te[nt]=this._pixelShiftLocations(Te[nt],Z,te);this.shape.setCoordinates(Te)}this.currentReferencedPixel=G.pixel},j.prototype._pixelShiftLocations=function(G,Z,te){return(G=this.map.positionsToPixels([G])[0])[0]-=Z,G[1]-=te,this.map.pixelsToPositions([G])[0]},j.prototype._showOrHideDragHandles=function(G){this.primaryHandles.forEach(function(Z){Z.setOptions({visible:G})}),this.secondaryHandles.forEach(function(Z){Z.setOptions({visible:G})})},j.prototype._unselectShapeForRotate=function(){this.initCentroid=null,this.initCoordinates=null,this.initHeading=null,this.isRotating=!1,this.removeRotateHandle()},j.prototype.rotateShape=function(G,Z,te,xe){switch(G.getType()){case"LineString":case"MultiPoint":G.setCoordinates(pn.math.rotatePositions(Z,te,xe));break;case"Polygon":case"MultiLineString":var Te=Z.map(function(nt){return pn.math.rotatePositions(nt,te,xe)});G.setCoordinates(Te);break;case"MultiPolygon":Te=Z.map(function(nt){return nt.map(function(it){return pn.math.rotatePositions(it,te,xe)})}),G.setCoordinates(Te)}this.rotateHandle&&this.rotateHandle.setOptions({position:pn.math.rotatePositions([this.rotateInitHandlePosition],te,xe)[0]})},j.prototype.getInitHandlePosition=function(G){return G=G.getCoordinates(),pn.math.getPositions(G)[0]},j}(),k3=function(){var j=function(G,Z){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,xe){te.__proto__=xe}||function(te,xe){for(var Te in xe)Object.prototype.hasOwnProperty.call(xe,Te)&&(te[Te]=xe[Te])})(G,Z)};return function(G,Z){if("function"!=typeof Z&&null!==Z)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");function te(){this.constructor=G}j(G,Z),G.prototype=null===Z?Object.create(Z):(te.prototype=Z.prototype,new te)}}(),O3=function(j){function G(Z,te){var xe=j.call(this)||this;return xe._onStyleChanged=function(){var Te;xe.source&&xe.map&&xe.map.sources&&(Te=xe.source.getId(),(Te=xe.map.sources.getById(Te))&&(xe.source=Te))},xe.map=Z,xe.options=(new Pm).merge(yy(te,Pm._cloneCustomizer)),xe.drawingLayers=new MM,xe.drawingHelper=new v1(xe.map,xe),xe.editHelper=new kM(xe.map,te,xe.drawingLayers,xe),xe.inputHelper=new b1(xe.map,xe.options,xe.drawingLayers,xe.drawingHelper,xe.editHelper),xe.setOptions(xe.options),xe.map.events.add("stylechanged",xe._onStyleChanged),xe}return k3(G,j),G.prototype.dispose=function(){this.options.toolbar&&this.options.toolbar._dispose(),this.drawingLayers&&(this.map.layers.remove(this.drawingLayers.lineLayer),this.map.layers.remove(this.drawingLayers.polygonLayer),this.map.layers.remove(this.drawingLayers.polygonOutlineLayer),this.map.layers.remove(this.drawingLayers.pointLayer)),this.drawingHelper&&this.drawingHelper.dispose(),this.map.events.remove("stylechanged",this._onStyleChanged),this.map=null,this.options=null,this.drawingLayers=null,this.source=null,this.drawingHelper=null,this.editHelper=null,this.inputHelper=null},G.prototype.edit=function(Z){Z&&(this.source&&!this.source.getShapeById(Z.getId())&&this.source.add(Z),this.setOptions({mode:ir.editGeometry}),this.editHelper.edit(Z))},G.prototype.getOptions=function(){return this.options},G.prototype.getLayers=function(){return this.drawingLayers},G.prototype.getPreviewLayers=function(){return this.drawingHelper.getPreviewLayers()},G.prototype.getSource=function(){return this.source},G.prototype.setOptions=function(Z){(Z=(new Pm).merge(this.options,yy(Z,Pm._cloneCustomizer))).dragHandleStyle.draggable=!0,Z.secondaryDragHandleStyle.draggable=!0,Z.source=Z.source||this.options.source,this.options.toolbar!==Z.toolbar?(this.options.toolbar&&this.options.toolbar._close(),this.options.toolbar=Z.toolbar,this.options.toolbar&&this.options.toolbar._open(this,this.map)):this.options.toolbar&&!this.options.toolbar._isOpen()&&this.options.toolbar._open(this,this.map),this.options.source?this.options.source!==Z.source&&(this.source=this.options.source,Z.mode=ir.idle,this._setLayerSources()):(this.source=new pn.source.DataSource,this.map.sources.add(this.source),this._setLayerSources()),this.options.mode!==Z.mode&&this._invokeEvent("drawingmodechanged",Z.mode),this.options=Z,this.options.source=this.source,this.editHelper.setOptions(this.options),this.inputHelper.setOptions(this.options),this.drawingHelper.setOptions(this.options),this.inputHelper.setOptions(this.options)},G.prototype._getMap=function(){return this.map},G.prototype._setLayerSources=function(){this.drawingLayers.polygonLayer?this.drawingLayers.polygonLayer.setOptions({filter:["==",["geometry-type"],"Polygon"],source:this.source}):(this.drawingLayers.polygonLayer=new pn.layer.PolygonLayer(this.source,null,{fillColor:"rgba(0, 0, 0, 0.12)",filter:["all",["==",["geometry-type"],"Polygon"],["!",["has","_incomplete"]]]}),this.map.layers.add(this.drawingLayers.polygonLayer)),this.drawingLayers.polygonOutlineLayer?this.drawingLayers.polygonOutlineLayer.setOptions({filter:["any",["==",["geometry-type"],"Polygon"],["all",["==",["geometry-type"],"LineString"],["has","_outline"]]],source:this.source}):(this.drawingLayers.polygonOutlineLayer=new pn.layer.LineLayer(this.source,null,{filter:["any",["==",["geometry-type"],"Polygon"],["all",["==",["geometry-type"],"LineString"],["has","_outline"]]],strokeColor:"#000000"}),this.map.layers.add(this.drawingLayers.polygonOutlineLayer)),this.drawingLayers.lineLayer?this.drawingLayers.lineLayer.setOptions({filter:["all",["==",["geometry-type"],"LineString"],["!",["has","_outline"]]],source:this.source}):(this.drawingLayers.lineLayer=new pn.layer.LineLayer(this.source,null,{filter:["all",["==",["geometry-type"],"LineString"],["!",["has","_outline"]]],strokeColor:"#000000"}),this.map.layers.add(this.drawingLayers.lineLayer)),this.drawingLayers.pointLayer?this.drawingLayers.pointLayer.setOptions({filter:["==",["geometry-type"],"Point"],source:this.source}):(this.drawingLayers.pointLayer=new pn.layer.SymbolLayer(this.source,null,{filter:["==",["geometry-type"],"Point"],iconOptions:{allowOverlap:!0,ignorePlacement:!0,image:["case",["has","_azureMapsMarker"],["get","_azureMapsMarker"],"marker-black"],size:.5}}),this.map.layers.add(this.drawingLayers.pointLayer))},G}(pn.internal.EventEmitter),OM=function(){function j(G,Z){var te=this;this._options={resolution:15,showGrid:!1,removeDuplicates:!0,enabled:!0,simplify:!0},this._mapSize24=512*Math.pow(2,24),this._updateGrid=function(){var Te=te,Qr=Te._map.getCamera(),nt=Math.round(Qr.zoom),it=Te._options.resolution*Math.pow(2,24-nt),at=pn.data.BoundingBox,fr=Te._mapSize24,Er=Te.clip,yo=(Qr=te.splitOnAntimeridian(Qr.bounds),[]);Qr.forEach(function(zo){zo=(Xo=Te.fastPositionsToPixels([at.getNorthWest(zo),at.getSouthEast(zo)],!1,!1,it))[0];for(var Xo=Xo[1],Gc=Er(zo[0]-zo[0]%it-it,0,fr),Ki=Er(Xo[0]-Xo[0]%it+it,0,fr),ph=Er(zo[1]-zo[1]%it-it,0,fr),x1=Er(Xo[1]-Xo[1]%it+it,0,fr),Rm=ph;Rm<x1;Rm+=it)yo.push(new pn.data.LineString(Te.fastPixelsToPositions([[Gc,Rm],[Ki,Rm]])));for(var vy=Gc;vy<Ki;vy+=it)yo.push(new pn.data.LineString(Te.fastPixelsToPositions([[vy,ph],[vy,x1]])))}),Te._source.setShapes(yo)};var xe=this;xe._map=G,xe._source=new pn.source.DataSource,G.sources.add(xe._source),xe._layer=new pn.layer.LineLayer(xe._source,null,{strokeColor:"#c3a77e",strokeWidth:1,visible:!1}),G.layers.add(xe._layer,"transit"),xe.setOptions(Z||{})}return j.prototype.dispose=function(){var G=this;G._map.events.remove("move",G._updateGrid),G._map.events.remove("resize",G._updateGrid),Object.keys(G).forEach(function(Z){G[Z]=null})},j.prototype.getOptions=function(){return Object.assign({},this._options)},j.prototype.getGridLayer=function(){return this._layer},j.simplify=function(G,Z){return pn.math.simplify(G,Z)},j.prototype.snapPositions=function(G,Z){var te=this._options;if(!te.enabled)return G;Z=Math.round("number"==typeof Z?Math.abs(Z):this._map.getCamera().zoom);for(var xe,Te,nt=te.resolution*Math.pow(2,24-Z),it=this.fastPositionsToPixels(G,te.removeDuplicates,te.simplify,nt),at=0,fr=it.length;at<fr;at++){.5*nt<=(Te=(xe=it[at])[0]%nt)&&(Te-=nt);var Er=xe[1]%nt;.5*nt<=Er&&(Er-=nt),xe[0]-=Te,xe[1]-=Er}return this.fastPixelsToPositions(it)},j.prototype.snapShape=function(G,Z){var te;this._options.enabled&&(G instanceof pn.Shape?(te=G.toJson(),this.snapFeature(te,Z),G.setCoordinates(te.geometry.coordinates)):"Feature"===G.type&&this.snapFeature(G,Z))},j.prototype.setOptions=function(G){var Z,te,xe,Te;G&&(te=(Z=this)._map,xe=Z._options,Te=!1,"boolean"==typeof G.removeDuplicates&&G.removeDuplicates!==xe.removeDuplicates&&(xe.removeDuplicates=G.removeDuplicates),"boolean"==typeof G.simplify&&G.simplify!==xe.simplify&&(xe.simplify=G.simplify),"boolean"==typeof G.enabled&&G.enabled!==xe.enabled&&(xe.enabled=G.enabled),"number"==typeof G.resolution&&0<G.resolution&&(xe.resolution=G.resolution,Te=!0),"boolean"==typeof G.showGrid&&G.showGrid!==xe.showGrid&&(xe.showGrid=G.showGrid,xe.showGrid?(te.events.add("move",Z._updateGrid),te.events.add("resize",Z._updateGrid),Te=!0):(te.events.remove("move",Z._updateGrid),te.events.remove("resize",Z._updateGrid)),Z._layer.setOptions({visible:xe.showGrid})),Te&&(Z._source.clear(),Z._updateGrid()))},j.prototype.snapFeature=function(G,Z){var te=this,xe=G.geometry;switch(xe.type){case"Point":xe.coordinates=te.snapPositions([xe.coordinates],Z)[0];break;case"LineString":case"MultiPoint":xe.coordinates=te.snapPositions(xe.coordinates,Z);break;case"Polygon":case"MultiLineString":xe.coordinates=xe.coordinates.map(function(Te){return te.snapPositions(Te,Z)});break;case"MultiPolygon":xe.coordinates=xe.coordinates.map(function(Te){return Te.map(function(nt){return te.snapPositions(nt,Z)})})}},j.prototype.fastPositionsToPixels=function(G,Z,te,xe){for(var Te,nt,it=[],at=this._mapSize24,fr=0,Er=G.length;fr<Er;fr++){var yo=Math.sin(G[fr][1]*Math.PI/180),Qr=Math.round((pn.math.normalizeLongitude(G[fr][0])+180)/360*at);yo=Math.round((.5-Math.log((1+yo)/(1-yo))/(4*Math.PI))*at),0!==fr&&Z&&Te===Qr&&nt===yo||it.push([Qr,yo]),Te=Qr,nt=yo}return te&&1<it.length?pn.math.simplify(it,.5*xe):it},j.prototype.fastPixelsToPositions=function(G){for(var Z=[],te=0,xe=G.length;te<xe;te++)Z.push(this.fastPixelToPosition(G[te]));return Z},j.prototype.fastPixelToPosition=function(G){var Z=this._mapSize24;return[360*(G[0]/Z-.5),90-360*Math.atan(Math.exp(2*-(.5-G[1]/Z)*Math.PI))/Math.PI]},j.prototype.clip=function(G,Z,te){return Math.max(Math.min(G,te),Z)},j.prototype.splitOnAntimeridian=function(G){var Z,te,xe,Te,nt,it,at=[];return 6<=G.length&&360<G[3]-G[0]?[[-180,G[1],G[2],180,G[4],G[5]]]:G.length<6&&360<G[2]-G[0]?[[-180,G[1],180,G[3]]]:(this.crossesAntimeridian(G)?(Z=void 0,te=pn.math.normalizeLongitude(pn.data.BoundingBox.getWest(G)),xe=pn.math.normalizeLongitude(pn.data.BoundingBox.getEast(G)),Te=pn.math.normalizeLatitude(pn.data.BoundingBox.getNorth(G)),nt=pn.math.normalizeLatitude(pn.data.BoundingBox.getSouth(G)),it=6<=G.length?(Z=[te,nt,G[2],180,Te,G[5]],[-180,nt,G[2],xe,Te,G[5]]):(Z=[te,nt,180,Te],[-180,nt,xe,Te]),at.push(Z,it)):at.push(G),at)},j.prototype.crossesAntimeridian=function(G){return pn.math.normalizeLongitude(pn.data.BoundingBox.getEast(G))-pn.math.normalizeLongitude(pn.data.BoundingBox.getWest(G))<0||6<=G.length&&360<G[3]-G[0]||G.length<6&&360<G[2]-G[9]},j}(),NM=Object.freeze({__proto__:null,SnapGridManager:OM}),E1=Object.freeze({__proto__:null,get DrawingInteractionType(){return Ja},DrawingManager:O3,get DrawingMode(){return ir},SnapGridManager:OM}),eS=Ka.merge("atlas.control",D3),tS=Ka.merge("atlas.drawing",E1);Ka.merge("atlas.drawing",NM);ub.$C=eS,ub.VO=tS}},CF=>{CF(CF.s=810)}]);